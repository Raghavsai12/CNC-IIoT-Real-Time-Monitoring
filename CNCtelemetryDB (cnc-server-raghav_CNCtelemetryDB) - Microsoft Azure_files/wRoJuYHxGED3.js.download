define("@fluentui/react/lib/components/ProgressIndicator/ProgressIndicator.base",["require","exports","tslib","react","@fluentui/react/lib/Utilities"],(function(e,t,r,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressIndicatorBase=void 0;var n=(0,o.classNamesFunction)(),i=function(e){function t(t){var r=e.call(this,t)||this;r._onRenderProgress=function(e){var t=r.props,o=t.ariaLabel,i=t.ariaValueText,s=t.barHeight,l=t.className,c=t.description,u=t.label,d=void 0===u?r.props.title:u,m=t.styles,p=t.theme,f="number"==typeof r.props.percentComplete?Math.min(100,Math.max(0,100*r.props.percentComplete)):void 0,g=n(m,{theme:p,className:l,barHeight:s,indeterminate:void 0===f}),b={width:void 0!==f?f+"%":void 0,transition:void 0!==f&&f<.01?"none":void 0},v=void 0!==f?0:void 0,h=void 0!==f?100:void 0,C=void 0!==f?Math.floor(f):void 0;return a.createElement("div",{className:g.itemProgress},a.createElement("div",{className:g.progressTrack}),a.createElement("div",{className:g.progressBar,style:b,role:"progressbar","aria-describedby":c?r._descriptionId:void 0,"aria-label":o,"aria-labelledby":d?r._labelId:void 0,"aria-valuemin":v,"aria-valuemax":h,"aria-valuenow":C,"aria-valuetext":i}))};var i=(0,o.getId)("progress-indicator");return r._labelId=i+"-label",r._descriptionId=i+"-description",r}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.barHeight,o=e.className,i=e.label,s=void 0===i?this.props.title:i,l=e.description,c=e.styles,u=e.theme,d=e.progressHidden,m=e.onRenderProgress,p=void 0===m?this._onRenderProgress:m,f="number"==typeof this.props.percentComplete?Math.min(100,Math.max(0,100*this.props.percentComplete)):void 0,g=n(c,{theme:u,className:o,barHeight:t,indeterminate:void 0===f});return a.createElement("div",{className:g.root},s?a.createElement("div",{id:this._labelId,className:g.itemName},s):null,d?null:p(r.__assign(r.__assign({},this.props),{percentComplete:f}),this._onRenderProgress),l?a.createElement("div",{id:this._descriptionId,className:g.itemDescription},l):null)},t.defaultProps={label:"",description:"",width:180},t}(a.Component);t.ProgressIndicatorBase=i})),
define("@fluentui/react/lib/components/ProgressIndicator/ProgressIndicator.styles",["require","exports","tslib","@fluentui/react/lib/Styling","@fluentui/react/lib/Utilities"],(function(e,t,r,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStyles=void 0;var n={root:"ms-ProgressIndicator",itemName:"ms-ProgressIndicator-itemName",itemDescription:"ms-ProgressIndicator-itemDescription",itemProgress:"ms-ProgressIndicator-itemProgress",progressTrack:"ms-ProgressIndicator-progressTrack",progressBar:"ms-ProgressIndicator-progressBar"},i=(0,o.memoizeFunction)((function(){return(0,a.keyframes)({"0%":{left:"-30%"},"100%":{left:"100%"}})})),s=(0,o.memoizeFunction)((function(){return(0,a.keyframes)({"100%":{right:"-30%"},"0%":{right:"100%"}})}));t.getStyles=function(e){var t,l,c,u=(0,o.getRTL)(e.theme),d=e.className,m=e.indeterminate,p=e.theme,f=e.barHeight,g=void 0===f?2:f,b=p.palette,v=p.semanticColors,h=p.fonts,C=(0,a.getGlobalClassNames)(n,p),y=b.neutralLight;return{root:[C.root,h.medium,d],itemName:[C.itemName,a.noWrap,{color:v.bodyText,paddingTop:4,lineHeight:20}],itemDescription:[C.itemDescription,{color:v.bodySubtext,fontSize:h.small.fontSize,lineHeight:18}],itemProgress:[C.itemProgress,{position:"relative",overflow:"hidden",height:g,padding:"".concat(8,"px 0")}],progressTrack:[C.progressTrack,{position:"absolute",width:"100%",height:g,backgroundColor:y,selectors:(t={},t[a.HighContrastSelector]={borderBottom:"1px solid WindowText"},t)}],progressBar:[{backgroundColor:b.themePrimary,height:g,position:"absolute",transition:"width .3s ease",width:0,selectors:(l={},l[a.HighContrastSelector]=r.__assign({backgroundColor:"highlight"},(0,a.getHighContrastNoAdjustStyle)()),l)},m?{position:"absolute",minWidth:"33%",background:"linear-gradient(to right, ".concat(y," 0%, ")+"".concat(b.themePrimary," 50%, ").concat(y," 100%)"),animation:"".concat(u?s():i()," 3s infinite"),selectors:(c={},c[a.HighContrastSelector]={background:"highlight"},c)}:{transition:"width .15s linear"},C.progressBar]}}})),
define("@fluentui/react/lib/components/ProgressIndicator/ProgressIndicator",["require","exports","@fluentui/react/lib/Utilities","@fluentui/react/lib/components/ProgressIndicator/ProgressIndicator.base","@fluentui/react/lib/components/ProgressIndicator/ProgressIndicator.styles"],(function(e,t,r,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressIndicator=void 0,t.ProgressIndicator=(0,r.styled)(a.ProgressIndicatorBase,o.getStyles,void 0,{scope:"ProgressIndicator"})})),
define("@fluentui/react/lib/components/ProgressIndicator/ProgressIndicator.types",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})})),
define("@fluentui/react/lib/components/ProgressIndicator/index",["require","exports","tslib","@fluentui/react/lib/components/ProgressIndicator/ProgressIndicator","@fluentui/react/lib/components/ProgressIndicator/ProgressIndicator.base","@fluentui/react/lib/components/ProgressIndicator/ProgressIndicator.types"],(function(e,t,r,a,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(a,t),r.__exportStar(o,t),r.__exportStar(n,t)})),
define("@fluentui/react/lib/ProgressIndicator",["require","exports","tslib","@fluentui/react/lib/components/ProgressIndicator/index"],(function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.__exportStar(a,t)})),
define("@microsoft/azureportal-reactview/Css",["require","exports"],(function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.CSSClasses=void 0,function(e){e.NoDefaultPadding="reactview-nodefaultpadding",e.FullRootHeight="reactview-fullheight",e.NestedResource="reactview-nestedresource",e.InlineIcon="reactview-inlineicon",e.FormLabel="reactview-form-layout-label",e.FormElement="reactview-form-element",e.FormWidth="reactview-form-width",e.Padding="reactview-padding",e.NoPrint="reactview-noprint",e.FormLayoutWidth="reactview-form-layout-width",e.FormLayoutElement="reactview-form-layout-element"}(r||(t.CSSClasses=r={}))})),
define("@microsoft/azureportal-reactview/internal/ContextUtilities",["require","exports","react"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createContext=function(e,t){const a=r.createContext(e);return a.displayName=t,a}})),
define("@microsoft/azureportal-reactview/internal/Creapi",["require","exports","@microsoft/azureportal-reactview/internal/DynamicReact","@microsoft/azureportal-reactview/Az","@microsoft/azureportal-reactview/internal/ContextUtilities","lodash","_oss/@hookstate/core"],(function(e,t,r,a,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomizationState=void 0,t.createNode=function(e){return C(e,{},void 0,[],void 0,{})},t.getNodeType=function(e){if(r.default.isValidElement(e)&&e.type===g)return e.props.metadata.type;return},t.localStateSelector=function(e,t){return t},t.useCustomizationState=function(e){const{state:t}=r.default.useContext(u),a=(0,i.useHookstate)(t.nested(s.Customizations).nested(e));return a.get()?.state},t.useId=v,t.useDiagnostics=function(){const e=v();return{trace:t=>{(0,a.trace)(t.map((t=>({...t,source:e,timestamp:t.timestamp??Date.now()}))))},log:t=>{(0,a.log)(t.map((t=>({...t,area:e,timestamp:t.timestamp??Date.now()}))))}}},t.useTriggerCustomizer=function(e){const{state:t}=r.default.useContext(u),a=(0,i.useHookstate)(t.nested(s.Customizations).nested(e));return()=>{a.get()&&a.merge({bypassOnChange:!0})}};const s={Customizations:"customizations",Value:"value"},l=Symbol("internals"),c=(0,o.createContext)(void 0,"CreapiRootContext"),u=(0,o.createContext)({id:"",state:null},"CreapiComponentContext"),d=e=>{const{children:t,id:a,state:o}=e,n=r.default.useMemo((()=>({id:a,state:o})),[a,o]);return r.default.createElement(u.Provider,{value:n},t)},m=e=>{const{children:t,onChange:a}=e,o=r.default.useMemo((()=>({onChange:a})),[a]);return r.default.createElement(c.Provider,{value:o},t)},p=(e,t,r,a,o,n,i)=>{if(Array.isArray(t))r[e]=t.reduce(((t,r)=>{if(function(e){return"staticValue"in e}(r))return t.concat(r.staticValue);const s=_(r,a.nested(e),o,n.get(),i.get().value);return t.concat(s)}),[]);else{const s=_(t,a.nested(e),o,n.get(),i.get().value);void 0!==s&&(r[e]=s)}},f=(e,t,a,o,n,i)=>{const s=e=>(t,r)=>{n.merge({value:r}),a?.(i.get()),e?.(t,r),o(!0)};if(t){const t=e.onChange;e.onChange=r.default.useCallback(s(t),[a,t])}else{const t=e.props.onChange;e.props.onChange=r.default.useCallback(s(t),[a,t])}},g=e=>{const t=e.metadata,a=(0,i.useHookstate)(e.subState),o=(0,i.useHookstate)(e.globalState),n=((e,t,a,o,n)=>{const[l,u]=r.default.useState(!1),{onChange:d}=r.default.useContext(c),m=(0,i.useHookstate)(o.nested(s.Customizations)),g={...e.static,props:{}};return Object.entries(e.dynamic).forEach((([e,t])=>{p(e,t,g,m,l,n,o)})),Object.entries(t).forEach((([e,t])=>{g[e]={...t.static},Object.entries(t.dynamic).forEach((([t,r])=>{p(t,r,g[e],m.nested(e),l,n,o)}))})),f(g,a,d,u,o,n),g})(t.props,t.nestedProps,t.root,a,o),l=r.default.useMemo((()=>t.children.map((t=>r.default.createElement(g,{key:t.id,metadata:t,subState:a.nested(t.id),globalState:e.globalState})))),[t,e.globalState,a]);return r.default.createElement(r.default.Fragment,null,r.default.createElement(d,{id:t.parentId?`${t.parentId}.${t.id}`:t.id,state:a},l.length?r.default.createElement(t.component,{...n},l):r.default.createElement(t.component,{...n})))};var b;function v(){const{id:e}=r.default.useContext(u);return e}function h(e,t,o,c,u,d,p,f,b,v,C,S){return{add:(0,n.merge)({},...Object.entries(e).map((([r,a])=>({[r]:(i,m)=>{const g=P(i,o.join("."),a.wrapper(m??a.defaultComponent),r);u.children.push(g),(0,n.set)(t,[...o,i],Object.keys(a.childNodes).length>0?{}:{[s.Value]:null,[s.Customizations]:{}}),a.singleton&&delete e[r];const x=F(e,o,d,p,f,u,v,S);return o.length&&(0,n.set)(b,[p,...o,l],x),C[[...o,i].join(".")]={type:r,componentName:m?m.displayName||m.name||"unknown":"default",customizations:{}},h(a.childNodes,t,[...o,i],c,g,{},r,y(f,r,x),b,a.skipCustomizer,C,a.customizerOptions)}})))),customize:x(e,t,o,c,u,d,p,f,b,v,C,S),seal:(0,n.merge)({},...Object.entries(f).map((([s,y])=>({[s]:y?()=>{const r=F(e,o,d,p,f,u,v,S);return o.length&&(0,n.set)(b,[p,...o,l],r),h(y.childNodes,t,y.ids,c,y.currentComponent,y.currentState,y.currentNodeId,y.seals,b,y.skipCustomizerTillOnChange,C,y.customizerOptions)}:()=>{const e=(0,i.hookstate)(t);return({onChange:t,...o})=>(r.default.useEffect((()=>{(0,a.trace)([{action:"BuilderLoad",source:"Creapi",timestamp:Date.now(),data:{type:s,components:C}}])}),[]),r.default.useEffect((()=>{e.nested("props").merge(o)}),[o]),r.default.createElement(m,{onChange:t},r.default.createElement(g,{key:c.id,metadata:c,subState:e,globalState:e})))}})))),unseal:I(b,t,c,C),define:{prop:(r,a)=>((0,n.set)(t,["props",r],a),h(e,t,o,c,u,d,p,f,b,v,C,S))}}}function C(e,t,r,a,o,i){return{add:{child:(n,s)=>C(e,y(t,n.id,{...n,singleton:s}),r,a,o,i)},register:{wrapper:(r,a,n)=>C(e,t,r,a??[],o,n??{}),defaultComponent:o=>C(e,t,r,a,o,i)},seal:()=>({id:e,childNodes:t,wrapper:r,skipCustomizer:a,defaultComponent:o,customizerOptions:i}),toBuilder:()=>()=>{const a=P(e,"",r(void 0),e,!0);return h((0,n.cloneDeep)(t),{},[],a,a,{},e,y({},e,void 0),{},[],{"":{type:e,componentName:"default",customizations:{}}},i)}}}function y(e,t,r){return{...e,[t]:r}}function x(e,t,r,a,o,i,l,c,u,d,m,p){const f=g=>({get(b,v){if(!g&&("props"===v||v.endsWith("Props")))return new Proxy({},f(v));const C=function(e,t,r){return[...e,s.Customizations,...r?[r]:[],t]}(r,v,g),y=E(v,g);return{static:s=>(w(o,g).static[v]=s,(0,n.set)(t,C,{value:s,state:2}),m[r.join(".")].customizations[y]={type:"static"},h(e,t,r,a,o,i,l,c,u,d,m,p)),dynamic:(s,f,b)=>{const x=(0,n.get)(t,C),S=w(o,g).dynamic,I={selector:s,execFn:f,initialValue:b,skipTillOnChange:d.includes(v),deferredTime:p[v]?.deferredTime};if(x){const e=S[v];S[v]=e?Array.isArray(e)?[...e,I]:[e,I]:[{staticValue:x.value},I],b?x.value=Array.isArray(x.value)?x.value.concat(b):[x.value].concat(b):x.state=0}else S[v]=I,(0,n.set)(t,C,b?{value:b,state:2}:{value:void 0,state:0});return m[r.join(".")].customizations[y]={type:"dynamic"},h(e,t,r,a,o,i,l,c,u,d,m,p)}}}});return new Proxy({},f())}function S(e,t,r,a,o,n){return new Proxy({},{get(i,s){if(s in e){const i=e[s],c=i[l];return c?()=>h(c.childNodes,t,c.ids,r,c.currentComponent,c.currentState,c.currentNodeId,c.seals,a,c.skipCustomizerTillOnChange,o,c.customizerOptions):S(i,t,r,a,o,E(s,n))}throw new Error(`Could not find ${E(s,n)} node to unseal.`)}})}function I(e,t,r,a){return new Proxy({},{get(o,n){if(n in e)return S(e[n],t,r,e,a);throw new Error(`Could not find ${n} node level to unseal. Available node levels for unseal: ${Object.keys(e).join(", ")}.`)}})}function E(e,t){return t?`${t}.${e}`:e}function P(e,t,r,a,o){return{id:e,parentId:t,component:r,type:a,children:[],props:{static:{},dynamic:{}},nestedProps:{},root:o}}function F(e,t,r,a,o,n,i,s){return{childNodes:e,ids:t,currentState:r,currentNodeId:a,seals:o,currentComponent:n,skipCustomizerTillOnChange:i,customizerOptions:s}}function w(e,t){return t?e.nestedProps[t]??={static:{},dynamic:{}}:e.props}function _(e,t,a,o,i){const[s,l]=r.default.useState(e.initialValue),c=t.nested("bypassOnChange").get(),u=e.selector(o,i),d=(0,n.isPlainObject)(u)?Object.values(u):[u];return r.default.useEffect((()=>{let r,o=!0;if(!e.skipTillOnChange||a||c){t.merge({state:1});const a=async()=>{const r=await e.execFn(u);o&&(l((()=>r)),t.merge({value:r,state:2}))};e.deferredTime?r=setTimeout(a,e.deferredTime):a()}return()=>{o=!1,r&&clearTimeout(r)}}),e.skipTillOnChange?[...d,a,c]:d),s}!function(e){e[e.Pending=0]="Pending",e[e.Running=1]="Running",e[e.Done=2]="Done"}(b||(t.CustomizationState=b={}))})),
define("@microsoft/azureportal-reactview/internal/FormLabel",["require","exports","react","@microsoft/azureportal-reactview/internal/ContextUtilities"],(function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormLabelUIContext=void 0,t.useFormLabelUIContext=function(){return r.useContext(t.FormLabelUIContext)},t.FormLabelUIContext=(0,a.createContext)(null,"FormLabelUIContext")})),
define("@microsoft/azureportal-reactview/internal/FormLabelValidationContextType",["require","exports","react"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormLabelValidationContext=void 0,t.FormLabelValidationContext=r.createContext(null)})),
define("@microsoft/azureportal-reactview/internal/FormTelemetry",["require","exports","@microsoft/azureportal-reactview/internal/ContextUtilities"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormTelemetryContext=void 0,t.FormTelemetryContext=(0,r.createContext)(null,"FormTelemetryContext")})),
define("@microsoft/azureportal-reactview/internal/SharedFormContext",["require","exports","@microsoft/azureportal-reactview/internal/ContextUtilities","@microsoft/azureportal-reactview/internal/ReactView"],(function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormStateExtractor=t.FormStepContext=void 0,t.FormStepContext=(0,r.createContext)(null,"FormStepContext");class o{constructor(){this._initialize(),a.ReactView.getInstance().onDispose((()=>{this._initialize()}))}static getInstance(){return o._instance||(o._instance=new o),o._instance}registerStatusBarError(e){this._formState.statusBarError=e}registerFormScopeState(e,t){this._formState.scope=e,this._formState.valueMapping=t}registerFormLabelState(e,t){this._formState.labelsGetMetadata[e]=t}registerStepState(e){this._formState.formTabMetadata=e}getFormState(){const e=this._getBladeInfo(),t=this._formState.formTabMetadata,r=this._getAllVisibleFormFieldsForCurrentTab();return{bladeInfo:e.bladeInfo,scope:e.scope,allTabs:t,allFormLabels:r}}_initialize(){this._formState={statusBarError:void 0,scope:void 0,formTabMetadata:[],labelsGetMetadata:{},valueMapping:{}}}_getAllVisibleFormFieldsForCurrentTab(){const e=[];return Object.getOwnPropertyNames(this._formState.labelsGetMetadata).forEach((t=>{const r=this._formState.labelsGetMetadata[t]();if(r.pivotIsActive){const a=r.metadata,o=this._formState.valueMapping[a.formLabelProps.displayValue],n=o&&a.value&&"object"==typeof a.value?a.value[o]:a.value;e.push({labelId:t,...a,value:n})}})),e}_getBladeInfo(){const e=this._formState.scope,t=document.getElementById("__bladeTitleMain"),r=t&&t.textContent,a=document.getElementById("__bladeSubtitle");return{bladeInfo:{title:r,subTitle:a&&a.textContent,statusBarError:this._formState.statusBarError},scope:e}}}t.FormStateExtractor=o})),
define("@microsoft/azureportal-reactview/FormLabel",["require","exports","react","@fluentui/react/lib/Label","@fluentui/react/lib/Stack","@microsoft/azureportal-reactview/Css","@fluentui/react/lib/Icon","@fluentui/react/lib/Styling","@fluentui/react/lib/Utilities","@microsoft/azureportal-reactview/internal/ErrorBoundary","@fluentui/react-hooks/lib/useId","lodash","@microsoft/azureportal-reactview/internal/FormLabel","@microsoft/azureportal-reactview/internal/SharedFormContext","@fluentui/react/lib/ProgressIndicator","@fluentui/react/lib/Text","FxInternal/Resources/ReactComponents","@microsoft/azureportal-reactview/Az","@fluentui/react/lib/Callout","@microsoft/azureportal-reactview/internal/FormLabelValidationContextType","@microsoft/azureportal-reactview/internal/ContextUtilities","@microsoft/azureportal-reactview/internal/FormTelemetry","@microsoft/azureportal-reactview/internal/Creapi","@fluentui/react/lib/utilities/ThemeProvider/useTheme"],(function(e,t,r,a,o,n,i,s,l,c,u,d,m,p,f,g,b,v,h,C,y,x,S,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withFormLabelAndValidation=t.FormLabel=t.RealFormLabel=t.ValidationAggregator=t.useValidationEffect=t.useFormLabelContext=t.ValidationState=void 0;const E=(0,s.mergeStyleSets)({formLabel:{maxWidth:"calc(100% - 13px)",display:"inline"},formContainerInfoIcon:{cursor:"pointer",verticalAlign:"middle",paddingLeft:"5px"},validationWrapper:{fontSize:"14px"},callout:{padding:"12px",maxWidth:"480px"}}),P={flex:"initial",maxWidth:"250px",minWidth:"250px",width:"100%"},F={flex:"initial",maxWidth:"207px",width:"100%"},w={itemProgress:{paddingTop:"4px",paddingBottom:"10px"},progressBar:{height:"2px"},progressTrack:{height:"2px"}},_={padding:"0px 0px 15px 0px"},T={calloutMain:{fontSize:"12px",fontWeight:400}},V={display:"inline"},k={minHeight:"16px"},z={root:{paddingBottom:"16px"}},L={childrenGap:8},M={childrenGap:4},N=(0,y.createContext)({ariaLabelledBy:"",ariaRequired:!1,setIsFormDisabled:()=>{},setIsTooltipIconTabbable:()=>{},isEmptyContext:!0},"FormLabelContext"),O=(0,y.createContext)(null,"FormLabelValidationGlobalContext"),j=({loading:e,validationErrors:t,validationRunning:a,validationErrorMessageId:n})=>{const l=(0,I.useTheme)(),c=r.useMemo((()=>(e=>(0,s.mergeStyleSets)({validationImage:{color:e.semanticColors.errorIcon,fontSize:"16px",verticalAlign:"middle"},validationText:{color:e.semanticColors.errorText,verticalAlign:"middle"}}))(l)),[l]);return r.createElement("div",{style:k},a||e?r.createElement(f.ProgressIndicator,{styles:w}):r.createElement(r.Fragment,null),!a&&t.length?r.createElement(o.Stack,{styles:z},t.map(((e,t)=>r.createElement(o.Stack.Item,{key:`error-${t}`,id:`${n}-${t}`,className:"validationErrorMessage"},r.createElement(o.Stack,{className:E.validationWrapper,horizontal:!0,tokens:L},r.createElement(o.Stack.Item,null,r.createElement(i.FontIcon,{iconName:"StatusErrorFull",className:c.validationImage})),r.createElement(o.Stack.Item,{id:n},"string"==typeof e.message?r.createElement(g.Text,{className:c.validationText,role:"alert"},e.message):e.message)))))):r.createElement(r.Fragment,null))},R=e=>{const{children:t,enableValidation:a,forceTriggerValidation:n,labelId:i,onErrorsUpdate:s,onValidationStateChange:l,pendingValidation:c,required:d,runningValidation:p,setErrorMessageIds:f,setIsTooltipIconTabbable:g,sublabel:h,validations:y}=e,[I,E]=r.useState(!1),[P,F]=r.useState(null),w=r.useContext(x.FormTelemetryContext),_=(0,u.useId)("errorMessage"),T=(0,S.useId)().split(".").pop(),{errors:V,validationContextValue:k,validationState:z}=function(e,t,a,o,n,i){const s=r.useContext(O),[l,c]=r.useState(!1),[u,d]=r.useState([]),[m,p]=r.useState(0),[f,g]=r.useState(new Map),[h,C]=r.useState(0),y=r.useContext(x.FormTelemetryContext),S=a?1:h,I=!l&&!(!t&&!s?.forceTriggerValidation),E=r.useCallback(((e,t)=>g((r=>{const a=new Map(r);return a.set(e,t),a}))),[g]),P=r.useCallback((()=>p((e=>e+1))),[p]),F=r.useMemo((()=>({addValidation:E,isDirty:l,setIsDirty:c,forceTriggerValidation:I,validationEffectInit:P})),[E,l,c,I,P]);return r.useEffect((()=>()=>s?.cleanup(e)),[]),r.useEffect((()=>{let e=!0;return(l||I)&&(C(1),Promise.allSettled([].concat(...Array.from(f.values()))).then((t=>{if(e){const e=n?Array.isArray(n)?n.filter((e=>3===e.state)):3===n.state?[n]:[]:[];t.forEach((t=>{"fulfilled"===t.status&&3===t.value.state&&e.push(t.value),"rejected"===t.status&&(v.log([{level:2,area:"ReactViews.FormLabel",entryType:"ValidationUnhandledPromiseRejection",message:"Unhandled promise rejection caused validation to fail",timestamp:Date.now(),args:[t.reason]}]),e.push({state:3,message:b.FormLabel.validationFailed}))})),d(e),e.length?C(3):f.size!==m||o||C(2)}}))),()=>{e=!1}}),[f,n,l,I]),r.useEffect((()=>{s?.notifyValidationStateToGlobal(e,S),y&&1!==S&&0!==S&&y.setStepValidationInfo(i,e,S)}),[S]),{errors:u,validationContextValue:F,validationState:S}}(i,n,p,c,y,T),L=r.useMemo((()=>({ariaLabelledBy:i,ariaRequired:d,setIsFormDisabled:g,setIsTooltipIconTabbable:g,isEmptyContext:!1})),[i,d,g]),R=r.useMemo((()=>({setLoading:E,setSublabel:F})),[]);r.useEffect((()=>{w&&w.registerCompositeIds(T,i)}),[]),r.useEffect((()=>{s?.(i,V)}),[V]),r.useEffect((()=>{w&&w.setTerminalValidationState(T,i,z),l?.(z)}),[z]),r.useEffect((()=>{f(V.map(((e,t)=>`${_}-${t}`)).join(" "))}),[V.length]);const A=r.Children.map(t,(e=>r.isValidElement(e)?r.cloneElement(e,{"aria-describedby":_,"aria-invalid":V.length>0}):e));return r.createElement(o.Stack,{tokens:M},r.createElement(o.Stack.Item,{key:"formlabelContent"},r.createElement(N.Provider,{value:L},r.createElement(m.FormLabelUIContext.Provider,{value:R},r.createElement(C.FormLabelValidationContext.Provider,{value:k},A)))),r.createElement(o.Stack.Item,{key:"formlabelSublabel"},h),r.createElement(o.Stack.Item,{key:"formlabelSublabelViaContext"},P),a?r.createElement(o.Stack.Item,{key:"formlabelValidations"},r.createElement(j,{loading:I,validationErrors:V,validationRunning:1===z,validationErrorMessageId:_})):r.createElement(r.Fragment,null))},A=e=>{const[t,c]=r.useState(!1),[m,p]=r.useState(!1),f=(0,u.useId)("label"),g=(0,u.useId)("icon"),[v,C]=r.useState(!1),[y,x]=r.useState(""),S={width:"inherit !important",maxWidth:e.stackVertical?"100%":"calc(100% - 250px)",minWidth:"250px",flex:"auto"},I=t=>{"F1"===t.key&&e.tooltip&&(t.preventDefault(),p(!m))},w=r.useMemo((()=>(0,d.merge)({root:{padding:e.displayValue?"5px 0px":"",...e.nested?F:P}},e.labelContainerStyles)),[e.labelContainerStyles,e.nested,e.displayValue]);r.useEffect((()=>{let e=!0;return setTimeout((()=>{e&&p(v)}),500),()=>{e=!1}}),[v]);const k=r.useCallback((()=>C(!0)),[]),z=r.useCallback((()=>C(!1)),[]),L=r.useMemo((()=>(0,d.merge)({root:{"::after":{paddingRight:"0px"}}},e.styles)),[e.styles]),M=r.useMemo((()=>({...e.formLabelContainerStyle??{},flexFlow:"wrap "+(e.stackVertical?"column":"row")})),[e.formLabelContainerStyle,e.stackVertical]),N=r.createElement(R,{enableValidation:e.enableValidation,forceTriggerValidation:e.forceTriggerValidation,labelId:f,onErrorsUpdate:e.onErrorsUpdate,onValidationStateChange:e.onValidationStateChange,required:e.required,runningValidation:e.runningValidation,pendingValidation:e.pendingValidation,setErrorMessageIds:x,setIsTooltipIconTabbable:c,sublabel:e.sublabel,validations:e.validations},e.children);return r.createElement(r.Fragment,null,e.hideLabel?N:r.createElement(o.Stack,{tokens:e.addVerticalPadding&&_,onKeyDown:I,style:M},e.nested&&r.createElement("i",{className:n.CSSClasses.NestedResource}),r.createElement(o.Stack.Item,{styles:w,style:e.labelContainerStyle},r.createElement(a.Label,{...e,id:f,"aria-label":e.ariaLabel??e.displayValue,"aria-describedby":y,styles:L,className:(0,s.mergeStyles)(E.formLabel,e.className)},e.displayValue),e.tooltip&&r.createElement("div",{id:g,style:V},r.createElement(i.Icon,{tabIndex:t?0:-1,"aria-label":t?(0,l.format)(b.FormLabel.labelInfoIndicator,e.displayValue):void 0,iconName:"Info",className:E.formContainerInfoIcon,onMouseEnter:k,onMouseLeave:z})),m&&r.createElement(h.Callout,{styles:T,onKeyDown:I,className:E.callout,target:`#${g}`,onDismiss:()=>p(!1),role:"alert",directionalHint:h.DirectionalHint.topAutoEdge,setInitialFocus:!0,onMouseEnter:k,onMouseLeave:z},e.tooltip)),r.createElement(o.Stack.Item,{styles:(0,d.merge)({root:S},e.formContainerStyles),align:e.stackVertical?void 0:"center",style:e.formContainerStyle},N)))};var B;!function(e){e[e.Unset=0]="Unset",e[e.Running=1]="Running",e[e.Success=2]="Success",e[e.Error=3]="Error"}(B||(t.ValidationState=B={}));t.useFormLabelContext=e=>{const t=r.useContext(N);return t.isEmptyContext&&!e&&console.error("useFormLabelAria called incorrectly. No context was provided. Is this being called correctly by a child of FormLabel? If this error does not apply, use the ignoreError argument."),t};t.useValidationEffect=(e,t)=>{const a=(0,u.useId)("validation"),o=r.useContext(C.FormLabelValidationContext);if(o){const{addValidation:n,isDirty:i,forceTriggerValidation:s,validationEffectInit:l}=o;r.useEffect((()=>{l()}),[]),r.useEffect((()=>{if(i||s){const t=setTimeout((()=>(()=>{const t=e();n(a,Array.isArray(t)?t:[t])})()),500);return()=>clearTimeout(t)}}),[...t,i,s])}};t.ValidationAggregator=e=>{const[t,a]=r.useState(new Map),o=(0,u.useId)("validationAggregator"),n=r.useContext(O),i=n?.notifyValidationStateToGlobal,s=r.useCallback(((e,t)=>a((r=>new Map(r).set(e,t)))),[a]),l=r.useCallback((e=>a((t=>{const r=new Map(t);return r.delete(e),r}))),[]),c=r.useMemo((()=>{const e=Array.from(t.values());return e.some((e=>1===e))?1:e.some((e=>3===e))?3:e.some((e=>0===e))?0:2}),[t]);r.useEffect((()=>()=>n?.cleanup(o)),[]),r.useEffect((()=>{e.onChange(c),i?.(o,c)}),[o,c,e.onChange,i]);const d=r.useMemo((()=>({cleanup:l,forceTriggerValidation:e.forceTriggerValidation||n?.forceTriggerValidation,notifyValidationStateToGlobal:s})),[l,s,e.forceTriggerValidation,n?.forceTriggerValidation]);return r.createElement(O.Provider,{value:d},e.children)};t.RealFormLabel=e=>r.createElement(A,{...e}),t.FormLabel=(0,c.withErrorBoundary)(t.RealFormLabel,"FormLabel");t.withFormLabelAndValidation=e=>{const a=a=>{const{ariaLabelledBy:o,ariaRequired:n}=(0,t.useFormLabelContext)(),{setIsDirty:i}=r.useContext(C.FormLabelValidationContext),s=r.useCallback(((...e)=>{i(!0),a.onChange&&a.onChange(...e)}),[i,a.onChange]);return r.createElement(e,{...a,"aria-labelledby":o,"aria-required":n,onChange:s})};return e=>{const{formLabelProps:t,...o}=e,n=r.useRef(void 0),i=r.useRef(void 0),s=r.useRef(void 0),l=r.useCallback(((...t)=>{e.onChange?.(...t),n.current=t[1]}),[e.onChange]),c=r.useCallback(((e,t)=>{i.current=e,s.current=t}),[]),u=r.useContext(p.FormStepContext),d=u?.isActive?.();return r.useEffect((()=>{p.FormStateExtractor.getInstance().registerFormLabelState(i.current,(()=>{const t=s.current&&s.current.filter((e=>"string"==typeof e.message)).map((e=>e.message));return{pivotIsActive:d,metadata:{labelId:i.current,formLabelProps:e.formLabelProps,componentProps:o,value:n.current,errors:t}}}))})),r.createElement(A,{...e.formLabelProps,disabled:e.disabled,enableValidation:!0,onErrorsUpdate:c},r.createElement(a,{...o,onChange:l}))}}}));