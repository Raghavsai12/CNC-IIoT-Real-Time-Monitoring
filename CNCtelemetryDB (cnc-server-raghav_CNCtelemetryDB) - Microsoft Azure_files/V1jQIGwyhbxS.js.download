define("MsPortalImpl.Controls/Controls/Base/WidgetBinding",["require","exports"],(function(e,t){"use strict";t.chainDisabledProperties=c,t.chainEnabledTabIndexProperties=d,t.contextFor=function(e){let t=n(e);t||(t=r(null));s(t.$disabled)&&(t=t.extend({$disabled:ko.pureComputed(MsPortalFx.wrap(!1))}));s(t.$tabIndex)&&(t=t.extend({$tabIndex:ko.pureComputed(MsPortalFx.wrap(0))}));s(t.$enabledTabIndex)&&(t=t.extend({$enabledTabIndex:ko.pureComputed(MsPortalFx.wrap(0))}));return t},t.createChainedContext=l,t.createChildContext=a,t.createIsolatedContext=function(e,t){return r(e).extend({$dicontainer:t.$dicontainer,$disabled:t.$disabled,$enabledTabIndex:t.$enabledTabIndex,$extensionName:t.$extensionName,$partName:t.$partName,$tabIndex:t.$tabIndex})},t.getContext=n,t.makeTabIndexProperty=p;var s=MsPortalFx.isUndefined;function i(e,t){let i;return s(e)||(i=ko.unwrap(e)),s(i)?t:i}function o(e,t){const s=c([e.$disabled,t.$disabled]),i=d([e.$enabledTabIndex,t.$enabledTabIndex]);return{$disabled:s,$enabledTabIndex:i,$tabIndex:p(i,s)}}function n(e){return ko.contextFor($(e)[0])}function r(e){return new ko.bindingContext(e)}function a(e,t,s,i){let o=i||n(e);return o=o?o.createChildContext(t):r(t),s&&(o=o.extend(s)),o}function l(e,t){const s=o(e,t);return e.extend(s)}function c(e){return ko.pureComputed((()=>{let t=!1;for(let s=0;s<e.length;s++){const o=i(e[s],!1);t=t||o}return t}))}function d(e){return ko.pureComputed((()=>{let t=0;for(let s=0;s<e.length;s++){const o=i(e[s],0);null===t||null===o?t=null:t<0||(t=o)}return t}))}function p(e,t){return ko.pureComputed((()=>t()?-1:e()))}ko.bindingHandlers.context={init:function(e,t,s,i,n){const r=t(),l=o(n,{$disabled:r.$disabled,$enabledTabIndex:r.$tabIndex});r.$dicontainer&&(l.$dicontainer=r.$dicontainer);const c=a(e,i,l,n);return ko.applyBindingsToDescendants(c,e),{controlsDescendantBindings:!0}}},ko.virtualElements.allowedBindings.context=!0;const u=ko.bindingHandlers.template;ko.bindingHandlers.template={init:function(e,t,s,i,o){return u.init(e,t,s,i,o)},update:function(e,t,s,i,o){const n=t();let r=ko.unwrap(n);r="string"==typeof r?{name:n}:ko.utils.extend({},r);let a=r.context;a&&(o=ko.ignoreDependencies((()=>("function"==typeof a&&(a=a(r.data||i)),l(o,{$disabled:a.$disabled,$enabledTabIndex:a.$tabIndex})))),delete r.context);const c=o.$ctl,d=c&&c.templateEngine;return d&&r.name&&!r.templateEngine&&(r.templateEngine=d),t=()=>r,u.update(e,t,s,i,o)}}})),
define("MsPortalImpl/Base/Base.ElementWidgetMap",["require","exports"],(function(e,t){"use strict";t.getAll=function(e){const t=e&&s.get(e);return t&&t.slice()},t.getAllMatch=function(e,t){if(e){const i=s.get(e);return i&&i.filter((e=>e instanceof t))}},t.remove=function(e,t){if(e&&t){let i=s.get(e);i&&(i=i.filter((e=>e!==t)),i.length>0?s.set(e,i):s.delete(e))}},t.set=function(e,t){if(e&&t){const i=s.get(e);i?i.push(t):s.set(e,[t])}};const s=new WeakMap})),
define("MsPortalImpl/Extension/CachedManifestClient",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";t.CachedManifestClient=void 0;var i=MsPortalFx.Base;const o=i.Diagnostics.createLog(e);class n{constructor(e,t){this.getManifests=t=>{const s="assetTypes"===t?Promise.resolve(e):function(e){return Promise.resolve(MsPortalEarly.getCachedManifestUri(e)).then((e=>e?i.Net2.ajax({uri:e,performRetry:!0,type:"GET",dataType:"json",contentType:"application/json",useRawAjax:!0}).catch((e=>(o.error(e),null))):{manifest:{}}))}(t);return s.then((e=>e.manifest||{}))},this.getMetadata=()=>t}static create(){return Promise.all([MsPortalEarly.manifestCachePromise,MsPortalEarly.getBootEnvironment()]).then((([e,t])=>{const s={},i=t.extensionsPageVersion;return Object.keys(i).forEach((t=>{const o=e.manifest[t]||{},n=MsPortalEarly.pickExtensionStamp(i[t]).split("/");o.pageVersion=n[0],o.prewarmerScript=n[1]&&[n[1],null],s[t]=o})),new n({manifest:s},e.metadata)})).catch((e=>{throw MsPortalEarly.navigateError("NoExtensions",[["stack",encodeURIComponent(e?.stack).slice(0,1e3)]]),e}))}}t.CachedManifestClient=n,__decorate([__metadata("fx:diagnostics",[e,"CachedManifestClient"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],n,"create",null)})),
define("MsPortalImpl/Extension/Extension.DefinitionValidator",["require","exports"],(function(e,t){"use strict";t.ValidationResult=void 0,t.validateBlade=a,t.validateDefinition=function(e,t){t=t||[],e?i(e,((s,l)=>{switch(s){case"name":o("Extension name",l,t);break;case"version":case"hash":case"schemaVersion":case"sdkVersion":case"buildDescription":o(s,l,t);break;case"isPreview":n(s,l,t);break;case"assetTypes":r(s,l,t);break;case"blades":!function(e,t,s){t&&r("blades",t,s)&&t.forEach(((t,i)=>{a(e,t,i,s)}))}(e,l,t);break;case"startBoardParts":!function(e,t){r("startBoardParts",e,t)&&e.forEach(((e,s)=>{d("startBoardParts[{0}]".format(s),e,t)}))}(l,t);break;case"partsCatalog":!function(e,t){if(!e)return;r("partsCatalog",e,t)&&e.forEach((e=>{m(e,t)}))}(l,t);break;case"commandsCatalog":!function(e,t){if(!e)return;r("commandsCatalog",e,t)&&e.forEach((e=>{const s="Commands in 'commandsCatalog' ";e.name||t.push(`${s}must have names.`),e.reference&&t.push(`${s}cannot specify a 'reference' property.`)}))}(l,t);break;case"commandGroups":!function(e,t){if(!e)return;r("commandGroups",e,t)&&MsPortalFx.mapMany(e,(e=>e.commands)).forEach((e=>{e.reference&&function(e,t){if(!e||!e.reference)return;let s=!1;i(e,(e=>{"name"!==e&&"bindings"!==e&&"reference"!==e&&(s=!0)})),s?t.push("Command reference can only define 'name' and 'bindings' properties. Definition: {0}".format(ko.toJSON(e))):e.reference.commandType||t.push("Command reference must specify the 'commandType' property. Definition: {0}".format(ko.toJSON(e)))}(e,t)}))}(l,t);break;case"htmlTemplates":!function(e,t){i(e,((e,s)=>{"string"!=typeof s&&(o("htmlTemplates['{0}'].file".format(e),s.file,t),o("htmlTemplates['{0}'].content".format(e),s.content,t))}))}(l,t);break;case"styleSheets":!function(e,t){Array.isArray(e)?e.forEach(((e,s)=>{o("StyleSheet at position {0}".format(s),e,t)})):t.push("Invalid type for 'styleSheets' property on definition.")}(l,t);break;case"galleryService":case"bladeMap":case"partTypeMap":case"requireConfig":case"dashboardProvider":break;default:t.push("Unexpected attribute '{0}' on definition.".format(s))}})):t.push("Definition is null or undefined.");return!t.length},t.validateIsArray=r,t.validateIsBoolean=n,t.validateIsString=o,t.validatePartType=m;var s=MsPortalFx.Extension.SetRequirement;function i(e,t){MsPortalFx.forEachKey(e,((e,s)=>{void 0!==s&&t(e,s)}))}function o(e,t,s){"string"!=typeof t&&s.push("{0} is not a valid string.".format(e))}function n(e,t,s){"boolean"!=typeof t&&s.push("{0} is not a valid boolean.".format(e))}function r(e,t,s){const i=Array.isArray(t);return i||s.push("The '{0}' property is not a valid array.".format(e)),i}function a(e,t,s,i){const o=t.name;t.inputs&&r("Blade: {0}. Property: blades[{1}].inputs".format(o,s),t.inputs,i),t.optionalInputs&&r("Blade: {0}. Property: blades[{1}].optionalInputs".format(o,s),t.optionalInputs,i),r("Blade: {0}. Property: blades[{1}].lenses".format(o,s),t.lenses,i)&&t.lenses.forEach(((e,t)=>{const n="Blade: {0}. Lens: {1}. Property: blades[{2}].lenses[{3}].".format(o,e.name,s,t);e.partInstances&&r(n,e.partInstances,i)&&e.partInstances.forEach(((n,r)=>{d("Blade: {0}. Lens: {1}. Part: {2}. Property: blades[{3}].lenses[{4}].partInstances[{5}]".format(o,e.name,n.name,s,t,r),n,i)}))})),t.permissions&&r("Blade: {0}. Property: blades[{1}].permissions".format(o,s),t.permissions,i)&&t.permissions.forEach(((e,t)=>{c("Blade: {0}. Property: blades[{1}].permissions[{2}]".format(o,s,t),e,i)})),function(e,t,s){if(!e)return;e.source?l(e.source,t+".source",s):s.push("Source not specified for toolbar. "+t)}(t.toolbar,"Blade: {0}. Property: blades[{1}].toolbar".format(o,s),i),function(e,t,s){e&&e.source&&l(e.source,t+".source",s)}(t.actionBar,"Blade: {0}. Property: blades[{1}].actionBar".format(o,s),i)}function l(e,t,s){e.property&&o(t+".property",e.property,s),e.optional&&"boolean"!=typeof e.optional&&s.push("The attribute 'optional' should be of type boolean. "+t),e.isIdentityInput&&"boolean"!=typeof e.isIdentityInput&&s.push("The attribute 'isIdentityInput' should be of type boolean. "+t),r(t+".valuesFrom",e.valuesFrom,s)&&e.valuesFrom.forEach(((e,i)=>{!function(e,t,s){switch(t.referenceType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:break;default:s.push("Unknown reference type '{0}' found for {1}.referenceType.".format(t.referenceType,e))}o(e+".property",t.property,s),t.part&&o(e+".part",t.part,s)}(t+".valuesFrom[{0}]".format(i),e,s)}))}function c(e,t,i){switch(t.permissionType){case 0:{const s=t;s.extensionName&&o(e+".extensionName",s.extensionName,i),o(e+".assetType",s.assetType,i),s.assetId?function(e,t,s){switch(t.sourceType){case 0:t.providerKey&&s.push("Asset ID source source type of FromInput with provider key (should be null) found for {0}.sourceType.".format(e));break;case 1:t.providerKey||s.push("Asset ID source source type of FromProvider with missing provider key found for {0}.sourceType.".format(e)),o(e+".providerKey",t.providerKey,s);break;case 2:t.providerKey||s.push("Asset ID source source type of FromSourceProvider with missing provider key found for {0}.sourceType.".format(e)),o(e+".providerKey",t.providerKey,s);break;default:s.push("Unknown asset ID source source type '{0}' found for {1}.sourceType.".format(t.sourceType,e))}o(e+".property",t.property,s)}(e+".assetId",s.assetId,i):i.push("Permission missing assetId found for {0}.assetId.".format(e)),o(e+".action",s.action,i);break}case 1:{const o=t;switch(o.requirement){case s.All:case s.Any:break;default:i.push("Unknown permission set requirement '{0}' found for {1}.requirement.".format(o.requirement,e))}r(e+".permissions",o.permissions,i)&&o.permissions.forEach(((t,s)=>{c("{0}.permissions[{1}]".format(e,s),t,i)}));break}default:i.push("Unknown permission type '{0}' found for {1}.permissionType.".format(t.permissionType,e))}}function d(e,t,s){t.reference||t.inline?t.reference&&t.inline?s.push("'reference' and 'inline' properties cannot be set at the same time on PartInstanceDefinition. Property: {0}".format(e)):t.reference&&!t.reference.partTypeName?s.push("'partTypeName' property is required on part reference. Property: {0}".format(e)):t.inline&&p(e,t.inline,s):s.push("'reference' or 'inline' property required on PartInstanceDefinition. Property: {0}".format(e))}function p(e,t,s){t&&(!function(e,t,s){if(!t)return;const i=t.inputIdentityProperties||[],o=t.sharedProperties||[],n=i.concat(o.map((e=>e.property))),r=o.map((e=>e.key)),a=u(n),l=u(r);a&&a.length>0&&s.push("Part view model properties cannot be used in multiple part settings. Duplicated properties: '{0}'. Path: '{1}'.".format(JSON.stringify(a),e));l&&l.length>0&&s.push("Shared key settings cannot be used in multiple part settings. Duplicated keys: '{0}'. Path: '{1}'.".format(JSON.stringify(l),e))}(e,t.partState,s),t.permissions&&r("{0}.permissions".format(e),t.permissions,s)&&t.permissions.forEach(((t,i)=>{c("{0}.permissions[{1}]".format(e,i),t,s)})))}function u(e){const t={},s=[];return(e||[]).forEach((e=>{t[e]&&s.push(e),t[e]=!0})),s}function m(e,t){e.inputDefinitions&&r("PartType: {0}. Property: inputDefinitions".format(e.name),e.inputDefinitions,t),e.reference&&function(e,t){(e.reference.bindings||[]).forEach((s=>{(s.valuesFrom||[]).forEach((s=>{7!==s.referenceType&&9!==s.referenceType&&5!==s.referenceType&&t.push("Adapted Part: {0} can only have Adapter, AdapterInput and Constant bindings for its referenced part.".format(e.name))}))}))}(e,t),p("PartType: {0}".format(e.name),e,t)}t.ValidationResult=class{constructor(){this.errors=[]}valid(){return!this.errors.length}}})),
define("MsPortalImpl/Extension/ExtensionManagerOptions",["require","exports","FxInternal/AsyncLoader","Fx/DependencyInjection","MsPortalImpl/Extension/CachedManifestClient"],(function(e,t,s,i,o){"use strict";t.unregisterTestExtensions=t.registerTestExtensions=t.postBoot=t.listTestExtensions=t.getExtensionRegistration=t.getCatalogApiCacheContent=t.TestExtensionsSource=t.PostBootCache=t.ExtensionManagerOptions=void 0;const n=fx.environment,r=/\{0\}/g,a="feature.canmodifyextensions=true";function l(e,t,s){const i=!e.isEnabled("disableextensions"),o=[],a={};return t.forEach((t=>{if(a[t.name])return;a[t.name]=!0;const l=t.name.toLowerCase(),c=(/^[\w\-]+$/.exec(e.getValue(l)||"")||[""])[0];let d=c||i&&!(1&t.flags)&&!s.includes(t.name);if("false"===c&&(d=!1),d){const s="true"!==c&&"false"!==c?c:"",i=e.getValue(l+"_urlredirect"),a="string"==typeof i&&/^[a-z0-9]+$/i.test(i)?i:null,d=function(e){return void 0!==e.hostingServiceName}(t)?function(e,t,s){const i=s||e.hostingServiceName,o=16&e.flags?n.hostingServiceConfiguration.thirdParty:n.hostingServiceConfiguration.default,r=MsPortalEarly.formatHostingServiceEndpoints(o.uriFormat,{extName:i,stamp:t}),a=o.prewarmUriFormats.map((e=>MsPortalEarly.formatHostingServiceEndpoints(e,{extName:i}))),l=a.filter((e=>!MsPortalEarly.blockedHosts.includes(e.hostname))),c=l.length>0?l[0]:a[0],d=MsPortalEarly.formatHostingServiceEndpoints(o.uriFormat,{useEnvPrefix:!1,useEnvSuffix:!1,extName:i}).toString(),p=(o.baseDomains||[]).map((e=>MsPortalEarly.formatHostingServiceEndpoints(e,{extName:i,stamp:t}).toString())),u=!s&&!t;return{name:e.name,flags:e.flags,redirectTo:e.redirectTo,uri:r.toString(),prewarmUri:c.toString(),homePageUri:d,baseDomains:p,isTestExtension:!1,stamp:t,useBootProvidedVersion:u,isSideloaded:e.missingCachedManifest||!u,azBaseUri:e.azBaseUri,serviceTreeId:e.serviceTreeId}}(t,s,a):function(e,t){const s=t&&e.uriFormat?e.uriFormat.replace(r,t):e.uri,i=!e.isTestExtension&&!t;return{name:e.name,flags:0|e.flags,redirectTo:e.redirectTo,uri:s,prewarmUri:s,homePageUri:s,baseDomains:[],isTestExtension:e.isTestExtension,stamp:t,useBootProvidedVersion:i,isSideloaded:e.missingCachedManifest||!i,azBaseUri:e.azBaseUri,serviceTreeId:e.serviceTreeId,armResourceId:e.armResourceId}}(t,s);o.push(d)}})),o}class c{constructor(e){this.value=e}static create(e,t){const i=e.isEnabled("canmodifyextensions"),o=()=>t.getAsync(s.get("MsPortalImpl/Extension/ExtensionMetadataSource","ExtensionMetadataSource")),n=i&&t.getAsync(s.get("MsPortalImpl/Extension/ExtensionPatch","PatchMetadataSource")),r=i&&o().then((e=>e.getCodeComponentsMetadata()));return MsPortalImpl.Extension={registerTestExtension:(e,t)=>o().then((s=>s.registerTestExtension(e,t))),unregisterAll:()=>o().then((e=>e.unregisterAll())),listTestExtensions:()=>o().then((e=>e.listTestExtensions()))},Promise.all([r,n]).then((([e])=>new c(e||[])))}}t.TestExtensionsSource=c,__decorate([__metadata("fx:diagnostics",[e,"TestExtensionsSource"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[FxImpl.Features,i.Container]),__metadata("design:returntype",Promise)],c,"create",null);class d{constructor(e,t,s){this._normalizedNameMap={};const i=(e.getValue("disabledextensionredirects")||"").toLowerCase().split(","),o=l(e,t,s||[]),n=FxImpl.partition(o,(e=>e.redirectTo&&!i.includes(e.name.toLowerCase())));this.extensionRedirectMap=MsPortalFx.convertArrayToMap(n[0],(e=>e.name),(e=>e.redirectTo)),this.extensionsAsArray=n[1],this.extensionsAsMap=MsPortalFx.convertArrayToMap(this.extensionsAsArray,(e=>e.name)),this._normalizedNameMap=MsPortalFx.convertArrayToMap(o,(e=>e.name.toLowerCase()),(e=>e.name))}static create(e,t,s){return new d(t,e.value.concat(s.getMetadata()),fx.environment.disabledExtensions)}getNormalizedMetadata(e,t){const s=e?this._normalizedNameMap[e.toLowerCase()]:e;if(t&&!s)throw new Error(`The extension name '${e}' is not valid`);return s&&this.extensionsAsMap[this.resolveExtensionName(s)]}resolveExtensionName(e){return this.extensionRedirectMap[e]||e}}t.ExtensionManagerOptions=d,__decorate([__metadata("fx:diagnostics",[e,"ExtensionManagerOptions"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[c,FxImpl.Features,o.CachedManifestClient]),__metadata("design:returntype",d)],d,"create",null);let p=t.PostBootCache=class{constructor(){this._value={}}get(e){return this._getEntry(e).promise}set(e,t){const s=t.extensionEnvironment;this._getEntry(e).resolve({...t,extensionEnvironment:"string"==typeof s?JSON.parse(s):s||{}})}_getEntry(e){return this._value[e]||(this._value[e]=Promise.withResolvers())}};t.PostBootCache=p=__decorate([__metadata("fx:diagnostics",[e,"PostBootCache"]),i.Class()],p);t.getExtensionRegistration=s.defineHandler(FxImpl.Extension.getExtensionRegistrationEndPoint,(e=>{const t=e.diContainer.get(d).extensionsAsMap[e.messageArg];return{baseUri:MsPortalEarly.ExtensionLoader.getUri(t),resourceId:t.armResourceId}})),t.registerTestExtensions=s.defineHandler(FxImpl.Extension.CreateUiDef.registerTestExtensionsEndPoint,(async e=>{const t=await e.diContainer.getAsync(s.get("MsPortalImpl/Extension/ExtensionMetadataSource","ExtensionMetadataSource")),i=e.messageArg.map((e=>t.registerTestExtension(e)));await Promise.all(i);const o=globalThis.location;o.search?o.search=o.search.concat("&"+a):o.search="?"+a})),t.unregisterTestExtensions=s.defineHandler(FxImpl.Extension.CreateUiDef.unregisterTestExtensionsEndPoint,(async e=>{const t=await e.diContainer.getAsync(s.get("MsPortalImpl/Extension/ExtensionMetadataSource","ExtensionMetadataSource")),i=e.messageArg.map((e=>t.unregisterTestExtension(e)));await Promise.all(i),globalThis.location.reload()})),t.listTestExtensions=s.defineHandler(FxImpl.Extension.CreateUiDef.listTestExtensionsEndPoint,(async e=>(await e.diContainer.getAsync(s.get("MsPortalImpl/Extension/ExtensionMetadataSource","ExtensionMetadataSource"))).listTestExtensions())),t.getCatalogApiCacheContent=s.defineHandler(FxImpl.Extension.getCatalogApiCacheContentEndPoint,(()=>Promise.resolve(null))),t.postBoot=s.defineHandler(FxImpl.Extension.postBootEndPoint,(e=>{e.diContainer.get(p).set(e.messageContext.srcWindowId,e.messageArg)}))})),
define("MsPortalImpl/Shared/RedirectCommon",["require","exports"],(function(e,t){"use strict";t.getReactBrowseRedirectBlade=void 0;var s=MsPortalFx.Base;const i=(e,t)=>{if(!e)return[];const s=e=>t+(e>0?e:"");let i=0,o=e.getStringValue(s(i))||"";const n=[];for(;o.length;)n.push(...o.split(",").map((e=>e.trim()))),o=e.getStringValue(s(++i))||"";return n};t.getReactBrowseRedirectBlade=e=>{const{bladeName:t,resourceType:o,inMenu:n,variantAssignments:r}=e;if(n||!r||!o)return t;if(o===s.Constants.ResourceTypes.AllResources&&r.getBooleanValue("RedirectBlade-HubsExtension-BrowseAll"))return"BrowseAll.ReactView";if(o===s.Constants.ResourceTypes.ResourceGroups&&r.getBooleanValue("RedirectBlade-HubsExtension-BrowseResourceGroups"))return"BrowseResourceGroups.ReactView";if(!["argbrowseresourcesinmenu","browseresource"].includes(t?.toLowerCase()))return t;const a="*"===(r.getStringValue("ReactBrowseOptInResourceProviders")||"").trim(),l=i(r,"ReactBrowseOptInResourceProviders").flatMap((e=>e.toLowerCase())),c=i(r,"ReactBrowseOptOutResourceTypes").flatMap((e=>e.toLowerCase())),d=o.toLowerCase(),p=d.split("/")[0];return!l.includes(p)&&!a||c.includes(d)?t:"BrowseResource.ReactView"}})),
define("MsPortalImpl/Extension/Extension.Manifest",["require","exports","Fx/DependencyInjection","Fx","FxInternal","FxHubs/ResourceManagement","FxInternal/AsyncLoader","MsPortalImpl/Extension/CachedManifestClient","MsPortalImpl/Extension/Extension.DefinitionValidator","MsPortalImpl/Extension/ExtensionManagerOptions","Fx/Experimentation","MsPortalImpl/Shared/RedirectCommon"],(function(e,t,s,i,o,n,r,a,l,c,d,p){"use strict";t.RedirectMap=t.ManifestCache=void 0,t.assetRedirectKey=y,t.bladeRedirectKey=b,t.partRedirectKey=x;var u=MsPortalFx.Extension,m=MsPortalFx.Base.Diagnostics,g=MsPortalFx.isNullOrWhiteSpace,h=(MsPortalFx.Extension.BrowseType,MsPortalFx.Base.Diagnostics.Telemetry);const f=window;function x(e,t,s,i,o){return`[${e}]${t}-${s}-${i}-${o}`.toLowerCase()}function b(e,t){return`${e}-${t}`.toLowerCase()}function y(e,t,s){return`${e}_${t}${s?"."+s:""}`.toLowerCase()}const v=m.createLog(e);function w(e){if(!e)return;const t={hideassettype:1,hideinstances:2,showassettype:4,showinstances:8,disabled:16},s=(e,s,i)=>{if("number"==typeof i)e[s]={options:i};else if("string"==typeof i){let o=0;(i||"").toLowerCase().split(",").forEach((e=>{e=(e||"").trim(),t[e]&&(o|=t[e])})),e[s]={options:o}}},i=(e,t,s)=>{"boolean"==typeof s&&(e[t]?e[t].hideBrowseInfoBox=s:e[t]={hideBrowseInfoBox:s})},o=Object.create(null);return MsPortalFx.forEachKey(e,((e,t)=>{t&&(s(o,e,t.options),i(o,e,t.hidebrowseinfobox),t.kinds&&(o[e]=o[e]||Object.create(null),o[e].kinds=Object.create(null),MsPortalFx.forEachKey(t.kinds,((t,n)=>{n&&(s(o[e].kinds,t,n.options),i(o[e].kinds,t,n.hidebrowseinfobox))}))),t.featureCardOptions&&(o[e]=o[e]||Object.create(null),o[e].featureCardOptions=t.featureCardOptions),t.variant&&(o[e]=o[e]||Object.create(null),o[e].variant=t.variant))})),o}let M=t.RedirectMap=class{constructor(e){this._partRedirectsMap={},this._bladeRedirectsMap={},this._assetRedirectsMap={},this._experimentAssignments=e.shellAssignments}addPartRedirect(e){this._partRedirectsMap[x(e.type,e.fromExtension,e.fromPart,e.fromBlade,e.fromLens)]=e}addBladeRedirect(e){this._bladeRedirectsMap[b(e.fromExtension,e.fromBlade)]=e}addAssetRedirect(e){this._assetRedirectsMap[y(e.fromExtension,e.fromAsset,e.fromKind)]=e}getPartRedirect(e,t,s,i,o){const n=x(e,t,s,i,o);return{key:n,definition:this._partRedirectsMap[n]}}getBladeRedirect(e,t,s){const i=b(e,t),o=this._bladeRedirectsMap[i];let n=!!o;const r={};if(o?.useFlighting){n=!!this._experimentAssignments.isAvailable&&this._experimentAssignments.getBooleanValue(`RedirectBlade-${o.fromExtension}-${o.fromBlade}`);const e=["argbrowseresourcesinmenu","browseresource"],t=this._experimentAssignments?.getStringValue("ReactBrowseOptInResourceProviders")||"";if(o&&t.length>0&&n&&o.fromExtension.toLowerCase()==="HubsExtension".toLowerCase()&&e.includes(o.fromBlade.toLowerCase())){const e=s?.resourceType||"";n="browseresource.reactview"===(0,p.getReactBrowseRedirectBlade)({bladeName:o.fromBlade,variantAssignments:this._experimentAssignments,resourceType:e}).toLowerCase(),r.browseReactRedirectApplied=n,r.browseBladeParameters=s}}return o&&h.trace({source:"ExtensionManifest.RedirectMap",action:"getBladeRedirect.redirection",data:{redirect:o,redirectApplied:n,nullExperimentAssignments:!this._experimentAssignments.isAvailable,...Object.keys(r).length>0&&r}}),{key:i,definition:n?o:null}}getAssetRedirect(e){return this._assetRedirectsMap[e.toLowerCase()]}};function C(e,t,s,i){e.push(t.format(s,i))}t.RedirectMap=M=__decorate([__metadata("fx:diagnostics",[e,"RedirectMap"]),s.Class(),__metadata("design:paramtypes",[d.Experimentation])],M);const S={},I={};let P=t.ManifestCache=class{constructor(e,t,s,i,o,n){this._redirectMap=t,this._cachedManifestClient=i,this._features=o,this._experimentation=n,this._cachedManifestsLoaded={},this._cache={},this._asyncCache={},this._extensionBlockBladeRedirect=(o.getValue("blockbladeredirect")||"").toLowerCase(),function(e){const t=(e,t)=>{e&&e.split(",").forEach(t)};t(e.getValue("assettypeapiversion"),(e=>{const t=e.split(":");2===t.length&&t[0]&&(S[t[0].toLowerCase()]=t[1])}));const s=e=>t=>{t&&(I[t.toLowerCase()]=e)};t(e.getValue("showassettypes"),s(!0)),t(e.getValue("hideassettypes"),s(!1))}(this._features),o.isEnabled("prefetchbrowsequerymanifest")&&this._cachedManifestClient.getManifests("assetTypesBrowse"),o.isEnabled("prefetchfeaturecardsmanifest")&&this._cachedManifestClient.getManifests("featureCards"),n.shellAssignments.getBooleanValue("disablecopilotmanifest")&&(this._cachedManifestsLoaded.copilot=Q.resolve(null));const a=FxImpl.partition(s.extensionsAsArray,(e=>e.isSideloaded)),l=[];a[0].length&&l.push(e.getAsync(r.get("MsPortalImpl/Extension/SideloadManifestClient","SideloadManifestClient")).then((e=>e.getManifests(a[0]))).then((e=>{MsPortalFx.forEachKey(e,((e,t)=>{this.trySetAllManifest(e,t)}))}))),this._sideloadManifestsLoaded=Promise.all(l).then((()=>a[1]))}getManifests(e,t){const s=Object.create(null);t&&Object.keys(this._cache).forEach((i=>{const o=this.getManifest(i,e);o&&(s[i]=!0,t(i,o))}));let i=this._cachedManifestsLoaded[e]||(this._cachedManifestsLoaded[e]=Q(Promise.all([this._sideloadManifestsLoaded,this._cachedManifestClient.getManifests(e)]).then((([t,s])=>{t.forEach((t=>{this.trySetManifest(t.name,e,s[t.name]||{})}))}))));return t&&(i=Q(o.tryImmediateResolve(i,(()=>{Object.keys(this._cache).forEach((i=>{s[i]||t(i,this.getManifest(i,e))}))})))),i}getManifest(e,t){return this._getCache(e)[t]}getManifestAsync(e,t){return o.tryImmediateResolve(o.tryImmediateResolve(this.getManifests(t),(()=>this._getAsyncCache(e)[t].promise)),(()=>this._getCache(e)[t]))}trySetManifest(e,t,s,i){if(this._validateAndProcessManifest(e,s,i))return this._setManifest(e,t,s),!0}trySetAllManifest(e,t,s){if(this._validateAndProcessManifest(e,t,s))return MsPortalEarly.cachedManifestTypes.forEach((s=>{this._setManifest(e,s,t)})),!0}getVersion(e){const t=this.getManifest(e,"assetTypes");return t&&t.pageVersion}getHostOverride(){return this._features.getValue("manifesthost")}_setManifest(e,t,s){this._getCache(e)[t]||(this._getCache(e)[t]=s,this._getAsyncCache(e)[t].resolve())}_getCache(e){return this._cache[e]||(this._cache[e]={})}_getAsyncCache(e){return this._asyncCache[e]||(this._asyncCache[e]={assetTypes:Promise.withResolvers(),assetTypesBrowse:Promise.withResolvers(),assetTypesMenu:Promise.withResolvers(),featureCards:Promise.withResolvers(),galleryParts:Promise.withResolvers(),surveys:Promise.withResolvers(),uiDefinition:Promise.withResolvers(),extensionConfiguration:Promise.withResolvers(),sourceMappings:Promise.withResolvers(),copilot:Promise.withResolvers(),tourGuide:Promise.withResolvers(),browseMenus:Promise.withResolvers(),menus:Promise.withResolvers(),portalServices:Promise.withResolvers()})}_validateAndProcessManifest(e,t,s){const o=s||[],r=[];if(!t){const e="Manifest was not specified for the extension. Ensure that you passing a valid manifest to the MsPortalFx.Extension.register/FxExtension.registerAmd call that is used to register your extension with the portal.";o.push(e)}const a=this._features.getValue("manifesthost"),c=/([^:]*)/.exec(f.location.host)[1];let d=t.assetTypes;if(d){if(!(0,l.validateIsArray)("manifest.assetTypes",d,o))return!1;d=d.filter((t=>function(e,t,s,i){const o=e.name;let n=!0;if(g(o)&&(n=!1,C(s,"The name for the asset type in manifest '{0}' was not specified.",t)),void 0!==e.options&&"number"!=typeof e.options&&(n=!1,C(s,"The asset type options property present for the asset type '{0}' in manifest '{1}' was not a number.",o,t)),void 0!==e.browseType&&"number"!=typeof e.browseType&&(n=!1,C(s,"The browse type for the asset type '{0}' in manifest '{1}' was not a number.",o,t)),e.browseLinkUri&&"string"!=typeof e.browseLinkUri&&(n=!1,C(s,"The browse link URI for the asset type '{0}' in manifest '{1}' was not a string.",o,t)),void 0!==e.privateBrowse&&"boolean"!=typeof e.privateBrowse&&(n=!1,C(s,"The private browse flag present for the asset type '{0}' in manifest '{1}' was not a boolean.",o,t)),void 0!==e.browseRequiresRdfe&&"boolean"!=typeof e.browseRequiresRdfe&&(n=!1,C(s,"The requires RDFE browse flag was present for the asset type '{0}' in manifest '{1}' was not a boolean.",o,t)),void 0!==e.browseRequirements&&"number"!=typeof e.browseRequirements&&(n=!1,C(s,"The browse requirements was present for the asset type '{0}' in manifest '{1}' was not a number.",o,t)),void 0!==e.browseType){switch(e.browseType){case 1:case 2:case 3:break;default:C(i,"The browse for the asset type '{0}' in manifest '{1}' is deprecated: '"+e.browseType+"'.",o,t)}g(e.pluralDisplayName)&&g(e.text)&&(n=!1,C(s,"The pluralDisplayName for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",o,t)),MsPortalFx.isNullOrUndefined(e.icon)&&(n=!1,C(s,"The icon for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",o,t))}else void 0!==e.privateBrowse&&(n=!1,C(s,"The asset type '{0}' in manifest '{1}' has a private blade flag but no browse type.",o,t));return e.propertyProviderServiceViewModel&&"string"!=typeof e.propertyProviderServiceViewModel&&(n=!1,C(s,"The property provider service view model for the asset type '{0}' in manifest '{1}' was not a string.",o,t)),n}(t,e,o,r))),t.assetTypes=d;const s=this._features.getValue(`${e}_hideassettypes`),p=this._features.getValue(`${e}_showassettypes`),m=this._features.getValue(`${e}_assettypeoptions`),h=this._features.getValue(`${e}_resourcetypeapiversions`),f=this._features.getValue(`${e}_argbrowseoptions`),x=this._features.getValue(`${e}_showargcolumns`),b=this._features.getValue(`${e}_hideassettypecommands`);let y;const M=s&&s.toLowerCase().split(","),P=p&&p.toLowerCase().split(",");let _;const F=m&&w(JSON.parse(m.toLowerCase()));let T;const k=h&&JSON.parse(h.toLowerCase());let E;const D=f&&JSON.parse(f.toLowerCase());let A;const B=x&&JSON.parse(x.toLowerCase());let N;const R=b&&JSON.parse(b.toLowerCase());let L,z;const H=t.environmentConfiguration;if(H){const e=H[H[a]&&a||H[c]&&c||MsPortalFx.find(Object.keys(H),(e=>c.endsWith(e)))||"*"];e&&(y=e.hideAssetTypes,_=w(e.assetTypeOptions),T=e.resourceTypeApiVersions,E=e.argBrowseOptions,A=e.showArgColumns,N=e.hideAssetTypeCommands,L=e.assetTypeBrowseCommandsExperiments,z=e.assetTypeExtensibleCommandsApiVersions)}if(d.forEach((t=>{if(t?.name){const s=t.name.toLowerCase(),o=e.toLowerCase(),r=t.variants&&this._experimentation.shellAssignments.getStringValue("assettypevariant-"+o+"-"+s);if(P||M||y||F||_||k||T||D||E||B||A||R||N||L||z||r){r&&(t.variant=r);const o=(e,i)=>{const o=e[s];if(o){void 0!==o.options&&(t.options=o.options);!i&&void 0!==o.variant?t.variant=o.variant:r||void 0===o.variant||(t.variant=o.variant),t.hideBrowseInfoBox=o.hideBrowseInfoBox,t.privateBrowse=(0,n.supportsOption)(t.options,1),t.resourceType?.kinds&&t.resourceType.kinds.forEach((e=>{const t=e.name.toLowerCase();if(o.kinds){const s=o.kinds[t];s&&(void 0!==s.options&&(e.options=s.options),e.hideBrowseInfoBox=s.hideBrowseInfoBox)}})),o.featureCardOptions&&(t.featureCardOptions=o.featureCardOptions)}},a=e=>{const i=e[s];i&&(t.hiddenCommands=i)},l=e=>{e.includes(s)&&(t.privateBrowse=!1,t.options=-2&t.options)},c=e=>{e.includes(s)&&(t.privateBrowse=!0,t.options=1|t.options)};_?o(_,!0):y&&c(y),F?o(F):P?l(P):M&&c(M);const d=t.resourceType;if(d){const e=T&&T[d.resourceTypeName.toLowerCase()];e&&(d.apiVersion=e);const t=k?.[d.resourceTypeName.toLowerCase()];t&&(d.apiVersion=t)}if(E?.[s]){const i=E[s].toLowerCase();u.ArgBrowseFeatureValueToEnumMap[i]?(t.armBrowseOption=u.ArgBrowseFeatureValueToFallbackEnumMap[i],t.argBrowseOption=u.ArgBrowseFeatureValueToEnumMap[i]):u.RemappedArgBrowseFeatureValueToEnumMap[i]?(v.verbose(`Remapped arg browse option in config for asset type ${t.name} in extension ${e}: ${E[s]} to '${u.RemappedArgBrowseFeatureValueToEnumMap[i].mappedOptionString}'`),t.armBrowseOption=u.ArgBrowseFeatureValueToFallbackEnumMap[i],t.argBrowseOption=u.RemappedArgBrowseFeatureValueToEnumMap[i].mappedOption):(v.error(`Unknown arg browse option in config for asset type ${t.name} in extension ${e}: ${E[s]}, defaulting to 'Disable'`),t.armBrowseOption=0,t.argBrowseOption=4)}if(D?.[s]){const i=D[s].toLowerCase();u.ArgBrowseFeatureValueToEnumMap[i]?(t.armBrowseOption=u.ArgBrowseFeatureValueToFallbackEnumMap[i],t.argBrowseOption=u.ArgBrowseFeatureValueToEnumMap[i]):u.RemappedArgBrowseFeatureValueToEnumMap[i]?(v.verbose(`Remapped arg browse option in config for asset type ${t.name} in extension ${e}: ${E[s]} to '${u.RemappedArgBrowseFeatureValueToEnumMap[i].mappedOptionString}'`),t.armBrowseOption=u.ArgBrowseFeatureValueToFallbackEnumMap[i],t.argBrowseOption=u.RemappedArgBrowseFeatureValueToEnumMap[i].mappedOption):(v.error(`Unknown arg browse option in URL for asset type ${t.name} in extension ${e}: ${E[s]}, defaulting to 'Disable'`),t.armBrowseOption=0,t.argBrowseOption=4)}if(A&&(t.showArgColumns=A[s]),B&&(t.showArgColumns=B[s]),N&&a(N),R&&a(R),t.browseCommandExperiments=L?.[s],t.extensibleCommandsApiVersions=z?.[s],t.variant){const e=t.variants?.find((e=>e.name.toLowerCase()===t.variant.toLowerCase()));e&&(0,i.forEachKey)(e,((e,s)=>{"name"!==e&&(t[e]=s)}))}}}})),S||I){const t=(e||"").toLowerCase()+"_";d.forEach((e=>{const s=t+(e.name||"").toLowerCase(),i=e.resourceType;void 0!==S[s]&&i&&(i.apiVersion=S[s]),void 0!==I[s]&&(e.privateBrowse=!I[s],e.options=e.privateBrowse?1|e.options:-2&e.options)}))}}const p=t.featureCards;if(p){const s=this._features.getValue(`${e}_featurecardoptions`);let i;const o=s&&JSON.parse(s.toLowerCase()),n=t.featureCardEnvironmentConfiguration;if(n){const e=n[n[a]&&a||n[c]&&c||MsPortalFx.find(Object.keys(n),(e=>c.endsWith(e)))||"*"];e&&(i=e.featureCardOptions)}(o||i)&&p.forEach((e=>{const t=e.id.toLowerCase(),s=t=>{const s=Object.create(null);t.forEach((e=>{const t=e.resourceType||e.resourcetype;"string"==typeof e.enabled&&t?s[t.toLowerCase()]=e.enabled:s[t.toLowerCase()]=!!e.enabled}));e.resourceTypes=s};if(i){const e=i[t];e&&s(e)}if(o){const e=o[t];e&&s(e)}}))}o.length&&!s&&v.error(`The manifest for '${e}' has validation errors. Errors: ${JSON.stringify(o)}`),r.length&&v.error(`The manifest for '${e}' has non-fatal validation errors. Errors: ${JSON.stringify(r)}`);return(t.redirects||[]).forEach((t=>{if(t.toExtension=t.toExtension||(3!==t.type?e:""),t.fromExtension=t.fromExtension||e,t.useFlighting=!!t.useFlighting,t.toExtension===e||t.fromExtension===e||"HubsExtension"===t.toExtension)switch(t.type){case 2:case 3:{const e=t;!e.fromBlade||this._extensionBlockBladeRedirect&&e.toExtension.toLowerCase()===this._extensionBlockBladeRedirect||this._redirectMap.addBladeRedirect(e);break}case 4:case 5:this._redirectMap.addPartRedirect(t);break;case 6:this._redirectMap.addAssetRedirect(t)}})),!0}};t.ManifestCache=P=__decorate([__metadata("fx:diagnostics",[e,"ManifestCache"]),s.Class(),__metadata("design:paramtypes",[s.Container,M,c.ExtensionManagerOptions,a.CachedManifestClient,FxImpl.Features,d.Experimentation])],P)})),
define("MsPortalImpl/Extension/Extension",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/Extension.Manifest"],(function(e,t,s,i){"use strict";t.ShellWorkerExtension=t.InitializedManifestCache=t.ExtensionFactory=void 0;var o=FxImpl.Extension,n=FxImpl.Rpc;class r{static create(e){return e.getManifests("assetTypes").then((()=>null))}}t.InitializedManifestCache=r,__decorate([__metadata("fx:diagnostics",[e,"InitializedManifestCache"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.ManifestCache]),__metadata("design:returntype",Promise)],r,"create",null);let a=t.ExtensionFactory=class{constructor(e,t){this.createExtension=s=>{const i=t.getManifest(s.name,"assetTypes")||{};return new l(s,32&i.flags?null:e)}}};t.ExtensionFactory=a=__decorate([__metadata("fx:diagnostics",[e,"ExtensionFactory"]),s.Class(),__metadata("design:paramtypes",[n.Client,i.ManifestCache])],a);class l{constructor(e,t){this.isLoaded=ko.observable(),this.lastError=ko.observable(),this.refCount=ko.observable(0);const{name:s,serviceTreeId:i}=e;this.name=s,this.serviceTreeId=i,this.processMessages=t?()=>o.pingEndPoint.invoke(t,s,void 0):()=>Promise.resolve(),this.waitForIdle=t?(e,i)=>FxImpl.Extension.waitForExtensionIdleEndPoint.invoke(t,s,{bladeName:e,bladeInstanceId:i}):()=>Promise.resolve(void 0),this.onStateChange=e=>{const{loadTime:t,error:s,refCount:i}=e;void 0!==t&&(this.isLoaded(!!t),t&&(this.loadTime=t)),s&&this.lastError(s),MsPortalFx.isNullOrUndefined(i)||this.refCount(i)}}}t.ShellWorkerExtension=l})),
define("MsPortalImpl/Extension/ExtensionManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/Extension","MsPortalImpl/Extension/ExtensionManagerOptions","ShellWorker/ExtensionManager"],(function(e,t,s,i,o,n){"use strict";t.ExtensionManagerImpl=t.ExtensionManager=t.ExtensionLoader=void 0,Object.defineProperty(t,"ExtensionManagerOptions",{enumerable:!0,get:function(){return o.ExtensionManagerOptions}});var r=MsPortalFx.Base.Diagnostics,a=FxImpl.Rpc;const l=r.createLog(e);let c=class{constructor(e,t){this._options=e,this._rpcClient=t}startRpc(e){this._rpcClient.start({instanceIndex:0,loadChannelFunction:void 0,originId:"fx",shellChannel:new FxImpl.Rpc.RpcChannel(FxImpl.localRpcPort),windowRedirectMap:this._options.extensionRedirectMap}),n.onExtensionStateChangeEndPoint.register(this._rpcClient,"fxw",(t=>{e[t.name].onStateChange(t)}))}setRequestedBlade(e,t){n.setRequestedBladeEndPoint.invoke(this._rpcClient,"fxw",{extensionName:e,bladeName:t})}};c=__decorate([__metadata("fx:diagnostics",[e,"ExtensionLoaderImpl"]),s.Class(),__metadata("design:paramtypes",[o.ExtensionManagerOptions,a.Client])],c);class d{static create(e,t){return t}}t.ExtensionLoader=d,__decorate([__metadata("fx:diagnostics",[e,"ExtensionLoader"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.InitializedManifestCache,c]),__metadata("design:returntype",d)],d,"create",null);let p=t.ExtensionManagerImpl=class{constructor(e,t,s){this._options=s,this.lastExtensionError=ko.observable(),this.initializedExtensions=[],this._callbacks=$.Callbacks(),this._unloadCallbacks=$.Callbacks(),this._ltm=new FxImpl.TriggerableLifetimeManager,this._extensionsMap=FxImpl.mapValues(s.extensionsAsMap,(t=>{const s=e.createExtension(t);return s.lastError.subscribeAndRun(this._ltm,(e=>{e&&this.lastExtensionError(s)})),s.isLoaded.subscribeAndRun(this._ltm,(e=>{e?(this.initializedExtensions.push(s),this._callbacks.fire(s.name)):(MsPortalFx.remove(this.initializedExtensions,s),this._unloadCallbacks.fire(s.name))})),s})),t.startRpc(this._extensionsMap)}getExtension(e){const t=this._options.getNormalizedMetadata(e);return t&&this._extensionsMap[t.name]}onLoad(e){const t=this.initializedExtensions.slice(0),s=t=>{try{e(t)||this._callbacks.remove(s)}catch(e){l.error("onLoad event callback has thrown an exception.",2,e)}};this._callbacks.add(s),t.forEach((t=>{e(t.name)}))}onUnload(e){const t=s=>{try{e(s)||this._unloadCallbacks.remove(t)}catch(e){l.error("onUnload event callback has thrown an exception.",3,e)}};this._unloadCallbacks.add(t)}dispose(){this._ltm.dispose()}getExtensions(){return Object.keys(this._extensionsMap).map((e=>this._extensionsMap[e]))}};t.ExtensionManagerImpl=p=__decorate([__metadata("fx:diagnostics",[e,"ExtensionManagerImpl"]),s.Class(),__metadata("design:paramtypes",[i.ExtensionFactory,d,o.ExtensionManagerOptions])],p);class u{static create(e){return e}}t.ExtensionManager=u,__decorate([__metadata("fx:diagnostics",[e,"ExtensionManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[p]),__metadata("design:returntype",u)],u,"create",null)})),
define("MsPortalImpl/UI/Compositions/UI.Composition",["require","exports"],(function(e,t){"use strict";t.PartContainerModelIdProperty=t.EditScopeIdPropertyName=t.CompositionType=t.CompositionInstanceDataName=void 0,t.bladeImplementedWithVirtualPart=function(e){return!!n[r(e)]},t.deepSubset=function(e,t){return Object.keys(t).every((s=>e.hasOwnProperty(s)&&MsPortalFx.deepEquals(t[s],e[s])))},t.findCommand=function(e,t,s){if(!e)throw new Error("Commands list is required.");if(!t)throw new Error("Command name is required.");if(!s)throw new Error("Command container name is required.");return MsPortalFx.find(e,(e=>e.commandName===t))},t.fxreplacedpartcomposing=void 0,t.getBladeType=r,t.getIdMatchFunc=function(e){return t=>t.id===e},t.isContextMenuContainer=function(e){const t=e;return t&&t.beforeActivateCommandMenuItems&&"function"==typeof t.beforeActivateCommandMenuItems},t.isPartComposition=function(e){const t=e.locator&&e.locator.type;return 5===t||6===t||7===t},t.referenceTypeMap=void 0,t.tryGetAssetType=function(e){const t=e&&e.assetTypeId;if("string"==typeof t)return t};var s=MsPortalFx.Base.Constants.BladeParameterNames;const i=t.referenceTypeMap={};i[0]="Part",i[1]="BladeInput",i[2]="BladeActionBar",i[3]="BladeProperty",i[4]="Command",i[5]="Constant",i[6]="SelectedItem",i[7]="Adapter",i[8]="Dashboard",i[9]="AdapterInput";t.EditScopeIdPropertyName=s.EditScopeId,t.PartContainerModelIdProperty="##SnapshotContainerId##",t.CompositionInstanceDataName="MsPortalImplCompositionInstance",t.fxreplacedpartcomposing="fxreplacedpartcomposing";var o;!function(e){e[e.Unknown=0]="Unknown",e[e.Part=1]="Part",e[e.StartboardPart=2]="StartboardPart",e[e.Lens=3]="Lens",e[e.BladeActionBar=4]="BladeActionBar",e[e.Blade=5]="Blade",e[e.Journey=6]="Journey",e[e.Startboard=7]="Startboard"}(o||(t.CompositionType=o={}));const n={1:!0,3:!0,4:!0,2:!0,5:!0,6:!0};function r(e){let t;return t=12===e.style?4:e.templateBlade?1:e.frameBlade?2:e.menuBlade?3:16&e.attributes?5:e.tabMenuBlade?6:0,t}})),
define("MsPortalImpl/Services/Services.Tenants",["require","exports","FxHubs/ArmHelpers/ArmApisStartup","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","FxHubs/RpcEndPoints","Fx/Ajax","Fx","FxInternal/AsyncLoader"],(function(e,t,s,i,o,n,r,a,l){"use strict";t.getHomeTenantsCountHandler=t.TenantsService=t.DEV=void 0;var c=MsPortalFx.Base,d=c.Diagnostics,p=d.Telemetry,u=c.Resources;const m="home",g=d.createLog(e),h="Services.Tenants",f={home:0,projectedby:0,managedby:0},x=(0,a.memoizePromise)((e=>{const t=p.startTrace({source:h,action:e});return(0,r.ajax)({uri:u.getAppRelativeUri("/api/directories/List"),type:"POST",dataType:"json",contentType:"application/json",performRetry:!0}).then((e=>(p.completeTrace(t,{tenantsCount:(e.tenants||[]).length,failure:e.failure}),e.tenants.forEach((e=>e.tenantCategory=e.tenantCategory||m)),e))).catch((e=>{throw p.cancelTrace(t),e}))})),b=(0,a.memoizePromise)((()=>{const e=p.start({source:h,action:"_getTenantsMemo"});return(0,r.batch)({uri:(0,s.listTenantsApi)(),setTelemetryHeader:h+".getTenants"}).then((t=>{const s=t.content.value||[];p.completeTrace(e,{tenantsCount:s.length});const i={failure:!1,tenants:[]},o={};return s.forEach((e=>{const t=e.displayName||"",s=e.domains||[],n=e.tenantId;let r=(e.tenantCategory||"").toLowerCase();r||(g.warning(`Tenant ${t}(${n}) received from ARM with missing tenantCategory. Treating it as 'Home' tenant.`),r=m);const a={displayName:t,domainName:e.defaultDomain||s[0]||"",id:n,tenantCategory:r};r.split(",").forEach((e=>{f[e]++})),(e.defaultDomain||1===s.length)&&t?i.tenants.push(a):o[n]=a})),p.trace({source:h,action:"tenantsInfo",data:{allTenantsCount:s.length,tenantsWithInfoCount:i.tenants.length,homeTenantsCount:f.home,projectedTenantsCount:f.projectedby,managedByTenantsCount:f.managedby}}),i.tenants.length!==s.length?x("GetTenantsFromArmFallback").then((e=>(e.tenants.forEach((e=>{const t=o[e.id];t&&(t.displayName=e.displayName||e.id,t.domainName=e.domainName||e.id)})),(0,a.forEachKey)(o,((e,t)=>{i.tenants.push(t)})),i))):i})).catch((t=>(p.cancelTrace(e,MsPortalFx.getLogFriendlyMessage(t)),MsPortalFx.Hubs.Notifications.ClientNotification.publish({title:o.tenantErrorTitle,description:o.tenantErrorDescription.format(location.hostname),status:MsPortalFx.Hubs.Notifications.NotificationStatus.Error}),{tenants:[],failure:!0})))})),y=(0,a.memoizePromise)((()=>b().then((e=>e.tenants.filter((e=>e.tenantCategory.toLowerCase().includes(m)))))));let v=t.TenantsService=class{getHomeTenantsCount(){return y().then((e=>e.length))}getTenants(){return b()}getHomeTenants(){return y()}};t.TenantsService=v=__decorate([__metadata("fx:diagnostics",[e,"TenantsService"]),i.Class()],v);t.getHomeTenantsCountHandler=(0,l.defineHandler)(n.Directories.getHomeTenantsCountEndPoint,(e=>e.diContainer.get(v).getHomeTenantsCount()))})),
define("MsPortalImpl/UI/UI.AuthStateManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Tenants","FxInternal/AsyncLoader","FxHubs/RpcEndPoints","Fx"],(function(e,t,s,i,o,n,r,a){"use strict";t.getCurrentUserEndPointHandler=t.AuthStateManager=void 0,t.getMsalJsLoginQueryParameters=function(e){return{"exp.msaljsloginexp":e,msaljsscript:e}},t.getSubscriptions=function(){if(!M){const e=Promise.withResolvers();p.updateSubscriptionInfoEndPoint.register(d.client,"HubsExtension",(t=>{e.resolve(t)})),M=e.promise}return M},t.hasFlag=b;var l=MsPortalFx.Base,c=l.Diagnostics,d=FxImpl.Rpc,p=HubsExtension.Internal.Azure,u=c.Telemetry,m=l.Resources;const g=window,h=i.Services.PortalIdentity.tenantNameAndDomainFormat,f=MsPortalFx.ensureSuffix(m.getAppRelativeUri("/"),"/")+"SignOut";let x;function b(e,t){return(e&t)===t}const y=(0,a.isFeatureEnabled)("persistcachedtokensonrefresh"),v={isAnonymous:!0};class w{constructor(e,t){if(this._diContainer=e,this.tokenCache={},this._persistAuthStateOnRefresh=!0,this.persist=()=>{this._persistAuthStateOnRefresh&&(this.bootstrapState&&MsPortalImpl.sessionStorage.setItem("authState",JSON.stringify(this.bootstrapState)),y&&this.tokenCache&&Object.keys(this.tokenCache).length&&(u.trace({source:"UIAuthStateManager",action:"persistedTokenCache",data:{extensions:Object.keys(this.tokenCache)}}),MsPortalImpl.sessionStorage.setItem("extensionTokenCache",btoa(JSON.stringify(this.tokenCache)))))},this._loadCurrentDirectoryDetailsMemo=(0,a.memoizePromise)((()=>{const e=this.getCurrentUser();if((0,a.isFeatureEnabled)("tenants2020")&&!!e.tenantDisplayName){const{tenantDisplayName:t,tenantDomain:s}=e;return Promise.resolve({directoryName:t,domainName:s,uniqueDirectoryName:h.format(t,s)})}return this._diContainer.get(o.TenantsService).getHomeTenants().then((t=>{const s=(e.tenantId||"").toLowerCase(),i={};let o="",n="",r="";return t.forEach((t=>{if(s===(t.id||"").toLowerCase()){const s=e.tenantDomain||e.tenantId;t.displayName&&t.displayName!==t.id||(t.displayName=s),t.domainName&&t.domainName!==t.id||(t.domainName=s),o=r=t.displayName,n=t.domainName}else t.displayName?i[t.displayName.toLocaleLowerCase()]=!0:u.trace({source:"UIAuthStateManager",action:"getUserInfo",data:t})})),i[o.toLocaleLowerCase()]&&(r=h.format(o,n)),{directoryName:o,domainName:n,uniqueDirectoryName:r}}))})),this.bootstrapState={...t,loginReplyUrlPath:t?.loginReplyUrlPath||"/signin/index/"},(0,a.isFeatureEnabled)("singlesignout")&&g.addEventListener("storage",(e=>{"signOutAll"===e.key&&(this.clear(),g.location.href=f)})),MsPortalImpl.localStorage.getItem("authState")&&(u.trace({source:"UIAuthStateManager",action:"clearAuthState"}),this.clear(!0)),y){const e=MsPortalImpl.sessionStorage.getItem("extensionTokenCache");if(e){try{this.tokenCache=JSON.parse(atob(e)),u.trace({source:"UIAuthStateManager",action:"loadedTokenCache",data:{extensions:Object.keys(this.tokenCache)}})}catch(e){u.trace({source:"UIAuthStateManager",action:"errorLoadingTokenCache",data:{error:MsPortalFx.sanitizeMessage(JSON.stringify(e))}})}MsPortalImpl.localStorage.removeItem("extensionTokenCache")}}this.tokenCache=this.tokenCache||{};const s=this.tokenCache,i=t?.oAuthToken;i&&i.authHeader&&i.expiresAt>Date.now()&&(s.HubsExtension={...s.HubsExtension||{},"":{header:i.authHeader,expiresAt:i.expiresAt}});const n=t?.selfOAuthToken;n&&n.authHeader&&n.expiresAt>Date.now()&&(s.HubsExtension={...s.HubsExtension||{},self:{header:n.authHeader,expiresAt:n.expiresAt}});const r=t?.prefetchedTokens;r&&MsPortalFx.forEachKey(r,(e=>{if(e){const t=r[e];MsPortalFx.forEachKey(t,(s=>{if(s){const i=t[s];if(i.authHeader&&i.expiresAt>Date.now()){const t=this.tokenCache;(t[e]=t[e]||{})[s]={header:i.authHeader,expiresAt:i.expiresAt}}}}))}})),this.isInternal=fx.environment.internalTenants.includes((this.getCurrentUser().tenantId||"").toLowerCase());const l=[];this.onTokensUpdated=e=>{l.push(e)},this._notifyTokensUpdated=()=>{l.forEach((e=>e(this)))},document.addEventListener("visibilitychange",(function(){x="visible"===document.visibilityState}))}getPageVisibility(){return x}disablePersistingAuthStateOnRefresh(){this._persistAuthStateOnRefresh=!1}updateRefreshToken(e,t,s){u.trace({source:"UIAuthStateManager",action:"updateRefreshToken",data:{correlationId:s}});const i=this.bootstrapState||{},{refreshToken:o,...n}=i;this.updateBootstrapState({...n,refreshToken:e,altRefreshToken:t},"updateRefreshToken",s)}clear(e){e||(this.updateBootstrapState(null,"clear"),this.tokenCache&&delete this.tokenCache,this.tokenCache={}),MsPortalImpl.localStorage.removeItem("authState")}clearSpaAuthCode(){this.bootstrapState.spaAuthCode="",this.bootstrapState.spaAccountId=""}getUserInfo(e){const t=MsPortalFx.isNullOrUndefined(e)?7:e;return(0,a.memoizePromise)((e=>Promise.all([this.getCurrentUser(),this._loadCurrentDirectoryDetailsMemo()]).then((([t,s])=>{let i={isMfa:t.isMfa,mfaEnforcementDate:t.mfaEnforcementDate};return b(e,3)&&(i={...i,email:t.emailAddress,preferredUsername:t.preferredUsername,givenName:t.firstName,surname:t.lastName,isGitHubUser:!!t.gitHubUserId}),b(e,4)&&(i={...i,directoryId:t.tenantId,directoryName:s&&s.directoryName,domainName:s&&s.domainName,isOrgId:t.isOrgId,objectId:t.objectId,principalId:t.principalId,uniqueDirectoryName:s&&s.uniqueDirectoryName,isTenantAdmin:t.isTenantAdmin,countryCode:t.countryCode,isTenantParityDependent:t.isTenantParityDependent,dataBoundary:t.dataBoundary,armTenantDataBoundary:t.armTenantDataBoundary}),i}))))(t)}getSignedInUserTenant(){return this.getCurrentUser().tenantDomain||""}getCurrentUser(){return this.bootstrapState?.user||v}updateBootstrapState(e,t,s){u.trace({source:"UIAuthStateManager",action:"updateBootstrapState",data:{caller:t,isBootstrapStateNull:!e,correlationId:s}}),this.bootstrapState=e,this._notifyTokensUpdated()}updateExtensionTokens(e,t){if(e?.length&&this.tokenCache){const s=this.tokenCache;e.forEach((e=>{const i=e.resource??"",o=e.name;(s[o]||(s[o]={}))[e.requestedScopes?.length?`${i}_${e.requestedScopes.join("_")}`:i]=t})),this._notifyTokensUpdated()}}clearExtensionTokens(e){delete this.tokenCache[e],this._notifyTokensUpdated()}static create(e){return new w(e,MsPortalEarly.authBootstrapState)}}let M;t.AuthStateManager=w,__decorate([__metadata("fx:diagnostics",[e,"AuthStateManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container]),__metadata("design:returntype",w)],w,"create",null),FxImpl.registerGlobalState({reset:()=>{M=null}});t.getCurrentUserEndPointHandler=n.defineHandler(r.Auth.getCurrentUserEndPoint,(e=>e.diContainer.get(w).getCurrentUser()))})),
define("MsPortalImpl/Base/JQueryHelper",["require","exports"],(function(e,t){"use strict";t.filterVisible=function(e,t){return $(e).find(t+i).filter(((t,i)=>!$(i).parentsUntil(e,"."+s).length))},t.findByClassName=function(e,t){return e.find("."+t)},t.forceShow=function(e,t){return n(e),e.show(t)},t.getUnhideSelector=function(){return i},t.hide=o,t.isElementVisible=r,t.isVisible=function(e){return e.toArray().some(r)},t.jBody=void 0,t.toggle=function(e,t){return(t?n:o)(e)},t.unhide=n;const s="fxs-display-none",i=":not(.fxs-display-none)";t.jBody=$(document.body);function o(e){return e.addClass(s)}function n(e){return e.removeClass(s)}function r(e){return!!e.offsetParent}})),
define("MsPortalImpl/UI/UI.NavigationManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Base/JQueryHelper","FxInternal/AsyncLoader","FxInternal/Redirect","Fx/Ajax","FxInternal"],(function(e,t,s,i,o,n,r,a,l){"use strict";t.forceSignInHandler=t.WindowManager=t.RootElements=t.DEV=t.Browser=void 0,t.getErrorPageUri=function(e,t){const s=new d(fx.internalEnv.portalApplicationUri+"/Error");return s.path+="/"+e,s.fragment=window.location.hash,s.query=(new g).setParameters({aadAuthority:FxImpl.internalEnv.fxAadAuthority,aadErrorDetails:t}),s.toString()};var c=MsPortalFx.Base,d=c.UriBuilder,p=c.Diagnostics,u=c.Resources,m=p.Telemetry,g=c.QueryStringBuilder;const h=window,f=m.trace,x=MsPortalFx.pathJoin,b=MsPortalFx.ensureSuffix,y=b(u.getAppRelativeUri("/"),"/")+"signout/clearstate";function v(e){return t=>{t?o.unhide(e):o.hide(e)}}let w=t.Browser=class{confirm(e){return h.confirm(e)}};t.Browser=w=__decorate([__metadata("fx:diagnostics",[e,"Browser"]),s.Class()],w);class M{constructor(e,t){this.portal=e,this.splashScreen=t,[e,t].forEach((e=>{const t=e.length;if(1!==t)throw new Error("Unexpected length '"+e.selector+"': "+t)})),this.showPortal=v(e),this.showSplash=v(t)}static create(){return new M($(h.document.getElementById("web-container")),$(h.document.querySelectorAll("body>.fxs-splashscreen")))}dispose(){this.showPortal(!1)}}t.RootElements=M,__decorate([__metadata("fx:diagnostics",[e,"RootElements"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",M)],M,"create",null);let C=t.WindowManager=class{constructor(e,t){this.unloadCallbacks=[],this.unloadCallbacks.push(e.persist);const s=()=>{"hidden"===document.visibilityState&&this.unloadCallbacks.forEach((e=>e()))};document.addEventListener("visibilitychange",s),this.location=h.location;const i=e.getCurrentUser(),o=e.bootstrapState;this.redirect=s=>{let n=s.uri||"";const r=Promise.withResolvers(),l=s.redirectAction||0;1&l&&e.clear(),2&l&&MsPortalImpl.localStorage.removeItem("LastValidSessionTs"),4&l&&MsPortalImpl.sessionStorage.clear(),8&l&&(0,a.postJSON)({uri:y},{portalAuthorization:o.refreshToken,altPortalAuthorization:o.altRefreshToken,tenant:o.user.tenantId}),16&l&&(MsPortalImpl.sessionStorage.removeItem("Redirect_BootParameters"),MsPortalImpl.localStorage.removeItem("Redirect_BootParameters")),t.showSplash(!0),MsPortalImpl.sessionStorage.setItem("portalInit_lastSessionId",MsPortalFx.sessionId),f({source:"Shell",action:"PortalRedirect",actionModifier:"Redirect",data:s});const c=()=>{r.resolve(void 0)};s.skipFlushBuffers?c():(Promise.all(this.unloadCallbacks.map((e=>e()))).finally(c),setTimeout(c,5e3)),Promise.allSettled([s.delayPromise,r.promise]).finally((()=>{if(!n){const e=new d(location.href);e.path=x("/",e.path,i.tenantId||"","/"),n=e.toString()}(e=>{window.location.href=e})(n)}))},this.openWindow=t=>{let s;const i=l.tryImmediateResolve(Q(t),(t=>{if(t){const s=new d(t),i=s.path,o=b(i,"/");if(!MsPortalFx.localeCompareIgnoreCase(o,b(location.protocol+"//"+location.host,"/"))){const i=s.fragment;i.startsWith("#@")||(s.fragment="#@"+e.getSignedInUserTenant()+(i.startsWith("#")?`/${i.slice(1)}`:""),t=s.toString())}}s?s.location.href=t:s=h.open(t)}));return s||(s=h.open()),i},this.dispose=()=>{document.removeEventListener("visibilitychange",s)}}};t.WindowManager=C=__decorate([__metadata("fx:diagnostics",[e,"WindowManager"]),s.Class(),__metadata("design:paramtypes",[i.AuthStateManager,M])],C);t.forceSignInHandler=(0,n.defineHandler)(r.forceSignInEndPoint,(t=>MsPortalFx.require(e.normalize("./UI.NavigationManager.ForceSignIn")).then((e=>e.forceSignIn(t.diContainer,t.messageArg,t.messageContext.srcWindowId)))))})),
define("MsPortalImpl/Base/Base.ImplUtils",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/UI.AuthStateManager","FxInternal/Diagnostics","MsPortalImpl/Extension/ExtensionManager"],(function(e,t,s,i,o,n,r,a,l){"use strict";t.Uri=t.CompositionProvenance=void 0,t.getHashQueryStringSegment=T,t.getHashSegment=F,t.getHost=C,t.getLocationFromContext=b,t.getPathSegment=P,t.getPathnameSegment=S,t.getPort=I,t.getProtocol=M,t.getQueryStringSegment=_,t.log=function(e,t,s,i){i=i?MsPortalFx.extend2(e.contextData,i):e.contextData;y(e.localRequire,e.windowContext,t,s,{contextData:i,diContainer:e.diContainer})},t.logIncludingProvenance=function(e,t,i){try{const o=(i=i||{windowContext:null,localRequire:null,diContainer:s.container}).windowContext,n=b(i.diContainer,o),r=i.localRequire&&i.localRequire.normalize(),l=MsPortalFx.extend2(i.contextData||{},{extensionName:n.extension,bladeOrPartName:n.bladeOrPartName,area:r}),c=MsPortalFx.getLogFriendlyMessage(t);new p.Log(r||n.bladeOrPartName||n.extension).writeEntry(e,c,null,[(0,a.decycle)(t),l])}catch(e){u.error(e)}},t.logToExtension=y,t.mapToQueryString=w,t.queryStringToMap=v,t.redirectWithCdn=function(e,t){const s=new c.UriBuilder(t.uri+location.search+MsPortalFx.ensurePrefix(t.hash,"#")),i=s.query;MsPortalFx.forEachKey(k,((e,t)=>i.setParameter(e,t))),MsPortalFx.forEachKey(t.parameters,((e,t)=>i.setParameter(e,t)));e.get(r.AuthStateManager).clear(!0),e.get(n.WindowManager).redirect({uri:s.toString(),redirectAction:t.redirectAction||0,reason:t.reason})},t.validateAbsoluteHttpUri=function(e,t){const s=(t=t||{}).requireHttps||!1;return(s?g:m).test(e)};var c=MsPortalFx.Base,d=FxImpl.Rpc,p=c.Diagnostics;const u=p.createLog(e),m=/^https?:\/\/.+$/i,g=/^https:\/\/.+$/i,h=MsPortalFx.forEachKey,f=MsPortalFx.isEmpty;let x=t.CompositionProvenance=class{constructor(e,t){this.locator=e,this.instanceId=t}};function b(e,t){let s,i;if(e&&!e.isDisposed()&&"composition"===e.scope){const t=e.get(x).locator;i=t.name,s=t.getExtensionName()}if(!s)if("string"==typeof t)s=t;else if(t){const e=function(e){const t=$(e),s=t.closest(".fxs-blade-content-container-details,.fxs-blade").data(o.CompositionInstanceDataName);if(s&&o.bladeImplementedWithVirtualPart(s.bladeDefinition))return s.locator;const i=t.closest(".fxs-tile").data(o.CompositionInstanceDataName);return i&&i.locator}(t);e?(i=e.name,s=e.getExtensionName()):s=function(e){const t="data-extensionname",s="["+t+"]["+t+"!='']";return $(e).closest(s).attr(t)||"fx"}(t)}return{bladeOrPartName:i,extension:s||"fx"}}function y(e,t,o,n,r={}){let{rpcClient:c}=r;const{contextData:p,diContainer:m,waitForExtension:g}=r;p&&(n+=" "+JSON.stringify(p)),(async()=>{try{c||(c=m?.get(d.Client)||d.client);const r=b(m,t);g&&m&&"fx"!==r.extension&&await new Promise((e=>{const t=m.get(l.ExtensionManager);t.getExtension(r.extension).isLoaded()&&e(),t.onLoad((t=>t===r.extension&&(e(),!0)))}));const p=r.bladeOrPartName;if((p||"").toLowerCase().endsWith("_dx"))return void i.get("MsPortalImpl/Extension/DefinitionCache","DefinitionCache").then((e=>{s.container.get(e).getBladeDefinition(r.extension,r.bladeOrPartName).then((e=>{try{const t=MsPortalFx.first(MsPortalFx.find(e.effectiveInputs,(e=>"dxContext"===e.property)).valuesFrom).constantValue.viewKind;c.log(e.dxView?.runtimeExtension??"Microsoft_Azure_CreateUIDef",{level:o,code:0,area:t,message:(0,a.decycle)(n)})}catch(e){u.error(e)}}))}));const h=p||e.normalize();c.log(r.extension,{level:o,code:0,area:h,message:(0,a.decycle)(n)})}catch(e){u.error(e)}})()}t.CompositionProvenance=x=__decorate([__metadata("fx:diagnostics",[e,"CompositionProvenance"]),s.Value("composition"),__metadata("design:paramtypes",[Object,String])],x);function v(e=""){const t={},s=e.indexOf("?");return(s>-1?e.slice(s+1):e).split("&").forEach((e=>{if(!e||/^=+$/.test(e))return;const s=e.split("="),i=s.shift(),o=s.length>0?s.join("="):"";t[i]=o})),t}function w(e){let t="",s="";return h(e,((e,i)=>{t+="{0}{1}={2}".format(s,e,i),s||(s="&")})),t}function M(e){const t=/^([^:/]+):\/\//.exec(e.toString());return t?t[1]+":":""}function C(e){const t=M(e=e.toString());if(!t)return"";const s=e.slice(t.length+2),i=s.indexOf("/"),o=i>0?s.slice(0,i):s;return!o||o.indexOf("@")>0?"":o.replace(/:.*/,"")}function S(e){const t=P(e),s=C(t),i=I(t),o=M(t),n=(o?o.length+2:0)+s.length+(i?i.length+1:0);return s&&o?t.slice(n):""}function I(e){const t=M(e),s=C(e);if(!t||!s)return"";const i=t.length+2+s.length,o=/^:(\d+)/.exec(e.toString().substring(i));return o?o[1]:""}function P(e){const t=e.toString().replace(/#.*/g,"").replace(/\?.*/,"");return C(t)&&M(t)?t:""}function _(e){return(e=e.toString().replace(/#.*/g,"")).includes("?")?e.replace(/.*\?/,"?"):""}function F(e){return(e=e.toString()).includes("#")?e.replace(/[^#]*#/,"#").replace(/\?.*/,""):""}function T(e){const t=e.indexOf("#"),s=-1===t?-1:e.slice(t).indexOf("?");return-1===t||-1===s?"":e.slice(t+s)}t.Uri=class{constructor(e){this._hashQs={},this._qs={},e=e&&e.toString()||"",this._protocol=M(e),this._host=C(e),this._port=I(e),this._pathname=S(e),this._hash=F(e),this._qsPart=_(e),this._qs=v(this._qsPart),this._hashQsPart=T(e),this._hashQs=v(this._hashQsPart)}getQueryStringValue(e){return this._qs[e]||""}setHashQueryStringValue(e,t){return this._hashQs[e]=t,this}setHashQueryString(e){return this._hashQs=v(e),this}deleteHashQueryStringValue(e){return delete this._hashQs[e],this}clearHashQueryStringIfEmpty(){return f(this._hashQs)&&(this._hashQsPart=""),this}getHashQueryStringValue(e){return this._hashQs[e]||""}setHash(e){return this._hash=e.toString().replace(/\?.*/,""),this}isHashEmpty(){return""===this.hash||"#"===this.hash}toString(){return this.href}get href(){return this.path+this.queryString+this.hash+this.hashQueryString}get host(){return this._host}get path(){return(this.protocol?this.protocol+"//":"")+this.host+(this.port?":"+this.port:"")+this.pathname}get pathname(){return this._pathname}get port(){return this._port}get protocol(){return this._protocol}get queryString(){const e=w(this._qs);return e||this._qsPart?"?"+e:""}get hash(){return this._hash||this.hashQueryString?"#"+(this._hash||"").replace(/^#/,""):""}get hashQueryString(){const e=w(this._hashQs);return this._hashQsPart||e?"?"+e:""}get hashWithHashQueryString(){return this.hash+this.hashQueryString}getHashParts(){return this._cachedHashParts&&this._partsBasedHash===this.hash||(this._partsBasedHash=this.hash,this._cachedHashParts=MsPortalEarly.getHashParts(this.hash)),this._cachedHashParts}};const k=["cloudsimpleextbearer","tokencaching","internalgraphapiversion","cae"].reduce(((e,t)=>{const s=MsPortalFx.getFeatureValue(t);return s&&(e[`feature.${t}`]=s),e}),{})})),
define("MsPortalImpl/Base/Base.BrowserDetection",["require","exports"],(function(e,t){"use strict";t.safari_11_webKitVersion=t.operaFeature=t.msieFeature=t.isTouch=t.isSafari=t.isOpera=t.isMac=t.isInstalledPwa=t.isIeOrEdgeNonChromium=t.isIPadOS=t.isIOS=t.isFirefox=t.isEdge=t.isChromiumEdge=t.isChromeOrEdgeChromium=t.isChromeIos=t.isChrome=t.isAndroidOrMobile=t.ffFeature=t.edgeFeature=t.edgeChromiumFeature=t.chromeFeature=void 0,t.subscribeToInstalledPwa=f,t.webKitVersion=void 0;const s=window.navigator.userAgent;const i=t.ffFeature="undefined"!=typeof InstallTrigger,o=t.operaFeature=!!window.opr&&!!window.opr.addons||!!window.opera||navigator.userAgent.includes(" OPR/"),n=t.edgeChromiumFeature=function(){let e=!1,t=!1;if(navigator.userAgentData){const{brands:s}=navigator.userAgentData;return s.forEach((s=>{"Chromium"===s.brand&&(e=!0),"Microsoft Edge"===s.brand&&(t=!0)})),e&&t}return!1}(),r=t.chromeFeature=!(!window.chrome||!window.chrome.webstore&&!window.chrome.loadTimes||n||o),a=t.msieFeature=!!document.documentMode,l=t.edgeFeature=!a&&!!window.StyleMedia,c=/^(?!.*chrome).*safari/i.test(navigator.userAgent),d=/Trident\//i.test(s),p=/ip(?:hone|od|ad)/i.test(s),u=/ipad/i.test(s),m=/CriOS/i.test(s);t.safari_11_webKitVersion=604;function g(e){return window.matchMedia(e).matches}let h=t.isInstalledPwa=g("(display-mode: standalone)");function f(e){const t=window.matchMedia("(display-mode: standalone)");return t.addEventListener("change",e),()=>t.removeEventListener("change",e)}f((e=>{t.isInstalledPwa=h=e.matches}));t.isFirefox=i;const x=t.isChrome=!(!r&&!m);t.isEdge=l,t.isChromiumEdge=n,t.isChromeOrEdgeChromium=n||x||o,t.isIeOrEdgeNonChromium=a||d||l,t.isSafari=c&&!m,t.isChromeIos=m,t.isAndroidOrMobile=/Mobile|Android/.test(s)||"true"===MsPortalFx.getFeatureValue("skipautofocus"),t.isIOS=p,t.isIPadOS=u,t.isMac=window.navigator.platform.includes("Mac"),t.webKitVersion=function(){const e=/AppleWebKit\/([\d.]+)/.exec(s);if(e)return parseFloat(e[1])}()||0,t.isTouch=function(){const e="-webkit- -moz- -o- -ms-".split(" ");return"ontouchstart"in window||g(`(${e.join("touch-enabled),(")}touch-enabled)`)}(),t.isOpera=o})),
define("MsPortalImpl/Base/Base.CssSelectorParser",["require","exports"],(function(e,t){"use strict";t.parseCssSelector=function(e){return e=e.replace("::after",":after").replace("::before",":before"),n=(e,t)=>t,d(e||"",!1)},t.subselectorToString=function(e){return e.map((e=>e.value)).join("")};const s=jQuery.find,i=s.selectors,o=s.selectors.match;let n;
/*!
   * -----------------------------------------------------------------------------
   * The portion of this file from here until "End of jQuery code snippet" is code
   * derived from the jQuery JavaScript Library v2.0.3 - http://jquery.com/
   * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors
   * Released under the MIT license - http://jquery.org/license
   * Date: 2013-07-03T13:30Z
   */const r="[\\x20\\t\\r\\n\\f]",a=new RegExp("^"+r+"+|((?:^|[^\\\\])(?:\\\\.)*)"+r+"+$","g"),l=new RegExp("^"+r+"*,"+r+"*"),c=new RegExp("^"+r+"*([>+~]|"+r+")"+r+"*"),d=function(e,t){let r,d,p,u;const m=n[e+" "];if(m)return t?0:m.slice(0);u=e;const g=[],h=i.preFilter;for(;u;){r&&!(d=l.exec(u))||(d&&(u=u.slice(d[0].length)||u),g.push(p=[])),r=!1,(d=c.exec(u))&&(r=d.shift(),p.push({value:r,type:d[0].replace(a," ")}),u=u.slice(r.length));for(const e in i.filter)!(d=o[e].exec(u))||h[e]&&!(d=h[e](d))||(r=d.shift(),p.push({value:r,type:e,matches:d}),u=u.slice(r.length));if(!r)break}return t?u.length:u?s.error(e):n(e,g).slice(0)};
/*!
   * End of jQuery code snippet
   * -----------------------------------------------------------------------------
   */let p;p=void 0})),
define("MsPortalImpl/Base/Base.CssSanitizer",["require","exports","MsPortalImpl/Base/Base.CssSelectorParser","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.ImplUtils"],(function(e,t,s,i,o){"use strict";t.cssTextModule4Directives=t.chromeOrEdgeChromiumWithSafariDirectives=t.CssSanitizerErrorTypes=void 0,t.domStylePropertyToCssProperty=x,t.firefoxAnyValueAcceptedCssDirectives=void 0,t.generateErrorMessage=w,t.getScopeName=b,t.mediaQueryToClass=y,t.safariAnyValueAcceptedCssDirectives=void 0,t.sanitizeDefinition=function(t){const s="."+b(t.name),i=[];return t.styleSheets=(t.styleSheets||[]).map((e=>v(e,s,i))),i.forEach((s=>{const i=`Sanitization error found in style sheet in extension: ${t.name}\n${w(s)}`;o.logToExtension(e,t.name,2,i)})),!i.length},t.sanitizeStyleDeclarationString=function(e,t,s){t.insertRule(".ignored1 { {0} }".format(e),0),t.insertRule(".ignored2 {}",1);const i=t.cssRules[0],o=t.cssRules[1];return i.type===CSSRule.STYLE_RULE?(S(i.style,o,s),o.style.cssText):(s.push("Not a style rule: "+e),null)},t.sanitizeStyleSheetText=v,t.stylePolicy=void 0;let n=["align-content","align-items","align-self","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-left","border-left-color","border-left-style","border-left-width","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-shadow","box-sizing","break-after","break-before","break-inside","clear","clip-path","color","content","counter-increment","counter-reset","cursor","display","direction","enable-background","fill","fill-rule","fill-opacity","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-emoji","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","gap","row-gap","column-gap","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-gap","grid-column-start","grid-column-end","grid-gap","grid-row","grid-row-end","grid-row-gap","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","height","justify-content","justify-items","left","letter-spacing","line-height","list-style-position","list-style-type","margin","margin-left","margin-top","margin-right","margin-bottom","max-height","max-width","min-height","min-width","opacity","order","orphans","outline","outline-color","outline-style","outline-width","overflow","overflow-wrap","overflow-x","overflow-y","padding","padding-top","padding-left","padding-right","padding-bottom","pointer-events","right","scroll-snap-align","scroll-snap-type","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","table-layout","text-align","text-decoration","text-decoration-color","text-decoration-line","text-decoration-style","text-decoration-thickness","text-indent","text-justify","text-orientation","text-transform","text-overflow","top","transform","transform-origin","transition","transition-delay","transition-duration","transition-property","transition-timing-function","user-select","vertical-align","visibility","white-space","widows","width","word-break","word-spacing","word-wrap","-webkit-line-clamp"];const r=t.firefoxAnyValueAcceptedCssDirectives=["-moz-box-orient","-moz-border-top-colors","-moz-border-right-colors","-moz-border-bottom-colors","-moz-border-left-colors"],a=t.chromeOrEdgeChromiumWithSafariDirectives=["background-repeat-x","background-repeat-y","transition-behavior","-webkit-border-horizontal-spacing","-webkit-border-vertical-spacing","-webkit-box-orient","-webkit-text-stroke-width","-webkit-text-fill-color","-webkit-text-stroke-color","-webkit-font-smoothing","-webkit-user-drag"],l=t.safariAnyValueAcceptedCssDirectives=["transform-origin-x","transform-origin-y","transform-origin-z","-webkit-box-shadow","-webkit-tap-highlight"],c=t.cssTextModule4Directives=["text-wrap","text-wrap-mode","text-wrap-style","white-space-collapse","white-space-trim"];n=n.concat(r),n=n.concat(a),n=n.concat(l),n=n.concat(c);const d=t.stylePolicy={};n.forEach((e=>{d[e]=1})),d["font-family"]=function(e){return/^ *["']?(?:Segoe UI|Consolas)["']? *(?:,|$)/.test(e)},d.position=["relative","absolute","static","inherit","sticky"],d["list-style-image"]=["none","inherit","initial"],d["text-transform"]=function(e){return"none"===e||"uppercase"===e||"lowercase"===e||"capitalize"===e},d["z-index"]=function(e){return parseInt(e,10)>=0};const p=/\(min-width: (\d+)px\)/,u=/\((min|max)-width: (\d+)px\)/,m=/\W/g,g=/[a-z|A-Z]+/g,h=Object.keys(d).map((function(e){let t=e.toLowerCase().match(g).reduce(((e,t,s)=>s>0?e+(t=t.charAt(0).toUpperCase()+t.slice(1)):e+t));"float"===t&&(t="cssFloat");return t}));var f;function x(e){return"cssFloat"===e?"float":(e||"").replace(/([A-Z])/g,"-$1").toLowerCase()}function b(e){return"css-scope-"+e.replace(m,"")}function y(e){return`fxt-mq-${"MINWIDTH"===e.type?"min":"max"}w-${e.pixels}`}function v(e,t,o,n){const r=document.implementation.createHTMLDocument(""),a=r.createElement("style");r.body.appendChild(a);const l=function(e,t){const s=t.createElement("style");t.body.appendChild(s),s.textContent=e;const i=s.sheet,o=i&&i.cssRules;return o?Array.prototype.slice.call(o,0):[]}(e,r),c=l.filter((e=>e.type===CSSRule.MEDIA_RULE)).reduce(((e,t)=>{const s=(r=t.media,i.isIeOrEdgeNonChromium?r.mediaText.split(",").map((e=>e.trim())):Array.from(r)).map((e=>e.replaceAll("all and ","").replace(/\((.*):\s*(.*)\)/,"($1: $2)").trim()));var r;s.filter((e=>!M(e))).forEach((e=>{!function(e,t,s){s.push(...e.map((e=>({type:f.MediaQuery,mediaQuery:t,errorMessage:e}))))}(["Media query is not allowed"],e,o)}));const a=s.filter((e=>M(e))).map((e=>{const t=function(e){const t=u.exec(e);return{type:"min"===t[1]?"MINWIDTH":"MAXWIDTH",pixels:Number(t[2])}}(e),s=y(t);return n&&n.push({mediaClass:s,mediaQuery:t}),"."+s}));if(0===a.length)return e;const l=function(e){const t=[];for(let s=0;s<e.length;s++)t[s]=e[s];return t}(t.cssRules).filter(T).map((e=>({selectorText:`${a.join()} ${e.selectorText}`,cssText:e.cssText,style:e.style,type:e.type})));return[...e,...l]}),[]),d=[...l,...c].filter(T).map((e=>{const i=function(e,t,i,o){const n=[],r=function(e,t,i){let o;const n=[];try{o=s.parseCssSelector(e)}catch(t){return i.push("Malformed selector: "+e+"\nException: "+t.toString()),null}return o.forEach((e=>{(function(e,t){return!e.some((e=>{if("CLASS"===e.type){if(e.value&&!e.value.startsWith(".ext-")&&!e.value.startsWith(".fxt-"))return t.push("Selectors can only refer to extension-specific class names (those starting with .ext- or .fxt-)"),!0}else if("ID"===e.type)return t.push("Selectors cannot refer to elements by ID"),!0}))})(e,i)&&n.push(t+" "+s.subselectorToString(e))})),n.join(", ")}(e.selectorText,i,n).replace(" .fxt-mq-",".fxt-mq-");if(C(n,e,o),r){t.insertRule(r+" {}",0);const s=t.cssRules[0],i=[];return S(e.style,s,i),C(i,e,o),s}return null}(e,a.sheet,t,o);return i?i.cssText:null}));let p=d.join("\n");return["ext-mode-light","ext-mode-dark","ext-mode-standardcontrast","ext-mode-highcontrast","ext-highcontrast-light","ext-highcontrast-dark"].forEach((e=>{const s=["{0} {1}","{1} {0}"].map((s=>s.format(t,"."+e)));p=p.replaceAll(s[0],s[1])})),p}function w(e){let t;if(e.type===f.StyleRule)t=`Invalid CSS property - ${e.errorMessage}\nCSS rule: ${e.rule.cssText}`;else t=`Invalid CSS Media Query - ${e.mediaQuery}\nMedia Query: ${e.errorMessage}`;return t}function M(e,t=[p]){return Boolean(t.some((t=>e.match(t))))}function C(e,t,s){s.push(...e.map((e=>({type:f.StyleRule,rule:t,errorMessage:e}))))}function S(e,t,s){const i=function(e){const t=[];for(let s=0,i=e.length;s<i;s++){const i=e[s];if(P[i]&&!(i in d))return F(e);t.push(i)}return t}(e);for(let o=0,n=i.length;o<n;o++){const n=i[o],r=e.getPropertyValue(n),a=e.getPropertyPriority(n);if("initial"===r)continue;const l=I(a,s);let c=null,p=null;if(d.hasOwnProperty(n)){c=n;const e=d[n];if(1===e)p=r;else if(e instanceof Array){const t=e.indexOf(r);t>=0&&(p=e[t])}else"function"==typeof e&&e(r)&&(p=r);p?t.style.setProperty(n,r,l):s.push("Disallowed style value. Property name: {0}, value: {1}".format(c,r))}else n.startsWith("--ext")?(c=n,p=r,t.style.setProperty(n,r,l)):s.push("Disallowed style property. Property name: "+n)}}function I(e,t){return e?(t.push("Disallowed CSS priority value: "+e),""):e}!function(e){e[e.MediaQuery=0]="MediaQuery",e[e.StyleRule=1]="StyleRule"}(f||(t.CssSanitizerErrorTypes=f={}));const P={};var _;function F(e){const t=[];for(let s=h.length-1;s>=0;s--){const i=h[s];e[i]&&t.push(x(i))}return t}function T(e){return e.type===CSSRule.STYLE_RULE}(i.isChromeOrEdgeChromium||i.isSafari)&&(_=P,[].forEach((e=>{_[e]=1})))})),
define("MsPortalImpl/Base/Base.KnockoutBindingSanitizer",["require","exports","MsPortalImpl/Base/Base.CssSanitizer"],(function(e,t,s){"use strict";t.sanitizeBindingAttribute=u,t.sanitizeBindingComment=function(e,t,s,i){const o=/^\s*ko\s([\s\S]*)/.exec(t);if(o){const t=u(e,o[1],"comment",s,i);return null===t?" ko ":" ko "+t+" "}if(/^\s *\/ko/.test(t))return" /ko ";return null};const i=v(g,f((function(e){return/^[-\w]+$/.test(e)}))),o={checked:g,click:g,clickBubble:g,commands:i,disable:g,disableAutoDispose:g,enable:g,event:b(["click","keypress","afterkeypress"]),foreach:v(g,b(["data","as"])),formElement:i,fxclick:g,htmlTemplate:i,if:g,ifnot:g,image:g,options:g,optionsText:y,optionsValue:y,sanitizedAttr:i,sanitizedCss:i,sanitizedHtml:g,selectedOptions:g,stringOrHtmlContent:g,style:x(((e,t)=>t.style.hasOwnProperty(s.domStylePropertyToCssProperty(e))),(function(e,t,i){const o=s.domStylePropertyToCssProperty(e),n=i.style[o],r=d.exec(t),a=r?t.slice(1,-1):null;let l=!1;1===n?l=!!r||g(t)===t:n instanceof Array?l=!!r&&n.includes(a):"function"==typeof n&&(l=!!r&&n(a));return l})),submit:g,text:g,uniqueName:g,visible:g,value:g,valueUpdate:(n=["afterkeyup"],function(e,t){return n.some((t=>e==='"'+t+'"'||e==="'"+t+"'"))?e:null}),vtext:g,with:g};var n;const r={$data:!0,$root:!0,$parent:!0,$parents:!0,$tabIndex:!0,$disabled:!0,$index:!0,$rawData:!0,$context:!0,$parentContext:!0,$dicontainer:!1,$extensionName:!1,$partName:!1,$ctl:!1,$vm:!1,$enabledTabIndex:!0,$component:!1,$componentTemplateNodes:!1,$element:!1,$ko:!1,$subscribable:!1},a={attr:"sanitizedAttr",css:"sanitizedCss",html:"sanitizedHtml"};const l="pc",c=["===","==","!==","!=","<=","<",">=",">","&&","||","-","+","*","/"],d=/^(?:"(?:[^"\\]|\\.)*"|'(?:[^'\\]|\\.)*')$/,p=/^[a-z_$][\w$]*$/i;function u(e,t,s,i,n){const r=[],c=ko.expressionRewriting.parseObjectLiteral(t);let d=!0;return c.forEach((function(t){const c=(t.key||t.unknown||"").trim(),p=function(e){return a[e]||e}(c);let u=o[p];if(!u&&p.startsWith(l)&&(u=g),u){const o=(t.value||"").trim(),a=u(o,i,e.windowContext);null!==a?r.push(m(p)+": "+a):(d=!1,n.push({provenanceContext:e,reason:6,tag:s,binding:c,val:o}))}else d=!1,n.push({provenanceContext:e,reason:5,tag:s,binding:c})})),d?r.join(", "):null}function m(e){return e&&!d.test(e)&&(p.test(e)||(e="'"+e.replace("'","\\'")+"'")),e}function g(e){const t=h(e);if(null!==t)return t;for(let t=0;t<c.length;t++){const s=e.split(c[t]);if(2===s.length&&h(s[0].trim())&&h(s[1].trim()))return e}return null}function h(e){if(/^!?(?:[$\w.'\-"[\]]|\(\))+$/.test(e)||/^\{\s*\}$/.test(e)){let t;const s=/(\$\w+)/g;for(;t=s.exec(e);){const e=t[1];if(!0!==r[e])return null}const i=/(?:\$context\.|\$parentContext\.)(?!\$context\b|\$parentContext\b)([$\w]+)/g;for(;t=i.exec(e);){const e=t[1];if(!0!==r[e])return null}return/\$context(?:[^.]|$)|\$parentContext(?:[^.]|$)/.test(e)||(/\b_?this\b/.test(e)||/\b(?:eval|new\s+Function|setTimeout|setInterval)\b/.test(e))?null:e}return null}function f(e){return x(e,((e,t,s)=>!!g(t)))}function x(e,t){return function(s,i){const o=ko.expressionRewriting.parseObjectLiteral(s),n=[];let r=!0;return o.forEach((function(s){const o=(s.key||"").trim(),a=(s.value||"").trim();e(o,i)&&t(o,a,i)?n.push(m(o)+": "+a):r=!1})),r?"{ "+n.join(", ")+" }":null}}function b(e){return f(((t,s)=>e.includes(t)))}function y(e){return/^"[^"]*"$/.test(e)||/^'[^']*'$/.test(e)?e:null}function v(...e){return function(t,s){let i,o;for(i=0;i<e.length;i++)if(o=e[i](t,s),null!==o)return o;return null}}})),
define("MsPortalImpl/Base/Base.LruMap",["require","exports"],(function(e,t){"use strict";t.LruMap=void 0;t.LruMap=class{count(){return this._count}constructor(e){this._map=Object.create(null),this._count=0,this._lastAccessed=0,this._capacity=e}contains(e){return!!this._map[e]}trim(e){"number"!=typeof e&&(e=this._capacity);let t=this.count()-e;if("number"!=typeof e||t<1)return;const s=this._lastAccessed-e+1;MsPortalFx.forEachKey(this._map,((e,t,i)=>{t.lastAccessed<s&&i.push(t)}),[]).sort(((e,t)=>t.lastAccessed-e.lastAccessed)).some((e=>(delete this._map[e.key],t--,t<1))),this._count=e}getOrAdd(e,t){const s=this._map[e];let i;if(s)s.lastAccessed=++this._lastAccessed,i=s.data;else{if(!t)throw new Error(`Unable to find item with key: '${e}'.`);i=t(e),this.addOrUpdate(e,i)}return i}addOrUpdate(e,t,s){const i=this._map[e];return i?(i.data=t,i.lastAccessed=++this._lastAccessed):(this._map[e]={key:e,data:t,lastAccessed:++this._lastAccessed},this._count++,s||this.trim()),!i}remove(e){this._map[e]&&(this._count--,delete this._map[e])}}})),
define("MsPortalImpl/Base/Base.Sanitization",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.ImplUtils","FxInternal/Utils/LinkSanitizer"],(function(e,t,s,i,o){"use strict";t.getAllowListedAttr=function(){return u},t.sanitizeLinkUri=function(e,t){if(""===e||a.test(e))return e;if((0,i.validateAbsoluteHttpUri)(e)||n.test(e)){const s=(0,i.getLocationFromContext)(t.diContainer,t.windowContext).extension;return d(t).getSafeLink(e,s)}return!1},t.sanitizeUri=function(t,s,o){const n=c(t,s,o);n||(0,i.logToExtension)(o&&o.localRequire||e,o&&o.windowContext||null,2,"Disallowed URI: "+t);return n},t.validateDataImage=function(e){return""===e||l.test(e)},t.validateLinkUri=function(e,t){if(""===e||a.test(e)||(0,i.validateAbsoluteHttpUri)(e)||n.test(e))return p(e,t),!0;return!1},t.validateLocalUriOnly=function(e){return""===e||a.test(e)},t.validateUriOrBlank=c;MsPortalFx.Base.Diagnostics;const n=/^(?:vstfs:|ftp:|ftps:|sftp:|storageexplorer:|adlalink:|adl:|asalink:|vsweb:|azuredatastudio:|bfcomposer:|ms-quick-assist:|ms-remote-help:)?\/\/|^mailto:|^vscode:/,r=/^#(?:allservices|asset|blade|create|dashboard|home|menu|resource)\b/,a=/^#/,l=/^data:image\//;function c(e,t,s){return!!(""===e||(0,i.validateAbsoluteHttpUri)(e)||n.test(e)||"_self"===t&&r.test(e))&&(p(e,s),!0)}function d(e){return(e?.diContainer||s.container).get(o.LinkSanitizer)}function p(e,t){const s=(0,i.getLocationFromContext)(t?.diContainer,t?.windowContext).extension;if(FxImpl.features.isEnabled("logexternaldomainlinks")&&!d(t).isTrustedDomainLink(e,s)){const s=MsPortalFx.sanitizeMessage(e);(0,i.logIncludingProvenance)(1,"Link is external to the known valid domains: "+s,t)}}const u=["alt","border","colspan","rowspan","span","disabled","height","width","lang","spellcheck","title","value","dx-content-path","dx-content-property","cx","cy","d","rx","ry","x","y","x1","x2","y1","y2","fill","fill-rule","opacity","points","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-width","transform","vector-effect","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-current","aria-disabled","aria-expanded","aria-haspopup","aria-hidden","aria-invalid","aria-label","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","role"]})),
define("MsPortalImpl/Base/Base.KnockoutTemplateSanitizer",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.KnockoutBindingSanitizer","MsPortalImpl/Base/Base.CssSanitizer","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.LruMap"],(function(e,t,s,i,o,n,r,a){"use strict";t.isAllowedCssClassName=t.TemplateSanitizer=t.KODeniedTemplateSanitizer=t.KOAllowedTemplateSanitizer=t.Impl=void 0,t.sanitizeBladeDefinition=function(e,t,s,i){s.isWeave||(s.lenses||[]).forEach((o=>{(o.partInstances||[]).forEach((o=>{m(e,t,`${s.name}/${o.name}`,o.inline,i)}))}))},t.sanitizeDefinition=function(e,t,i=s.container){g.sanitizeDefinition(e,t,i)},t.sanitizeHTML=function(e,t,i,o){return s.container.get(w).sanitize({value:e,localRequire:t,windowContext:i,diContainer:s.container},o)},t.sanitizeHTML_DenyKO=function(e,t,i,o){return s.container.get(M).sanitize({value:e,localRequire:t,windowContext:i,diContainer:s.container},o)},t.sanitizeInlineTemplate=m;MsPortalFx.Base.Diagnostics;const l=/^(?:az-|ms-|msportalfx|ext-|lang-|fxt-)[\w-]+$/,c=MsPortalFx.getUniqueId().toLowerCase(),d={sanitizeLinkUri:(e,t,s,i,o,n,a)=>r.sanitizeLinkUri(e,a),validateUriOrBlank:(e,t,s,i,o,n,a)=>r.validateUriOrBlank(e,null,a),validateLocalUriOnly:r.validateLocalUriOnly,validateClassNames:function(e,t,s,i,o,n,r){const a=/[\w-]+/g;let l;const c=[];for(;l=a.exec(e);){const e=l[0];f(e)?c.push(e):n.push({provenanceContext:r,reason:2,tag:t,val:e})}return c.join(" ")||null},validateKOBindingString:function(e,t,s,i,n,r,a){return o.sanitizeBindingAttribute(a,e,t,n,r)},mapName:function(e,t,s,i){return i.setAttribute(s,"TemplateSanitizer"+c+"_"+e),!1}},p=["src"],u="data-sanitizer-"+c+"-";function m(e,t,s,i,o){const n=i&&i.htmlTemplateInline;n&&h(e,t,s,n,o,(()=>{n.content=null}))}var g;function h(t,s,i,o,n,r){const a=t.get(w).sanitize({contextData:{File:o.file,TemplateKey:i},diContainer:t,localRequire:e,value:o.content,windowContext:s});!a.errors.length||0===n?o.content=a.sanitizedMarkup:r()}!function(e){e.sanitizeDefinition=function(e,t,i=s.container){const o=e.name;MsPortalFx.forEachKey(e.htmlTemplates,((s,n)=>{h(i,o,s,n,t,(()=>{delete e.htmlTemplates[s]}))}))}}(g||(t.Impl=g={}));const f=function(e){return"string"==typeof e&&l.test(e)};t.isAllowedCssClassName=f;const x=(()=>{function e(e){return e.length?t(e):1}function t(t){const s={};return t.forEach((function(t){if("string"==typeof t)s[t]=1;else for(const i in t){const o=t[i];s[i]=o instanceof Function?o:e(o)}})),s}const s=["ABBR","ADDRESS","ARTICLE","B","BLOCKQUOTE","BR","CAPTION","CITE","CODE","COL","COLGROUP","DD","DEL","DFN","DIV","DL","DT","EM","FIELDSET","FIGURE","FIGCAPTION","FONT","FOOTER","HEADER","H1","H2","H3","H4","H5","H6","HR","I","INS","LABEL","LEGEND","MARK","OL","P","PRE","Q","S","SECTION","SMALL","SPAN","STRONG","SUB","SUP","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","U","UL",{A:[{href:d.sanitizeLinkUri},"target"]},{BUTTON:["value"]},{IMG:[S("src",d.validateUriOrBlank)]},{INPUT:[{type:["text","password","radio","checkbox","submit"]},"checked","maxlength","value"]},{LI:["value"]},{OPTION:["label","selected","value"]},{SELECT:["multiple","size"]},{TEXTAREA:["rows","cols"]},{TIME:["datetime"]},{SVG:["viewBox","focusable",{"xmlns:xlink":d.validateUriOrBlank},{"xmlns:svg":d.validateUriOrBlank},{xmlns:d.validateUriOrBlank}]},{CIRCLE:["r"]},"DEFS","DESC",{ELLIPSE:["id"]},{G:["id"]},{LINE:["id"]},"METADATA",{PATH:["id"]},{POLYGON:["id"]},{POLYLINE:["id"]},{RECT:["id"]},{STOP:["offset"]},{TEXT:["id","font-size"]},"TITLE",{USE:["id",{"xlink:href":d.validateLocalUriOnly}]},{AUDIO:[S("src",d.validateUriOrBlank),"controls","currentTime","duration","preload"]},{VIDEO:[S("src",d.validateUriOrBlank),"controls","poster","preload","autoplay"]},{SOURCE:[S("src",d.validateUriOrBlank),"type"]}],i=[{"data-bind":d.validateKOBindingString},{class:d.validateClassNames},{name:d.mapName},"dx-content-path","dx-content-property","data-click-telemetry",{"data-activatable":["true","false"]},"data-activate-info"].concat(...r.getAllowListedAttr());return{style:n.stylePolicy,elements:{tags:t(s),global:t(i)},comments:o.sanitizeBindingComment}})(),b=[];function y(e,t,s){const a=document.implementation.createHTMLDocument(""),l=document.createDocumentFragment(),c=FxImpl.createElement("div"),m=x.elements,g=m.tags,h=m.global,f=[];let y=!1,v=e.value||"";l.appendChild(c);try{p.forEach((e=>{v=C(v,e,u+e)}))}catch(t){i.log(e,s,`An error occured processing the untrustedHTMLString '${v}'.\nuntrustedHTMLString is now set to empty string to prevent further errors.\nError message was: '${t.message}'.\nReview binding and any other context provided.`,{untrustedHTMLString:v}),v=""}a.body.innerHTML=v;const w=a.createElement("style");w.setAttribute("type","text/css"),a.head.appendChild(w);const M=w.sheet;function S(s,i,o,n){if(o.hasAttribute(s)&&!n.hasAttribute(s)){const r=o.getAttribute(s),a=[],l=function(s,i,o,n,r,a){if(!t&&s===d.validateKOBindingString)return null;if(/<\/title\b/i.test(i))return null;if(1===s)return i;if("object"==typeof s)return i in s?i:null;if(s instanceof Function){const t=s(i,o,n,r,x,a,e);return"boolean"==typeof t?!0===t?i:null:"string"==typeof t?t:null}return null}(i,r,o.nodeName.toUpperCase(),s,n,a);null!==l&&n.setAttribute(s,l),a.length>0?a.forEach((e=>{f.push(e)})):null===l&&f.push({provenanceContext:e,reason:1,tag:o.nodeName.toUpperCase(),attr:s,val:r})}}function I(e,t,s){if("object"==typeof s)for(let i=0,o=e.attributes,n=o.length;i<n;i++){const n=o[i].name;n in s&&S(n,s[n],e,t)}}!function s(i,l){const c=i.nodeName.toUpperCase();if(i.nodeType===Node.ELEMENT_NODE&&(y||(y=i!==a.body)))if(g[c]){const t=FxImpl.createElement(c);I(i,t,g[c]),I(i,t,h);const s=i.getAttribute("style");if(s){const i=[],o=n.sanitizeStyleDeclarationString(s,M,i);i.forEach((t=>{f.push({provenanceContext:e,reason:3,tag:c,attr:"style",val:t})})),t.setAttribute("style",o)}if("A"===c){const s=i.getAttribute("href"),o=i.getAttribute("target");!MsPortalFx.isNullOrWhiteSpace(s)&&r.validateUriOrBlank(s,null,e)&&((MsPortalFx.isNullOrWhiteSpace(o)||"_self"===o)&&t.setAttribute("target","_blank"),t.setAttribute("rel","noopener"))}l.appendChild(t),l=t}else if(f.push({provenanceContext:e,reason:4,tag:c}),!MsPortalFx.isFeatureEnabled("oldsanitizer"))return l;for(let n=0,r=i.childNodes,a=r.length;n<a;n++){const i=r[n];switch(i.nodeType){case Node.TEXT_NODE:l.appendChild(document.createTextNode(i.textContent));break;case Node.ELEMENT_NODE:s(i,l);break;case Node.COMMENT_NODE:{const s=x.comments;if(!(!t&&s===o.sanitizeBindingComment)&&s&&s instanceof Function){const t=[],o=s(e,i.textContent,x,t);null!==o&&l.appendChild(document.createComment(o)),t.length>0&&t.forEach((e=>{f.push(e)}))}break}}}return l}(a.body,c),f.forEach((e=>function(e,t){const s=b[e.reason]||"Unknown";i.log(e.provenanceContext,t,"Sanitization error found: "+s,{Tag:e.tag,Attribute:e.attr,Binding:e.binding,Value:e.val})}(e,s)));let P=c.innerHTML;return p.forEach((e=>{P=C(P,u+e,e)})),{sanitizedMarkup:P,errors:f}}b[1]="Invalid attribute",b[2]="Invalid CSS class name",b[3]="Invalid CSS property",b[4]="Invalid tag",b[5]="Unknown or prohibited binding",b[6]="Invalid binding value";class v{constructor(e){this._allowKnockoutBindings=e,this._templateCache=new a.LruMap(100),this.executionCount=0}sanitize(e,t=2){const s=e.value||"";return this._templateCache.getOrAdd(s,(()=>(this.executionCount++,y(e,this._allowKnockoutBindings,t))))}}t.TemplateSanitizer=v;let w=t.KOAllowedTemplateSanitizer=class extends v{constructor(){super(!0)}};t.KOAllowedTemplateSanitizer=w=__decorate([__metadata("fx:diagnostics",[e,"KOAllowedTemplateSanitizer"]),s.Class(),__metadata("design:paramtypes",[])],w);let M=t.KODeniedTemplateSanitizer=class extends v{constructor(){super(!1)}};function C(e,t,s){if(!e)return e;const i=new RegExp("(\\s+)"+t+"(\\s*\\=)","g");return e.replace(i,"$1"+s+"$2")}function S(e,t){const s={};return s[u+e]=t,s}t.KODeniedTemplateSanitizer=M=__decorate([__metadata("fx:diagnostics",[e,"KODeniedTemplateSanitizer"]),s.Class(),__metadata("design:paramtypes",[])],M)})),
define("MsPortalImpl/Controls/ControlBindings",["require","exports"],(function(e,t){"use strict";t.controlBindingMap=void 0;const s=ko.bindingHandlers,i=t.controlBindingMap={};function o(e,t){i[e]=t}o(127,"pcAccordion"),o(20,"pcArtifactLinks"),o(106,"pcAsyncFileUpload"),o(16,"pcAttachment"),o(63,"pcChart"),o(7,"pcCheckBoxField"),o(208,"pcClipboardButton"),o(75,"pcConsole"),o(40,"pcCopyableLabel"),o(85,"pcCreatorAndSelectorV2"),o(23,"pcCustomHtmlField"),o(91,"pcCustomValueSlider"),o(111,"pcCustomRangeSlider"),o(25,"pcDatePickerField"),o(26,"pcDateTimePickerField"),o(27,"pcDateTimeRangePickerField"),o(92,"pcDayPickerField"),o(76,"pcDeleteAssetConfirmation"),o(33,"pcDiffEditor"),o(32,"pcDockedBalloon"),o(65,"pcDonut"),o(3,"pcDropDownField"),o(99,"pcDurationPickerField"),o(15,"pcSection"),o(37,"pcEditor"),o(120,"pcEssentials"),o(82,"pcFileDownloadButton"),o(12,"pcFilterComboField"),o(67,"pcGraph"),o(125,"pcEditableGrid"),o(131,"pcDataGrid"),o(132,"pcPagedDataGrid"),o(133,"pcSequentialDataGrid"),o(98,"pcGroupDropDownField"),o(77,"pcHeroBanner"),o(19,"pcHistory"),o(84,"pcHotSpot"),o(108,"pcIFrame"),o(113,"pcIFrame2"),o(78,"pcInfoBox"),o(121,"pcIntuneAppFileUpload"),o(118,"pcLegend"),o(88,"pcHotSpot"),o(87,"pcInfoBox"),o(58,"pcLogStream"),o(68,"pcMap"),o(115,"pcMenu"),o(69,"pcMetrics"),o(126,"pcMonitorChart"),o(126,"pcMonitorChartV2"),o(204,"pcMetricGrid"),o(13,"pcMultiLineTextField"),o(79,"pcNotice"),o(10,"pcNumericTextBoxField"),o(29,"pcOAuthButtonField"),o(213,"pcOAuthButtonV2Field"),o(4,"pcOptionsGroupField"),o(209,"pcPager"),o(212,"pcPager2"),o(70,"pcPairedTimeline"),o(94,"pcPairedTimelineBadges"),o(5,"pcPasswordField"),o(39,"pcCheckBox"),o(42,"pcDropDown"),o(43,"pcFilterCombo"),o(54,"pcGrid"),o(56,"pcObsoleteListView1"),o(110,"pcMarkdown"),o(45,"pcMultiLineTextBox"),o(46,"pcMultiselectDropDown"),o(47,"pcNumericTextBox"),o(48,"pcOptionPicker"),o(49,"pcPassword"),o(50,"pcRangeSlider"),o(52,"pcSlider"),o(57,"pcTreeView"),o(128,"pcPill"),o(129,"pcPillCollection"),o(123,"pcPillList"),o(89,"pcPreviewTag"),o(71,"pcProgressBar"),o(72,"pcQuotaGauge"),o(9,"pcRangeSliderField"),o(93,"pcSearchBox"),o(86,"pcRangeSelection"),o(114,"pcResourceFilter"),o(11,"pcSelectorField"),o(100,"pcSimpleButton"),o(206,"pcRecommendations"),o(97,"pcChart"),o(73,"pcSingleValueGauge"),o(6,"pcSliderField"),o(21,"pcSplitter"),o(207,"pcSplitter2"),o(134,"pcSummary"),o(135,"pcPricingControl"),o(124,"pcResourceDropDown"),o(136,"pcTagsByResource"),o(101,"pcTextBlock"),o(2,"pcTextField"),o(24,"pcTimePickerField"),o(62,"pcToolbar"),o(22,"pcTriStateCheckBox"),o(116,"pcVideo"),o(119,"pcHeatMap"),o(137,"pcArmErrorList"),o(138,"pcDocsControl"),o(201,"pcFileShareDropDown"),o(202,"pcStorageAccountDropDown"),o(205,"pcToggle"),o(104,"pcList2"),o(203,"pcBlobContainerDropDown"),o(210,"pcManagementGroupDropDown"),o(211,"pcTabMenu"),o(214,"pcOpenCesCvaSurvey");const n={};function r(e,t,i){const o=ko.unwrap(e());if(o){const e=t[o.controlType];if(!e)throw new Error(`Unsupported ControlType in formControl binding handler: ${o.controlType}. Extension: ${i.$extensionName} ContentName: ${i.$partName}`);return s[e]}}function a(e,t,s,i,o,n){const a=r(t,n,o);if(a){const n=$(e);return n.attr("data-formelement",n.attr("data-bind")),a.init(e,t,s,i,o)}}function l(e,t,s,i,o,n){if(e){const a=r(t,n,o);if(a)return a.update(e,t,s,i,o)}}[127,20,16,7,208,85,23,91,111,25,26,27,92,138,3,99,15,120,201,12,98,124,19,108,113,110,13,8,10,29,4,5,128,129,123,135,89,9,11,6,21,207,202,134,136,2,24,22,210,214].forEach((e=>n[e]=i[e])),s.pcControl={init:function(e,t,s,o,n){return a(e,t,s,o,n,i)},update:function(e,t,s,o,n){return l(e,t,s,o,n,i)}},s.formElement={init:function(e,t,s,i,o){return a(e,t,s,i,o,n)},update:function(e,t,s,i,o){return l(e,t,s,i,o,n)}}})),
define("Viva.Controls/Controls/Base/Viva.KnockoutExtensions",["require","MsPortalImpl.Controls/Controls/Base/WidgetBinding"],(function(e,t){"use strict";const s=ko.bindingHandlers;s.stopBindings={init:function(e,t,s,i){return{controlsDescendantBindings:ko.unwrap(t())}}};const i="__ko__disableAutoDispose",o=ko.utils.domNodeIsAttachedToDocument;function n(e){const s=t.createIsolatedContext(e.$data,e);return s.createChildContext=function(s,i){return t.createIsolatedContext(s,e)},s}ko.utils.domNodeIsAttachedToDocument=function(e){return!!$(e).data(i)||o.call(this,e)},s.disableAutoDispose={init:(e,t,s)=>{$(e).data(i,!0)}},s.privateTemplate={init:function(e,t,i,o,r){return s.template.init(e,t,i,o,n(r))},update:function(e,t,i,o,r){return s.template.update(e,t,i,o,n(r))}};const r={};s.vivaControl={registerCallback:function(e){const t=MsPortalFx.getUniqueId();return r[t]=e,t},unregisterGuid:function(e){delete r[e]},init:function(e,t,i,o,n){const a=ko.unwrap(t()),l=r[a];return ko.utils.domNodeDisposal.addDisposeCallback(e,(function(){const e=l().ltm;s.vivaControl.unregisterGuid(a),MsPortalFx.disposeDisposable(e)})),s.privateTemplate.init(e,l,i,o,n)},update:function(e,t,i,o,n){const a=ko.unwrap(t()),l=r[a];return s.privateTemplate.update(e,l,i,o,n)}}})),
define("Viva.Controls/Util/Viva.Util",["require","exports"],(function(e,t){"use strict";t.DOMTokenListShim=void 0,t.cloneEvent=function(e,t){const s=t||e.type;return $.Event(e,{type:s,target:e.target,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,currentTarget:e.currentTarget,isImmediatePropagationStopped:e.isImmediatePropagationStopped,isPropagationStopped:e.isPropagationStopped,preventDefault:e.preventDefault,stopImmediatePropagation:e.stopImmediatePropagation,stopPropagation:e.stopPropagation})},t.executeSetFocusOn=i,t.existsOrRegisterId=function(e,t){const s=!e.includes(t);s&&e.push(t);return!s},t.fillObserableFields=function(e,t,s){const i=s?s.length:0;let o,n,r;for(let a=0;a<i;a++)o=s[a],n=t[o]||ko.observable(),r=e[o],n(ko.isObservable(r)?r.peek():r),t[o]||(t[o]=n)},t.findContainingControl=function(e){if(e){const t=$(e);let s;if(t.attr("data-control"))return e;if(s=t.closest("[data-control='true']"),s.length>0)return s[0]}return null},t.forceScreenRead=function(e,t){let s,i;switch(e.tagName){case"TABLE":s="tr";break;case"TR":s="td";break;case"UL":s="li";break;default:s="span"}t&&(i=e.getAttribute("aria-live"),e.setAttribute("aria-live","assertive"));const o=FxImpl.createElement(s);e.appendChild(o),e.removeChild(o),t&&(i?e.setAttribute("aria-live",i):e.removeAttribute("aria-live"))},t.getClassList=function(e){const t=e.getAttribute("class");return t?new n(t):new n},t.getObjectBasicShape=function(e,t=!0){const s=Object.keys(e);return t?s.sort(((e,t)=>e<t?1:-1)):s},t.getScrollableParents=function(e,t){let s=e.parents().filter((function(e,t){const s=$(t),i=s.css("overflow-x"),o=s.css("overflow-y");return!("hidden"===i&&"hidden"===o||"visible"===i&&"visible"===o)}));t&&(s=s.add(window));return s},t.setClassList=function(e,t){e.setAttribute("class",t._fields.join(" "))},t.setFocusToFirstFocusableChild=function(e,t){const s="[data-focus-first='true']",i=":not("+s+")",n="[data-canfocus='true']",r=function(e){return e};let a=!1;t&&(a=o(e,n+s,t),a||(a=o(e,n+i,t)));a||(a=o(e,n+s,r),a||(a=o(e,n+i,r)));return a},t.shapeContains=function(e,t){if(t.length<=e.length){let s=-1;for(let i=0;i<t.length;i++){const o=t[i];if(s=MsPortalFx.findIndex(e,(e=>e===o),s+1),s<0)return!1}return!0}return!1};var s=MsPortalFx.isNullOrUndefined;function i(e){let t;return!(!$(e).attr("data-canfocus")||(t=e["data-canfocus"],!t))&&t()}function o(e,t,o){let n,r,a,l=0;do{if(n=null,a=e.find(t+":eq("+l+")"),a.length>0&&(n=a[0],r=o(n),r&&i(n)))return!0;l++}while(!s(n));return!1}class n{constructor(e=null){this._fields=e?e.split(" "):[]}add(e){this._fields.includes(e)||this._fields.push(e)}remove(e){for(;this._fields.includes(e);)this._fields.splice(this._fields.indexOf(e),1)}contains(e){return this._fields.includes(e)}get length(){return this._fields.length}toggle(e){return this._fields.includes(e)?(this.remove(e),!1):(this.add(e),!0)}item(e){return this._fields[e]}toString(){return this._fields.toString()}}t.DOMTokenListShim=n})),
define("_generated/Less/MsPortalImpl.Controls/Controls/Base.css",["module"],(function(e){"use strict";return{css:".fxc-base-fill-container-width{width:100%}.fxc-base-fill-container-height{height:100%}.fxc-base-loading{position:relative;height:100%}.fxc-base-loading .fxc-base-loadingImage{position:absolute;top:calc(50% - 30px/2);left:calc(50% - 30px/2)}",moduleId:e.id}})),
define("MsPortalImpl.Controls/Controls/Base/Base",["require","exports","Viva.Controls/Controls/Base/Viva.KnockoutExtensions","Fx/DependencyInjection","Viva.Controls/Util/Viva.Util","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl.Controls/Controls/Base/WidgetBinding","FxInternal/ProxiedObservables","MsPortalImpl/Base/Base.ElementWidgetMap","FxInternal/Css","_generated/Less/MsPortalImpl.Controls/Controls/Base.css","MsPortalImpl/Controls/ControlBindings","MsPortalImpl/UI/Compositions/UI.Composition"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m){"use strict";t.WidgetUIState=t.Widget=void 0,t.getWidget=function(e,t){return MsPortalFx.first(x(e,t))||null},t.getWidgets=x,t.isViewModelTrusted=b,t.setTrustedViewModel=function(e){return e._isTrusted=!0,e};var g=MsPortalFx.Base.Diagnostics.Telemetry;(0,d.injectCss)(p);const h="remove.fxWidget",f="fxs-display-none";function x(e,t){return(t?c.getAllMatch(e[0],t):c.getAll(e[0]))||[]}function b(e){return!!e._isTrusted}t.WidgetUIState=class{constructor(){this.tabIndex=ko.observable(0),this.disabled=ko.observable(!1),this._ltm=new FxImpl.TriggerableLifetimeManager}dispose(){this._ltm.dispose()}};t.Widget=class{constructor(t,s,o={},d){if(this._destroyIds=[],this._cssClassMap={},!t||!t.length)throw new Error("You must specify an element to associate a control to it. Your element is either null or an empty collection.");(0,l.setPoUndefined)(this),this.isTrusted=o.isTrusted||b(s),this.element=t,this.vm=s,this.state=d;const p=this.weaveContext=o.weaveContext,u=this.ltm=new FxImpl.TriggerableLifetimeManager;this.vmBasicOption={ltm:u},d&&u.registerForDispose(d),this._bindingContext=p?null:o.bindingContext;const m=p?null:this._bindingContext||a.contextFor(t);this._diContainer=o.diContainer||p&&p.diContainer||m&&m.$dicontainer||i.container,c.set(t[0],this);const g=s.controlType;if(0!==g&&94!==g){let e;const i=t.attr("data-bind")||"";if(i.length&&i.includes("visible")){e=(ko.expressionRewriting.parseObjectLiteral(i)||[]).some((e=>"visible"===e.key))}if(!e){const e=s.visible;e&&e.subscribeAndRun(this.ltm,(e=>{MsPortalFx.isNullOrUndefined(e)||t.toggleClass(f,!e)}))}}const h=s&&s.cssClass;h&&h.subscribeAndRun(u,(s=>{s=s||"";const i=this._cssClassMap;this._cssClassMap={},s.split(/\s+/).forEach((s=>{s&&(this.isTrusted||r.isAllowedCssClassName(s)?(this._cssClassMap[s]=s,delete i[s]):(0,n.logToExtension)(e,t,2,`Invalid control css class name: ${s}`))}));const o=Object.keys(i);o.length&&this.element.removeClass(o.join(" "));const a=Object.keys(this._cssClassMap);a.length&&this.element.addClass(a.join(" "))})),this._registerDispose(),MsPortalFx.isFeatureEnabled("controlstelemetry")&&0!==g&&(this._initializeTelemetry(),this._attachTelemetryEvents(),this._trace({action:"ControlInitialized"}))}isDisposed(){return this._destroyIds.length>0}dispose(){if(this._checkExistsOrRegisterDestroyId(null))return;this.ltm&&this.ltm.dispose();const e=this.element;e.removeClass(`${f} ${Object.keys(this._cssClassMap).join(" ")}`),c.remove(e[0],this),this._disposeCallback&&(this._unregisterDispose(),this._disposeCallback=null)}_checkExistsOrRegisterDestroyId(e){return o.existsOrRegisterId(this._destroyIds,e)}_cleanDescendants(){ko.utils.cleanDescendantNodes(this.element)}_cleanElement(...e){const t=this.element;this.weaveContext||this._cleanDescendants(),e.length&&t.removeClass(e.join(" ")),this.weaveContext||t.empty()}_registerDispose(){const e=this.element;this._bindingContext?ko.utils.domNodeDisposal.addDisposeCallback(e[0],this._disposeCallback=e=>{this.dispose()}):e.on(h,this._disposeCallback=t=>{t.target!==e[0]||this._destroyTriggered||(this._destroyTriggered=!0,this.dispose())})}_unregisterDispose(){const e=this.element,t=this._disposeCallback;this._bindingContext?ko.utils.domNodeDisposal.removeDisposeCallback(e[0],t):e.off(h,t)}_trace(e){this._telemetryInfo||this._initializeTelemetry();const t=ko.unwrap(this.vm.telemetryName);g.trace({source:this._telemetryInfo.telemetrySource,extension:this._telemetryInfo.extensionName,name:t||FxImpl.Po.getMetadataId(this.vm),action:e.action,actionModifier:e.actionModifier,data:{controlType:this._telemetryInfo.controlType,vmKind:this._telemetryInfo.vmKind,...e.data},lowPriority:!0})}_startTrace(e){this._telemetryInfo||this._initializeTelemetry();const t=ko.unwrap(this.vm.telemetryName);return g.startTrace({source:this._telemetryInfo.telemetrySource,extension:this._telemetryInfo.extensionName,name:t||FxImpl.Po.getMetadataId(this.vm),action:e.action,actionModifier:e.actionModifier,data:{controlType:this._telemetryInfo.controlType,vmKind:this._telemetryInfo.vmKind,...e.data},lowPriority:!0})}_initializeTelemetry(e){const t=this.vm.controlType,s=this.element.closest(".fxs-blade")[0],i=s&&$.data(s,m.CompositionInstanceDataName),o=i&&i.locator,n=o&&o.toFriendlyString(),r=o&&o.getExtensionName(),a=u.controlBindingMap[t]||t||"UNKNOWN",l=this.vm.vmKind||"INVALID";this._telemetryInfo={telemetrySource:n,extensionName:r,controlType:a,vmKind:l}}_attachTelemetryEvents(){const e=this.element,t=()=>{this._trace({action:"ControlClicked",actionModifier:"click"})},s=()=>{this._focusTrace&&(g.cancelTrace(this._focusTrace),this._focusTrace=null),this._focusTrace=this._startTrace({action:"ControlFocused",actionModifier:"focusout"}),this._trace({action:"ControlFocused",actionModifier:"focusin"})},i=()=>{this._focusTrace?(g.endTrace(this._focusTrace,"focusout"),this._focusTrace=null):this._trace({action:"ControlFocused",actionModifier:"focusout"})};e.on("focusin",s),e.on("focusout",i),e.get(0).addEventListener("click",t,!0),this.ltm.registerForDispose((()=>{e.off("focusin",s),e.off("focusout",i),e.get(0).removeEventListener("click",t,!0),this._focusTrace&&g.cancelTrace(this._focusTrace)}))}}})),
define("MsPortalImpl.Controls/Controls/Base/OptionsBase",["require","exports","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl.Controls/Controls/Base/WidgetBinding","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","FxInternal/Weave","FxInternal/Css","_generated/Less/MsPortalImpl.Controls/Controls/Base.css"],(function(e,t,s,i,o,n,r,a){"use strict";t.Widget=void 0,t.isHtmlContent=function(e){return e&&!!e.htmlTemplate},(0,r.injectCss)(a);var l=MsPortalFx.Base,c=l.Promises.CancelationToken,d=l.Promises.makeCancelable,p=MsPortalFx.Errors;const u="fxc-base",m="fxc-base-fill-container-width",g="fxc-base-fill-container-height",h=[];class f extends s.Widget{constructor(e,t,s,o){super(e,t,s,o),this._addDisposablesToCleanUp=e=>this.ltm.registerForDispose(e),s=s||{},this._options=t,this._widgets=[],this._waitToken=new c,e.addClass(u);switch(s.fillBehavior||0){case 1:e.addClass(m);break;case 2:e.addClass(g);break;case 3:e.addClass(`${m} ${g}`)}const r=h.length;if(r){h[r-1].push(this)}const a=this.tabindex=this.state?this.state.tabIndex:ko.observable(0),l=this.disabled=this.state?this.state.disabled:ko.observable(!1),d=this.weaveContext,p=d?null:this._bindingContext||i.getContext(e)||{},f=d?(0,n.toObservable)(this.ltm,d.disabled):p.$disabled,x=d?(0,n.toObservable)(this.ltm,d.enabledTabIndex):p.$enabledTabIndex;this.$disabled=i.chainDisabledProperties([f,l,t.disabled]),this.$enabledTabIndex=i.chainEnabledTabIndexProperties([x,a]),this.$tabIndex=i.makeTabIndexProperty(this.$enabledTabIndex,this.$disabled)}dispose(){if(this._checkExistsOrRegisterDestroyId(super.dispose))return;this._waitToken.cancel(new p.DisposedCanceledError),this._widgets&&(this._widgets.forEach((e=>{e&&e.dispose()})),this._widgets=null),this.element.removeClass(`${u} ${m} ${g}`).removeAttr("role");const e=h.length;if(e){const t=h[e-1];MsPortalFx.remove(t,this)}super.dispose()}get options(){return this._options}widget(){return this.element}get widgets(){return this._widgets}awaitContentRevealed(){return Promise.resolve(!1)}static beginTracking(e=[]){h.push(e)}static endTracking(){return h.pop()}trigger(e,t,s,i){const o=this.options[e],n=this.element;return s=s||{},(t=t||$.Event(e)).type=e,t.target=i||n[0],n.trigger(t,s),!($.isFunction(o)&&!1===o.apply(n[0],[t].concat(s))||t.isDefaultPrevented())}waitFor(e){return d(e,this._waitToken)}sanitizeTemplate(t){return t&&!this.isTrusted?o.sanitizeHTML(t,e,this.element).sanitizedMarkup:t}_bindDescendants(e={},t){const s=this.options,i=$(t||this.element)[0];ko.utils.extend(e,{data:s});const o=this._createBindingContext(e,s,i);ko.applyBindingsToDescendants(o,i)}_bindElement(e,t){const s=$(t)[0],i=this._createBindingContext(e,e,s);ko.applyBindings(i,s)}_createBindingContext(e,t,s){return i.createChildContext(s,e,{$ctl:this,$vm:t,$disabled:this.$disabled,$enabledTabIndex:this.$enabledTabIndex,$tabIndex:this.$tabIndex,$dicontainer:this._diContainer},this._bindingContext)}_isRtl(){return"rtl"===$.querySelectorAll("html").attr("dir")}}t.Widget=f})),
define("MsPortalImpl.Controls/Controls/SimpleButton",["require","exports","Weave/DirectMode","MsPortalImpl.Controls/Controls/Base/OptionsBase","FxInternal/WeaveControls/Button.Component.Internal","FxInternal/Weave"],(function(e,t,s,i,o,n){"use strict";t.InnerTsxComponent=function(e){const t=e.vm;return s(o.ButtonInner,{onClick:t.onClick,text:(0,n.toComputation)(t.text),style:(0,n.toComputation)(t.style),disabled:(0,n.toComputation)(t.disabled),ariaLabel:(0,n.toComputation)(t.ariaLabel),loading:(0,n.toComputation)(t.loading),loadingText:(0,n.toComputation)(t.loadingText),icon:(0,n.toComputation)(t.icon)})},t.Widget=void 0;const r="fxc-simplebutton";class a extends i.Widget{constructor(e,t,s){super(e,t,s),this.element.addClass(r)}dispose(){this._checkExistsOrRegisterDestroyId(super.dispose)||(this._cleanElement(r),super.dispose())}}t.Widget=a})),
define("MsPortalImpl.Controls/Fields/Base/FormValidation",["require","exports","MsPortalImpl/Base/JQueryHelper"],(function(e,t,s){"use strict";t.ensureFormFieldValidation=function(e,t=!0,s=!1){const i=d(e,s),n=i.map((e=>e.field)),r=i.map((e=>e.viewmodel)).filter(MsPortalFx.identity);t&&o(r);if(0===n.length)return Promise.resolve(!0);return p(n)},t.focusOnFirstInvalidField=function(e){e.find(".fxs-bg-error").eq(0).closest("[data-validatable='true']").find(".azc-input").eq(0).focus()},t.gatherFormFields=d,t.gatherFormFieldsFromElements=c,t.gridEnableValidation=o,t.markFormFieldElement=function(e,t,s,i){const o=$(e);o.attr(n,"true"),o.data(r,i),o.data(a,t),o.data(l,s);const c=(i.fieldsData?o.parent():o).closest(".fxs-validationContainer");let p;if(c.length&&c.hasClass("fxs-part-content")){const t=c.parent(),s=ko.dataFor(t[0]),i=s&&s.context;p=i&&i.validateElements,p&&p.push(e)}else if(c.length){const e=c.data(r);e&&e.fieldsData&&e.fieldsData(d(c,!0))}i.ltm.registerForDispose((()=>{p&&p.remove(e),o.data(r,null),o.data(a,null),o.data(l,null)}))},t.performFieldValidation=p;const i=MsPortalFx.identity;MsPortalFx.Base.Diagnostics.createLog(e);function o(e){e.forEach((e=>{const t=e&&e.rowMetadata;t&&t.editState&&t.editState()&&e.performValidation&&!e.performValidation()&&e.performValidation(!0)}))}const n="data-validatable",r="field",a="viewmodel",l="widgetviewmodel";function c(e,t,i){return e.filter((e=>{const o=$(e);return e&&e.hasAttribute(n)&&o.closest(".fxs-suppresschildvalidation").length<1&&o.data(r)&&(!t||t(e))&&(i||s.isElementVisible(e))})).map((e=>{const t=$(e);return{viewmodel:t.data(a),widgetviewmodel:t.data(l),field:t.data(r)}}))}function d(e,t=!1,s){return e.length?c(e.find(`[${n}]`).toArray(),(e=>$(e).data(r)&&(!s||s(e))),t):[]}function p(e){const t=[];return e.filter((e=>e.triggerValidation)).map((e=>{t.push(e.triggerValidation())})),Promise.all(t).then((e=>e.every(i)))}})),
define("MsPortalImpl/AzFramework/AzBladeViewModel",["require","exports"],(function(e,t){"use strict";t.BladeViewModel=void 0;class s{constructor(){this._initializedPromiseDeferred=Promise.withResolvers(),this._onInputsSetCalledDeferred=Promise.withResolvers()}hookOnInputsSet(e){return this._initializedPromiseDeferred.resolve(e),this._onInputsSetCalledDeferred.promise}onInputsSet(e){return this._onInputsSetCalledDeferred.resolve({parameters:e.parameters}),this._initializedPromiseDeferred.promise.then((e=>e))}}t.BladeViewModel=class extends s{constructor(e){super(),this.title=ko.observable(),this.subtitle=ko.observable(),this.icon=ko.observable(),this.statusBar=ko.observable(),this.menuContent={title:ko.observable(),subtitle:ko.observable()},this._onPinHandler=ko.observable(),this.menuBladeViewModel=ko.observable(),this._msPortalFxV2ShellApi=ko.computed(e,(()=>({onPin:this._onPinHandler()})))}setOnPinHandler(e){this._onPinHandler(e)}}})),
define("MsPortalImpl/ViewModels/ViewModels.BladeCaller",["require","exports"],(function(e,t){"use strict";t.addCallableBindings=function(e,t,s,a){const l=t.inputs=t.inputs||[];let c;if(t.outputs=t.outputs||[],t.bindings=t.bindings||[],a.inline)c=a.inline.bindings=a.inline.bindings||[];else{if(!a.reference)throw new Error("Part is neither inline nor a reference, so cannot add blade callable bindings");c=a.reference.bindings=a.reference.bindings||[]}l.push(o),c.push({property:o,valuesFrom:[{referenceType:1,property:o}]}),l.push(n),c.push({property:n,valuesFrom:[{referenceType:1,property:n}]}),t.outputs.push(r),t.bindings.push({property:r,valuesFrom:[{referenceType:0,property:e+i+r,part:s}]})},t.addCallablePartInputs=function(e){e.inputs=e.inputs||[],e.inputs.push(o,n)},t.addCallerBindings=function(e,t,s){const a=t.additionalInputArguments=t.additionalInputArguments||[];t.outputArguments=t.outputArguments||[];const l=e+i;a.push({property:o,valuesFrom:[{referenceType:s,property:l+o}]}),a.push({property:n,valuesFrom:[{referenceType:s,property:l+n}]}),t.outputArguments.push({property:r,valuesFrom:[{referenceType:1,property:r}]})},t.bindingName_bladeCallerResult=t.bindingName_bladeCallerParams=t.bindingName_bladeCallId=void 0;const s="internal_",i=".",o=t.bindingName_bladeCallId=s+"bladeCallId",n=t.bindingName_bladeCallerParams=s+"bladeCallerParams",r=t.bindingName_bladeCallerResult=s+"bladeCallerResult"})),
define("MsPortalImpl/Extension/DefinitionPreprocessor",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/ViewModels/ViewModels.BladeCaller","FxInternal/Utils/LinkSanitizer"],(function(e,t,s,i,o,n){"use strict";t.collisionPrefix=t.PinPrefix=void 0,t.preprocessDefinition=function(e,t){const s=e;return s.partTypeMap=s.partTypeMap||{},s.bladeMap=s.bladeMap||{},(s.partsCatalog||[]).forEach((e=>M(s,t,e,{}))),(s.blades||[]).forEach((e=>C(s,t,e,{}))),function(e){e.startBoardParts&&e.startBoardParts.forEach((e=>{e.inline&&_(e.inline.details,0)})),P(e)}(e),s},t.processBlade=C,t.processCommands=P,t.processPart=M;var r=MsPortalFx.Base.Constants.BladeParameterNames,a=MsPortalFx.Parts,l=a.PartKind,c=a.PartSize,d=MsPortalFx.Composition.Configuration;const p="internal_parameterProviderActionBarOutput",u="content.parameterProvider",m=MsPortalFx.isDevelopmentMode?1:0,g=t.PinPrefix="InferredBladePinPart",h=t.collisionPrefix="inferredBladePinPartInputs.",f="Microsoft_Azure_Insights",x="MetricsSummaryPart",b="timeRange",y="_msPortalFxTimeRange";function v(e,t){e&&e.extension&&(e.extension=t[e.extension]||e.extension)}function w(e,t){e&&e.length&&e.forEach((e=>{e.bladeExtension&&(e.bladeExtension=t[e.bladeExtension]||e.bladeExtension)}))}function M(e,t,o,r){if(o.processed)return o;r=r||{},v(o.reference,r),w(o.details,r),e.partTypeMap[o.name.toLowerCase()]=o,o.assetTypeDefinition=MsPortalFx.find(t.assetTypes,(e=>e.partName===o.name&&!e.partExtensionName)),_(o.details,0),o.parameterProvider&&F(o),function(e,t){const s=t.reference;if(s){if(s.partTypeName===x&&(s.extension===f||!s.extension&&e.name===f)){const e=s.bindings;MsPortalFx.find(e,(e=>e.property===b))||(e.push({property:b,valuesFrom:[{referenceType:9,property:y}],optional:!0}),t.inputDefinitions.push({name:y,type:d.TimeRangeValueType,optional:!0}))}}}(e,o);const a=s.container;return o.trustedLinkedDomains&&a.get(n.LinkSanitizer).processTrustedLinkedDomains(e.name,o.trustedLinkedDomains),i.sanitizeInlineTemplate(a,e.name,o.name,o,m),o.processed=!0,o}function C(e,t,a,d){if(d=d||{},a.processed)return a;MsPortalFx.isNullOrUndefined(a.pinnable)&&(a.pinnable=!!a.pinnedPart),2&a.attributes&&(a.optionalInputs=a.optionalInputs||[],a.optionalInputs.push("_provisioningContext")),a.templateBlade&&function(e){const t=e.templateBlade,s=t.isV2,i=t.isV2?c.FitToContainer:t.partSize||c.FullWidthFitHeight,o=I(e.name,e,t.htmlTemplate,t.htmlTemplateInline,i,t.partState,t.parameterProvider,t.styleSheets,e.permissions,12===e.style?l._Internal_App:null,s);e.lenses=e.lenses||[],e.lenses.push({name:"TemplateBladeVirtualLens",partInstances:[o]}),e.locked=!0,s&&(e.style=8);const n=o.inline;S(n,e.inputs,e.templateKeyInputs,void 0,e.effectiveInputs),S(n,e.optionalInputs,[],!0,e.effectiveInputs);const r=e.effectiveInputs=n.bindings;e.outputs&&e.outputs.forEach((t=>{e.bindings=e.bindings||[],e.bindings.push({property:t,valuesFrom:[{referenceType:0,property:"content."+t,part:o.name}]})})),e.editScopeType&&r.push({property:"editScopeId",valuesFrom:[{referenceType:1,property:"editScopeId"}]});e.actionBar&&(e.actionBar.source={valuesFrom:[{referenceType:0,part:o.name,property:"content.actionBar"}]});e.toolbar&&(e.toolbar.source={valuesFrom:[{referenceType:0,part:o.name,property:"content.commandBar"}]});n.details=t.details}(a),a.menuBlade&&function(e){const t=e.name,s=e.menuBlade.isV2,i=I(t,e,void 0,{content:`<div data-bind='pcControl: ${s?"viewModel && viewModel._msPortalFxMenu":"menu"}' class='ext-menublade-part'></div>`,file:t+MsPortalFx.getUniqueId()},c.FitToContainer,void 0,!1,[],void 0);S(i.inline,e.inputs,e.templateKeyInputs,void 0,e.effectiveInputs),S(i.inline,e.optionalInputs,[],!0,e.effectiveInputs);const o={name:t,partInstances:[i]};e.lenses.splice(0,0,o),e.effectiveInputs=i.inline.bindings,MsPortalFx.isNullOrUndefined(e.pinnable)&&(e.pinnable=!0)}(a),a.tabMenuBlade&&function(e){const t=e.name,s=e.tabMenuBlade.isV2,i=I(t,e,void 0,{content:`<div data-bind='pcControl: ${s?"viewModel && viewModel._msPortalFxTabMenu":"tabMenu"}' class='ext-tabmenublade-part'></div>`,file:t+MsPortalFx.getUniqueId()},c.FitToContainer,void 0,!1,[],void 0);S(i.inline,e.inputs,e.templateKeyInputs,void 0,e.effectiveInputs),S(i.inline,e.optionalInputs,[],!0,e.effectiveInputs);const o={name:t,partInstances:[i]};e.lenses.splice(0,0,o),e.effectiveInputs=i.inline.bindings,e.style=10,MsPortalFx.isNullOrUndefined(e.pinnable)&&(e.pinnable=!0)}(a),a.frameBlade&&function(e){const t=e.name,s=I(t,e,void 0,void 0,c.FitToContainer,e.frameBlade.partState,!1,[],e.permissions,l.Frame);S(s.inline,e.inputs,e.templateKeyInputs,void 0,e.effectiveInputs),S(s.inline,e.optionalInputs,[],!0,e.effectiveInputs),e.toolbar={source:{valuesFrom:[{referenceType:0,part:t,property:"content.commandBar"}]}};const i={name:t,partInstances:[s]};e.lenses.splice(0,0,i),e.effectiveInputs=s.inline.bindings}(a),(a.lenses||[]).forEach((e=>{(e.partInstances||[]).forEach((e=>{v(e.reference,d),w(e.inline&&e.inline.details,d)}))})),e.bladeMap[a.name.toLowerCase()]=a,a.assetTypeDefinition=MsPortalFx.find(t.assetTypes,(e=>e.bladeName===a.name)),function(e){e.lenses&&e.lenses.forEach((t=>{t.partInstances&&t.partInstances.forEach((t=>{t.inline&&(t.parameterProvider&&F(t.inline),_(t.inline.details,0)),function(e,t,s){if(s.parameterProvider&&(e.attributes|=1,o.addCallableBindings(u+".bladeCallable",e,t,s),e.actionBar)){e.actionBar.bindings=e.actionBar.bindings||[];e.actionBar.bindings.some((e=>"input"===e.property))||e.actionBar.bindings.push({property:"input",valuesFrom:[{referenceType:0,part:t,property:u+".defaultActionBarInput"}]}),e.templateBlade||(s.inline||s.reference).bindings.push({property:p,valuesFrom:[{referenceType:2,property:"content.output"}]})}}(e,t.name,t)}))}))}(a),a.effectiveInputs||(a.effectiveInputs=a.viewModelInputs||[]);const f=function(e){const t=g+e.name;e.pinnedPart||(e.pinnedPart=t);const s={name:t,viewModel:"Shell.InferredBladePinPart"+e.name,partKind:l.Button,inputs:e.inputs,initialSize:c.Normal,details:[{blade:e.name,invocationInputArguments:[{valuesFrom:[{property:"container.selectable.value",referenceType:0}]}],additionalInputArguments:[]}],bindings:[],viewStateProperties:["container.selectable.isSelected"],commandGroup:e.commandGroup,commandGroupReference:e.commandGroupReference,assetIdInputProperty:e.assetIdInputProperty,assetType:e.assetType};(e.inputs||[]).forEach((e=>{s.bindings.push({property:h+e,valuesFrom:[{property:e,referenceType:1}]})})),(e.optionalInputs||[]).forEach((e=>{e!==r.ReferrerInfo&&s.bindings.push({property:h+e,optional:!0,valuesFrom:[{property:e,referenceType:1}]})})),e.viewModelInputs&&e.viewModelInputs.forEach((t=>{t.property===e.assetIdInputProperty&&s.bindings.push(t)}));return s}(a);e.partTypeMap[f.name.toLowerCase()]=f;const x=s.container;return a.trustedLinkedDomains&&x.get(n.LinkSanitizer).processTrustedLinkedDomains(e.name,a.trustedLinkedDomains),i.sanitizeBladeDefinition(x,e.name,a,m),a.processed=!0,a}function S(e,t,s,i,o){t&&t.forEach((t=>{const n=!i&&s&&s.includes(t);e.inputs.push(t),e.bindings.push(o&&MsPortalFx.find(o,(e=>e.property===t))||{property:t,optional:i,isIdentityInput:n,valuesFrom:[{referenceType:1,property:t}]})}))}function I(e,t,s,i,o,n,r,a,c,d,p){return{name:e,inline:{bindings:[],details:[],inputs:[],partKind:d||l.Custom,viewModelLocator:t.viewModelLocator,viewModel:t.viewModelName,htmlTemplate:s,htmlTemplateInline:i,assetType:t.assetType,assetIdInputProperty:t.assetIdInputProperty,initialSize:o,viewStateProperties:[],shareVmWithParentBlade:!0,partState:n,styleSheets:a,permissions:c,noFxContentPadding:p},parameterProvider:r}}function P(e){e.commandsCatalog&&e.commandsCatalog.forEach((e=>{_([e.details],4)})),e.commandGroups&&e.commandGroups.forEach((e=>{e.commands&&e.commands.forEach((e=>{_([e.details],4)}))}))}function _(e,t){e&&e.filter((e=>e&&!!e.parameterCollector)).forEach((e=>{o.addCallerBindings(e.parameterCollector+".bladeCaller",e,t)}))}function F(e){e.editScopeType=e.editScopeType||"PDLEditScope",e.inputs=e.inputs||[],e.inputs.push(p),o.addCallablePartInputs(e)}})),
define("MsPortalImpl/Extension/ShellPart",["require","exports"],(function(e,t){"use strict";t.isShellPart=function(e){const t=e.name;return"HubsExtension"===e.getExtensionName()&&!!s[t]},t.shellParts=void 0;const s=t.shellParts={ResourcePart:{viewModelName:"ResourcePartViewModel",shellModule:"MsPortalImpl/UI/UI.ResourcePart"}}})),
define("MsPortalImpl/Services/Services.ExtensionStorageManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/ExtensionManager"],(function(e,t,s,i){"use strict";t.ExtensionStorageManager=void 0;const o=MsPortalFx.Base.Diagnostics.createLog(e),n="LocalStorage",r=e=>{o.error(`error performing IndexedDB operation: ${e?.target?.error?.toString()}`,void 0,e?.target?.error)},a=(e,t,s)=>{const i=s?.name;"NotFoundError"!==i&&"UnknownError"!==i||(o.warning(`IDBDatabase produced ${i}, deleting unusable database`),t.close(),indexedDB.deleteDatabase(e).onerror=r)},l=(e,t)=>{const s=`ExtensionStorage${e}`,i=new Set;let l=Object.create(null);const c="localStorage"===t&&indexedDB?"localStorage":"sessionStorage";let d=!1;const p=new Promise((e=>{"sessionStorage"===c?e():((e,t)=>{const s=indexedDB.open(e,1);let i=s=>{let l;try{l=s.transaction(n,"readonly")}catch(i){o.warning(`call to IDBDatabase.transaction threw: ${i?.toString()}`,void 0,i),a(e,s,i),t(Object.create(null),!0)}if(l){l.onerror=i=>{o.debug(`call to IDBDatabase.transaction errored: ${i?.target?.error?.toString()}`,i?.target?.error),a(e,s,i?.target?.error),t(Object.create(null),!0)};const i=l.objectStore(n).getAll();i.onsuccess=()=>{const e={};for(const t of i.result){const{key:s,value:i}=t;e[s]=i}t(e)},i.onerror=r}i=MsPortalFx.noop};s.onsuccess=()=>{i(s.result)},s.onerror=e=>{o.debug(`call to indexedDB.open failed (expected for Private mode): ${e?.target?.error?.toString()}`,e?.target?.error),t(Object.create(null),!0)},s.onupgradeneeded=e=>{const t=e.target.result;t.createObjectStore(n,{keyPath:"key"}).transaction.oncomplete=()=>{i(t)}}})(s,((t,s)=>{l=t,d=s,u("init",l),e()}))})),u=(e,s,o)=>{i.forEach((i=>i({storage:t,serializedStorage:s,action:e,key:o})))},m=e=>{"localStorage"===c&&p.then((()=>{d||((e,t)=>{const s=indexedDB.open(e,1);s.onsuccess=()=>{const e=s.result.transaction(n,"readwrite");e.onerror=r;const i=e.objectStore(n);t(i).onerror=r},s.onerror=r})(s,e)}))};return{internalStorage:{setItem:(e,t)=>{l[e]=t,m((s=>s.put({key:e,value:t}))),u("set",{[e]:t},e)},removeItem:e=>{delete l[e],m((t=>t.delete(e))),u("remove",{},e)},clear:()=>{l=Object.create(null),m((e=>e.clear())),u("clear",{})},serialize:()=>l,registerChangeListener:e=>{i.add(e);return()=>{i.delete(e)}}},ready:p}};let c=t.ExtensionStorageManager=class{constructor(e){this._storageByExtension=new Map,this._registeredExtensionNames=new Set(e.extensionsAsArray.map((e=>e.name)))}getStorageForExtension(e){let t=this._storageByExtension.get(e);return!t&&this._registeredExtensionNames.has(e)&&(t=function(e){const t=l(e,"sessionStorage"),s=l(e,"localStorage"),i={sessionStorage:t.internalStorage,localStorage:s.internalStorage},o={setItem:e=>{i[e.storage].setItem(e.keyName,e.keyValue)},removeItem:e=>{i[e.storage].removeItem(e.keyName)},clear:e=>{i[e.storage].clear()},registerChangeListener:e=>{const t=Object.keys(i).map((t=>i[t].registerChangeListener(e)));return()=>t.forEach((e=>{e()}))},serialize:()=>({sessionStorage:i.sessionStorage.serialize(),localStorage:i.localStorage.serialize()})};return Promise.all([t.ready,s.ready]).then((()=>o))}(e),this._storageByExtension.set(e,t)),t}};t.ExtensionStorageManager=c=__decorate([__metadata("fx:diagnostics",[e,"ExtensionStorageManager"]),s.Class(),__metadata("design:paramtypes",[i.ExtensionManagerOptions])],c)})),
define("MsPortalImpl/Extension/DefinitionCache",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension.DefinitionValidator","MsPortalImpl/Extension/ShellPart","FxHubs/RpcEndPoints","FxInternal","MsPortalImpl/Services/Services.ExtensionStorageManager"],(function(e,t,s,i,o,n,r,a,l,c,d,p){"use strict";t.doesBladeDefinitionExist=t.DefinitionSource=t.DefinitionCache=void 0;var u=FxImpl.Extension;const m=new RegExp(`^[\\w$]*(\\${".ReactView".toLowerCase()}|\\${".MenuView".toLowerCase()})?$`);function g(e){return{commandsCatalog:MsPortalFx.convertArrayToMap(e.commandsCatalog,(e=>e.name)),commandGroups:MsPortalFx.convertArrayToMap(e.commandGroups,(e=>e.name))}}let h=t.DefinitionSource=class{getDefinition(e){return null}};t.DefinitionSource=h=__decorate([__metadata("fx:diagnostics",[e,"DefinitionSource"]),s.Class()],h);let f=t.DefinitionCache=class{constructor(e,t,s,i,o){this._diContainer=e,this._definitionSource=t,this._extensionManagerOptions=s,this._manifestCache=i,this._rpcClient=o,this._cache={},this._azCache={}}getDefinition(e){return this._getEntry(e).definition}getCommandGroup(e,t){return this._getCommandDefinitions(e,t,(e=>e.commandGroups))}getCommand(e,t){return this._getCommandDefinitions(e,t,(e=>e.commandsCatalog))}getBladeDefinition(e,t,s){const i=this._getEntry(e),o=i.definition,n=t.toLowerCase(),r=o.bladeMap[n];if(r)return Q(r);const a=i.bladeDefMap;return m.test(t?.toLowerCase())?(this._diContainer.get(p.ExtensionStorageManager).getStorageForExtension(e),t.toLowerCase().endsWith(".ReactView".toLowerCase())||t.toLowerCase().endsWith(".MenuView".toLowerCase())?Q(this._getAzBladeDefinition(t,e)):n.endsWith("_dx")?Q(a[n]||this.setDxBladeDefinition(e,t)):Q(a[n]||!s&&this.setBladeDefinition(e,t,u.getBladeDefinitionEndPoint.invoke(this._rpcClient,e,t)))):Q.reject(FxImpl.createError("Blade name is invalid identifier"))}doesBladeDefinitionExist(e,t){if(t.toLowerCase().endsWith("_dx")){let s;try{s=this._extensionManagerOptions.getNormalizedMetadata(e,!0)}catch{return Q(!1)}return i.get("MsPortalImpl/Extension/DxDefinitionCache","getDxBladeDefinition").then((i=>i(this._diContainer,this,e,t,s,!0))).then((e=>!!e))}throw new Error("Not implemented")}async setDxBladeDefinition(e,t){const s=this._extensionManagerOptions.getNormalizedMetadata(e,!0),o=i.get("MsPortalImpl/Extension/DxDefinitionCache","getDxBladeDefinition").then((i=>i(this._diContainer,this,e,t,s)));return this.setBladeDefinition(e,t,o)}setBladeDefinition(e,t,s){const i=this._getEntry(e),o=i.definition,n=t.toLowerCase(),l=i.bladeDefMap;return l[n]=s.then((t=>r.processBlade(o,this._manifestCache.getManifest(e,"assetTypes"),t,this._extensionManagerOptions.extensionRedirectMap))).then((e=>{const t=[];if(a.validateBlade(o,e,null,t),t.length)throw new Error("Invalid blade definition. Errors: "+t.join("\n"));return e})).finally((()=>{delete l[n]}))}loadPartDefinition(e,t){if("HubsExtension"===e){const e=l.shellParts[t];if(e)return Q(d.tryImmediateResolve(MsPortalFx.require(e.shellModule),(e=>("resourcepart"===t.toLowerCase()&&(e.partDefinition.resizeMode=2,e.partDefinition.initialSize=MsPortalFx.Parts.PartSize.Large),e.partDefinition))))}return Q(u.getPartDefinitionEndPoint.invoke(this._rpcClient,e,t))}getPartDefinition(e,t){const s=this._getEntry(e),i=s.definition,o=t.toLowerCase(),n=i.partTypeMap[o];if(n)return Q(n);const l=s.partDefMap;return l[o]||(l[o]=this.loadPartDefinition(e,t).then((t=>{t=r.processPart(i,this._manifestCache.getManifest(e,"assetTypes"),t,this._extensionManagerOptions.extensionRedirectMap);const s=[];if(a.validatePartType(t,s),s.length)throw new Error("Invalid part type definition. Errors: "+s.join("\n"));return t})).finally((()=>{delete l[o]})))}_getAzBladeDefinition(e,t){return this._diContainer.getAsync(i.get("MsPortalImpl/AzFramework/AzExtensionCore","AzDefinitionCache")).then((s=>s.getBladeDefinition(this._getAzDefinition(t),e,t)))}_getCommandDefinitions(e,t,s){if(!t)return Q();const i=this._getEntry(e);if(!i.commandDefMap){const t=i.definition;i.commandDefMap=t.commandGroups||t.commandsCatalog?Q(g(t)):Q(FxImpl.Extension.getCommandsDefinitionEndPoint.invoke(this._rpcClient,e,void 0)).then((e=>(r.processCommands(e),g(e))))}return Q(d.tryImmediateResolve(i.commandDefMap,(e=>s(e)[t])))}_getAzDefinition(e){return this._azCache[e]||(this._azCache[e]={name:e,bladeMap:{},partTypeMap:{}})}_getEntry(e){return this._cache[e]||(this._cache[e]={definition:this._definitionSource.getDefinition(e)||{name:e,bladeMap:{},partTypeMap:{}},bladeDefMap:{},partDefMap:{},commandDefMap:null})}};t.DefinitionCache=f=__decorate([__metadata("fx:diagnostics",[e,"DefinitionCache"]),s.Class(),__metadata("design:paramtypes",[s.Container,h,n.ExtensionManagerOptions,o.ManifestCache,FxImpl.Rpc.Client])],f);t.doesBladeDefinitionExist=i.defineHandler(c.Provisioning.doesBladeDefinitionExistEndPoint,(e=>{const t=e.messageArg;return Q(e.diContainer.get(f).doesBladeDefinitionExist(t.extensionName,t.bladeName))}))})),
define("MsPortalImpl/Extension/Extension.Definition.Locator",["require","exports","Fx/DependencyInjection","Fx/ResourceManagement","FxInternal/AsyncLoader","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Extension/DefinitionCache","FxHubs/RpcEndPoints"],(function(e,t,s,i,o,n,r,a,l,c,d){"use strict";t.resourceMenu=t.hubsLocator=t.getBladeDefinitionLocator=t.LocatorTypeMap=t.LocatorError=t.LocatorContext=t.Locator=t.DefinitionFinderImpl=t.DefinitionFinder=void 0;var p=MsPortalFx.Base.Constants,u=MsPortalFx.Base.Diagnostics;MsPortalFx.Extension.BrowseType;const m=u.createLog(e),g="Unable to locate {0} '{1}'. Search path:'{2}'.";function h(e,t){const s=[];let i=e;for(;i;)s.unshift(i.getCacheKeyPart()),i=i.parent;const o=s.join("-");return t?o:o.toLowerCase()}function f(e,t,s){return e.definitionCache.getDefinition(t.name).partTypeMap[s.toLowerCase()]}function x(e,t){let s="<InvalidJsonString>";try{s=JSON.stringify(t)}catch(e){}return m.error("{0} JSON: {1}".format(e,s)),w.forExtension("##ErrorDeserializingLocator##-{0}".format(s))}var b;!function(e){e[e.Extension=0]="Extension",e[e.Blade=1]="Blade",e[e.Lens=2]="Lens",e[e.AssetType=3]="AssetType",e[e.CommandGroup=4]="CommandGroup",e[e.PartInstance=5]="PartInstance",e[e.PartType=6]="PartType",e[e.StartboardPartInstance=7]="StartboardPartInstance",e[e.BladeActionBar=8]="BladeActionBar",e[e.Command=9]="Command",e[e.Hub=11]="Hub",e[e.CustomLen_Unused=12]="CustomLen_Unused",e[e.CommandType=13]="CommandType",e[e.BladeRedirect=14]="BladeRedirect",e[e.PartInstanceRedirect=15]="PartInstanceRedirect",e[e.PartTypeRedirect=16]="PartTypeRedirect",e[e.AssetTypeForBrowse=17]="AssetTypeForBrowse",e[e.HtmlTemplate=18]="HtmlTemplate"}(b||(t.LocatorTypeMap=b={}));class y extends MsPortalFx.Errors.Error{constructor(e,t,s,i){super({message:s,innerErrors:i}),this.source=t,this.data=e}}t.LocatorError=y;let v=t.LocatorContext=class{constructor(e,t,s,i){this.extensionManager=e,this.manifestCache=t,this.definitionCache=s,this.redirectMap=i}tryLocateAssetDefinitionFromResourceId(e,t){const s=i.ArmId.parse(e,!0).resourceType,o=i.ArmId.parse(e).resourceType;return!!this.tryLocateAssetDefinitionFromResourceType(s,t)||this.tryLocateAssetDefinitionFromResourceType(o,t)}tryLocateAssetDefinitionFromResourceType(e,t){const s=e.toLowerCase(),i=this.extensionManager.getExtensions().some((e=>{const i=this.manifestCache.getManifest(e.name,"assetTypes"),o=i&&MsPortalFx.find(i.assetTypes,(e=>e.resourceType?.resourceTypeName?.toLowerCase()===s&&3!==e.browseType));return o&&(t.extensionName=e.name,t.value=o),!!o}));return i||(t.error="Unable to locate extension for resource type '{0}'.".format(e),t.value=null),i}};t.LocatorContext=v=__decorate([__metadata("fx:diagnostics",[e,"LocatorContext"]),s.Class(),__metadata("design:paramtypes",[l.ExtensionManager,a.ManifestCache,c.DefinitionCache,a.RedirectMap])],v);class w{constructor(e,t,s,i,o,n,r){this.type=e,this.name=t,this.parent=o,this.enumerate=s,this.getValue=n,this.getValueAsync=r,this.typeDisplayName=i}static forExtension(e){return new w(0,e,void 0,"extension",void 0,(t=>t.extensionManager.getExtension(e)),null)}static fromJSON(e,t){if(!t||"object"!=typeof t)return x("Locator object is invalid.",t);const s=t.parent?w.fromJSON(e,t.parent):null,i=b[t.type],o="with{0}".format(i);if(!s&&0!==t.type)return x("Locator with name '{0}' has no parent.".format(t.name),t);let n;return 0===t.type?(n=e.resolveExtensionName(t.name),w.forExtension(n)):o in s?s[o](t.name):x("Unknown locator type: {0}.".format(i),t)}getCacheKeyPart(){return`[${this.type}]${this.name}`}getCacheFriendlyKeyPart(e="/"){return`${b[this.type]}${e}${this.name}`}withBlade(e){return new w(1,e,void 0,"blade",this,((e,t,s)=>e.definitionCache.getDefinition(t.name).bladeMap[s.toLowerCase()]),((t,s)=>t.definitionCache.getBladeDefinition(s.name,e)))}withPartInstance(e){return new w(5,e,((e,t)=>t.partInstances),"part instance",this)}tryLocate(e,t,s){const i=h(this),o={};let n=!1;if(!t.hasOwnProperty(i)&&(this.parent&&this.parent.tryLocate(e,t,o),!this.parent||o.value))if(this.getValue){const s=this.getValue(e,o.value,this.name);void 0!==s&&(t[i]=s)}else{const s=this.enumerate(e,o.value);this._fillCacheFromArray(t,s)}const r=t[i];return r?(s.value=r,n=!0):(s.error=g.format(this.typeDisplayName,this.name,this.toString()),o.error&&(s.error=o.error+"\n"+s.error)),n}async locateAsync(e,t){const s={};if(this.tryLocate(e,t,s))return s.value;let i;try{const s=this.parent;s&&(i=await s.locateAsync(e,t))}catch(e){const t=g.format(this.typeDisplayName,this.name,this.toString());throw new y(this.type,this.toFriendlyString(),t,e)}if(this.tryLocate(e,t,s))return s.value;if(this.getValueAsync){const s=await this.getValueAsync(e,i);return t[h(this)]=s}throw new y(this.type,this.toFriendlyString(),s.error)}_fillCacheFromArray(e,t){t&&t.forEach((t=>{const s=h(new w(this.type,t.name,this.enumerate,this.typeDisplayName,this.parent,this.getValue,this.getValueAsync));e[s]=t}))}static forPartInstanceRedirect(e,t,s,i){return new w(15,(0,a.partRedirectKey)(5,e,t,s,i),void 0,"part instance redirect",void 0,(o=>{const n=o.redirectMap.getPartRedirect(5,e,t,s,i);return n.definition&&MsPortalFx.extend({name:n.key},n.definition)}))}static forPartTypeRedirect(e,t){return new w(16,(0,a.partRedirectKey)(4,e,t),void 0,"part type redirect",void 0,(s=>{const i=s.redirectMap.getPartRedirect(4,e,t);return i.definition&&MsPortalFx.extend({name:i.key},i.definition)}))}static forBladeRedirect(e,t,s){return new w(14,(0,a.bladeRedirectKey)(e,t),void 0,"blade redirect",void 0,(i=>{const o=i.redirectMap.getBladeRedirect(e,t,s);return o.definition&&MsPortalFx.extend({name:o.key},o.definition)}))}withBladeActionBar(e){return new w(8,e,((e,t)=>t.actionBar?[t.actionBar]:[]),"blade actionbar",this)}withStartboardPartInstance(e){return new w(7,e,((e,t)=>e.definitionCache.getDefinition(t.name).startBoardParts),"startboard part instance",this)}withPartType(e){return new w(6,e,void 0,"part type",this,f,(async(t,s)=>{if(e.startsWith(r.PinPrefix)){const i=e.slice(r.PinPrefix.length);return await t.definitionCache.getBladeDefinition(s.name,i),f(t,s,e)}return t.definitionCache.getPartDefinition(s.name,e)}))}withLens(e){return new w(2,e,((e,t)=>t.lenses),"lens",this)}withAssetType(e){return new w(3,e,((e,t)=>e.manifestCache.getManifest(t.name,"assetTypes").assetTypes),"asset type",this)}withAssetBrowseType(e){return new w(17,e,((e,t)=>{const s=e.manifestCache.getManifest(t.name,"assetTypesBrowse");return s?.assetTypesBrowse}),"asset browse type",this,void 0,(async(t,s)=>{const i=(await t.manifestCache.getManifestAsync(s.name,"assetTypesBrowse")).assetTypesBrowse.find((t=>e===t.name));if(!i)throw new MsPortalFx.Errors.NotFoundDataError({dataSetName:"assetTypesBrowse"});return i}))}withCommand(e){return new w(9,e,null,"command",this)}withHtmlTemplate(e){return new w(18,e,null,"html template",this,((e,t,s)=>e.definitionCache.getDefinition(t.name).htmlTemplates[s]))}getExtensionLocator(){let e=this;for(;e.parent;)e=e.parent;return e}getExtensionName(){return this.getExtensionLocator().name}toString(){return h(this,!0)}toFriendlyString(e="/"){return function(e,t){const s=[];let i=e;for(;i;)s.unshift(i.getCacheFriendlyKeyPart(t)),i=i.parent;return s.join(t)}(this,e)}equals(e){if(this.name&&e&&e.name&&this.name===e.name&&this.type===e.type){if(this.parent)return this.parent.equals(e.parent);if(!e.parent)return!0}return!1}toJSON(){return{name:this.name,type:this.type,parent:this.parent&&this.parent.toJSON()}}}t.Locator=w;class M{static populateCache(e,t,s){return e[h(t)]=s,e}constructor(e,t){this._locatorContext=e,this._cache=t||{}}locateAsync(e){return e.locateAsync(this._locatorContext,this._cache)}locate(t,s){const i={};let o=null;if(this.tryLocate(t,i))o=i.value;else{const o=s||t.getExtensionName();(0,n.logToExtension)(e,o,2,i.error)}return o}tryLocate(e,t){return e.tryLocate(this._locatorContext,this._cache,t)}}t.DefinitionFinderImpl=M;class C{static create(e){return new M(e)}}t.DefinitionFinder=C,__decorate([__metadata("fx:diagnostics",[e,"DefinitionFinder"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[v]),__metadata("design:returntype",C)],C,"create",null);const S=p.BladeNames.Hubs.ResourceMenuBlade,I=t.hubsLocator=w.forExtension("HubsExtension");t.resourceMenu=I.withBlade(S),t.getBladeDefinitionLocator=o.defineHandler(d.Provisioning.getBladeDefinitionLocatorEndPoint,(async e=>{const t=e.messageArg;return{...await e.diContainer.get(C).locateAsync(w.forExtension(t.extensionName).withBlade(t.bladeName))}}))})),
define("MsPortalImpl/ReactViews/ReactFederatedModules",["require","exports","Fx/DependencyInjection","FxInternal/RpcEndPointsCore"],(function(e,t,s,i){"use strict";t.ReactFederatedModules=void 0;let o=t.ReactFederatedModules=class{constructor(e){this._rpcClient=e,this._getRequireConfigCache={}}getFederatedModulesRequireConfig(e,t){const s=`${e}/${t}`;let o=this._getRequireConfigCache[s];return void 0===o&&(o=this._getRequireConfigCache[s]=i.getFederatedModulesRequireConfigEndpoint.invoke(this._rpcClient,"fxw",{extensionName:e,modulePrefix:t})),o}getInShellRequireConfig(e){return this.getFederatedModulesRequireConfig(e,e)}};t.ReactFederatedModules=o=__decorate([__metadata("fx:diagnostics",[e,"ReactFederatedModules"]),s.Class(),__metadata("design:paramtypes",[FxImpl.Rpc.Client])],o)})),
define("MsPortalImpl/ReactViews/ReactFrame.Constants",["require","exports"],(function(e,t){"use strict";t.reactFrameSignature=t.SESSION_STORAGE_THROTTLE=t.SESSION_STORAGE_DEVTOOLS_RELOAD_AND_PROFILE=t.SESSION_STORAGE_DEVTOOLS_RECORD_CHANGE_DESCRIPTIONS_KEY=void 0;t.SESSION_STORAGE_DEVTOOLS_RELOAD_AND_PROFILE="React::DevTools::reloadAndProfile",t.SESSION_STORAGE_DEVTOOLS_RECORD_CHANGE_DESCRIPTIONS_KEY="React::DevTools::recordChangeDescriptions",t.SESSION_STORAGE_THROTTLE="React::PerfTools::throttle",t.reactFrameSignature="Az"})),
define("MsPortalImpl/ReactViews/ReactFrame.FrameCreator",["require","exports","Fx","MsPortalImpl/ReactViews/ReactFrame.Constants"],(function(e,t,s,i){"use strict";t.createReactViewFrame=async function(e){const{frameContainer:t,isOnDemand:o,lifetime:c}=e;let d=a;const m=document.createElement("iframe"),g="_react_frame_"+w++,h=I(g);m.setAttribute("id",g),m.classList.add("fxs-part-frame"),m.setAttribute("allow","microphone *; display-capture *; encrypted-media *;clipboard-read;clipboard-write;"),m.setAttribute("role","presentation"),m.setAttribute("allowfullscreen","true"),m.classList.add("fxs-extension-frame");const b=e=>e.source===m.contentWindow&&e.data?.signature===i.reactFrameSignature;let y=0,v=!0;const D=[],A=(e,t)=>{D.push({event:e,value:t,timestamp:Date.now(),retryCount:y})};A("Frame Location",o?"On Demand":"Frame Pool"),A("Frame ID",g);const B=()=>{const e=d,t=S(e,h,y),s=e||C;return m.setAttribute("sandbox",s?"allow-scripts allow-popups allow-modals allow-forms allow-popups-to-escape-sandbox allow-downloads allow-presentation allow-same-origin":"allow-scripts allow-popups allow-modals allow-forms allow-popups-to-escape-sandbox allow-downloads allow-presentation"),m.src=t,t};return new Promise(((e,i)=>{let o,n;const h=()=>{"visible"===document.visibilityState&&(A("Document Visible","Delaying failure handling by 3 seconds"),window.removeEventListener("visibilitychange",h),setTimeout(S,3e3))},w=()=>{A("Network Online","Delaying failure handling by 3 seconds"),window.removeEventListener("online",w),setTimeout(S,3e3)},C=(e,t)=>{const s=setTimeout(e,t);return c.createChildLifetime().registerForDispose((()=>clearTimeout(s)))},S=()=>{const e=o();if(A("Attempt to Load ReactFrame Failed",{frameTimeout:P,elapsedTime:e,frameSrc:m.src}),"hidden"===document.visibilityState)return A("Document Hidden"),void window.addEventListener("visibilitychange",h);if(!window.navigator.onLine)return A("Network Offline"),void window.addEventListener("online",w);if(r.warning(new u({message:`Timeout occurred. FrameReady message not received within ${P} ms. Time elapsed: ${e} seconds`,source:p,data:{frameId:g,url:m.src}})),o=(0,s.startTimer)(),y++,y<E){d&&(y===E-1||e>=k||!a)&&(d=!1);const t=B();r.warning(`${g} load failed. Retry attempt ${y} with ${t}`),P=Math.min(_,P*T),A("Retrying",{newUri:t,newFrameTimeout:P}),n=C(S,P)}else v=!1,A("Failed to load ReactFrame"),i(new u({message:`Failed to load ReactFrame in Prewarmer after ${E} attempts.`,source:p,data:{frameId:g,url:m.src}})),window.removeEventListener("message",I),window.removeEventListener("visibilitychange",h),window.removeEventListener("online",w)},I=t=>{const s=t.data;if(b(t)&&0===s.kind){n.dispose();const t=o();A("Successfully loaded ReactFrame",{elapsedTime:t}),P=Math.max(Math.min(P,2*t),F),e({frameId:g,iframeElement:m,isFrameReactViewMessage:b,frameClientOptimizations:x}),d?l=!0:a&&!l&&(a=!1),setTimeout((()=>window.removeEventListener("message",I)),1e3),window.removeEventListener("visibilitychange",h),window.removeEventListener("online",w)}else(e=>e.source===m.contentWindow&&e.data?.signature===f)(t)&&A("Iframe Script Load",{message:s.message,isSuccess:s.isSuccess})};window.addEventListener("message",I),M.then((()=>{d=a,B(),n=C(S,P),o=(0,s.startTimer)(),A("Start Time"),A("IFrame Source",m.src),m.onload=()=>{A("Frame on load")},m.onerror=e=>{A("Frame on error",{error:MsPortalFx.getLogFriendlyMessage(e)})}})),t.appendChild(m)})).finally((()=>{n.trace({source:`${p}-${g}`,action:"PrewarmEventHistory",data:D,actionModifier:v?"complete":"cancel"})}))},t.releaseOriginIndexForFrame=function(e){for(const[t,s]of Array.from(m.entries()))s===e&&m.delete(t)};var o=MsPortalFx.Base.Diagnostics,n=o.Telemetry;const r=o.createLog(e);let a=fx.environment.reactViewSameOriginEndpoints.length>0,l=!1;const c=MsPortalFx.isFeatureEnabled("skipreactorigincheck"),d=MsPortalFx.getFeatureValue("reactviewendpointindex")||"0",p="ReactViewPrewarmer",u=MsPortalFx.Errors.Error,m=new Map,g={true:fx.environment.reactFrameContentHashes[0],false:fx.environment.reactFrameContentHashes[1],bundle:fx.environment.reactFrameContentHashes[2]},h=MsPortalFx.sessionId,f="ReactFrameRenderer",x=/_clientoptimizations=(true|false|bundle)/.exec(window.location.search.toLowerCase())?.[1]??fx.environment.clientOptimizations,b={l:FxImpl.Intl.effectiveLocale,preorderperf:MsPortalFx.getFeatureValue("preorderPerf"),trustedAuthority:FxImpl.trustedParentOrigin,contentHash:(y=x,g[y]),reactIndex:d,sessionId:h};var y;const v=Object.keys(b).reduce(((e,t)=>{const s=b[t];return s?e+`&${t}=${s}`:e}),"");let w=0,M=Promise.resolve();if(a&&!c){let e=0;M=fetch(S(!0)).then((t=>{e=t.status,e>=200&&e<400?l=!0:a=!1})).catch((()=>{a=!1})).finally((()=>{n.trace({source:`${p}`,action:"PrewarmOriginCheck",data:e,actionModifier:l?"complete":"failed"})}))}const C=function(e){const t=window.location.hostname,s=new URL(e).hostname;return t.toLowerCase()!==s.toLowerCase()||"localhost"===t.toLowerCase()}(S(!1));function S(e,t=0,s=0){const i=e?fx.environment.reactViewSameOriginEndpoints:fx.environment.reactViewEndpoints,o=`sandbox-${1+t}`;return`${(i.length&&i[Number(d)]||FxImpl.trustedParentOrigin).replace("{subdomain}",o)}${fx.environment.applicationPath}/React/Index?reactView=true&retryCount=${s}${v}#postParams/`}const I=e=>{let t=0;for(;m.has(t);)t++;return m.set(t,e),t};let P=2e4;const _=3e4,F=2e3,T=4,k=25e3,E=4})),
define("MsPortalImpl/Services/Services.SecurityTokens",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Resources/ImplScriptResources","Fx/Cryptography","Fx/UriBuilder","Fx/Experimentation","FxInternal/Authentication/TokensCommon"],(function(e,t,s,i,o,n,r,a,l,c,d){"use strict";t.SecurityTokensManager=t.DEV=void 0,t.persistOrClearFeatureValueInLocalStorage=function(e){const{experimentValue:t,localStorageEntryKey:s}=e,i=e.data||{};t?MsPortalImpl.localStorage.setItem(s,t):MsPortalImpl.localStorage.removeItem(s);h.trace({source:"UI.Initialize",action:s,data:{...i,isExperimentValuePresent:!!t}})};var p=MsPortalFx.Base,u=p.Net2,m=p.Constants,g=p.Diagnostics,h=g.Telemetry,f=p.Resources,x=p.Security,b=FxImpl.Security;g.LogEntryLevel;const y=window,v=g.createLog(e),w=m.Shell,M=["cloudsimpleextbearer","cacheextensionapp","internalgraphapiversion","prefetchtokensinparallel","useupdatedserviceerrorcodes"].reduce(((e,t)=>{const s=MsPortalFx.getFeatureValue(t);return s&&(e[`feature.${t}`]=`${s}`),e}),{}),C=f.getAppRelativeUri("/api/DelegationToken"),S=f.getAppRelativeUri("/api/PortalAuthorization/GetPopToken"),I=f.getAppRelativeUri("/api/PortalAuthorization/GetThirdPartyToken"),P=b.tokenErrors,_=fx.environment.auth.portalClientId,F=fx.environment.auth.armAadResource,T={},k=P.unknown,E=P.sessionEnded,D=P.credentialsExpired,A=P.networkError,B=P.badRequest,N={[P.requiresMFA.toLowerCase()]:!0,[P.tooManyRequests.toLowerCase()]:!0,[P.missingBrokerReplyUrl.toLowerCase()]:!0,[P.deviceUncompliant.toLowerCase()]:!0,[P.passthroughUserError.toLowerCase()]:!0},R=Object.create(null);let L,z,H;try{z=JSON.parse(MsPortalImpl.sessionStorage.getItem("FallbackHardFailMap")||null)||Object.create(null)}catch{z=Object.create(null)}try{H=JSON.parse(MsPortalImpl.sessionStorage.getItem("OverrideExtensionAppIdMap")||null)||Object.create(null)}catch{H=Object.create(null)}function O(t,s,o,n,r,a){const l=s?.toLowerCase();try{const e=JSON.parse(t)||Object.create(null);if(!("object"==typeof e&&!Array.isArray(e)&&"string"==typeof e.oldAppId&&"string"==typeof e.newAppId&&!!e.newAppId))throw new Error(`${n} appidswap_${l} has invalid inputs`);const i=o||"",a=e.oldAppId||"",c=e.newAppId;i===a&&(U(`ExtensionClientIdSwappedVia${n}`,s,{extensionClientId:o,appIdToOverride:a,newAppId:c,correlationId:r}),o=c,H[l]=c,MsPortalImpl.sessionStorage.setItem("OverrideExtensionAppIdMap",JSON.stringify(H)))}catch(t){a&&(0,i.logToExtension)(e,s,2,`Overriding the extension client ID failed for extension '${s}'. Details: ${MsPortalFx.getLogFriendlyMessage(t?.message||t)}. CorrelationId: ${r}`)}return o}function U(e,t,s){h.trace({source:"Services.SecurityTokens",name:t,action:e,data:s})}let W=null;let V=e=>MsPortalFx.isFeatureEnabled("msaljs")||e.getBooleanValue("msaljsexp"),q=e=>MsPortalFx.isFeatureEnabled("msaljswithfallback");function $(e){const t=e.toLowerCase();return(MsPortalFx.getFeatureValue("xmscc")+"").toLowerCase().split(",").includes(t)}function j(e){return MsPortalFx.isFeatureEnabled("cae")||e.getBooleanValue("caeexp")}function G(e,t,s,i,o){if(!W){const t=MsPortalFx.getFeatureValue("msaljsoptedoutextensions"),s="string"==typeof t&&t?.length?t.trim():e.getStringValue("msaljsoptedoutextensions");U("MsaljsOptedOutExtensionsSource",null,{sourceUsed:t?"FeatureFlag":"Experiment",correlationId:o}),function(e,t){W={};let s={};try{s=JSON.parse(e||"{}")}catch{U("MsaljsOptedOutExtensionsParseError",null,{inputString:e,correlationId:t})}MsPortalFx.forEachKey(s,((e,t)=>{const s=e.toLowerCase();s in W||(W[s]=new Set),(t||[]).forEach((e=>{e&&W[s].add(e.toLowerCase())}))}))}(s,o)}const n=W[t];return e.getBooleanValue("authverbosetelemetry")&&U(i,null,{normalizedExtensionNameLowerCase:t,resourceNameLowerCase:s,extensionLevelOptOut:n?.has("*"),resourceLevelOptOut:n?.has(s),correlationId:o}),n}function K(e){return Promise.resolve({result:{value:{authHeader:null,expiresAt:0,expiresInMs:0,status:B,errorMessage:e},portalAuthorization:"",altPortalAuthorization:""},requestDetails:{audience:null,extensionClientId:null,tokenFetchMethodType:"MsalJs"}})}let J=t.SecurityTokensManager=class{constructor(e,t,s,i){this._authStateManager=e,this._experimentation=t,this._windowManager=s,this.saveMruTokenFunc=MsPortalFx.noop,this.sessionEndedHandler=MsPortalFx.noop,this.tokenFailedHandler=MsPortalFx.noop,this.unauthorizedTokenHandler=MsPortalFx.noop,this.tokenMfaErrorHandler=MsPortalFx.noop,this.tokenClaimsErrorHandler=MsPortalFx.noop,this.prefetchTokenThrottlingHandler=MsPortalFx.noop,this.portalAuthHandlerPromise=Promise.resolve(null),this._sessionEnded=!1,this._extensionsAuthMetadataLoadPromise=null,this._tokenHistory={};const o=this._loginReplyUrlPath=e.bootstrapState.loginReplyUrlPath;this.portalAuthHandlerPromise=this._experimentation.shellAssignments.whenAvailable().then((t=>{if("/auth/login/"===o||V(t)||q()){this._extensionsAuthMetadataLoadPromise=MsPortalEarly.extensionAuthMetadataInPortalConfig;const n=h.start({source:"Services.SecurityTokens",action:"msalModuleLoad"});return MsPortalFx.require("MsPortalImpl/Services/PortalAuthHandler").then((r=>(h.completeTrace(n,{loginReplyUrlPath:o}),r.MsalClientAuth.getInstance(e,s,i,t))))}return Promise.resolve(null)}));const n=e.bootstrapState??{},r=n.createdOn??Date.now();this._userUsedMfa=e.getCurrentUser().isMfa;const a=this._user=n.user??{};this._tenantId=a.tenantId,this._ongoingTokenRequest=Promise.resolve(void 0),this.shellTokenCache=this._createShellTokenCache(n.oAuthToken,n.selfOAuthToken,r),setInterval((()=>function(e,t){const s=Date.now(),i=[];Object.keys(e).forEach((t=>{const s=e[t];s.expiresAt<Date.now()&&(i.push(`${s.extensionName}_${s.resourceName}`),delete e[t])})),U("CleanTokenHistoryScheduledJobCompleted",w,{pageVisible:t,timeTaken:Date.now()-s,extensionTokensDeleted:i})}(this._tokenHistory,this._authStateManager.getPageVisibility())),36e5),this.getTokenFunc=async e=>{const{sshTokenData:t,resourceName:s,audience:i,tenantId:o,requestedScopes:n}=e,r=window.fx.environment.consoleClientId;if(MsPortalFx.isFeatureEnabled("enableauthtelemetrycli")&&!T[s]&&(U("GetTokenFuncForAzConsoleRequestSummary",null,{resourceName:s,audience:i,azConsoleClientId:r,tenantId:o,includesSshTokenData:!!t}),T[s]=!0),t){let s=i;const o=await this._extensionsAuthMetadataLoadPromise;if(!s){s=(((o["HubsExtension".toLowerCase()]||{}).resourceAccessMap||{})[e.resourceName]||{}).resource}const{token:n,errorMessage:a}=await this.getSshCertToken({extensionClientId:r,audience:s,jwk:t.jwk,kid:t.kid});return{header:n?.header,expiresAt:n?.expiresAt,tokenType:n?.header?.split(" ")[0],errorMessage:a}}try{const t=await this.getToken({extensionName:"HubsExtension",resourceName:e.resourceName,audience:e.audience,extensionClientId:r,isBackground:!1,skipCache:!1,requestedScopes:n}),s=t.token;return s?.header?{header:s.header,expiresAt:s.expiresAt,tokenType:""}:{header:"",expiresAt:null,tokenType:"",errorMessage:t.errorMessage}}catch(e){const t=e.innerErrors;return{header:"",expiresAt:null,tokenType:"",errorMessage:t.length?t[0]?.errorMessage:e.message}}},u.initialize((async e=>(await this.shellTokenCache.getToken(e)).header),(async()=>(await p.Security.getUserInfo()).armTenantDataBoundary))}isSessionEnded(){return this._sessionEnded}getDiagnosticsData(){return{user:this._user}}async getAuthorizationTokenForChallenge({currentAuthorizationHeader:e,wwwAuthHeader:t}){const s=this._tokenHistory;if(!e)return U("ClaimsChallengeAuthHeaderInvalid",null,"Received a null/empty authorization header for the initial request that resulted in a claims challenge. This is an invalid request."),Promise.resolve(null);if(!t)return U("ClaimsChallengeStringInvalid",null,"Received a null/empty claims challenge string. This is an invalid request."),Promise.resolve(null);const i=s[await(0,a.getHmacSha256UsingCryptoApi)("key1",e)],o=i?.extensionName;return i?(U("ClaimsChallengeCacheHit",o,{cachedTokenDetails:i}),this.getToken({audience:i.audience,extensionClientId:i.extensionClientId,extensionName:o,resourceName:i.resourceName,wwwAuthHeader:t,isBackground:!1,skipCache:!0})):(U("ClaimsChallengeCacheMiss",null,"Did not find a match for the current authorization header presented on the request."),Promise.resolve(null))}async getToken(e){e=e||{};const{extensionName:t,isBackground:s,requestedScopes:i,isThirdPartyExtension:o,audience:l,authConfigStamp:c,extensionIsSideloaded:d,extensionClientId:p,popTokenData:m,wwwAuthHeader:g,tenantId:f,addXmsCcForExtension:x}=e,b=e.skipCache||!!g||!!f,M=!f,C=MsPortalFx.newGuid();let{resourceName:S}=e;S=S||"";let _=t===w?"HubsExtension":t,F=S;"telemetrytoken"===S.toLowerCase()&&(_="HubsExtension",F=MsPortalFx.isFeatureEnabled("selftoken")?"self":"");const T=this.shellTokenCache;let A=1;const B=await this._experimentation.shellAssignments.whenAvailable(),R="/auth/login/"===this._authStateManager.bootstrapState?.loginReplyUrlPath||function(e,t,s,i){if(!V(e))return!1;const o=G(e,t,s,"checkMsalJsEnabledForExtensionResource",i);return!o||!o.has("*")&&!o.has(s)}(B,_.toLowerCase(),F.toLowerCase(),C),L=function(e,t,s,i){if(!q())return!1;const o=G(e,t,s,"checkMsalJsWithFallbackExpEnabledForExtensionResource",i);return!o||!o.has("*")&&!o.has(s)}(B,_.toLowerCase(),F.toLowerCase(),C),z=this._authStateManager.tokenCache;U("IncomingTokenRequestSummary",t,{addXmsCcForExtensionValue:x,audience:l,authConfigStamp:c,correlationId:C,extensionClientId:p,extensionIsSideloaded:d,extensionName:t,includesPopTokenData:!!m,includesWwwAuthHeader:!!g,isBackground:s,isThirdPartyExtension:o,normalizedExtensionName:_,normalizedResourceName:F,resourceName:S,skipCache:b,tenantIdOnRequest:f,isNullTokenCache:!z,requestedScopes:i});const H=async()=>{if(!b){const e=z?.[_];if(e){const s=e[i?.length?`${F}_${i.join("_")}`:F];if(s){const e=s.header,o=s.expiresAt;if(o>Date.now())return U(e?"GetCachedToken":"GetCachedErrorResponse",t,{normalizedExtensionName:_,normalizedResourceName:F,resourceName:S,cacheEntryExpirationTicks:o,correlationId:C,requestedScopes:i}),Promise.resolve({...s,token:e?{header:e,expiresAt:o}:null});this._authStateManager.clearExtensionTokens(_)}}}const o=Date.now(),c={...e,extensionName:_,resourceName:F,skipCache:b,audience:l,addXmsCcForExtension:$(t),correlationId:C,requestedScopes:i},d=h.startTrace({source:"Services.SecurityTokens",action:"GetTokenResult",data:{correlationId:C}});let u,m;return L&&"/auth/login/"!==this._loginReplyUrlPath?(u="MsalJsWithFallback",m=this._getTokenFromMsalJsWithFallback(c)):R?(u="MsalJs",m=this._getTokenFromMsalJs(c)):(u="Msal.Net",m=this._getTokenFromServer(c,u)),m.then((async({result:c,requestDetails:m})=>{const g=(c=c||{}).value||{};let x=g.status,I=g.errorMessage;const B=m?.tokenFetchMethodType,L=g.missingClaims,z=g.authHeader,O=c.relatedExtensionMetadata?.length?c.relatedExtensionMetadata:[{name:_,resource:F,requestedScopes:i}];if(h.endTrace(d,!!z,{correlationId:C,enableMsalJs:R,extensionName:t,normalizedExtensionName:_,extensionClientId:m?.extensionClientId,resourceName:S,requestedScopes:i,normalizedResourceName:F,audience:l,status:x,errorMessage:I,missingClaimsReceived:!!L,isBackground:s,pageVisible:this._authStateManager.getPageVisibility(),tokenFetchMethod:u,tokenFetchMethodType:B}),x===P.tooManyRequests&&this.prefetchTokenThrottlingHandler(),z){const e=g.expiresAt,o=await(0,a.getHmacSha256UsingCryptoApi)("key1",z);if(this._tokenHistory[o]={extensionName:t,resourceName:S,expiresAt:e,extensionClientId:p,audience:l,requestedScopes:i,tenantId:f},s||!MsPortalFx.isFeatureEnabled("prefetchtokens")&&!MsPortalFx.isFeatureEnabled("msaljsprefetch")||this.saveMruTokenFunc({extension:_,resource:F,audience:l}),x)v.warning(`Received malformed token with non-null 'authHeader' and 'status' values. If the token has a valid authHeader, the status must be null and vice-versa. Extension: ${t}, resource: ${S}, status: ${x}`,null,{correlationId:C});else{const o=Date.now();if(!(e<=o)){const t={header:g.authHeader,expiresAt:e};return M&&this._authStateManager.updateExtensionTokens(O,t),{token:t}}if(!(A>3))return v.warning(`Token fetch took longer than token lifetime, retrying operation. Retry attempt: ${A++}, Token expiration: ${e}, Current time: ${o}`,null,{extensionName:t,resourceName:S,normalizedExtensionName:_,normalizedResourceName:F,isBackground:s,requestedScopes:i,skipCache:b,correlationId:C}),H();v.error("Unable to get token after {0} retry attempts.".format(A),null,{correlationId:C}),x=k}}if(x||(x="NullTokenNullError",v.warning(`Token missing both authHeader and status. The token must contain a valid status if the authHeader could not be obtained. Setting status to "${x}". Extension: ${t}, resource: ${S}`,null,{correlationId:C})),!s){if(L&&x!==P.refreshTokenRejectedByConditionalAccess)return this.tokenClaimsErrorHandler(t,S,L,I,C),{token:null,error:"MissingClaims",errorMessage:"Token request failed due to missing claims"};if(x===P.passthroughUserError&&(I=r.passthroughUserError.format(t,this._tenantId,I)),M&&N[x.toLowerCase()]){const e={header:null,expiresAt:o+6e4,error:x,errorMessage:I};this._authStateManager.updateExtensionTokens(O,e)}const s=x===D;if(x===E&&["UnauthorizedRefreshToken","AccountIdentifierMismatch"].includes(I))this.unauthorizedTokenHandler(t,S,I);else if(x===E||s){let e;if(this._sessionEnded=!0,s||!T)e=o;else{const s=t===w?S:"";e=T.getTokenExpiresAt(s,i)}this.sessionEndedHandler(t,e||o,C)}else if(x===P.requiresMFA){const e=this._userUsedMfa?r.mfaFailureUserHasMfa:r.mfaFailureUserHasNoMfa.format(y.fx.environment.links.mfa);this.tokenMfaErrorHandler(t,S,e,C)}else if(x===P.refreshTokenRejectedByConditionalAccess)this._windowManager.redirect({uri:n.getErrorPageUri("UE_SessionExpired",encodeURIComponent(I)),redirectAction:3,reason:P.refreshTokenRejectedByConditionalAccess,logData:{extensionName:t,resourceName:S}});else if(e.extensionIsSideloaded&&(I+=" Testing extension authorization configuration changes by sideloading is not supported. Please deploy your changes to test."),x!==P.brokerTimeout&&this.tokenFailedHandler(t,S,I,C),t!==w){const e="Failed to get token for {0} & {1}. Error:{2}. Message:{3}".format(t,S,x,I);x===k?v.error(e):v.verbose(e)}}return{token:null,error:x,errorMessage:I}}))};return H().then((e=>{const s=e?.token;return R&&o&&s.header?async function(e,t,s){const i=e.header,o=h.startTrace({source:"Services.SecurityTokens",action:"GetThirdPartyEncryptedToken",name:t,data:{correlationId:s}}),{encryptedToken:n}=await u.postJSON({uri:I,dataType:"json",setAuthorizationHeader:!1,headers:{authorization:i},performRetry:!1},{extensionName:t});let r;return r=n?{token:{header:n,expiresAt:e.expiresAt}}:{error:k,errorMessage:"Failed to encrypt the authorization header."},h.endTrace(o,!!r.token?.header,{isNonEmptyTokenHeader:!!i,correlationId:s}),r}(s,t,C):e}))}async getPopToken(e){const{extensionName:t,scopes:s,resourceRequestMethod:i,resourceRequestUri:o,shrClaims:n,shrNonce:r}=e,a=await this.portalAuthHandlerPromise,c=MsPortalFx.newGuid(),d=h.startTrace({source:"Services.SecurityTokens",action:"GetPopToken",name:e.extensionName,data:{correlationId:c}});let p;if(a){const e=await MsPortalEarly.extensionAuthMetadataInPortalConfig||{};let l=e[t.toLowerCase()]?.oAuthClientId;l||(v.warning(`The extension '${t}' does not have an oAuthClientId specified when requesting a PoP token. The portal's client ID will be used to make this request.`),l=_),p=await a.acquireTokenForExtension({extensionClientId:l,scopes:s,isBackground:!1,popTokenData:{scopes:s,resourceRequestMethod:i,resourceRequestUri:o,shrClaims:n,shrNonce:r},correlationId:c})}else{const t=new l(S);p=(await u.postJSON({uri:t.toString(),dataType:"json",setAuthorizationHeader:!1,performRetry:!1},{extensionName:e.extensionName,portalAuthorization:this._authStateManager.bootstrapState.refreshToken,altPortalAuthorization:this._authStateManager.bootstrapState.altRefreshToken,tenant:this._tenantId,httpMethod:e.resourceRequestMethod,scopes:e.scopes,requestUri:e.resourceRequestUri,shrClaims:e.shrClaims})).value}return h.endTrace(d,!!p?.authHeader,{isMsalJsEnabled:!!a}),p}async getSshCertToken(e){const t=this._experimentation.shellAssignments,s=MsPortalFx.newGuid();if(!V(t))return Promise.reject("The 'getSshCertToken' API was called in a portal session where msaljs was not enabled. This API is not supported here and should not be called.");const{audience:i,extensionClientId:o,jwk:n,kid:r}=e;if(!i)return Promise.reject("The audience value is null or empty.");if(!o)return Promise.reject("The extensionClientId value is null or empty.");const a=await this.portalAuthHandlerPromise,l=await a.acquireTokenForExtension({extensionClientId:o,isBackground:!1,scopes:[i+"/.default"],sshTokenData:{jwk:n,kid:r},tenantId:this._tenantId,correlationId:s});return l.authHeader?{token:{header:l.authHeader,expiresAt:l.expiresAt}}:{token:null,error:l.status,errorMessage:l.errorMessage}}async _getTokenFromMsalJsWithFallback(e){const{correlationId:t,extensionName:s,resourceName:i}=e,o=s.toLowerCase(),n=i.toLowerCase();if(z[o]=z[o]||Object.create(null),z[o][n])return await this._getTokenFromServer(e,"Msal.Net Cached Fallback");const r=await this._getTokenFromMsalJs(e);return r?.result?.value?.status?(U("GetTokenFromMsalJsWithFallback_ServerCalled",o,{audience:e.audience,errorMessage:r.result.value.errorMessage,extensionClientId:e.extensionClientId,resourceNameLowerCase:n,status:r.result.value.status,correlationId:t}),z[o][n]=!0,function(){try{const e=JSON.stringify(z);MsPortalImpl.sessionStorage.setItem("FallbackHardFailMap",e)}catch(e){h.trace({source:"Services.SecurityTokens",action:"StoreFallbackHardFailMap",actionModifier:"Failed",data:{error:MsPortalFx.getLogFriendlyMessage(e)}})}}(),await this._getTokenFromServer(e,"Msal.Net Initial Fallback")):r}isPortalToken(e){const t=e?.toLowerCase();return!t||t===FxImpl.nonCaeArmAliasLowerCase}async _getTokenFromMsalJs(t){if("true"===MsPortalImpl.sessionStorage.getItem("InitializedWithSilentAuth"))return{result:{value:this._authStateManager.bootstrapState.oAuthToken,portalAuthorization:"",altPortalAuthorization:""},requestDetails:{audience:"",extensionClientId:"",tokenFetchMethodType:"MsalJs"}};const{correlationId:s,extensionName:o,resourceName:n,tenantId:a,popTokenData:c,wwwAuthHeader:u,addXmsCcForExtension:m,isThirdPartyExtension:g,isBackground:h,requestedScopes:f}=t;let{audience:x,extensionClientId:b}=t;const y=await this._extensionsAuthMetadataLoadPromise,w=o.toLowerCase(),M=y[w];if(b=function(e,t,s,i){const o=t?.toLowerCase();if(!o||!H||"object"!=typeof H)return s;const n=H[o];if(n&&"string"==typeof n)return n;let r=s;const a=e.getBooleanValue("enableappidswaperrorlogging"),l=e.getStringValue(`appidswap_${o}`);"string"==typeof l&&l?.length&&(r=O(l.trim(),t,s,"Experiment",i,a));const c=MsPortalFx.getFeatureValue(`appidswap_${o}`);return"string"==typeof c&&c?.length&&(r=O(c.trim(),t,s,"Feature",i,a)),r}(this._experimentation.shellAssignments,o,b||M?.oAuthClientId,s),!b&&!M){if(!this.isPortalToken(n)){const e=`The extension '${o}' was not found in the list of extensions registered with the portal. Please follow the instructions at https://aka.ms/portalfx/extensionauth register your extension with the portal.`;return v.error(e,null,{correlationId:s}),K(e)}{v.warning(`The extension '${o}' was not found in the list of extensions registered with the portal. The portal's ARM token will be returned by default.`,null,{correlationId:s});const e=this._authStateManager.tokenCache.HubsExtension,t=e?.[""],i=t?.expiresAt>Date.now()-6e5;if(t&&i)return Promise.resolve({result:{value:{authHeader:t.header,expiresAt:t.expiresAt,expiresInMs:t.expiresAt-Date.now()},portalAuthorization:"",altPortalAuthorization:""},requestDetails:{audience:x,extensionClientId:b,tokenFetchMethodType:"MsalJs"}});x=F,b=_}}if(b=b||M.oAuthClientId,b||(v.warning(`The extension '${o}' does not have an oAuthClientId specified. The portal's client ID will be used to make this request.`,null,{correlationId:s}),b=_),n&&n.toLowerCase()!==FxImpl.nonCaeArmAliasLowerCase||(x=F,b=_),!x){const e=M.resourceAccessMap;if(!e)return U("EmptyAudienceInPortalConfig",o,{normalizedResourceName:n,correlationId:s}),K(`The extension '${o}' has not defined any resource access in the portal's configuration. Please follow the instructions at https://aka.ms/portalfx/resourceaccess to fix this. CorrelationId: ${s}`);const t=e[n.toLowerCase()];if(!t)return U("MissingResourceInPortalConfig",o,{normalizedResourceName:n,correlationId:s}),K(`The extension '${o}' has not defined the resource access for resource '${n}' in the extension's configuration, or in the portal's configuration. Please follow the instructions at https://aka.ms/portalfx/resourceaccess to add your new resource. CorrelationId: ${s}`);if(x=t.resource,b=t.overrideClientId||b,!x)return U("MissingAudienceInPortalConfig",o,{normalizedResourceName:n,correlationId:s}),K(`The extension '${o}' has an invalid audience for the resource '${n}' in the extension's configuration or portal's configuration. CorrelationId: ${s}`)}const C=(0,d.isCommonEndPointMatch)(x);if(C?.length){const e=x;if(x=(0,d.translateCommonEndpoint)(C[0]),!x)return K(`The extension '${o}' has an unsupported placeholder '${e}' as the audience for the resource '${n}' in the extension's configuration or portal's configuration. CorrelationId: ${s}`)}const S=x===b;S&&(b=_),MsPortalFx.isFeatureEnabled("replaceaadgraphendpoint")&&new l(x).getAuthority()===new l(fx.internalEnv.fxGraphEndpoint).getAuthority()&&(x="https://graph.microsoftazure.us/");const I=[p.Constants.Shell.toLowerCase(),"HubsExtension".toLowerCase()].includes(w);if(b===_&&!I&&!S&&!this.isPortalToken(n)){const t=this._isExtensionAndAudienceAllowedForUsingPortalClientId(o,x,s),n=`The extension '${o}' does not have an oAuthClientId specified when requesting a token for audience '${x}'. To resolve this error, the extension needs to create a first-party application and enlist it with the portal. CorrelationId: ${s}`;if(this._experimentation.shellAssignments.getBooleanValue("logmissingextensionappid")&&(0,i.logToExtension)(e,o,2,n),!t){return K(`The extension '${o}' does not have an oAuthClientId specified when requesting a token for audience '${x}'. To resolve this error, the extension needs to create a first-party application and enlist it with the portal. CorrelationId: ${s}`)}}U("ExtensionTokenRequestSummary",o,{normalizedExtensionName:o,normalizedResourceName:n,audience:x,extensionClientId:b,isThirdPartyExtension:g,correlationId:s});let T=[];T=f?.length?[x+"/"+f.join(" ")]:[x+"/.default"];let k;if(b.toLowerCase()===_){const e=j(this._experimentation.shellAssignments)&&t.resourceName.toLowerCase()!==FxImpl.nonCaeArmAliasLowerCase||m;k=this.portalAuthHandlerPromise.then((t=>t.acquireTokenForPortal({scopes:T,isBackground:h,wwwAuthHeader:u,addXmsCcClaim:e,correlationId:s})))}else k=this.portalAuthHandlerPromise.then((e=>e.acquireTokenForExtension({scopes:T,isBackground:h,extensionClientId:b,tenantId:a,popTokenData:c,wwwAuthHeader:u,addXmsCcClaim:m,correlationId:s})));return k.then((e=>{if(e?.status===P.missingBrokerReplyUrl){const t=r.missingBrokerReplyUrlError.format(o,b,"https://aka.ms/portalfx/msaljsreplyurl");e={...e,errorMessage:t}}return{result:{value:e,portalAuthorization:"",altPortalAuthorization:""},requestDetails:{audience:x,extensionClientId:b,tokenFetchMethodType:"MsalJs"}}}))}_getTokenFromServer(e,t){if(MsPortalFx.isFeatureEnabled("paralleltokens")){const{extensionName:s,resourceName:i}=e,o=(s+"_"+i).toLowerCase();let n=R[o];return n&&!e.skipCache||(R[o]=n=this._getTokenFromController(e,t)),n.finally((()=>{R[o]=null}))}return this._ongoingTokenRequest=this._ongoingTokenRequest.then((()=>this._getTokenFromController(e,t))),this._ongoingTokenRequest}_getTokenFromController(e,t){const{correlationId:s,extensionName:i,resourceName:o}=e,n=this._authStateManager.bootstrapState.refreshToken,r=this._authStateManager.bootstrapState.altRefreshToken,a=function(e,t){const s={extensionName:e.extensionName,resourceName:e.resourceName,tenant:e.tenant,portalAuthorization:e.portalAuthorization,wwwAuthHeader:e.wwwAuthHeader,authConfigStamp:e.authConfigStamp,altPortalAuthorization:e.altPortalAuthorization,sshTokenData:e.sshTokenData},i=h.startTrace({source:"Services.SecurityTokens",action:"Get",name:e.extensionName,data:{correlationId:e.correlationId}});let o="",n="";const r=new l(C),a={...M};return(j(t)||$(e.extensionName))&&(a["feature.cae"]="true"),e.skipCache?a["feature.tokencaching"]="false":a["feature.tokencaching"]=`${MsPortalFx.isFeatureEnabled("tokencaching")}`,a["feature.replaceaadgraphendpoint"]=`${MsPortalFx.isFeatureEnabled("replaceaadgraphendpoint")}`,u.postJSON({uri:r.toString(),dataType:"json",setAuthorizationHeader:!1,performRetry:!1,headers:{"x-ms-feature-flags":JSON.stringify(a)}},s).catchError(MsPortalFx.Errors.AjaxError,(t=>{o="Failed to get tokens for extension '{0}' resource '{1}'. {2} {3} {4}".format(e.extensionName,e.resourceName,t?.jqXHR?.status??"",t?.textStatus??"",t?.errorThrown??"");let s="";return t?t.jqXHR?t.jqXHR.responseText||(s="response.jqXHR.responseText"):s="response.jqXHR":s="response",n=s?`${s} was undefined.`:t.jqXHR.responseText.slice(0,20),Promise.reject(t)})).finally((()=>{h.endTrace(i,!o,{correlationId:e.correlationId,error:o,resourceName:e.resourceName,skipCache:e.skipCache,errorResponseText:n})}))}({extensionName:i,tenant:this._tenantId,resourceName:o??"",portalAuthorization:n,skipCache:e.skipCache,wwwAuthHeader:e.wwwAuthHeader,authConfigStamp:e.authConfigStamp,altPortalAuthorization:r,correlationId:s},this._experimentation.shellAssignments).catch((e=>{const t=e.data??{},s=t.status;let i;i=401===s?D:400===s?B:s?k:A;const o=e?.jqXHR?.responseJSON?.message??e.message,a=e?.stack??"";return{portalAuthorization:n,value:{authHeader:null,expiresAt:0,expiresInMs:0,refreshToken:null,status:i,errorMessage:`code: ${s}, statusText: ${t.statusText}, message: ${o}, stack: ${a}`},altPortalAuthorization:r}}));return a.then((e=>(this._authStateManager.updateRefreshToken(e.portalAuthorization||n,e.altPortalAuthorization||r,s),{result:e,requestDetails:{audience:null,extensionClientId:null,tokenFetchMethodType:t}})))}_createShellTokenCache(e,t,s){const i=Object.create(null);if(e){const t=e.expiresInMs??1;i[""]={header:e.authHeader,expiresAt:t>0?s+t:-1}}if(t){const e=t.expiresInMs??1;i.self={header:t.authHeader,expiresAt:e>0?s+e:-1}}return x.createAuthTokenCache((e=>{let t=e?.resourceName||"";return"telemetrytoken"===t.toLowerCase()&&(t=MsPortalFx.isFeatureEnabled("selftoken")?"self":""),this._sessionEnded?Promise.resolve({error:E}):this.getToken({...e,extensionName:w,resourceName:e.resourceName,skipCache:e.skipCache}).then((e=>{const s=(e??{}).token;if(s&&["","self"].includes(t.toLowerCase())){const e=Date.now(),i=this._authStateManager.bootstrapState??{};let o,n;""===t?(o={authHeader:s.header,expiresAt:s.expiresAt,expiresInMs:s.expiresAt-e},n=i.selfOAuthToken):(o=i.oAuthToken,n={authHeader:s.header,expiresAt:s.expiresAt,expiresInMs:s.expiresAt-e});const r={...i,createdOn:e,oAuthToken:o,selfOAuthToken:n};this._authStateManager.updateBootstrapState(r,"getTokenFunc")}return e}))}),i)}_fetchAllPortalAppIdAllowListValues(){const e=[];for(let t=1;t<=10;t++){const s=this._experimentation.shellAssignments?.getStringValue(`portalappidallowlist${t}`);if(!s)return e;e.push(s)}return e}_isExtensionAndAudienceAllowedForUsingPortalClientId(e,t,s){if(!e&&!t)return U("IsExtensionAndAudienceAllowedForUsingPortalClientId",e,{audience:t,error:"Missing the extensionName or audience.",correlationId:s}),!0;if(L&&"object"==typeof L&&!Array.isArray(L)){return(L[e.toLowerCase()]||[]).some((e=>e.toLowerCase()===t.toLowerCase()))}const i=this._fetchAllPortalAppIdAllowListValues();if(!i.length)return!0;const o={};try{if(i.forEach(((e,t)=>{const s=JSON.parse(e);if(!s||"object"!=typeof s||Array.isArray(s))throw new Error(`Value contained in portalappidallowlist${t+1} was invalid`);Object.keys(s).forEach((e=>{const i=s[e];if(!i||!Array.isArray(i)||!i.length)throw new Error(`Value contained in portalappidallowlist${t+1} was invalid for key '${e}'`);if(!o[e])return void(o[e]=i);const n=[...o[e]];i.forEach((e=>{n.includes(e)||n.push(e)})),o[e]=n}))})),!Object.keys(o).length)return!0;L=o}catch(i){return U("ErrorParsingPortalAppIdAllowList",e,{audience:t,error:MsPortalFx.getLogFriendlyMessage(i?.message||i),correlationId:s}),!0}return(o[e.toLowerCase()]||[]).some((e=>e.toLowerCase()===t.toLowerCase()))}};t.SecurityTokensManager=J=__decorate([__metadata("fx:diagnostics",[e,"SecurityTokensManager"]),s.Class(),__metadata("design:paramtypes",[o.AuthStateManager,c.Experimentation,n.WindowManager,s.Container])],J)})),
define("MsPortalImpl/Services/Services.Settings",["require","exports","Fx/DependencyInjection","FxHubs/HubsSettingsSchema","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/UI/UI.NavigationManager","FxHubs/RpcEndPoints","FxInternal/AsyncLoader","Fx","FxInternal"],(function(e,t,s,i,o,n,r,a,l,c){"use strict";t.SettingsManager=t.PortalStartupMarkers=t.Internal=void 0,t.deleteUserSettings=T,t.deleteUserSettingsHandler=void 0,t.flush=P,t.getAllStoreIds=function(){return MsPortalFx.map(v,MsPortalFx.identity)},t.getDashboardStoreId=function(e){return v[e]},t.getDashboardStoreName=function(e){return w[e+1e3]},t.queryStores=function(e,t){if(!t||!t.length)return Promise.resolve(new Map);const s=t.map((t=>e.queryStore(t)),e);return Promise.all(s).then((e=>{const s=new Map;return e.forEach(((e,i)=>{s.set(t[i],e)})),s}))},t.readExtUserSettingsHandler=t.readBrowserStorageSettingsHandler=void 0,t.readUserSettings=_,t.writeBrowserStorageSettingsHandler=t.readUserSettingsHandler=void 0,t.writeUserSettings=F,t.writeUserSettingsHandler=void 0;var d=MsPortalFx.Base,p=d.Net2,u=MsPortalFx.Base.Diagnostics;const m=fx.environment,g=fx.environment.applicationPath+"/api/Settings{0}",h=g.format("/Update"),f=g.format("/Select"),x=g.format("/Clear"),b=g.format("/ClearAll"),y=d.Diagnostics.createLog(e);d.getVersionFromString(m.version).revision=0;const v={General:0,Blade:1,Part:2,LensState:3,Startboard:4,SharedPart:5,HubsExtension:6,CrossTenant:7,Favorites:8,DashboardInventory:9,FileUpload:10,FirstVisited:12,StartupNotifications:13,ArgQueryInventory:14,Browse:15,Recents:16,Hats:18,ResourceFilters:19,TrialLanding:20,Contactability:21,TourGuide:23,Session:22,MenuFavorites:24,HomeRecommendation:25,Personalization:26,HomeView:27,Login:28},w=(0,l.forEachKey)(v,((e,t,s)=>{s[t]=e}),[]);(()=>{for(let e=0;e<100;e++){const t="Dashboard"+e,s=e+1e3;v[t]=s,w[s]=t}})();let M=t.PortalStartupMarkers=class{};var C;t.PortalStartupMarkers=M=__decorate([__metadata("fx:diagnostics",[e,"PortalStartupMarkers"]),s.Class()],M),function(e){const t=FxImpl.features.isEnabled("selftoken");function s(e){const t=w[e];if(!t)throw new Error(`Invalid store: ${e}`);return t}function i(e,t){const i={};return t&&t.forEach(((t,o)=>{const n="string"==typeof o?o:s(o);i[n]=t,e&&delete e[n]})),i}function o(e){const t={};var s;e.keys.forEach((s=null,function(e){this[e]=s}),t);const i=new Map;return i.set(e.store,t),i}function n(e,t){const s=MsPortalFx.merge(e,t);let i={settingsToSet:new Map,settingsToDelete:new Map};return i=s.reduce(((e,t)=>(r(e.settingsToSet,e.settingsToDelete,t.settingsToSet),r(e.settingsToDelete,e.settingsToSet,t.settingsToDelete),e)),i),[i]}function r(e,t,s){s&&s.forEach(((i,o)=>{const n="string"==typeof o?o:parseInt(o),r=s.get(n);if(e&&(e.get(n)||e.set(n,{}),a(r,e.get(n))),t){const e=t.get(n);e&&(u(r,e),MsPortalFx.isEmpty(e)&&t.delete(n))}}))}function a(e,t){(0,l.forEachKey)(e,((e,s)=>{t[e]=s}))}function u(e,t){(0,l.forEachKey)(e,(e=>{delete t[e]}))}e.createUserSettingsManager=function(e,t,s,i){return new S(new v(e,new m(g.createWithWriteDeleteBufferTimeout(t,i),s)))},e.getSettingStoreName=s,e.convertSettingQueryToDictionary=o,e.updateDictionary=r,e.updateSettingsDictionary=a,e.sanitizeSettingsDictionary=u;e.InMemorySettingsManagerImpl=class{constructor(){this._maps={}}setSettings(e){return(0,l.forEachKey)(e.settings,((e,t,s)=>{s.set(e,JSON.stringify(t))}),this._getMap(e.store)),Promise.resolve()}queryStore(e){const t=this._getMap(e),s={};return t.forEach(((e,t)=>{s[t]=JSON.parse(e)})),Promise.resolve(s)}deleteSettings(e){if(e.keys){const t=this._getMap(e.store);e.keys.forEach((e=>{t.delete(e)}))}return Promise.resolve()}clearSettings(){return Promise.resolve(this._maps={})}flushSettings(){return Promise.resolve()}dispose(){}_getMap(e){return this._maps[e]=this._maps[e]||new Map}};class m{constructor(e,t){this._baseManager=e,this._managersDictionary=new Map,this._managers=[this._baseManager],t&&t.forEach((e=>{this._managers.push(e.manager),e.stores.forEach((t=>{this._managersDictionary.set(t,e.manager)}))}))}queryStore(e,t){return this._getManager(e).queryStore(e,t)}deleteSettings(e,t){return this._getManager(e.store).deleteSettings(e,t)}setSettings(e,t){return this._getManager(e.store).setSettings(e,t)}clearSettings(){return Promise.all(this._managers.map((e=>e.clearSettings())))}flushSettings(){return this._baseManager.flushSettings()}dispose(){this._baseManager.dispose()}_getManager(e){return this._managersDictionary.get(e)||this._baseManager}}e.RoutingSettingsManager=m;e.UserSettingsManagerImpl=class{constructor(e,t){this._ajaxState=0,this._memoizedQueryStore=(0,l.memoizePromise)((e=>{const t=(0,l.startTimer)();return this._ajax(f,[e]).then((s=>{this._setAjaxState(1);const i=s?.content&&s.content[e]||{},o=t();return o>5e3&&y.warning(`\n                        Request to store '${e}' took more than 5s to complete.\n                        Request time: ${o}ms.\n                        Response size: ${s&&s.jqXHR&&s.jqXHR.responseText.length}\n                    `),i})).catch((e=>(this._setAjaxState(2,e,`queryStore(duration:${t()})`),{})))})),this._clearAllUserSettings=e.isEnabled("clearallusersettings"),this._useInMemorySettings=e.isEnabled("inmemorysettings"),t=Promise.resolve(t),this._preloadingStores=t.then((e=>(this._setAjaxState(1),e&&e.settings||{})),(e=>(MsPortalFx.Helpers.isXMLHttpRequestLike(e)&&p.isRetryable(e)||y.error(new MsPortalFx.Errors.Error({message:"Early Failed to preload stores.",innerErrors:e}),1),{}))),this._preloadingStores.then((e=>{this._preloadStores=(0,l.forEachKey)(e,((e,t,s)=>{t&&(s[e]=Promise.resolve(t))}),{}),this._preloadingStores=null}))}_ajax(e,s){return s||e!==h&&e!==f?p.ajaxExtended({uri:e,type:"POST",dataType:"json",data:s&&JSON.stringify(s),contentType:"application/json;charset=utf-8",timeout:3e4,performRetry:!0,maxRetryDuration:3e4,setAuthorizationHeader:!t||{resourceName:"self"},headers:{"x-ms-feature-flags":JSON.stringify(MsPortalEarly.earlyBaseFeatureFlags)}}).catchError(MsPortalFx.Errors.AjaxError,(t=>(400===t.jqXHR?.status?y.error(`Setting _ajax 400 occurred. uri: ${e}, data: ${MsPortalFx.getObjectDescriptor(s,!0)}.`):t.jqXHR?.status>=500&&y.error(`Setting _ajax 5xx occurred. uri: ${e}, response: ${t.jqXHR.responseText}.`),Promise.reject(t)))):Promise.reject(FxImpl.createError(`Invalid setting ajax call uri: ${e}, data: ${MsPortalFx.getObjectDescriptor(s)}`))}_setAjaxState(e,t,s){if(e>this._ajaxState&&(this._ajaxState=e,2===e)){(t&&t.data&&(0===t.data.status||401===t.data.status)?y.warning:y.error).bind(y)(new MsPortalFx.Errors.Error({message:`${s} Setting is transitioned into HasFailRequests state. All further querystore/updatesetting will be in-memory mode.`,innerErrors:t}))}}queryStore(e,t){const i="string"==typeof e?e:s(e);return this._ajaxState>=2?Promise.resolve({}):(t&&this._memoizedQueryStore.delete(i),this._preloadingStores?this._preloadingStores.then((e=>e[i]||this._memoizedQueryStore(i))):this._preloadStores[i]||this._memoizedQueryStore(i))}clearSettings(){(0,l.forEachKey)(this._preloadStores,(e=>{delete this._preloadStores[e]})),this._memoizedQueryStore.clear();const e=(0,l.startTimer)();return this._ajax(this._clearAllUserSettings?b:x).catch((t=>{this._setAjaxState(2,t,`clearSetting(duration:${e()}):`)}))}updateSettings(e){if(!this._useInMemorySettings&&1===this._ajaxState){const t={save:i(this._preloadStores,e.settingsToSet),remove:i(this._preloadStores,e.settingsToDelete)};if(t.save||t.remove){const e=(0,l.startTimer)();return this._ajax(h,t).catch((t=>(this._setAjaxState(2,t,`updateSettings(duration:${e()}):`),Promise.reject(t))))}}return Promise.resolve()}};class g{constructor(e,t,s,i){this._primitiveSettingsManager=e,this._sequencer=t(n,(e=>this._executeMethod(e[0])),s,!0,{optionalDataInterval:i})}static createWithWriteDeleteBufferTimeout(e,t,s){return new g(e,((e,t,s,i,o)=>new d.Debouncer(e,t,s,i,o)),t||5e3,s||3e5)}queryStore(e,t){return this._primitiveSettingsManager.queryStore(e,t)}setSettings(e,t){if(!MsPortalFx.isEmpty(e.settings)){const s=new Map;return s.set(e.store,e.settings),this._sequencer.execute([{settingsToSet:s,settingsToDelete:null}],1===t)}return Promise.resolve()}deleteSettings(e,t){return e.keys&&e.keys.length?this._sequencer.execute([{settingsToSet:null,settingsToDelete:o(e)}],1===t):Promise.resolve()}flushSettings(){return this._sequencer.flush()}clearSettings(){const e=Promise.withResolvers();return this.flushSettings().finally((()=>{this._primitiveSettingsManager.clearSettings().finally((()=>{e.resolve()}))})),e.promise}dispose(){this.flushSettings()}_executeMethod(e){return this._primitiveSettingsManager.updateSettings(e)}}e.SequencingSettingsManager=g;class v{constructor(e,t){this._cache=new Map,this._activeUpdatePromises=new Map,this._uniqueId=1,this._memoizedQueryPromises=(0,l.memoizePromise)((e=>{const t=this._verifySettings()?this._baseManager.queryStore(e):Promise.resolve({});return c.tryImmediateResolve(t,(t=>this._updateCaches(e,t)))})),this._useInMemorySettings=e.isEnabled("inmemorysettings"),this._baseManager=t}queryStore(e,t){return t?(this._memoizedQueryPromises.delete(e),this._baseManager.queryStore(e,t).then((t=>this._updateCaches(e,t)))):this._memoizedQueryPromises(e)}setSettings(e,t,s){return new Promise(((i,o)=>{this._execute(this._setSettingsInternal,e,t,i,o,s)}))}dispose(){this._baseManager.dispose()}_setSettingsInternal(e,t,s,i,o,n){const r=this._writeSettingsToCache(e,!0),a=()=>this._baseManager.setSettings(r,t).then(i).catch(o);n?(a(),this._resolveSetPromise(s)):this._executeIfBaseManagerCallIsAllowed(a,s)}_resolveSetPromise(e){const t=this._activeUpdatePromises.get(e);t&&(t.resolve(),this._activeUpdatePromises.delete(e))}_execute(e,t,s,i,o,n){const r=this._uniqueId++;if(this._activeUpdatePromises.set(r,Promise.withResolvers()),t){const a=t.store,l=()=>{e.call(this,t,s,r,i,o,n)};this._cache.get(a)?l():this.queryStore(a).then(l)}}deleteSettings(e,t){return new Promise(((s,i)=>{this._execute(this._deleteSettingsInternal,e,t,s,i)}))}_deleteSettingsInternal(e,t,s,i,o){this._deleteSettingsFromCache(e),this._executeIfBaseManagerCallIsAllowed((()=>{this._baseManager.deleteSettings(e,t).then(i).catch(o)}),s)}clearSettings(){const e=Promise.withResolvers();return this.flushSettings().finally((()=>this._baseManager.clearSettings().finally((()=>{this._cache=new Map,this._memoizedQueryPromises.clear(),e.resolve()})))),e.promise}flushSettings(){const e=[];return this._activeUpdatePromises.forEach((t=>e.push(t.promise))),Promise.all(e).then((()=>this._baseManager.flushSettings()))}_updateCaches(e,t){return this._writeSettingsToCache({store:e,settings:t}),this._cache.get(e)}_verifySettings(){return!this._useInMemorySettings}_executeIfBaseManagerCallIsAllowed(e,t){e(),this._resolveSetPromise(t)}_deleteSettingsFromCache(e){const t=this._cache.get(e.store);e.keys&&t&&e.keys.forEach((e=>{delete t[e]}))}_writeSettingsToCache(e,t){const s=e.store;if(e){this._cache.has(s)||this._cache.set(s,{});const i=this._cache.get(s),o={};return(0,l.forEachKey)(e.settings,((e,s)=>{(!t||i[e]!==s&&JSON.stringify(i[e])!==JSON.stringify(s))&&(i[e]=o[e]=s)})),{store:s,settings:o}}return null}}e.CachingSettingsManagerImpl=v}(C||(t.Internal=C={}));class S{constructor(e){this._baseManager=e}deleteSettings(e,t){return this._baseManager.deleteSettings(e,t)}clearSettings(){return this._baseManager.clearSettings()}flushSettings(){return this._baseManager.flushSettings()}dispose(){this._baseManager.dispose()}async queryStore(e,t,s){const i=await this._baseManager.queryStore(e,t);return s?i:I(i)}querySettings(e,t){return e.keys&&e.keys.length>0?this.queryStore(e.store,t,!0).then((t=>{const s={};if(t){e.keys.filter((e=>e in t)).forEach((e=>{s[e]=t[e]}))}return I(s)})):this.queryStore(e.store,t)}querySetting(e,t,s){return this.querySettings({store:e,keys:[t]},s).then((e=>{if(e){const s=e[t];return void 0===s?null:s}return null}))}setSettings(e,t){return this._baseManager.setSettings(I(e),t)}setSetting(e,t,s,i){return this.setSettings(function(e,t,s){const i={};return i[t]=s,{store:e,settings:i}}(e,t,s),i)}readSettingsRpc(e,t){const s=e,o=MsPortalFx.find(e,(e=>!i.allowedUserSettingsKeys.includes(e)));if(o)throw u.createIgnoreUnhandledRejectionError(`${t.srcWindowId} is not allowed to read the user setting ${o}.`);return _(this,s).then((e=>{const t={};return Object.getOwnPropertyNames(e).forEach((s=>{t[s]=e[s]})),t}))}static create(e,t,s){const i={manager:new C.InMemorySettingsManagerImpl,stores:[11]},o=e.isEnabled("day0settings"),n=C.createUserSettingsManager(e,new C.UserSettingsManagerImpl(e,!o&&MsPortalEarly.preload),[i]);return t.unloadCallbacks.push((()=>P(n))),o?n.clearSettings().then((()=>{const e=new d.UriBuilder(t.location.href);return e.query.removeParameters(["day0settings","feature.day0settings"]),t.redirect({uri:e.toString(),skipFlushBuffers:!0,reason:"useDayZeroSettings"}),Promise.withResolvers().promise})):n}}function I(e){return JSON.parse(JSON.stringify(e))}function P(e){const t=[e?e.flushSettings():Promise.resolve(),u.Telemetry.flush(),u.Upload.flush(),u.Metric.flush()];return Promise.all(t)}function _(e,t,s,i){const o={store:MsPortalFx.isNullOrUndefined(s)?6:s,keys:t};return e.querySettings(o,i).then((e=>t.length?MsPortalFx.convertArrayToMap(t,MsPortalFx.identity,(t=>e[t])):e))}function F(e,t,s,i){const o={store:i||6,settings:t};e.setSettings(o,s)}function T(e,t,s){const i={store:s||6,keys:t};e.deleteSettings(i)}t.SettingsManager=S,__decorate([__metadata("fx:diagnostics",[e,"SettingsManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[FxImpl.Features,n.WindowManager,o.SecurityTokensManager]),__metadata("design:returntype",Object)],S,"create",null);t.deleteUserSettingsHandler=(0,a.defineHandler)(i.deleteHubsUserSettings,(e=>T(e.diContainer.get(S),e.messageArg.settingsKeys,e.messageArg.settingStore))),t.readUserSettingsHandler=(0,a.defineHandler)(i.readHubsUserSettings,(e=>_(e.diContainer.get(S),e.messageArg.settingsKeys,e.messageArg.settingStore,e.messageArg.bypassCache))),t.writeUserSettingsHandler=(0,a.defineHandler)(i.writeHubsUserSettings,(e=>F(e.diContainer.get(S),e.messageArg.settings,e.messageArg.priority,e.messageArg.settingStore)));const k=[];k[1]="hideBrowseInfo";t.writeBrowserStorageSettingsHandler=(0,a.defineHandler)(r.BrowserStorageSettings.writeBrowserStorageSettingsEndpoint,(e=>{const t=e.messageArg;if(0!==t.storageType)return Promise.reject("Access outside of local storage is denied.");let s=!1;return(0,l.forEachKey)(t.storageSettings,((e,t)=>{k[e]||(s=!0)})),s?Promise.reject("Certain keys in the list are not allowed to be accessed."):((0,l.forEachKey)(t.storageSettings,((e,t)=>{"string"===MsPortalFx.getTypeOf(t)&&MsPortalImpl.localStorage.setItem(k[e],t)})),Promise.resolve(null))})),t.readBrowserStorageSettingsHandler=(0,a.defineHandler)(r.BrowserStorageSettings.readBrowserStorageSettingsEndpoint,(e=>{const t=e.messageArg;if(0!==t.storageType)return Promise.reject("Access outside of local storage is denied.");const s={};let i=!1;return t.storageKeys.forEach((e=>{k[e]||(i=!0),s[e]=MsPortalImpl.localStorage.getItem(k[e])})),i?Promise.reject("Certain keys in the list are not allowed to be accessed."):Promise.resolve(s)})),t.readExtUserSettingsHandler=(0,a.defineHandler)(FxImpl.Azure.ResourceManager.readUserSettingsEndPoint,(e=>e.diContainer.get(S).readSettingsRpc(e.messageArg,e.messageContext)))})),
define("MsPortalImpl/Services/Services.SettingsProcessor",["require","exports"],(function(e,t){"use strict";t.SettingsProcessor=void 0,t.create=async function(e,t,s,i,o){const n=new FxImpl.TriggerableLifetimeManager,r={},a=Object.keys(s);a.forEach((e=>{r[e]=0,s[e].subscribe(n,(s=>{1!==r[e]&&(r[e]=3,void 0===s?t.deleteSettings({store:i,keys:[e]}):t.setSetting(i,e,s),o&&t.flushSettings())}))}));const l=await t.queryStore(i)||{};return a.forEach((e=>{const t=l[e];void 0!==t&&0===r[e]&&(r[e]=1,s[e](t),r[e]=2)})),new e(s,(()=>t.flushSettings()),(()=>n.dispose()))};t.SettingsProcessor=class{constructor(e,t,s){this.value=e,this.flush=t||(()=>Promise.resolve()),this.dispose=s||(()=>{})}}})),
define("MsPortalImpl/Services/Services.HomeViewSettings",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.SettingsProcessor"],(function(e,t,s,i,o){"use strict";t.HomeViewSettingsManager=t.HomeViewSettings=void 0;class n extends o.SettingsProcessor{static create(e){return o.create(n,e,new r,27,!0)}}t.HomeViewSettingsManager=n,__decorate([__metadata("fx:diagnostics",[e,"HomeViewSettingsManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.SettingsManager]),__metadata("design:returntype",Promise)],n,"create",null);class r{constructor(){this.homeview=ko.observable(""),this.userTypeHint=ko.observable(""),this.showAzHome=ko.observable(!1),this.freHomeCredits=ko.observable(null),this.freHomePage=ko.observable("")}static create(e){return e.value}}t.HomeViewSettings=r,__decorate([__metadata("fx:diagnostics",[e,"HomeViewSettings"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[n]),__metadata("design:returntype",r)],r,"create",null)})),
define("MsPortalImpl/Services/Services.GeneralSettings",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.SettingsProcessor","FxHubs/HubsSettingsSchema","FxInternal/AsyncLoader","MsPortalImpl/Services/Services.HomeViewSettings"],(function(e,t,s,i,o,n,r,a){"use strict";t.GeneralSettingsManager=t.GeneralSettings=void 0,t.effectiveMenuBehaviorSetting=l,t.getCurrentDeepLink=void 0,t.getMenuBehaviorSettingFromSettings=function(e){let t;t=e instanceof d?e:e.get(d);return l(t.defaultMenuCollapseState())},t.isLandingPageDashboard=function(e){const t=e.get(FxImpl.Features),s=e.get(d).landingPage();return!t.isEnabled("azurehome")||2===s||4===s},t.isSideBarDocked=function(e){const t=e.get(FxImpl.Features),s=e.get(d).sideBarLayout(),i=e.get(a.HomeViewSettings),o=FxImpl.getShellAssignments();return!t.isEnabled("sidebarhamburgermode")||o?.getBooleanValue("LeftNav")||(o?.getBooleanValue("azhome")||"startup"===i.userTypeHint())&&i.showAzHome()||"startup"===i.homeview()||2===s||4===s},t.proxyGetCurrentDeepLink=function(e){t.getCurrentDeepLink=p=e},t.proxySetCurrentDeepLink=function(e){t.setCurrentDeepLink=u=e},t.setCurrentDeepLink=void 0,t.stringifyDefaultMenuCollapseState=function(e){switch(e){case 1:return"InitAsCollapsed";case 3:return"Collapsed";case 0:return"InitAsExpanded";case 2:return"Expanded";default:return""}},t.writeBrowsePreviewOptInFlagHandler=void 0;function l(e){switch(e){case 3:case 1:return 3;case 2:case 0:return 2;default:return window?.fx?.environment?.chrome?.defaultSettingForMenuGroupsAsExpanded?2:3}}class c extends o.SettingsProcessor{constructor(e,t,s){super(e,t,s)}static create(e,t){const s=new d;return t.registerObjectFactory(FxImpl.Constants.RpcMethods.getSettings,{allowedOrigin:null,allowRemoteChanges:!1,handler:()=>MsPortalFx.clone(s,!1)}),o.create(c,e,s,0)}}t.GeneralSettingsManager=c,__decorate([__metadata("fx:diagnostics",[e,"GeneralSettingsManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.SettingsManager,FxImpl.Rpc.Client]),__metadata("design:returntype",Promise)],c,"create",null);class d{constructor(){this.rawLocale=ko.observable(""),this["fxs-theme"]=ko.observable(),this.npsTimeMs=ko.observable(0),this.sideBarCollapsedKey=ko.observable(!1),this.sideBarCollapsedKeyV2=ko.observable(!1),this.notificationToastEnabledKey=ko.observable(!0),this.notificationSurveyEnabledKey=ko.observable(!0),this.notificationTeachingBubbleEnabledKey=ko.observable(!0),this.whatsNewEnabledKey=ko.observable(!0),this.sideBarBrowseDisplayModeKey=ko.observable(0),this.whatsNewVersion=ko.observable(0),this.userConsentForNpsContact=ko.observable(!1),this.userOptedOutOfNpsSurvey=ko.observable(!1),this.mfaModalAcknowledged=ko.observable(!1),this.mfaNotificationAcknowledged=ko.observable(!1),this.armMfaGeneralNotificationShown=ko.observable(!1),this.highContrastKey=ko.observable(0),this.idleTimeoutMins=ko.observable(0),this.dblClickThemeEnabledKey=ko.observable(!0),this.searchHistory=ko.observable(""),this.landingPage=ko.observable(MsPortalFx.isFeatureEnabled("landalltohome")?3:4),this.devSatTimeMs=ko.observable(0),this.TestExtensions=ko.observable(),this.TestPatches=ko.observable(),this.sideBarLayout=ko.observable(MsPortalFx.isFeatureEnabled("sidebarhamburgermode")?3:4),this.defaultMenuCollapseState=ko.observable(!0===window?.fx?.environment?.chrome?.defaultSettingForMenuGroupsAsExpanded?0:1)}static create(e){return e.value}}t.GeneralSettings=d,__decorate([__metadata("fx:diagnostics",[e,"GeneralSettings"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[c]),__metadata("design:returntype",d)],d,"create",null);t.writeBrowsePreviewOptInFlagHandler=(0,r.defineHandler)(n.writeBrowsePreviewOptInFlagEndpoint,(e=>{const t=e.messageArg;if((t.assetIds||[]).length){const s=e.diContainer.get(i.SettingsManager);s.querySetting(15,"argBrowsePreference").then((e=>{e=e||{},t.assetIds.forEach((s=>{e[s.toLowerCase()]=t.value})),s.setSetting(15,"argBrowsePreference",e);const i=p().toLowerCase();if(!t.preventAutoBladeLaunch&&(i.startsWith("#blade/HubsExtension/BrowseResource/resourceType/".toLowerCase())||i.startsWith("#blade/HubsExtension/BrowseResourceBlade/resourceType/".toLowerCase())||i.startsWith("#view/HubsExtension/BrowseResource/resourceType/".toLowerCase())||i.startsWith("#view/HubsExtension/BrowseResourceBlade/resourceType/".toLowerCase()))){const e=encodeURIComponent(t.resourceType);let s=t.value?"#view/HubsExtension/BrowseResource/resourceType/"+e:"#view/HubsExtension/BrowseResourceBlade/resourceType/"+e;t.kind&&(s=s+"/kind/"+encodeURIComponent(t.kind)),u(s)}}))}}));let p=()=>window.location.hash||"";t.getCurrentDeepLink=p;let u=e=>{window.location.hash=e};t.setCurrentDeepLink=u})),
define("_generated/Less/MsPortalImpl/Themes/Themes.Reset.css",["module"],(function(e){"use strict";return{css:'.fxs-display-none{display:none!important}.fxs-hide-accessible-label{overflow:hidden;position:absolute;top:-1000px;left:-1000px;width:0;height:0}html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{font-size:100%;font-weight:inherit}html{-webkit-text-size-adjust:100%;text-size-adjust:100%}html,body{height:100%}body{font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400;margin:0;padding:0;overflow:hidden}button,input,select,textarea{font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400;border-radius:0}input::-ms-clear{display:none}button,[type="button"],[type="reset"],[type="submit"]{font-size:13px;line-height:1.385;background:none;color:inherit}img{overflow:hidden;max-height:100%;max-width:100%}textarea{overflow:auto}img,a img,:link img,:visited img{border:0}a[href]{-webkit-touch-callout:default}a[href]:not([tabindex="-1"]):focus,area[href]:not([tabindex="-1"]):focus,input:not([disabled]):not([tabindex="-1"]):focus,select:not([disabled]):not([tabindex="-1"]):focus,textarea:not([disabled]):not([tabindex="-1"]):focus,button:not([disabled]):not([tabindex="-1"]):focus,iframe:not([tabindex="-1"]):focus,[contentEditable="true"]:not([tabindex="-1"]):focus{outline-offset:-1px}[tabindex="0"]:focus{outline-offset:-1px}tbody tr[tabindex]:not([tabindex="-1"]):focus{box-shadow:none}a{text-decoration:none}b,strong{font-weight:700}pre,code{font-family:Consolas,"Courier New",monospace;font-size:13px}legend,fieldset{border:0;margin:0;padding:0}hr{border-width:0;border-top-width:1px;border-top-style:solid}[role="button"],[role="link"],.fxs-fxclick{cursor:pointer}a[href]:hover,[role="link"].fxs-fxclick:hover{text-decoration:underline}a[role="menuitem"]:hover{text-decoration:none}::placeholder{opacity:1}:focus-visible{outline-width:1px;outline-style:solid}@supports(-webkit-touch-callout:none){*{-webkit-touch-callout:none}}svg{overflow:hidden}',moduleId:e.id}})),
define("MsPortalImpl/Base/Themes",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.GeneralSettings","FxInternal/Css","_generated/Less/MsPortalImpl/Themes/Themes.Reset.css"],(function(e,t,s,i,o,n,r){"use strict";t.ThemeManager=void 0,(0,n.injectCss)(r);var a=MsPortalFx.Base,l=a.Resources,c=a.Diagnostics.Telemetry.trace;const d=window,p=d.fx.environment,u="fxs-theme",m=`${u}-`,g="fxs-mode-standardcontrast ext-mode-standardcontrast",h="fxs-mode-highcontrast ext-mode-highcontrast",f="fxs-highcontrast-dark ext-highcontrast-dark",x="fxs-highcontrast-light ext-highcontrast-light",b=i.Themes.Names,y="_generated/Less/MsPortalImpl/Themes/Theme2.Colors.{0}.css",v="dark",w="azure",M={name:"HighContrastMode",mode:1},C={name:"HighContrastMode",mode:0},S="#f1f1f8",I="#333",P="Theme_Light.png",_="Theme_Dark.png",F=a.Images.Themes.System(),T=a.Images.Themes.Azure();function k(e,t,s,i,o,n){return{colorCode:e,imageUri:l.getContentUri("Content/Images/MsPortalImpl/Themes/"+t),svg:s,name:i,title:o,mode:n}}const E=k(S,P,F,w,b.system,0),D=k(I,_,F,v,b.system,1),A=e=>e?D:E;function B(e,t,s){c({source:e,action:t,data:s})}class N{constructor(e,t){this._lifetime=new FxImpl.TriggerableLifetimeManager,this._brandingDefaultTheme=p.chrome.defaultTheme;const s=t[u]||ko.observable(null),i=t.highContrastKey,o=()=>k("#0078d4","Theme_Azure.png",T,w,b.azure,0),n=o(),r=k("#215b7d","Theme_Blue.png",a.Images.Themes.Blue(),"blue",b.blue,0),l=k(I,_,a.Images.Themes.Dark(),v,b.dark,1),c=k(S,P,a.Images.Themes.Light(),"light",b.light,0),y=o();this._legacyThemes=[n,r,c,l];const F=(e,t,s)=>{t=t||{},(e=e||o()).colorCode=t.colorCode,e.imageUri=t.imageUri,e.name=t.name,s&&(e.svg=t.svg)};switch(this._brandingDefaultTheme){case"blue":F(y,r,!0);break;case"light":F(y,c,!0)}y.title=b.light,F(E,y);const D=d.matchMedia("(prefers-color-scheme: dark)"),N=D.matches;this._themes=[A(N),y,l];const R=e=>{const t=e.matches,i=A(t);this._themes[0]=i,b.system===s()?.title&&s(i),this.updateThemesCallback?.()};D.addEventListener("change",R),this._lifetime.registerForDispose((()=>{D.removeEventListener("change",R)}));const L=i();if(i(0),0!==L){let e=y;2===L&&(e=l),s(e)}let z,H;z=b.system===s()?.title?this._themes[0]:MsPortalFx.find(this._themes.slice(1),(e=>e.name===s()?.name)),MsPortalFx.isNullOrUndefined(z)&&(z=MsPortalFx.find(this._legacyThemes,(e=>e.name===(s()||this.getDefaultTheme()).name))),MsPortalFx.isNullOrUndefined(z)&&(z=r),this.currentTheme=s,s(z),this.highContrastMode=i,ko.reactor(this._lifetime,[s,i],((t,s)=>{t=t||this._themes[0];const i=0!==s,o=2===s,n=1===s;i&&(t=o?l:y);const r=this._injectStyles(t),a=o?this._injectStyles(M):n?this._injectStyles(C):Promise.resolve({});Promise.all([a,r]).then((()=>{const s=t.mode?"fxs-mode-dark ext-mode-dark":"fxs-mode-light ext-mode-light";e.removeClass(H).addClass(H=m+t.name+" "+s).toggleClass(g,!i).toggleClass(h,i).toggleClass(f,o).toggleClass(x,n)}))})),s.subscribe(this._lifetime,(()=>{B("Shell","SelectedTheme",s().name)})),i.subscribe(this._lifetime,(e=>{B("Shell","SelectedHighContrastMode",i())}));const O=d.matchMedia("(forced-colors: active) and (prefers-color-scheme: light)"),U=d.matchMedia("(forced-colors: active) and (prefers-color-scheme: dark)"),W=[O,U],V=()=>{O.matches?i(1):U.matches?i(2):i(0)};W.forEach((e=>e.addEventListener("change",V))),d.matchMedia("(forced-colors: active)").matches&&V(),this._lifetime.registerForDispose((()=>{e.removeClass(`${H} ${g} ${h} ${f} ${x}`),W.forEach((e=>e.removeEventListener("change",V)))}))}getThemes(){return this._themes}getLegacyThemes(){return this._legacyThemes}getDefaultTheme(){if(this._brandingDefaultTheme){const e=this._legacyThemes.filter((e=>e.name===this._brandingDefaultTheme));if(e&&e.length>0)return e[0]}return this._legacyThemes[1]}getCurrentThemeColorCssModuleId(){if(1===this.highContrastMode())return y.format("HighContrastMode.LightMode");if(2===this.highContrastMode())return y.format("HighContrastMode.DarkMode");switch(this.currentTheme().name){case w:return y.format("Azure");case"blue":return y.format("Blue");case"light":return y.format("Light");case v:return y.format("Dark")}}_injectStyles(t){const s=t.name,i=t.mode,o=s.charAt(0).toUpperCase()+s.slice(1),r=i?"DarkMode":"LightMode";let a;return a="HighContrastMode"===o?["_generated/Less/MsPortalImpl/Themes/Theme2.{0}.css".format(o),y.format(o+"."+r)]:["_generated/Less/MsPortalImpl/Themes/Theme2.css",y.format(o)],Promise.all(a.map((t=>MsPortalFx.require(t,e)))).then((e=>(0,n.injectCss)(...e)))}dispose(){this._lifetime.dispose()}}class R{static createManager(e){return new N($([d.document.body,d.document.head]),e)}}t.ThemeManager=R,__decorate([__metadata("fx:diagnostics",[e,"ThemeManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.GeneralSettings]),__metadata("design:returntype",R)],R,"createManager",null)})),
define("MsPortalImpl/ReactViews/ReactFrame.FramePrewarmer",["require","exports","MsPortalImpl/Base/Themes","FxInternal/Errors","MsPortalImpl/ReactViews/ReactFrame.Constants"],(function(e,t,s,i,o){"use strict";t.prewarmReactFrame=async function(e){const{diContainer:t,frameClientOptimizations:n,frameCreationStart:r,frameId:a,iframeElement:l,isFrameReactViewMessage:c,boundToView:d,lifetime:p}=e,[u,m,g]=await Promise.all([MsPortalFx.require("_generated/Less/MsPortalImpl/Base/Base.Images.css"),MsPortalFx.require("_generated/Less/MsPortalImpl/Widgets/Widgets.Portal.css"),MsPortalFx.require(t.get(s.ThemeManager).getCurrentThemeColorCssModuleId())]);if(p.isDisposed())throw new i.FxDisposedCanceledError;const h=new MessageChannel;l.contentWindow.postMessage({signature:o.reactFrameSignature,kind:3,data:{requireConfig:FxImpl.internalEnv.fxRequireConfig,initModules:[],css:[u,m].map((e=>e.css)).join("\n"),isMenuBladeContent:!0,boundToView:d,preload:MsPortalFx.isFeatureEnabled("preorderpreload"),profile:MsPortalFx.isFeatureEnabled("reactprofile"),portalUri:FxImpl.internalEnv.portalApplicationUri,type:"prewarm",shellClientOptimizations:fx.environment.clientOptimizations,internalEnv:{blockUntrustedDomains:FxImpl.internalEnv.blockUntrustedDomains,azsEndpoints:FxImpl.internalEnv.azsEndpoints,fxTrustedDomains:FxImpl.authTokenDomainValidator?.fxTrustedDomains,createSubscriptionLink:FxImpl.internalEnv.createSubscriptionLink,subscriptionLearnMoreLink:FxImpl.internalEnv.subscriptionLearnMoreLink},perfLogEntries:[{groupName:"ReactView boot",name:"prewarm",timeStamp:r}],themeColorCssModule:g,profileOnReload:"true"===MsPortalImpl.sessionStorage.getItem(o.SESSION_STORAGE_DEVTOOLS_RELOAD_AND_PROFILE)}},"*",[h.port1]);const f=[];let x=(e,t,s)=>{f.push({kind:e,data:t,azHostId:s})};const b={},y=e=>{if(c(e)){const t=e.data;x(t.kind,t.data,t.azHostId)}};window.addEventListener("message",y);const v={id:a,element:l,port:h.port2,setMessageListener:(e,t)=>{b[t]=e,x=(e,t,s)=>{if(b[s])return b[s](e,t);f.push({kind:e,data:t,azHostId:s})},f.splice(0).forEach((({kind:e,data:t,azHostId:s})=>{x(e,t,s)}))},clearMessageListener:()=>{v.frameReuseSupported||window.removeEventListener("message",y)},inUse:!1,frameClientOptimizations:n};return v}})),
define("MsPortalImpl/ReactViews/ReactFrame.FramePool",["require","exports","Fx/DependencyInjection","Fx/Experimentation","FxInternal/Lifetime","MsPortalImpl/ReactViews/ReactFrame.FrameCreator","MsPortalImpl/ReactViews/ReactFrame.FramePrewarmer"],(function(e,t,s,i,o,n,r){"use strict";t.ReactFramePool=void 0;var a=MsPortalFx.Base.Diagnostics.Telemetry;let l=t.ReactFramePool=class{constructor(e){this._diContainer=e,this._experiments={},this._framesByExtension=new Map,this._framesInUse=[],this._getExtensionFrameCache=new Map,this._lifetime=new o.TriggerableLifetimeManager,this._previousCompleted=MsPortalFx.noop,this._viewLoadsByFrame=new Map,this._spareFrameTimeout=0,this._diContainer.get(i.Experimentation).shellAssignments.whenAvailable().then((e=>{Object.assign(this._experiments,{prewarmContextPanes:e.getBooleanValue("PrewarmContextPanes"),reactServiceJsonSerialization:e.getBooleanValue("ReactServiceJsonSerialization"),skipEarlyStorageData:e.getBooleanValue("SkipEarlyStorageData")})})),this._spareFrameCreationDelay=1e3*(+MsPortalFx.getFeatureValue("reactspareframedelay")||0)}getFrame(e,t,s,i,o){if(3===e&&this._sidebarFrame)return this._sidebarFrame;const r=(o&&(1!==e||this._experiments.prewarmContextPanes)?this.getExtensionFrame({extensionName:s,bladeSequenceNumber:i}):this.createFrame(t,!0)).promise.then((s=>{this._framesInUse[this._framesInUse.length-1]?.classList.remove("fxs-reactview-frame-active");const i=s.element;return i.classList.add("fxs-reactview-frame-active"),i.classList.remove("fxs-display-none"),this._framesInUse.push(i),s.container=t,this._experiments.prewarmContextPanes&&i.classList.toggle("fxs-contextpane-floated-frame",1===e),s})),a=Promise.withResolvers(),l=Promise.withResolvers(),c=async e=>{this._previousCompleted===c&&(this._previousCompleted=MsPortalFx.noop,await r,e||(await a.promise,await new Promise((e=>setTimeout(e,1e3)))),this._previousCompleted===MsPortalFx.noop&&(this.makeSpareFrame(),l.resolve()))};this._previousCompleted=c;const d={frame:r,completed:c,onFCP:a.resolve,dispose:()=>{r.then((e=>{const t=e.element;t.classList.remove("fxs-reactview-frame-active");const i=this._framesInUse.findIndex((e=>e===t));if(-1!==i&&this._framesInUse.splice(i,1),!e.frameReuseSupported){t.remove();const i=this._framesByExtension.get(s);i&&this._framesByExtension.set(s,i.filter((t=>t.frame!==e)))}this._framesInUse[this._framesInUse.length-1]?.classList.add("fxs-reactview-frame-active"),(0,n.releaseOriginIndexForFrame)(e.id),e.onDisposed?.()}))},reactViewContentLoaded:l.promise};return 3===e&&(this._sidebarFrame=d),d}getReactViewExperiments(){return this._experiments}getSidebarFrame(){return this.getFrame(3,document.querySelector(".fxs-sidebar-content"),"",0,!1)}setFrameRoot(e){this._rootElement=e,this.makeSpareFrame()}loadReactView(e){const{bladeSequenceNumber:t,diContainer:s,extensionName:i,frame:o,inContextPane:n,inSideBar:r,inDockedContextPane:l,viewName:c}=e,d=Date.now(),p=s.get(FxImpl.Rpc.Client);p.acquireWindow(i,90);const u=i+t;if(this._viewLoadsByFrame.has(u))return this._viewLoadsByFrame.get(u);if((l||n&&!this._experiments.prewarmContextPanes)&&!o)return{viewLoadingCompleted:Promise.resolve({}),viewLoadingStarted:Promise.resolve()};o||this._spareFrame||this._previousCompleted();const m=o?{promise:Promise.resolve(o),frame:o,boundToView:!0}:r?{promise:this.getSidebarFrame().frame,boundToView:!0}:this.getExtensionFrame({extensionName:i,bladeSequenceNumber:t});m.promise.then((e=>e.inUse=!0));const g=Promise.withResolvers(),h=MsPortalFx.require("MsPortalImpl/ReactViews/ReactFrame.ViewLoader").then((({loadReactViewIntoFrame:t})=>{const s=o?.id??"No frame",n=a.startTrace({action:"ReactViewLoad",source:"Prewarmer",actionModifier:"mark",data:{extensionName:i,viewName:c,frameId:s}});return t({...e,loadReactViewStart:d,experiments:this._experiments,frameLifetime:this._lifetime.createChildLifetime(),reactFramePromise:m.promise,rpcClient:p,viewLoadingStartedDeferred:g}).then((e=>({traceKey:n,viewMetadata:e.viewMetadata}))).catch((e=>(a.trace({source:"ReactViewPrewarmer",action:"SetLatestError",actionModifier:"cancel",data:{error:MsPortalFx.getLogFriendlyMessage(e),extensionName:i,viewName:c,frameId:s}}),{traceKey:n,viewMetadata:{}})))})),f={viewLoadingCompleted:h,viewLoadingStarted:g.promise};return this._viewLoadsByFrame.set(u,f),f}dispose(){this._lifetime.dispose()}getExtensionFrame({extensionName:e,bladeSequenceNumber:t}){const s=e+t;if(this._getExtensionFrameCache.has(s))return this._getExtensionFrameCache.get(s);this._framesByExtension.has(e)||this._framesByExtension.set(e,[]);let i=MsPortalFx.find(this._framesByExtension.get(e),(e=>e.frame&&e.frame.frameReuseSupported&&!e.frame.inUse));return i?i.frame.reused=!0:(i=this.takeSpareFrame(),this._framesByExtension.get(e).push(i)),this._getExtensionFrameCache.set(s,i),i}createFrame(e,t){if(!e)throw new Error("No root element has been defined yet, cannot create any frames");const s={boundToView:t,promise:void 0};return s.promise=this.initializeNewFrame(s,e).then((e=>(s.frame=e,e))),s}async initializeNewFrame(e,t){const s=Date.now();MsPortalFx.require("MsPortalImpl/ReactViews/ReactFrame.ViewLoader");const i=await(0,n.createReactViewFrame)({experiments:this._experiments,frameContainer:t,lifetime:this._lifetime,isOnDemand:e.boundToView});return(0,r.prewarmReactFrame)({...i,diContainer:this._diContainer,experiments:this._experiments,frameCreationStart:s,boundToView:e.boundToView,lifetime:this._lifetime})}makeSpareFrame(){this._spareFrame||(window.clearTimeout(this._spareFrameTimeout),this._spareFrameTimeout=window.setTimeout((()=>{this._spareFrame=this.createFrame(this._rootElement,!1)}),this._spareFrameCreationDelay))}takeSpareFrame(){if(this._spareFrame){const e=this._spareFrame;return this._spareFrame=void 0,e.boundToView=!0,e.promise=e.promise.catch((()=>this.initializeNewFrame(e,this._rootElement))),e}return this.createFrame(this._rootElement,!0)}};t.ReactFramePool=l=__decorate([__metadata("fx:diagnostics",[e,"ReactFramePool"]),s.Class(),__metadata("design:paramtypes",[s.Container])],l)})),
define("MsPortalImpl/ReactViews/ReactFrame.Utils",["require","exports","Fx/Experimentation"],(function(e,t,s){"use strict";t.clearTrustedViewExpressions=function(){o=void 0},t.getBrowserTabId=function(){let e=MsPortalImpl.sessionStorage.getItem("browserTabId");e||(e=FxImpl.createGuid(null,!0),MsPortalImpl.sessionStorage.setItem("browserTabId",e));return e},t.getModuleIdAndUrl=function(e,t,s=!1){e=e.toLowerCase();const o=s?t=>t.toLowerCase().startsWith(e):t=>!t.includes("/_generated/")&&i.exec(t)?.[0].toLowerCase()===e,n=MsPortalFx.forEachKey(t.dependencyTree||{},((e,t,s)=>{s.id||MsPortalFx.find(Object.keys(t),(t=>{if(o(t))return s.id=t,s.url=e,!0}))}),{id:"",url:""});n.id||MsPortalFx.forEachKey(t.paths,((e,s,i)=>{if(!i.id&&o(e))return i.id=e,i.url=t.paths[e][0],!0}),n);return n},t.getTrustedViewExpressions=n,t.shouldRenderInShell=function(e,t,i){if("Microsoft_Azure_ReactPlayground"===e&&i.get(s.Experimentation).shellAssignments.getBooleanValue("playgroundinshell"))return t.endsWith(".ReactView");if(t.endsWith(".ReactView")){const s=`${e}/${t}`;return n().some((e=>e.test(s)))}return!1},t.watchFirstHiddenAndOffline=function(e){const t=e.createChildLifetime();let s;const i=()=>{s||(s=Date.now(),t.dispose())},o=()=>"hidden"===document.visibilityState&&i();window.addEventListener("visibilitychange",o),t.registerForDispose((()=>window.removeEventListener("visibilitychange",o))),o();const n=()=>!window.navigator.onLine&&i();return window.addEventListener("online",n),t.registerForDispose((()=>window.removeEventListener("online",n))),n(),()=>s};const i=/[^/]*$/;let o;function n(){if(!o){const e=[],t=MsPortalFx.getFeatureValue("TrustedView");t&&e.push(t);const s=MsPortalFx.getEnvironmentValue("trustedViews");s&&Array.isArray(s)&&e.push(...s),o=e.map((e=>function(e){if(!e)return null;if(e.startsWith("/")){const t=e.lastIndexOf("/");if(0===t)return null;try{const s=e.substring(t+1),i=e.substring(1,t);return new RegExp(i,s)}catch{return null}}return new RegExp(`^${MsPortalFx.regexEscape(e)}$`)}(e))).filter(Boolean)}return o}})),
define("MsPortalImpl/Extension/ViewModelManager",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","FxInternal/Composition/ViewModelComposer","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/ReactViews/ReactFederatedModules","MsPortalImpl/ReactViews/ReactFrame.FramePool","MsPortalImpl/ReactViews/ReactFrame.Utils","MsPortalImpl/Extension/ShellPart","MsPortalImpl/Extension/DefinitionCache","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Extension/Extension.Definition.Locator","FxInternal"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m){"use strict";t.ViewModelManager=void 0,t.getNextSequenceNumber=x,t.getViewModelOptions=b,t.registerWithDi=S,t.registerWithState=function(e,t,s){w[e]={name:e,modulePath:t,factoryWithState:s}},t.resolve=I;var g=FxImpl.TelemetryContext;const h=MsPortalFx.Base.Diagnostics.createLog(e);let f=1;function x(){return f++}function b(e,t,s){return{type:e,locator:"object"==typeof t?t:{name:t},createSelectable:s.createSelectable,telemetryContext:g.getState(),partSize:s.partSize,contentSize:s.contentSize,partLocation:s.partLocation,onInputsSetParameters:s.onInputsSetParameters,collapsed:s.collapsed,flags:s.flags,menuId:s.menuId}}let y=class{constructor(e,t,s,i,o){this._diContainer=e,this._rpcClient=t,this._extensionManagerOptions=s,this._definitionCache=i,this._extensionLoader=o,this._proxiedObjects=new Map,this._prefetchedResults=[],this._bladeSequenceNumbers=[]}getViewModel(e,t,s,i){return this._getViewModel(e,s,t,i,o.getViewModelEndPoint,!1)}getPartViewModel(e,t,s,n){if(this._useAzViewModelManager(e,t,!!(64&s)))return this._diContainer.getAsync(i.get("MsPortalImpl/AzFramework/AzExtensionCore","AzViewModelManager")).then((i=>i.getPartViewModel(e,t,s,n)));{const i=this._getViewModel(e,s,t,n,o.getPartViewModelEndPoint,!0),r=n?.bladeName&&64&s,a=r&&this._getBladeRedirector();return i.then((i=>{i||h.error("ViewModelComposer returned null/undefined for the view model",0,[{extensionName:e,type:s,name:t,options:n}]);const o=r&&n?.onInputsSetParameters&&{extensionName:e,bladeName:n.bladeName,parameters:n.onInputsSetParameters.inputs||{}};this._onPartViewModelAcquired(i,a,o)})),i}}getWeaveShellPort(e){const t=this._proxiedObjects.get(e);return t&&t.isPartViewModel&&t.managedValue}_useAzViewModelManager(e,t,s){return"string"==typeof t&&!!s&&(t.toLowerCase().endsWith(".ReactView".toLowerCase())||t.toLowerCase().endsWith(".MenuView".toLowerCase())||t.toLowerCase().endsWith("_dx"))}_getViewModel(e,t,s,i,o,n){const r=b(t,s,i=i||{}),a=I(this._diContainer,e,r,i.onViewModelAcquired);return a||o.acquireChannel(this._rpcClient,e,r).then((e=>{const t=e.value;return this._proxiedObjects.set(t,{isPartViewModel:n,managedValue:e}),i.onViewModelAcquired&&i.onViewModelAcquired(t),t}))}releaseViewModel(e,t){const s=this._proxiedObjects.get(e);if(s){const{managedValue:i}=s;t||MsPortalFx.disposeViewModelProperties(e),MsPortalFx.disposeDisposable(e),i.dispose(),this._proxiedObjects.delete(e)}}getBladeSequenceNumber(e,t,s){const i=_(e,t,s);return MsPortalFx.find(this._bladeSequenceNumbers,(e=>i===e.key))?.sequenceNumber}tryEarlyGetViewModel(e,t,s,n){let c;try{c=this._extensionManagerOptions.getNormalizedMetadata(e,!0),e=c.name}catch(e){return Promise.reject(e)}const p=(e,t)=>{for(;t.length>2;)t.pop();t.push(e)},u=_(e,t,s),{isPrefetch:m}=n,g=this.getBladeSequenceNumber(e,t,s),h=n.sequenceNumber||g||x();m&&!g&&p({key:u,sequenceNumber:h},this._bladeSequenceNumbers);const f=this._useAzViewModelManager(e,t,!0);let b=null;if(f)if((0,l.shouldRenderInShell)(e,t,this._diContainer)){this._diContainer.get(FxImpl.Rpc.Client).acquireWindow(e,90),this._diContainer.get(r.ReactFederatedModules).getInShellRequireConfig(e)}else{const o=this._diContainer.get(a.ReactFramePool),r={isMenuBladeContent:n.isMenuBladeContent,inContextPane:n.inContextPane,inDockedContextPane:n.inDockedContextPane,inSideBar:n.inSideBar,diContainer:this._diContainer,bladeSequenceNumber:h,viewLoadStartTime:Date.now()};t.toLowerCase().endsWith(".ReactView".toLowerCase())||t.toLowerCase().endsWith(".MenuView".toLowerCase())?o.loadReactView({extensionName:e,viewName:t,parameters:s,...r}):t.toLowerCase().endsWith("_dx")&&(b=i.get("MsPortalImpl/Extension/DxDefinitionCache","getRuntimeBlade").then((e=>e(this._diContainer,c,t).then((e=>{e?.bladeName?.toLowerCase().endsWith(".ReactView".toLowerCase())&&o.loadReactView({extensionName:e.extensionName,viewName:e.bladeName,parameters:null,...r})})))))}let y=!(f||(v=t,v in M||v in w||v.startsWith("Shell.InferredBladePinPart")));var v;if(y){const i=this._getCachedBladeDefinition(e,t);(i&&!(0,o.canGetViewModelEarly)(i,s)||P(s=ko.toJS(s||{})))&&(y=!1)}const C=MsPortalFx.find(this._prefetchedResults,(e=>u===e.key));if(!m){C&&MsPortalFx.remove(this._prefetchedResults,C);const e=MsPortalFx.find(this._bladeSequenceNumbers,(e=>u===e.key));e&&MsPortalFx.remove(this._bladeSequenceNumbers,e)}let S;y?C?S=C.result:(this._extensionLoader.setRequestedBlade(e,t),S=o.tryEarlyGetViewModelEndPoint.acquireChannel(this._rpcClient,e,{timestamp:Date.now(),bladeName:t,parameters:s,options:{menuId:n.menuId,partialFlags:(n.inContextPane?1:0)|(n.isMenuBladeContent?4:0)|(n.menuContentOverride?8:0),sequenceNumber:h}}).then((i=>{const o=i.value;return o.viewModel?(this._proxiedObjects.set(o.viewModel,{isPartViewModel:!0,managedValue:i}),this._onPartViewModelAcquired(o.viewModel,I,{extensionName:e,bladeName:t,parameters:s})):i.dispose(),this._diContainer.get(d.DefinitionCache).setBladeDefinition(e,t,Promise.resolve(o.definition)).then((e=>({definition:e,rpcDurationMs:o.rpcDurationMs,viewModel:o.viewModel,viewModelLoadIndex:o.viewModelLoadIndex})))})),m&&p({key:u,result:S},this._prefetchedResults)):S=C?.result||this._definitionCache.getBladeDefinition(e,t).then((e=>({definition:e,rpcDurationMs:-1,viewModel:null,viewModelLoadIndex:-1})));const I=this._getBladeRedirector();return m&&this._prefetchMenuBladeContent(n.menuContentOverride,I,{extensionName:e,bladeName:t,parameters:s}),b?Promise.all([S,b]).then((([e])=>e)):S}_onPartViewModelAcquired(e,t,s){this._tryPrefetchMenuBladeContent(e?.internal.initialMenuHeaderBlade,t,s),this._tryPrefetchMenuBladeContent(e?.internal.initialMenuContentBlade,t,s)}_tryPrefetchMenuBladeContent(e,t,s){e&&m.tryImmediateResolve(Q(e),(e=>{this._prefetchMenuBladeContent(e,t,s)}))}_prefetchMenuBladeContent(e,t,s){if(e){const{extensionName:i,bladeName:o,parameters:n}=e;if(i&&o){const e=s&&this._getCachedBladeDefinition(s.extensionName,s.bladeName),r=Q(t).valueOf();if(e&&r){const t=r.applyRedirects(u.Locator.forExtension(i).withBlade(o),n||{},{bladeDefinition:e,locator:u.Locator.forExtension(s.extensionName).withBlade(s.bladeName),model:s.parameters});t&&this.tryEarlyGetViewModel(t.getExtensionName(),t.name,n||{},{isPrefetch:!0,isMenuBladeContent:!0})}}}}_getCachedBladeDefinition(e,t){const s=Q(this._definitionCache.getBladeDefinition(e,t,!0));return s&&s.valueOf()}_getBladeRedirector(){return this._diContainer.getAsync(i.get("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener.Helpers","BladeRedirector"))}};y=__decorate([__metadata("fx:diagnostics",[e,"ViewModelManagerImpl"]),s.Class(),__metadata("design:paramtypes",[s.Container,FxImpl.Rpc.Client,n.ExtensionManagerOptions,d.DefinitionCache,p.ExtensionLoader])],y);class v{static create(e){return e}}t.ViewModelManager=v,__decorate([__metadata("fx:diagnostics",[e,"ViewModelManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[y]),__metadata("design:returntype",v)],v,"create",null);const w={},M={};let C=class extends o.ViewModelProvider{constructor(e){super(null,null,e.get(FxImpl.Rpc.Client))}};function S(e,t,s){M[e]={name:t,modulePath:s}}function I(e,t,s,i){let o=null,n=null;const r=s.locator.name;if(r in M){const t=e.get(C);return s.locator={name:r,module:M[r].modulePath,export:M[r].name},t.getObservable(e.createChildContainer("viewModel"),null,s,i)}if(r in w?(o=w[r].modulePath,n=e=>w[r].factoryWithState(e)):r.startsWith("Shell.InferredBladePinPart")&&(o="MsPortalImpl/Extension/PinBladeInferred",n=s=>s.createViewModel(r,e.get(v),e.get(d.DefinitionCache),t)),o)return MsPortalFx.require(o).then((e=>n(e))).then((e=>(i&&i(e),"number"==typeof s.partSize&&e&&e.content&&ko.isObservable(e.content.size)&&e.content.size(s.partSize),s.onInputsSetParameters&&e&&e.updatePartInputValues&&(e.onInputsSetPromise=e.updatePartInputValues(s.onInputsSetParameters.inputs,s.onInputsSetParameters.settings,s.onInputsSetParameters.traceOptions)),e)))}function P(e){const t=MsPortalFx.isPlainObject(e)&&Object.keys(e).map((t=>e[t]))||Array.isArray(e)&&e;return t&&t.some((e=>"function"==typeof e||P(e)))}function _(e,t,s){return`${e},${t}${"string"==typeof s?.id?","+s.id:""}`}C=__decorate([__metadata("fx:diagnostics",[e,"ShellViewModelProvider"]),s.Class(),__metadata("design:paramtypes",[s.Container])],C),MsPortalFx.forEachKey(c.shellParts,((e,t)=>S(t.viewModelName,e,t.shellModule)))})),
define("MsPortalImpl/AzFramework/AzExtensionCore",["require","exports","Fx/DependencyInjection","MsPortalImpl/AzFramework/AzBladeViewModel","MsPortalImpl/Base/Base.ImplUtils","FxInternal/Composition/ViewModelComposer","MsPortalImpl/Extension/ViewModelManager","FxInternal/Composition/Part"],(function(e,t,s,i,o,n,r,a){"use strict";function l(e,t){const s=p(e,t,!0),i={name:e,initialDisplayState:2,locked:!0,pinnable:!0,reactView:{},style:8,lenses:[{name:"AzBladeVirtualLens",partInstances:[{name:e,inline:s}]}],effectiveInputs:s.bindings,hasOnPinMethod:!0,attributes:17,contextPaneWidth:1,reflowReady:!0,menuBlade:e.toLowerCase().endsWith(".MenuView".toLowerCase())?{isMenuView:!0}:null};return["BrowseAll.ReactView","BrowseFavoriteResources.ReactView","BrowseRecentResources.ReactView","BrowseResourceGroups.ReactView","BrowseResource.ReactView","ArmBrowse.ReactView"].includes(i.name)&&(i.activationStyle={width:0}),i}t.AzViewModelManager=t.AzDefinitionCache=void 0,t.createAzBladeDefinition=l,t.isValidUri=function(e){return(0,o.validateAbsoluteHttpUri)(e)||e?.startsWith("//")&&(0,o.validateAbsoluteHttpUri)(`http:${e}`)};let c=t.AzDefinitionCache=class{constructor(){}getBladeDefinition(e,t,s){const i=t.toLowerCase(),o=e.bladeMap[i];return Promise.resolve(o||(e.bladeMap[i]=l(t,s)))}getPartDefinition(e,t,s){const i=t.toLowerCase(),o=e.partTypeMap[i];return Promise.resolve(o||(e.partTypeMap[i]=p(t,s)))}};t.AzDefinitionCache=c=__decorate([__metadata("fx:diagnostics",[e,"AzDefinitionCache"]),s.Class(),__metadata("design:paramtypes",[])],c);let d=t.AzViewModelManager=class{getPartViewModel(e,t,s,o){"object"==typeof t&&(t=t.name);const l=(0,a.composePartViewModel)((e=>new i.BladeViewModel(e)),{createSelectable:o&&o.createSelectable,location:o&&o.partLocation,logArea:`Extension/${e}/PartType/${t}`,flags:o&&o.flags,type:s});return l.internal.reactViewInitializeEnd=ko.observable(),o&&((0,n.tryApplyEarlyOnInputsSet)(l,(0,r.getViewModelOptions)(s,t,o)),o.onViewModelAcquired&&o.onViewModelAcquired(l)),Promise.resolve(l)}};function p(e,t,s=!1){const i="parameters";return{isBlade:s,bladeOrPartName:e,isMenuBlade:e.toLowerCase().endsWith(".MenuView".toLowerCase()),extensionName:t,partKind:MsPortalFx.Parts.PartKind._Internal_React,viewModel:e,inputs:[i],...s?{bindings:[{property:i,optional:!1,isIdentityInput:!1,valuesFrom:[{referenceType:999,property:i}]}],initialSize:MsPortalFx.Parts.PartSize.FitToContainer,shareVmWithParentBlade:!0}:{inputDefinitions:[{name:i}]}}}t.AzViewModelManager=d=__decorate([__metadata("fx:diagnostics",[e,"AzViewModelManager"]),s.Class()],d)})),
define("MsPortalImpl/ReactViews/ReactQueryStore",["require","exports","Fx/DependencyInjection","FxInternal/Diagnostics"],(function(e,t,s,i){"use strict";t.ReactQueryStoreManager=void 0,t.registerQuery=function(e){const{cacheOptions:t,getArgsKey:s,name:n,onError:r,query:a}=e,l=e=>{const t=s?.(...e)??(e.length>0?(i=e,JSON.stringify(i,((e,t)=>t&&t instanceof Object&&t.constructor===Object?Object.keys(t).sort().reduce(((e,s)=>(e[s]=t[s],e)),{}):t))):"");var i;return`:query:${n}${t?":":""}${t}`};return{name:n,bind:(e,...s)=>{const c={},d=l(s);return c.query={store:e,arguments:s,clear:()=>{e.clearEntry(d,t)},get:async(l={})=>{const{ignoreCachedValue:c="if-stale",force:p}=l,u=Date.now();if(!p&&"always"!==c){const t=e.getEntry(d);if(t){const e=t.expires<u,s=e||t.staleAfter<u;if(!(e||"unset"===t.state||s&&"never"!==c))return"resolved"===t.state?Promise.resolve(t.data):Promise.reject(t.error)}}return e.setValueAsync(d,(()=>(l.telemetryContext,a(...s).then((e=>e),(e=>{if(r?.(e),0!==e?.errorLevel){let t=e?.message||"Unknown error";try{t=JSON.parse(JSON.stringify((0,i.decycle)(e)))}catch{}o.writeEntry(1,`Query failed: ${n}`,t.code,[t])}throw e})))),t,{forceNewRequest:p})},getCacheEntry:()=>e.getEntry(d),set:s=>{e.setValue(d,{state:"resolved",data:s},t)}},c.query}}};const o=MsPortalFx.Base.Diagnostics.createLog(e);let n=0;class r{constructor(e,t,s){this.extensionName=e,this.baseStore=t,this.getSharedExtensionStore=s,this.entryState={},this.listeners=[],this.entries={...t?.getEntries()},this.baseUnsubscribe=t?.subscribe((e=>this.setEntry({...e,scope:"view"})))}clearEntry(e,t){this.setValue(e,{state:"unset"},t)}getEntries(){const e={},t=Date.now();for(const[s,i]of Object.entries(this.entries))i.expires>=t&&"unset"!==i.state&&(e[s]=i);return e}getEntry(e){return this.entries[e]}setValue(e,t,s={},r){const a=Date.now(),l=r||a;if("rejected"===t.state&&t.error){let e=t.error?.message||"Unknown error";try{e=JSON.parse(JSON.stringify((0,i.decycle)(t.error)))}catch{}t={state:"rejected",error:e}}const c="unset"===t.state||void 0===s.expires?Number.MAX_SAFE_INTEGER:"function"==typeof s.expires?s.expires("data"in t?t.data:void 0):a+1e3*s.expires,d="unset"===t.state?0:"function"==typeof s.staleAfter?s.staleAfter("data"in t?t.data:void 0):a+1e3*(s.staleAfter??5),p={...t,completed:a,expires:c,staleAfter:d,started:l,sequenceId:n++,skipStructuralSharing:s.skipStructuralSharing},u=this.getEntryState(e);u.pendingRequests=u.pendingRequests.filter((e=>e.requestStarted>l)),this.setEntry({id:e,entry:p,scope:s.scope}),o.debug(`Updated query entry: ${e}`,p)}setValueAsync(e,t,s={},i={}){const{forceNewRequest:o}=i,n=this.getEntryState(e);if(o||0===n.pendingRequests.length){const i={requestStarted:Date.now(),promise:void 0};n.pendingRequests.push(i),i.promise=t().then((e=>({state:"resolved",data:e})),(e=>({state:"rejected",error:e}))).then((t=>{if(n.pendingRequests.some((e=>e===i))&&(n.pendingRequests=n.pendingRequests.filter((e=>e!==i)),this.setValue(e,t,s,i.requestStarted)),"rejected"===t.state)throw t.error;return t.data}))}return n.pendingRequests[n.pendingRequests.length-1].promise}setEntry(e){const{entry:t,id:s,scope:i}=e,o=this.getEntry(s);if((!o||o.started<t.started||o.started===t.started&&o.sequenceId<t.sequenceId)&&(this.entries[s]=t,this.baseStore&&"session"===i&&this.baseStore.setEntry(e),this.notifyListeners(e),"session"===i&&e.sharedWith&&this.getSharedExtensionStore))for(const s of e.sharedWith){this.getSharedExtensionStore(s).setEntry({...e,entry:{...t,sharedBy:this.extensionName},sharedWith:void 0})}}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter((t=>t!==e))}}dispose(){this.listeners=[],this.baseUnsubscribe?.()}getEntryState(e){let t=this.entryState[e];return t||(t=this.entryState[e]={pendingRequests:[]}),t}notifyListeners(e){for(const t of this.listeners)t(e)}}let a=t.ReactQueryStoreManager=class{constructor(){this.extensionStores=new Map,this.viewStores=new Map}getViewStore(e,t,s){let i=this.viewStores.get(t);if(!i){const o=this.getExtensionStore(e);i=new r(e,o,this.getExtensionStore.bind(this)),this.viewStores.set(t,i),s.registerForDispose((()=>{this.viewStores.delete(t),i.dispose()}))}return i}getExtensionStore(e){let t=this.extensionStores.get(e);return t||(t=new r(e),this.extensionStores.set(e,t)),t}};t.ReactQueryStoreManager=a=__decorate([__metadata("fx:diagnostics",[e,"ReactQueryStoreManager"]),s.Class()],a)})),
define("MsPortalImpl/Services/Services.BrowserSettings",["require","exports","Fx/DependencyInjection","Weave"],(function(e,t,s,i){"use strict";t.ServiceDependencyState=t.PrivateLinkState=void 0,t.hideSmallModals=function(){return r&&n.width<480},t.isZoomedInTooDeep=function(){return r&&(o.innerHeight<400&&o.innerWidth<800||100*o.devicePixelRatio>300)},t.temporaryExtensionCount=void 0;const o=window,n=o.screen||{},r=MsPortalFx.isFeatureEnabled("hidemodalsonsmallscreens");t.temporaryExtensionCount=new class{constructor(){this._extensionCountTable=new Object(null),this._intervalIds=[]}_getCurrentCount(e){return this._extensionCountTable[e]??0}addIntervalId(e){this._intervalIds.push(e)}flush(){this._extensionCountTable=new Object(null)}flushIntervalIds(){this._intervalIds.filter((e=>clearInterval(e))),this._intervalIds.length=0}incrementCount(e){this._extensionCountTable[e]=this._getCurrentCount(e)+1}getExtensionCountsAsList(){const e=[];return Object.keys(this._extensionCountTable).forEach((t=>{e.push({extension:t,count:this._extensionCountTable[t]})})),e}};let a=t.PrivateLinkState=class{constructor(){this.isPrivateLinked=(0,i.makeWritableComputation)(!1)}};t.PrivateLinkState=a=__decorate([__metadata("fx:diagnostics",[e,"PrivateLinkState"]),s.Class()],a);let l=t.ServiceDependencyState=class{constructor(){this.azureResourceGraphUnavailable=(0,i.makeWritableComputation)(!1)}};t.ServiceDependencyState=l=__decorate([__metadata("fx:diagnostics",[e,"ServiceDependencyState"]),s.Class()],l)})),
define("MsPortalImpl/Services/SubscriptionAndLocationHelpers",["require","exports","MsPortalImpl/Resources/ImplScriptResources"],(function(e,t,s){"use strict";t.compareSubscriptions=function(e,t){const s="disabled",i=(e.state||"").toLowerCase(),o=(t.state||"").toLowerCase();if(i!==o){if(i===s)return 1;if(o===s)return-1}const n=(e.displayName||"").toLowerCase(),r=(t.displayName||"").toLowerCase(),a=(e.subscriptionId||"").toLowerCase(),l=(t.subscriptionId||"").toLowerCase();return MsPortalFx.compare(n,r)||MsPortalFx.compare(a,l)},t.getSubscriptionsWithUniqueDisplayNames=function(e){const t=e.subsMap||{},o={},n=[];let r=0;const a=new Set;if(MsPortalFx.forEachKey(t,((e,{subscription:i,notInFirstPage:l})=>{const c=i.displayName,d=i.state,p=(i.subscriptionPolicies||{}).quotaId,{uniqueDisplayName:u,...m}=i;p&&a.size<10&&a.add(p);let g=d&&"disabled"===d.toLowerCase()?s.disabledSubscriptionLabelFormat.format(c):c;const h=o[c];if(h){if(g=s.subscriptionNameAndIdLabelFormat.format(g,e),!h.updated){const e=n[h.index];e.uniqueDisplayName=s.subscriptionNameAndIdLabelFormat.format(e.uniqueDisplayName,e.subscriptionId),h.updated=!0}}else o[c]={index:r,updated:!1};i={...m,uniqueDisplayName:g},t[e]={subscription:i,notInFirstPage:l},n.push(i),r++})),a.size){const t=[];a.forEach((e=>t.push(e))),i.trace({source:`${e.telemetrySource}.getSubscriptionsWithUniqueDisplayNames`,action:e.isPortalStartup?"quotaIdsOnPortalLoad":"additionalQuotaIdsOnAllSubscriptionsLoad",data:{quotaIds:t.join(",")}})}return n},t.mergeSelectedSubscriptionsWithFirstPage=function(e,t){const s=e.length+t.length,i=new Map,o=new Array(s);let n=Math.min(e.length,s);for(let t=0;t<n;t++){const s=e[t];i.set(s.subscriptionId,s),o[t]=s}const r=Math.min(t.length,s);let a=0;for(;a<r&&n<o.length;){const e=t[a++];i.has(e.subscriptionId)||(i.set(e.subscriptionId,e),o[n++]=e)}return o.length=n,o};var i=MsPortalFx.Base.Diagnostics.Telemetry})),
define("MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers",["require","exports","MsPortalImpl/Notifications/NotificationsClientStrings","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/SubscriptionAndLocationHelpers","MsPortalImpl/UI/UI.AuthStateManager","FxInternal/AsyncLoader","FxInternal/Diagnostics","FxHubs/RpcEndPoints","Fx/Ajax"],(function(e,t,s,i,o,n,r,a,l,c,d,p){"use strict";t.countTypeMap=t.DEV=void 0,t.lazyUserDataMemo=function(e){if(I)return I;return I=_(e),I},t.useAdvancedSubFilters=F;d.Subscriptions.CountTypeEnum;var u=MsPortalFx.Base,m=u.Constants,g=u.Diagnostics,h=g.Telemetry,f=MsPortalFx.Hubs.Notifications.NotificationStatus;const x=s.PrivateLinkNotification;let b=window;const y=g.createLog(e);let v,w=!1;const M=t.countTypeMap={total:1,partial:2,notabletocalculate:4};async function C(e){const t=await MsPortalFx.require("MsPortalImpl/Services/LazyUserData/LazyUserData.Deferred");return await t.getLazyUserData({diContainer:e,useAdvancedFiltersPromise:F(e),fetchFirstPageAndSelectedSubscriptions:!0})}async function S(e){w&&y.error("getLazyUserData should only be called once per session");const[t,s]=await Promise.all([e.get(a.AuthStateManager),e.get(o.SecurityTokensManager)]),n=await s.getToken({extensionName:"fx",resourceName:"",isBackground:!1,skipCache:!1})||{};w=!0;let d=b.fx.environment.applicationPath;d.endsWith("/")||(d+="/");const g=e.get(FxImpl.Features),v=g.isEnabled("selftoken"),S=new u.UriBuilder(d+"api/Portal/GetLazyUserData"),I=h.startTrace({source:"LazyUserDataHelpers",action:"loadLazyUserData"}),P=n.token||{};let _,F="2019-10-01";g.isEnabled("policyforrestypes")&&g.isEnabled("fetchpolicyforrestypes")&&(F="2022-04-01");try{_=(await(0,p.ajaxExtended)({contentType:"application/json",headers:{accept:"application/json","x-ms-feature-flags":JSON.stringify({"feature.inmemorysettings":g.getValue("inmemorysettings"),"feature.globalresourcefilter":g.getValue("globalresourcefilter"),"feature.settingsportalinstance":g.getValue("settingsportalinstance")})},setAuthorizationHeader:!v||{resourceName:"self"},type:"POST",uri:S.toString(),data:JSON.stringify({version:F,armAuthorizationHeader:P.header})})).content}catch(s){if(403===s.jqXHR.status){const e=b.location,s=t.bootstrapState||{},i=s.loginReplyUrlPath||"/signin/index/",o=s?.user?.tenantId||"";return e.href=`${e.origin}${i}${o}?mfalogin=true&reason=AuthenticationCriteraNotSatisfiedInLazy`,null}y.warning(`Call to GetLazyUserData failed and will be retried on the client. Error details: ${MsPortalFx.getLogFriendlyMessage(s)}`);try{_=await C(e)}catch(e){y.warning(new MsPortalFx.Errors.Error({message:`Failed to load client-side lazyUserData. Error details: ${MsPortalFx.getLogFriendlyMessage(e)}`,innerErrors:e}))}}_=_||{};let T=_.firstPageSubscriptions||{},k=_.serviceHealthAlerts;const E=["Failure_PrivateLink","Failure_CaePolicyValidation"].includes(T.resultCode),D=_.argServiceIsUnavailable||"Failure_ArgServiceUnavailable"===T.resultCode;if(D&&(e.get(i.ServiceDependencyState).azureResourceGraphUnavailable(!0),y.error("ServiceErrorFromArg received from LazyUserDataHelpers")),E&&e.get(i.PrivateLinkState).isPrivateLinked(!0),E||D){h.trace({source:"LazyUserDataHelpers",action:E?"ReceivedPrivateLinkCode":"ARGUnavailableFallback",data:{resultCode:T.resultCode}});try{const t=await C(e);T=t.firstPageSubscriptions||{};const s=T.exception;if(E&&s){let t=s.content?.message||s.message;try{if(t?.includes("DebugOnlyDetails:")){const e=JSON.parse(t.substring(t.indexOf("DebugOnlyDetails:")+17));e?.error?.message&&(t=(0,c.sanitizeMessage)(e.error.message))}else t=(0,c.sanitizeMessage)(t||MsPortalFx.getLogFriendlyMessage(s))}catch{}t=t||MsPortalFx.getLogFriendlyMessage(s),e.getAsync(l.get("MsPortalImpl/UI/Hubs/UI.NotificationManager","NotificationHandler")).then((i=>i.showModalNotification({diContainer:e,messageContext:{srcWindowId:m.Shell,destWindowId:m.Shell,callStack:s.stack},messageArg:{primaryButtonText:x.primaryButtonText,secondaryButtonClickAction:2,secondaryButtonText:x.secondaryButtonText,notification:{title:x.title,description:x.description+"<br /><br />"+x.details.format(t),descriptionAsHtml:!0,status:f.Warning,timestamp:new Date}}})))}k=t.serviceHealthAlerts}catch(e){y.warning(new MsPortalFx.Errors.Error({message:`Failed to load client-side lazyUserData. Error details: ${MsPortalFx.getLogFriendlyMessage(e)}`,innerErrors:e}))}}const A=T.valueMapById||{},B=T.count||{},N=(B.type||"").toLowerCase(),R=_.locations||{},L=_.recentResources||Object.create(null),z=L.recentResources||Object.create(null),H=_.policyForResourceTypes||{isIncomplete:!0};k=k||[];const O=(0,r.getSubscriptionsWithUniqueDisplayNames)({subsMap:A,isPortalStartup:!0,telemetrySource:"LazyUserDataHelpers"}),U=O.length;h.completeTrace(I,{firstPageSubscriptions:{armCount:T.count||{},hasErrors:T.hasErrors,nextLink:T.nextLink,resultCode:T.resultCode,subscriptionsReturned:U},locations:{armCount:R.count||{},hasErrors:R.hasErrors,locationsReturned:(R.value||[]).length,nextLink:R.nextLink},recentResources:{recentResourcesCount:Object.keys(L).length,status:L.status||"unknown",verifiedRecentResourcesCount:Object.keys(z).reduce(((e,t)=>("exists"===z[t].existenceState.toLowerCase()&&e++,e)),0)},serviceHealthAlerts:{returnedCount:k.length}}),T.hasErrors&&y.warning("Subscriptions in GetLazyUserData contained errors.");let W=B.value;return"total"!==N&&(W=U),{firstPageSubscriptions:{subscriptions:O,subscriptionsMap:A,countData:{value:W,type:M[N]},nextLink:T.nextLink},locations:R,recentResources:"completedsuccess"===(L.status||"").toLowerCase()?z:void 0,serviceHealthAlerts:k,policyForResourceTypes:H}}let I,P=0;async function _(e){try{return S(e)}catch(t){if(y.warning(new MsPortalFx.Errors.Error({message:`Failed to load lazyUserData. Error details: ${MsPortalFx.getLogFriendlyMessage(t)}`,innerErrors:t})),P<1)return P++,_(e);throw t}}async function F(e){if(v)return v;if(!e.get(FxImpl.Features).isEnabled("globalresourcefilter"))return v=Promise.resolve(!1);const t=await e.getAsync(n.SettingsManager);return v=t.querySetting(19,"optedIn").then((e=>!!e))}})),
define("MsPortalImpl/Base/Base.ArmIdHelpers",["require","exports","Fx/ResourceManagement","FxHubs/ArmHelpers/ArmIds"],(function(e,t,s,i){"use strict";t.isResourceAtAnyLevel=function(e){return i.ResourceArmIdKindMap[e.kind]},t.sanitizeId=function(e){return 0!==s.ArmId.parse(e,!0).kind?MsPortalFx.sanitizeMessage(e):"_REDACTED_"}})),
define("MsPortalImpl/Base/Base.HistoryManager",["require","exports"],(function(e,t){"use strict";t.pushState=function(e){const t=i(e);o(history.pushState,t,e.url)},t.replaceState=function(e){const t=i(e);o(history.replaceState,t,e.url)};const s=MsPortalFx.Base.Diagnostics.createLog(e);function i(e){return{...window?.history?.state??{},...e?.data??{}}}function o(e,t,i){try{e===history.pushState?window.history.pushState(t,"",i):e===history.replaceState&&window.history.replaceState(t,"",i)}catch(e){let t=!0;e instanceof DOMException&&(e.code!==DOMException.SECURITY_ERR&&"SecurityError"!==e.name||(t=!1)),t&&s.error(e,0)}}})),
define("MsPortalImpl/Base/Base.DeepLink",["require","exports","Fx/ResourceManagement","MsPortalImpl/Base/Base.ArmIdHelpers","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/UI/UI.AuthStateManager","FxInternal/Shared/lib/LinkUtils","MsPortalImpl/Base/Base.HistoryManager"],(function(e,t,s,i,o,n,r,a){"use strict";t.dashboardRouteName=void 0,t.getAllServicesDeeplink=function(e){return"#allservices/category/All"+(e?"/filter/"+e:"")+u()},t.getAssetDeepLink=function(e,t,i={}){let n=t.assetId;const r=n&&"string"==typeof n&&s.ArmId.parse(n,!0);r&&0!==r.kind&&(n=n.substring(1));return new o.Uri(i.baseUri||"").setHash("#{0}{1}/{2}/{3}/{4}".format(x(e),"asset",t.extensionName,t.assetType,n)).setHashQueryString(u()).toString()},t.getBladeDeepLink=function(e,t,s={},i={}){const o=s?Object.fromEntries(Object.entries(s).map((([e,t])=>[e,ko.unwrap(t)]))):s,n={extensionName:e,hashQuery:u(),setDeepLinkContext:i.setDeepLinkContext,portalUri:i.baseUri,v2DeepLink:i.v2DeepLink,viewName:t,viewParameters:o,selectedMenuItemId:i.selectedMenuItemId};return(0,r.getViewDeepLink)(n)},t.getCurrentUri=p,t.getDashboardDeepLink=f,t.getDashboardIdFromUri=function(e=p()){return b(e)?e.getHashParts().rest:""},t.getDashboardTypeFromUri=function(){const e=p();return b(e)?e.getHashParts().rest.split("/")[0]:""},t.getDefaultDashboardDeeplink=function(){return"#dashboard"+u()},t.getGalleryDeepLink=function(e,t={}){let s="#{0}/{1}";const i=t.model;i&&(ko.unwrap(i.additionalConfig)||{}).preview&&(s+="/preview");return new o.Uri(t.baseUri||"").setHash(s.format("create",e)).setHashQueryString(u()).toString()},t.getHomeDeeplink=function(){return"#home"+u()},t.getMenuIdFromDeepLink=function(e){const t=new o.Uri(e),s=t.getHashParts();switch(s.category){case"blade":case"view":{const e=t.hash.split("/");return g(e)?"view"===s.category?e[4]:e[3]:""}case"resource":{const e=s.rest.split("/");return h(e)?e[e.length-1]:""}}return""},t.getServiceMenuDeepLink=void 0,t.isDashboardRoute=b,t.originalHref=t.isServiceMenuBlade=void 0,t.parseBladeInputs=function(e,t,s){s=s||{};const i={};try{for(let t=0;t<e.length;){let o=c(e[t++]);if(!o)throw new Error("invalid decodeKey:"+o);let n=c(e[t++]);s.v2DeepLink?o.slice(-1)===r.DeepLinkV2TypeMarker.JSON&&(n=m(n,((e,t)=>{"string"!=typeof t||"htmlTemplate"!==e&&"__html"!==e||(t="");return t})),o=o.slice(0,-1)):s.parseJSON&&n&&/^\s*\{.*\}\s*$/.test(n)&&(n=m(n,((e,t)=>{"string"!=typeof t||"htmlTemplate"!==e&&"__html"!==e||(t="");return t}))),i[o]=n}}catch(e){throw new MsPortalFx.Errors.Error({message:`Deep link ${t} has illegal inputs`,innerErrors:e})}return i},t.prependTenantToResourceDeepLink=function(e,t){if(t&&t.startsWith("#resource/"))return`#${x(e)}${t.substring(1)}`;return t},t.replaceMenuIdFromDeepLink=function(e,t){const s=new o.Uri(e),i=s.getHashParts(),n=s.hash.split("/");switch(i.category){case"blade":case"view":if(g(n))return"view"===i.category?n[4]=t:n[3]=t,s.setHash(n.join("/")),s.toString();break;case"resource":if(h(i.rest.split("/")))return n[n.length-1]=t,s.setHash(n.join("/")),s.toString();break}return e||""},t.rpcGetDashboardDeepLink=function(e,t){let o=t=MsPortalFx.trimStart(t,"/");if(!t.startsWith("dashboard/arm")&&!t.startsWith("dashboard/private")){const e=s.ArmId.parse(MsPortalFx.ensurePrefix(t,"/"),!0);o=(0,i.isResourceAtAnyLevel)(e)?MsPortalFx.ensurePrefix(t,"dashboard/arm/"):MsPortalFx.ensurePrefix(t,"dashboard/private/")}const n=window.location,r=p(),a=x(e),l=n.port;return[n.protocol,"//",r.host,l?":"+l:"",n.pathname,r.queryString,"#",a,o,u()].join("")},t.safeJSONParse=m,t.updateDashboardUri=function(e,t,s,i){const o=f(e,t);if((i=i||p()).hash.toLowerCase()!==`#${o}`){i.setHash(o);(s?a.replaceState:a.pushState)({data:{},url:i.href})}};const l=window,c=decodeURIComponent,d=t.dashboardRouteName="dashboard";t.originalHref=l.location.href;function p(){return new o.Uri(location.href)}function u(){return p().hashQueryString}function m(e,t){try{return JSON.parse(e,t)}catch(t){return e}}function g(e){const t=e.length>=4&&e.length%2==0&&"#blade"===e[0]&&!MsPortalFx.isNullOrWhiteSpace(e[3]),s=e.length>=5&&"#view"===e[0]&&e[3]===r.DeepLinkV2TypeMarker.MenuBlade&&!MsPortalFx.isNullOrWhiteSpace(e[4]);return t||s}function h(e){return e.length%2==1&&!MsPortalFx.isNullOrWhiteSpace(e[e.length-1])}t.isServiceMenuBlade=(e,t)=>[{serviceMenuBlade:"ServiceMenuBlade",extensionName:"HubsExtension"}].some((s=>s.extensionName.toLowerCase()===e.toLowerCase()&&s.serviceMenuBlade.toLowerCase()===t.toLowerCase()));function f(e,t){return`${x(e)}dashboard/${t}`.toLowerCase()+u()}function x(e){const t=e.get(n.AuthStateManager).getSignedInUserTenant();return t?"@"+t+"/":""}function b(e){return!MsPortalFx.localeCompareIgnoreCase(e.getHashParts().category,d)}t.getServiceMenuDeepLink=e=>{const{serviceMenuBladeInputs:t}=e,s=Object.fromEntries(Object.entries(t).map((([e,t])=>[e,ko.unwrap(t)]))),i=s.menuId||"",o=s.extension||"",n=e.selectedItemId||"";return`#servicemenu/${encodeURIComponent(o)}/${encodeURIComponent(i)}${n.length>0?"/"+encodeURIComponent(n):""}`}})),
define("MsPortalImpl/Resources/PortalNotificationsTelemetry",["require","exports"],(function(e,t){"use strict";var s;t.Source=t.DEV=t.ActionModifierInternal=t.ActionModifier=t.ActionInternal=t.Action=void 0,function(e){e.HatsHelper="HatsHelper",e.HaTSurvey="HaTSurvey",e.NotificationHub="NotificationHub",e.PortalNotifications="PortalNotifications",e.ToastTray="ToastTray",e.UIActionableNotifications="UI.ActionableNotifications",e.UpdateContactabilityDialog="UpdateContactabilityDialog"}(s||(s={}));t.Source=s;var i;!function(e){e.AdvisorNotificationShown="AdvisorNotificationShown",e.ConvertedLinksInNotificationDescription="ConvertedLinksInNotificationDescription",e.CopilotButtonClicked="CopilotButtonClicked",e.CopilotButtonAdded="CopilotButtonAdded",e.CopilotToastClicked_ManageAccess="CopilotToastClicked_ManageAccess",e.CopilotToastDismissed="CopilotToastDismissed",e.CopilotToastLaunched="CopilotToastLaunched",e.CopilotToastLoaded="CopilotToastLoaded",e.CopilotToastNotLaunched="CopilotToastNotLaunched",e.CopilotToastShown="CopilotToastShown",e.CustomOverrideFailed="CustomOverrideFailed",e.DeprecatedNotificationApiCalled="DeprecatedNotificationApiCalled",e.DevSATDismissed="DevSATDismissed",e.DevSATLaunched="DevSATLaunched",e.DevSATNotShown="DevSATNotShown",e.DevSATShown="DevSATShown",e.ExtensionDisposed="ExtensionDisposed",e.ExtensionExtended="ExtensionExtended",e.FeedbackClicked="FeedbackClicked",e.FetchHatsExtensionTasks="FetchHatsExtensionTasks",e.FrameworkSurveys_SATCloseClicked="FrameworkSurveys_SATCloseClicked",e.FrameworkSurveys_SATDismissed="FrameworkSurveys_SATDismissed",e.FrameworkSurveys_SATScoreClicked="FrameworkSurveys_SATScoreClicked",e.FrameworkSurveys_SATSubmitFailed="FrameworkSurveys_SATSubmitFailed",e.FrameworkSurveys_SATSubmitted="FrameworkSurveys_SATSubmitted",e.FrameworkSurveys_SATSurveyOptOut="FrameworkSurveys_SATSurveyOptOut",e.FrameworkSurveys_LaunchingHatsFromSATToast="FrameworkSurveys_LaunchingHatsFromSATToast",e.HatsFailedToSetLastTimeShownSetting="HatsFailedToSetLastTimeShownSetting",e.FrameworkSurveys_SATLoaded="FrameworkSurveys_SATLoaded",e.FrameworkSurveys_SATNeverLoaded="FrameworkSurveys_SATNeverLoaded",e.HatsPaneDismissed="HatsPaneDismissed",e.HatsPaneOpened="HatsPaneOpened",e.LaunchingHatsFromNPS="LaunchingHatsFromNPS",e.InProgressNotification="InProgressNotification",e.IrisNotification="IrisNotification",e.IrisAdvisor="IrisAdvisor",e.IrisBillingDownload="IrisBillingDownload",e.ModalDialogDismissed="ModalDialogDismissed",e.ModalDialogOpened="ModalDialogOpened",e.NotificationApiCalled="NotificationApiCalled",e.NotificationClicked="NotificationClicked",e.NotificationDismissAllClicked="NotificationDismissAllClicked",e.NotificationDismissedFromPane="NotificationDismissedFromPane",e.NotificationMenuClosed="NotificationMenuClosed",e.NotificationMenuOpen="NotificationMenuOpen",e.NotificationMoreEventsLinkClicked="NotificationMoreEventsLinkClicked",e.NPSAdminPolicies="NPSAdminPolicies",e.NPSCloseClicked="NPSCloseClicked",e.NPSDismissed="NPSDismissed",e.NPSScoreClicked="NPSScoreClicked",e.NPSShown="NPSShown",e.NPSNeverShown="NPSNeverShown",e.NPSSubmitFailed="NPSSubmitFailed",e.NPSSubmitted="NPSSubmitted",e.NPSSurveyOptOut="NPSSurveyOptOut",e.NPSUserOptedOut="NPSUserOptedOut",e.PollingNotification="PollingNotification",e.PrivacyPolicyClick="PrivacyPolicyClick",e.RecommendationAdded="RecommendationAdded",e.RecommendationClicked="RecommendationClicked",e.RecommendationSurfaced="RecommendationSurfaced",e.SatisfactionAreaClicked="SatisfactionAreaClicked",e.SatisfactionOverallClicked="SatisfactionOverallClicked",e.ServerEventMappedToNotification="ServerEventMappedToNotification",e.ServiceHealthAlertNotification="ServiceHealthAlertNotification",e.ToastAdded="ToastAdded",e.ToastClicked="ToastClicked",e.ToastDismissed="ToastDismissed",e.UpdateContactabilityCountryInfo="UpdateContactabilityCountryInfo",e.UpdateContactabilityCheckboxChanged="UpdateContactabilityCheckboxChanged",e.UpdateContactabilityUpdateEmailClick="UpdateContactabilityUpdateEmailClick"}(i||(t.ActionInternal=i={}));t.Action=i;var o;!function(e){e.ActionsBeaconCall="ActionsBeaconCall",e.ActionsBeaconCallFailed="ActionsBeaconCallFailed",e.ActionsBeaconCallSuccess="ActionsBeaconCallSuccess",e.AdvisorNotificationReceived="AdvisorNotificationReceived",e.BillingDownloadNotificationReceived="BillingDownloadNotificationReceived",e.Cancelled="Cancelled",e.Completed="Completed",e.ContactabilityNotificationReceived="ContactabilityNotificationReceived",e.ControlNotificationReceived="ControlNotificationReceived",e.ExtensionHasNoSurveyTasks="ExtensionHasNoSurveyTasks",e.ExtensionMissingTasks="ExtensionMissingTasks",e.FailedToFetchNotificationsFromStorage="FailedToFetchNotificationsFromStorage",e.FailedToTransferStoredNotification="FailedToTransferStoredNotification",e.FailedToWriteNotificationsToStorage="FailedToWriteNotificationsToStorage",e.FeedbackDislike="FeedbackDislike",e.FeedbackLike="FeedbackLike",e.FrameworkSurveys_SATNotLoaded="FrameworkSurveys_SATNotLoaded",e.FrameworkSurveys_SATScoreInvalid="FrameworkSurveys_SATScoreInvalid",e.FrameworkSurveys_SATScoreValid="FrameworkSurveys_SATScoreValid",e.HatsPaneFailed="HatsPaneFailed",e.HatsPaneLaunched="HatsPaneLaunched",e.ImpressionsBeaconCall="ImpressionsBeaconCall",e.ImpressionsBeaconCallFailed="ImpressionsBeaconCallFailed",e.ImpressionsBeaconCallSuccess="ImpressionsBeaconCallSuccess",e.IncorrectlyStoredPollingNotificationData="IncorrectlyStoredPollingNotificationData",e.InProgressFinished="InProgressFinished",e.InProgressStarted="InProgressStarted",e.InvalidBillingDownloadContent="InvalidBillingDownloadContent",e.InvalidIrisTelemetryUri="InvalidIrisTelemetryUri",e.Mark="Mark",e.NoExtensionTaskMatches="NoExtensionTaskMatches",e.NotificationNotShown_BillingAccountInvoiceList="NotificationNotShown_BillingAccountInvoiceList",e.NotificationNotShown_BillingDownloadFailed="NotificationNotShown_BillingDownloadFailed",e.NotificationNotShown_InvalidContent="NotificationNotShown_InvalidContent",e.NotificationNotShown_InvalidGetPollUriStatus="NotificationNotShown_InvalidGetPollUriStatus",e.NotificationNotShown_InValidNotificationType="NotificationNotShown_InValidNotificationType",e.NotificationNotShown_LoadBillingDownloadHelperFailed="NotificationNotShown_LoadBillingDownloadHelperFailed",e.NotificationNotShown_NoNotificationsOrCultureMismatch="NotificationNotShown_NoNotificationsOrCultureMismatch",e.NotificationNotShown_NoTitleOrDescription="NotificationNotShown_NoTitleOrDescription",e.NotificationNotShown_NoValidInvoicesInList="NotificationNotShown_NoValidInvoicesInList",e.NotificationNotShown_PollingForBillingDownloadUriFailed="NotificationNotShown_PollingForBillingDownloadUriFailed",e.NotificationNotShown_SubscriptionInvoiceList="NotificationNotShown_SubscriptionInvoiceList",e.NotificationDismissed="NotificationDismissed",e.NotificationShown="NotificationShown",e.NPSNotShown="NPSNotShown",e.NPSScoreInvalid="NPSScoreInvalid",e.NPSScoreValid="NPSScoreValid",e.PoliciesFetched="PoliciesFetched",e.PoliciesFetchFailed="PoliciesFetchFailed",e.PollingError="PollingError",e.PollingFailed="PollingFailed",e.PollingNotificationNotFound="PollingNotificationNotFound",e.PollingRegistered="PollingRegistered",e.PollingTimedOut="PollingTimedOut",e.PublishIrisNotification="PublishIrisNotification",e.SATScoreValid="SATScoreValid",e.SmallModalsHidden="SmallModalsHidden",e.UpdateEmailFailed="UpdateEmailFailed",e.UpdateEmailSucceeded="UpdateEmailSucceeded"}(o||(t.ActionModifierInternal=o={}));t.ActionModifier=o})),
define("MsPortalImpl/UI/Commands/Base.PortalFunctions",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";t.UpdateDashboardPortalFunc=t.UnshareDashboardToSessionPortalFunc=t.ToggleCloudShell=t.SwitchDashboardPortalFunc=t.StartNewDashboardPortalFunc=t.ShowWelcomeSequence=t.ShowTelemetryInsights=t.ShowPersonalizedSurvey=t.ShowDebugTools=t.ShareDashboardToSessionPortalFunc=t.ShareCurrentDashboardPortalFunc=t.RoutePortalFunc=t.ResetDashboardPortalFunc=t.ReplacePartPortalFunc=t.ReloadPartPortalFunc=t.RefreshDashboardPortalFunc=t.ReadDashboardPortalFunc=t.PortalFunction=t.PinTilesPortalFunc=t.PinTileWithOptionsPortalFunc=t.PinTilePortalFunc=t.PinBladePortalFunc=t.IsCurrentDashboarSharedPortalFunc=t.ImportDashboardPortalFunc=t.GetUserPermissionsForDashboardPortalFunc=t.GetCurrentDashboardPropertiesPortalFunc=t.ExportDashboardPortalFunc=t.DownloadDiagnosticsJson=t.DeleteDashboardWithConfimationPortalFunc=t.CreateJourneyForBladeFunc=t.CreateJourneyForAssetFunc=t.ClonePartPortalFunc=t.CloneDashboardPortalFunc=t.AssignTagsToDashboardPortalFunc=void 0;class i{constructor(){this._eventHandlers=[]}setRegistration(e){this._handler=e}addPreInvocationEvent(e){this._eventHandlers.push(e)}invoke(e,t){if(!this._handler)throw new Error("Must register portal function before calling it.");return this._eventHandlers.forEach((e=>e(t))),this._handler(e,t)}}t.PortalFunction=i;let o=t.RefreshDashboardPortalFunc=class extends i{};t.RefreshDashboardPortalFunc=o=__decorate([__metadata("fx:diagnostics",[e,"RefreshDashboardPortalFunc"]),s.Class()],o);let n=t.StartNewDashboardPortalFunc=class extends i{};t.StartNewDashboardPortalFunc=n=__decorate([__metadata("fx:diagnostics",[e,"StartNewDashboardPortalFunc"]),s.Class()],n);let r=t.ExportDashboardPortalFunc=class extends i{};t.ExportDashboardPortalFunc=r=__decorate([__metadata("fx:diagnostics",[e,"ExportDashboardPortalFunc"]),s.Class()],r);let a=t.ImportDashboardPortalFunc=class extends i{};t.ImportDashboardPortalFunc=a=__decorate([__metadata("fx:diagnostics",[e,"ImportDashboardPortalFunc"]),s.Class()],a);let l=t.ReadDashboardPortalFunc=class extends i{};t.ReadDashboardPortalFunc=l=__decorate([__metadata("fx:diagnostics",[e,"ReadDashboardPortalFunc"]),s.Class()],l);let c=t.SwitchDashboardPortalFunc=class extends i{};t.SwitchDashboardPortalFunc=c=__decorate([__metadata("fx:diagnostics",[e,"SwitchDashboardPortalFunc"]),s.Class()],c);let d=t.ResetDashboardPortalFunc=class extends i{};t.ResetDashboardPortalFunc=d=__decorate([__metadata("fx:diagnostics",[e,"ResetDashboardPortalFunc"]),s.Class()],d);let p=t.CloneDashboardPortalFunc=class extends i{};t.CloneDashboardPortalFunc=p=__decorate([__metadata("fx:diagnostics",[e,"CloneDashboardPortalFunc"]),s.Class()],p);let u=t.UpdateDashboardPortalFunc=class extends i{};t.UpdateDashboardPortalFunc=u=__decorate([__metadata("fx:diagnostics",[e,"UpdateDashboardPortalFunc"]),s.Class()],u);let m=t.ClonePartPortalFunc=class extends i{};t.ClonePartPortalFunc=m=__decorate([__metadata("fx:diagnostics",[e,"ClonePartPortalFunc"]),s.Class()],m);let g=t.AssignTagsToDashboardPortalFunc=class extends i{};t.AssignTagsToDashboardPortalFunc=g=__decorate([__metadata("fx:diagnostics",[e,"AssignTagsToDashboardPortalFunc"]),s.Class()],g);let h=t.ShareCurrentDashboardPortalFunc=class extends i{};t.ShareCurrentDashboardPortalFunc=h=__decorate([__metadata("fx:diagnostics",[e,"ShareCurrentDashboardPortalFunc"]),s.Class()],h);let f=t.ShareDashboardToSessionPortalFunc=class extends i{};t.ShareDashboardToSessionPortalFunc=f=__decorate([__metadata("fx:diagnostics",[e,"ShareDashboardToSessionPortalFunc"]),s.Class()],f);let x=t.UnshareDashboardToSessionPortalFunc=class extends i{};t.UnshareDashboardToSessionPortalFunc=x=__decorate([__metadata("fx:diagnostics",[e,"UnshareDashboardToSessionPortalFunc"]),s.Class()],x);let b=t.GetUserPermissionsForDashboardPortalFunc=class extends i{};t.GetUserPermissionsForDashboardPortalFunc=b=__decorate([__metadata("fx:diagnostics",[e,"GetUserPermissionsForDashboardPortalFunc"]),s.Class()],b);let y=t.IsCurrentDashboarSharedPortalFunc=class extends i{};t.IsCurrentDashboarSharedPortalFunc=y=__decorate([__metadata("fx:diagnostics",[e,"IsCurrentDashboarSharedPortalFunc"]),s.Class()],y);let v=t.GetCurrentDashboardPropertiesPortalFunc=class extends i{};t.GetCurrentDashboardPropertiesPortalFunc=v=__decorate([__metadata("fx:diagnostics",[e,"GetCurrentDashboardPropertiesPortalFunc"]),s.Class()],v);let w=t.RoutePortalFunc=class extends i{};t.RoutePortalFunc=w=__decorate([__metadata("fx:diagnostics",[e,"RoutePortalFunc"]),s.Class()],w);let M=t.PinTilesPortalFunc=class extends i{};t.PinTilesPortalFunc=M=__decorate([__metadata("fx:diagnostics",[e,"PinTilesPortalFunc"]),s.Class()],M);let C=t.PinTileWithOptionsPortalFunc=class extends i{};t.PinTileWithOptionsPortalFunc=C=__decorate([__metadata("fx:diagnostics",[e,"PinTileWithOptionsPortalFunc"]),s.Class()],C);let S=t.PinTilePortalFunc=class extends i{};t.PinTilePortalFunc=S=__decorate([__metadata("fx:diagnostics",[e,"PinTilePortalFunc"]),s.Class()],S);let I=t.PinBladePortalFunc=class extends i{};t.PinBladePortalFunc=I=__decorate([__metadata("fx:diagnostics",[e,"PinBladePortalFunc"]),s.Class()],I);let P=t.DeleteDashboardWithConfimationPortalFunc=class extends i{};t.DeleteDashboardWithConfimationPortalFunc=P=__decorate([__metadata("fx:diagnostics",[e,"DeleteDashboardWithConfimationPortalFunc"]),s.Class()],P);let _=t.ReplacePartPortalFunc=class extends i{};t.ReplacePartPortalFunc=_=__decorate([__metadata("fx:diagnostics",[e,"ReplacePartPortalFunc"]),s.Class()],_);let F=t.ReloadPartPortalFunc=class extends i{};t.ReloadPartPortalFunc=F=__decorate([__metadata("fx:diagnostics",[e,"ReloadPartPortalFunc"]),s.Class()],F);let T=t.CreateJourneyForBladeFunc=class extends i{};t.CreateJourneyForBladeFunc=T=__decorate([__metadata("fx:diagnostics",[e,"CreateJourneyForBladeFunc"]),s.Class()],T);let k=t.CreateJourneyForAssetFunc=class extends i{};t.CreateJourneyForAssetFunc=k=__decorate([__metadata("fx:diagnostics",[e,"CreateJourneyForAssetFunc"]),s.Class()],k);let E=t.ToggleCloudShell=class extends i{};t.ToggleCloudShell=E=__decorate([__metadata("fx:diagnostics",[e,"ToggleCloudShell"]),s.Class()],E);let D=t.DownloadDiagnosticsJson=class extends i{};t.DownloadDiagnosticsJson=D=__decorate([__metadata("fx:diagnostics",[e,"DownloadDiagnosticsJson"]),s.Class()],D);let A=t.ShowDebugTools=class extends i{};t.ShowDebugTools=A=__decorate([__metadata("fx:diagnostics",[e,"ShowDebugTools"]),s.Class()],A);let B=t.ShowTelemetryInsights=class extends i{};t.ShowTelemetryInsights=B=__decorate([__metadata("fx:diagnostics",[e,"ShowTelemetryInsights"]),s.Class()],B);let N=t.ShowWelcomeSequence=class extends i{};t.ShowWelcomeSequence=N=__decorate([__metadata("fx:diagnostics",[e,"ShowWelcomeSequence"]),s.Class()],N);let R=t.ShowPersonalizedSurvey=class extends i{};t.ShowPersonalizedSurvey=R=__decorate([__metadata("fx:diagnostics",[e,"ShowPersonalizedSurvey"]),s.Class()],R)})),
define("MsPortalImpl/Services/Services.Storage",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";t.StorageService=t.ComponentName=void 0;const i=MsPortalFx.Base.Diagnostics.createLog(e),o=JSON.stringify;var n;!function(e){e[e.DesktopManager=2]="DesktopManager",e[e.AssetMruList=3]="AssetMruList",e[e.ExtensionManager=4]="ExtensionManager",e[e.Router=5]="Router",e[e.UserSettings_Journeys=6]="UserSettings_Journeys",e[e.UserSettings_EditScopes=7]="UserSettings_EditScopes",e[e.Relex=8]="Relex",e[e.ManifestVersions=9]="ManifestVersions",e[e.Redirect=10]="Redirect",e[e.Cdn=11]="Cdn",e[e.UserSettings_NewJourneys=12]="UserSettings_NewJourneys",e[e.Telemetry=13]="Telemetry",e[e.Dashboard=14]="Dashboard",e[e.Avatar=15]="Avatar",e[e.UserSettingsService=16]="UserSettingsService",e[e.AppBanner=19]="AppBanner",e[e.IEBanner=20]="IEBanner",e[e.Menu=21]="Menu",e[e.GlobalInfoBanner=22]="GlobalInfoBanner"}(n||(t.ComponentName=n={}));const r=MsPortalFx.getEnumArray(n),a={};r.forEach((e=>{a[e.name]={count:0,keySize:0,valueSize:0}}));class l{constructor(e,t){function s(e){return n[e]+"_"}function l(e,t){return s(e)+(t||"")}function c(s){return 1===s?e:t}function d(e,t,s){for(let i=0;i<e.length;i++){const o=e.key(i);t.call(s,e.getItem(o),o,e)}}function p(e){const t=(r.forEach((e=>{const t=a[e.name];t.count=t.keySize=t.valueSize=0})),a);let s,i=0,n="";d(e,((e,s)=>{const a=MsPortalFx.find(r,(e=>s.startsWith(e.name)));if(a){const r=t[a.name];r.count++,r.keySize+=s.length;const l=o(e).length;r.valueSize+=l,l>i&&(i=l,n=s)}}));try{s=o(t)}catch(e){s=`Could not stringify the summary. Exception: ${MsPortalFx.getLogFriendlyMessage(e)}`}return"Summary: {0}. The longest value (key == {1}) took {2} bytes. The total storage length is {3}.".format(s,n,i,e.length)}this.getValue=(e,t,s)=>c(s).getItem(l(e,t)),this.getAllComponentItems=(e,t)=>{const i=s(e),o=c(t),n={},r=i.length;return d(o,((e,t)=>{if(t.startsWith(i)){const s=t.substring(r,t.length);n[s]=e}})),n},this.setValue=(e,t,s,o)=>{const n=c(o),r=l(e,t);try{n.setItem(r,s)}catch(e){const s=new Error("Storage.setItem failed.");s.innerError=e,s.storageState=p(n),s.key=r||t,i.error(s)}},this.clearValue=(e,t,s)=>{const i=c(s),o=l(e,t),n=i.getItem(o);return i.removeItem(o),n},this.clearAllComponentItems=(e,t)=>{const i=s(e),o=c(t),n=[];d(o,((e,t)=>{t.startsWith(i)&&n.push(t)})),n.forEach((e=>o.removeItem(e)))},this.clearAll=()=>{t.clear(),e.clear()}}static create(){return new l(MsPortalImpl.sessionStorage,MsPortalImpl.localStorage)}}t.StorageService=l,__decorate([__metadata("fx:diagnostics",[e,"StorageService"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",l)],l,"create",null)})),
define("MsPortalImpl/Base/Languages",["require","exports","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Services/Services.GeneralSettings"],(function(e,t,s,i){"use strict";t.createLocaleContext=c,t.getCultureSpecificLanguage=function(){const e=MsPortalFx.find(d.selectableDisplayLanguages,(e=>!MsPortalFx.localeCompareIgnoreCase(e.locale,d.selectedDisplayLanguage)));return e&&(e.specificCulture||e.locale)||"en-us"},t.getCurrentLocaleContext=function(){return d},t.getLocalizedName=function(e){const t=FxImpl.knownCulturesMap[e];return t?t.localizedName:null},t.initialize=function(e,t,n,l){const u={requireRedirect:!1,userSettingLocale:void 0,browserLocale:void 0,desiredLocale:void 0,localeFromQuery:void 0},m=t.get(s.StorageService),g=t.get(i.GeneralSettings).rawLocale;return g.subscribeAndRun(e,(e=>{const t=MsPortalImpl.getBrowserLanguage(),s=p(e||t),i=JSON.parse(m.getValue(a,r,0)||"{}");i.l=s,m.setValue(a,"LastUsedLocale",s,0),l||s===p(n)||(u.requireRedirect=!0,u.userSettingLocale=e,u.browserLocale=t,u.desiredLocale=s,u.localeFromQuery=p(n)),m.setValue(a,r,JSON.stringify(i),0)})),d=c({selectableLanguages:o.fx.environment.supportedLanguages.filter((e=>"qps-ploc"!==e)),displayLanguage:FxImpl.Intl.displayLanguage,formatCulture:FxImpl.Intl.formatCulture,rawLocaleSetting:g()}),u},t.redirectQueryKey=t.localeDelimiter=void 0,t.setCurrentLocaleContext=function(e){d=e};const o=window,n=MsPortalFx.forEachKey,r=t.redirectQueryKey="LocaleQuery",a=(t.localeDelimiter=".",s.ComponentName.Redirect);function l(e){const t=MsPortalFx.convertArrayToMap(e,(e=>e.locale.split("-")[0]));return n(FxImpl.knownCulturesMap,((e,s,i)=>{const o=e.split("-");o.length>1&&!s.neutralCulture&&t[o[0]]&&i.push(s)}),[])}function c(e){const t=e.displayLanguage,s=(i=e.selectableLanguages,o=FxImpl.knownCulturesMap,i.map((e=>o[e])).filter(MsPortalFx.identity));var i,o,n,r;return{selectableDisplayLanguages:s,selectedDisplayLanguage:t,selectedFormatCulture:(n=e.rawLocaleSetting,r=e.formatCulture,n?n.split(".")[1]:r),selectableFormatCultures:l(s)}}let d;function p(e){const t=MsPortalImpl.sanitizeLanguage(e,o.fx.environment.supportedLanguages).split("."),s=t[0];return`${s}.${FxImpl.sanitizeFormatCulture(t[1],s)}`}})),
define("MsPortalImpl/Notifications/IrisNotificationsTelemetry",["require","exports","Fx/Ajax","FxHubs/RpcEndPoints","Fx/DependencyInjection","MsPortalImpl/Resources/PortalNotificationsTelemetry","FxInternal/AsyncLoader"],(function(e,t,s,i,o,n,r){"use strict";t.irisTelemetryHandler=t.IrisNotificationsTelemetry=t.DEV=void 0,t.replaceActionWithAction=d,t.scrapeIrisValue=p;var a=MsPortalFx.Base.Diagnostics,l=a.Telemetry;const c=a.createLog(e);function d(e,t){return t.includes("{ACTION}")?t.replace("{ACTION}",encodeURIComponent(e)):(m(n.Action.IrisNotification,n.ActionModifier.InvalidIrisTelemetryUri,{originalAction:e,originalUri:((t||"").split("?")[0]||"")+""+(t.includes("?")?"?_QUERY_PARAMS_REDACTED_":"")}),"")}function p(e,t){const s=((e||"").split("?")[1]||"").split("&").filter((e=>!!e));for(let e=0;e<s.length;e++){const i=s[e].split("=");if((i[0]||"").toLowerCase()===t)return i[1]||""}return""}let u=t.IrisNotificationsTelemetry=class{constructor(){this._irisMessageLimit=Number(MsPortalFx.getFeatureValue("irismessagelimit")||1)}_logIrisNotificationTelemetry(e){const t=(e=e||{}).action,i=e.irisNotificationDetails;if(t&&i){const e=i.actionBeaconUri,o=i.impressionsUri,r=t===n.ActionModifier.NotificationShown||t===n.ActionModifier.ControlNotificationReceived?n.ActionModifier.ImpressionsBeaconCall:n.ActionModifier.ActionsBeaconCall,a=r===n.ActionModifier.ImpressionsBeaconCall?o:d(t,e||"");let l;try{l=new URL(a).host}catch(e){return c.error(`Invalid telemetryUri. (telemetryUri=${a})`),Promise.reject(`Invalid telemetryUri. ${MsPortalFx.getLogFriendlyMessage(e)}`)}const u={actionASID:p(e,"asid"),actionPID:p(e,"pid"),impressionASID:p(o,"asid"),impressionPID:p(o,"pid"),messageLimit:this._irisMessageLimit,originalModifier:t,notificationId:i?.notificationId,beaconHost:l};return m(n.Action.IrisNotification,t,u),(0,s.ajax)({type:"POST",uri:MsPortalFx.Base.Resources.getAppRelativeUri("/api/iris/beacon"),isBackgroundTask:!0,setAuthorizationHeader:!0,headers:{Accept:"application/json","x-ms-correlation-id":MsPortalFx.newGuid(),"Content-Type":"application/json","x-ms-tracking-id":MsPortalFx.newGuid()},data:JSON.stringify({beaconUri:a})}).then((()=>{const e=r+"Success";m(n.Action.IrisNotification,e,u)})).catch((e=>{const t=r+"Failed";u.error=JSON.stringify(e?.jqXHR),m(n.Action.IrisNotification,t,u)}))}}logIrisNotificationTelemetry(e){return this._logIrisNotificationTelemetry(e)}};t.IrisNotificationsTelemetry=u=__decorate([__metadata("fx:diagnostics",[e,"IrisNotificationsTelemetry"]),(0,o.Class)("")],u);t.irisTelemetryHandler=(0,r.defineHandler)(i.Impl.irisTelemetryEndpoint,(e=>{e.diContainer.get(u).logIrisNotificationTelemetry(e.messageArg)}));function m(e,t,s){l.trace({source:n.Source.PortalNotifications,action:e,actionModifier:t,data:s||{}})}})),
define("MsPortalImpl/Services/Services.Copilot",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoaderCore","MsPortalImpl/UI/UI.AuthStateManager","Fx/Experimentation","FxInternal/RpcEndPointsCore","FxInternal/AsyncLoader","Fx/Telemetry"],(function(e,t,s,i,o,n,r,a,l){"use strict";t.getCopilotConfigurationHandler=t.CopilotShellAPIs=t.CopilotService=t.CopilotReactViewChannelFactory=void 0,t.isCopilotEnabled=d,t.isCopilotEnabledHandler=void 0;const c=50;function d(e){const t=e.get(o.AuthStateManager).getCurrentUser(),s=e.get(n.Experimentation).shellAssignments,i=MsPortalFx.isFeatureEnabled("unifiedcopilot");let r=s.getBooleanValue("unifiedcopilot");const a=s.getBooleanValue("copilotmanageability");let l=1;for(;!r&&l<=c;){const e="unifiedcopilot"+l;r=s.getBooleanValue(e),l+=1}const d=!!(i||r||a),p=!t.objectId;return d&&!p}t.isCopilotEnabledHandler=(0,a.defineHandler)(r.isCopilotEnabledEndpoint,(({diContainer:e})=>d(e))),t.getCopilotConfigurationHandler=(0,a.defineHandler)(r.getCopilotConfigurationEndpoint,(({diContainer:e})=>({...e.get(p).getConfig()})));let p=t.CopilotService=class{constructor(e,t){this._diContainer=e;const s=t.shellAssignments.getBooleanValue("useCopilotDomainConfig");this._config=s?MsPortalFx.getEnvironmentValue("copilot"):u;const i=d(this._diContainer);(0,l.trace)({source:"CopilotConfiguration",action:"getCopilotConfiguration",data:{useConfig:s,copilotEnabled:i,config:this._config}}),this._config?.extension&&(this._config.enabled=this._config.enabled||i)}getConfig(){return this._config}nudge(e){return this._diContainer.getAsync(m).then((t=>t.nudge(e)))}};t.CopilotService=p=__decorate([__metadata("fx:diagnostics",[e,"CopilotService"]),s.Class(),__metadata("design:paramtypes",[s.Container,n.Experimentation])],p);const u={enabled:!1,extension:"Microsoft_Azure_Copilot",chatView:"copilotfluentai.reactview",packagesPrefix:"@microsoft/azureportal-copilot(?:-ko|-internal)?",initModuleId:"@microsoft/azureportal-copilot/internal/CopilotInternal"};class m{static create(e,t){const{enabled:s,extension:o}=t.getConfig();if(s){if("Microsoft_Azure_Copilot"===o)return e.getAsync(i.get("MsPortalImpl/Services/Services.AzureCopilotShellAPIs","AzureCopilotShellAPIs"));if("Microsoft_Entra_Copilot"===o)return e.getAsync(i.get("MsPortalImpl/Services/Services.EntraCopilotShellAPIs","EntraCopilotShellAPIs"))}return e.getAsync(i.get("MsPortalImpl/Services/Services.UnsupportedCopilotShellAPIs","UnsupportedCopilotShellAPIs"))}}t.CopilotShellAPIs=m,__decorate([__metadata("fx:diagnostics",[e,"CopilotShellAPIs"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container,p]),__metadata("design:returntype",Promise)],m,"create",null);class g{static create(e,t){const{enabled:s,extension:o}=t.getConfig();if(s){if("Microsoft_Azure_Copilot"===o)return e.getAsync(i.get("MsPortalImpl/Services/Services.CopilotReactViewChannelFactory","ReactViewChannelFactory"));if("Microsoft_Entra_Copilot"===o)return e.getAsync(i.get("MsPortalImpl/Services/Services.EntraCopilotReactViewChannelFactory","ReactViewChannelFactory"))}}}t.CopilotReactViewChannelFactory=g,__decorate([__metadata("fx:diagnostics",[e,"CopilotReactViewChannelFactory"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container,p]),__metadata("design:returntype",Promise)],g,"create",null)})),
define("MsPortalImpl/UI/UI.BladeOpener",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader"],(function(e,t,s,i){"use strict";t.BladeOpener=void 0;const o=i.getFactory("MsPortalImpl/UI/UI.BladeOpenerImpl","BladeOpener");let n=t.BladeOpener=class{constructor(e){this._diContainer=e}openBlade(e,t={}){return this._diContainer.getAsync(o()).then((s=>s.openBlade(e,t)))}};t.BladeOpener=n=__decorate([__metadata("fx:diagnostics",[e,"BladeOpener"]),s.Class(),__metadata("design:paramtypes",[s.Container])],n)})),
define("_generated/MsPortalImpl/Svg/Internal/CopilotMonoline.svg",["require","exports"],(function(e,t){"use strict";t.type=t.data=void 0;t.type=1,t.data="<svg viewBox='0 0 20 20' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M5.927 2h6.212c1.054 0 1.981.694 2.278 1.705l.469 1.594c.161.546.64.933 1.199.982h.289c.888 0 1.573.252 2.027.768.443.503.589 1.17.599 1.839.019 1.321-.498 2.962-.909 4.268-.358 1.137-.819 2.318-1.436 3.222-.615.901-1.455 1.623-2.582 1.623H7.861a2.375 2.375 0 0 1-2.278-1.705l-.469-1.594a1.376 1.376 0 0 0-1.199-.982h-.29c-.888 0-1.573-.252-2.027-.768-.443-.503-.589-1.17-.599-1.839-.019-1.321.498-2.962.909-4.268.358-1.137.819-2.317 1.436-3.222C3.959 2.722 4.799 2 5.926 2ZM2.862 7.146c-.427 1.357-.879 2.828-.863 3.953.008.554.13.944.349 1.192.207.235.576.429 1.277.429h2.627c.609 0 1.146-.4 1.32-.985.47-1.577 1.266-4.239 1.894-6.276l.033-.107c.149-.484.293-.952.449-1.368.132-.354.281-.691.461-.985H5.927c-.644 0-1.221.402-1.756 1.187-.533.781-.958 1.848-1.308 2.959Zm2.872 6.574c.147.209.263.444.338.699l.469 1.594c.172.585.709.987 1.319.987h.026a.914.914 0 0 0 .754-.378c.167-.227.32-.543.474-.957.145-.386.281-.827.433-1.321l.03-.098.2-.651a2.382 2.382 0 0 1-.742.119H6.41a2.785 2.785 0 0 1-.159.005h-.518Zm2.459-1.005h.843c.553 0 1.047-.33 1.262-.83.437-1.446.871-2.896 1.171-3.905.075-.253.19-.487.337-.694h-.843c-.553 0-1.046.33-1.262.829a959.24 959.24 0 0 0-1.171 3.906c-.075.253-.19.487-.337.694Zm2.029-6.311c.235-.077.485-.119.742-.119h2.626a2.75 2.75 0 0 1 .158-.005h.518a2.36 2.36 0 0 1-.338-.699l-.469-1.594A1.375 1.375 0 0 0 12.14 3h-.015a.915.915 0 0 0-.765.378c-.167.227-.32.543-.474.957-.145.387-.281.827-.433 1.321l-.03.098-.2.65Zm6.916 6.451c.427-1.357.879-2.828.863-3.953-.008-.555-.13-.944-.349-1.192-.207-.235-.576-.429-1.277-.429h-2.627c-.609 0-1.146.4-1.32.985a777.776 777.776 0 0 1-1.894 6.276l-.033.107c-.149.484-.293.952-.449 1.368a5.731 5.731 0 0 1-.461.985h4.483c.644 0 1.221-.402 1.756-1.187.533-.781.958-1.848 1.308-2.959Z'/></g></svg>"})),
define("MsPortalImpl/UI/Hubs/UI.ActionableNotifications",["require","exports","Weave/DirectMode","Weave","MsPortalImpl/Resources/PortalNotificationsTelemetry","MsPortalImpl/Notifications/IrisNotificationsTelemetry","MsPortalImpl/UI/UI.BladeOpener","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Services/Services.Copilot","Fx/Experimentation","MsPortalImpl/Base/Languages","FxInternal/AsyncLoader","FxInternal/Weave/Components/Section","FxInternal/Weave/Components/Button","Fx/Composition/Selectable","_generated/MsPortalImpl/Svg/Internal/CopilotMonoline.svg","MsPortalImpl/Resources/ImplScriptResources"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x){"use strict";t.DEV=void 0,t.Link=D,t.makeActionable=function(e,t){let s=e.inlineForm?.buttons||e.actions||[];if(Array.isArray(s)){if(s.length<k&&(!function(e,t){const s=function(e){if(Object.keys(B).length)return B;const t=e.get(d.Experimentation),s=(0,c.isCopilotEnabled)(e);return B.checkCopilotActionableErrorNotifications=s&&t.shellAssignments.getBooleanValue("notificationcopilotbuttonactionable")&&"en"===p.getCurrentLocaleContext()?.selectedDisplayLanguage,B.showCopilotButtonForAllErrorNotifications=s,B}(t);if(!s.checkCopilotActionableErrorNotifications&&!s.showCopilotButtonForAllErrorNotifications)return!1;try{const i=e.description||"";let n;if(e.id?.includes("#")&&(n=e.id.split("#")[0]),s.checkCopilotActionableErrorNotifications){let s;if(i.includes("Please remove the lock and try again.")?s="ScopeLocked":i.includes("does not have authorization to perform action")&&(s="AuthorizationFailed"),s){const r=/Failed to ([^.]+)\./.exec(i);if(r&&r.length>1){const i=r[1],a=R(e,{id:"copilot-error-actionable",label:P.label,secondary:!0,launchCopilot:async()=>{const r=await N(t,{prompt:_.Prompt.actionableCase.format(i,s),displayPrompt:_.displayPrompt.format(e.title)});return S.trace({source:o.Source.UIActionableNotifications,action:o.ActionInternal.CopilotButtonClicked,actionModifier:"ActionableError",data:{operation:i,armErrorCode:s,nudgeResult:r.nudgeResult,promptTrimmed:r.promptTrimmed,extensionName:n,notificationId:e.id}}),r.nudgeResult}});return S.trace({source:o.Source.UIActionableNotifications,action:o.ActionInternal.CopilotButtonAdded,actionModifier:"ActionableError",data:{operation:i,armErrorCode:s,buttonAddedTo:a,extensionName:n,notificationId:e.id}}),!0}}}if(2===e.status&&s.showCopilotButtonForAllErrorNotifications){const s=R(e,{id:"copilot-error-general",label:P.label,secondary:!0,launchCopilot:async()=>{const s=await N(t,{prompt:_.Prompt.generalCase.format(e.title,i),displayPrompt:_.displayPrompt.format(e.title)});return S.trace({source:o.Source.UIActionableNotifications,action:o.ActionInternal.CopilotButtonClicked,actionModifier:"AllError",data:{nudgeResult:s.nudgeResult,promptTrimmed:s.promptTrimmed,extensionName:n,notificationId:e.id}}),s.nudgeResult}});return S.trace({source:o.Source.UIActionableNotifications,action:o.ActionInternal.CopilotButtonAdded,actionModifier:"AllError",data:{buttonAddedTo:s,extensionName:n,notificationId:e.id}}),!0}}catch(e){F.warning("Failed to add copilot button to notification",e)}}(e,t),s=e.inlineForm?.buttons||e.actions||[]),!s.length)return e.formSection=void 0,e;let i=s;MsPortalFx.isArrayOrObservableArray(s)&&s.length>k&&(i=s.slice(0,k),S.trace({source:o.Source.ToastTray,action:"TooManyButtons",data:{buttonCount:s.length,notificationId:e.notificationId||e.id}}));const n=function(e,t,s){const i=[];return t.forEach((t=>{if(!t.label)return;let o,n={bladeRef:!1,deepLink:!1,extLink:!1,pinToDashboard:!1};if(A(t))H(t,i,s,{image:{...f,options:{customClass:"ext-copilot-error-notification-icon"}},position:0},e,n);else{if(function(e){const t=e.action;if(!t)return!1;if("string"==typeof t)return!0;const s=t,i=s.partName&&s.extension&&s.parameters,o=t?.parameters,n=o?.blade&&o?.extension;if(!i&&!n)return!1;return!0}(t)){const r=t.action;return"string"==typeof r?(r.startsWith("#")?n.deepLink=!0:n.extLink=!0,o=n.deepLink?null:{image:y.LaunchCurrent(),position:1}):r.parameters.blade?n.bladeRef=!0:(n.pinToDashboard=!0,o={image:y.Pin(),position:0}),void H(t,i,s,o,e,n)}(function(e){if(!(e.openBlade||e.deepLink||e.externalLink||e.pinToDashboard||e.endpoint))return!1;if(e.openBlade&&(!e.openBlade.blade||!e.openBlade.extension))return!1;if(e.deepLink&&!e.deepLink)return!1;if(e.externalLink&&!e.externalLink)return!1;if(e.pinToDashboard&&(!e.pinToDashboard.extension||!e.pinToDashboard.name))return!1;if(e.endpoint&&(!e.endpoint.uri||!e.endpoint.method||!e.endpoint.successMessage||!e.endpoint.failureMessage))return!1;return!0})(t)&&(t.externalLink?o={image:y.LaunchCurrent(),position:1}:t.pinToDashboard&&(o={image:y.Pin(),position:0}),n={bladeRef:!!t.openBlade,deepLink:!!t.deepLink,extLink:!!t.externalLink,pinToDashboard:!!t.pinToDashboard},H(t,i,s,o,e,n))}})),i}(e,i,t);return e.formSection=O(n,null),e}if(e.actions&&"object"==typeof e.actions){const s=function(e,t,s){if(!t?.label)return;const i={bladeRef:!1,deepLink:!1,extLink:!1};if(function(e){const t=e.action;if(!t)return!1;if("string"==typeof t)return!0;const s=t?.parameters;if(!s?.blade||!s?.extension)return!1;return!0}(t)){const n=t.action;return"string"==typeof n?n.startsWith("http")?i.extLink=!0:i.deepLink=!0:n.parameters.blade&&(i.bladeRef=!0),function(e,t,s,i){const n={text:e.label,action:e.action,isExternal:i.extLink,target:i.extLink?"_blank":"_self",onClick:n=>{if(i.bladeRef){const s=e.action;L({blade:s?.parameters?.blade,extension:s?.parameters?.extension,openInContextPane:s?.parameters?.openInContextPane,tryOpenInDockedContextPane:s?.parameters?.tryOpenInDockedContextPane,parameters:s?.parameters?.parameters},t)}else if(i.deepLink){const s=e.action;t.get(a.RoutePortalFunc).invoke({uri:s,openedByContext:{openedBy:6}})}else if(i.extLink){const s=e.action;t.get(l.WindowManager).openWindow(s)}if(4!==s.toastDuration){const i=s.irisNotificationDetails;i?z(t,i,e.id):S.trace({source:o.Source.ToastTray,action:e.id,data:{notificationId:s.notificationId||s.id}})}}};return n}(t,s,e,i)}return null}(e,e.actions,t);return e.formSection=O([],s),e}return e};var b=MsPortalFx.Base,y=b.Images,v=MsPortalFx.Hubs.Notifications,w=FxImpl.Hubs.Notifications,M=v.NotificationStatus,C=w.InternalClientNotification,S=MsPortalFx.Base.Diagnostics.Telemetry,I=b.Diagnostics;const P=x.ActionableNotification.CopilotButton,_=x.CopilotNotification.ErrorNudge,F=I.createLog(e),T=2e3,k=3,E={Microsoft_Azure_Support:{"EmbeddedChat.ReactView":!0,"EmbeddedChatV2.ReactView":!0}};function D(e){return s("a",{"aria-label":e.text,className:e.isExternal?"fxs-notification-action-link msportalfx-ext-link msportalfx-tooltip-overflow":"fxs-notification-action-link msportalfx-tooltip-overflow",href:"#",target:e.target,onClick:({event:t})=>{t.preventDefault(),e.onClick(null)}},e.text)}function A(e){return"function"==typeof e?.launchCopilot}const B={};async function N(e,t){try{let s=!1;t.prompt?.length>T&&(s=!0);const i=await MsPortalFx.require("MsPortalImpl/Services/Services.Copilot"),o=s?{...t,prompt:t.prompt.slice(0,T)}:t;return{promptTrimmed:s,nudgeResult:await e.get(i.CopilotService).nudge({...o,source:"notification"})}}catch(e){F.warning("Failed to send prompt through copilot nudge",e)}}function R(e,t){let s="";return e.inlineForm?.buttons?.length?(e.inlineForm.buttons.push(t),s="inlineFormButtons"):(e.actions||(e.actions=[]),e.actions.push(t),s="notificationActions"),s}function L(e,t){let s=8;e.tryOpenInDockedContextPane?s=E[e.extension]?.[e.blade]?1024:1:e.openInContextPane&&(s=1);const i=new h.PdlBladeReference(e.blade,e.extension,{parameters:e.parameters||Object.create(null)});t.get(r.BladeOpener).openBlade(i,{flags:s,telemetryName:o.Source.UIActionableNotifications})}function z(e,t,s){(0,n.irisTelemetryHandler)({diContainer:e,messageArg:{irisNotificationDetails:t,action:s},messageContext:null})}function H(e,t,s,n,r,c){const d={disabled:(0,i.makeWritableComputation)(!1),style:(0,i.makeWritableComputation)(0),text:e.label,icon:n,onClick:()=>{if(A(e))return e?.launchCopilot();if(c.bladeRef){const t=e.action;e.openBlade?L(e.openBlade,s):L({blade:t?.parameters?.blade,extension:t?.parameters?.extension,openInContextPane:t?.parameters?.openInContextPane,tryOpenInDockedContextPane:t?.parameters?.tryOpenInDockedContextPane,parameters:t?.parameters?.parameters},s)}else c.deepLink?s.get(a.RoutePortalFunc).invoke({uri:e.deepLink?.uri??e.action,openedByContext:{openedBy:6}}):c.extLink?s.get(l.WindowManager).openWindow(e.externalLink?.uri??e.action):c.pinToDashboard?function(e,t){const s={partReferences:[{partName:e.name||e.partName,parameters:e.parameters||Object.create(null),options:{extensionName:e.extension}}],originExtension:e.extension,notify:!0};(0,u.get)("MsPortalImpl/UI/Dashboard/Common/DashboardPinHelper","pinTilesWithDashboardSelection").then((e=>e(t,o.Source.NotificationHub,null,s)))}(e.pinToDashboard??e.action,s):e.endpoint&&function(e,t,s){s.forEach((e=>e.disabled(!0))),b.Net2.ajax({uri:e.uri,type:e.method,dataType:"json",contentType:"application/json",setAuthorizationHeader:!!e.useArmToken,data:e.body||""}).then((()=>{t.description=e.successMessage,t.status=M.Success})).catch((s=>{t.description=e.failureMessage,t.status=M.Error})).finally((()=>{t.toastDuration=0,t.inlineForm=void 0,C.internalPublish(t)}))}(e.endpoint,r,t);if(4!==r.toastDuration){const t=r.irisNotificationDetails;t?z(s,t,e.id):S.trace({source:o.Source.ToastTray,action:e.id,data:{notificationId:r.notificationId||r.id}})}}};(e.secondary||e.isSecondary)&&d.style(1),t.push(d)}function O(e,t){return t?{buttons:[],link:t,section:e=>s(m.Section,{className:e,children:[s(m.Section,{children:[s(D,{...t})]})]})}:{buttons:e,link:t,section:t=>s(m.Section,{className:t,children:[s(m.Section,{children:e.map((e=>s(g.Button,{...e})))})]})}}})),
define("MsPortalImpl/Base/Base.SvgHelper",["require","exports","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.Sanitization"],(function(e,t,s,i){"use strict";t.SvgsPalettes=t.SvgPlaceholderClass=t.SvgBadgeClass=void 0,t.getSvgReferenceOrFallBackToData=function(t,r,a,l,m){r=r||t.options||{};const x=t&&t.type,S=t&&t.data;if(0===x||!S)return p(w.cloneNode(),M);if(2===x){if(i.sanitizeUri(S,null,{diContainer:m,localRequire:e,windowContext:a})){const e=n(r.title||""),t=FxImpl.createElement("img");return e?t.setAttribute("alt",e):t.setAttribute("aria-hidden","true"),t.setAttribute("src",o(S)),t}return s.logToExtension(e,a,2,"Image has failed to load as an invalid uri was passed in : "+S),p(w.cloneNode(),M)}const I=function(t,i,o){let n=v[t];if(!n||o){n=y,n.innerHTML=t;const r=[];g(n.querySelectorAll(_),(o=>{s.logToExtension(e,i,2,"Svg contains illegal element: "+o.tagName,{contextData:{svg:t}}),r.push(o)})),r.forEach((e=>e.remove())),g(n.querySelectorAll("*"),(o=>{const n=o.attributes,r=[];for(let o=0,a=n.length;o<a;++o){const a=n[o].name;P[a]||(s.logToExtension(e,i,2,"Svg contains illegal attribute: "+a,{contextData:{svg:t}}),r.push(a))}r.forEach((e=>o.removeAttribute(e)))})),MsPortalFx.isFeatureEnabled("preservegradients")||g(n.querySelectorAll("clipPath,filter,linearGradient,mask,radialGradient"),(e=>{const t=e.getAttribute("id");if(t){const s=MsPortalFx.getUniqueId();e.setAttribute("id",s),["clip-path","fill","filter","mask"].forEach((e=>{g(n.querySelectorAll(`[${e}='url("#${t}")'],[${e}="url('#${t}')"],[${e}="url(#${t})"]`),(t=>{t.setAttribute(e,`url(#${s})`)}))}))}})),o||(g(n.querySelectorAll("clipPath,filter,linearGradient,mask,radialGradient"),(e=>C.appendChild(e))),v[t]=n.cloneNode(!0))}return n.cloneNode(!0)}(S,a,l);if(!I.hasChildNodes())return s.logToExtension(e,a,2,"Svg has failed to load, imageData: "+S),p(w.cloneNode(),M);const D=d[r.palette];r.palette&&g(I.getElementsByClassName(c),(e=>u(e,D)));if(r.symbol)return h(F(x,I).symbolContainer,r);if(!k&&(T||!MsPortalFx.isNullOrWhiteSpace(r.customClass)||E.test(I.outerHTML))){return h(I,r)}const A=I.outerHTML;let B=b.get(A);if(B)B=B.cloneNode(!0);else{const e=F(x,I);B=e.reference,f.appendChild(e.symbol),b.set(A,B.cloneNode(!0))}return h(B,r)};MsPortalFx.Base.Diagnostics;var o=MsPortalFx.encodeAttribute,n=MsPortalFx.encodeHtml;const r=window,a="http://www.w3.org/2000/svg",l=r.document,c=t.SvgPlaceholderClass="msportalfx-svg-placeholder",d=(t.SvgBadgeClass="msportalfx-svg-badge",t.SvgsPalettes=[]);let p;function u(e,t){const s=e.getAttribute("class");e.setAttribute("class",(s?s+" ":"")+t)}function m(e,t){e.setAttribute("class",(e.getAttribute("class")||"").split(" ").filter((e=>e&&e!==t)).join(" "))}function g(e,t){for(let s=0,i=e.length;s<i;++s)t(e[s])}function h(e,t){if(t.customClass&&n(t.customClass).split(" ").filter((e=>e.startsWith("ext-")||e.startsWith("msportalfx")||e.startsWith("fxt-"))).forEach((t=>g(e.getElementsByClassName(c),(e=>u(e,t))))),t.description){const s=l.createElementNS(a,"desc");s.textContent=t.description;const i=e.getElementsByTagName("title")[0];i&&i.parentNode.insertBefore(s,i.nextSibling)}if(t.title)g(e.getElementsByTagName("title"),(e=>{e.textContent||(e.textContent=t.title)}));else{const t=[];g(e.getElementsByTagName("title"),(e=>e&&!e.textContent&&t.push(e))),t.forEach((e=>e.remove()))}return t._badgeWidth||(g(e.getElementsByClassName(c),(e=>m(e,c))),g(e.querySelectorAll("[class='']"),(e=>e.removeAttribute("class")))),p(e.firstElementChild||w.cloneNode(),e.innerHTML)}d[0]="",d[2]="msportalfx-svg-palette-black",d[3]="msportalfx-svg-palette-blue",d[1]="msportalfx-svg-palette-white",d[4]="msportalfx-svg-palette-green",d[5]="msportalfx-svg-palette-gray",d[99]="msportalfx-svg-palette-inherit",d[100]="msportalfx-svg-disabled",p=r.SVGElement&&"outerHTML"in SVGElement.prototype?e=>e:(e,t)=>(e.outerHTML=t,e);const f=FxImpl.createElement("div",{id:"FxSymbolContainer","aria-hidden":"true",role:"presentation",style:"width: 0; height: 0; overflow: hidden"});l.body.appendChild(f);const x=MsPortalFx.getIdGenerator("FxSymbol"),b=new Map,y=l.implementation.createHTMLDocument("").body,v=Object.create(null),w=l.createElementNS(a,"svg"),M=(()=>{const e=FxImpl.createElement("div");return e.appendChild(w),e.innerHTML})(),C=l.createElementNS(a,"defs"),S=l.createElementNS(a,"svg");S.setAttribute("aria-hidden","true"),S.setAttribute("width","0"),S.setAttribute("height","0"),S.setAttribute("role","presentation"),S.setAttribute("focusable","false"),S.appendChild(C);const I=FxImpl.createElement("div",{id:"DefsContainer","aria-hidden":"true",role:"presentation",style:"width: 0; height: 0; overflow: hidden"});I.appendChild(S),l.body.appendChild(I);const P=["aria-hidden","aria-labelledby","class","clip-path","clip-rule","color-interpolation-filters","cx","cy","d","data-islogo","dy","enable-background","fill-opacity","fill-rule","fill","filter","filterUnits","flood-opacity","focusable","gradientTransform","gradientUnits","height","href","id","in","in2","mask","maskUnits","mode","offset","opacity","points","r","result","role","rx","ry","space","spreadMethod","stdDeviation","stop-color","stop-opacity","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","stroke","text-anchor","transform","viewBox","width","x","x1","x2","xlink:href","xml:space","xmlns:svg","xmlns:xlink","xmlns","y","y1","y2","values"].reduce(((e,t)=>(t&&(e[t]=!0,e[t.toUpperCase()]=!0),e)),r.Object.create(null)),_="*:not("+["circle","clipPath","defs","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","g","image","line","linearGradient","mask","path","polygon","polyline","radialGradient","rect","stop","svg","symbol","text","title","use"].join("):not(")+")";function F(e,t){const s=x(),i=w.cloneNode(),o=FxImpl.createElement("div");u(i,c),i.setAttribute("height","100%"),i.setAttribute("width","100%"),i.appendChild(l.createElementNS(a,"title")),o.appendChild(i);const n=w.cloneNode(),r=l.createElementNS(a,"defs"),d=l.createElementNS(a,"symbol"),p=l.createElementNS(a,"use");p.setAttribute("href","#"+s),i.appendChild(p);const g=t.getElementsByTagName("svg")[0]||t;for(let e=0,t=g.attributes.length;e<t;++e){const t=g.attributes[e];d.setAttribute(t.name,t.value)}for(;g.hasChildNodes();)d.appendChild(g.firstChild);d.setAttribute("id",s),d.setAttribute("data-type",e+""),m(d,c),r.appendChild(d),n.appendChild(r);const h=l.createElement("div");return h.appendChild(n),{reference:o,symbol:n,symbolContainer:h}}const T=MsPortalFx.isFeatureEnabled("fulldiagnostics"),k=MsPortalFx.isFeatureEnabled("forcesvgshadowdom"),E=/msportalfx-svg-c0(?:5|7)|-animated[\s'"]|[\s'"]ext-|fxs-svg-number/})),
define("MsPortalImpl/Dialogs/MessageBoxInternal",["require","exports"],(function(e,t){"use strict";t.MessageBoxExtended=void 0;var s=MsPortalFx.ViewModels.Dialogs;class i extends s.MessageBox{}t.MessageBoxExtended=i})),
define("MsPortalImpl/Services/Services.PortalIdleState",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";t.PortalIdleStateService=void 0;class i{constructor(e,t){if(this._win=e,this._defaultPollMS=t,this._state=0,this._handleId=1,this._iteration=0,this._actions=new Map,this._frameInFocus=!1,this._win.addEventListener("blur",this._blurFunc=()=>{document.activeElement instanceof HTMLIFrameElement||this._signalIdle(this._defaultPollMS)}),this._win.addEventListener("focus",this._focusFunc=()=>{this.signalBusy()}),MsPortalFx.isFeatureEnabled("displayidlestateindom")){const e=document.getElementById("web-container");e.dataset.frameinfocus=String(this._frameInFocus),e.dataset.idlestate=String(this._state)}}dispose(){const e=this._win;return!!e&&(this._win=null,e.removeEventListener("blur",this._blurFunc),e.removeEventListener("focus",this._focusFunc),this._setIdleState(0),!0)}addCallbacks(e){const t=this._handleId++;return this._actions.set(t,e),t}removeCallbacks(e){return this._actions.delete(e)}signalBusy(e=0,t){if(this._blurStartTime=null,this._setFrameInFocus(1===e),1===e){const e=document.getElementsByClassName("fxs-topbar-sidebar-collapse-button")[0];e?.offsetWidth>0&&e?.offsetHeight>0&&3!==t&&$(e).trigger("fxtogglesidebar",{collapse:!0})}1===this._state&&(this._setIdleState(2),this._processCallbacks(5e3))}signalIdle(e=0){(0===e||this._frameInFocus)&&this._signalIdle(0)}static create(){return new i(window,6e4)}_setFrameInFocus(e){this._frameInFocus=e,MsPortalFx.isFeatureEnabled("displayidlestateindom")&&(document.getElementById("web-container").dataset.frameinfocus=String(this._frameInFocus))}_setIdleState(e){this._state=e,MsPortalFx.isFeatureEnabled("displayidlestateindom")&&(document.getElementById("web-container").dataset.idlestate=String(this._state))}_signalIdle(e){this._blurStartTime||(this._blurStartTime=Date.now()),this._setIdleState(1),this._processCallbacks(e)}_processCallbacks(e){if(!this._win)return;const t=()=>{let e;switch(this._state){case 2:this._setIdleState(0),e=e=>e.onBusy?.(new Date);break;case 1:this._setIdleState(1),e=e=>e.onIdle(Math.floor((Date.now()-this._blurStartTime)/6e4));break;default:return}const t=(t,s)=>{const i=t[s],o=this._actions.get(i);o&&e(o)},s=Array.from(this._actions.keys()),i=this._actions.size,o=this._iteration%i;this._iteration++;for(let e=o;e<i+o;e++)t(s,e%i)},s=this._timeoutHandle;s&&this._win.clearTimeout(s),this._timeoutHandle=this._win.setTimeout((()=>{this._timeoutHandle=null;try{t()}finally{0!==this._state&&this._processCallbacks(this._defaultPollMS)}}),e)}}t.PortalIdleStateService=i,__decorate([__metadata("fx:diagnostics",[e,"PortalIdleStateService"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",i)],i,"create",null)})),
define("MsPortalImpl/TsxStringMode/Tsx",["require","exports"],(function(e,t){"use strict";function s(e){const t=[];return e&&Object.keys(e).forEach((s=>{switch(s){case"data-bind":e["data-bind"]&&t.push(function(e){const t=[],s=e=>{MsPortalFx.forEachKey(e,((e,i)=>{t.push(`"${e}":`),"string"==typeof i?t.push(i):(t.push("{"),s(i),t.push("}")),t.push(",")})),t.pop()};return t.push("data-bind='"),s(e),t.push("'"),t.join("")}(e["data-bind"]));break;case"class":e.class&&t.push(`class='${"string"==typeof(i=e.class)?i:i.join(" ")}'`);break;default:!MsPortalFx.isNullOrUndefined(e[s])&&t.push(`${s}='${e[s]}'`)}var i})),t}t.KoContext=function(e){return"KoContext"},t.KoForEach=function(e){return"KoForEach"},t.KoIf=function(e){return"KoIf"},t.KoIfNot=function(e){return"KoIfNot"},t.KoTemplate=function(e){return"KoTemplate"},t.KoWith=function(e){return"KoWith"},t.Root=function(){return"Root"},t.elementStringFactories=void 0,t.tsx=function(e,t,...s){const o="string"==typeof e?e:e(),n=i[o];let r=n.createOpenTag(t);return r+=s.join(""),r+=n.createClosingTag(),r};const i=t.elementStringFactories={Root:{createOpenTag:()=>"",createClosingTag:()=>""},a:{createOpenTag:e=>`<a ${s(e).join(" ")}>`,createClosingTag:()=>"</a>"},article:{createOpenTag:e=>`<article ${s(e).join(" ")}>`,createClosingTag:()=>"</article>"},aside:{createOpenTag:e=>`<aside ${s(e).join(" ")}>`,createClosingTag:()=>"</aside>"},b:{createOpenTag:e=>`<b ${s(e).join(" ")}>`,createClosingTag:()=>"</b>"},br:{createOpenTag:e=>`<br ${s(e).join(" ")}/>`,createClosingTag:()=>""},button:{createOpenTag:e=>`<button ${s(e).join(" ")}>`,createClosingTag:()=>"</button>"},canvas:{createOpenTag:e=>`<canvas ${s(e).join(" ")}>`,createClosingTag:()=>"</canvas>"},div:{createOpenTag:e=>`<div ${s(e).join(" ")}>`,createClosingTag:()=>"</div>"},fieldset:{createOpenTag:e=>`<fieldset ${s(e).join(" ")}>`,createClosingTag:()=>"</fieldset>"},"fxs-progress":{createOpenTag:e=>`<fxs-progress ${s(e).join(" ")}>`,createClosingTag:()=>"</fxs-progress>"},h1:{createOpenTag:e=>`<h1 ${s(e).join(" ")}>`,createClosingTag:()=>"</h1>"},h2:{createOpenTag:e=>`<h2 ${s(e).join(" ")}>`,createClosingTag:()=>"</h2>"},h3:{createOpenTag:e=>`<h3 ${s(e).join(" ")}>`,createClosingTag:()=>"</h3>"},h4:{createOpenTag:e=>`<h4 ${s(e).join(" ")}>`,createClosingTag:()=>"</h4>"},h5:{createOpenTag:e=>`<h5 ${s(e).join(" ")}>`,createClosingTag:()=>"</h5>"},hr:{createOpenTag:e=>`<hr ${s(e).join(" ")}>`,createClosingTag:()=>"</hr>"},header:{createOpenTag:e=>`<header ${s(e).join(" ")}>`,createClosingTag:()=>"</header>"},i:{createOpenTag:e=>`<i ${s(e).join(" ")}>`,createClosingTag:()=>"</i>"},iframe:{createOpenTag:e=>`<iframe ${s(e).join(" ")}>`,createClosingTag:()=>"</iframe>"},img:{createOpenTag:e=>`<img ${s(e).join(" ")}/>`,createClosingTag:()=>""},input:{createOpenTag:e=>`<input ${s(e).join(" ")}/>`,createClosingTag:()=>""},label:{createOpenTag:e=>`<label ${s(e).join(" ")}>`,createClosingTag:()=>"</label>"},legend:{createOpenTag:e=>`<legend ${s(e).join(" ")}>`,createClosingTag:()=>"</legend>"},li:{createOpenTag:e=>`<li ${s(e).join(" ")}>`,createClosingTag:()=>"</li>"},main:{createOpenTag:e=>`<main ${s(e).join(" ")}>`,createClosingTag:()=>"</main>"},nav:{createOpenTag:e=>`<nav ${s(e).join(" ")}>`,createClosingTag:()=>"</nav>"},ol:{createOpenTag:e=>`<ol ${s(e).join(" ")}>`,createClosingTag:()=>"</ol>"},p:{createOpenTag:e=>`<p ${s(e).join(" ")}>`,createClosingTag:()=>"</p>"},span:{createOpenTag:e=>`<span ${s(e).join(" ")}>`,createClosingTag:()=>"</span>"},table:{createOpenTag:e=>`<table ${s(e).join(" ")}>`,createClosingTag:()=>"</table>"},tbody:{createOpenTag:e=>`<tbody ${s(e).join(" ")}>`,createClosingTag:()=>"</tbody>"},td:{createOpenTag:e=>`<td ${s(e).join(" ")}>`,createClosingTag:()=>"</td>"},textarea:{createOpenTag:e=>`<textarea ${s(e).join(" ")}>`,createClosingTag:()=>"</textarea>"},th:{createOpenTag:e=>`<th ${s(e).join(" ")}>`,createClosingTag:()=>"</th>"},thead:{createOpenTag:e=>`<thead ${s(e).join(" ")}>`,createClosingTag:()=>"</thead>"},time:{createOpenTag:e=>`<time ${s(e).join(" ")}>`,createClosingTag:()=>"</time>"},tr:{createOpenTag:e=>`<tr ${s(e).join(" ")}>`,createClosingTag:()=>"</tr>"},ul:{createOpenTag:e=>`<ul ${s(e).join(" ")}>`,createClosingTag:()=>"</ul>"},video:{createOpenTag:e=>`<video ${s(e).join(" ")}>`,createClosingTag:()=>"</video>"},KoIf:{createOpenTag:e=>`\x3c!-- ko if: ${e.condition} --\x3e`,createClosingTag:()=>"\x3c!-- /ko --\x3e"},KoIfNot:{createOpenTag:e=>`\x3c!-- ko ifnot: ${e.condition} --\x3e`,createClosingTag:()=>"\x3c!-- /ko --\x3e"},KoForEach:{createOpenTag:e=>`\x3c!-- ko foreach: ${e.items} --\x3e`,createClosingTag:()=>"\x3c!-- /ko --\x3e"},KoTemplate:{createOpenTag:e=>{let t;return e.templateKey?t=`'${e.templateKey}'`:e.options&&(t=e.options),`\x3c!-- ko template: ${t} --\x3e`},createClosingTag:()=>"\x3c!-- /ko --\x3e"},KoContext:{createOpenTag:e=>`\x3c!-- ko context: ${e.context} --\x3e`,createClosingTag:()=>"\x3c!-- /ko --\x3e"},KoWith:{createOpenTag:e=>`\x3c!-- ko with: ${e.data} --\x3e`,createClosingTag:()=>"\x3c!-- /ko --\x3e"}}})),
define("MsPortalImpl/Interactions/Interactions.DismissHandler",["require","exports"],(function(e,t){"use strict";t.dismissByLogName=function(e){if(!n.length)return;n.filter((t=>t.logName===e)).forEach((t=>{t.dismissFn(e)}))},t.dispose=function(){const e=s.body;e.removeEventListener("focus",l,g()),e.removeEventListener("keydown",c,g()),e.removeEventListener("mousedown",d,g()),e.removeEventListener("touchstart",d,g()),e.removeEventListener("wheel",p,g()),e.removeEventListener("scroll",u,g()),n.length=0},t.initialize=function(){const e=s.body;e.addEventListener("focus",l,g()),e.addEventListener("keydown",c,g()),e.addEventListener("mousedown",d,g()),e.addEventListener("touchstart",d,h()),e.addEventListener("wheel",p,h()),e.addEventListener("scroll",u,g())},t.register=function(e){if(!r(e))throw new Error("The dismiss handle object is null or malformed.");if(n.some((t=>t===e)))return;n.push(e)},t.unregister=function(e){MsPortalFx.remove(n,e)},t.validatePreviousFocusedElement=function(e,t){const s=`DismissHandle for '${e.logName}': previouslyFocusedElement`;if(!t)return i.warning(`${s} was not defined.`),!1;if("function"!=typeof t.focus)return i.error(FxImpl.createError(`${s} focus member is not a function. _previouslyFocusedElement.focus: ${t.focus}`,{data:{previous:MsPortalFx.getObjectDescriptor(t)}})),!1;return!0};const s=document,i=MsPortalFx.Base.Diagnostics.createLog(e);let o=!1;const n=[];function r(e){const t=e&&"function"==typeof e.dismissFn&&function(e){const t="function";let s=!!e;return e.shouldDismissOnFocusOutFn&&(s=s&&typeof e.shouldDismissOnFocusOutFn===t),e.restoreFocus&&(s=s&&typeof e.restoreFocus===t),e.shouldDismissOnMouseDownFn&&(s=s&&typeof e.shouldDismissOnMouseDownFn===t),e.shouldDismissOnMouseWheelFn&&(s=s&&typeof e.shouldDismissOnMouseWheelFn===t),s}(e);return t||i.error("The dismiss handle object is null or malformed."),t}function a(e){if(!n.length)return;const t=n[n.length-1];try{const s=e(t);0!==s&&(t.dismissFn(),2===s&&t.restoreFocus&&t.restoreFocus())}catch(e){!function(e,t){i.error("An error occurred on dismiss. Unregister might have been forgotten on cleanup of the dismissable element. DismissHandle log name: {0}".format(t&&t.logName||"unknown"),0,e)}(e,t)}}function l(e){a((t=>t.shouldDismissOnFocusOutFn&&r(t)?t.shouldDismissOnFocusOutFn(e.target):0))}function c(e){27===e.keyCode&&a((e=>r(e)?2:0))}function d(e){a((t=>t.shouldDismissOnMouseDownFn&&r(t)?t.shouldDismissOnMouseDownFn(e.target,e):0))}function p(e){o||(o=!0,setTimeout((()=>{o=!1}),250),a((t=>t.shouldDismissOnMouseWheelFn&&r(t)?t.shouldDismissOnMouseWheelFn(e.target):0)))}function u(e){a((t=>t.shouldDismissOnMouseWheelFn&&t.shouldDismissOnScroll&&r(t)&&!$(e.target).hasClass("azc-resize")?t.shouldDismissOnMouseWheelFn(e.target):0))}let m=!1;try{window.addEventListener("test",null,{passive:!0}),window.removeEventListener("test",null),m=!0}catch(e){m=!1}function g(){return!m||{capture:!0}}function h(){return!m||{capture:!0,passive:!0}}})),
define("MsPortalImpl/Base/Base.KeyboardHelper",["require","exports","MsPortalImpl/Base/Base.BrowserDetection"],(function(e,t,s){"use strict";var i,o;t.VariableKeyCode=void 0,t.getModifierKeys=function(e){return(e.altKey&&1)|(e.metaKey&&2)|(e.shiftKey&&4)|(e.ctrlKey&&8)},t.isCtrlOrCommand=a,t.isCtrlOrCommandOnly=function(e){return!e.shiftKey&&!e.altKey&&a(e)},t.isNonWrittenCharacter=function(e){switch(e){case 18:case 17:case 40:case 35:case 27:case 36:case 37:case 34:case 33:case 39:case 16:case 9:case 38:return!0;default:return!1}},t.mapKeyCodeToString=function(e,t){return(e?n:r)[t]||o[t]},t.setCtrlOrCommandModifier=function(e){e.ctrlKey=!s.isMac,e.metaKey=s.isMac},function(e){e[e.Equals=s.isFirefox?61:187]="Equals",e[e.Minus=s.isFirefox?173:189]="Minus"}(i||(t.VariableKeyCode=i={})),function(e){e[e.Alt=18]="Alt",e[e.Backslash=220]="Backslash",e[e.Backspace=8]="Backspace",e[e.Comma=188]="Comma",e[e.Control=17]="Control",e[e.Delete=46]="Delete",e[e.Down=40]="Down",e[e.End=35]="End",e[e.Enter=13]="Enter",e[e.Equals=i.Equals]="Equals",e[e.Escape=27]="Escape",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F10=121]="F10",e[e.Home=36]="Home",e[e.Left=37]="Left",e[e.Menu=93]="Menu",e[e.Minus=i.Minus]="Minus",e[e.PageDown=34]="PageDown",e[e.PageUp=33]="PageUp",e[e.Period=190]="Period",e[e.Right=39]="Right",e[e.Shift=16]="Shift",e[e.Slash=191]="Slash",e[e.Space=32]="Space",e[e.Tab=9]="Tab",e[e.Up=38]="Up",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.Num0=48]="Num0",e[e.Num1=49]="Num1",e[e.Num2=50]="Num2",e[e.Num3=51]="Num3",e[e.Num4=52]="Num4",e[e.Num5=53]="Num5",e[e.Num6=54]="Num6",e[e.Num7=55]="Num7",e[e.Num8=56]="Num8",e[e.Num9=57]="Num9",e[e.NumPad0=96]="NumPad0",e[e.NumPad1=97]="NumPad1",e[e.NumPad2=98]="NumPad2",e[e.NumPad3=99]="NumPad3",e[e.NumPad4=100]="NumPad4",e[e.NumPad5=101]="NumPad5",e[e.NumPad6=102]="NumPad6",e[e.NumPad7=103]="NumPad7",e[e.NumPad8=104]="NumPad8",e[e.NumPad9=105]="NumPad9",e[e.SingleQuote=222]="SingleQuote"}(o||(o={}));const n=[];n[192]="~",n[219]="{",n[221]="}",n[220]="|",n[59]=":",n[188]="<",n[i.Equals]="+",n[i.Minus]="_",n[49]="!",n[50]="@",n[51]="#",n[52]="$",n[53]="%",n[54]="^",n[55]="&",n[56]="*",n[57]="(",n[48]=")",n[190]=">",n[191]="?",n[222]='"',n[32]="SHIFT+SPACE",n[40]="SHIFT+Down",n[38]="SHIFT+Up";const r=[];function a(e){return e.ctrlKey&&!e.metaKey||s.isMac&&e.metaKey&&!e.ctrlKey}r[220]="\\",r[188]=",",r[i.Minus]="-",r[49]="1",r[50]="2",r[51]="3",r[52]="4",r[53]="5",r[54]="6",r[55]="7",r[56]="8",r[57]="9",r[48]="0",r[190]=".",r[32]="SPACE",r[191]="/"})),
define("MsPortalImpl/Interactions/Interactions.KeyboardNavigation",["require","exports","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Base/JQueryHelper"],(function(e,t,s,i){"use strict";t.KeyboardNavigation=void 0;t.KeyboardNavigation=class{constructor(e,t){if(this._element=t.element,this._tabTriggers=t.tabTriggers||6,this._itemSelector=t.itemSelector||":tabbable",this._arrowsOnly=!(2&this._tabTriggers),this._internalLifetime=e.createChildLifetime(),this._parentTabIndexContextObservable=t.parentTabIndexContextObservable,this._setTabIndex=t.setTabIndex||((e,t)=>{e.attr("tabindex",""+t)}),this._disableTabsterControl(),this._setRootTabIndex(),this._internalLifetime.registerForDispose(this._element.setEvents(["focus",e=>{const t=this._element.find(this._itemSelector).first();this._arrowsOnly&&this._manageTabIndices(t),t.focus()}],["keydown",e=>{this._handleMenuKeyDown(e)}])),this._arrowsOnly){const e=this._element.find(this._itemSelector);this._setTabIndex(e,-1),this._internalLifetime.registerForDispose(this._element.setEvents(["focus",this._itemSelector,e=>{this._manageTabIndices($(e.target))}]))}}correctState(e){(e||this._lastTarget&&this._lastTarget.length&&!this._element.find(this._itemSelector).toArray().includes(this._lastTarget[0]))&&(this._setRootTabIndex(),this._lastTarget&&(this._setTabIndex(this._lastTarget,-1),this._lastTarget=null))}dispose(){this._internalLifetime.dispose()}_handleMenuKeyDown(e){const t=s.getModifierKeys(e);let i=!1;const o=2&this._tabTriggers,n=4&this._tabTriggers,r=8&this._tabTriggers,a=0===t;o&&9===e.keyCode&&a||n&&40===e.keyCode&&a||r&&39===e.keyCode&&a?i=this._moveFocusToItem(1,e.target):(o&&9===e.keyCode&&4===t||n&&38===e.keyCode&&a||r&&37===e.keyCode&&a)&&(i=this._moveFocusToItem(-1,e.target)),i&&e.preventDefault()}_moveFocusToItem(e,t){let s=!1;const o=this._element.find(this._itemSelector),n=$(o.filter(((e,t)=>i.isElementVisible(t)))),r=n.index(t);return-1!==r&&($(n[(r+e+n.length)%n.length]).focus(),s=!0),s}_manageTabIndices(e){if(e&&e.length&&(!this._lastTarget||this._lastTarget[0]!==e[0])){const t=this._element.find(this._itemSelector);this._itemFocusLifetime&&this._itemFocusLifetime.dispose(),this._itemFocusLifetime=this._internalLifetime.createChildLifetime(),this._lastTarget=e,t.index(this._lastTarget[0])>=0&&(this._parentTabIndexContextObservable?this._parentTabIndexContextObservable.subscribeAndRun(this._itemFocusLifetime,(e=>{this._setTabIndex(t,-1);const s=this._lastTarget||this._element.find(this._itemSelector).first();s&&this._setTabIndex(s,e)})):(this._setTabIndex(t,-1),this._setTabIndex(this._lastTarget,0))),this._clearRootTabIndex();const s=e=>{this._setRootTabIndex()},i=this._lastTarget[0];ko.utils.domNodeDisposal.addDisposeCallback(i,s),this._itemFocusLifetime.registerForDispose((()=>{ko.utils.domNodeDisposal.removeDisposeCallback(i,s)}))}}_setRootTabIndex(){this._parentTabIndexContextObservable?(this._rootFocusLifetime&&this._rootFocusLifetime.dispose(),this._rootFocusLifetime=this._internalLifetime.createChildLifetime(),this._parentTabIndexContextObservable.subscribeAndRun(this._rootFocusLifetime,(e=>{this._setTabIndex(this._element,e)}))):this._setTabIndex(this._element,0)}_clearRootTabIndex(){this._rootFocusLifetime&&this._rootFocusLifetime.dispose(),this._setTabIndex(this._element,-1)}_disableTabsterControl(){const e=this._element[0];if(!e)return;const t=e.hasAttribute("data-tabster")?JSON.parse(e.getAttribute("data-tabster")||"{}"):{};t.uncontrolled=!0,e.setAttribute("data-tabster",JSON.stringify(t))}}})),
define("MsPortalImpl/Base/Base.ImageHelper",["require","exports","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Base/Base.SvgHelper"],(function(e,t,s,i){"use strict";t.GetImageData=function t(s,l){l=l||{};const{context:c,bypassCache:d,svgAttributes:p}=l,u=s&&s.type,m=s&&s.options||{};let g;const h=u>=899&&u<999;if(0===u||1===u||2===u||h){const e=i.getSvgReferenceOrFallBackToData(s,m,c,d);"img"===e.tagName.toLowerCase()||e.hasChildNodes()?(a(r(e),p),g=Promise.resolve([e])):g=Promise.resolve([]),g=Promise.resolve(e.hasChildNodes()||"img"===e.tagName.toLowerCase()?[e]:[])}else{g=(s&&s.data&&Promise.resolve({[u]:s})||MsPortalFx.require("MsPortalImpl/Base/Base.ImageLibrary").then((e=>e.builtInSvgs))).then((t=>{if(u>=999){const s=m.title?n(m.title,e,c).sanitizedMarkup:"",i=FxImpl.createElement("img");return i.setAttribute("alt",s),i.setAttribute("aria-hidden",(!m.title).toString()),i.setAttribute("src",o(t[u]&&t[u].data)),[i]}{const e=i.getSvgReferenceOrFallBackToData(t[u],m,c,d),s=r(e),o=m._badgeWidth;if(o){const t=s&&s.getAttribute("class").includes(i.SvgPlaceholderClass)&&s||e.querySelector("svg."+i.SvgPlaceholderClass);t&&(t.setAttribute("class",t.getAttribute("class").replace(i.SvgPlaceholderClass,i.SvgBadgeClass)),"number"==typeof o&&t.setAttribute("style","width:"+o+"%; height:"+o+"%"))}return a(s,p),e.childElementCount?[e]:[]}}))}if(m.badge){let e=m.badge.width;e&&"number"==typeof e||(e=40);const s=MsPortalFx.extend2(m.badge.image,{options:MsPortalFx.extend2(m.badge.image.options||{},{_badgeWidth:e})});g=Promise.all([g,t(s,{context:c})]).then((e=>[].concat(...e||[])))}return g};var o=MsPortalFx.encodeAttribute,n=s.sanitizeHTML;function r(e){return"svg"===e.tagName.toLowerCase()?e:e.getElementsByTagName("svg")[0]}function a(e,t){e&&MsPortalFx.forEachKey(t,((t,s)=>e.setAttribute(t,s)))}})),
define("MsPortalImpl/Base/Base.KnockoutExtensions.Image",["require","exports","MsPortalImpl/Base/Base.ImageHelper","FxInternal"],(function(e,t,s,i){"use strict";t.renderImage=a;const o={"aria-hidden":"true",role:"presentation",focusable:"false"},n=!MsPortalFx.isFeatureEnabled("nokosvgcaching")&&new Map,r={controlsDescendantBindings:!0};function a(e,t){if(t){let r,a;n&&(r=JSON.stringify(t),a=n.get(r)),a||(a=s.GetImageData(t,{context:e,svgAttributes:o}).then((e=>{const t=document.createDocumentFragment();let s,i;for(s=0,i=e.length;s<i;s++)t.appendChild(e[s].cloneNode(!0));return t})),n&&n.set(r,a));const l=e.firstChild;return i.tryImmediateResolve(a,(t=>{l===e.firstChild&&(e.innerHTML="",e.appendChild(t.cloneNode(!0)))}))}return e.innerHTML="",Promise.resolve()}ko.bindingHandlers.image={init:()=>r,update:function(e,t){a(e,ko.unwrap(t()))}}})),
define("MsPortalImpl/Base/Base.Timers",["require","exports"],(function(e,t){"use strict";t.requestAnimationFrame=t.debounce=t.cancelAnimationFrame=void 0,t.setupTimers=n,t.throttle=void 0,t.throttleByAnimationFrame=function(e){let t,s;return(...o)=>{if(t=o,!s){const o=Q.defer(),n=s=o.promise;s.timeout(2e3,"requestAnimationFrameQ timout after 2 seconds: callback:"+e).catch((()=>{n===s&&(s=null)})),i((()=>{try{Promise.resolve(e(...t)).then(o.resolve,o.reject)}catch(e){o.reject(e)}s=null}))}return s}};const s=window;let i=t.requestAnimationFrame=void 0,o=t.cancelAnimationFrame=void 0;function n(e){if(!e&&s.requestAnimationFrame&&s.cancelAnimationFrame)t.requestAnimationFrame=i=e=>s.requestAnimationFrame(e),t.cancelAnimationFrame=o=e=>s.cancelAnimationFrame(e);else{let e=0;t.requestAnimationFrame=i=function(t){const s=Date.now(),i=Math.max(0,16-(s-e)),o=setTimeout((function(){t(s+i)}),i);return e=s+i,o},t.cancelAnimationFrame=o=function(e){clearTimeout(e)}}}n(!1);const r="function",a=MsPortalFx.memoize,l=MsPortalFx.uncurryThis(Array.prototype.slice),c=MsPortalFx.Errors,d={noDebugCheck:!0};function p(e,t,s){return new c.CanceledError({message:e,data:t&&t+"",innerErrors:s})}const u=function(e,t,s){let i,o,n,c;typeof t!==r&&(s=t,t=e,e=null);const u=a((()=>{const e=n||(n=Q.defer());return(s>0?MsPortalFx.delay(s):Promise.resolve()).then((()=>e.promise.isPending()&&o())).then(e.resolve,e.reject),e.promise}),d);o=()=>(u.clear(),n=null,t.apply(null,i));const m=function(){return i=arguments.length?l(arguments):void 0,u()},g=e=>{n&&n.promise.isPending()&&n.reject(e||p("canceled",t)),n=null,c||u.clear()};return m.cancel=g,m.dispose=()=>{c=!0;const e=p("disposed",t);g(e);const s=Promise.reject(e);s.catch(MsPortalFx.noop),u.map().set(void 0,s)},e&&e.registerForDispose(m),m};t.throttle=u;const m=function(e,t,s=0){let i;typeof t!==r&&(s=t,t=e,e=null);let o,n,c,u,m=0;const g=a((()=>{const e=c||(c=Q.defer()),t=Date.now(),i=m+s-t;return i>0?MsPortalFx.delay(i).then((()=>e.promise.isPending()&&n())):Promise.resolve().then((()=>e.promise.isPending()&&o())).then(e.resolve,e.reject),e.promise}),d);n=()=>(g.clear(),g()),o=()=>(g.clear(),c=null,t.apply(null,i));const h=function(...e){return m=Date.now(),i=arguments.length?l(arguments):void 0,g()};function f(e){c&&c.promise.isPending()&&c.reject(e||p("canceled",t)),c=null,u||g.clear()}return h.cancel=f,h.dispose=()=>{u=!0;const e=p("disposed",t);f(e);const s=Promise.reject(e);s.catch(MsPortalFx.noop),g.map().set(void 0,s)},e&&e.registerForDispose(h),h};t.debounce=m,ko.extenders.rateLimit.tasks.debounce=m,ko.extenders.rateLimit.tasks.throttle=u})),
define("MsPortalImpl/Base/Base.KnockoutExtensions.FxClick",["require","exports"],(function(e,t){"use strict";function s(e,t,s,i){let o=!1;i&&i.registerForDispose((()=>o=!0)),MsPortalFx.require("MsPortalImpl/UI/Compositions/UI.Composition.Selectable2Registrar",(n=>{o||n.attachFxClickHandler(e,s,t,i)}))}t.applyFxClick=s,ko.bindingHandlers.fxclick={init:(e,t,i,o,n)=>{s(e,t(),n,null)}}})),
define("MsPortalImpl/Weave/InternalUtil",["require","exports","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Base/Base.KnockoutExtensions.FxClick","MsPortalImpl/Base/Base.Sanitization"],(function(e,t,s,i,o){"use strict";t.applyFxClickToElement=function(e,t,s,o){(0,i.applyFxClick)(e,s,{$dicontainer:o.diContainer,$disabled:o.disabled,$tabIndex:o.tabIndex},t)},t.makeHtmlDataHandler=function(t,i,o){return n=>n?n.skipSanitization&&o?n.content:i.get(s.KODeniedTemplateSanitizer).sanitize({contextData:{moduleName:n.moduleName},diContainer:i,localRequire:e,value:n.content,windowContext:t}).sanitizedMarkup:""},t.matchKeyCode=function(e,t){return!0===e||Array.isArray(e)&&e.includes(t)},t.sanitizeHref=function(e,t){const s=(0,o.sanitizeLinkUri)(e,t);return!1===s?{valid:!1}:{valid:!0,value:s}},t.sanitizeSrc=function(e){return(0,o.validateUriOrBlank)(e)||(0,o.validateDataImage)(e)?{valid:!0,value:e}:{valid:!1}}})),
define("MsPortalImpl/Weave/SandboxDomAgents/EntryPoint",["require","exports","FxInternal"],(function(e,t,s){"use strict";t.attachSandboxDomAgent=function(e,t,i,n){s.tryImmediateResolve(o[n.type](),(s=>{t.isDisposed()||s.attachDomAgent(e,t,i,n.options)}))};const i=e=>MsPortalFx.require(e),o={tab:()=>i("MsPortalImpl/Weave/SandboxDomAgents/Tab"),splitter:()=>i("MsPortalImpl/Weave/SandboxDomAgents/Splitter"),button:()=>i("MsPortalImpl/Weave/SandboxDomAgents/Button")}})),
define("MsPortalImpl/Weave/Util",["require","exports","Weave/DirectMode","Weave","Weave/Core/Computation","FxInternal/Weave/Util","FxInternal/Weave","Weave/Core/InternalUtil","FxInternal/WeaveControls/Common","FxInternal"],(function(e,t,s,i,o,n,r,a,l,c){"use strict";function d(e,t,s){return(e.koContext?e.koContext.createChildContext(s):new ko.bindingContext(s)).extend({$disabled:(0,r.toObservable)(t,e.disabled),$tabIndex:(0,r.toObservable)(t,e.tabIndex),$index:(0,r.toObservable)(t,e.indexInLoop),$dicontainer:e.diContainer,$partName:e.partName,$extensionName:e.extensionName})}t.aggregateContext=function(e,t,s){const i=(0,r.toComputation)(t.disabled);return{disabled:(0,n.aggregateDisabled)([e.disabled,s&&(0,r.toComputation)(s.disabled),i]),tabIndex:(0,n.aggregateTabindex)([e.tabIndex,s&&(0,r.toComputation)(s.tabIndex)],i)}},t.createControlComponent=function(e){return t=>s(i.GetContext,{fn:o=>((0,l.patchFieldControlVM)(o,t.vm),(0,l.tryWrapAggregationSourceForFieldControlVM)(t.vm,s(i.LifetimeManagerScoped,{fn:()=>{const s=new e.widgetUIStateCtor({diContainer:o.diContainer,vm:t.vm}),i=e.innerComponent({vm:t.vm,state:s}),r=t.afterMount;return(0,n.isWeaveNodeWithParentRenderInfo)(i)?(0,a.WeaveTsx)(t.tagName||"div",{...t,afterMount:l,className:[i.parentClassName,t.className],vm:void 0,tagName:void 0},i.weaveNode):(0,a.WeaveTsx)(t.tagName||"div",{...t,afterMount:l,vm:void 0,tagName:void 0},i);function l(i,n){n.registerForDispose(new e.widgetCtor($(i),t.vm,{weaveContext:o,diContainer:o.diContainer},s)),r&&r(i,n)}}})))})},t.createControlComponentForKO=function(e){return t=>s(i.GetContext,{fn:s=>{(0,l.patchFieldControlVM)(s,t.vm);const i=t.afterMount;return(0,l.tryWrapAggregationSourceForFieldControlVM)(t.vm,(0,a.WeaveTsx)(t.tagName||"div",{...t,afterMount:(o,n)=>{n.registerForDispose(new e.widgetCtor($(o),t.vm,{bindingContext:d(s,n,{}),diContainer:s.diContainer})),i&&i(o,n)},vm:void 0,tagName:void 0}))}})},t.createControlComponentNoUIState=function(e){return t=>s(i.GetContext,{fn:s=>{(0,l.patchFieldControlVM)(s,t.vm);const i=t.afterMount;return(0,l.tryWrapAggregationSourceForFieldControlVM)(t.vm,(0,a.WeaveTsx)(t.tagName||"div",{...t,afterMount:(o,n)=>{n.registerForDispose(new e.widgetCtor($(o),t.vm,{weaveContext:s,diContainer:s.diContainer})),i&&i(o,n)},vm:void 0,tagName:void 0},e.innerComponent({vm:t.vm})))}})},t.createControlLazyComponent=function(e){return t=>s(i.GetContext,{fn:o=>{(0,l.patchFieldControlVM)(o,t.vm);const r=c.tryImmediateResolve(e(),(e=>s(i.LifetimeManagerScoped,{fn:()=>{const s=new e.WidgetUIState({diContainer:o.diContainer,vm:t.vm}),i=e.InnerTsxComponent({vm:t.vm,state:s}),r=t.afterMount;return(0,n.isWeaveNodeWithParentRenderInfo)(i)?(0,a.WeaveTsx)(t.tagName||"div",{...t,afterMount:l,className:[i.parentClassName,t.className],vm:void 0,tagName:void 0},i.weaveNode):(0,a.WeaveTsx)(t.tagName||"div",{...t,afterMount:l,vm:void 0,tagName:void 0},i);function l(i,n){n.registerForDispose(new e.Widget($(i),t.vm,{weaveContext:o,diContainer:o.diContainer},s)),r&&r(i,n)}}})));return(0,l.tryWrapAggregationSourceForFieldControlVM)(t.vm,s(i.PromiseFragment,{"data-odebug":"p2a",promise:r}))}})},t.createControlLazyComponentForKO=function(e){return t=>s(i.GetContext,{fn:o=>{const n=c.tryImmediateResolve(e(),(e=>{const s=t.afterMount,i=t.vm,n="function"==typeof i?i(e):i;(0,l.patchFieldControlVM)(o,n);return(0,l.tryWrapAggregationSourceForFieldControlVM)(n,(0,a.WeaveTsx)(t.tagName||"div",{...t,afterMount:(t,i)=>{i.registerForDispose(new e.Widget($(t),n,{bindingContext:d(o,i,{}),diContainer:o.diContainer})),s&&s(t,i)},vm:void 0,tagName:void 0}))}));return s(i.PromiseFragment,{"data-odebug":"p2b",promise:n})}})},t.createFragment=function(e){return s(i.Fragment,null,e)},t.isTsxElemId=function(e){return(e||"").startsWith("_weave_e_")},t.mapWhiteSpaceToUndefined=function(e){return(e||"").trim()||void 0},t.tryFocusAfterChangePropagation=function(e){const t=document.activeElement;t!==e&&(0,o.invokeAfterChangePropagation)((()=>{t!==document.activeElement&&document.activeElement!==document.body||e.focus()}))},t.weaveContextToKoContext=d,t.wrapFnWaitForChangePropagation=function(e,t){let s=!1;return()=>{s&&t||(s=!0,(0,o.invokeAfterChangePropagation)((()=>{s=!1,e()})))}}})),
define("Viva.Controls/Util/Viva.Resize",["require","exports","MsPortalImpl/Base/Base.Timers"],(function(e,t,s){"use strict";t.track=function(e,t,r,p){const u=$(t);if(e&&!e.isDisposed()&&l){const t=u.length;if(1!==t){const e=`Viva.Resize.track can only take an element with length of 1. Current element.length: ${t}.`;if(i.error(e),!t)return}const m=u[0],g=p?.notifyInitialSize,h=p?.ignoreInitialState,f=p?.debounceTime??n,x=p?.partialPixels??!1;if(a.has(m)){const e="Viva.Resize.track already registered for this element.";i.error(e)}u.addClass(o),e.registerForDispose((()=>{u.removeClass(o)}));let b=0,y=0;const v=(t,s,i)=>{e.isDisposed()||(!s&&!t||s===b&&t===y)&&!i||(b=s,y=t,r(t,s))},w=s.debounce(e,((e,t)=>{s.requestAnimationFrame((()=>{v(e,t)}))}),f);if(a.set(m,{lifetime:e,partialPixels:x,debounceHandler:w,ignoreInitialState:h&&!g}),l.observe(m),e.registerForDispose((()=>{l.unobserve(m),a.delete(m)})),g){const{width:e,height:t}=d(function(e){const t=getComputedStyle($(e)[0],null),s="border-box"===t.boxSizing;let i=c(t.width);i&&s&&(i-=c(t.paddingLeft),i-=c(t.paddingRight),i-=c(t.borderLeftWidth),i-=c(t.borderRightWidth));let o=c(t.height);o&&s&&(o-=c(t.paddingTop),o-=c(t.paddingBottom),o-=c(t.borderTopWidth),o-=c(t.borderBottomWidth));return{width:i,height:o}}(m),x);v(e,t,!0)}}};const i=MsPortalFx.Base.Diagnostics.createLog(e),o="fxs-vivaresize",n=100,r=.05,a=new Map,l=window?.ResizeObserver?new window.ResizeObserver(((e,t)=>{for(const t of e){const e=t.target,s=a.get(e);if(s){const{lifetime:e,debounceHandler:i,ignoreInitialState:o,inited:n,partialPixels:r}=s;if(!e.isDisposed())if(o&&!n)s.inited=!0;else{const{width:e,height:s}=d(t.contentRect,r);i(e,s)}}}})):null;function c(e){let t;return e?.endsWith("px")&&(t=parseFloat(e)),t||0}function d(e,t){let s=e.width||0,i=e.height||0;return t||(s=Math.floor(s+r),i=Math.floor(i+r)),{width:s,height:i}}window&&!l&&i.error("ResizeObserver not supported by browser. UI will not be responsive to resizing in some cases.")})),
define("WeaveDOM/Core/InternalUtil",["require","exports"],(function(e,t){"use strict";function s(e){return document.createRange().createContextualFragment(e)}function i(e){const t=[];for(let s=20;s>0&&e;s--)8===e.nodeType?t.push(e.nodeValue||""):t.push(e.classList?.value||""),e=e.parentNode;return t.join(":")}function o(e,t){return e.nodeType===t}function n(e,t){o(e,1)&&o(t,1)?e.insertAdjacentElement("beforebegin",t):e.before?e.before(t):e.parentNode.insertBefore(t,e)}function r(e,t){return e.getElementById?e.getElementById(t):e.querySelector("#"+t)}function a(e,t){const s=e.childNodes;for(let e=0;e<s.length;++e){const i=s[e];o(i,8)&&t.set(i.textContent,i)}}Object.defineProperty(t,"__esModule",{value:!0}),t.documentFragmentFromHtml=s,t.toggleClass=function(e,t,s){for(const i of(t||"").split(" "))i&&(s?e.classList.add(i):e.classList.remove(i))},t.removeNode=function(e){e.remove?e.remove():e.parentNode.removeChild(e)},t.removeNodesBetween=function(e,t,s=""){if(!(e&&t&&e!==t&&e.parentNode===t.parentNode&&e.nextSibling&&t.previousSibling))throw new Error(`removeNodesBetween argument error. odebug="${s}" startClasses="${i(e)}" endClasses="${i(t)}" !start="${!e}" !end="${!t}" (start===end)="${e===t}" !start?.parentNode="${!e?.parentNode}" (start?.parentNode!==end?.parentNode)="${e?.parentNode!==t?.parentNode}" (!start?.nextSibling)="${!e?.nextSibling}" (!end?.previousSibling)="${!t?.previousSibling}"`);const o=document.createRange();o.setStartAfter(e),o.setEndBefore(t),o.deleteContents()},t.isNodeType=o,t.insertHtmlBeforeNode=function(e,t){if(o(e,1))e.insertAdjacentHTML("beforebegin",t);else{n(e,s(t))}},t.insertNodeBeforeNode=n,t.getElementByIdInDocumentFragment=r,t.collectCommentNodes=function(e,t){const s=new Map;for(const i of e){a(r(t,i),s)}return a(t,s),s},t.ensureNoContent=function(e,t,s,i){if(!s&&t.commentStart.nextSibling!==t.commentEnd)throw new Error("Node is not empty, operation invalid.");e.ensureContentDisposed(t,i)},t.attachEventListener=function(e,t,s,i){e.addEventListener(s,i),t.registerForDispose((()=>e.removeEventListener(s,i)))},t.performanceNow=function(){return window.performance.now()},t.removeAllChildren=function(e){for(;e?.lastChild;)e.removeChild(e.lastChild)},t.wrapFunc=function(e,t,s){return function(...i){for(const e of t)e.call(this);const o=e.apply(this,i);if(s)for(const e of s)e.call(this);return o}},t.getUniqueCommentIdPair=function(){const e=""+l++;return{commentStartId:"_weave_cstart_"+e,commentEndId:"_weave_cend_"+e}},t.isCommentStartId=function(e){return c(e,"_weave_cstart_")},t.isCommentEndId=function(e){return c(e,"_weave_cend_")};let l=0;function c(e,t){return e.startsWith,e.startsWith(t)}})),
define("WeaveDOM/Core/DefaultInputBindings",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultInputBindings=void 0;t.defaultInputBindings=[{name:"textInput",metadata:{eventsToListen:["input","change"],writeValueToElement:(e,t)=>{const s=e;t=""+(t||""),s.value!==t&&(s.value=t)},collectDataFromEvent:e=>({value:e.target.value})}},{name:"checkboxInput",metadata:{eventsToListen:["change"],writeValueToElement:(e,t)=>{const s=e;t=!!t,s.checked!==t&&(s.checked=t)},collectDataFromEvent:e=>({checked:e.target.checked})}}]})),
define("WeaveDOM/Core/Sanitization",["require","exports"],(function(e,t){"use strict";function s(e){const t=new Set;for(const s of e)t.add(s);return t}Object.defineProperty(t,"__esModule",{value:!0}),t.arrayToSet=s,t.isSelfCloseTag=function(e){return"img"===e||"input"===e||"area"===e||"br"===e||"col"===e||"hr"===e||"source"===e||"track"===e||"wbr"===e},t.validateTagNameInSandboxMode=function(e){return n.has(e)},t.validateTagNameInDirectMode=function(e){return r.has(e)},t.ensureNotClass=function(e){if("class"===e)throw new Error("class attribute not supported.")},t.ensureAllowedAttribute=function(e,t){if(!function(e,t){switch(e){case"a":return p.has(t);case"area":return u.has(t);case"audio":return g.has(t);case"button":return h.has(t);case"blockquote":return f.has(t);case"canvas":return x.has(t);case"col":case"colgroup":return b.has(t);case"del":return y.has(t);case"details":case"dialog":return M.has(t);case"embed":return v.has(t);case"form":return w.has(t);case"input":return c.has(t);case"img":return S.has(t);case"ins":return I.has(t);case"iframe":return C.has(t);case"label":return P.has(t);case"map":return _.has(t);case"meter":return F.has(t);case"ol":return T.has(t);case"optgroup":return k.has(t);case"option":return E.has(t);case"output":return D.has(t);case"progress":return A.has(t);case"q":return B.has(t);case"source":return N.has(t);case"td":return R.has(t);case"textarea":return L.has(t);case"th":return z.has(t);case"time":return H.has(t);case"track":return O.has(t);case"video":return U.has(t);default:return l.has(t)}}(e,t))throw new Error(`Attribute ${t} is not allowed for tag ${e}.`)},t.sanitizeAttributeValue=function(e,t,s){if(s)switch(e){case"src":if(s.src)return s.src(t);break;case"href":if(s.href)return s.href(t)}return{valid:!0,value:t}};const i=["a","abbr","address","area","article","aside","audio","b","bdi","bdo","blockquote","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","header","hgroup","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","label","legend","li","main","map","mark","meter","nav","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","source","small","span","strong","sub","summary","sup","table","tbody","textarea","td","tfoot","th","thead","time","tr","track","u","ul","var","video","wbr"],o=i.concat(["iframe","svg","template"]),n=s(i),r=s(o),a=["aria-atomic","aria-autocomplete","aria-checked","aria-controls","aria-current","aria-describedby","aria-disabled","aria-expanded","aria-grabbed","aria-haspopup","aria-hidden","aria-invalid","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-owns","aria-orientation","aria-posinset","aria-pressed","aria-readonly","aria-required","aria-selected","aria-setsize","aria-valuemin","aria-valuemax","aria-valuenow","class","data-click-telemetry","datetime","dir","draggable","focusable","hidden","id","lang","spellcheck","role","style","tabindex","title","translate"],l=s(a),c=s(a.concat(["accept","autocomplete","autofocus","capture","disabled","form","list","max","maxlength","min","minlength","multiple","name","pattern","placeholder","readonly","required","size","step","type","value"])),d=a.concat(["download","href","hreflang","media","rel","target","type"]),p=s(d),u=s(d.concat("alt","coords","shape")),m=a.concat(["autoplay","controls","crossorigin","loop","muted","preload","src"]),g=s(m),h=s(a.concat("autofocus","disabled","form","formaction","formenctype","formmethod","formnovalidate","formtarget","name","type")),f=s(a.concat("cite")),x=s(a.concat("width","height")),b=s(a.concat("span")),y=s(a.concat("cite","datetime")),v=s(a.concat("height","src","width","type")),w=s(a.concat("accept-charset","action","autocomplete","enctype","method","name","novalidate","target")),M=s(a.concat("open")),C=s(a.concat("height","name","sandbox","scrolling","seamless","src","srcdoc","width")),S=s(a.concat("alt","crossorigin","height","ismap","src","width")),I=s(a.concat("cite","datetime")),P=s(a.concat("for","form")),_=s(a.concat("name")),F=s(a.concat("form","high","low","max","min","optimum","value")),T=s(a.concat("reversed","type","start")),k=s(a.concat("label","disabled")),E=s(a.concat("disabled","label","selected","value")),D=s(a.concat("for","form","name")),A=s(a.concat("max","value")),B=s(a.concat("cite")),N=s(a.concat("src","media","type")),R=s(a.concat("colspan","headers","rowspan")),L=s(a.concat("autofocus","cols","disabled","form","maxlength","minlength","name","placeholder","readonly","required","rows","wrap")),z=s(a.concat("abbr","colspan","headers","rowspan","scope")),H=s(a.concat("datetime")),O=s(a.concat("default","kind","label","src","srclang")),U=s(m.concat("height","poster","width"))})),
define("WeaveDOM/Core/DomOperatorBase",["require","exports","WeaveDOM/Core/InternalUtil","WeaveDOM/Core/Sanitization","Weave/Core/InputBindings","Weave/Core/InternalUtil","WeaveDOM/Core/DefaultInputBindings"],(function(e,t,s,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DirectDomAgent=void 0;const a=document.createElement("style");a.textContent=".weave-display-none1,.weave-display-none2{display:none !important}",document.head.appendChild(a);function l(e,t){e.hideCount+=t;const s=t>0;return s||0!==e.hideCount?s&&e.hideCount===t?3:1:2}t.DirectDomAgent=class{constructor(){this.inputBindingsMgr=new o.InputBindingsManager,this._textHiddenContentMap=new WeakMap,this._dynamicNodeDisplayStateMap=new WeakMap,this._inputBindingDefMap=(0,n.makeMap)(r.defaultInputBindings,(e=>e.name),(e=>e.metadata))}prepareInitInputBinding(e,t){return this.inputBindingsMgr.ensureNoInputBindingExists(e,t),this.ensureInputBindingMetadata(t)}ensureInputBindingMetadata(e){const t=this._inputBindingDefMap.get(e);if(!t)throw new Error(`Input binding "${e}" is not defined.`);return t}setAttribute(e,t,s,o,n){const r=e.getAndEnsureElementNode(s).element;if(!o.startsWith("data-")){(0,i.ensureAllowedAttribute)(r.tagName.toLowerCase(),o);const e=(0,i.sanitizeAttributeValue)(o,n,t);if(!e.valid)throw new Error(`Invalid attribute value for ${o}: ${n}`);n=e.value,(0,i.ensureNotClass)(o)}r.setAttribute(o,n)}removeAttribute(e,t,s){const o=e.getAndEnsureElementNode(t).element;s.startsWith("data-")||((0,i.ensureAllowedAttribute)(o.tagName.toLowerCase(),s),(0,i.ensureNotClass)(s)),o.removeAttribute(s)}toggleClass(e,t,i,o){const n=e.getAndEnsureElementNode(t).element;(0,s.toggleClass)(n,i,o)}setStyle(e,t,s,i){e.getAndEnsureElementNode(t).element.style[s]=i||""}clear(e,t){(0,s.removeNodesBetween)(e.commentStart,e.commentEnd,t)}remove(e,t){this.clear(e,t),(0,s.removeNode)(e.commentStart),(0,s.removeNode)(e.commentEnd)}toggleDisplay(e,t,s){const i=e.getAndEnsureDynamicNode(t);if("if"!==i.type)throw new Error(`Only If node supports "toggleDisplay", ${t}, ${i.type}`);s=!!s;const o=this._getOrCreateDynamicNodeDisplayState(i.commentStart,!1);if(o.visible===s)return;o.visible=s;const n=s?-1:1;this._applyDisplayState(n,l(o,n),i.commentStart.nextSibling,i.commentEnd)}setDisplayState(e,t){const s=this._dynamicNodeDisplayStateMap.get(e);s&&0!==s.hideCount&&this._applyDisplayState(s.hideCount,3,t.firstChild,null)}_applyDisplayState(e,t,i,o){if(null===i)return;const n=[t];let r=0,a=i;for(;a!==o;){if((0,s.isNodeType)(a,8))(0,s.isCommentStartId)(a.textContent)?n[++r]=l(this._getOrCreateDynamicNodeDisplayState(a,e<0),e):(0,s.isCommentEndId)(a.textContent)&&r--;else if((0,s.isNodeType)(a,1)){const e=n[r];1!==e&&(0,s.toggleClass)(a,"weave-display-none2",3===e)}else if((0,s.isNodeType)(a,3)){const e=n[r];2===e?a.textContent=this._textHiddenContentMap.get(a):3===e&&(this._textHiddenContentMap.set(a,a.textContent),a.textContent="")}a=a.nextSibling}}_getOrCreateDynamicNodeDisplayState(e,t){let s=this._dynamicNodeDisplayStateMap.get(e);if(!s){if(t)throw new Error(`DynamicNodeDisplayState doesn't exist, ${e.textContent}`);this._dynamicNodeDisplayStateMap.set(e,s={visible:!0,hideCount:0})}return s}}})),
define("WeaveDOM/DirectRender/AttributeHandler",["require","exports","Weave/Core/InternalUtil"],(function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onWheelHandler=t.onTouchStartHandler=t.onTouchMoveHandler=t.onTouchEndHandler=t.onTouchCancelHandler=t.onSelectHandler=t.onScrollHandler=t.onMouseUpHandler=t.onMouseOverHandler=t.onMouseOutHandler=t.onMouseMoveHandler=t.onMouseDownHandler=t.onFocusHandler=t.onDropHandler=t.onDragStartHandler=t.onDragOverHandler=t.onDragLeaveHandler=t.onDragExitHandler=t.onDragEnterHandler=t.onDragEndHandler=t.onDragHandler=t.onDoubleClickHandler=t.onBlurHandler=void 0,t.afterMountHandler=function(e,t){(0,s.isNotNullNorUndefined)(t)&&e.addDeferredBinding({handler:o,value:t})},t.onChangeHandler=function(e,t,s,o,n,r){const a=n.type;"input"===r&&"file"===a&&e.addBinding({handler:i,value:t})},t.onBlurHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("blur")),t.onDoubleClickHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("dblclick")),t.onDragHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("drag")),t.onDragEndHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("dragend")),t.onDragEnterHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("dragenter")),t.onDragExitHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("dragexit")),t.onDragLeaveHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("dragleave")),t.onDragOverHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("dragover")),t.onDragStartHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("dragstart")),t.onDropHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("drop")),t.onFocusHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("focus")),t.onMouseDownHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("mousedown")),t.onMouseMoveHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("mousemove")),t.onMouseOutHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("mouseout")),t.onMouseOverHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("mouseover")),t.onMouseUpHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("mouseup")),t.onScrollHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("scroll")),t.onSelectHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("select")),t.onTouchCancelHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("touchcancel")),t.onTouchEndHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("touchend")),t.onTouchMoveHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("touchmove")),t.onTouchStartHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("touchstart")),t.onWheelHandler=(0,s.generateBindOnlyAttributeHandler)((0,s.makeEventHandler)("wheel"));const i=(0,s.makeEventHandler)("change");function o(e,t,s){const i=e.getElementMetadata(t);s(i.element,i.ltm.innerLtmRoot)}})),
define("WeaveDOM/DirectRender/Common",["require","exports","WeaveDOM/Core/InternalUtil","Weave/Core/InternalUtil"],(function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createHTMLNode=t.createTextNode=t.markParentActive=t.markInactive=t.markAttributeSealed=t.markSealed=t.ensureActive=t.ensureNotAttributeSealed=t.ensureNotSealed=void 0;t.createTextNode=function(e){return this.collectors.htmlCollector.push((0,i.encodeHtml)(e)),this};t.createHTMLNode=function(e){return this.collectors.htmlCollector.push(this.getHtmlString(e)),this}})),
define("WeaveDOM/DirectRender/DataAttribute",["require","exports","Weave/Core/InternalUtil"],(function(e,t,s){"use strict";function i(e){return o.get(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.dataHandler=void 0,t.getElementData=i,t.dataHandler=(0,s.generateBindOnlyAttributeHandler)(((e,t,s)=>{o.set(e.getElementMetadata(t).element,s)}));const o=new WeakMap;(window.weaveDebug||(window.weaveDebug={})).getElementData=i})),
define("WeaveDOM/DirectRender/ForEachNodeOperations",["require","exports","WeaveDOM/Core/InternalUtil"],(function(e,t,s){"use strict";function i(e,t,o,n,r,a,l,c){if(o>=0){const d=r[o];return a(d)?function(e,t,s,o,n,r,a,l){const c=s;for(;s>=0&&r(n[s]);)--s;if(s!==c){const e=c-s,i=t(n.slice(s+1,c+1),o);for(let t=0;t<e;++t)a[t+s+1]=i[t];l.created+=e}return i(e,t,s,o,n,r,a,l)}(e,t,o,n,r,a,l,c):e(d).commentEnd===n?function(e,t,s,o,n,r,a,l){const c=s;for(;s>=0;){const t=n[s];if(!r(t)){const i=e(t);if(i.commentEnd===o){o=i.commentStart.previousSibling,--s;continue}}break}return l.skipped+=c-s,i(e,t,s,o,n,r,a,l)}(e,t,o,n,r,a,l,c):function(e,t,o,n,r,a,l,c){const d=o;for(;o>=0&&!a(r[o])&&e(r[o]).commentEnd!==n;)--o;if(o!==d){const t=document.createDocumentFragment();for(let s=o+1;s<=d;++s){const i=e(r[s]);let o=i.commentStart;const n=i.commentEnd.nextSibling;for(;o!==n;){const e=o.nextSibling;t.appendChild(o),o=e}}(0,s.insertNodeBeforeNode)(n.nextSibling,t),c.moved+=d-o}return i(e,t,o,n,r,a,l,c)}(e,t,o,n,r,a,l,c)}return n.nextSibling}Object.defineProperty(t,"__esModule",{value:!0}),t.processForEachItems=function(e,t,o,n,r,a,l){const c=n.map((e=>r(e)?null:a(e))),d=document.activeElement,p=i(e,t,n.length-1,o.commentEnd.previousSibling,n,r,c,l);(0,s.removeNodesBetween)(o.commentStart,p),document.activeElement!==d&&d.focus();return c}})),
define("WeaveDOM/DirectRender/NodeEditors",["require","exports","WeaveDOM/DirectRender/Common","WeaveDOM/Core/InternalUtil","WeaveDOM/Core/Sanitization","Weave/Core/InternalUtil","Weave/Core/WeaveUtil"],(function(e,t,s,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createChildElementNode=t.createChildDynamicNode=t.ignoreDebugInfo=void 0;let a=function(e){this.state|=8;const t=(0,n.getUniqueDynamicNodeId)(),{commentStartId:o,commentEndId:d}=(0,i.getUniqueCommentIdPair)(),{selfLtm:p,contentLtm:u}=(0,n.createDynamicNodeLtms)(e.type,this.ltm);return this.collectors.dynamicBindingCollector.push({commentStartId:o,commentEndId:d,dynamicNodeId:t,initContentLtm:u,metadata:e,selfLtm:p}),this.collectors.htmlCollector.push("\x3c!--",o,"--\x3e"),{attributeSanitizer:this.attributeSanitizer,collectors:this.collectors,commentEndId:d,getHtmlString:this.getHtmlString,ltm:u||p,nodeId:t,nodeType:e.type,parentEditor:this,state:1,createChildDynamicNode:a,createChildElementNode:l,createChildVirtualNode:r.returnThis,createHTMLNode:s.createHTMLNode,createTextNode:s.createTextNode,seal:c}};t.createChildDynamicNode=a;let l=function(e){return this.collectors.htmlCollector.push("<",e),{attributeSanitizer:this.attributeSanitizer,collectors:this.collectors,elementBinders:void 0,elementDeferredBinders:void 0,elementId:"",debugInfo:void 0,getHtmlString:this.getHtmlString,idAttrPlaceHolderIndex:-1,ltm:this.ltm,parentEditor:this,state:1,tagName:e,addAttribute:h,addBinding:f,addDebugInfo:b,addDeferredBinding:x,seal:g,sealAttributes:d}};t.createChildElementNode=l;let c=function(){this.collectors.htmlCollector.push("\x3c!--",this.commentEndId,"--\x3e")},d=function(){const e=this.collectors.htmlCollector;if(this.elementBinders||this.elementDeferredBinders){let t=this.elementId;t||(this.elementId=t=(0,n.getUniqueElementId)(),e.push(' id="',t,'"')),this.collectors.elementBindingCollector.push({elementId:t,binders:this.elementBinders,deferredBinders:this.elementDeferredBinders,ltm:this.ltm})}else this.elementId||(this.idAttrPlaceHolderIndex=e.length,e.push(""));return(0,o.isSelfCloseTag)(this.tagName)?(e.push("/>"),{attributeSanitizer:void 0,collectors:void 0,commentEndId:void 0,getHtmlString:void 0,ltm:void 0,nodeId:void 0,nodeType:void 0,parentEditor:this,state:1,createChildDynamicNode:p,createChildElementNode:p,createChildVirtualNode:r.returnThis,createHTMLNode:p,createTextNode:p,seal:u}):(e.push(">"),{attributeSanitizer:this.attributeSanitizer,collectors:this.collectors,commentEndId:void 0,getHtmlString:this.getHtmlString,ltm:this.ltm,nodeId:void 0,nodeType:void 0,parentEditor:this,state:1,createChildDynamicNode:a,createChildElementNode:l,createChildVirtualNode:r.returnThis,createHTMLNode:s.createHTMLNode,createTextNode:s.createTextNode,seal:m})};function p(){throw new Error("Operation is not supported for self-close element.")}let u=r.noop,m=function(){if(8&this.state){const e=this.parentEditor;let t=e.elementId;t||(t=e.elementId=(0,n.getUniqueElementId)(),this.collectors.htmlCollector[e.idAttrPlaceHolderIndex]=` id="${t}"`),this.collectors.commentContainerCollector.push(t)}},g=function(){(0,o.isSelfCloseTag)(this.tagName)||this.collectors.htmlCollector.push("</",this.tagName,">")},h=function(e,t){const s=(0,o.sanitizeAttributeValue)(e,t,this.attributeSanitizer);return s.valid?this.collectors.htmlCollector.push(" ",e,'="',(0,n.encodeHtml)(s.value),'"'):console.warn(`Invalid attribute value will be ignored: ${e}, ${t}`),this},f=function(e){return this.elementBinders?this.elementBinders.push(e):this.elementBinders=[e],this},x=function(e){return this.elementDeferredBinders?this.elementDeferredBinders.push(e):this.elementDeferredBinders=[e],this},b=function(e){throw new Error("addDebugInfo not supported in prod mode.")}})),
define("WeaveDOM/DirectRender/RenderAgent",["require","exports","Weave/Core/RenderAgentBase","WeaveDOM/Core/InternalUtil","WeaveDOM/DirectRender/Common","WeaveDOM/DirectRender/NodeEditors","Weave/Core/ApplyBindings","WeaveDOM/DirectRender/ForEachNodeOperations","WeaveDOM/Core/Sanitization","Weave/Core/CollectRenderInfo","WeaveDOM/DirectRender/AttributeHandler","Weave/Core/InternalUtil","Weave/Core/WeaveUtil","WeaveDOM/Core/DomOperatorBase","WeaveDOM/DirectRender/DataAttribute","Weave/Core/AttributeHandler","Weave/Core/InternalUtil"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DirectModeRenderEngine=void 0;let x=u.noop;class b extends s.RenderAgentBase{constructor(e){super(function(e){const t=(0,f.makeMap)(I.concat(e.customAttributeHandlers||[]),(e=>e.name),(e=>e.handler),!1);return(e,s,i,o,n,r,a)=>{const l=t.get(s);l?l(e,i,o,n,r,a):(0,h.htmlAttributeHandler)(e,s,i,0)}}(e),void 0,e.customEventDataProvider),this._options=e,this._domAgent=new m.DirectDomAgent,this._attributeSanitizer=this._options.attributeSanitizer,this._getHtmlString=this._options.htmlElementDataSerializer,this.thisInstance=this;const t=e?.weaveNode?.["data-odebug"]||"";let s;this.render(this._memoryManager.outerLtmRoot,void 0,e.weaveNode,(0,c.createInternalWeaveContext)({...e.weaveContext}),new p.AggregationRelay(e.aggregators,{}),e.afterMount,(e=>{const o=e.containerDoc;this.applyCssChanges();const n=this._options.rootElement;if("replace"===this._options.renderKind)(0,i.removeAllChildren)(n),n.appendChild(o),s=()=>(0,i.removeAllChildren)(n);else{const e=P++,r=document.createComment(`tsx_vroot_${e}_start`),a=document.createComment(`tsx_vroot_${e}_end`);n.appendChild(r),n.appendChild(a),(0,i.insertNodeBeforeNode)(a,o),s=()=>{(0,i.removeNodesBetween)(r,a,t),(0,i.removeNode)(r),(0,i.removeNode)(a)}}})),this._cleanup=s}buildNodeLookup(e){const{elementBindings:t,dynamicBindings:s,containerDoc:o,commentLookup:n}=e;for(const e of t)this._memoryManager.setElementNode({nodeId:e.elementId,ltm:e.ltm,element:(0,i.getElementByIdInDocumentFragment)(o,e.elementId)});for(const e of s){const t=e.metadata;this._memoryManager.setDynamicNode({nodeId:e.dynamicNodeId,type:t.type,commentStart:n.get(e.commentStartId),commentEnd:n.get(e.commentEndId),contentLtm:e.initContentLtm,selfLtm:e.selfLtm,itemNodesId:"forEach"===t.type?t.initRenderDomInfo.map(v):void 0})}}applyCssChanges(){const e=[],t=[];this._cssMetadataMap.forEach(((s,i)=>{0===s.oldRefCount&&s.newRefCount>0?e.push(i):s.oldRefCount>0&&0===s.oldRefCount&&t.push(i),s.oldRefCount=s.newRefCount})),(e.length||t.length)&&this._options.cssLoader(e,t)}clearVisualState(e,t){this._domAgent.clear(e,t)}createCollector(e,t){let s,i;return{attributeSanitizer:this._attributeSanitizer,collectors:{commentContainerCollector:[],dynamicBindingCollector:[],dynamicDebugInfoCollector:s,elementBindingCollector:[],elementDebugInfoCollector:i,htmlCollector:[]},commentEndId:void 0,getHtmlString:this._getHtmlString,ltm:e,nodeId:void 0,nodeType:void 0,parentEditor:void 0,state:1,createChildDynamicNode:n.createChildDynamicNode,createChildElementNode:n.createChildElementNode,createChildVirtualNode:u.returnThis,createHTMLNode:o.createHTMLNode,createTextNode:o.createTextNode,seal:x}}clearLogicalState(e,t,s){(0,i.ensureNoContent)(this._memoryManager,e,s,this._ltmRemovalCallback)}removeVisualState(e,t){this._domAgent.remove(e,t)}sealCollector(e){e.seal();const t=e.collectors,s=t.htmlCollector.join(""),o=(0,i.documentFragmentFromHtml)(s);return{commentLookup:(0,i.collectCommentNodes)(t.commentContainerCollector,o),containerDoc:o,dynamicBindings:t.dynamicBindingCollector,dynamicDebugInfos:t.dynamicDebugInfoCollector,elementBindings:t.elementBindingCollector,elementDebugInfos:t.elementDebugInfoCollector,ltm:e.ltm}}setContent(e,t,s){const o=s.commentStart,n=s.commentEnd;if(o.nextSibling!==n)throw new Error("The next sibling of start node is not end node.");this._domAgent.setDisplayState(o,e.containerDoc),(0,i.insertNodeBeforeNode)(n,e.containerDoc)}setAttribute(e,t,s){this._domAgent.setAttribute(this._memoryManager,this._attributeSanitizer,e,t,s)}removeAttribute(e,t){this._domAgent.removeAttribute(this._memoryManager,e,t)}toggleClass(e,t,s){this._domAgent.toggleClass(this._memoryManager,e,t,s)}setStyle(e,t,s){this._domAgent.setStyle(this._memoryManager,e,t,s)}toggleDisplay(e,t){this._domAgent.toggleDisplay(this._memoryManager,e.dynamicNodeId,t)}dispose(){super.dispose(),this._cleanup()}addEventListener(e,t){const{eventName:s,eventHandler:o}=t;if("input"===s)throw new Error(`${s} is not allowed through this API: addEventListener`);const n=this._memoryManager.getAndEnsureElementNode(e),r=n.ltm.innerLtmRoot;(0,i.attachEventListener)(n.element,r,s,(e=>{o(this._makeFullEventData(e,s,r,(0,p.getEventData)(e,s)))}))}setItems(e,t,s,i,o){const n=this._memoryManager.getAndEnsureDynamicNode(e);(0,p.ensureDynamicNodeOperation)(n.type,8);const r=n.itemNodesId,d=(0,l.arrayToSet)(r);for(const e of s)if("exist"===e.type){const t=e.metadata.itemId;if(!d.delete(t))throw new Error(`The ForEachItem node ${t} doesn't exists, state tracking is lost.`)}d.forEach((e=>{this.removeLogicalState(e,t)}));const u={created:0,deleted:0,skipped:0,moved:0},m=(0,a.processForEachItems)((e=>this.getDynamicNodeMetadata(e.metadata.itemId)),((e,s)=>{const r=this.createCollector(n.selfLtm,t),a=(0,c.collectForEachItemsRenderInfo)({aggregators:o.aggregators,attributesHandler:this._handleAttribute,cssMetadataMap:this._cssMetadataMap,hooksState:void 0},t,r,e.map(w),i,o),l=this.sealCollector(r);return this.applyCssChanges(),this._domAgent.setDisplayState(n.commentStart,l.containerDoc),this._renderBetweenNodes(l,s,s.nextSibling),a}),n,s,M,C,u);return u.deleted=r.length-(m.length-u.created),n.itemNodesId=m.map(S),m}getDynamicNodeMetadata(e){return this._memoryManager.getAndEnsureDynamicNode(e)}focus(e,t){const s=this._options.rootElement.getElementsByClassName(y(e))[t];s&&document.activeElement!==s&&s.focus()}setLocatorClass(e,t){this._domAgent.toggleClass(this._memoryManager,e,y(t),!0)}initTwoWayInputBinding(e,t,s){const o=this._memoryManager.getAndEnsureElementNode(e),n=this._domAgent.prepareInitInputBinding(o,t);this._domAgent.inputBindingsMgr.createInputBinding(o,{type:"twoWay",name:t});const r=o.element,a=o.ltm.innerLtmRoot;for(const e of n.eventsToListen)(0,i.attachEventListener)(r,a,e,(e=>{n.writeValueToElement(r,s(this._makeFullEventData(e,t,a,n.collectDataFromEvent(e))))}))}initValuePushInputBinding(e,t){const s=this._memoryManager.getAndEnsureElementNode(e),o=this._domAgent.prepareInitInputBinding(s,t),n={type:"valuePush",name:t,lastReceivedValue:void 0};this._domAgent.inputBindingsMgr.createInputBinding(s,n);const r=s.element,a=s.ltm.innerLtmRoot;for(const e of o.eventsToListen)(0,i.attachEventListener)(r,a,e,(()=>{o.writeValueToElement(r,n.lastReceivedValue)}))}initValueSubscribeInputBinding(e,t,s){const o=this._memoryManager.getAndEnsureElementNode(e),n=this._domAgent.prepareInitInputBinding(o,t);this._domAgent.inputBindingsMgr.createInputBinding(o,{type:"valueSubscribe",name:t});const r=o.element,a=o.ltm.innerLtmRoot;for(const e of n.eventsToListen)(0,i.attachEventListener)(r,a,e,(e=>{s(this._makeFullEventData(e,t,a,n.collectDataFromEvent(e)))}))}pushInputValue(e,t,s){const i=this._memoryManager.getAndEnsureElementNode(e),o=this._domAgent.inputBindingsMgr.resolveInputBinding(i,t,["twoWay","valuePush"]),n=this._domAgent.ensureInputBindingMetadata(t);"valuePush"===o.type&&(o.lastReceivedValue=s),n.writeValueToElement(i.element,s)}_makeFullEventData(e,t,s,i){return{...i,event:e,ltm:s,...this._customEventDataProvider(t)}}_renderBetweenNodes(e,t,s){const o=e.containerDoc;if(this.buildNodeLookup(e),t.nextSibling!==s)throw new Error("The next sibling of start node is not end node.");(0,i.insertNodeBeforeNode)(s,o),(0,r.applyBindings)(this,e.elementBindings,e.dynamicBindings)}}function y(e){return`_wv_locator_${e}`}function v(e){return e.itemId}function w(e){return e.weaveNode}function M(e){return"new"===e.type}function C(e){return e.metadata}function S(e){return e.itemId}t.DirectModeRenderEngine=b;const I=[{name:"afterMount",handler:d.afterMountHandler},{name:"autoplay",handler:h.autoplayHandler},{name:"checked",handler:h.checkedHandler},{name:"className",handler:h.classNameHandler},{name:"controls",handler:h.controlsHandler},{name:"coords",handler:h.coordsHandler},{name:"data",handler:g.dataHandler},{name:"disabled",handler:h.disabledHandler},{name:"id",handler:h.idHandler},{name:"loop",handler:h.loopHandler},{name:"muted",handler:h.mutedHandler},{name:"autofocus",handler:h.autofocusHandler},{name:"formnovalidate",handler:h.formnovalidateHandler},{name:"hidden",handler:h.hiddenHandler},{name:"open",handler:h.openHandler},{name:"novalidate",handler:h.novalidateHandler},{name:"seamless",handler:h.seamlessHandler},{name:"ismap",handler:h.ismapHandler},{name:"required",handler:h.requiredHandler},{name:"onBlur",handler:d.onBlurHandler},{name:"onChange",handler:d.onChangeHandler},{name:"onValueChange",handler:h.onValueChangeHandler},{name:"onCheckedChange",handler:h.onCheckedChangeHandler},{name:"onClick",handler:h.onClickHandler},{name:"onDoubleClick",handler:d.onDoubleClickHandler},{name:"onDrag",handler:d.onDragHandler},{name:"onDragEnd",handler:d.onDragEndHandler},{name:"onDragEnter",handler:d.onDragEnterHandler},{name:"onDragExit",handler:d.onDragExitHandler},{name:"onDragLeave",handler:d.onDragLeaveHandler},{name:"onDragOver",handler:d.onDragOverHandler},{name:"onDragStart",handler:d.onDragStartHandler},{name:"onDrop",handler:d.onDropHandler},{name:"onFocus",handler:d.onFocusHandler},{name:"onFocusIn",handler:h.onFocusInHandler},{name:"onFocusOut",handler:h.onFocusOutHandler},{name:"onKeyDown",handler:h.onKeyDownHandler},{name:"onKeyPress",handler:h.onKeyPressHandler},{name:"onKeyUp",handler:h.onKeyUpHandler},{name:"onMouseDown",handler:d.onMouseDownHandler},{name:"onMouseEnter",handler:h.onMouseEnterHandler},{name:"onMouseLeave",handler:h.onMouseLeaveHandler},{name:"onMouseMove",handler:d.onMouseMoveHandler},{name:"onMouseOut",handler:d.onMouseOutHandler},{name:"onMouseOver",handler:d.onMouseOverHandler},{name:"onMouseUp",handler:d.onMouseUpHandler},{name:"onScroll",handler:d.onScrollHandler},{name:"onSelect",handler:d.onSelectHandler},{name:"onTouchCancel",handler:d.onTouchCancelHandler},{name:"onTouchEnd",handler:d.onTouchEndHandler},{name:"onTouchMove",handler:d.onTouchMoveHandler},{name:"onTouchStart",handler:d.onTouchStartHandler},{name:"onWheel",handler:d.onWheelHandler},{name:"readonly",handler:h.readonlyHandler},{name:"ref",handler:h.refHandler},{name:"style",handler:h.styleHandler},{name:"value",handler:h.valueHandler},{name:"visible",handler:h.visibleHandler},{name:"reversed",handler:h.reversedHandler},{name:"default",handler:h.defaultHandler},{name:"multiple",handler:h.multipleHandler}];let P=0})),
define("MsPortalImpl/Weave/DirectRender",["require","exports","MsPortalImpl/Weave/Util","MsPortalImpl/Weave/InternalUtil","WeaveDOM/DirectRender/RenderAgent","MsPortalImpl/Base/Base.KnockoutExtensions.Image","Viva.Controls/Util/Viva.Resize","MsPortalImpl/Weave/SandboxDomAgents/EntryPoint","Weave/Core/InternalUtil","FxInternal/Weave/Util","FxInternal/Weave","FxInternal/Weave/Aggregators","FxInternal/Css","MsPortalImpl/Base/Base.Timers","Weave/Core/ClassNameProcessor","WeaveDOM/Core/InternalUtil"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h){"use strict";function f(t,s){const{weaveContext:n,element:r,ltm:c}=t,d=new o.DirectModeRenderEngine({afterMount:t.afterMount,aggregators:p.aggregators,attributeSanitizer:{href:t=>(0,i.sanitizeHref)(t,{diContainer:n.diContainer,windowContext:r,localRequire:e}),src:i.sanitizeSrc},cssLoader:t.cssLoader||(e=>(0,u.injectCss)(...e||[])),customAttributeHandlers:[{name:"fxclick",handler:b},{name:"image",handler:x},{name:"onResize",handler:v},{name:"domAgent",handler:(0,l.generateDeferredBindOnlyAttributeHandler)((function(e,t,s){const{element:i,ltm:o}=e.getElementMetadata(t);(0,a.attachSandboxDomAgent)(i,o.innerLtmRoot,n.diContainer,s)}))},{name:"pcControl",handler:M},{name:"onClick",handler:S},I("onKeyDown","keydown"),I("onKeyPress","keypress"),I("onKeyUp","keyup")],customEventDataProvider:()=>({requestConfirm:w}),htmlElementDataSerializer:(0,i.makeHtmlDataHandler)(r,n.diContainer,!0),renderKind:s,rootElement:r,weaveNode:t.weaveNode,weaveContext:n});c.registerForDispose(d)}t.appendToElement=function(e){return f(e,"append")},t.applyToElement=function(e){let t=e.weaveNode;(0,c.isWeaveNodeWithParentRenderInfo)(t)&&(!function(e,t,s){if(!t.isDisposed()&&s.parentClassName){const i=(0,g.processClassName)(s.parentClassName,t);(0,h.toggleClass)(e,i.initClass,!0);const o=(0,g.applyClassBindingMetadata)(i,t,((t,s)=>(0,h.toggleClass)(e,t,s)));t.registerForDispose((()=>{for(const t of o())(0,h.toggleClass)(e,t,!1)}))}}(e.element,e.ltm,t),t=t.weaveNode);return f({...e,weaveNode:t},"replace")};const x=(0,l.generateDeferredBindOnlyAttributeHandler)((function(e,t,s){const i=e.getElementMetadata(t).element;(0,l.activateAndRun)(e,t,s,(e=>{(0,n.renderImage)(i,e)}))}));function b(e,t,s){MsPortalFx.isNullOrUndefined(t)||e.addBinding({handler:y,value:{data:t,context:s}})}function y(e,t,s){const o=e.getElementMetadata(t),n=o.ltm.innerLtmRoot;(0,i.applyFxClickToElement)(o.element,n,(0,c.valueOrComputationToValueOrObservable)(n,s.data),{diContainer:s.context.diContainer,disabled:(0,d.toObservable)(n,s.context.disabled),tabIndex:(0,d.toObservable)(n,s.context.tabIndex)})}const v=(0,l.generateDeferredBindOnlyAttributeHandler)((function(e,t,s){const i=e.getElementMetadata(t),o=e.getElementNodeLtm(t);(0,m.requestAnimationFrame)((()=>{o.isDisposed()||(0,r.track)(o.createChildLifetime(),$(i.element).first(),((e,t)=>{(e>0||t>0)&&s({ltm:o,height:t,width:e})}),{notifyInitialSize:!0,partialPixels:!0})}))}));function w(e){return new Promise((t=>{t(window.confirm(e)?"ok":"cancel")}))}function M(e,t,s){MsPortalFx.isNullOrUndefined(t)||(e.addAttribute("data-bind","pcControl: __control_vm__"),e.addDeferredBinding({handler:C,value:{vm:t,context:s}}))}function C(e,t,i){const{element:o,ltm:n}=e.getElementMetadata(t),{vm:r,context:a}=i,l=(0,s.weaveContextToKoContext)(a,n.innerLtmRoot,{__control_vm__:r});ko.applyBindings(l,o),n.innerLtmRoot.registerForDispose((()=>ko.cleanNode(o)))}const S=(0,l.generateBindOnlyAttributeHandler)((function(e,t,s){const{eventHandler:i,stopPropagation:o,preventDefault:n}="function"==typeof s?{eventHandler:s,stopPropagation:!1,preventDefault:!1}:{eventHandler:s.handler,stopPropagation:s.stopPropagation,preventDefault:s.preventDefault};e.addEventListener(t,{eventName:"click",eventHandler:e=>{o&&e.event.stopPropagation(),n&&e.event.preventDefault(),i(e)}})}));function I(e,t){return{name:e,handler:(0,l.generateBindOnlyAttributeHandler)(((e,s,o)=>{const{eventHandler:n,stopPropagation:r,preventDefault:a}="function"==typeof o?{eventHandler:o,stopPropagation:void 0,preventDefault:void 0}:{eventHandler:o.handler,stopPropagation:o.stopPropagation,preventDefault:o.preventDefault};e.addEventListener(s,{eventName:t,eventHandler:e=>{(0,i.matchKeyCode)(r,e.keyCode)&&e.event.stopPropagation(),(0,i.matchKeyCode)(a,e.keyCode)&&e.event.preventDefault(),n(e)}})}))}}})),
define("_generated/MsPortalImpl/Svg/Startup/Warning.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=9,t.data="<svg viewBox='0 0 9 9' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path fill='#db7500' d='M8.267 8H.733c-.6 0-.916-.623-.62-1.129L2.014 3.53 3.896.384c.302-.507.903-.514 1.197-.008L7.001 3.65l1.882 3.229C9.183 7.383 8.881 8 8.267 8z'/><circle cx='4.5' cy='6.178' r='.615' class='msportalfx-svg-c01'/><path d='M4.623 2.428H3.98l.164 2.85h.774l.165-2.85z' class='msportalfx-svg-c01'/></g></svg>"})),
define("MsPortalImpl/Widgets/Widgets.Common",["require","exports","Fx/DependencyInjection","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.SvgHelper","_generated/MsPortalImpl/Svg/Startup/Warning.svg","MsPortalImpl/Weave/DirectRender","FxInternal/Weave","Fx","FxInternal"],(function(e,t,s,i,o,n,r,a,l,c,d){"use strict";t.cancelBindings=function(e){e&&$.contains(m.document.documentElement,e)&&b.filter((t=>{const s=t.element;return e===s||$.contains(e,s)})).forEach((e=>{MsPortalFx.remove(b,e),e&&e.dispose()}))},t.getAsyncBindingHandler=function(e,t){return t=t||{controlsDescendantBindings:!0},{init:function(e,s,i,o,n){return t},update:function(t,o,n,r,p){const g=ko.unwrap(o());ko.ignoreDependencies((()=>{let o;const n=Q(d.tryImmediateResolve(MsPortalFx.require(e),(n=>{if(!o)return function(e,t,o,n,r){const c=$(o),d=i.getWidget(c);null!==d&&d.dispose();if(n){let i;h&&(i=MsPortalFx.getUniqueId(),m.performance.mark(`${i}_start`));const d=e.$dicontainer||s.container,p=t.WidgetUIState&&new t.WidgetUIState({diContainer:d,vm:n,sanitizationContext:o});let u,g;if(t.InnerTsxComponent||t.tryWeaveInnerContent){let s;t.InnerTsxComponent?(u=new FxImpl.TriggerableLifetimeManager,s=t.InnerTsxComponent({state:p,vm:n})):(s=t.tryWeaveInnerContent({state:p,vm:n}),void 0!==s&&(u=new FxImpl.TriggerableLifetimeManager));const i=(0,l.toComputation)(e.$disabled),m=(0,l.toComputation)(e.$enabledTabIndex),h=(0,l.toComputation)(e.$tabIndex);u&&(0,a.applyToElement)({element:o,ltm:u,weaveNode:s,weaveContext:{disabled:i,tabIndex:h,diContainer:d,partName:e.$partName,extensionName:e.$extensionName,koContext:e},opName:`control_${r}`,afterMount:t.Widget?()=>{g=new t.Widget(c,n,{weaveContext:{disabled:i,enabledTabIndex:m,tabIndex:h,diContainer:d},diContainer:d},p),g.ltm.registerForDispose(u)}:void 0})}if(!g&&t.Widget&&(g=new t.Widget(c,n,{bindingContext:e,diContainer:d},p)),h&&(m.performance.mark(`${i}_end`),m.performance.measure(r,`${i}_start`,`${i}_end`)),g){const e=g;if(e.awaitContentRevealed)return e.awaitContentRevealed()}}}(p,n,t,g,e)}),(s=>{if(!o&&!MsPortalFx.Errors.isInstanceOfErrorType(s,u.CanceledError))return function(e,t,s){if(u.isInstanceOfErrorType(e,u.CanceledError))return;let i,o;e&&(i=e.message||MsPortalFx.getLogFriendlyMessage(e),o=e.stack);let n=`Failed to load the control module '${s}'.`;i&&(n+=`\r\n Error: ${i}`);x.error(n,1);const r=$(t);r.html(f),c.nextTick((()=>{r.trigger("fxportalcontrolloadfailed",new MsPortalFx.Errors.Error({message:n,stack:o,innerErrors:e,data:e&&e.data}))}))}(s,t,e),Promise.reject(s)})));if(!n.isFulfilled()){const e=()=>{MsPortalFx.remove(b,i,-1),y.delete(t),o&&MsPortalFx.remove(v,i,-1)},s=()=>{o=!0,e()};ko.utils.domNodeDisposal.addDisposeCallback(t,s);const i={element:t,promise:n,dispose:s};n.isPending()&&(b.push(i),y.set(t,i)),i.promise=n.catch((e=>(v.push(i),Promise.reject(e)))).finally(e)}}))}}},t.getCssScope=function(e){const t=e.closest(".fxs-part-content");if(!t[0])return"";return t[0].className.split(" ").filter((e=>e&&e.startsWith("css-scope-"))).join(" ")},t.getStringFromHtmlContent=function(e,t,s){let i,o="";M(t)?i=t.htmlTemplate:o=t;i&&(o=$($.parseHTML(i,g)).text());return o},t.isElementFullyInViewport=function(e,t=0,s=!1){const i=e.getBoundingClientRect(),o=document.documentElement;let n=!0;if(!s){const e=m.innerWidth||o.clientWidth;n=i.left>=0&&i.right<=e}const r=m.innerHeight||o.clientHeight,a=i.top+t>=0&&i.bottom+t<=r;return{elementRect:i,fullyVisible:a&&n}},t.isHtmlContent=M,t.isLink=function(e){return!!e&&e.hasOwnProperty("uri")},t.registerKoTemplate=function(e,t){if(!e||!t)return void x.error(`Cannot register a template with an undefined ${e?"content":"name"}.`);if(!/^[a-z][a-z0-9]*$/i.test(e))return void x.error(`Name '${e}' is invalid. Name must start with a letter and can only contain letters and numbers.`);const s=$(m.document.body);if(s.find("#"+e).length)return void x.error(`A template with name '${e}' was already registered.`);const i=$(FxImpl.createElement("script",{id:e,type:"text/html"})).text(t);s.append(i)},t.waitForBindings=function(e){if(!e)return Promise.reject(FxImpl.createError("container is "+e));if(!$.contains(m.document.documentElement,e))return Promise.reject(new MsPortalFx.Errors.CanceledError("container is not in documentElement"));return w(e)},t.waitForReactElement=function e(t,s){const i=t.querySelector(s);if(i)return Promise.resolve($(i));return new Promise((i=>{const o=new MutationObserver((()=>{o.disconnect(),e(t,s).then(i)}));o.observe(t,{childList:!0,subtree:!0})}))};var p=MsPortalFx.Base.Diagnostics,u=MsPortalFx.Errors;const m=window,g=m.document.implementation.createHTMLDocument(""),h=FxImpl.features.isNativePerf,f="<span class='fxs-portal-controlloadfailed'>"+n.getSvgReferenceOrFallBackToData(r).outerHTML+MsPortalFx.encodeHtml(o.PartError.title)+"</span>",x=p.createLog(e),b=[],y=new Map,v=[];function w(e){const t=MsPortalFx.find(v,(function(t){const s=t.element;return e===s||$.contains(e,s)}));if(t)return t.promise;const s=y.get(e)||MsPortalFx.find(b,(t=>$.contains(e,t.element)));return s?s.promise.then((()=>w(e))):Promise.resolve()}function M(e){return e&&e.hasOwnProperty("htmlTemplate")}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css",["module"],(function(e){"use strict";return{css:'.fxs-avatarmenu{flex:0 0 auto;box-sizing:border-box}.fxs-avatarmenu-header{position:relative;display:flex;align-items:center;height:40px}.fxs-avatarmenu-username{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:14px;line-height:normal;max-width:160px}.fxs-avatarmenu-tenant{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:600;font-size:10px;line-height:normal;text-transform:uppercase;max-width:160px}.fxs-avatarmenu-tenant-container{text-align:right;flex:1 1 auto;padding-left:20px}.fxs-avatarmenu-imageonly .fxs-dropmenu-button .fxs-avatarmenu-tenant-container{display:none}.fxs-avatarmenu-dropdown{width:220px;max-height:calc(100vh - 40px);overflow-x:hidden;overflow-y:auto}.fxs-avatarmenu-tenant-image-container{height:28px;width:28px;flex:0 0 auto;padding-left:6px;padding-right:6px;box-sizing:content-box}.fxs-avatarmenu-tenant-image{height:28px;width:28px;border:0;border-radius:28px}.fxs-avatarmenu-tenant-image-overlay{height:14px;width:14px;position:absolute;right:4px;bottom:4px;border-radius:10000px;background-color:var(--topbarBackground)}.fxs-avatarmenu-dropdown-item{display:flex}.fxs-avatarmenu-scrollviewer{max-height:505px;overflow:auto}html[lang^="ja"] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant,html[lang^="ko"] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant,html[lang^="zh"] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant{font-size:11px}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css",["module"],(function(e){"use strict";return{css:".fxs-contextMenu{display:none;position:fixed;width:192px;z-index:200;max-height:100vh;overflow-x:hidden;overflow-y:auto;border-style:solid;border-width:1px}.fxs-contextMenu:focus{outline:0}.fxs-contextMenu.fxs-contextMenu-active{display:block}.fxs-contextMenu-item{display:flex;align-items:center;padding:8px;box-sizing:border-box;font-size:13px;line-height:normal;cursor:pointer}.fxs-contextMenu-text{flex:1 1 auto;margin-left:8px;overflow:hidden;text-overflow:ellipsis}.fxs-contextMenu-icon{flex:0 0 auto;height:16px;width:16px;display:flex;justify-content:center;align-items:center;align-self:flex-start;margin-top:1px}.fxs-contextMenu-icon>svg{height:16px;width:16px}.fxs-contextMenu-itemList{list-style-type:none;margin:0;padding:0}.fxs-contextMenu-extensioncommand .fxs-contextMenu-icon{display:none}.fxs-contextMenu-extensioncommand.fxs-contextMenu-itemDisabled{display:block}.fxs-contextMenu-itemDisabled{cursor:text}.fxs-contextMenu-form{padding:8px 20px;display:none}.fxs-contextMenu-form.fxs-contextMenu-active{display:block}.fxs-dialogballoon.azc-balloon{opacity:1;width:auto;max-width:550px}.fxs-dialogballoon.azc-balloon>.azc-balloon-content{margin:0;overflow:unset;height:unset}.fxs-dialogballoon.azc-balloon .azc-balloon-text,.fxs-dialogballoon.azc-balloon .fxs-messagebox,.fxs-dialogballoon.azc-balloon>.azc-balloon-content{height:100%}.fxs-dialogballoon.azc-balloon .fxs-messagebox{overflow:auto}.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-mini,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-small,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-normal,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-tall,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-large,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-wide,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-herowide,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-herotall,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-hero{height:20px;width:20px}.msportalfx-contextmenu-grid rect{display:none}.msportalfx-contextmenu-grid-mini .msportalfx-grid-rect-mini,.msportalfx-contextmenu-grid-small .msportalfx-grid-rect-small,.msportalfx-contextmenu-grid-normal .msportalfx-grid-rect-normal,.msportalfx-contextmenu-grid-wide .msportalfx-grid-rect-wide,.msportalfx-contextmenu-grid-tall .msportalfx-grid-rect-tall,.msportalfx-contextmenu-grid-large .msportalfx-grid-rect-large,.msportalfx-contextmenu-grid-herowide .msportalfx-grid-rect-herowide,.msportalfx-contextmenu-grid-herotall .msportalfx-grid-rect-herotall,.msportalfx-contextmenu-grid-hero .msportalfx-grid-rect-hero{display:block}.fxs-contextMenuTouchHint{position:fixed;z-index:500;border:2px solid #808080;box-sizing:border-box;background-color:rgba(255,255,255,.2);pointer-events:none}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css",["module"],(function(e){"use strict";return{css:".fxs-contextpane{display:none;height:100%;position:relative;z-index:2;overflow:auto}.fxs-contextpane-content{box-sizing:border-box;height:auto;overflow:auto}.fxs-contextpane-loadindicator{display:none;position:absolute;top:0;bottom:0;right:0;left:0;background:inherit}.fxs-contextpane-loading .fxs-contextpane-loadindicator{display:block}.fxs-contextpane-visible{display:block}.fxs-contextpane-title{font-weight:600;font-size:18px;line-height:50px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin:0}.fxs-portal-contextpane-right{position:absolute;right:0;max-width:100%;height:100%}.fxs-portal-contextpane-right .fxs-blade{box-shadow:none}.fxs-portal-contextpane-docked{flex-direction:column;height:100%;box-sizing:border-box;width:320px;z-index:2;overflow:auto;border-color:#e0e0e0}.fxs-portal-contextpane-docked-resize-curtain{width:20px;height:100%;position:absolute;border-color:#e0e0e0;resize:horizontal;z-index:1000;top:0}.fxs-blade.fxs-contextpane-content{min-width:300px}.fxs-isEdge.fxs-portal-contextpane-right{overflow:auto}.fxs-portal-contextpane-right.fxs-contextpane-loading{min-width:355px}.fxs-portal-contextpane-docked-resize-splitter{position:fixed;top:0;bottom:0;left:0;right:0;pointer-events:none;z-index:2}@media(min-width:640px){.fxs-portal-contextpane-right{height:100%;max-width:calc(100% - 48px)}.fxs-sidebar-hamburger-mode .fxs-portal-contextpane-right{max-width:100%}}@media(min-width:1024px){.fxs-portal-contextpane-right{max-width:calc(100% - 225px)}.fxs-extension-sidebar~.fxs-portal-contextpane-right{max-width:calc(100% - 280px)}.fxs-sidebar-is-collapsed~.fxs-portal-contextpane-right,.fxs-extension-sidebar.fxs-sidebar-is-collapsed~.fxs-portal-contextpane-right{max-width:calc(100% - 48px)}}@media(min-height:500px){.fxs-contextpane-visible{display:flex;flex-flow:column nowrap}.fxs-contextpane{overflow:initial}.fxs-contextpane-content{height:100%}}@media(max-height:499.99999px){.fxs-contextpane .fxc-gc-vscroll{max-height:calc(100vh - 45px)}}.fxs-react-contextpane.fxs-react-contextpane.fxs-react-contextpane,.fxs-react-contextpane.fxs-react-contextpane .fxs-blade{background:none;pointer-events:none}.fxs-react-contextpane .fxs-header{pointer-events:auto}.fxs-react-contextpane .fxs-blade-content-container{display:none}.fxs-contextpane-floated-frame.fxs-contextpane-floated-frame{right:0;top:calc(64px - 20px - 8px);height:calc(100% - (64px - 20px - 8px));z-index:2;pointer-events:all;max-width:100%}.fxs-journey-breadcrumb.fxs-display-none+.fxs-journey-layout .fxs-contextpane-floated-frame{top:64px}.fxs-contextpane.fxs-portal-contextpane-docked .fxs-blade.fxs-bladesize-medium{width:100%;min-width:320px}.fxs-contextpane.fxs-portal-contextpane-docked .fxs-blade.msportalfx-shadow-level3{box-shadow:var(--shadowLevel1)}@media(min-width:1280px){.fxs-portal-contextpane-docked{width:480px}.fxs-contextpane.fxs-portal-contextpane-docked .fxs-blade.fxs-bladesize-medium{min-width:480px}.fxs-portal-contextpane-docked-resize-curtain{cursor:col-resize}}@media(max-width:1280px){.fxs-portal-contextpane-docked{width:320px}.fxs-contextpane.fxs-portal-contextpane-docked .fxs-blade.fxs-bladesize-medium{min-width:calc(320px - 20px)}.fxs-portal-contextpane-docked-resize-curtain{cursor:default}}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Control.css",["module"],(function(e){"use strict";return{css:".fxc-base .fxs-tile-progress{background-color:inherit}.fxc-base .fxs-tile-progress .fxs-tile-progress-transparent{height:100%;width:100%;left:auto;top:auto}.fxc-base .fxs-tile-progress .fxs-tile-progress-transparent>div{margin:0;left:0;vertical-align:baseline}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css",["module"],(function(e){"use strict";return{css:".fxs-dropmenu{position:relative;flex:0 0 auto;box-sizing:border-box;z-index:200}.fxs-dropmenu-button{border:0;padding:0;margin:0;background:none;cursor:pointer;display:flex;position:relative;height:100%;align-items:center;justify-content:center}.fx-dropmenu-dropdown .fxs-dropmenu-list-system a{display:flex}.fxs-dropmenu-content:not(.azc-toolbarButton-overflowPopup){position:absolute}.fxs-dropmenu-content:not(.azc-toolbarButton-overflowPopup) ol,.fxs-dropmenu-content:not(.azc-toolbarButton-overflowPopup) ul{list-style:none outside none;padding:0;margin:0}.fxs-dropmenu-content:not(.azc-toolbarButton-overflowPopup) li{white-space:nowrap}.fxs-dropmenu-content:not(.azc-toolbarButton-overflowPopup) li a{align-items:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding:10px 20px}.fxs-dropmenu-list-content{flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-dropmenu-image{flex:0 0 auto;height:16px;width:16px}.fxs-dropmenu-image img,.fxs-dropmenu-image svg{height:13px;width:13px}.fxs-dropmenu-line-separator{border-top-width:1px;border-top-style:solid}.fxs-dropmenu-content li a:hover{text-decoration:none}.fxs-dropmenu-left{right:0}.fxs-dropmenu-right{left:0}.fxs-dropmenu-hidden{display:none}.fxs-dropmenu-invisible{visibility:hidden}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css",["module"],(function(e){"use strict";return{css:'.fxs-flowlayout{position:relative}.fxs-flowlayout>.fxs-flowlayout-childcontainer{position:relative;transition:height .25s linear,width .25s linear 0s}.fxs-flowlayout>.fxs-flowlayout-childcontainer>.fxs-flowlayout-element{position:absolute}.fxs-flowlayout>.fxs-flowlayout-childcontainer>.fxs-flowlayout-drop-placeholder{position:absolute;background:rgba(0,0,0,.2)}.fxs-flowlayout-childcontainer>.fxs-tile{transition:height 125ms linear 125ms,width 125ms linear 0s,top 175ms ease-out,left 175ms ease-out,right 175ms ease-out}.fxs-flowlayout-resolutionguide{position:absolute;top:0;left:0;box-sizing:border-box;color:#fff;border-color:#fff;opacity:.7;border-width:1px;border-right-style:dashed;border-bottom-style:dashed;pointer-events:none;font-size:13px;line-height:normal}.fxs-mode-light .fxs-flowlayout-resolutionguide{color:inherit;border-color:inherit}.fxs-flowlayout-resolutionguide::after{position:absolute;right:8px;bottom:5px}.fxs-flowlayout-resolutionguide-1024x768{height:768px;width:1024px}.fxs-flowlayout-resolutionguide-1024x768::after{content:"1024 x 768"}.fxs-flowlayout-resolutionguide-1366x768{height:768px;width:1366px}.fxs-flowlayout-resolutionguide-1366x768::after{content:"1366 x 768"}.fxs-flowlayout-resolutionguide-1440x900{height:900px;width:1440px}.fxs-flowlayout-resolutionguide-1440x900::after{content:"1440 x 900"}.fxs-flowlayout-resolutionguide-1920x1080{height:1080px;width:1920px}.fxs-flowlayout-resolutionguide-1920x1080::after{content:"1920 x 1080"}.fxs-flowlayout-resolutionguide-3840x2160{height:2160px;width:3840px}.fxs-flowlayout-resolutionguide-3840x2160::after{content:"3840 x 2160"}.fxs-drag-surface{position:fixed;margin:0;padding:0;top:0;left:0;right:0;bottom:0;overflow:hidden;background-color:transparent;pointer-events:none;z-index:199}.fxs-drag-disableTouchAction{touch-action:none}.fxs-flowlayout-resizehandle{display:inline-block;padding:0 4px 4px 0;bottom:0;right:0}.fxs-flowlayout-resizehandle>div{height:12px;width:12px;border:2px solid rgba(125,125,125,.5);border-left-width:0;border-top-width:0}.fxs-flowlayout-resizehandle,.fxs-flowlayout-livepreview{position:absolute;cursor:se-resize;z-index:1}.fxs-flowlayout-livepreview{min-width:85px;min-height:85px;max-width:2245px;max-height:2245px;overflow:hidden}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css",["module"],(function(e){"use strict";return{css:"@keyframes fxs-search-indicator-animatedEllipses{0%{transform:scale(1);opacity:.3}36.1%{transform:scale(1.06);opacity:1}50%{transform:scale(1.06);opacity:1}86.1%{transform:scale(1);opacity:.3}}.fxs-search-menu{position:absolute;top:30px;left:0;width:100%;display:none;box-sizing:border-box;max-height:calc(100vh - 40px);overflow-x:hidden;overflow-y:auto}.fxs-asyncsearch-menu{position:absolute;top:30px;left:0;display:none;width:100%;box-sizing:border-box;max-height:calc(100vh - 40px);overflow-x:hidden;overflow-y:auto}.fxs-search-text{white-space:normal;overflow:hidden;text-overflow:ellipsis}.fxs-search-wrapper{display:flex;align-items:center;width:100%;border-radius:2px}.fxs-search{position:relative;display:flex}.fxs-search-icon-mini{padding:0 2px 0 8px;box-sizing:border-box;height:26px;width:22px;display:flex;align-items:center}.fxs-search-icon-mini svg{height:12px;width:12px}.fxs-search-clear{height:26px;width:24px;cursor:pointer;fill:#484644;box-sizing:border-box;display:flex;align-items:center;justify-content:center}.fxs-search-clear svg{height:12px;width:12px}.fxs-search-box{height:26px;flex:1 1 auto}.fxs-search-box .azc-input{border:0;font-size:13px;height:26px;background-color:transparent;box-sizing:border-box;outline:0;padding:2px 8px 4px;width:100%}.fxs-search-indicator{display:none;align-items:center;height:26px;box-sizing:border-box}.fxs-search-indicator>div{height:7px;width:7px;animation:fxs-search-indicator-animatedEllipses 1.5s infinite;background:#aab3bd;margin:0 2.5px}.fxs-search-indicator>div:nth-child(1){animation-delay:0s}.fxs-search-indicator>div:nth-child(2){animation-delay:.2s}.fxs-search-indicator>div:nth-child(3){animation-delay:.4s}.fxs-searching .fxs-search-indicator{display:flex}.fxs-search .fxs-search-icon{display:none}.fxs-search-showmenu .fxs-search-menu{display:block}.fxs-search-showmenu .fxs-asyncsearch-menu{display:block}.fxs-topbar-state-searchcollapsed .fxs-search-icon{display:flex}.fxs-topbar-state-searchcollapsed .fxs-search-wrapper{display:none}.fxs-topbar-state-searchcollapsed .fxs-search-activated .fxs-search-icon{display:none}.fxs-topbar-state-searchcollapsed .fxs-search-activated .fxs-search-wrapper{display:flex}.fxs-topbar-state-searchcollapsed .fxs-search-activated.fxs-search-showmenu .fxs-search-menu{display:block}.fxs-topbar-state-searchcollapsed .fxs-search-showmenu .fxs-search-menu{display:none}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css",["module"],(function(e){"use strict";return{css:".fxs-sidebar,.fxs-sidebar-leftnav-container{z-index:6;height:100%;font-size:13px;box-sizing:border-box;position:fixed;top:0}.fxs-sidebar-list{padding:0;margin:0;list-style:none}.fxs-sidebar-button{cursor:pointer}.fxs-sidebar-favorites{padding-bottom:20px}.fxs-sidebar-bar{width:225px;display:flex;flex-direction:column;height:100%;overflow:hidden}.fxs-sidebar-top{flex:0 0 auto}.fxs-sidebar-top>.fxs-sidebar-button{width:100%;border:0;padding:0;text-align:left}.fxs-sidebar-middle{flex:1 1 auto;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch}.fxs-sidebar-favorites-section{height:32px;display:flex;align-items:center;flex:0 0 auto}.fxs-sidebar-myfavorites{text-transform:uppercase;font-weight:700;font-size:10px;word-break:keep-all;margin-left:10px}.fxs-sidebar-divider,.fxs-sidebar-divider2{border-bottom-width:1px;border-bottom-style:solid;height:0;flex:1 1 0}.fxs-sidebar-divider:first-of-type{margin-right:5px;max-width:13px}.fxs-sidebar-divider:last-of-type{margin-left:5px}.fxs-sidebar-item-link{display:flex;align-items:center;flex:1 1 auto;min-height:32px;-webkit-user-drag:none;color:inherit;box-sizing:border-box;padding:7px 0}a.fxs-sidebar-item-link:hover{text-decoration:none;color:inherit}.fxs-sidebar-icon{flex:0 0 18px;height:18px;padding-left:15px;align-self:flex-start}.fxs-sidebar-icon svg,.fxs-sidebar-icon img{height:18px;width:18px}.fxs-sidebar-hamburger .fxs-sidebar-icon{height:16px;padding-left:15px;align-self:center}.fxs-sidebar-hamburger .fxs-sidebar-icon svg{height:16px;width:16px}.fxs-sidebar-label{flex:1 1 auto;overflow:hidden;text-overflow:ellipsis;margin-left:6px}.fxs-sidebar-create,.fxs-sidebar-browse{font-size:inherit}.fxs-sidebar-create .fxs-sidebar-label,.fxs-sidebar-browse .fxs-sidebar-label{margin-right:15px}.fxs-sidebar-collapse-button{display:flex;align-items:center;height:28px}.fxs-sidebar-collapse-button svg{height:8px;width:8px;transform:rotate(-90deg);margin-left:auto;margin-right:10px}.fxs-sidebar-fav-icon svg{height:12px;width:12px;fill:#0078d4}.fxs-theme-blue .fxs-sidebar-fav-icon svg,.fxs-mode-dark .fxs-sidebar-fav-icon svg{fill:#f2f2f2}.fxs-sidebar-external{flex:0 0 12px;margin:0 10px;padding-top:3px;width:12px;fill:#bbb}.fxs-sidebar-external svg{height:12px;width:12px}.fxs-sidebar-handle{flex:0 0 20px;cursor:move;fill:#bbb}.fxs-sidebar-handle svg{display:none;height:16px;width:16px;transform:rotate(90deg)}.fxs-sidebar-item:hover .fxs-sidebar-handle svg{display:block}.fxs-extension-sidebar .fxs-sidebar-bar{background:none;width:280px;transition-property:width;transition-duration:.2s}.fxs-extension-sidebar.fxs-sidebar-is-collapsed .fxs-sidebar-bar{transition-duration:0s}.fxs-extension-sidebar .fxs-sidebar-shadow{width:0}.fxs-sidebar-is-collapsed .fxs-sidebar-bar{width:48px}.fxs-sidebar-is-collapsed .fxs-sidebar-myfavorites,.fxs-sidebar-is-collapsed .fxs-sidebar-external{display:none}.fxs-sidebar-is-collapsed .fxs-sidebar-top>.fxs-sidebar-item-link .fxs-sidebar-label,.fxs-sidebar-is-collapsed .fxs-sidebar-middle .fxs-sidebar-label{display:none}.fxs-sidebar-is-collapsed .fxs-sidebar-top>.fxs-sidebar-item-link .fxs-sidebar-favorites,.fxs-sidebar-is-collapsed .fxs-sidebar-middle .fxs-sidebar-favorites{width:48px}.fxs-sidebar-is-collapsed .fxs-sidebar-collapse-button svg{transform:rotate(90deg)}.fxs-sidebar-is-collapsed .fxs-sidebar-middle{width:68px}.fxs-sidebar-shadow{pointer-events:none;position:absolute;right:0;top:0;bottom:0}.fxs-sidebar-divider2,.fxs-sidebar .fxs-sidebar-collapse-button,.fxs-sidebar.fxs-sidebar-is-collapsed{display:none}.fxs-sidebar-item-link.fxs-sidebar-hamburger{display:flex;border:0;padding:0;width:100%;height:40px}.fxs-sidebar-is-collapsed .fxs-sidebar-bar.msportalfx-shadow-level3{box-shadow:none}.fxs-sidebar .fxs-sidebar-shadow{display:none}.fxs-sidebar .fxs-part-frame.fxs-blade-floated-frame{top:0;height:100%}.fxs-sidebar-content{height:100%;position:relative}@media(max-width:640px)or (max-height:500px){.fxs-sidebar-leftnav-container{display:none;}.fxs-sidebar-leftnav-display{display:flex;top:40px;z-index:4;height:calc(100% - 40px);}}@media(min-width:640px) and (min-height:500px){.fxs-sidebar-hamburger-mode .fxs-sidebar.fxs-sidebar-is-collapsed,.fxs-sidebar-hamburger-mode .fxs-sidebar .fxs-sidebar-collapse-button{display:none}.fxs-sidebar-hamburger-mode .fxs-sidebar-item-link.fxs-sidebar-hamburger{display:flex}.fxs-sidebar-hamburger-mode .fxs-sidebar{position:fixed}.fxs-sidebar-hamburger-mode .fxs-sidebar .fxs-sidebar-shadow{display:none}.fxs-sidebar-docked-mode .fxs-sidebar,.fxs-sidebar-docked-mode .fxs-sidebar-leftnav-container{z-index:4;position:relative;max-width:48px}.fxs-sidebar-docked-mode .fxs-sidebar.fxs-sidebar-leftnav,.fxs-sidebar-docked-mode .fxs-sidebar-leftnav-container.fxs-sidebar-leftnav{max-width:unset;min-width:68px;background-color:var(--sidebarItemDivider)}.fxs-sidebar-docked-mode .fxs-sidebar .fxs-sidebar-collapse-button{display:flex}.fxs-sidebar-docked-mode .fxs-sidebar-item-link.fxs-sidebar-hamburger{display:none}.fxs-sidebar-docked-mode .fxs-sidebar.fxs-sidebar-is-collapsed{position:relative;display:flex}.fxs-sidebar-docked-mode .fxs-sidebar.fxs-sidebar-is-collapsed .fxs-sidebar-shadow{display:flex}}@media(min-width:1024px) and (min-height:500px){.fxs-sidebar-hamburger-mode .fxs-sidebar .fxs-sidebar-shadow{display:none}.fxs-sidebar-hamburger-mode .fxs-sidebar{position:fixed}.fxs-sidebar-docked-mode .fxs-sidebar-bar.msportalfx-shadow-level3{box-shadow:none}.fxs-sidebar-docked-mode .fxs-sidebar,.fxs-sidebar-docked-mode .fxs-sidebar-leftnav-container{position:relative;max-width:initial}.fxs-sidebar-docked-mode .fxs-sidebar .fxs-sidebar-shadow{display:flex}.fxs-sidebar-leftnav-container{display:flex;z-index:6;height:100%}}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css",["module"],(function(e){"use strict";return{css:".fxs-stacklayout{display:flex}.fxs-stacklayout-vertical{flex-direction:column}.fxs-stacklayout-horizontal{flex-direction:row}.fxs-stacklayout-child{flex:0 0 auto}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css",["module"],(function(e){"use strict";return{css:'.fxs-startboard{display:flex;flex-flow:column nowrap;overflow:auto;width:100%}.fxs-startboard .fxs-startboard-message-container{display:none}.fxs-startboard.fxs-startboard-notfound>.fxs-startboard-layout{display:none}.fxs-startboard.fxs-startboard-notfound .fxs-startboard-message-container{display:block}.fxs-startboard-header{display:flex;align-items:center;flex:0 0 auto;width:100%;height:45px;padding:0 25px 0 40px;margin-top:20px;box-sizing:border-box}.fxs-startboard-header .fxs-startboard-title-next{display:block}.fxs-startboard-header .fxs-startboard-title-content{display:flex}.fxs-startboard-header .fxs-startboard-button-text{font-size:13px}.fxs-startboard-header .fxs-startboard-button-icon{height:12px;width:12px;align-items:center;justify-content:center;flex:0 0 12px}.fxs-startboard-header .fxs-startboard-dropdown .fxs-startboard-button-icon,.fxs-startboard-header .fxs-startboard-title-next .fxs-startboard-button-icon{height:16px;width:16px;margin:4px 8px;flex:0 0 auto}.fxs-startboard-header .fxs-startboard-dropdown .fxs-startboard-button-icon>svg,.fxs-startboard-header .fxs-startboard-title-next .fxs-startboard-button-icon>svg{flex:0 0 16px}.fxs-startboard-header .fxs-startboard-title{max-width:300px;font-weight:600}.fxs-startboard-header .fxs-startboard-title-edit{padding:0 5px 2px;margin:0 -6px -2px;border-width:1px;border-style:solid;color:inherit;background-color:transparent;width:300px;transition:border .12s}.fxs-startboard-header .fxs-startboard-title-edit:active,.fxs-startboard-header .fxs-startboard-title-edit:hover{border-color:inherit}.fxs-startboard-header .fxs-startboard-button{position:relative}.fxs-startboard-header .fxs-startboard-title,.fxs-startboard-header .fxs-startboard-button{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:left}.fxs-startboard-header .fxs-startboard-dropdown,.fxs-startboard-header .fxs-startboard-button{font-size:13px;line-height:20px}.fxs-startboard-header .fxs-startboard-title,.fxs-startboard-header .fxs-startboard-title-edit{font-size:18px;line-height:24px}.fxs-startboard-header .fxs-startboard-subtitle{text-align:initial;font-size:12px;line-height:14px}.fxs-startboard-header .fxs-startboard-subtitle.fxs-startboard-subtitle-shared{margin-left:32px}.fxs-startboard-header .fxs-startboard-migration{height:40px;align-items:center;display:flex;flex:0 0 auto}.fxs-startboard-customize-header{min-height:70px}.fxs-startboard-commandBar,.fxs-startboard-customize-header,.fxs-startboard-info,.fxs-startboard-warning,.fxs-startboard-error{padding:0 25px 0 40px}.fxs-startboard-commandBar-fullScreen{display:none;margin-left:10px}.fxs-startboard-actions{margin-left:30px}.fxs-startboard-actions .fxs-startboard-actions-preview,.fxs-startboard-actions .fxs-startboard-actions-save{margin-right:10px}.fxs-startboard-warning,.fxs-startboard-error{margin:0}.fxs-startboard-layout{padding:16px 40px;flex:1 1 auto}.fxs-startboard-layout .fxs-flowlayout-childcontainer{padding-bottom:25px;padding-right:25px}.fxs-startboard-dropdown{display:none;flex:0 1 auto;max-width:560px;padding:2px 0}.fxs-startboard-button{flex:0 0 auto;border:0;margin:0 5px;padding:4px 5px;height:20px;background-color:transparent;box-sizing:content-box}.fxs-startboard-button:not([aria-disabled]):hover{cursor:pointer}.fxs-startboard-button .fxs-startboard-button-text{margin-left:5px}.fxs-startboard-button .fxs-startboard-button-icon{height:16px;width:16px}.fxs-startboard-button{display:flex;align-items:center;min-width:0}.fxs-startboard-button-browse{padding:0!important}.fxs-startboard-dropdown>.fxs-dropmenu{width:100%}.fxs-startboard-dropdown>.fxs-dropmenu .fxs-dropmenu-button{width:100%}.fxs-startboard-dropdown .fxs-dropmenu-content{overflow-x:hidden;overflow-y:auto;min-width:400px;max-width:560px;min-height:35px}.fxs-startboard-dropdown .fx-dropmenu-dropdown{max-height:calc(100vh - 120px)}.fxs-startboard-item-container{display:flex;align-items:center;min-width:0}.fxs-startboard-dropdown .fxs-dropmenu-list-system .fxs-startboard-dropdown-item{padding:7px 25px 8px}.fxs-startboard-dropdown-item+.fxs-startboard-dropdown-item::before{content:"";position:absolute;top:0;width:calc(100% - 50px);border-top-width:1px;border-top-style:solid;border-color:rgba(125,125,125,.5)}.fxs-startboard-item-title{flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-startboard-item-icon{flex:0 0 auto;height:14px;width:14px;padding-right:5px}.fxs-startboard-dropdown-button{display:flex;flex-flow:column nowrap}.fxs-startboard-title-container{display:flex}.fxs-startboard-dropdown-item{position:relative;height:35px;box-sizing:border-box;cursor:pointer}.fxs-startboard-dropdown-item.fxs-startboard-dropdown-browseall{height:auto;cursor:default}.fxs-startboard-dropdown-subscriptions{white-space:normal}.fxs-startboard-migration,.fxs-startboard-dropdown{display:none}.fxs-startboard-header:not(.fxs-startboard-header-normal) .fxs-startboard-title-edit{display:none}.fxs-startboard-header-normal .fxs-startboard-dropdown{display:block}.fxs-startboard-header-normal .fxs-startboard-migration{display:none}.fxs-startboard-header-normal .fxs-startboard-title-next{display:none}.fxs-startboard-header-migration .fxs-startboard-dropdown{display:none}.fxs-startboard-header-migration .fxs-startboard-migration{display:flex}.fxs-startboard-header-migration .fxs-startboard-title-next{display:block}.fxs-startboard-message-container{padding:55px 40px}.fxs-startboard-message-title{font-size:32px;margin-bottom:20px}.fxs-startboard-message-body{font-size:17px}.fxs-startboard-notfound .fxs-startboard-button{display:none}.fxs-portal:not(.fxs-desktop-organize) .fxs-topbar-dashboard-changed .fxs-startboard-header-item{display:none}.fxs-portal:not(.fxs-desktop-organize) .fxs-topbar-dashboard-changed .fxs-startboard-title-next{display:block}.fxs-startboard-loadanimation{display:none;align-items:center;justify-content:center;position:absolute;height:100%;width:100%}.fxs-startboard-loading .fxs-startboard-loadanimation{display:flex}.fxs-startboard-loading .fxs-startboard-layout,.fxs-startboard-loading .fxs-startboard-message-container{visibility:hidden}.fxs-startboard-loading .fxs-startboard-header-item{display:none}.fxs-startboard-loading .fxs-startboard-title-next{display:block}.fxs-startboard-loading .fxs-startboard-layout .fxs-tile .fxs-part-content{display:none}@media(min-height:500px){.fxs-startboard{overflow:hidden}.fxs-startboard-layout{overflow:auto}}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css",["module"],(function(e){"use strict";return{css:".fxs-tile-progress-transparent{height:12px;position:absolute;top:0;left:0;z-index:195;overflow:hidden}.fxs-tile-progress-transparent>div{margin-left:6px}.fxs-tile-progress-transparent>div::after{height:4px;width:4px;background:#000}.fxs-startboard .fxs-tile{border-radius:2px}.fxs-startboard .fxs-tile>.fxs-part{border-radius:2px}.fxs-tile{height:175px;width:175px;position:relative;box-shadow:none}.fxs-tilesize-mini{height:85px;width:85px}.fxs-tilesize-small{height:85px;width:175px}.fxs-tilesize-tall{height:355px;width:175px}.fxs-tilesize-wide{height:175px;width:355px}.fxs-tilesize-normal{height:175px;width:175px}.fxs-tilesize-large{height:355px;width:355px}.fxs-tilesize-herotall{height:535px;width:355px}.fxs-tilesize-herowide{height:355px;width:535px}.fxs-tilesize-hero{height:535px;width:535px}.fxs-tilesize-herowidefitheight{height:auto;width:535px}.fxs-tilesize-fullwidthfitheight{height:auto;width:100%}.fxs-tilesize-fullwidthfitheight .fxs-part{height:auto}.fxs-tilesize-fullwidthfitheight .fxs-part-content{height:auto}.fxs-tilesize-herowidefitheight,.fxs-tilesize-fullwidthfitheight{margin-bottom:5px}.fxs-tilesize-herowidefitheight:last-child,.fxs-tilesize-fullwidthfitheight:last-child{margin-bottom:0}.fxs-tilesize-fittocontainer{height:100%;width:100%}.fxs-tilesize-fittocontainer>.fxs-part{overflow:visible}.fxs-tile-actionbar{z-index:196}.fxs-tile-container{width:100%;height:100%}div.fxs-tile-overlay:not(.fxs-progress){display:none;position:absolute;width:100%;top:0;bottom:0;cursor:pointer}.fxs-bladestyle-create .fxs-tile .fxs-part,.fxs-bladestyle-context .fxs-tile .fxs-part,.fxs-bladestyle-contextaction .fxs-tile .fxs-part,.fxs-bladestyle-help .fxs-tile .fxs-part{box-shadow:none}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css",["module"],(function(e){"use strict";return{css:".fxs-tile-actionbar-actionlist{display:flex;flex-flow:row nowrap;border-radius:0 2px 0 0}.fxs-tile-actionbar-actionlist:empty{height:25px;visibility:hidden}.fxs-tile-actionbar-actionlist .fxs-tile-actionbar-action:last-of-type{border-radius:0 2px 0 0}.fxs-tile-actionbar-action{flex:0 0 auto;display:flex;align-items:center;justify-content:center;box-sizing:border-box;height:25px;width:25px;padding:6px;background-color:transparent;cursor:pointer;border:0;transition:background .1s ease-out}.fxs-tile-actionbar-action>svg{height:13px;width:13px}.fxs-tile .fxs-tile-actions{position:absolute;right:0;cursor:default}.fxs-tile-actionbar-command-unpinfromstartboard{display:none}.fxs-desktop-organize .fxs-tile-actionbar-command-unpinfromstartboard{display:flex}.fxs-tile-transparent{opacity:0}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css",["module"],(function(e){"use strict";return{css:".fxs-toast{position:fixed;right:5px;width:355px;max-width:100%;box-sizing:border-box;list-style-type:none;margin:0;padding:0;padding-left:10px}.fxs-topbar-toast{position:relative;top:25px}.fxs-toast-wrapper,.fxs-toast-content{flex:1 1 auto;width:100%;padding:10px;box-sizing:border-box}.fxs-toast-item{display:flex;margin-bottom:5px;max-height:82vh;overflow-y:auto;position:relative}.fxs-toast-header{display:flex;padding-top:5px;margin-bottom:5px}.fxs-toast-icon{margin-right:4px}.fxs-toast-icon svg{height:15px;width:15px;vertical-align:middle}.fxs-toast-title{flex:1 1 auto;margin:0 4px;max-width:254px;font-weight:600;display:block;display:-webkit-box;line-height:19px;max-height:38px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow-wrap:break-word}.fxs-toast-title.fxs-toast-link:hover{text-decoration:underline}.fxs-toast-time{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:60px;flex:0 0 auto}.fxs-toast-close{position:absolute;top:0;right:0;background:none;border:0;cursor:pointer;margin-left:4px;padding:0;margin-top:16px;margin-right:12px}.fxs-toast-close svg{height:12px;width:12px}.fxs-toast-description{font-size:13px;line-height:normal;max-width:100%;overflow:hidden;position:relative;text-overflow:ellipsis;white-space:pre-wrap;width:335px}.fxs-toast-progressbar{margin-top:10px;max-height:5px}.fxs-mfa{padding-bottom:0;padding-top:0}.fxs-mfa .fxs-mfa-description-text{display:inline;margin-right:5px}.fxs-mfa .fxs-mfa-description-link{display:inline-block}.fxs-mfa .fxs-mfa-description-wrapper{padding-top:10px}.fxs-mfa .fxs-mfa-title-icon{margin-right:4px}.fxs-mfa .fxs-mfa-title-icon svg{height:15px;width:15px;fill:#0078d4;vertical-align:middle}.fxs-nps .fxs-gap-above{margin-top:10px}.fxs-nps .fxs-nps-title,.fxs-nps .fxs-sat-title{font-weight:600;margin-bottom:7px;width:calc(100% - 15px)}.fxs-nps .fxs-nps-title{font-size:14px;line-height:18px}.fxs-nps .fxs-nps-title-control{margin-top:25px}.fxs-nps .fxs-sat-title{margin-top:28px}.fxs-nps .fxs-nps-sat-question{margin-bottom:7px}.fxs-nps .fxs-nps-title-icon{margin-right:4px}.fxs-nps .fxs-nps-title-icon svg{height:15px;width:15px;fill:#0078d4;vertical-align:middle}.fxs-nps .fxs-red-star{color:#f00;font-size:14px;line-height:20px}.fxs-nps .fxs-nps-score{display:flex}.fxs-nps .fxs-nps-score span{flex:1 1 auto;border:1px solid #c5cbd1;text-align:center;height:23px;line-height:23px;margin-right:6px;display:inline-block;cursor:pointer}.fxs-nps .fxt-nps-sat-labels ul{font-size:10px;line-height:14px}.fxs-nps .fxs-nps-score span:hover,.fxs-nps .fxs-nps-score span.fxs-nps-score-selected{background:#00bcf2;border-color:#00bcf2}.fxs-nps .fxs-nps-score span:last-child{margin-right:0}.fxs-nps .fxs-nps-help{display:flex;margin-bottom:10px}.fxs-nps .fxs-nps-help span:last-child{margin-left:auto}.fxs-nps .fxs-nps-comments{margin-bottom:18px;margin-top:22px;width:100%;box-sizing:border-box}.fxs-nps .fxs-nps-link-wrapper{font-size:10px;line-height:14px;margin-bottom:5px;margin-top:10px}.fxs-nps .fxs-nps-disclaimer{display:inline}.fxs-nps .fxs-nps-checkbox{margin:15px 5px 0 0}.fxs-nps .fxs-nps-checkbox-contact{margin-right:3px}.fxs-nps .fxs-nps-contact-link{display:inline-block;margin-left:3px}.fxs-nps .fxs-nps-button-holder{border-top:1px solid #dcdfe2}.fxs-nps .fxs-nps-submit{display:inline-block;margin-right:10px;text-align:center}.fxs-nps .fxs-nps-close{display:inline-block;text-align:center}.fxs-nps .fxs-nps-start-hats{display:inline-block;margin-right:10px;text-align:center}.fxs-nps .fxs-nps-link-survey{text-decoration:underline}.fxs-nps .fxs-nps-survey-opt-out{float:right;margin-top:5px}.fxs-sat .fxs-sat-title{font-weight:600;margin-bottom:7px}.fxs-sat .fxs-sat-submit{margin:15px 10px 5px 0;border:0}.fxs-copilot-toast .fxs-gap-above{margin-top:10px}.fxs-copilot-toast .fxs-copilot-toast-title{font-weight:600;font-size:14px;line-height:18px;margin-bottom:7px;width:calc(100% - 15px)}.fxs-copilot-toast .fxs-copilot-toast-title-icon{margin-right:4px}.fxs-copilot-toast .fxs-copilot-toast-title-icon svg{height:20px;width:20px;fill:#0078d4;padding-bottom:5px;vertical-align:middle}.fxs-copilot-toast .fxs-copilot-toast-description{margin-bottom:10px;min-height:40px}.fxs-copilot-toast .fxs-copilot-toast-link-wrapper{font-size:10px;line-height:14px;margin-bottom:5px;margin-top:10px}.fxs-copilot-toast .fxs-copilot-toast-button-holder{border-top:1px solid #dcdfe2}.fxs-copilot-toast .fxs-copilot-toast-optout{display:inline-block;margin-right:10px;text-align:center}.fxs-copilot-toast .fxs-copilot-toast-close{display:inline-block;text-align:center}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css",["module"],(function(e){"use strict";return{css:".fxs-topbar{height:40px;position:relative;z-index:5;flex:0 0 auto;font-size:13px}.fxs-topbar-skip-link{user-select:auto;position:absolute;display:flex;align-items:center;justify-content:center;box-sizing:border-box;overflow:hidden;width:0;height:0;font-weight:bold;color:var(--topbarAlternateTextFill);background-color:var(--searchBackground);border-color:var(--colorControlBorder);top:0}.fxs-topbar-skip-link:active,.fxs-topbar-skip-link:focus,.fxs-topbar-skip-link:focus-within{width:max-content;height:28px;padding:0 8px 2px;border-width:1px;border-style:solid;border-radius:0 0 4px 4px;z-index:1000}.fxs-topbar-preview,.fxs-topbar-brand{flex:0 1 auto;margin:0;padding:0;height:100%;min-width:0}.fxs-topbar .fxs-topbar-journey-icon{border:0}.fxs-topbar .fxs-topbar-journey-icon svg{height:16px;width:16px;margin-top:4px}.fxs-topbar-content{width:100%;height:100%;position:absolute;top:0;-webkit-app-region:drag;display:flex;align-content:center;align-items:center}.fxs-search-box,.fxs-topbar-button,.fxs-topbar-avatarmenu,.fxs-topbar-reportbug,.fxs-topbar-upgradebutton{-webkit-app-region:no-drag}.fxs-topbar-internal{min-width:85px;box-sizing:border-box;text-align:center;flex:0 0 auto}.fxs-topbar-exitdevmode,.fxs-topbar-reportbug,.fxs-topbar-upgradebutton{display:flex;height:40px;width:auto;flex:0 0 auto;align-items:center;justify-content:center;padding:0 5px;color:#000}.fxs-topbar-preview .fxs-topbar-home .fxs-topbar-internal,.fxs-topbar-brand .fxs-topbar-home{display:inline-block;font-size:15px;padding:0 20px;height:40px;line-height:40px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:100%;box-sizing:border-box}.fxs-topbar-preview .fxs-topbar-home{display:inline-block;width:100%;height:100%}.fxs-topbar-devmode .fxs-topbar-home{color:#000}a.fxs-topbar-home:hover{text-decoration:none}.fxs-topbar-button{display:flex;height:40px;width:40px;flex:0 0 auto;align-items:center;justify-content:center}.fxs-topbar-button svg{height:16px;width:16px}.fxs-topbar-button.fxs-topbar-close:hover{background-color:#ba141a}.fxs-desktop-organize .fxs-topbar-exit-customize{visibility:visible;top:0}.fxs-topbar-exit-customize-message,.fxs-topbar-dashboard-message{font-size:14px}.fxs-topbar-exit-customize-button,.fxs-topbar-dashboard .fxs-button{flex:0 0 auto;margin-left:10px}.fxs-show-startboard .fxs-topbar-dashboard-view{display:none}.fxs-portal:not(.fxs-show-startboard) .fxs-topbar-dashboard-save,.fxs-portal:not(.fxs-show-startboard) .fxs-topbar-dashboard-discard{display:none}.fxs-topbar-exit-customize,.fxs-topbar-dashboard{display:flex;align-items:center;justify-content:center;flex:1 1 auto;position:absolute;top:-40px;z-index:5;visibility:hidden;width:100%;height:100%;transition:top .3s ease .0001s}.fxs-topbar-dashboard-changed .fxs-topbar-dashboard{top:0;visibility:visible}.fxs-topbar-dashboard-changed .fxs-topbar-content{visibility:hidden}.fxs-topbar-dashboard-changed .fxs-topbar-exit-customize{display:none}.fxs-topbar-notifications{position:relative}.fxs-topbar-helpmenu{position:relative}.fxs-topbar-placeholder{flex:1 1 auto}.fxs-topbar-buttons-container{display:flex;flex:0 0 auto}.fxs-topbar-back{transform:scale(-1,1)}.fxs-topbar-search{margin-left:7px;width:800px;min-width:280px;flex:0 10000 auto}.fxs-topbar-exitdevmode.fxs-topbar-debug-button.fxs-topbar-search-activated-hidden{border:2px solid;box-sizing:border-box;height:calc(100% - 8px);border-radius:8px;background-color:#fff8!important}.fxs-topbar-copilot{gap:5px;width:auto;height:26px;padding-left:12px;padding-right:13px;border-radius:3px;background:var(--copilotIconBackground)}.fxs-topbar-copilot .fxs-topbar-copilot-text{margin-bottom:1px;font-weight:600;font-size:13px;color:var(--copilotIconTextColor)}.fxs-topbar-copilot-button-icon{height:16px}.fxs-topbar-copilot-active{background:var(--copilotIconActiveBackground)}.fxs-topbar-copilot-active .fxs-topbar-copilot-text{color:var(--copilotIconActiveTextColor)}.fxs-topbar-button.fxs-topbar-copilot.fxs-topbar-home:hover{background:var(--copilotIconHoverBackground)}.fxs-topbar-button.fxs-topbar-copilot.fxs-topbar-home:active{background:var(--copilotIconActiveBackground)}.fxs-topbar-button.fxs-topbar-copilot.fxs-topbar-home:focus{background:var(--copilotIconFocusBackground)}.fxs-topbar-button.fxs-topbar-copilot.fxs-topbar-home:focus:hover{background:var(--copilotIconHoverBackground)}.fxs-topbar-button.fxs-topbar-copilot.fxs-topbar-home .fxs-topbar-copilot-text:hover{color:var(--copilotIconHoverTextColor)}.fxs-topbar-button.fxs-topbar-copilot.fxs-topbar-home .fxs-topbar-copilot-text:active{color:var(--copilotIconActiveTextColor)}.fxs-topbar-button.fxs-topbar-copilot.fxs-topbar-home .fxs-topbar-copilot-text:focus{color:var(--copilotIconFocusTextColor)}.fxs-search-back-icon{display:none}.fxs-topbar-reportbug,.fxs-topbar-upgradebutton{margin-left:7px;height:26px;border-radius:2px;font-weight:600}.fxs-topbar-reportbug .fxs-topbar-reportbug-icon,.fxs-topbar-upgradebutton .fxs-topbar-reportbug-icon{width:16px;height:16px}.fxs-topbar-reportbug .fxs-topbar-upgradebutton-icon,.fxs-topbar-upgradebutton .fxs-topbar-upgradebutton-icon{width:14px;height:14px}.fxs-topbar-reportbug .fxs-topbar-reportbug-text,.fxs-topbar-upgradebutton .fxs-topbar-reportbug-text,.fxs-topbar-reportbug .fxs-topbar-upgradebutton-text,.fxs-topbar-upgradebutton .fxs-topbar-upgradebutton-text{margin-left:7px;margin-bottom:2px}.fxs-topbar-reportbug .fxs-topbar-upgradebutton-text,.fxs-topbar-upgradebutton .fxs-topbar-upgradebutton-text{margin-top:1px}.fxs-topbar-state-searchcollapsed .fxs-topbar-search{width:40px;min-width:40px;flex:0 0 auto}.fxs-topbar-state-searchcollapsed.fxs-topbar-search-activated .fxs-topbar-search{width:calc(100% - 40px - 7px*2);margin-left:7px}.fxs-topbar-state-searchcollapsed.fxs-topbar-search-activated .fxs-search-back-icon{display:flex}.fxs-topbar-state-searchcollapsed.fxs-topbar-search-activated .fxs-topbar-search-activated-hidden{opacity:0;position:absolute;height:0!important;width:0!important;overflow:hidden!important}.fxs-topbar-sidebar-collapse-button{display:flex;width:48px}.fxs-topbar-wafflemenu{display:flex;width:48px}.fxs-topbar-wafflemenu-active{background-color:var(--topbarActionHoverBgColor)}.fxs-topbar-leftNav-shown{width:68px}.fxs-topbar-search.fxs-search-onecolumn{justify-content:center}.fxs-topbar-search.fxs-search-onecolumn .fxs-search-wrapper,.fxs-topbar-search.fxs-search-onecolumn .fxs-search-menu{min-width:364px;max-width:520px;left:auto}@media(max-width:700px){.fxs-topbar-exit-customize-message,.fxs-topbar-dashboard-message{display:none}}@media(min-width:640px) and (min-height:500px){.fxs-topbar-sidebar-collapse-button{display:none}.fxs-sidebar-hamburger-mode .fxs-topbar-sidebar-collapse-button{display:flex}}@media(min-width:494px){.fxs-topbar-search-activated .fxs-search-back-icon{position:absolute}.fxs-topbar-state-searchcollapsed.fxs-topbar-search-activated .fxs-topbar-search{margin:auto}}",moduleId:e.id}})),
define("MsPortalImpl/Widgets/Widgets.WidgetBase",["require","exports","MsPortalImpl/Base/Base.ElementWidgetMap","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Control.css","_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css","_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css","_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css","_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css","_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css","_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x){"use strict";t.Widget=t.ViewModel=void 0,(0,i.injectCss)(o,n,r,a,l,c,d,p,u,m,g,h,f,x);t.ViewModel=class{constructor(){this.disabled=ko.observable(!1)}};class b{constructor(e,t,i=!1){if(!e||0===e.length)throw new Error("You must specify an element to associate a widget to it. Your element is either null or an empty collection.");this.options=t,this._ltm=new FxImpl.TriggerableLifetimeManager,this.element=$(e[0]),i||this._ltm.registerForDispose(e.setEvents([b.widgetRemoveEvent,t=>{t.target!==e[0]||this._disposeTriggered||(this._disposeTriggered=!0,this.dispose())}])),s.set(e[0],this)}setFocus(){}dispose(){this._ltm.dispose(),s.remove(this.element[0],this)}get ltm(){return this._ltm}static getWidget(e,t){const s=b.getWidgets(e,t);return s&&s[0]||null}static getWidgets(e,t){return(t?s.getAllMatch(e[0],t):s.getAll(e[0]))||[]}trigger(e,t){const s=this.options[e],i=this.element;t=t||{};const o=$.Event(e);return o.type=e,o.target=i[0],i.trigger(o,t),!($.isFunction(s)&&!1===s.apply(i[0],[o].concat(t))||o.isDefaultPrevented())}getTelemetrySource(){return null}_bindDescendants(e){const t={data:this.options,func:this},s=e?$.extend(null,t,e):t;ko.applyBindingsToDescendants(s,this.element[0])}_cleanDescendants(){ko.utils.cleanDescendantNodes(this.element)}_cleanElement(...e){this._cleanDescendants(),this._cleanElementClasses(e),this.element.empty()}_cleanElementClasses(e){e.length>0&&this.element.removeClass(e.join(" "))}_isRtl(){return"rtl"===$.querySelectorAll("html").first().attr("dir")}}t.Widget=b,b.widgetRemoveEvent="remove.fxWidget"})),
define("_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox.css",["module"],(function(e){"use strict";return{css:".fxs-messagebox{font-size:14px;min-width:120px;box-sizing:border-box;border-width:1px;border-style:solid;line-height:normal;position:relative;overflow:hidden}.fxs-progressbox{color:#fff}.fxs-messagebox-title{padding:12px 20px 7px;margin:0;border-bottom:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-progressbox-text,.fxs-modal-template,.fxs-messagebox-template,.fxs-messagebox-text{padding:0 20px 8px;word-wrap:break-word}.fxs-messagebox-title.fxs-display-none+.fxs-modal-template,.fxs-messagebox-title.fxs-display-none+.fxs-messagebox-template,.fxs-messagebox-title.fxs-display-none+.fxs-messagebox-text{padding-top:12px}.fxs-messagebox-buttons{padding:8px 20px 16px}.fxs-messagebox-buttons .fxs-button{margin-right:8px}.fxs-progressbox-progressbar{padding:7px 20px 24px}.azc-balloon-dialog .fxs-messagebox{box-shadow:unset;border:0}.fxs-messagebox-confirmation{padding:10px 20px 0;display:block}.fxs-formdialog-description{padding:0 0 15px}.fxs-formdialog-form{max-width:458px}",moduleId:e.id}})),
define("MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl.Controls/Controls/SimpleButton","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Common","Fx/Controls/Button","Fx/Controls/CheckBox","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox.css"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m){"use strict";t.Widget=t.ViewModel=void 0,t.createMessageBoxWithCallback=function(e,t,s,i){const o=new _;o.title(s.title),s.templateViewModel?(o.template(s.text),o.templateViewModel(s.templateViewModel)):o.text(s.text);return o.buttons=s.buttons,o.onButtonClick=e=>{t(e)},o.modal=i.modal,o.trustedTemplate=i.trustedTemplate,o.defaultButtonText=s.defaultButtonText,o.cancelButtonText=s.cancelButtonText,o.extraButtonText=s.extraButtonText,o.confirmationRequired=s.confirmationRequired,o.confirmationMessage=s.confirmationMessage,o.hideTitle=s.hideTitle,o.scopeClass=i.scopeClass,o.sourceTarget=i.sourceTarget,new F(e,o)},t.createMessageBoxWithCallback2=function(e,t,s,i){s.positionHint=s.positionHint||3;const n=new _;n.title(s.title),"object"==typeof s.content?(n.template(s.content.htmlTemplate),n.templateViewModel(s.content.viewModel)):"string"==typeof s.content&&n.text(s.content);Array.isArray(s.buttons)?(n.customBtns=[],s.buttons.forEach((e=>{const t=e.displayText||b[e.button];n.customBtns.push({kind:3,text:t,result:e.button,disabled:e.disabled})})),n.customBtns.length&&(n.customBtns[0].kind=1,n.customBtns.length>1&&(MsPortalFx.last(n.customBtns).kind=2))):n.buttons=s.buttons;n.modal=i.modal,n.trustedTemplate=i.trustedTemplate,n.hideTitle=s.hideTitle,n.scopeClass=i.scopeClass;const r=new F(e,n),a=r.buttonVms()[0],l=a&&a.result;return n.onButtonClick=s=>{l===s?o.ensureFormFieldValidation(e,!0).then((i=>{i?t(s):o.focusOnFirstInvalidField(e)})).catch($.noop):t(s)},r},t.setFocusOnMessageBox=P;var g=s;(0,u.injectCss)(m);const h=MsPortalFx.Base.Diagnostics.createLog(e),f=MsPortalFx.getIdGenerator("messagebox"),x=n.Dialogs.ButtonText,b=[];b[0]=x.abort,b[1]=x.cancel,b[2]=x.ignore,b[3]=x.no,b[4]=x.ok,b[5]=x.retry,b[6]=x.yes;const y="fxs-portal-bg-txt-br",v="msportalfx-shadow-level2",w="fxs-popup",M="fxs-messagebox",C="fxs-messagebox-text",S=g.tsx("div",null,g.tsx("h2",{"data-bind":{text:"data.title",visible:"!data.hideTitle"},class:"fxs-messagebox-title az-text-header1 msportalfx-tooltip-overflow"}),g.tsx(s.KoIf,{condition:"data.trustedTemplate"},g.tsx(s.KoIfNot,{condition:"data.template"},g.tsx("div",{"data-bind":{sanitizedHtml:"data.text"},class:C})),g.tsx(s.KoIf,{condition:"data.template"},g.tsx("div",{class:"fxs-modal-template","data-bind":{trustedHtml:{html:"data.template",data:"data.templateViewModel",isolated:"true"}}}))),g.tsx(s.KoIfNot,{condition:"data.trustedTemplate"},g.tsx(s.KoIfNot,{condition:"data.template"},g.tsx("div",{"data-bind":{text:"data.text"},class:C})),g.tsx(s.KoIf,{condition:"data.template"},g.tsx("div",{class:"fxs-messagebox-template","data-bind":{untrustedHtml:{html:"data.template",data:"data.templateViewModel",isolated:"true"},keyedCss:{scopingClasses:"data.scopeClass"}}}))),g.tsx(s.KoIf,{condition:"data.confirmationRequired"},g.tsx("div",{"data-bind":{pcControl:"func.checkboxVm"},class:"fxs-messagebox-confirmation"})),g.tsx("div",{class:"msportalfx-form fxs-messagebox-buttons","data-bind":{foreach:"func.buttonVms",visible:"func.buttonVms().length >= 1"}},g.tsx("div",{"data-bind":{pcControl:"$data.vm",attr:{"data-result":"$data.result"}}})));let I=document.activeElement;function P(e,t){const s=e.closest(`.${M}`);s.length>0&&c.waitForBindings(s[0]).then((()=>{setTimeout((()=>{const e=l.Widget.getWidget(s,F);let t=s.findFirstTabbable();0!==t.length||MsPortalFx.isNullOrUndefined(e)||(t=e.element),t.closest(".fxs-messagebox-buttons").length>0?(e.element.find(".fxs-portal-button-primary")&&e.element.find(".fxs-portal-button-primary").focus(),e.element.find(".fxs-portal-button-danger")&&e.element.find(".fxs-portal-button-danger").focus()):t.focus()}),10)})).catch($.noop);let i=t||document.activeElement;for(;i&&"function"!=typeof i.focus;)i=$(i).closest("[tabindex]")[0];I=i}class _ extends l.ViewModel{constructor(){super(...arguments),this.title=ko.observable(),this.text=ko.observable(),this.template=ko.observable(),this.templateViewModel=ko.observable(),this.trustedTemplate=!1,this.modal=!1,this.buttons=1,this.confirmationRequired=!1,this.hideTitle=!1,this.scopeClass=""}get onButtonClick(){return this._buttonClick}set onButtonClick(e){if(this._buttonClick)throw new Error("The onButtonClick callback has already been set.");this._buttonClick=e}}t.ViewModel=_;class F extends l.Widget{constructor(e,t){super(e,t),this.buttonVms=ko.observableArray([]),e.html(S).addClass(M).addClass(w).addClass(y).addClass(v),e.closest(".azc-balloon-dialog").attr("role",null);const s=this.ltm,i=e=>{const t=this.element[0],s=$(e).closest(".azc-dockedballoon-balloon").attr("id");return!(this.options.modal||t===e||$.contains(t,e)||s&&(this.element.find(`.azc-dockedballoon-anchor[aria-owns='${s}']`).length||this.element.find(`.azc-dockedballoon-anchor[aria-controls='${s}']`).length))?2:0};this._dismissHandle={dismissFn:()=>{this.cancelBtn&&this.cancelBtn!==this.defaultBtn?ko.unwrap(this.cancelBtn.onClick)():"function"==typeof this.options.onButtonClick&&this.options.onButtonClick(1)},shouldDismissOnMouseDownFn:i,shouldDismissOnMouseWheelFn:i,restoreFocus:()=>{const e=this.element[0],t=document.activeElement;($.contains(e,t)||t===e)&&r.validatePreviousFocusedElement(this._dismissHandle,I)&&I.focus()},logName:"messagebox"},t.confirmationRequired&&(this.checkboxVm=p.create(s,{label:t.confirmationMessage,labelOnRight:!0})),this._getButtonHtml(t.buttons,s),this._bindDescendants(),this._setAria();let o=document.activeElement;t.sourceTarget&&(this.element[0]===t.sourceTarget||t.sourceTarget.contains(document.activeElement)||(o=t.sourceTarget)),new a.KeyboardNavigation(this.ltm,{element:e,tabTriggers:2}),P(e,o),r.register(this._dismissHandle),s.registerForDispose((()=>{this._dismissHandle.restoreFocus(),r.unregister(this._dismissHandle)})),t.confirmationRequired&&(this.checkboxVm.value(!1),ko.reactor(s,(()=>{this.defaultBtn.disabled(!this.checkboxVm.value())})))}dispose(){this._cleanElement(M,w,y,v),super.dispose()}generateBtns(e,t){if(0===t.length)return;const s=this.buttonVms,i=(e,t,s)=>d.create(e,{text:s.text,style:t,disabled:s.disabled,onClick:()=>{"function"==typeof this.options.onButtonClick&&this.options.onButtonClick(s.result),this._dismissHandle.restoreFocus()}});s().forEach((e=>{e.vm.dispose()})),s().length=0,s([]),this.defaultBtn=null,this.cancelBtn=null,this.extraBtn=null,t.forEach(((t,o)=>{switch(0===o&&1!==t.kind&&4!==t.kind&&h.error("The first button should be the default button for this dialog."),!this.defaultBtn||1!==t.kind&&4!==t.kind||h.error("Only one default button should be defined."),this.cancelBtn&&2===t.kind&&h.error("Only one cancel button should be defined."),t.kind){case 1:s.push({vm:i(e,0,t),result:t.result}),this.defaultBtn=MsPortalFx.last(s()).vm;break;case 2:s.push({vm:i(e,1,t),result:t.result}),this.cancelBtn=MsPortalFx.last(s()).vm;break;case 4:s.push({vm:i(e,2,t),result:t.result}),this.defaultBtn=MsPortalFx.last(s()).vm;break;default:s.push({vm:i(e,1,t),result:t.result}),this.extraBtn=MsPortalFx.last(s()).vm}})),1===t.length&&(this.cancelBtn=this.defaultBtn),MsPortalFx.isNullOrUndefined(this.cancelBtn)&&h.error("Cancel button should be defined.")}_getButtonHtml(e,t){const s=this.options;if(s.customBtns)this.generateBtns(t,s.customBtns);else{switch(e){case 0:this.generateBtns(t,[{kind:1,text:x.retry,result:5},{kind:2,text:x.abort,result:0},{kind:3,text:x.ignore,result:2}]);break;case 1:this.generateBtns(t,[{kind:1,text:x.ok,result:4}]);break;case 2:this.generateBtns(t,[{kind:1,text:x.ok,result:4},{kind:2,text:x.cancel,result:1}]);break;case 3:this.generateBtns(t,[{kind:1,text:x.retry,result:5},{kind:2,text:x.cancel,result:1}]);break;case 4:this.generateBtns(t,[{kind:1,text:x.yes,result:6},{kind:2,text:x.no,result:3}]);break;case 5:this.generateBtns(t,[{kind:1,text:x.yes,result:6},{kind:3,text:x.no,result:3},{kind:2,text:x.cancel,result:1}]);break;case 6:this.generateBtns(t,[{kind:4,text:x.delete,result:7},{kind:2,text:x.cancel,result:1}]);break;case 7:this.generateBtns(t,[{kind:4,text:x.delete,result:7},{kind:2,text:x.goBack,result:8}]);break;default:throw new Error("Could not locate message box button of type {0}.".format(e))}this.defaultBtn&&s.defaultButtonText&&this.defaultBtn.text(s.defaultButtonText),this.cancelBtn&&s.cancelButtonText&&this.cancelBtn.text(s.cancelButtonText),this.extraBtn&&s.extraButtonText&&this.extraBtn.text(s.extraButtonText)}}_setAria(){const e=this.element,t=e.find(`.${C}`),s=f(),i=f();e.attr({role:"dialog","aria-labelledby":i,"aria-describedby":t.length?s:null}),e.find("h2").attr("id",i),t.attr("id",s),this.ltm.registerForDispose((()=>{e.removeAttr("role aria-labelledby aria-describedby tabindex")}))}}t.Widget=F})),
define("MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox","FxInternal/Controls/Section","Fx/Controls/Section","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox.css"],(function(e,t,s,i,o,n,r,a,l,c){"use strict";t.Widget=t.ViewModel=void 0,t.createFormDialogWithCallback=function(e,t,s){const o=new m(s);return o.onButtonClick=s=>{4===s?i.ensureFormFieldValidation(e,!0).then((o=>{o?t(s):i.focusOnFirstInvalidField(e)})):t(s)},new g(e,o)};var d=s;(0,l.injectCss)(c);const p="fxs-formdialog",u=d.tsx(s.Root,null,d.tsx("div",{class:"fxs-formdialog-description fxs-messagebox-text","data-bind":{text:"description"}}),d.tsx("div",{class:"fxs-formdialog-form msportalfx-form","data-bind":{pcControl:"formSection"}}));class m extends o.ViewModel{constructor(e,t){if(super(),this.diContainer=t,this.lifetime=new FxImpl.TriggerableLifetimeManager,MsPortalFx.isNullOrUndefined(e))throw new Error("dialogOptions must be specified for rendering a form dialog.");const s=[[e.row1column1,e.row1column2],[e.row2column1,e.row2column2]],i=this.lifetime,o=s.map((e=>{const t=e.filter(MsPortalFx.identity).map((e=>n.create(i,{style:0,children:[e]})));if(t.length)return n.create(i,{style:3,children:t})})).filter(MsPortalFx.identity),l=r.create(i,{children:o});this.title(e.title),this.customBtns=[{kind:1,result:4,text:a.Dialogs.okButtonText,disabled:ko.computed(i,(()=>!l.valid()))},{kind:2,result:1,text:a.Dialogs.cancelButtonText}],this.template(u),this.templateViewModel({description:e.description,formSection:l}),this.trustedTemplate=!0}dispose(){this.lifetime.dispose()}}t.ViewModel=m;class g extends o.Widget{constructor(e,t){super(e,t),e.addClass(p)}dispose(){this.options.dispose(),this._cleanElement(p),super.dispose()}}t.Widget=g})),
define("_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup.css",["module"],(function(e){"use strict";return{css:".fxs-listpopup{display:inline-block;cursor:default;position:absolute;left:0;width:200px;max-height:300px;z-index:200;overflow-y:auto;box-sizing:border-box}.fxs-listpopup-list{list-style-type:none;padding:0;max-height:300px}.fxs-listpopup-item{font-size:13px;line-height:normal;display:flex;align-items:center;flex:0 0 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;position:relative;box-sizing:border-box;padding:0 10px;border:0;overflow:visible;text-align:left;height:35px;cursor:pointer}",moduleId:e.id}})),
define("MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Widgets/Widgets.WidgetBase","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup.css","Fx"],(function(e,t,s,i,o,n,r,a,l,c){"use strict";t.Widget=t.ViewModel=void 0,t.createListPopupWithCallback=function(e,t,s,i){const o=new M;return o.dialogOptions=i,o.onItemSelected=()=>{s(4)},o.onLostFocus=e,new C(t,o)},(0,a.injectCss)(l);var d=MsPortalFx.Base.Diagnostics;const p=".fxs-commandBar-item",u=".azc-toolbarButton-container:first",m="fxs-listpopup",g=d.createLog(e),h="fxs-portal-bg-txt-br",f="msportalfx-shadow-level2",x="fxs-popup",b="fxs-listpopup-list",y="fxs-listpopup-item",v=`.${y}`,w=s.tsx("ul",{class:b,"data-bind":{foreach:"func._items"},role:"menu"},s.tsx("li",{role:"menuitemradio",class:[y,"fxs-portal-hover"],tabindex:"-1","data-bind":{text:"text",css:{"fxs-listpopup-item-selected fxs-portal-selected fxs-portal-activated fxs-br-primary":"text === $root.data.dialogOptions.selectedItem()"},event:{click:"onClick",keydown:"onKeyDown"},attr:{title:"text","aria-setsize":"$parent.func._items().length","aria-posinset":"$index() + 1","aria-checked":'text === $root.data.dialogOptions.selectedItem() ? "true" : "false"'}}}));class M extends r.ViewModel{}t.ViewModel=M;class C extends r.Widget{constructor(e,t){super(e,t),t.dialogOptions||g.error("dialogOptions must be specified for rendering a list popup.");const s=document.activeElement,r=t=>t===s||$.contains(s,t)||e[0]===t||$.contains(e[0],t)?0:2,a=this._dismissHandle={dismissFn:()=>{const e=t.onLostFocus;e&&e()},shouldDismissOnFocusOutFn:r,shouldDismissOnMouseDownFn:r,shouldDismissOnMouseWheelFn:r,restoreFocus:()=>{i.validatePreviousFocusedElement(a,s)&&s.focus()},logName:"listpopup"};this._items=ko.computed(this.ltm,(()=>{const e=e=>{"function"==typeof t.onItemSelected&&(t.dialogOptions.selectedItem(e),t.onItemSelected(),a.restoreFocus())};return t.dialogOptions.listItems().map((t=>({text:t,onClick:(s,i)=>{i.stopPropagation(),e(t)},onKeyDown:(s,i)=>{if(13!==i.keyCode&&32!==i.keyCode||0!==o.getModifierKeys(i))return!0;i.stopPropagation(),e(t)}})))})),e.addClass(`${m} ${x} ${h} ${f}`).html(w),new n.KeyboardNavigation(this.ltm,{element:e.find(`.${b}`),tabTriggers:12,itemSelector:v}),e.closest(p).find(u).attr("aria-expanded","true"),this._bindDescendants(),c.nextTick((()=>{this.setFocus()})),i.register(a)}dispose(){i.unregister(this._dismissHandle),this._cleanElement(m,x,h,f),this.element.removeAttr("tabindex").closest(p).find(u).attr("aria-expanded","false"),super.dispose()}setFocus(){this.element.find(v).first().focus()}}t.Widget=C})),
define("MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox.css"],(function(e,t,s,i,o,n,r){"use strict";t.Widget=t.ViewModel=void 0,t.createProgressBox=function(e,t){const s=new p(t.text,t.completionPercentage);return s.title(t.title),s.customBtns=[],new u(e,s)};var a=s;(0,n.injectCss)(r);const l=i.Dialogs.ProgressBar,c="fxs-progressbox",d=a.tsx(s.Root,null,a.tsx("div",{"data-bind":{text:"data.text"},class:"fxs-progressbox-text fxs-messagebox-text"}),a.tsx("div",{"data-bind":{text:"data.completionText"},class:"fxs-progressbox-progressbar"}));class p extends o.ViewModel{constructor(e,t){super(),this.text=ko.observable(),this.completionPercentage=ko.observable(-1),ko.isObservable(e)&&(this.text=e),ko.isObservable(t)&&(this.completionPercentage=t),this.completionText=ko.pureComputed((()=>{const e=this.completionPercentage();return e<0||e>100?"":l.percentComplete.format(e)})),this.template(d),this.templateViewModel({data:{text:this.text,completionText:this.completionText}}),this.trustedTemplate=!0}}t.ViewModel=p;class u extends o.Widget{constructor(e,t){super(e,t),e.addClass(c)}dispose(){this._cleanElement(c),super.dispose()}}t.Widget=u})),
define("_generated/MsPortalImpl/Svg/Startup/Error.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=77,t.data="<svg viewBox='0 0 2048 2048' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M960 0q133 0 255 34t230 96 194 150 150 195 97 229 34 256q0 133-34 255t-96 230-150 194-195 150-229 97-256 34q-133 0-255-34t-230-96-194-150-150-195-97-229T0 960q0-133 34-255t96-230 150-194 195-150 229-97T960 0zm0 1792q114 0 220-30t199-84 169-130 130-168 84-199 30-221q0-114-30-220t-84-199-130-169-168-130-199-84-221-30q-115 0-221 30t-198 84-169 130-130 168-84 199-30 221q0 114 30 220t84 199 130 169 168 130 199 84 221 30zM896 512h128v640H896V512zm0 768h128v128H896v-128z'/></g></svg>"})),
define("MsPortalImpl/UI/UI.DialogManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Dialogs/MessageBoxInternal","MsPortalImpl/Base/Themes","MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog","MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup","MsPortalImpl/Services/Services.PortalIdleState","MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox","_generated/MsPortalImpl/Svg/Startup/Error.svg","_generated/MsPortalImpl/Svg/Startup/Warning.svg","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox","MsPortalImpl/Base/Base.SvgHelper","FxInternal/Composition/ContainerViewModel","FxInternal"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f){"use strict";t.MessageBox=t.DialogManager=void 0;var x=MsPortalFx.Base,b=x.Diagnostics,y=b.Telemetry;const v=$(window.document.body),w=b.createLog(e),M="Shell";function C(e){return"The {0} used to render the dialog was not specified.".format(e)}var S=t.MessageBox=i.MessageBoxExtended;class I{constructor(e,t){this._portalIdleService=e,this._diContainer=t}get hasOpenDialog(){return!!this._dismissOpenDialog}dismissOpenDialog(e){this._dismissOpenDialog&&(this._dismissOpenDialog(e),this._dismissOpenDialog=null)}showModalDialog(e){const t=$(FxImpl.createElement("div",{class:"fxs-portal-shield-icon"})),s=$(FxImpl.createElement("div")),i=$(FxImpl.createElement("div",{class:"fxs-portal-shield-modaldialog"}));i.append(t,s);const o=$(FxImpl.createElement("div",{class:"fxs-portal-shield-middle"})),n=$(FxImpl.createElement("div",{class:"fxs-portal-shield"}));let r,a;o.append(i),n.append(o),v.append(n),e.showErrorIcon?(r=g.getSvgReferenceOrFallBackToData(MsPortalFx.extend2(c,{data:_(c.data,"msportalfx-svg-c22")})),a="fxs-portal-shield-icon-error"):(r=g.getSvgReferenceOrFallBackToData(MsPortalFx.extend2(d,{data:_(d.data,"msportalfx-svg-c10")})),a="fxs-portal-shield-icon-warning"),t.empty().addClass(a).append(r),this._currentCancelToken&&(this._currentCancelToken.cancel(),this._currentCancelToken=null);const l=new S(e.title,e.description,e.buttons);return l.defaultButtonText=e.defaultButtonText,l.cancelButtonText=e.cancelButtonText,l.templateViewModel=e.templateViewModel,this._showDialog(s,l,{modal:!0,trustedTemplate:!0,locator:null}).then((s=>{const i=e.uiShield&&e.uiShield.hidePromise;return i?(this._currentCancelToken=new x.Promises.CancelationToken,x.Promises.makeCancelable(i,this._currentCancelToken).then((()=>{n.remove()}))):n.remove(),t.removeClass(a),s})).finally((()=>{this._portalIdleService.signalBusy()}))}showDialog(e,t,s,i){if(!e)throw new Error(C("dialogOptions"));if(!t)throw new Error(C("formTarget"));if(!s)throw new Error(C("sourceTarget"));(i=i||{}).modal=!1,i.sourceTarget=s,this.dismissOpenDialog();const o=$(k(t.getForm())),n=this._showDialog(o,e,i,t);return t.showForm(s,{modal:!1,positionHint:e.positionHint||6}),n}showShellDialog(e,t,s,i){if(!e)return Promise.reject(C("dialogOptions"));if(!t)return Promise.reject(C("formTarget"));if(!s)return Promise.reject(C("sourceTarget"));const o=Promise.withResolvers();i=i||{},this.dismissOpenDialog();const{element:n,ltm:r}=function(e){if(e)return e instanceof Element?{element:e,ltm:(ko.dataFor(e).func||ko.contextFor(e).$ctl).ltm}:e}(t.getForm()),a=$(n),l=this._showDialog(a,e,i,t);return t.showForm(s,{modal:i.modal||!1,positionHint:e.positionHint||6}),r.registerForDispose([a.setEvents(["closed",()=>{o.resolve(1)}])]),l.then(o.resolve).catch(o.reject),o.promise}_showDialog(e,t,s,i){return f.tryImmediateResolve(this._diContainer.getAsync(o.ThemeManager),(()=>{const o=Promise.withResolvers(),a=e=>{s.syncCallback&&s.syncCallback(e),o.resolve(e)},c=()=>{i&&i.hideForm()},d=t.telemetryName;let g=s.locator;g||s.modal||(g=function(e,t){const s=e.closest(".fxs-tile").data(p.CompositionInstanceDataName);let i;s&&(0,p.isPartComposition)(s)?i=s.locator:t||w.error("Unable to determine the extension that opened the dialog. "+MsPortalFx.getCurrentCallStack(!0));return i}(e,s.sideload)),4!==t.type&&(e=function(e){const t=e.closest(".fxs-bladecontent"),s=u.Widget.getWidgets(t);if(s&&s.length){const t=s[0];e=$(k(t.getForm()))}return e}(e));const f=function(e,t,s,i,o){let a;switch(s.type){case 1:a=m.createMessageBoxWithCallback(t,o,s,i);break;case 2:a=l.createProgressBox(t,s);break;case 4:a=r.createListPopupWithCallback((()=>{e.dismissOpenDialog()}),t,o,s);break;case 3:a=n.createFormDialogWithCallback(t,o,s);break;case h.Dlg2:a=m.createMessageBoxWithCallback2(t,o,s,i)}return a}(this,e,t,s,a);return function(e,t){T("DialogOpened",e,t)}(g,d),f?(this._dismissOpenDialog=e=>{f.dispose(),c(),MsPortalFx.isNullOrUndefined(e)?(F(g,"Dismissed",d),o.reject()):(a(e),F(g,e,d))},o.promise.then((e=>(f.dispose(),this._dismissOpenDialog=null,c(),F(g,e,d),e)))):(c(),F(g,"InvalidDialogType",d),o.reject("Invalid type specified in dialogOptions.")),o.promise}))}}class P{static create(e,t){return new I(e,t)}}function _(e,t){const s=MsPortalFx.getUniqueId();return e.replaceAll(t,s).replaceAll("msportalfx-svg-c01",t).replaceAll(s,"msportalfx-svg-c01")}function F(e,t,s){T("DialogClosed",e,s,t+"")}function T(e,t,s,i){s=s?"/"+s:"fxDefault";const o=`${t&&t.toFriendlyString()}/${s}`;y.trace({source:M,name:o,action:e,extension:t&&t.getExtensionName(),data:i})}function k(e){return e&&(e instanceof Element?e:e.element)}t.DialogManager=P,__decorate([__metadata("fx:diagnostics",[e,"DialogManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[a.PortalIdleStateService,s.Container]),__metadata("design:returntype",P)],P,"create",null)})),
define("MsPortalImpl/UI/Hubs/UI.NotificationManager",["require","exports","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Resources/PortalNotificationsTelemetry","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/UI/Hubs/UI.ActionableNotifications","MsPortalImpl/UI/UI.BladeOpener","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/UI.NavigationManager","FxInternal/AsyncLoader","FxInternal/Authentication/TokensCommon","FxInternal/Notifications","FxInternal/Utils/NotificationUtils","FxInternal/RpcEndPoints","FxHubs/Helpers/NotificationHelper","Fx/Ajax","Fx/Composition/Selectable","Fx/DependencyInjection","Fx/ResourceManagement","Weave"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x,b,y,v,w,M,C,S){"use strict";t.addNotification2Handler=t.addFxNotificationHandler=t.addClientNotificationsHandler=t.addClientNotificationHandler=t.NotificationManager=t.NotificationHandler=t.DEV=void 0,t.createNotificationManager=function(e){return G=e.get(J)},t.getNotificationData=X,t.getNotificationManager=function(){return G},t.updateNotificationHandler=t.showModalNotificationHandler=void 0;var I=MsPortalFx.Base,P=I.Constants,_=P.AssetNames,F=I.Diagnostics,T=(F.LogEntryLevel,F.Telemetry),k=M.Container,E=MsPortalFx.Hubs.Notifications,D=E.ClientNotification,A=E.NotificationStatus,B=FxImpl.Hubs.Notifications,N=B.ClientNotificationUriAction,R=FxImpl.NotificationManager;const L=window,z=F.createLog(e),H=r.Source.NotificationHub,O=N.OpenInNewTab,U=P.Shell.toLowerCase(),W="HubsExtension".toLowerCase(),V=MsPortalFx.getLogFriendlyMessage,q=Object.entries,$=Object.keys,j=new WeakMap;let G;const K=e=>(t,s)=>{const i=s.srcWindowId;if(i){MsPortalFx.merge(t).forEach((t=>{const s=i+"#";t.notificationId.startsWith(s)||(t.notificationId=s+t.notificationId),e._addOrUpdateNotification(t,i)}))}};let J=t.NotificationManager=class{constructor(e){this._diContainer=e,this.notifications=ko.observableArray(),this._extensionNotifications={},this._serverEventToNotificationMap={},this._extensionsHeldByCorrelationId={},this._inProgressLookupTable=new Z,this.showModalNotification=(e,t)=>{const s=t.notification;return this.addClientNotification(s),e.getAsync(u.DialogManager).then((e=>(this.addClientNotification(s),e.showModalDialog({title:s.title,description:s.description,buttons:2,defaultButtonText:t.primaryButtonText,cancelButtonText:t.secondaryButtonText,showErrorIcon:!0})))).then((i=>{let o;return 4===i?o=t.primaryButtonClickAction:1===i&&(o=t.secondaryButtonClickAction),1===o?this.handleNotificationClick(s):2===o&&e.get(m.WindowManager).redirect({uri:"/",reason:"ModalNotificationClickAction_RefreshPortal"}),i}))},this._rpcClient=e.get(FxImpl.Rpc.Client),this._pollingNotificationLookupTable=new Y(e),this.itemsPromise=e.get(o.ManifestCache).getManifests("assetTypes",((e,t)=>this._collectNotificationDefinitions(e,t)))}addNotification2(e,t){const s=t;return s&&this.itemsPromise.finally((()=>{const t=this._mapNotificationV2ToClientNotification(s,e.id,e.name,e.status,e.subStatus,e.assetId,e.properties);this._addOrUpdateNotification(t,s)})),null}registerCustomNotificationsProvider(e){if(this._diContainer.get(FxImpl.Features).isEnabled("enablecustomnotificationsprovider")){const t=new FxImpl.TriggerableLifetimeManager;this.notifications.subscribeAndRun(t,(t=>{e.notifications(t)}))}}updateNotification(e){return this.itemsPromise.finally((()=>{const t=MsPortalFx.find(this.notifications(),(t=>(t.correlationIds||[]).some((t=>t.toLowerCase()===e.id))));if(t){const s=e.propertyName.toLowerCase(),i=e.propertyValue;let o=t.correlationIds;"correlationid"===s?(o||(t.correlationIds=o=[]),o.push(i),this._addOrUpdateNotification(t)):s==="percentComplete".toLowerCase()&&(t.percentComplete=i,this._addOrUpdateNotification(t))}})),null}addServerEvents(e){return e.forEach((e=>{e&&this.itemsPromise.finally((()=>{this._addServerEvent(e)}))})),null}addClientNotification(e){le(e),this._addOrUpdateNotification(e)}addPendingNotification(e){const t=(0,x.serializePendingNotification)(e,!0),s=e=>{this._addOrUpdateNotification(e)};return(0,x.validatePendingNotification)(t)?(s(t),(0,x.createPendingNotificationReturnObject)(t,!0,s)):null}addSingleNotification(e){const t=(0,x.serializeNotification)(e,!0);return(0,x.validateNotification)(t)?((()=>{this._addOrUpdateNotification(t)})(),{id:t.id}):null}showNotificationDetails(e){ae(this._diContainer,ee(e))}handleNotificationClick(e,t){!function(e,t,i){const o=t.isRecommendation?r.ActionInternal.RecommendationClicked:r.ActionInternal.NotificationClicked;re(t,o);const a=t.asset||{},l=a.assetType;if(l){const t=l.toLowerCase(),o=a.extensionName.toLowerCase(),r=e.get(n.ExtensionManager);if(i||!r.getExtension("Microsoft_Azure_Monitoring")||o==="Microsoft_Azure_Billing".toLowerCase()&&t===_.SubscriptionDetail.toLowerCase()||o==="HubsExtension".toLowerCase()&&t===_.Deployments.toLowerCase()){const t={deepLink:(0,s.getAssetDeepLink)(e,a),openedBy:6};return void e.get(c.RoutePortalFunc).invoke({uri:t.deepLink,openedByContext:t},H)}}const d=t.uri;if(d){const s=t.uriAction||I.Resources.isUriAbsolute(d)&&O||N.NavigatePortal;if(s===O)e.get(m.WindowManager).openWindow(d);else if(s===N.OpenInCurrentTab)L.location.href=d;else{const t={deepLink:d,openedBy:6};e.get(c.RoutePortalFunc).invoke({uri:d,openedByContext:t},H)}return}const u=t.linkTo;if(u){if("string"==typeof u){const t={deepLink:u,openedBy:6};return void(u.startsWith("#")?e.get(c.RoutePortalFunc).invoke({uri:u,openedByContext:t},H):e.get(m.WindowManager).openWindow(u))}if(u.parameters?.blade&&u.parameters?.extension){const t=u.parameters?.openInContextPane?1:8,s=new w.PdlBladeReference(u.parameters.blade,u.parameters.extension,{parameters:u.parameters?.parameters});return void e.get(p.BladeOpener).openBlade(s,{flags:t,telemetryName:"NotificationManager.linkTo",context:{openedBy:6}})}if(u.parameters){const t=u.parameters?.openInContextPane?1:8;return void e.get(p.BladeOpener).openBlade(u,{flags:t,telemetryName:"NotificationManager.linkTo",context:{openedBy:6}})}}let g=t.linkedBlade;g||i||(g=ee(t));g&&ae(e,g)}(this._diContainer,e,t)}newDefinitionCount(){return $(this._extensionNotifications).length}serverEventsCount(){return $(this._serverEventToNotificationMap).length}removeNotification(e){const t=MsPortalFx.find(this.notifications(),(t=>(t.correlationIds||[]).some((t=>t===e))));t&&this.notifications.remove(t)}_addOrUpdateNotification(e,t){if(e&&oe(e.title)&&function(e){if("string"==typeof e)return!!oe(e);return!!oe(e?.htmlTemplate)}(e.description)){const s=()=>{if(e.clickable=!!(e.asset||e.linkedBlade||e.uri||e.linkTo),function(e){if(e.id)return;e.notificationId||(e.notificationId=D.generateClientNotificationId())}(e),e.inlineForm?.buttons||Array.isArray(e.actions))(e.inlineForm?.buttons||e.actions||[]).forEach(((e,t)=>{e.id=e.id||t.toString()}));else if(e.actions&&"object"==typeof e.actions){const t=e.actions;t.id=t.id||"0"}if(e.timeSinceNotified||(e.timeSinceNotified=(0,S.makeWritableComputation)(a.NotificationManager.aFewSecondsAgo)),e=function(e,t){if("object"==typeof e.description&&e.description.htmlTemplate)return e;if(null!==e.descriptionAsHtml&&void 0!==e.descriptionAsHtml)return e;const s=e.description;if(s.match(y.htmlTagRegex))return e;const i=(0,y.convertStringToHtml)(s);if(i!==s)return ce(r.ActionInternal.ConvertedLinksInNotificationDescription,null,{correlationIds:e.correlationIds,extensionName:t,id:e.notificationId??e.id}),{...e,descriptionAsHtml:!0,description:{htmlTemplate:i}};return e}(e,t),e.descriptionAsHtml||(e.descriptionAsHtml=!1),e.id||(e.correlationIds||[]).length||(e.correlationIds=[D.generateClientNotificationId()]),!e.correlationIds&&e.id&&(e.correlationIds=[e.id]),e.pollingDetails){if(3!==e.status)return;this._pollingNotificationLookupTable.add(e,t)}3===e.status?this._inProgressLookupTable.add(e.correlationIds):this._inProgressLookupTable.report(e.correlationIds,e.status);let s=this.notifications();const i=MsPortalFx.find(s,(t=>(t.correlationIds||[]).some((t=>e.correlationIds.includes(t)))));if(i){if(!(i.timestamp.getTime()<e.timestamp.getTime()||3===i.status))return;MsPortalFx.remove(s,i)}s.unshift(e),3!==e.status&&(s=MsPortalFx.stableSort(s,((e,t)=>3===e.status?3===t.status?0:-1:3===t.status?1:t.timestamp.getTime()-e.timestamp.getTime()))),s.length>100&&s.pop(),this.notifications(s),e.isRecommendation&&re(e,r.ActionInternal.RecommendationAdded),t&&(X(e).extensionName=t,this._holdOntoExtension(t,e))};d.makeActionable(e,this._diContainer),s()}}_addServerEvent(e){if(e.source&&e.operationName){const t=this._serverEventToNotificationMap[se(e.source,e.operationName)];if(t){ne({extensionName:e.source,action:"DeprecatedNotificationApiCalled",handlerName:"addServerEvent",status:e.status});const s=this._mapNotificationV2ToClientNotification(t.extensionWindowId,e.correlationId,t.notificationName,e.status,e.subStatus,e.assetId,e.properties,e.timestamp,!0);s&&this.addClientNotification(s)}}return null}_collectNotificationDefinitions(e,t){const s=t.notifications2;s&&s.forEach((t=>{const s=t.name,i=se(e,s);this._extensionNotifications[i]=t;const o=t.serverEvent;if(o&&o.operation&&o.source){const t=se(o.source,o.operation);this._serverEventToNotificationMap[t]={extensionWindowId:e,notificationName:s}}}))}_holdOntoExtension(e,t){const s=t.correlationIds;if(s)if(3===t.status){if(!s.some((e=>!!this._extensionsHeldByCorrelationId[e]))){const t=this._diContainer.get(n.ExtensionManager).getExtension(e);if(t){const i=this._rpcClient.acquireWindow(t.name,6e5);ce(r.ActionInternal.ExtensionExtended,null,{acquireResult:i?.getValue(),extensionAcquireDurationInMs:6e5,extensionName:e}),s.forEach((t=>{this._extensionsHeldByCorrelationId[t]=i,i.onDispose((()=>{this._extensionsHeldByCorrelationId[t]&&(delete this._extensionsHeldByCorrelationId[t],ce(r.ActionInternal.ExtensionDisposed,null,{acquireResult:i?.getValue(),extensionAcquireDurationInMs:6e5,extensionName:e}))}))}))}}}else s.forEach((e=>{const t=this._extensionsHeldByCorrelationId[e];t&&t.dispose()}))}_mapNotificationV2ToClientNotification(e,t,s,i,o,n,a,l,c=!1){const d=this._extensionNotifications[se(e,s)];if(d){let p;const u=d.messages.filter((e=>e.status.toLowerCase()===i.toLowerCase()));if(o?p=MsPortalFx.find(u,(e=>e.subStatus&&e.subStatus.toLowerCase()===o.toLowerCase())):1===u.length&&(p=u[0]),p){let u=p.message;a&&(u=u.format(a));const m={title:p.title,description:u,timestamp:l||new Date,isRecommendation:!1,status:te(p.type),correlationIds:[t],additionalProperties:[],isServerEvent:c};if((p.assetType||d.assetType)&&n){const t=p.assetType||d.assetType;m.asset={extensionName:e,assetType:t,assetId:n}}return ce(r.ActionInternal.ServerEventMappedToNotification,null,{extensionName:e,operationName:(s?.split(".")??[])[1]??s,status:i,subStatus:o,isServerEvent:c}),m}}return null}};t.NotificationManager=J=__decorate([__metadata("fx:diagnostics",[e,"NotificationManager"]),M.Class(),__metadata("design:paramtypes",[k])],J);let Q=t.NotificationHandler=class{notificationCallback(e){const t=e.diContainer.get(J);return ne({extensionName:e.messageContext.srcWindowId,action:"NotificationApiCalled",handlerName:"notificationCallback",status:e.messageArg?.status}),K(t)(e.messageArg,e.messageContext)}notificationsCallback(e){const t=e.diContainer.get(J);return ne({extensionName:e.messageContext.srcWindowId,action:"NotificationApiCalled",handlerName:"notificationsCallback",status:e.messageArg?.[0]?.status}),K(t)(e.messageArg,e.messageContext)}fxNotificationCallback(e){const t=e.diContainer.get(J);return ne({extensionName:e.messageContext.srcWindowId,action:"NotificationApiCalled",handlerName:"fxNotificationCallback",status:e.messageArg?.[0]?.status,pollingDetails:e.messageArg?.[0]?.pollingDetails,origin:e.messageArg[1],id:e.messageArg?.[0]?.id}),(e=>(t,s)=>{const i=s.srcWindowId;if(i){const s=t;let o=i;const n=i+"#",r=s.id.indexOf("#");r<0?s.id=n+s.id:o=s.id.slice(0,r),e._addOrUpdateNotification(s,o)}})(t)(e.messageArg[0],e.messageContext)}showModalNotification(e){const t=e.diContainer.get(J);return ne({extensionName:e.messageContext.srcWindowId,action:"DeprecatedNotificationApiCalled",handlerName:"showModalNotification"}),t.showModalNotification(e.diContainer,e.messageArg)}updateNotification(t){const s=t.diContainer.get(J),o=t.messageContext.srcWindowId;return ne({extensionName:o,action:"DeprecatedNotificationApiCalled",handlerName:"updateNotification"}),(0,i.logToExtension)(e,o,2,"Obsolete MsPortalFx.UI.NotificationManager.Notification2.(updateCorrelationId|reportProgress) called. Use publishNotification or publishPendingNotification from Fx/Notifications instead."),s.updateNotification(t.messageArg)}addNotification2(t){const s=t.diContainer.get(J),o=t.messageContext.srcWindowId;return ne({extensionName:o,action:"DeprecatedNotificationApiCalled",handlerName:"addNotification2"}),(0,i.logToExtension)(e,o,2,"Obsolete MsPortalFx.UI.NotificationManager.Notification2.raise called. Use publishNotification or publishPendingNotification from Fx/Notifications instead."),s.addNotification2(t.messageArg,o)}};t.NotificationHandler=Q=__decorate([__metadata("fx:diagnostics",[e,"NotificationHandler"]),M.Class()],Q);t.addClientNotificationHandler=(0,g.defineHandler)(B.addClientNotificationEndpoint,(e=>{e.diContainer.get(Q).notificationCallback(e)})),t.addClientNotificationsHandler=(0,g.defineHandler)(B.addClientNotificationsEndpoint,(e=>{e.diContainer.get(Q).notificationsCallback(e)})),t.addFxNotificationHandler=(0,g.defineHandler)(b.addFxNotificationEndpoint,(e=>{e.diContainer.get(Q).fxNotificationCallback(e)})),t.showModalNotificationHandler=(0,g.defineHandler)(B.showModalNotificationEndpoint,(e=>e.diContainer.get(Q).showModalNotification(e))),t.updateNotificationHandler=(0,g.defineHandler)(R.updateNotificationEndPoint,(e=>e.diContainer.get(Q).updateNotification(e))),t.addNotification2Handler=(0,g.defineHandler)(R.addNotification2EndPoint,(e=>e.diContainer.get(Q).addNotification2(e)));function X(e){let t;return e&&(t=j.get(e),t||j.set(e,t={extensionName:void 0,userVote:(0,S.makeWritableComputation)()})),t}class Z{constructor(){this.notificationTable=Object.create(null)}_encode(e){return e.join("~")}add(e){const t=this._encode(e);this.notificationTable[t]||(this.notificationTable[t]=Date.now(),ce(r.ActionInternal.InProgressNotification,r.ActionModifier.InProgressStarted,{createdAt:this.notificationTable[t],ids:t}))}report(e,t){const s=this._encode(e),i=this.notificationTable[s];i&&(ce(r.ActionInternal.InProgressNotification,r.ActionModifier.InProgressFinished,{createdAt:i,duration:Date.now()-i,ids:s,status:t}),this.notificationTable[s]=0)}}class Y{constructor(e){this._diContainer=e,this._notificationTable=Object.create(null),this._trustedDomainsByExtension={},this._securityTokensManager=this._diContainer.get(l.SecurityTokensManager),this._extConfigPromise=this._diContainer.get(o.ManifestCache).getManifests("extensionConfiguration",((e,t)=>this._collectTrustedDomainDefinitions(e,t)));try{const e=JSON.parse(MsPortalImpl.sessionStorage.getItem("NotificationsToPollList")||null)||Object.create(null);if("object"==typeof e){const t=$(e).filter((t=>function(e,t){if(!t)return pe(e,t,"Empty record"),!1;if(!t.originalNotification?.id)return pe(e,t,"original notification / original notification id"),!1;if(!t.uri)return pe(e,t,"uri"),!1;if(!t.extensionName)return pe(e,t,"extension name"),!1;if(!(t.originalNotification.title||"").trim()||!function(e){if(!e)return!1;if("object"==typeof e)return!!(e?.htmlTemplate||"").trim();return!!(e||"").trim()}(t.originalNotification.description))return pe(e,t,"original notification title / description"),!1;(isNaN(t.createdTime)||t.createdTime<0)&&(pe(e,t,"created time"),t.createdTime=0);(isNaN(t.lastTimePolled)||t.lastTimePolled<0)&&(pe(e,t,"last time polled"),t.lastTimePolled=0);(isNaN(t.userTimePassedInMs)||t.userTimePassedInMs<0)&&(pe(e,t,"user time passed in ms"),t.userTimePassedInMs=0);(isNaN(t.lastUserTimeChecked)||t.lastUserTimeChecked<0)&&(pe(e,t,"last user time checked"),t.lastUserTimeChecked=ie());return t.isPolling=!1,!0}(t,e[t])));let s=Object.create(null);$(this._notificationTable).length&&(s=this._notificationTable),this._notificationTable=e,q(s).forEach((e=>{this._notificationTable[e[0]]=e[1]})),this._rehydrateInProgressNotifications(t)}else MsPortalImpl.sessionStorage.removeItem("NotificationsToPollList"),z.warning(`${H}-${r.ActionInternal.PollingNotification}-${r.ActionModifier.FailedToFetchNotificationsFromStorage}`,null)}catch(e){z.warning(`${H}-${r.ActionInternal.PollingNotification}-${r.ActionModifier.FailedToFetchNotificationsFromStorage}`,null,V(e))}setTimeout((()=>{setInterval((()=>{this._cleanOutOldNotifications();const e=this._findNotificationsForPolling();e.length&&this._extConfigPromise.finally((()=>{this._pollNotifications(e)}))}),5e3)}),6e4)}_cleanOutOldNotifications(){const t=ie();$(this._notificationTable).filter((e=>{const s=this._notificationTable[e];if(!s)return!1;const i=s.originalNotification?.pollingDetails?.pollingTimeout?.timeoutInMs??864e5,o=t-s.lastUserTimeChecked;return s.lastUserTimeChecked=t,s.userTimePassedInMs+=o,s.userTimePassedInMs>=864e5||s.userTimePassedInMs>=i})).forEach((t=>{const s=this._notificationTable[t];let o=`${H}-${r.ActionInternal.PollingNotification}-${r.ActionModifier.PollingTimedOut}`;const n=s?.originalNotification?.pollingDetails?.pollingTimeout?.failureNotification&&s.originalNotification.pollingDetails.pollingTimeout.telemetryName;o+=n?`-${n}`:"";const a={createdTime:new Date(s?.createdTime),extensionName:s?.extensionName,failedAt:new Date,notificationId:t,telemetryName:o,uri:s?.uri};try{const t=JSON.stringify(a);(0,i.logToExtension)(e,s?.extensionName,2,t)}catch{ce(r.ActionInternal.PollingNotification,r.ActionModifier.PollingTimedOut,a)}this._handleFailedPollingAttempt(s,!0),this._notificationTable[t]=null,delete this._notificationTable[t]})),ue(this._notificationTable)}_collectTrustedDomainDefinitions(e,t){const s=/([^:]*)/.exec(L.location.host)[1],i=t?.extensionConfiguration;i?Array.isArray(i[s]?.trustedDomains)?this._trustedDomainsByExtension[e]=i[s].trustedDomains:Array.isArray(i["*"]?.trustedDomains)&&i["*"].trustedDomains.length?this._trustedDomainsByExtension[e]=i["*"].trustedDomains:this._trustedDomainsByExtension[e]=[]:this._trustedDomainsByExtension[e]=[]}_findNotificationsForPolling(){const e=[];return $(this._notificationTable).filter((e=>!!this._notificationTable[e]&&!this._notificationTable[e].isPolling)).forEach((t=>{const s=this._notificationTable[t];s&&function(e,t,s){const i=e>t?e-t:0;s=isNaN(s)?0:Number(s);let o=6e4;e<=12e4?o=5e3:e<=36e4?o=15e3:e<=66e4&&(o=3e4);return s>o?i>=s:i>=o}(s.userTimePassedInMs,s.lastTimePolled,s.originalNotification?.pollingDetails?.customDelayInMs)&&(s.isPolling=!0,e.push(s))})),e}_handleFailedPollingAttempt(t,s){const i=MsPortalFx.clone(t?.originalNotification||Object.create(null),!0,!0),o=i?.pollingDetails||Object.create(null);let n=s?o.pollingTimeout?.failureNotification??o.defaultFailureNotification:o.defaultFailureNotification;if(n){n={...n,status:2};const t=(0,x.createResponseNotification)(i,n);MsPortalFx.require(e.normalize("FxInternal/Notifications")).then((e=>{e.publishNotification(t)}))}}_pollNotifications(t){const s={},o=t.map((async e=>{const t=e?.originalNotification?.pollingDetails,i=e?.uri??t?.uri,o=(0,x.isArmUriMatch)(i),n=t?.authDetails;if(!i||o&&n)return de(e,i?"ARM/ARG uri detected, but authDetails were fetched.":"No pollingDetails/uri"),s[e?.originalNotification?.id]=!0,Promise.resolve(null);if(o)return(0,v.batch)({setTelemetryHeader:"PollingNotificationAPI_Polling_Batch",type:"GET",uri:i});let r,a=!1;if(n){const t=n.extensionName;if(!t)return de(e,"Non-ARM/ARG uri detected, but authDetails has no extensionName."),s[e?.originalNotification?.id]=!0,Promise.resolve(null);let o=n.resourceName,l=n.audience;if(!o){const s=await MsPortalEarly.extensionAuthMetadataInPortalConfig??Object.create(null),n=t===U?W:t,r=s[n.toLowerCase()]?.resourceAccessMap??Object.create(null);o=(Object.entries(r).map((e=>{const t=(0,h.isCommonEndPointMatch)(e[1].resource);return t?.length?[e[0],(0,h.translateCommonEndpoint)(t[0])]:[e[0],e[1].resource]})).find((e=>{if(i.includes(e[1]))return l=e[1],!0}))??["",""])[0].toLowerCase(),MsPortalFx.extend(e.originalNotification.pollingDetails.authDetails,{extensionName:t,resourceName:o,audience:l})}if(o&&(r=(await this._securityTokensManager.getToken({extensionName:t,isBackground:!1,resourceName:o,skipCache:!1,audience:l}))?.token?.header,!r))return de(e,`Could not fetch a token with extensionName: ${t} and resourceName: ${o}.`,null,o),s[e?.originalNotification?.id]=!0,Promise.resolve(null);if(!(0,x.isShellOrHubs)(t)&&this._trustedDomainsByExtension[t]?.length){a=FxImpl.getDomainValidator([...this._trustedDomainsByExtension[t]],!0).validateDomain(i)}}return(0,v.ajaxExtended)({setTelemetryHeader:"PollingNotificationAPI_Polling_Ajax",type:"GET",uri:i,headers:{"Content-Type":"application/json",...r&&{Authorization:r}},skipDomainValidation:a}).then((e=>({httpStatusCode:e?.jqXHR?.status,content:e?.content,headers:{"Retry-After":e?.jqXHR?.getResponseHeader("Retry-After"),"x-ms-failure-cause":e?.jqXHR?.getResponseHeader("x-ms-failure-cause")}})),(e=>({httpStatusCode:e?.jqXHR?.status,content:e?.jqXHR?.responseJSON??e?.errorThrown,headers:{"Retry-After":e?.jqXHR?.getResponseHeader("Retry-After"),"x-ms-failure-cause":e?.jqXHR?.getResponseHeader("x-ms-failure-cause")}}))).catch((t=>(de(e,`Polling against non-ARM/ARG uri '${i} failed unexpectedly with: '${V(t)}`),s[e?.originalNotification?.id]=!0,null)))}));Promise.allSettled(o).then((e=>{const t=[];return e.forEach((e=>{"rejected"===e.status&&e?.reason?.content?t.push(e.reason):"fulfilled"===e.status&&e?.value?t.push(e.value):t.push(null)})),t})).then((o=>{const n=[];o.forEach(((o,a)=>{const l=t[a]?.originalNotification?.id;if(!o)return n.push(l),void(s[l]||de(t[a],"No response received from polling attempt"));const c=o.httpStatusCode,d=o.content;let p;p="string"==typeof d?c.toString():d?.properties?.provisioningState||d?.status||c.toString();const u=this._notificationTable[l],m=o.headers["Retry-After"],g=1e3*parseInt(m??0);if(g>(u.originalNotification.pollingDetails.customDelayInMs??0)&&(u.originalNotification.pollingDetails.customDelayInMs=g),!u){const e=t[a]||Object.create(null);return void ce(r.ActionInternal.PollingNotification,r.ActionModifier.PollingNotificationNotFound,{code:c,createdTime:new Date(e.createdTime),extensionName:e.extensionName,notificationId:l,uri:e.uri})}u.lastTimePolled=u.userTimePassedInMs;const h=u.originalNotification,b=h.pollingDetails,y=h.pollingDetails;if((b?.keepPollingCodes||[]).includes(c)||(y?.keepPollingStatuses||[]).includes(p))return void(u.isPolling=!1);const v=y?.keepPollingStatuses?(0,x.fetchNotificationPollingResponseDetailsByContentStatus)(y?.responseNotificationByStatus,p):(0,x.fetchNotificationPollingResponseDetailsByStatusCode)(b?.responseNotificationByStatusCode,c);if(v){let t=v.notification,s=v.telemetryName;const o=v.requiredResponseValue;let r,a=!0;if(o){if((0,f.checkForContinuedPollingContent)(o,d))return void(u.isPolling=!1);a=(0,f.checkForRequiredContent)(o,d);const e=o.failureNotification;if(!a&&!e)return void(u.isPolling=!1);let i;e&&(i={...e,status:2}),!a&&i&&(t=i,s=o.telemetryName?o.telemetryName:s)}if(r=a?(0,x.createResponseNotification)(h,t,d,u):(0,x.createResponseNotification)(h,t),r)return n.push(l),s&&(0,i.logToExtension)(e,u.extensionName,0,`NotificationId: ${l}. Telemetry Name: ${s}. Status: ${p}.`),void MsPortalFx.require(e.normalize("FxInternal/Notifications")).then((e=>{e.publishNotification(r)}));const c={...b.defaultFailureNotification,status:2},m=b?.defaultTelemetryName;if(m){const t=`Expected response content values weren't present for formatting title or description. Telemetry Name: ${m}. NotificationId: ${u.originalNotification?.id}. Status: ${p}`;(0,i.logToExtension)(e,u.extensionName,0,t)}return r=(0,x.createResponseNotification)(h,c),n.push(l),void MsPortalFx.require(e.normalize("FxInternal/Notifications")).then((e=>{e.publishNotification(r)}))}n.push(l),this._handleFailedPollingAttempt(this._notificationTable[l],!1),de(u,`Polling against uri '${u?.uri} failed with unanticipated HttpStatusCode: '${c}', and an x-ms-failure-cause of: ${(o.headers||Object.create(null))["x-ms-failure-cause"]}`,c)})),n.forEach((e=>{this._notificationTable[e]=null,delete this._notificationTable[e]})),ue(this._notificationTable)})).catch((e=>{ce(r.ActionInternal.PollingNotification,r.ActionModifier.PollingError,{error:V(e),extensionNames:t.map((e=>e.extensionName)),notificationIds:t.map((e=>e.originalNotification?.id)),uris:t.map((e=>e.uri))})}))}_rehydrateInProgressNotifications(t){const s=[];t.forEach((t=>{const i=this._notificationTable[t];i?(i.lastUserTimeChecked=ie(),i.isPolling=!1,i.userTimePassedInMs=i.userTimePassedInMs??0,MsPortalFx.require(e.normalize("FxInternal/Notifications")).then((e=>{i?.originalNotification?.id&&i.originalNotification.id===t&&e.publishPendingNotification({id:i.originalNotification.id,title:i.originalNotification?.title,description:i.originalNotification?.description,..."linkTo"in i.originalNotification&&{linkTo:i.originalNotification.linkTo},..."actions"in i.originalNotification&&{actions:i.originalNotification.actions},..."percentComplete"in i.originalNotification&&{percentComplete:i.originalNotification.percentComplete},...i.originalNotification.isInternal&&"toastDuration"in i.originalNotification&&{toastDuration:i.originalNotification.toastDuration}})}))):s.push(t)})),s.length&&ce(r.ActionInternal.PollingNotification,r.ActionModifier.FailedToTransferStoredNotification,{ids:s,failedAt:new Date})}add(e,t){const s=e.id;if(this._notificationTable[s])return;const i=e?.pollingDetails?.uri,o=ie();this._notificationTable[s]={createdTime:e?.timestamp.getTime()||o,extensionName:t,isPolling:!1,lastTimePolled:0,lastUserTimeChecked:o,originalNotification:e,uri:i,userTimePassedInMs:0},ce(r.ActionInternal.PollingNotification,r.ActionModifier.PollingRegistered,{createdTime:e?.timestamp,extensionName:t,notificationId:s,registeredTime:this._notificationTable[s].lastUserTimeChecked,uri:i}),ue(this._notificationTable)}}function ee(e){return le(e),FxImpl.ViewModels.getBladeSelection("Microsoft_Azure_ActivityLog","ActivityLogBlade",{queryInputs:{correlatedEvents:{correlationId:e.correlationIds[0],duration:e.timestamp.getMinutes(),subscriptionId:e.additionalProperties?.subscriptionId||null}}})}function te(e){switch(e){case 0:return A.Error;case 1:return A.Warning;case 2:return A.Success;case 3:return A.InProgress;case 4:return A.Information}}function se(e,t){if(e&&t)return`${e}.${t}`}function ie(){return(new Date).getTime()}function oe(e){return e&&e.trim()}function ne(e){ce(e.action,null,{extensionName:e.extensionName,handlerCalled:e.handlerName,origin:e.origin,isPending:e.status&&(3===e.status||e.status===E.NotificationStatus.InProgress),isPolling:!!e.pollingDetails,isExecuteAsyncOp:!!e.pollingDetails?.responseNotificationByStatus,id:e.id})}function re(e,t){let s=e.additionalProperties||{};const i=e.correlationIds,o=e.asset||{};s={...s,status:A[e.status],correlationId:i&&i.join(","),asset:o,notificationId:e.notificationId??e.id},ce(t,null,s)}function ae(e,t){const i=(0,s.getBladeDeepLink)(t.extension,t.detailBlade,t.detailBladeInputs),o={deepLink:i,openedBy:6};e.get(c.RoutePortalFunc).invoke({uri:i,openedByContext:o},H)}function le(e){if(e.additionalProperties||(e.additionalProperties={}),!e.additionalProperties.subscriptionId){const t=e.asset,s=t?.assetId,i=C.ArmId.parse(s,!0).subscription;e.additionalProperties.subscriptionId=i}}function ce(e,t,s){T.trace({source:H,action:e,actionModifier:t,data:s??Object.create(null)})}function de(t,s,o,n){const a=t.originalNotification?.pollingDetails?.defaultTelemetryName;let l=`${H}-${r.ActionInternal.PollingNotification}-${r.ActionModifier.PollingFailed}`;l+=a?`-${a}`:"";const c={createdTime:new Date(t.createdTime),extensionName:t.extensionName,notificationId:t.originalNotification.id,telemetryName:l,uri:t.uri,...o&&{code:o},...s&&{error:s},...n&&{resourceName:n}};try{const s=JSON.stringify(c);(0,i.logToExtension)(e,t?.extensionName,2,s)}catch{ce(r.ActionInternal.PollingNotification,r.ActionModifier.PollingFailed,c)}}function pe(e,t,s){ce(r.ActionInternal.PollingNotification,r.ActionModifier.IncorrectlyStoredPollingNotificationData,{corruptedValue:s,createdTime:new Date(t?.createdTime),extensionName:t?.extensionName,failedAt:new Date,lastTimePolled:t?.lastTimePolled,lastUserTimeChecked:new Date(t?.lastUserTimeChecked),notificationId:t?.originalNotification?.id,recordId:e,uri:t?.uri,userTimePassedInMs:t?.userTimePassedInMs})}function ue(e){try{const t=JSON.stringify(e);MsPortalImpl.sessionStorage.setItem("NotificationsToPollList",t)}catch(e){ce(r.ActionInternal.PollingNotification,r.ActionModifier.FailedToWriteNotificationsToStorage,{error:V(e)})}}})),
define("MsPortalImpl/Services/Services.Subscriptions",["require","exports","Fx/Ajax","Fx/DependencyInjection","FxHubs/ArmHelpers/ArmApisStartup","FxHubs/HubsSettingsSchema","FxHubs/RpcEndPoints","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers","MsPortalImpl/Services/SubscriptionAndLocationHelpers","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Tenants","FxInternal/ResourceManagement/Subscriptions","FxInternal/AsyncLoader","Weave","Fx","MsPortalImpl/UI/Hubs/UI.NotificationManager"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x){"use strict";t.setInSessionSelectedSubscriptionsHandler=t.searchSubscriptionArgQueryFormat=t.searchForSubscriptionsHandler=t.getSubscriptionInfoHandler=t.getSubscriptionArgQueryFormat=t.getInSessionSelectedSubscriptionsObservableHandler=t.getInSessionDisplayedSubscriptionsHandler=t.SubscriptionsUserContext=t.StartupSubscriptionsInfoProvider=t.ServicesSubscriptions=t.DEV=void 0;r.Subscriptions.CountTypeEnum;var b=MsPortalFx.Base.Diagnostics,y=b.Telemetry;const v=MsPortalFx.require,w=b.createLog(e),M=(0,f.isFeatureEnabled)("getselectedsubstelemetry");let C=(0,f.isFeatureEnabled)("argsubscriptions")?parseInt((0,f.getFeatureValue)("maxselectedsubs")||"1000"):100;const S=(0,f.memoizePromise)((()=>v("MsPortalImpl/Services/Services.SubscriptionsDeferred"))),I=t.searchSubscriptionArgQueryFormat='resourcecontainers| where type =~ "microsoft.resources/subscriptions"| project subscriptionId, displayName=name| where displayName contains "{0}" or subscriptionId contains "{0}"',P=t.getSubscriptionArgQueryFormat='resourcecontainers| where type =~ "microsoft.resources/subscriptions" and subscriptionId == "{0}"| project subscriptionId, displayName=name';let _=t.ServicesSubscriptions=class{constructor(e,t,s,i){this._diContainer=e,this._authStateManager=s,this.globalSelectedSubscriptionsObservable=ko.observable([]),this.loadedSubscriptionsPromise=ko.observable(),this.startupSubscriptionsInfoMemo=(0,f.memoizePromise)((async()=>{const e=y.start({source:"Services.Subscriptions",action:"startupSubscriptionsInfoMemo"}),t=this._loadSubscriptions().then((t=>(y.completeTrace(e,{subscriptionsCount:t.subscriptions.length,countData:t.countData,hasNextLink:!!t.nextLink}),t)));return this.loadedSubscriptionsPromise(t),this.handleZeroSubsNotification=(async()=>{const e=await t;this.subscriptionsMap=e.subscriptionsMap;const s=4===e.countData.type,i=e.subscriptions.length;if(i&&e.countData.value)s&&D(this._diContainer,i);else{const[e,t]=await Promise.all([this._authStateManager.getUserInfo(),this._diContainer.get(u.TenantsService).getHomeTenantsCount()]),o=await v("MsPortalImpl/Services/NoSubsChecks");if(!await o.handleNoSubsInDirectory(this._diContainer,e,t,(0,l.useAdvancedSubFilters)(this._diContainer))&&s)return D(this._diContainer,i)}})(),t})),this.allSubscriptionsInfoMemo=(0,f.memoizePromise)((async()=>{const[e,t]=await Promise.all([this.startupSubscriptionsInfoMemo(),(0,l.useAdvancedSubFilters)(this._diContainer)]);let s;if(y.trace({source:"Services.Subscriptions",action:"allSubscriptionsInfoMemo",data:{nextLink:e.nextLink,startupSubsInfoCountData:e.countData,startupSubscriptionsInfoSubsCount:e.subscriptions.length}}),e.nextLink&&!t){s=this._loadSubscriptions(e);const t=await s;this.subscriptionsMap=t.subscriptionsMap}else s=Promise.resolve({...e,countData:{type:1,value:e.subscriptions.length}});return this.loadedSubscriptionsPromise(s),s}));const o="ServicesSubscriptionsConstructor",n=async()=>{if(i.isEnabled("mspfilter")){const e=await v("MsPortalImpl/Services/Services.ProjectedDirectories");return await this._diContainer.getAsync(e.ServicesProjectedDirectories)}return null},r=(0,l.useAdvancedSubFilters)(e),d=async()=>{if(!await r)return await E(t)},p=async e=>{let s;if(e){const e=(await S()).fetchSubscriptions(this._diContainer);this.loadedSubscriptionsPromise(e),this.startupSubscriptionsInfoMemo=(0,f.memoizePromise)((()=>e)),s=e}else s=this.startupSubscriptionsInfoMemo();try{const[l,p,u,m]=await Promise.all([s,d(),n(),r]);let g=p;if(m){if(0===l.countData.value)return[];g=l.subscriptions.map((e=>e.subscriptionId))}else y.trace({source:"Services.Subscriptions",action:o,data:{selectedSubscriptionsInSettingsCount:g.length}});const h=l.subscriptions,f=l.countData.value,b=l.countData.type,w=m?h:h.filter((e=>g.includes(e.subscriptionId)));let M=!1,S=Promise.resolve(w);if(!m&&u){const e=await u.getSubscriptionsForSelectedDirectories(w);S=e.length?Promise.resolve(e):u.getSubscriptionsForSelectedDirectories(h)}else 0===w.length&&(y.trace({source:"Services.Subscriptions",action:"zeroValidSelectedSubscriptions"}),S=Promise.resolve(h.slice(0,C)),M=f>0&&2===b);const I=await S;if(!m&&I.length>=C&&(y.trace({source:"Services.Subscriptions",action:"cappedSelectedSubscriptions",data:{selectedSubscriptionsCount:I.length}}),I.length=C,M=f>C),M){const e=this._diContainer.get(x.NotificationManager),t=(t,s)=>{e.addSingleNotification({status:0,title:t,description:s,linkTo:"#menu/directory"})},s=a.SubscriptionsNotification;1===b?t(s.totalCappedTitle.format(C,f),s.totalSubscriptionsCapped.format(C,f)):2===b&&t(s.partialCappedTitle.format(f),s.partialSubscriptionsCapped.format(C,f))}const P=(0,c.mergeSelectedSubscriptionsWithFirstPage)(I,h);if(!m&&I&&k(t,(I.length===f?[]:I).map((e=>e.subscriptionId)),e?"forceReload":"startup"),i.isEnabled("subscreditcheck")){(await v("MsPortalImpl/Services/SubsCreditCheck")).checkRemainingCredit(this._diContainer,I)}if(!i.isEnabled("ci")){const e=I.filter((e=>"pastdue"===e.state.toLowerCase()));if(y.trace({source:"Services.Subscriptions",action:"pastDueSubsCheck",data:{pastDueSubsCount:e.length}}),e.length){(await v("MsPortalImpl/Services/PastDueSubsCheck")).raiseWarningForPastDueSubs(this._diContainer,e)}}return this.globalSelectedSubscriptionsObservable(I),P}catch(e){y.trace({source:"Services.Subscriptions",action:o,data:{err:e}}),w.warning(e)}};this._getDisplayedSubscriptions=p;let m=!1;this.displayedSubscriptionsPromise=ko.observable((async()=>{const e=await p(!1);return m=!0,e})()),r.then((async e=>{if(!e)return;const t=await v("MsPortalImpl/Services/Services.GlobalResourceFilters"),s=await this._diContainer.getAsync(t.ResourceFilterManager),i=new FxImpl.TriggerableLifetimeManager;(0,h.subscribe)(i,[s.currentFilter],(async()=>{if(!m)return;const e=p(!0);if(this.displayedSubscriptionsPromise(e),!(await e)?.length){const[e,t]=await Promise.all([this._authStateManager.getUserInfo(),this._diContainer.get(u.TenantsService).getHomeTenantsCount()]);(await v("MsPortalImpl/Services/NoSubsChecks")).handleNoSubsInDirectory(this._diContainer,e,t,Promise.resolve(!0))}}))}))}async _loadSubscriptions(e){let t,s;if((e=e||{}).nextLink){const s=await S();t=await s.loadAllSubscriptionsFromArm(e)}else try{const e=(await this._diContainer.get(F).getSubscriptionsInfo()).firstPageSubscriptions||{},{subscriptions:s,...i}=e;t={...i,subscriptions:MsPortalFx.stableSort(s,c.compareSubscriptions)}}catch(e){return w.warning(new MsPortalFx.Errors.Error({message:`Error retrieving first page of subscriptions: \n${MsPortalFx.getLogFriendlyMessage(e)}`,innerErrors:e})),{subscriptions:[],subscriptionsMap:{},countData:{type:0,value:0},nextLink:""}}if(2===t.countData.type&&t.nextLink){if(!(await E(this._diContainer.get(p.SettingsManager))).length){const e=await S();t=await e.loadAllSubscriptionsFromArm(t),s=!0}}return y.trace({source:"Services.Subscriptions",action:"_loadSubscriptions",data:{startupStubsNextLink:e.nextLink,subscriptionsCount:t.subscriptions.length,countData:t.countData,nextLink:t.nextLink,loadedAllPages:s}}),t}refreshSubscriptions(){const e=this._getDisplayedSubscriptions(!0);return this.displayedSubscriptionsPromise(e),e}};t.ServicesSubscriptions=_=__decorate([__metadata("fx:diagnostics",[e,"ServicesSubscriptions"]),(0,i.Class)(),__metadata("design:paramtypes",[i.Container,p.SettingsManager,d.AuthStateManager,FxImpl.Features])],_);let F=t.StartupSubscriptionsInfoProvider=class{constructor(e){this.getSubscriptionsInfo=()=>(0,l.lazyUserDataMemo)(e)}};t.StartupSubscriptionsInfoProvider=F=__decorate([__metadata("fx:diagnostics",[e,"StartupSubscriptionsInfoProvider"]),(0,i.Class)(),__metadata("design:paramtypes",[i.Container])],F);let T=t.SubscriptionsUserContext=class{constructor(e,t,s){this._diContainer=e,this._servicesSubscriptions=t,this._settingsManager=s;const i=new FxImpl.TriggerableLifetimeManager;t.displayedSubscriptionsPromise.subscribeAndRun(i,(e=>{this._inSessionDisplayedSubscriptionsPromise=this._globalDisplayedSubscriptionsPromise=e}));const o=this._globalSelectedSubscriptions=t.globalSelectedSubscriptionsObservable;this.inSessionSelectedSubscriptions=ko.observable(o()),t.loadedSubscriptionsPromise.subscribeAndRun(i,(e=>{this._loadedSubscriptionsPromise=e})),this.useAdvancedFiltersPromise=(0,l.useAdvancedSubFilters)(e),this._globalSelectedSubscriptions.subscribe(i,(e=>{this.inSessionSelectedSubscriptions(e)}))}async getAllSubscriptionsCount(){const{countData:e}=await this._loadedSubscriptionsPromise;return e}getGlobalDisplayedSubscriptions(){return this._globalDisplayedSubscriptionsPromise}async getInSessionDisplayedSubscriptions(){const[e,t,s]=await Promise.all([this.getGlobalSelectedSubscriptions(),this._inSessionDisplayedSubscriptionsPromise,this.getAllSubscriptionsCount()]);return{subscriptions:[...t],isPartialSet:1!==s.type||t.length<e().length}}async getGlobalSelectedSubscriptions(){const e=M?y.start({source:"Services.Subscriptions",action:"GetSelectedSubscriptions"}):"";return await this._globalDisplayedSubscriptionsPromise,M&&y.completeTrace(e,{selectedSubscriptionsCount:this._globalSelectedSubscriptions().length}),this._globalSelectedSubscriptions}async getInSessionSelectedSubscriptions(){return await this._globalDisplayedSubscriptionsPromise,this.inSessionSelectedSubscriptions}async setGlobalSelectedSubscriptions(e){if(await this.useAdvancedFiltersPromise)return Promise.reject("Unable to set global selected subscriptions with feature.globalresourcefilter enabled");const t=await this.processNewSelectedSubscriptions(MsPortalFx.convertArrayToMap(e,MsPortalFx.identity,(()=>!0)));y.trace({source:"Services.Subscriptions",action:"setGlobalSelectedSubscriptions",data:{areAllSubsSelected:t.areAllSubsSelected,displayedSubscriptionsCount:t.displayedSubscriptions.length,selectedSubscriptionsCount:t.selectedSubscriptions.length,first100SubscriptionIds:t.selectedSubscriptions.slice(0,100).map((e=>e.subscriptionId))}}),this._globalDisplayedSubscriptionsPromise=Promise.resolve(t.displayedSubscriptions),this._inSessionDisplayedSubscriptionsPromise=Promise.resolve(t.displayedSubscriptions);const s=t.selectedSubscriptions;this._globalSelectedSubscriptions([...s]);const i=s.length===t.countData.value?[]:s.slice(0,C);k(this._settingsManager,i.map((e=>e.subscriptionId)),"updated")}async setInSessionSelectedSubscriptions(e){const t=await this.processNewSelectedSubscriptions(MsPortalFx.convertArrayToMap(e,MsPortalFx.identity,(()=>!0)));y.trace({source:"Services.Subscriptions",action:"setInSessionSelectedSubscriptions",data:{areAllSubsSelected:t.areAllSubsSelected,displayedSubscriptionsCount:t.displayedSubscriptions.length,selectedSubscriptionsCount:t.selectedSubscriptions.length,first100SubscriptionIds:t.selectedSubscriptions.slice(0,100).map((e=>e.subscriptionId))}}),this._inSessionDisplayedSubscriptionsPromise=Promise.resolve(t.displayedSubscriptions),this.inSessionSelectedSubscriptions(t.selectedSubscriptions)}async addGlobalSelectedSubscription(e){if(!(e=(e||"").trim()))return Promise.reject("Invalid subscription ID.");if(await this.useAdvancedFiltersPromise)return Promise.reject("Unable to add global selected subscription with advanced filtering enabled");await this._globalDisplayedSubscriptionsPromise;const t=MsPortalFx.makeArray([...this._globalSelectedSubscriptions()]);if(t.some((t=>t.subscriptionId===e)))return;const s=[...t.map((e=>e.subscriptionId)),e],i=await this.processNewSelectedSubscriptions(MsPortalFx.convertArrayToMap(s,MsPortalFx.identity,(()=>!0)));this._globalDisplayedSubscriptionsPromise=Promise.resolve(i.displayedSubscriptions),this._inSessionDisplayedSubscriptionsPromise=Promise.resolve(i.displayedSubscriptions),this._globalSelectedSubscriptions([...i.selectedSubscriptions]);const o=i.selectedSubscriptions.length===i.countData.value?[]:i.selectedSubscriptions.slice(0,C);k(this._settingsManager,o.map((e=>e.subscriptionId)),"added")}async getSubscriptionSearchResults(e){return(await S()).getSubscriptionSearchResults(e,this._servicesSubscriptions.allSubscriptionsInfoMemo())}async searchSubscriptionFromArg(e,t){const{getDataFromArt:s}=await MsPortalFx.require("FxHubs/ArtHelpers/ArtApis"),i=t+".searchSubscriptions";return{subscriptions:(await s({query:I.format(e),options:{resultFormat:"objectArray"}},i)).data||[]}}async getSubscriptionFromArg(e,t){const{getDataFromArt:s}=await MsPortalFx.require("FxHubs/ArtHelpers/ArtApis"),i=t+".getSubscription",o=(await s({query:P.format(e),options:{resultFormat:"objectArray"}},i)).data||[];if(1===o.length)return o[0];throw 0===o.length?new Error("Subscription not found"):new Error("Multiple subscriptions found")}async getAllSubscriptionIds(){const e=await this.useAdvancedFiltersPromise?this._loadedSubscriptionsPromise:this._servicesSubscriptions.allSubscriptionsInfoMemo(),t=await e;return{subscriptionIds:t.subscriptions.map((e=>e.subscriptionId)),allSubscriptionsCountData:t.countData}}async getSubscriptionTenant(e){if(!e)return{};const t=y.startTrace({source:"Services.Subscriptions",action:"GetSubscriptionTenant"}),i=(await MsPortalFx.Base.Security.getUserInfo()).directoryId,n=await this._diContainer.get(u.TenantsService).getHomeTenants();try{const r=(0,o.getSubscriptionApi)(e),a=(await(0,s.batch)({uri:r,type:"GET",setTelemetryHeader:"GetSubscriptionTenant"})).content.tenantId,l=n.find((e=>e.id===a))||{};return y.completeTrace(t,{source:"Services.Subscriptions",action:"GetSubscriptionTenant",data:{subscriptionId:e,signedInTenantId:i,subscriptionTenantId:l.id}}),l}catch(s){const o=s||{},r=o.content?.error||{};if("InvalidAuthenticationTokenTenant"===r.code){const s=r.message,o=[...s.matchAll(/https:\/\/([a-zA-Z0-9.-]+)\/([a-zA-Z0-9-]+)\//g)];if(o.length>0){const r=(o.map((e=>e[2]))||[]).slice(1),a=n.find((e=>r.includes(e.id)))||{};return y.completeTrace(t,{source:"Services.Subscriptions",action:"GetSubscriptionTenant",data:{subscriptionId:e,signedInTenantId:i,subscriptionTenantId:a?.id,armErrorMessage:s}}),a}}return y.cancelTrace(t,{source:"Services.Subscriptions",action:"GetSubscriptionTenant",data:{error:s}}),{}}}async getSubscription(e){if(!e)return Promise.reject("Invalid subscription ID.");const t=await this._loadedSubscriptionsPromise;return this._subscriptionsNameMap||(this._subscriptionsNameMap=MsPortalFx.convertArrayToMap(t.subscriptions,(e=>e.uniqueDisplayName),(()=>!0))),await(0,f.memoizePromise)((async e=>{try{await this._globalDisplayedSubscriptionsPromise;const t=this._servicesSubscriptions.subscriptionsMap;let i;if(t&&(i=(t[e]||{}).subscription),!i){const i=(0,o.getSubscriptionApi)(e),n=(await(0,s.batch)({uri:i,type:"GET",setTelemetryHeader:"GetSubscription"})).content,r=n.displayName;let l=n.state&&"disabled"===n.state.toLowerCase()?a.disabledSubscriptionLabelFormat.format(r):r;return this._subscriptionsNameMap[r]&&(l=a.subscriptionNameAndIdLabelFormat.format(l,n.subscriptionId)),n.uniqueDisplayName=l,t[n.subscriptionId]={subscription:n,notInFirstPage:!1},this._subscriptionsNameMap[l]=!0,n}return i}catch(e){const t=e||{},s=t.content,i=t.httpStatusCode,o=MsPortalFx.Base.Diagnostics.createIgnoreUnhandledRejectionError(JSON.stringify({httpStatusCode:i,message:s||t}),s?.stackTrace);throw o.httpStatusCode=i,[401,404,403].includes(i)&&(o.errorLevel=0),o}}))(e)}processNewSelectedSubscriptions(e){return(async()=>{const t=await S(),s=this._servicesSubscriptions.allSubscriptionsInfoMemo();return t.processSelectedSubscriptionChanges(this._diContainer,e,this._loadedSubscriptionsPromise,s,this.useAdvancedFiltersPromise)})()}async refreshSubscriptions(){const e=await this._globalDisplayedSubscriptionsPromise,t=this._servicesSubscriptions.refreshSubscriptions();this._globalDisplayedSubscriptionsPromise=t,this._inSessionDisplayedSubscriptionsPromise=t;const s=await t;this.inSessionSelectedSubscriptions(this._globalSelectedSubscriptions());const i=new Set(e.map((e=>e.subscriptionId))),o=new Set(s.map((e=>e.subscriptionId)));let n=0,r=0;return o.forEach((e=>{i.has(e)||n++})),i.forEach((e=>{o.has(e)||r++})),{added:n,removed:r}}};t.SubscriptionsUserContext=T=__decorate([__metadata("fx:diagnostics",[e,"SubscriptionsUserContext"]),(0,i.Class)(),__metadata("design:paramtypes",[i.Container,_,p.SettingsManager])],T);t.setInSessionSelectedSubscriptionsHandler=(0,g.defineHandler)(FxImpl.Azure.setInSessionSelectedSubscriptionsEndPoint,(e=>e.diContainer.get(T).setInSessionSelectedSubscriptions(e.messageArg))),t.searchForSubscriptionsHandler=(0,g.defineHandler)(FxImpl.Azure.searchForSubscriptionsEndPoint,(e=>e.diContainer.get(T).getSubscriptionSearchResults(e.messageArg))),t.getInSessionSelectedSubscriptionsObservableHandler=(0,g.defineHandler)(m.getInSessionSelectedSubscriptionsObservableEndPoint,(e=>e.diContainer.get(T).getInSessionSelectedSubscriptions())),t.getSubscriptionInfoHandler=(0,g.defineHandler)(FxImpl.Azure.getSubscriptionInfoEndPoint,(async e=>({...await e.diContainer.get(T).getSubscription(e.messageArg)}))),t.getInSessionDisplayedSubscriptionsHandler=(0,g.defineHandler)(r.Subscriptions.getInSessionDisplayedSubscriptionsEndPoint,(e=>e.diContainer.get(T).getInSessionDisplayedSubscriptions()));function k(e,t,s){y.trace({source:"Services.Subscriptions",action:"saveSelectedSubscriptions",data:{selectedSubscriptionsCount:t.length,first100SelectedSubscriptionIds:t.slice(0,100),reason:s}}),e.setSetting(6,n.Keys.subscriptionsSelected,t.join(";"))}async function E(e){const t=await e.querySetting(6,n.Keys.subscriptionsSelected);return t?.split(";")||[]}function D(e,t){const s=1===t?a.subscriptionErrorSingleSubscription:a.subscriptionErrorPluralSubscription,i=a.subscriptionErrorDescription.format(t,s);e.get(x.NotificationManager)?.addSingleNotification({title:a.subscriptionErrorTitle,description:i,status:1})}})),
define("MsPortalImpl/ReactViews/Browse.Prewarmer",["require","exports","FxHubs/ArtHelpers/ArtApis","Fx","FxHubs/ArtHelpers/ArgBrowseHelpers","Fx/ResourceManagement","FxHubs/ResourceManagement","FxHubs/RpcEndPointsCore","FxHubs/ArtHelpers/KustoQueryGenerator","FxHubs/ArtHelpers/KustoQueryHelpers","FxHubs/Common/ResourcesOperationsCache","Fx/DependencyInjection","FxHubs/Common/AssetViewModelCommon","FxHubs/Common/AssetTypeCache","MsPortalImpl/ReactViews/ReactQueryStore","MsPortalImpl/Services/Services.Subscriptions"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h){"use strict";t.columnsDataQuery=t.browseDataQuery=void 0,t.createKustoQueryGenerator=A,t.defaultProjectedColumns=void 0,t.getBrowsePreReqs=B,t.getColumnProjectionForFacet=N,t.getColumnType=R,t.getColumnsData=W,t.getResourceTypeBrowseData=async function(e,t,s){return k.bind(e,t,s).get()},t.getSubscriptionsFromArg=L,t.loadBrowseView=z,t.prewarmBrowseFrame=function(e,t,s,i){let o=!1,n=!1,r=!1;["browseall.reactview","browseresource.reactview","browseresourcegroups.reactview","resourcegroupoverview.reactview"].includes(e.toLowerCase())?(o=!0,n=!0):["armbrowse.reactview"].includes(e.toLowerCase())&&(o=!0,r=!0);if(o){const{kind:o,view:a,filter:l}=t.parameters,c={"browseall.reactview":"microsoft.resources/resources","browseresourcegroups.reactview":"microsoft.resources/subscriptions/resourcegroups","resourcegroupoverview.reactview":"microsoft.resources/resources"}[e.toLowerCase()]||t.parameters.resourceType,d="resourcegroupoverview.reactview"===e.toLowerCase()?t.parameters.id:t.parameters.scope,p=t.parameters.scopeParameters,u=a?{...a,filter:l||a.filter}:{id:"_default_",version:"1.0",filter:l};k.bind(s,c,d).get().then((e=>{const t=e?.browsePrereqs?.favoriteViewId&&"_default_"!==e.browsePrereqs.favoriteViewId?e.browsePrereqs.favoriteViewId:null;return(!a&&t?z({id:t}):Promise.resolve(u)).then((e=>{E.bind(s,s,c,d,e,r).get(),n&&D.bind(s,s,i,c,o,d,p,e).get()}))})).catch((e=>{v.error("Error prefetching browse data",null,e)}))}},t.resourcesQuery=void 0,t.respectOperationsCacheBeforeArgRequest=H,t.shouldRequestIncludeSubscriptions=O,t.useEdgeZones=U;var f=MsPortalFx.Base.Diagnostics,x=MsPortalFx.Extension.ResourceRoutingType,b=MsPortalFx.Base.Diagnostics.Telemetry;const y=MsPortalFx.Resources.Strings.Browse,v=f.createLog(e),w={1:"name",2:"kind",3:"resourceGroup",4:"location",5:"locationId",6:"resourceId",7:"resourceGroupId",8:"resourceType",9:"subscription",10:"subscriptionId",11:"type",12:"tagsArray",13:"edgeZone"},M={6:"id",8:"type",12:"tags",13:"extendedLocation"},C=[{key:"==",text:y.Filters.equals},{key:"!=",text:y.Filters.notEquals},{key:"before",text:y.Filters.before},{key:"after",text:y.Filters.after},{key:"between",text:y.Filters.between,isRange:!0},{key:"!between",text:y.Filters.notBetween,isRange:!0}],S={0:"",1:"==",2:"!=",3:"contains",4:"!contains",5:"startswith",6:"!startswith",7:"endswith",8:"!endswith"},I=[{key:"==",text:y.Filters.equals},{key:"!=",text:y.Filters.notEquals},{key:"<",text:y.Filters.lessThan},{key:"<=",text:y.Filters.lessThanOrEquals},{key:">=",text:y.Filters.greaterThanOrEquals},{key:">",text:y.Filters.greaterThan},{key:"between",text:y.Filters.between,isRange:!0},{key:"!between",text:y.Filters.notBetween,isRange:!0}],P=ko.utils.peekObservable,_=[{key:"==",text:y.Filters.equals,isEquality:!0},{key:"!=",text:y.Filters.notEquals,isEquality:!0},{key:"contains",text:y.Filters.contains},{key:"!contains",text:y.Filters.notContains},{key:"startswith",text:y.Filters.startsWith},{key:"!startswith",text:y.Filters.notStartsWith},{key:"endswith",text:y.Filters.endsWith},{key:"!endswith",text:y.Filters.notEndsWith}];let F={};const T=e=>MsPortalFx.isFeatureEnabled("argbrowseedgezones")&&e?["id","name","type","kind","location","subscriptionId","resourceGroup","tags","extendedLocation"]:["id","name","type","kind","location","subscriptionId","resourceGroup","tags"];t.defaultProjectedColumns=T;const k=t.browseDataQuery=(0,g.registerQuery)({name:"Browse::BrowseData",cacheOptions:{staleAfter:Number.MAX_SAFE_INTEGER},getArgsKey:(e,t)=>`${e}-${t}`,query:(e,t)=>Promise.all([X({resourceType:e}),B({resourceType:e,scope:t})]).then((t=>{const[s,i]=t;return(0,o.initializeColumnsWithSettings)(ee(e.toLowerCase()),i.columnSettings),{resourceType:e,resourceTypeDetails:s,browsePrereqs:i,columnIdToArgColumn:M,columnIdToStringMap:w,emptyBrowseLink:"https://go.microsoft.com/fwLink/?LinkID=845598"}}))}),E=t.columnsDataQuery=(0,g.registerQuery)({name:"Browse::ColumnsData",cacheOptions:{staleAfter:Number.MAX_SAFE_INTEGER,scope:"view"},getArgsKey:(e,t,s,i,o)=>`${t}-${s}-${i?.id}-${o?"v1":"v2"}`,query:(e,t,s,i,o)=>k.bind(e,t,s).get().then((e=>W(e,t,i,s,o)))}),D=t.resourcesQuery=(0,g.registerQuery)({name:"Browse::PrefetchedResources",cacheOptions:{scope:"view",staleAfter:Number.MAX_SAFE_INTEGER},getArgsKey:(e,t,s,i,o,n,r)=>`${s}-${i}-${o}-${n?JSON.stringify(n):""}-${r?.id}`,query:(e,t,o,r,a,l,c)=>Promise.all([k.bind(e,o,a).get(),E.bind(e,e,o,a,c).get()]).then((([e,d])=>async function(e,t,o,r,a,l,c,d,u,m){const g=r?.resourceTypeDetails;if(g?.assetTypeNotFound)return Promise.reject({message:"Asset type not found for resource type: "+a,resourceType:a,assetTypeNotFound:!0,originalError:g.assetTypeError});const f=a.toLowerCase(),x="microsoft.resources/resourceswithtag"===f?{}:{[f]:{resourceTypeName:a,selected:!0}},b=r?.browsePrereqs,v=b?.browseQueryManifest||{};if(v.mergedResourceTypes)for(const e of v.mergedResourceTypes)x[e.resourceTypeName.toLowerCase()]=e;const w=await async function(e,t,s,i){if(i?.subscriptionIds?.length){const e=i.selectedSubscriptionIds||i.subscriptionIds;return await Promise.all(e.map((e=>te(e))))}if(s){if(s.subscriptionId){const e=s.subscriptionId;return"string"==typeof e?[await te(e)]:await Promise.all(e.map((e=>te(e))))}return[...await MsPortalFx.Azure.getSelectedSubscriptions()]}const o=n.ArmId.parse(t,!0);return se(e,t)?(await L({})).subscriptions:o?.subscription?[await p.container.get(h.SubscriptionsUserContext).getSubscription(o.subscription)]:[...await MsPortalFx.Azure.getSelectedSubscriptions()]}(a,d,u,m),M=function(e){const t={"microsoft.resources/resources":"All","microsoft.resources/subscriptions":"Subscriptions","microsoft.resources/subscriptions/resourcegroups":"ResourceGroups","microsoft.resources/resourceswithtag":"TagResources","microsoft.management/managementgroups":"ManagementGroups"},s=(e||"").toLowerCase();return t[s]||"Resources:"+s}(f),C=[],I=!!r?.resourceTypeDetails?.resourceType,P=I&&"microsoft.resources/subscriptions/resourcegroups"===r.resourceTypeDetails?.resourceType.toLowerCase(),_=I&&"microsoft.resources/resourceswithtag"===r?.resourceTypeDetails?.resourceType.toLowerCase(),T=I&&1===r.resourceTypeDetails?.routingType,k=v.excludeColumns?.includes(4),E=v.excludeColumns?.includes(10),D=[{name:11,displayName:y.Columns.AssetType.title,format:1},!P&&!T&&{name:3,displayName:y.Columns.ResourceGroup.title,format:2},!k&&{name:4,displayName:y.Columns.Location.title,format:5},!T&&!E&&{name:9,displayName:y.Columns.Subscription.title,format:2},{name:2,displayName:y.Columns.Kind.title,format:1},!P&&!T&&{name:7,displayName:y.Columns.ResourceGroupId.title,format:1},!k&&{name:5,displayName:y.Columns.LocationId.title,format:1},{name:6,displayName:y.Columns.ResourceId.title,format:1},{name:8,displayName:y.Columns.ResourceType.title,format:1},!T&&!E&&{name:10,displayName:y.Columns.SubscriptionId.title,format:1},!v.excludeColumns?.includes(12)&&{name:12,displayName:y.Columns.Tags.title,format:1},!_&&(!v.browseQuery||v.edgeZonesSupported)&&i.isFeatureEnabled("argbrowseedgezones")&&{name:13,displayName:y.Columns.EdgeZone.title,format:1}].filter((e=>!!e)),N={};for(const e of t)N[F[e.id]||e.id]=e,o[e.id]&&(C.push(o[e.id]),D.push(o[e.id]));let R;if(m?.gridColumns){R=m.gridColumns.filter((e=>e.visible)).map((e=>o[e.id])).filter((e=>!!e)).map((e=>Y(e,r))).reduce(((e,t)=>[...e,...t]),[])}else R=C.map((e=>Y(e,r))).reduce(((e,t)=>[...e,...t]),[]);const z=[];if(m?.filterFacets&&r){const{columnIdToArgColumn:e,columnIdToStringMap:t}=r;m.filterFacets.forEach((s=>{const i=s.key||s.filter?.key,o=D.find((s=>Z(s.name,e,t).toLowerCase()===i.toLowerCase()));if(o){const i=function(e,t){const s=function(e,t){let s,i,o=[];if(e.key){const i=e;switch(t.format){case 1:case 5:case 0:case 2:case 8:case 7:s=j(S[i.operator])||j("==");break;case 3:s=q(S[i.operator])||q("==");break;case 4:s=$(S[i.operator])||$("==")}"string"==typeof i.value?o=[{key:i.value,text:i.value,value:i.value}]:i.value?.forEach((e=>{e.resourceType?o.push({key:e.name.toLowerCase(),text:e.displayName||e.name,value:e.resourceType}):o.push({key:e.name.toLowerCase(),text:e.displayName||e.name,value:e.name})}))}else if(e.filter){const n=e;switch(i=n.filter,t.format){case 1:case 5:case 0:case 2:case 8:case 7:s=j(n.operator);break;case 3:s=q(n.operator);break;case 4:s=$(n.operator)}o=[...n.values]}const n={filter:i||{key:t.name.toLowerCase(),value:t.name,text:t.displayName,format:t.format},operator:s,values:o,isAllValues:e.isAllValues};return n}(e,t);return s&&{filter:s.filter,operator:s.operator.key,values:s.values.map((e=>e)),isAllValues:s.isAllValues}}(s,{name:Z(o.name,e,t),displayName:o.displayName,format:o.format||1});z.push(i)}}))}const U=e=>{switch(e.toLowerCase()){case"typedisplayname":case"assettype":return"type";case"locationdisplayname":return"location";case"subscriptiondisplayname":return"subscription"}return e};let W,V;if(m?.groupByValue&&r){const{columnIdToArgColumn:e,columnIdToStringMap:t}=r,s=U(m.groupByValue),i=D.find((i=>Z(i.name,e,t).toLowerCase()===s.toLowerCase()));i&&(W=Z(i.name,e,t),3===i.format?V="date":4===i.format&&(V="number"))}m?.groupByFormat&&(V=m.groupByFormat);const G=[];if(m?.sortedColumns&&r){const{columnIdToArgColumn:e,columnIdToStringMap:t}=r;m.sortedColumns.forEach((s=>{const i=U(s.sortBy),o=D.find((s=>Z(s.name,e,t).toLowerCase()===i.toLowerCase()));if(o){const i=Z(o.name,e,t);i!==W&&G.push({sortBy:i,order:s.order,sortFormat:V})}}))}else G.push({sortBy:"name",order:1,sortFormat:"string"});const K=n.ArmId.parse(d,!0);if(v.mergedResourceTypes){const e=r.browsePrereqs.browseQueryManifest.mergedResourceTypes.filter((e=>e.selected)),t=0===e.length||e.length===r.browsePrereqs.browseQueryManifest.mergedResourceTypes.length;z.push({filter:{key:"type",text:y.mergedType,value:"type",format:1},operator:"==",values:!t&&e.map((e=>{const t=function(e,t,s){const i=e?.browsePrereqs?.assetTypes[t?.toLowerCase()],o={plural:t,lowerPlural:t,singular:t,lowerSingular:t};if(!i)return o;if(i.kindMap&&s){const e=i.kindMap[s.toLowerCase()]||i.defaultKind;if(e)return e.displayName||i.displayName||o}return i.displayName||o}(r,e.resourceTypeName,e.resourceKindName);return{key:e.resourceTypeName?.toLowerCase(),value:e,text:t.plural}}))||[],isAllValues:t})}const J={startIndex:0,currentResourceTypes:x,managementGroups:se(a,d)?[n.ArmId.getResourceNames(K)[0]]:void 0,pageSize:100,reason:"initial load",browseData:r,columns:R,visibleColumns:t.map((e=>e.id)),resourceType:a,subscriptions:w,telemetrySource:M,showHiddenTypes:m?.showAll,kind:l,searchTerm:m?.filter||"",filters:z,sortColumns:G,groupByColumn:W,columnDataMap:c,scope:d,scopeParameters:u};return async function(e,t){const{columns:i,visibleColumns:o,startIndex:r,currentResourceTypes:a,kind:l,managementGroups:c,pageSize:d,subscriptions:p,reason:u,resourceType:m,showHiddenTypes:g,telemetrySource:h,searchTerm:f,filters:x,browseData:b,sortColumns:y,groupByColumn:v,columnDataMap:w,scope:M,scopeParameters:C}=e,S=b?.browsePrereqs||await B({resourceType:m}),I=t.getBooleanValue("NameSearchPrioritization"),P=A({browsePrereqs:S,columns:i,visibleColumns:o,resourceType:m,currentResourceTypes:a,kind:l,showHiddenTypes:g,searchTerm:f,filters:x,telemetrySource:h,sortColumns:y,groupByColumn:v,columnDataMap:w,scope:M,scopeParameters:C,subscriptions:p,useNamePrioritization:I}),_={$top:d,$skip:r,$skipToken:"",allowPartialScope:t.getBooleanValue("allowPartialScope")},F=P.query();H(P,m,S,a,M);const T={query:P.query(),options:_};O(b,S)&&(p?.length?T.subscriptions=p.map((e=>e.subscriptionId)):c&&(T.managementGroups=c));const k=await s.getDataFromArt(T,`${h}.${u}`,256),E=k.data||{},D=MsPortalFx.convertArrayToMap(E.columns,(e=>e.name),((e,t)=>t));return{resources:(E.rows||[]).map((e=>{const t={};(E.columns||[]).forEach(((s,i)=>{const o=s.name.replaceAll("_",".");t[o]=e[i]}));const s=e[D.id];return t.resourceId=s,t.name=n.ResourceName.getDisplayName({id:s,name:e[D.name],armId:n.ArmId.parse(s,!0),tags:e[D.tags]||{}},null,M)||e[D.name],t.location=e[D.location],t.resourceKind=e[D.kind],t})),sourceQuery:F,tenantMaxSubscriptionLimit:k.tenantMaxSubscriptionLimit,tenantSubscriptionLimitHit:k.tenantSubscriptionLimitHit,totalRecords:k.totalRecords}}(J,e)}(t,d.visibleColumns,d.manifestColumnsMap,e,o,r,d.columnDataMap,a,l,c)))});function A(e){const{browsePrereqs:t,columns:s,visibleColumns:a,resourceType:d,currentResourceTypes:p,kind:u,showHiddenTypes:m,searchTerm:g,filters:h,telemetrySource:f,sortColumns:x,groupByColumn:y,groupByFormat:v,subscriptions:C,columnDataMap:S,scope:I,scopeParameters:P,useNamePrioritization:_}=e,F=t.browseQueryManifest,k=!!P;let E="";if(I){const e=n.ArmId.parse(I,!0);4===e.kind?E=`where ${(0,l.getPredicate)(7,["resourceGroup"],[e.resourceGroup])}`:[6,3,8].includes(e.kind)&&(E=`where ${(0,l.getPredicate)(9,["id"],[I+"/"])}`)}const D=(k?e=>{if(P)for(const t in P){const s=P[t];e=e.replaceAll("{{parameters."+t+"}}","string"==typeof s?(0,l.encodeKustoValue)(s).slice(1,-1):Array.isArray(s)?s.map((e=>(0,l.encodeKustoValue)(e))).join(","):"")}return e}:e=>e)([F.browseQuery,E].filter((e=>!!e)).join("|")),A=(d||"").toLowerCase(),B=u?.toLowerCase(),L=U(A,F),z=[...T(L),...s],H=[];y&&H.push({sortBy:y,order:1,sortFormat:v}),g&&_&&H.push({sortBy:"__hubs_search_priority_ranking",order:2,sortFormat:null}),x&&H.push(...x);const O={},W=MsPortalFx.unique(H,((e,t)=>e.sortBy===t.sortBy)),q=W?.length?W.map((e=>({sortColumn:e,mappingProvider:G(t,p,e,S[e.sortBy.toLowerCase()],C||[])}))):null;q&&z.push(...q.filter((e=>e.mappingProvider)).map((e=>e.mappingProvider.projectedColumn)));for(const e of F?.excludeColumns||[])MsPortalFx.remove(z,M[e]||w[e]);const $=q?.length?q.map((e=>function(e,t,s){const i=t[e.sortBy.toLowerCase()],o=s||i?.sortColumn||e.sortBy,n=1===e.order?1:2;let r={sortBy:o,order:n};if(o.startsWith("tags.")){const e=o.slice(5).toLowerCase();r={sortBy:`tagsLowerCase[${(0,l.encodeKustoValue)(e,!0)}]`,order:n}}else if("__hubs_search_priority_ranking"===o)r={...r,castFunction:1};else switch(i?.format){case 4:r={...r,castFunction:5};break;case 3:r={...r,castFunction:4}}return r}(e.sortColumn,S,e.mappingProvider?.projectedColumn))):[];x?.length||$.push({sortBy:"name",order:1});const j=new l.KustoQueryGenerator($,z,null,D);let K=!1;if(D){const e=(0,c.smartQuerySplit)(D);if(e.length&&e[0]){const t=e[0].trim().split(" ");K=!o.knownArgTopLevelOperatorsLowerCased.includes(t[0].toLowerCase())}}const J=!K&&("microsoft.resources/resourceswithtag"===A?7:"microsoft.resources/subscriptions/resourcegroups"===A?2:1);j.setSources(J),j.setIncludeSubscriptionNameJoin(se(A,I));const Q=[];if(q)for(const e of q)e.mappingProvider&&!O[e.mappingProvider.projectedColumn]&&(Q.push(e.mappingProvider.provider),O[e.mappingProvider.projectedColumn]=!0);const X=[],Z=[];m||i.forEachKey(t.assetTypes,((e,t)=>{X.push(e);const s=(0,r.supportsOption)(t.options,2);if(!("microsoft.resources/resources"===A||"microsoft.resources/subscriptions/resourcegroups"===A||"microsoft.resources/resourceswithtag"===A)&&p[e]){const o=t.kindMap&&i.forEachKey(t.kindMap,((e,t,s)=>(0,r.supportsOption)(t.options,2)&&e!==B&&s.push(e)),[])||[];t.defaultKind&&(0,r.supportsOption)(t.defaultKind.options,2)&&o.unshift(""),o.length&&Z.push((0,c.buildTypeKindsExclusionQueryProvider)(e,o)),B&&s&&Z.push((0,c.buildTypeExclusionWithKindInclusionQueryProvider)(e,[B]))}else if(s){const s=t.kindMap&&i.forEachKey(t.kindMap,((e,t,s)=>(0,r.supportsOption)(t.options,8)&&s.push(e)),[])||[];t.defaultKind&&(0,r.supportsOption)(t.defaultKind.options,8)&&s.unshift(""),s.length?Z.push((0,c.buildTypeExclusionWithKindInclusionQueryProvider)(e,s)):Z.push((0,c.buildTypeExclusionQueryProvider)(e))}else{const s=t.kindMap&&i.forEachKey(t.kindMap,((e,t,s)=>(0,r.supportsOption)(t.options,2)&&s.push(e)),[])||[];t.defaultKind&&(0,r.supportsOption)(t.defaultKind.options,2)&&s.unshift(""),s.length&&Z.push((0,c.buildTypeKindsExclusionQueryProvider)(e,s))}}));const Y=m?[]:[...Z];if("microsoft.resources/resourceswithtag"!==A&&"microsoft.resources/resources"!==A||m||Y.unshift({columnName:"type",comparisonType:7,value:X}),B){const e=[],s=t.assetTypes?.[A];if(s&&s.kindMap){const t=(s.kindMap[B]||{kinds:[B]}).kinds;e.push({columnName:"kind",comparisonType:7,value:t,nestedQueryProvider:{columnName:"type",comparisonType:7,value:A}})}e.length&&Y.unshift({queryProviders:e,operator:1})}if(F.mergedResourceTypes){const e=[],t={[A]:{resourceTypeName:d,selected:!0}};for(const e of F.mergedResourceTypes)t[V(e)]=e;const s=i.forEachKey(t,((e,t,s)=>{F.honorSelectedMergedResourceTypes&&!t.selected||s.push(t)}),[]),o=s.filter((e=>!e.resourceKindName)).map((e=>e.resourceTypeName));o?.length&&e.push({columnName:"type",comparisonType:7,value:o});const n=s.filter((e=>!!e.resourceKindName));n?.length&&n.forEach((t=>{const s=[t.resourceKindName];Array.isArray(t.additionalKinds)&&s.push(...t.additionalKinds),e.push({columnName:"type",comparisonType:7,value:[t.resourceTypeName],nestedQueryProvider:{columnName:"kind",comparisonType:7,value:s}})})),e.length>0&&Y.push({queryProviders:e,operator:1})}const ee={"==":2,"!=":12,"<":26,"<=":28,">=":29,">":27},te={between:30,"!between":31},ie={"==":2,"!=":12,before:26,after:27},oe={between:30,"!between":31},re={"==":7,"!=":17},ae={contains:6,"!contains":16,startswith:9,"!startswith":19,endswith:10,"!endswith":20},le={"==":2,"!=":12},ce={contains:1,"!contains":11,startswith:4,"!startswith":14,endswith:5,"!endswith":15};let de,pe=0;h?.forEach((e=>{if(e.isAllValues)return;if(e.filter.key.startsWith("tags.")){de||(de=!0,Q.push(...l.tagKeyClauses)),Q.push("extend tagIndex=array_index_of(lowerTagKeys,tolower("+(0,l.encodeKustoValue)(e.filter.value,!0)+"))");const t="tagValue"+ ++pe;if(Q.push("extend "+t+"=iff(tagIndex==-1,'',tags[tostring(tagKeys[tagIndex])])"),le[e.operator])Y.push({columnName:t,comparisonType:le[e.operator],value:e.values.map((e=>e.value))});else{if(!ce[e.operator])throw new Error("Unhandled tag string operator: "+e.operator);Y.push({columnName:t,comparisonType:ce[e.operator],value:null===e.values[0].key?e.values[0].value:e.values[0].text})}return}const s=e.filter.value?S[e.filter.value.toLowerCase()]:void 0,i=N(e.filter.value,s?.sortType),o=R(i,s?.sortType)&&G(t,p,{sortBy:e.filter.value,order:1,sortFormat:null},s,C||[]);o&&!O[o.projectedColumn]&&(Q.push(o.provider),O[o.projectedColumn]=!0);let n,r,a=e.values.map((e=>e.text||""));switch(e.filter.format){case 4:if(ee[e.operator]){const t=e=>{const t=Number.parseFloat(e);return Number.isNaN(t)?0:t};Y.push({columnName:i,comparisonType:ee[e.operator],value:t(e.values[0]?.text||"")})}else{if(!te[e.operator])throw new Error("Unhandled number operator: "+e.operator);Y.push({columnName:i,comparisonType:te[e.operator],value:e.values.map((e=>parseFloat(e?.text||"")))})}break;case 3:{n=4;const t=ne(e.values[0].text);if(t?(a=[t,...e.values.slice(1).map((e=>ne(e.text)))],r=19):r=4,ie[e.operator])Y.push({columnName:i,comparisonType:ie[e.operator],value:a[0],castFunction:4,valueCastFunction:r});else{if(!oe[e.operator])throw new Error("Unhandled date operator: "+e.operator);Y.push({columnName:i,comparisonType:oe[e.operator],value:a,castFunction:4,valueCastFunction:r})}break}default:if(re[e.operator])if("type"===e.filter.key&&e.values.some((e=>"string"!=typeof e.value))){const t=[];e.values.forEach((s=>{if("string"==typeof s.value)t.push({columnName:"type",comparisonType:7,value:s.value});else{if(!s.value.resourceTypeName)throw new Error("Unhandled type filter: "+JSON.stringify(e));{const e=s.value;if(e.resourceKindName){const s=[e.resourceKindName];e.additionalKinds&&s.push(...e.additionalKinds),t.push({columnName:"type",comparisonType:7,value:e.resourceTypeName,nestedQueryProvider:{columnName:"kind",comparisonType:7,value:s}})}else t.push({columnName:"type",comparisonType:7,value:e.resourceTypeName})}}})),Y.push({queryProviders:t,operator:1})}else Y.push({columnName:i,comparisonType:re[e.operator],value:e.values.map((e=>e.value))});else{if(!ae[e.operator])throw new Error("Unhandled string operator: "+e.operator);Y.push({columnName:i,comparisonType:ae[e.operator],value:e.values[0].text})}}}));const ue=[],me=[];let ge=!1;const he=F?.excludeColumns?.includes(12);if(g){_&&(he?ue.push((0,l.buildNamePrioritizationPredicateExcludeTags)("__hubs_search_priority_ranking",g)):(ue.push(l.tagsLowerCasePredicate),ue.push((0,l.buildNamePrioritizationPredicate)("__hubs_search_priority_ranking",g))),me.push((0,l.buildNamePrioritizationCleanupPredicate)("__hubs_search_priority_ranking"))),he||(ge=!0);const e=function(e,t){const s=e.length,i=(e=e.slice(0,1e3)).split(" ");(s>1e3||i.length>10)&&b.trace({source:t,action:"TextFilterTruncated",data:{filterLength:s,tokenCount:i.length}});return i.splice(0,10)}(g,f),s=["name"];for(const e of a||z){if("edgeZone"===e&&!L)continue;const i=S[e.toLowerCase()];if("type"===e&&"resourceType"!==i?.sortType)continue;const o=N(e,i?.sortType);let n=!1;if(!O[e]){const s=R(o,i?.sortType)&&G(t,p,{sortBy:e,order:1,sortFormat:null},i,C||[]);s&&(O[s.projectedColumn]||(Q.push(s.provider),O[s.projectedColumn]=!0),n=!0)}o.startsWith("tags.")?s.push(`tagsLowerCase['${o.substring(5).toLowerCase()}']`):(z.includes(o)||n)&&s.push(o)}ge&&s.push("tagsLowerCase['hidden-title']");for(const t of e)Y.push({columnName:s.map((e=>`tostring(${e})`)),comparisonType:6,value:t})}return ge&&Q.push(l.tagsLowerCasePredicate),j.setMappingProviders(Q),j.setQueryProviders(Y),x?.some((e=>e?.sortBy?.startsWith("tags.")))&&ue.push(l.tagsLowerCasePredicate),j.setPreSortPredicates(ue),j.setPostSortPredicates(me),j.updateQuery(),j.addedTagKeyClauses=de,j}function B(e){const t=(e.resourceType+(e.scope?":"+n.ArmId.parse(e.scope,!0).resourceType:"")).toLowerCase(),s=ee(e.resourceType.toLowerCase()),i=!(0,o.areColumnsInitialized)(s),r={resourceType:e.resourceType,resourceTypeKey:t,includeColumnsVersion:i&&s,includeFavoriteViewId:!0};return(0,o.getBrowsePreRequisitesMemoized)(r)}function N(e,t){return["location","tenant"].includes(t)?`${e}DisplayName`:{assetType:"type",edgeZone:"extendedLocation",location:"locationDisplayName",locationId:"location",resourceGroupId:"resourceGroup",resourceId:"id",resourceType:"type",subscription:"subscriptionDisplayName",tagsArray:"tags",type:"typeDisplayName"}[e]||e}function R(e,t){let s=t;switch(e){case"typeDisplayName":s="resourceType";break;case"locationDisplayName":s="location";break;case"subscriptionDisplayName":s="subscription";break;case"edgeZone":s="edgeZone"}return s}async function L(e){const{searchTerm:t}=e;return await i.memoizePromise((async e=>{const t=new l.KustoQueryGenerator;t.setSources(4),t.setDefaultQueryPredicate(null),t.setIncludeSubscriptionNameJoin(!1),t.setQueryProviders(e?[{columnName:"name",comparisonType:6,value:e}]:null),t.setExpansionProviders(null),t.setPostExpandQueryProviders(null),t.setSuffixPredicates(["project name, subscriptionId, tenantId"]),t.setPrefixPredicates(null),t.updateQuery();const i={query:t.query(),options:{$top:1e3,$skipToken:""}},o=await s.getDataFromArt(i,"getSubscriptionsForReactBrowse"),n={subscriptions:[],totalRecords:o.totalRecords,sourceQuery:t.query()},r=o?.data;if(r){const e=r.columns.findIndex((e=>"name"===e.name)),t=r.columns.findIndex((e=>"subscriptionId"===e.name)),s=r.columns.findIndex((e=>"tenantId"===e.name));r.rows.forEach((i=>{n.subscriptions.push({displayName:i[e],subscriptionId:i[t],tenantId:i[s],uniqueDisplayName:null,authorizationSource:null,state:null,subscriptionPolicies:null})}))}return n}))(t)}async function z(e){return a.Browse.loadBrowseViewEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",e)}function H(e,t,s,o,r){const a=p.container.get(d.ResourcesOperationsCache).getDeletedResourceIds(),l=p.container.get(d.ResourcesOperationsCache).getCreatedResourceGroups(),c=i.isFeatureEnabled("cachecreatedresources")?p.container.get(d.ResourcesOperationsCache).getCreatedResources():ko.observableArray([]);if(a?.().length||l?.().length||c?.().length){if(a?.().length){const t=e.getQueryProviders();t.push({columnName:"id",comparisonType:13,value:a()}),e.setQueryProviders(t)}const d=(t||"").toLowerCase(),p="microsoft.resources/resourceswithtag"!==d&&(!s?.browseQueryManifest.browseQuery||s?.browseQueryManifest.edgeZonesSupported)&&i.isFeatureEnabled("argbrowseedgezones");if("microsoft.resources/subscriptions/resourcegroups"===d&&l?.().length){const t=[["id","string"],["name","string"],["type","string"],["location","string"],["subscriptionId","string"],["resourceGroup","string"],["kind","string"],["tags","dynamic"],["status","string"]];p&&t.push(["extendedLocation","dynamic"]);const s=e=>{const t=[e.armResourceGroup.id,e.armResourceGroup.name,"microsoft.resources/subscriptions/resourcegroups",e.armResourceGroup.location,e.subscriptionId,e.armResourceGroup.name,"",e.armResourceGroup.tags??{},e.armResourceGroup.properties?.provisioningState];return p&&t.push(null),t},i={dataTableHeader:t,dataTableRows:l().filter((e=>!se(d,r)&&(!r||e.armResourceGroup.id.includes(r)))).map((e=>s(e))),upstreamDataFilterColumn:"id"};e.setInlineDataSource(i)}if(c?.().length){const t=[["id","string"],["name","string"],["type","string"],["location","string"],["subscriptionId","string"],["resourceGroup","string"],["kind","string"],["tags","dynamic"]];p&&t.push(["extendedLocation","dynamic"]);const s=e=>{const t=n.ArmId.parse(e.id),s=[e.id,e.name,e.type,e.location,t.subscription,t.resourceGroup,e.kind??"",e.tags??{}];return p&&s.push(null),s},i={dataTableHeader:t,dataTableRows:c().filter((e=>!se(d,r)&&(!r||e.id.includes(r))&&"microsoft.resources/resources"===d||o[e.type?.toLowerCase()])).map((e=>s(e))),upstreamDataFilterColumn:"id"};e.setInlineDataSource(i)}e.updateQuery()}}function O(e,t){return 1!==e?.resourceTypeDetails?.routingType&&!t?.browseQueryManifest?.excludeColumns?.includes(10)}function U(e,t){return"microsoft.resources/resourceswithtag"!==e&&(!t.browseQuery||t.edgeZonesSupported)&&i.isFeatureEnabled("argbrowseedgezones")}async function W(e,t,s,r,a){const l=e?.resourceTypeDetails;if(l?.assetTypeNotFound)return Promise.reject({message:"Asset type not found for resource type: "+t,resourceType:t,assetTypeNotFound:!0,originalError:l.assetTypeError});a&&(F={name:1,kind:2,resourceGroup:3,location:4,locationId:5,resourceId:6,resourceGroupId:7,resourceType:8,subscription:9,subscriptionId:10,assetType:11,tagsArray:12});const c={},d=e.browsePrereqs?.browseQueryManifest,p=n.ArmId.parse(r,!0),u=!d?.browseQuery||d?.edgeZonesSupported;let g=[6,3,8].includes(p.kind)?function(e,t){const s=[K(11,e,y.Columns.AssetType,0),K(4,e,y.Columns.Location,1),K(3,e,y.Columns.ResourceGroup,-1,!0),K(9,e,y.Columns.Subscription,-1,!0),K(2,e,y.Columns.Kind,-1,!0),K(7,e,y.Columns.ResourceGroupId,-1,!0),K(5,e,y.Columns.LocationId,-1,!0),K(6,e,y.Columns.ResourceId,-1,!0),K(8,e,y.Columns.ResourceType,-1,!0),K(10,e,y.Columns.SubscriptionId,-1,!0),K(12,e,y.Columns.Tags,-1,!0)];t&&i.isFeatureEnabled("argbrowseedgezones")&&s.push(K(13,e,y.Columns.EdgeZone,-1,!0));return s}(e.columnIdToStringMap,u):4===p.kind?function(e,t){const s=[K(11,e,y.Columns.AssetType,0),K(4,e,y.Columns.Location,1),K(3,e,y.Columns.ResourceGroup,-1,!0),K(9,e,y.Columns.Subscription,-1,!0),K(2,e,y.Columns.Kind,-1,!0),K(7,e,y.Columns.ResourceGroupId,-1,!0),K(5,e,y.Columns.LocationId,-1,!0),K(6,e,y.Columns.ResourceId,-1,!0),K(8,e,y.Columns.ResourceType,-1,!0),K(10,e,y.Columns.SubscriptionId,-1,!0),K(12,e,y.Columns.Tags,-1,!0)];t&&i.isFeatureEnabled("argbrowseedgezones")&&s.push(K(13,e,y.Columns.EdgeZone,-1,!0));return s}(e.columnIdToStringMap,u):function(e,t,s){const o=[K(11,e,y.Columns.AssetType,0)];t.includes(3)||o.push(K(3,e,y.Columns.ResourceGroup,1));t.includes(4)||o.push(K(4,e,y.Columns.Location,2));t.includes(10)||o.push(K(9,e,y.Columns.Subscription,3));o.push(K(2,e,y.Columns.Kind,-1,!0)),t.includes(3)||o.push(K(7,e,y.Columns.ResourceGroupId,-1,!0));t.includes(4)||o.push(K(5,e,y.Columns.LocationId,-1,!0));o.push(K(6,e,y.Columns.ResourceId,-1,!0),K(8,e,y.Columns.ResourceType,-1,!0)),t.includes(10)||o.push(K(10,e,y.Columns.SubscriptionId,-1,!0));t.includes(12)||o.push(K(12,e,y.Columns.Tags,-1,!0));s&&i.isFeatureEnabled("argbrowseedgezones")&&o.push(K(13,e,y.Columns.EdgeZone,-1,!0));return o}(e.columnIdToStringMap,e.browsePrereqs?.browseQueryManifest?.excludeColumns||[],u);const h={},f={};d?.defaultColumns&&(d.defaultColumns.forEach(((e,t)=>{"string"==typeof e?f[e]={visible:!0,index:t}:h[e]={visible:!0,index:t}})),g.forEach((e=>{e.visible=(h[F[e.id]]||{visible:!1}).visible,e.index=(h[F[e.id]]||{index:-1}).index})));for(const e of d?.columns||[])c[e.name]=e,g.push({id:e.name,name:e.displayName,visible:(f[e.name]||{visible:!1}).visible,description:e.description,index:(f[e.name]||{index:-1}).index});g=g.sort(((e,t)=>e.index-t.index));const b="microsoft.resources/resourceswithtag"===t,w=a?1:ee(t.toLowerCase());let M;a?await async function(e){const t=await(0,m.getMergedResourceTypeSingleAssetTypeInformation)(e,!0),s=t?.base?.routingType===x.Tenant?function(){const e=[J(11,y.Columns.AssetType),J(4,y.Columns.Location),J(2,y.Columns.Kind,!0),J(5,y.Columns.LocationId,!0),J(6,y.Columns.ResourceId,!0),J(8,y.Columns.ResourceType,!0),J(12,y.Columns.Tags,!0)];return e}():function(){const e=[J(11,y.Columns.AssetType),J(3,y.Columns.ResourceGroup),J(4,y.Columns.Location),J(9,y.Columns.Subscription),J(2,y.Columns.Kind,!0),J(7,y.Columns.ResourceGroupId,!0),J(5,y.Columns.LocationId,!0),J(6,y.Columns.ResourceId,!0),J(8,y.Columns.ResourceType,!0),J(10,y.Columns.SubscriptionId,!0),J(12,y.Columns.Tags,!0)];return e}(),i=t?.associated?.length>0,n=new Map;let r=[],a=[];const l=t?.base;if(oe(l,2))try{const e=await Q(l),s=e.columns||[];s.forEach((e=>{n.set(e.id,[l.compositeDisplayName.lowerPlural])})),r=s,a=e.defaultColumns,i&&(MsPortalFx.remove(a,11),a.unshift(11));const o=[];t.associated.forEach((e=>{if(oe(e,2)){const t=Q(e).then((e=>{const t=e.columns||[];t.forEach((e=>{const t=e.id,s=l.compositeDisplayName.lowerPlural;n.get(t)?n.get(t).push(s):n.set(t,[s])})),r=MsPortalFx.pushUnique(r,t,((e,t)=>{return s=e.name(),i=t.name(),s===i||(s||"").toLowerCase()===(i||"").toLowerCase();var s,i}))})).catch((t=>{v.warning(`Failed to get browse config for associated asset type '${e.resourceType}':`,t)}));o.push(t)}})),await Promise.all(o)}catch(e){v.warning(`Failed to get browse config for base asset type '${l.resourceType}':`,e)}if(r.forEach((e=>{s.push({id:e.id,itemKey:e.itemKey,name:e.name(),visible:!1,format:e.format,formatOptions:e.formatOptions,description:P(e.description)})})),a){const e=a.map((e=>ie(e))),t=ie(9);e.includes(t)||l?.routingType===x.Tenant||e.push(t);for(let t=e.length-1;t>=0;t--){const i=MsPortalFx.findIndex(s,(s=>s.id===ie(e[t])));i>=0&&s.splice(0,0,s.splice(i,1)[0])}for(let t=0;t<s.length;t++)s[t].visible=t<e.length}const c=l?.resourceType||e;(0,o.setDefaultBrowseColumns)(c,"",1,s)}(t):(0,o.setDefaultBrowseColumns)(b?"microsoft.resources/resources":t,b?"tags":r,w,g.map((e=>"type"===e.id?{...e,id:"assetType"}:e))),M=(0,o.getVisibleBrowseColumns)(b?"microsoft.resources/resources":t,b?"tags":r,w)().map((e=>"assetType"===e.id?{...e,id:"type"}:e));const C=g.filter((e=>e.visible)).sort(((e,t)=>e.index-t.index));if(s&&"_default_"!==s.id)if(s?.gridColumns?.length){const e=e=>{switch(e.toLowerCase()){case"typedisplayname":case"assettype":return"type";case"locationdisplayname":return"location";case"subscriptiondisplayname":return"subscription"}return e},t={};s.gridColumns.forEach(((s,i)=>t[e(s.id.toLowerCase())]={index:i,...s})),M=g.map((e=>t[e.id.toLowerCase()]?{...e,visible:!1!==t[e.id.toLowerCase()].visible,index:t[e.id.toLowerCase()].index}:null)).filter((e=>e?.visible)).sort(((e,t)=>e.index-t.index))}else M=C;const S={name:{name:"name",displayName:y.name,format:1},type:{name:"type",displayName:y.type,format:1,sortType:"resourceType"},location:{name:"location",displayName:y.location,format:5,sortType:"location"},resourcegroup:{name:"resourceGroup",displayName:y.resourceGroup,format:2},subscription:{name:"subscription",displayName:y.subscription,format:2,sortColumn:"subscriptionId",sortType:"subscription"},locationid:{name:"locationId",displayName:y.Columns.LocationId.title,format:1,sortColumn:"location"},edgezone:{name:"edgeZone",displayName:y.Columns.EdgeZone.title,format:1,sortType:"edgeZone"},kind:{name:"kind",displayName:y.Columns.Kind.title,format:1},resourcegroupid:{name:"resourceGroupId",displayName:y.Columns.ResourceGroupId.title,format:1,sortColumn:"resourceGroup"},resourceid:{name:"resourceId",displayName:y.Columns.ResourceId.title,format:1,sortColumn:"id"},resourcetype:{name:"resourceType",displayName:y.Columns.ResourceType.title,format:1,sortColumn:"type"},subscriptionid:{name:"subscriptionId",displayName:y.Columns.SubscriptionId.title,format:1},tagsarray:{name:"tagsArray",displayName:y.Columns.Tags.title,format:1}};return Object.values(c).forEach((e=>{let t,s;switch(e.format){case 5:t="location";break;case 7:t="tenant"}e.sortColumn&&(s="string"==typeof e.sortColumn?e.sortColumn:Object.keys(F).find((t=>F[t]===e.sortColumn))),S[e.name.toLowerCase()]={name:e.name,displayName:e.displayName,format:e.format,sortColumn:s,sortType:t}})),{resourceType:t,columnIdToResourceColumnMap:F,manifestColumnsMap:c,visibleColumns:M,defaultVisibleColumns:C,columnDataMap:S}}function V(e){return(e.resourceTypeName+(e.resourceKindName?":"+e.resourceKindName:"")).toLowerCase()}function q(e){return C.find((t=>t.key===e))}function $(e){return I.find((t=>t.key===e))}function j(e){return _.find((t=>t.key===e))}function G(e,t,s,o,n){if(s.sortBy.startsWith("tags.")||"__hubs_search_priority_ranking"===s.sortBy||!o)return null;const r=o.sortColumn||o.name;if("resourceType"===o.sortType){const s=i.forEachKey(e.assetTypes,((e,s,o)=>{if(e&&s&&(!Object.keys(t).length||t[e.toLowerCase()])){const t=s.displayName?.singular||e;let n,r;s.defaultKind?.displayName?.singular&&(n=s.defaultKind.displayName?.singular),s.kindMap&&(r=i.forEachKey(s.kindMap,((e,s,i)=>{i[e]=s.displayName?.singular||t}),{})),o[e]={displayName:n||t,subValueDisplayNames:r}}}),{}),o=`${r}DisplayName`;return{projectedColumn:o,provider:(0,l.buildDisplayNameMapProvider)({columnName:r,mappedColumnName:o,subValueColumnName:"kind",displayNameMapFunc:()=>s})}}if("location"===o.sortType){const t=MsPortalFx.extendStringMapIntoMap(Object.create(null),e.locations,(e=>({displayName:e.displayName}))),s=`${r}DisplayName`;return{projectedColumn:s,provider:(0,l.buildDisplayNameMapProvider)({columnName:r,mappedColumnName:s,displayNameMapFunc:()=>t})}}if("subscription"===o.sortType){const e=`${o.name}DisplayName`;return{projectedColumn:e,provider:(0,l.buildDisplayNameMapProvider)({columnName:r,mappedColumnName:e,displayNameMapFunc:()=>MsPortalFx.convertArrayToMap(n,(e=>e.subscriptionId),(e=>({displayName:e.displayName})))})}}if("edgeZone"===o.sortType){const e="edgeZone";return{projectedColumn:e,provider:(0,l.buildIifMapProvider)({predicate:'isnotnull(extendedLocation) and extendedLocation.type =~ "edgezone"',trueValue:"extendedLocation.name",falseValue:'""',mappedColumnName:e})}}if("tenant"===o.sortType){const t=MsPortalFx.extendStringMapIntoMap(Object.create(null),e.directoriesMap,(e=>({displayName:e.displayName}))),s=`${o.name}DisplayName`;return{projectedColumn:s,provider:(0,l.buildDisplayNameMapProvider)({columnName:r,mappedColumnName:s,displayNameMapFunc:()=>t})}}}function K(e,t,s,i,o){const n={id:t?.[e]||e.toString(),name:s.title,description:s.description,visible:!o,index:i};return F[n.id]=e,n}function J(e,t,s){return{id:w[e],name:t.title,description:t.description,visible:!s}}async function Q(e){const t=(await("HubsExtension"===e.extensionName?(0,u.getAssetTypeViewModel)(e):(0,u.getAssetTypeViewModel)(e,{keepReturnsIn:"getBrowseConfig",method:"getBrowseConfig",args:[{}]}))).getAssetTypeContract(2);if(!t||"function"!=typeof t.getBrowseConfig)throw new Error(`Asset type '${e.resourceType}' does not have a valid getBrowseConfig method`);return MsPortalFx.first(t._msPortalFx_earlyExecgetBrowseConfig)||t.getBrowseConfig()}function X(e){return"microsoft.resources/resources"===e.resourceType?.toLowerCase()||"microsoft.resources/resourceswithtag"===e.resourceType?.toLowerCase()?Promise.resolve({compositeDisplayName:y.AssetTypeNames.AllResource,extensionName:"HubsExtension"}):(0,m.getResourceTypeSingleAssetTypeInformation)(e.resourceType).then((e=>e),(t=>Promise.resolve({compositeDisplayName:{singular:e.resourceType,plural:e.resourceType},extensionName:"Unknown",assetTypeNotFound:!0,assetTypeError:t})))}function Z(e,t,s){return"string"==typeof e?e:t[e]||s[e]}function Y(e,t){const{name:s,iconColumn:i,bladeParameterColumn:o,sortColumn:n}=e,{columnIdToArgColumn:r,columnIdToStringMap:a}=t,l=[s],c=[i,o,n];for(const e of c)e&&l.push(Z(e,r,a));return l}function ee(e){return"microsoft.resources/resources"===e||"microsoft.resources/subscriptions/resourcegroups"===e||"microsoft.resources/resourceswithtag"===e?1:2}async function te(e){const t=n.ArmId.parse(e,!0);return 1===t.kind?await p.container.get(h.SubscriptionsUserContext).getSubscription(t.subscription):await p.container.get(h.SubscriptionsUserContext).getSubscription(e)}function se(e,t){const s=n.ArmId.parse(t,!0);return("microsoft.resources/resources"===e||"microsoft.resources/subscriptions/resourcegroups"===e)&&i.isFeatureEnabled("argbrowsemgscope")&&8===s.kind&&"microsoft.management/managementgroups"===s.resourceType.toLowerCase()}function ie(e){return"number"==typeof e&&w[e]||("number"==typeof e||e)&&e.toString()}function oe(e,t){return e?.viewModel&&(0,r.supportsContract)(e.contracts,t)}function ne(e){if(!e)return null;const t=e.slice(-2,-1),s=e.slice(4,-2);return e.startsWith("ago(")&&e.endsWith(")")&&!isNaN(Number(s))&&{s:!0,m:!0,h:!0,d:!0}[t]?s+t:null}})),
define("MsPortalImpl/Services/Services.ArmEvents",["require","exports","Fx/ResourceManagement","FxHubs/ArmHelpers/ArmIds","FxHubs/RpcEndPoints","FxInternal/AsyncLoader","Fx/DependencyInjection"],(function(e,t,s,i,o,n,r){"use strict";function a(e,t){return!e==!t&&e.toLowerCase()===t.toLowerCase()}t.subscribeToArmEventHandler=t.removeArmEventSubscriptionHandler=t.matchEventsHandler=t.createResourceDeletedEventHandler=t.ArmEvents=void 0;let l=t.ArmEvents=class{constructor(){this.instanceHandlers=[]}subscribeToArmEvent(e,t,s){if(!(e.operationNameRegex||e.source||e.status||e.subStatus))throw new Error("At least one criteria must be specified.");const i=MsPortalFx.getUniqueId();return this.instanceHandlers.push({cookie:i,criteria:e,callback:t,eventLimit:s}),i}removeArmEventSubscription(e){this.instanceHandlers=this.instanceHandlers.filter((t=>t.cookie!==e))}matchEvent(e,t){const s=t.operationNameRegex;if(s){if(!new RegExp(s,"gi").test(e.operationName))return!1}const i=t.source,o=t.status,n=t.subStatus;return!(i&&!a(e.source,i)||o&&!a(e.status,o)||!MsPortalFx.isNullOrUndefined(n)&&!a(e.subStatus,n))}matchEvents(e){this.instanceHandlers.slice().forEach((t=>{const s=[];e.forEach((e=>{this.matchEvent(e,t.criteria)&&s.push(e)})),t.callback(s.slice(0,t.eventLimit||s.length))}))}createResourceDeletedEvent(e){const t="microsoft.resources",o=t+"/subscriptions/resourcegroups",n="/delete",r=(e,s)=>{this.matchEvents([{operationName:s,status:"succeeded",source:t,correlationId:null,timestamp:new Date,assetId:e,isLocalEvent:!0}])};e.forEach((e=>{const t=s.ArmId.parse(e.assetId,!0);4===t.kind?r(e.assetId,o+n):i.ResourceArmIdKindMap[t.kind]&&r(e.assetId,n)}))}};t.ArmEvents=l=__decorate([__metadata("fx:diagnostics",[e,"ArmEvents"]),r.Class()],l);const{createResourceDeletedEventDefinition:c,matchEventsDefinition:d,removeArmEventSubscriptionDefinition:p,subscribeToArmEventDefinition:u}=o.Events;t.createResourceDeletedEventHandler=(0,n.defineHandler)(c,(e=>e.diContainer.get(l).createResourceDeletedEvent(MsPortalFx.makeArray(e.messageArg)))),t.matchEventsHandler=(0,n.defineHandler)(d,(e=>e.diContainer.get(l).matchEvents(e.messageArg.events))),t.removeArmEventSubscriptionHandler=(0,n.defineHandler)(p,(e=>e.diContainer.get(l).removeArmEventSubscription(e.messageArg.cookie))),t.subscribeToArmEventHandler=(0,n.defineHandler)(u,(e=>{const t=e.messageArg,s=ko.observableArray();return{cookie:e.diContainer.get(l).subscribeToArmEvent(t.eventCriteria,s,t.eventLimit),events:s}}))})),
define("MsPortalImpl/AzFramework/AzHost.Browse",["require","exports","FxHubs/ArtHelpers/ArtApis","FxHubs/ResourceCommands/BrowseCommanding","Fx","Fx/Pinner","MsPortalImpl/Services/Services.ArmEvents","Fx/ResourceManagement","Fx/Composition","FxHubs/RpcEndPointsCore","FxHubs/ArtHelpers/KustoQueryGenerator","MsPortalImpl/ReactViews/Browse.Prewarmer","Fx/DependencyInjection","FxHubs/ArtHelpers/ArgBrowseHelpers","Fx/Experimentation","Fx/Errors","FxHubs/Tags/TagsStartup","FxHubs/ArmClient","FxHubs/ArtHelpers/ZeroSubsExperience","FxHubs/RpcEndPoints","FxHubs/HubsSettingsSchema","FxHubs/Common/ResourcesOperationsCache","MsPortalImpl/Services/Services.Subscriptions","FxHubs/Common/UserSettingsHelper"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x,b,y,v,w,M,C){"use strict";t.executeArmBulkCommandHandler=T,t.getAllSubscriptionsCount=k,t.getColumnsData=D,t.getResourcesForExport=L,t.getResourcesFromArg=z,t.getZeroSubsPanels=q,t.registerBrowseHandlers=function(e,t,s,i,o,n){o.get(w.ResourcesOperationsCache).watchArmEvents(!0,o.get(r.ArmEvents)),e.set(3201,(e=>{t(ie(p.getResourceTypeBrowseData)(n,e.resourceType,e.scope),e)})),e.set(3202,(e=>{t(ie(p.getSubscriptionsFromArg)(e),e)})),e.set(3214,(e=>{t(ie(O)(e),e)})),e.set(3203,(async e=>{const t=await o.get(g.Experimentation).shellAssignments.whenAvailable();ie(T)({modelParameters:e,lifetime:i,experimentAssignments:t})})),e.set(3204,(e=>{ie(G)(e.resourceToPin)})),e.set(3205,(e=>{t(ie(j)(e.newTags),e)})),e.set(3206,(async e=>{const s=await o.get(g.Experimentation).shellAssignments.whenAvailable();t(ie(B)(e,s),e)})),e.set(3207,(e=>{t(ie(A)(e),e)})),e.set(3208,(e=>{t(ie(E)(o,{setting:"HoverCards",settingKey:"Visible"}),e)})),e.set(3224,(async e=>{(await o.get(g.Experimentation).shellAssignments.whenAvailable()).getBooleanValue("hidebrowsecards")?t(ie(E)(o,{setting:"CardToolbar",settingKey:"Visible"}),e):t(ie(E)(o,{setting:"CardToolbar",settingKey:"Hidden"}).then((e=>!e)),e)})),e.set(3209,(async e=>{const s=await o.get(g.Experimentation).shellAssignments.whenAvailable();t(ie(L)(e,s),e)})),e.set(3210,(e=>{t(ie(N)(e),e)})),e.set(3211,(async e=>{const s=await o.get(g.Experimentation).shellAssignments.whenAvailable();t(ie(R)(e,s),e)})),e.set(3212,(e=>{t(ie(U)(e),e)})),e.set(3213,(async e=>{const s=await o.get(g.Experimentation).shellAssignments.whenAvailable();t(ie(z)(e,s),e)})),e.set(3215,(e=>{ie(se)(e)})),e.set(3217,(e=>{t(ie(p.loadBrowseView)(e),e)})),e.set(3216,(e=>{t(ie(K)(e),e)})),e.set(3218,(e=>{t(ie(J)(e),e)})),e.set(3229,(e=>{t(ie(X)(e),e)})),e.set(3239,(e=>{ie(Z)(e)})),e.set(3219,(e=>{t(Promise.resolve(ie(V)(e)),e)})),e.set(3230,(e=>{t(Promise.resolve(ie(W)(e)),e)})),e.set(3231,(e=>{const t=e.resourceColumns.map((e=>({id:"type"===e.id?"assetType":e.id,name:e.name,visible:e.visible})));ie(m.setPersistedBrowseColumns)(o,e.resourceType,e.scopeResourceType,e.version||1,t,e.viewId)})),e.set(3220,(async e=>{const t=await o.get(g.Experimentation).shellAssignments.whenAvailable();ie(ee)(e,t)})),e.set(3221,(e=>{ie(te)(e)})),e.set(3222,(e=>{t(ie(k)(),e)})),e.set(3223,(async e=>{t(ie(q)(e,o),e)})),e.set(3236,(e=>{t(ie($)(),e)})),e.set(3225,(e=>{t(ie(E)(o,{setting:"PageSize",settingKey:"PageSize"}),e)})),e.set(3226,(e=>{ie(Y)(e)})),e.set(3227,(e=>{t(ie(D)(n,e.resourceType,e.scope,e.view,e.forceColumnsV1),e)})),e.set(3228,(async e=>{const s=await o.get(g.Experimentation).shellAssignments.whenAvailable();t(ie(H)(e,s,n),e)}))},t.saveBrowseUserSettings=oe;MsPortalFx.Extension;var S=MsPortalFx.Base.Diagnostics.Telemetry;const I=MsPortalFx.Resources.Strings.Browse,P=()=>o.require("FxHubs/ArmHelpers/ArmTags"),_=MsPortalFx.Base.Diagnostics.createLog(e),F={1:{column:2,facet:3},2:{column:2,facet:3},4:{column:5,facet:5},5:{column:2,facet:3},3:{column:4,facet:4},7:{column:2,facet:3},8:{column:2,facet:3}};async function T(e){const t={},s={},i=e.modelParameters.resources.map((e=>({name:e.resourceName,id:e.resourceId,type:e.resourceType,kind:e.kind}))),o=e.modelParameters.browseData.resourceTypeDetails.resourceType,n=()=>{MsPortalFx.require("FxHubs/ResourceCommands/BrowseBulkCommandImpl").then((t=>{new t.BulkCommandImpl(e.lifetime,"ExecuteArmCommand",{resourceType:o,hasSelectedItems:ko.observable(e.modelParameters.hasSelectedItems),selectedBrowseItems:ko.observable(i)},e.modelParameters.commandDefinition,e.modelParameters.apiVersionsMap).execute({button:6},s)}))},r=e.modelParameters.browseData.browsePrereqs.browseQueryManifest,a=r.mergedResourceTypes?.length>0,l=()=>{i.forEach((i=>{if(i.kind){const o=i.kind,n=s[i.type?.toLowerCase()]||{};if(n[o])return;const l=a?t[i.type?.toLowerCase()]:r,c=function(e,t,s){let i=[];if(t){const o=e.kindCommandNameMapping&&e.kindCommandNameMapping[t.toLowerCase()],n=o&&e.kindCommands?.[o.toLowerCase()];i=s?n?.selectionCommands:n?.commands,i?.length||s||(i=e?.commands?.commands)}else i=s?e?.commands?.selectionCommands:e?.commands?.commands;return i||[]}(l,o,!0)?.find((t=>t.label.toLowerCase()===e.modelParameters.commandDefinition.label.toLowerCase()));n[o]=c?.armCommandDefinitionOptions?.definitions?.[i.type?.toLowerCase()],s[i.type?.toLowerCase()]=n}})),n()};if(e.experimentAssignments.getStringValue("kindspecificcommandsincombinedbrowseview")?.toLowerCase()===o?.toLowerCase())if(a)if(t[o.toLowerCase()]=r,i.some((e=>!t[e.type?.toLowerCase()]))){const e=r.mergedResourceTypes.map((e=>e.resourceTypeName))?.reduce(((e,t)=>(e.includes(t)||e.push(t),e)),[]);c.Browse.getBrowseManifestsForResourceTypesEndpoint.invoke(FxImpl.Rpc.client,"fxw",e).then((s=>{e.forEach((e=>{t[e?.toLowerCase()]=s[e]})),l()}))}else l();else l();else n()}async function k(){const e=await o.memoizePromise((()=>y.Impl.getAllSubscriptionsCount(u.container.get(FxImpl.Rpc.Client))))();return{type:e?.type||0,value:e?.value}}async function E(e,t){const{setting:s,settingKey:i}=t,o=e.get(C.UserSettingsHelper),n=await o.readSettings([s],15);return n?.[s]?.[i]}async function D(e,t,s,i,o){return p.columnsDataQuery.bind(e,e,t,s,i,o).get()}async function A(e){try{const t={...e},{listScopeArmId:s,listScope:i}=e;if(4===s?.kind){const e=await(0,x.getResourceGroup)(i,"scope location");t.listScopeLocation=e?.location}else if([6,3,8].includes(s?.kind)){const e=await(0,x.getResource)(i,"scope location");t.listScopeLocation=e?.location}return await(0,m.getCreateBlade)(t,e.scope)}catch{return}}function B(e,t){const{telemetrySource:s,resourceType:o,kind:n,browseData:r,visibility:a,excludeCommands:c}=e,d=r?.browsePrereqs?.browseQueryManifest||{},p=(r?.browsePrereqs?.assetTypes||Object.create(null))[o?.toLowerCase()||""],u=p?.assetId.replaceAll("_",""),m=u&&t.getStringValue(`BrowseCommands-${u}`);let g,h;if(!(c||[]).includes("generic")){g=i.createGenericCommandDescriptors(s,d,p,o,a,m?.toLowerCase(),r?.browsePrereqs?.assetTypes[o?.toLowerCase()]?.isDisabled,n);const e=t=>{t?.forEach((t=>{switch(t.itemType){case"openMarketplace":t.bladeReference=l.BladeReferences.forMarketplace().createReference({marketplaceId:t.commandDefinition.marketplaceItemId});break;case"menu":e(t.commandItems)}}))};e(g)}return(c||[]).includes("selection")||(h=i.createSelectionCommandDescriptors(s,d,p,o,a,m?.toLowerCase(),n,!0)),Promise.resolve({genericCommands:g,selectionCommands:h})}async function N(e){const{browseData:t,cardDefinition:i,browseQuery:o,subscriptions:n,telemetrySource:r,reason:a,resourceType:l}=e,c=i.manifest.countQuery.replace("[[sourceQuery]]",o),d=i.extension+":"+i.manifest.id,u={query:c,options:{$top:1e3,$skipToken:""},subscriptions:(0,p.shouldRequestIncludeSubscriptions)(t,t?.browsePrereqs)?n.map((e=>e.subscriptionId)):void 0};try{const e=[10,30,60,300],t=await s.getDataFromArt(u,`${r}.${d.toLowerCase()}.${a}`,256,null,!1,{retryTimeoutsInSeconds:e,notifyRetry:(e,t,s)=>{const o=i.manifest.id.charAt(0).toUpperCase()+i.manifest.id.slice(1);S.trace({source:r,action:"BrowseLoadThrottle"+r+`${o}Count`,actionModifier:S.ActionModifier.Mark,data:{resourceType:l}})},skipErrorLogging:!1}),o=t?.data;if(1===o?.rows?.length){return{count:o.rows[0][0].toString()}}}catch(e){const t=MsPortalFx.getLogFriendlyMessage(e?.content?.error||e?.jqXHR);_.warning(new h.FxError({message:`Error fetching ${d}. Error: ${t}`,innerErrors:[e]}))}return{count:"-"}}async function R(e,t){const{reason:i,subscriptions:o,managementGroups:n,kind:r,visibleColumns:a,resourceType:l,currentResourceTypes:c,showHiddenTypes:u,filter:m,filterSearchTerm:g,searchTerm:h,filters:f,telemetrySource:x,browseData:b,columnDataMap:y,scope:v,scopeParameters:w}=e,M=b?.browsePrereqs||await(0,p.getBrowsePreReqs)({resourceType:l});let C=(0,p.getColumnProjectionForFacet)(m.value),S=(0,p.getColumnType)(C);const I=t.getBooleanValue("NameSearchPrioritization"),P=(0,p.createKustoQueryGenerator)({browsePrereqs:M,columns:[],visibleColumns:a,resourceType:l,currentResourceTypes:c,kind:r,showHiddenTypes:u,searchTerm:h,filters:f?.filter((e=>e.filter&&e.filter.key!==m.key)),telemetrySource:x,sortColumns:S&&[{sortBy:m.value,order:1,sortFormat:null}],columnDataMap:y,scope:v,scopeParameters:w,subscriptions:o,useNamePrioritization:I}),_=(l||"").toLowerCase(),T=(0,p.useEdgeZones)(_,M.browseQueryManifest);let k=!1;if(m.key.startsWith("tags.")){k=!0;const e=P.getPostExpandMappingProviders();P.addedTagKeyClauses||e.push(...d.tagKeyClauses),C="tagValue",S=void 0,e.push("extend tagIndex=array_index_of(lowerTagKeys,tolower("+(0,d.encodeKustoValue)(m.value,!0)+"))"),e.push("extend "+C+"=iff(tagIndex==-1,'',tags[tostring(tagKeys[tagIndex])])"),P.setPostExpandMappingProviders(e);const t=P.getProjectedColumns();t.includes(C)||(t.push(C),P.setProjectedColumns(t)),P.updateQuery()}else if(!(0,p.defaultProjectedColumns)(T).includes(C)){const e=P.getProjectedColumns();e.includes(C)||(e.push(C),P.setProjectedColumns(e)),P.updateQuery()}const E=function(e,t,s,i){const o=t?.[e.toLowerCase()];if(e.startsWith("tags.")||!o)return null;if((0,p.defaultProjectedColumns)(s).includes(e))return null;const n="column"===i?F[o?.format]?.column:F[o?.format]?.facet;if(!n)return null;return(0,d.extendColumnWithCastFunctionWrappedColumn)(e,n)}(C,y,T,"facet");E&&(P.setSuffixPredicates([E]),P.updateQuery());const D={query:P.query(),options:{$top:1,$skipToken:""},facets:[{expression:C,options:{$top:100,filter:g?C+" contains "+(0,d.encodeKustoValue)(g):null,sortOrder:"asc",sortBy:C}}]};(0,p.shouldRequestIncludeSubscriptions)(b,M)&&(o?.length?D.subscriptions=o.map((e=>e.subscriptionId)):n&&(D.managementGroups=n));const A=(await s.getDataFromArt(D,`${x}.${i}`)).facets||[];if(1===A.length){const e=MsPortalFx.convertArrayToMap(A[0].data.columns,(e=>e.name),((e,t)=>t)),t=e[C],s=e.count,i=k?new Map:FxImpl.lowerCaseStringMap(),o=A[0].data.rows.reduce(((e,i)=>{const o=i[t],n=e.get(String(o))||{name:o,count:0};return n.count+=parseInt(i[s]||"0"),e.set(String(o),n),e}),i),n={};return o.forEach(((e,t)=>n[String(t)]=e)),Promise.resolve({count:A[0].count,totalRecords:A[0].totalRecords,values:n})}return Promise.resolve({count:0,totalRecords:0,values:{}})}async function L(e,t){const{columns:i,visibleColumns:o,currentResourceTypes:n,kind:r,managementGroups:a,subscriptions:l,resourceType:c,showHiddenTypes:d,telemetrySource:u,searchTerm:m,filters:g,browseData:h,maxCsvItems:f,sortColumns:x,columnDataMap:b,scope:y,scopeParameters:v}=e,w=h?.browsePrereqs||await(0,p.getBrowsePreReqs)({resourceType:c}),M=t.getBooleanValue("NameSearchPrioritization"),C=(0,p.createKustoQueryGenerator)({browsePrereqs:w,columns:i,visibleColumns:o,resourceType:c,currentResourceTypes:n,kind:r,showHiddenTypes:d,searchTerm:m,filters:g,telemetrySource:u,sortColumns:x,columnDataMap:b,scope:y,scopeParameters:v,subscriptions:l,useNamePrioritization:M});let S=0;const I=async(e,t=0)=>{const i={$top:1e3,$skipToken:e};(0,p.respectOperationsCacheBeforeArgRequest)(C,c,w,n,y);const o={query:C.query(),options:i};(0,p.shouldRequestIncludeSubscriptions)(h,w)&&(l?.length?o.subscriptions=l.map((e=>e.subscriptionId)):a&&(o.managementGroups=a));const r=await s.getDataFromArt(o,`Browse.${u}.DownloadCsv.${S}`),d=r.data||{},m=MsPortalFx.convertArrayToMap(d.columns,(e=>e.name),((e,t)=>t)),g=d.rows.map((e=>{const t={};return(d.columns||[]).forEach(((s,i)=>{const o=s.name.replaceAll("_",".");t[o]=e[i]})),t.resourceId=e[m.id],t.name=e[m.name],t.location=e[m.location],t.resourceKind=e[m.kind],t})),x=t+g.length;if(r.$skipToken&&x<Math.min(f,r.totalRecords)){S++;const e=await I(r.$skipToken,x);return[...g,...e]}return g.slice(0,Math.min(f-t,g.length))};return I("")}async function z(e,t){const{columns:i,visibleColumns:o,startIndex:n,currentResourceTypes:r,kind:l,managementGroups:c,pageSize:d,subscriptions:u,reason:m,resourceType:g,showHiddenTypes:h,telemetrySource:f,searchTerm:x,filters:b,browseData:y,sortColumns:v,groupByColumn:w,groupByFormat:M,columnDataMap:C,scope:S,scopeParameters:I}=e,P=y?.browsePrereqs||await(0,p.getBrowsePreReqs)({resourceType:g}),_=t.getBooleanValue("NameSearchPrioritization"),F=(0,p.createKustoQueryGenerator)({browsePrereqs:P,columns:i,visibleColumns:o,resourceType:g,currentResourceTypes:r,kind:l,showHiddenTypes:h,searchTerm:x,filters:b,telemetrySource:f,sortColumns:v,groupByColumn:w,groupByFormat:M,columnDataMap:C,scope:S,scopeParameters:I,subscriptions:u,useNamePrioritization:_}),T={$top:d,$skip:n,$skipToken:"",allowPartialScope:t.getBooleanValue("allowPartialScope")},k=F.query();(0,p.respectOperationsCacheBeforeArgRequest)(F,g,P,r,S);const E={query:F.query(),options:T};(0,p.shouldRequestIncludeSubscriptions)(y,P)&&(u?.length?E.subscriptions=u.map((e=>e.subscriptionId)):c&&(E.managementGroups=c));const D=await s.getDataFromArt(E,`${f}.${m}`),A=D.data||{},B=MsPortalFx.convertArrayToMap(A.columns,(e=>e.name),((e,t)=>t));return{resources:A.rows.map((e=>{const t={};(A.columns||[]).forEach(((s,i)=>{const o=s.name.replaceAll("_",".");t[o]=e[i]}));const s=e[B.id];return t.resourceId=s,t.name=a.ResourceName.getDisplayName({id:s,name:e[B.name],armId:a.ArmId.parse(s,!0),tags:e[B.tags]||{}},null,S)||e[B.name],t.location=e[B.location],t.resourceKind=e[B.kind],t})),sourceQuery:k,tenantMaxSubscriptionLimit:D.tenantMaxSubscriptionLimit,tenantSubscriptionLimitHit:D.tenantSubscriptionLimitHit,totalRecords:D.totalRecords}}async function H(e,t,s){return p.resourcesQuery.bind(s,s,t,e.resourceType,e.kind,e.scope,e.scopeParameters,e.view).get()}async function O(e){return{subscriptions:(await(e.searchTerm?Q(FxImpl.Azure.searchForSubscriptionsEndPoint.invoke(u.container.get(FxImpl.Rpc.Client),"fx",e.searchTerm)):Q(y.Impl.getInSessionDisplayedSubscriptions(u.container.get(FxImpl.Rpc.Client))))).subscriptions.map((e=>e))}}async function U(e){const{subscriptions:t,maximumTags:s,searchTerm:i}=e,n=e.existingTagMap||Object.create(null),r=await(0,f.getAllTags)(u.container,t,s,!0,i,o.isFeatureEnabled("artbrowse"));let a;const l=r.errors;return l?.length&&(a=(r.completeFailure?I.ResourceTagsListPart.completeFailureMessage:I.ResourceTagsListPart.partialFailureMessage)+"\n\n"+l.join("\n")),r.tagItems.forEach((e=>{e.name||_.warning(new h.FxError({message:`Browse.ReactModel: found tag with no name. tagItems: ${JSON.stringify(r.tagItems)}`}));const t=e.name?.toLowerCase(),s="tags."+t;if(!n[s]){const t={id:s,name:e.name};n[s]=t}})),{tagNameMap:n,isError:r.completeFailure,statusMessage:a}}function W(e){return(0,m.getDefaultBrowseColumns)(e.resourceType,e.scopeResourceType,e.version)().map((e=>"assetType"===e.id?{...e,id:"type"}:e))}function V(e){return(0,m.getVisibleBrowseColumns)(e.resourceType,e.scopeResourceType,e.version)().map((e=>"assetType"===e.id?{...e,id:"type"}:e))}async function q(e,t){const{telemetrySource:s}=e,i=(await MsPortalFx.Base.Security.getUserInfo()).isGitHubUser;return(0,b.getZeroSubsPanels)({telemetrySource:s,isGitHubUser:i,diContainer:t}).map((e=>({image:e.icon,title:e.panelTitle,description:e.panelDescription,button:{label:e.buttonText,link:e.buttonClickableLink.uri()},freeServiceLink:e.freeServiceClickableLink&&e.freeServiceClickableLink?.uri(),learnMoreLink:e.learnMoreClickableLink?.uri()})))}async function $(){try{const[e,{showTenantSwitchView:t,tenantSwitchingTo:s}]=await Promise.all([(0,b.hasSubscriptionAsync)(),(0,b.shouldShowTenantSwitchView)()]);return{showRefreshPage:e,showTenantSwitchView:t,tenantSwitchingTo:s}}catch(e){return S.trace({source:"AzHost.Browse",action:"GetZeroSubsTenantAndSubResult",actionModifier:"error",data:{error:e}}),{showRefreshPage:!1,showTenantSwitchView:!1,tenantSwitchingTo:null}}}async function j(e){const t=await P(),s=new Map;Object.keys(e).forEach((t=>{s.set(t,e[t])}));const i=await t.handleTagsContextPaneResults(s);if(!i)return;const o=Object.create(null);return i.newTagsMap.forEach(((e,t)=>{o[t]=e})),o}function G(e){n.pin([new MsPortalFx.Composition.PartReference(e.partName,{id:e.resourceId},{extensionName:e.partExtensionName})],{notify:!0})}async function K(e){return await c.Browse.getBrowseViewsEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",e)}async function J(e){await c.Browse.saveBrowseViewEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",e)}async function X(e){return await c.Browse.updateBrowseViewLruEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",e)}function Z(e){const t=u.container.get(C.UserSettingsHelper);t.readSettings([v.Keys.browseFavoriteViews],15).then((s=>{s||(s=Object.create(null)),s[v.Keys.browseFavoriteViews]||(s[v.Keys.browseFavoriteViews]=Object.create(null)),s[v.Keys.browseFavoriteViews][e.resourceTypeKey]=e.favoriteViewId,t.writeSettings(s,void 0,15),c.Browse.onBrowseFavoriteViewIdUpdatedEndPoint.invoke(FxImpl.Rpc.client,"fxw",e)})).catch((e=>{_.error("Failed to set browse favorite view:",null,e)}))}function Y(e){oe({setting:"PageSize",settingKey:"PageSize",settingValue:e})}function ee(e,t){t.getBooleanValue("hidebrowsecards")?oe({setting:"CardToolbar",settingKey:"Visible",settingValue:e}):oe({setting:"CardToolbar",settingKey:"Hidden",settingValue:!e})}function te(e){oe({setting:"HoverCards",settingKey:"Visible",settingValue:e})}async function se(e){return u.container.get(M.SubscriptionsUserContext).setInSessionSelectedSubscriptions(e.subscriptionIds)}function ie(e){return async(...t)=>{try{return await e(...t)}catch(e){const t=FxImpl.Azure.buildSimplifiedError(e);throw{isBrowseError:!0,errorMessage:I.apiError.format(t.message),errorCode:t.status,assetTypeNotFound:e.assetTypeNotFound}}}}async function oe(e){const{setting:t,settingKey:s,settingValue:i}=e,o=u.container.get(C.UserSettingsHelper);let n=await o.readSettings([t],15);n=n?.[s]||Object.create(null),n[s]=i,await o.writeSettings({[t]:n},void 0,15)}})),
define("MsPortalImpl/Base/Base.Events",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";t.PortalCustomEvents=t.CustomEvents=void 0,t.exitFullscreen=function(){const e=document,t=e.exitFullscreen||e.webkitExitFullscreen||e.mozCancelFullScreen||e.msExitFullscreen;t&&t.call(e)},t.fxpinmultipleparts=t.fullscreen=void 0,t.getOrCreateFxElement=function(e,t){let s=MsPortalFx.find(t(),(t=>i(t)===e));s||(s={_handle:e},t.push(s));return s},t.isFullscreen=function(){const e=document;return!!(e.fullscreenElement||e.webkitFullscreenElement||e.mozFullScreenElement||e.msFullscreenElement)},t.requestFullscreen=function(){const e=document.documentElement,t=e.requestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen;t&&t.call(e)},t.unwrapFxElement=i;t.fxpinmultipleparts="fxpinmultipleparts",t.fullscreen="fullscreenchange MSFullscreenChange mozfullscreenchange webkitfullscreenchange";function i(e){return e._handle}class o{constructor(){this._events=new Map}setElement(e){this._element=e,this._events.forEach(((e,t)=>{e.forEach((e=>{this._setEvent(t,e)}))}))}_setEvent(e,t){if(t.ltm){if(t.ltm.isDisposed&&t.ltm.isDisposed())return;t.ltm.registerForDispose([this._element.setEvents([e,t.callback])])}else this._element.setEvents([e,t.callback])}trigger(e,t){if(!this._element)return;const s=$.Event(e);return s.type=e,s.target=this._element[0],this._element.trigger(s,t),s.isDefaultPrevented()}addHandler(e,t,s){this._events.has(t)||this._events.set(t,[]);const i={ltm:e,callback:s};this._events.get(t).push(i),this._element&&this._setEvent(t,i)}removeHandler(e,t){if(!this._events.has(e))return;const s=this._events.get(e);s.filter((e=>e.callback===t)).forEach((e=>{MsPortalFx.remove(s,e)}))}}t.CustomEvents=o;let n=t.PortalCustomEvents=class extends o{};t.PortalCustomEvents=n=__decorate([__metadata("fx:diagnostics",[e,"PortalCustomEvents"]),s.Class()],n)})),
define("_generated/Less/MsPortalImpl/Interactions/Interactions.FullScreenMode.css",["module"],(function(e){"use strict";return{css:".fxs-portal-fullscreen .fxs-sidebar,.fxs-portal-fullscreen .fxs-topbar,.fxs-portal-fullscreen .fxs-journey-breadcrumb{display:none!important}.fxs-portal-fullscreen .fxs-startboard-button{display:none}.fxs-portal-fullscreen .fxs-startboard-dropdown,.fxs-portal-fullscreen .fxs-startboard-commandBar{display:none}.fxs-portal-fullscreen .fxs-startboard-title-next,.fxs-portal-fullscreen .fxs-startboard-commandBar-fullScreen{display:block}",moduleId:e.id}})),
define("MsPortalImpl/Interactions/Interactions.FullScreenMode",["require","exports","Fx/DependencyInjection","FxInternal/Css","_generated/Less/MsPortalImpl/Interactions/Interactions.FullScreenMode.css"],(function(e,t,s,i,o){"use strict";t.FullScreenMode=void 0,(0,i.injectCss)(o);const n=document.body,r=n.classList;let a=t.FullScreenMode=class{constructor(){this.isActive=ko.observable(!1);new MutationObserver((()=>{this.isActive(r.contains("fxs-portal-fullscreen"))})).observe(n,{attributes:!0,attributeFilter:["class"]})}enter(){r.add("fxs-portal-fullscreen")}exit(){r.remove("fxs-portal-fullscreen")}toggle(){this.isActive()?this.exit():this.enter()}};t.FullScreenMode=a=__decorate([__metadata("fx:diagnostics",[e,"FullScreenMode"]),s.Class(),__metadata("design:paramtypes",[])],a)})),
define("MsPortalImpl/ReactServices/ReactServiceContext",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";t.ReactServiceContext=void 0;let i=t.ReactServiceContext=class{constructor(e){this.data=e}};t.ReactServiceContext=i=__decorate([__metadata("fx:diagnostics",[e,"ReactServiceContext"]),s.Value("reactview"),__metadata("design:paramtypes",[Object])],i)})),
define("MsPortalImpl/ReactServices/ReactServiceBase",["require","exports"],(function(e,t){"use strict";t.ProxyMethod=function(){return function(e,t){const s=Reflect.getOwnMetadata("fximpl:reactserviceproxymethods",e)||new Set;s.add(t),Reflect.defineMetadata("fximpl:reactserviceproxymethods",s,e)}},t.ReactServiceBase=void 0,t.isServiceProxyMethod=function(e,t){const s=Reflect.getOwnMetadata("fximpl:reactserviceproxymethods",e);return s?.has(t)||!1};t.ReactServiceBase=class{constructor(e,t){this.serviceName=e,this.context=t,this.contextData=this.context.data,this.stubFunctionCallbacks=t.data.stubFunctionCallbacks}fireEvent(e,t){this.context.data.invokeEventHandlerFn(this.serviceName,e,t)}verifyBladeOnlyApiAvailable(e){if(5===this.contextData.reactFrameType)throw new Error(`React service ${this.serviceName}.${e} is unavailable in the current ambient view context.`)}isValidCallback(e){return this.stubFunctionCallbacks?void 0!==this.getCallbackStub(e):"function"==typeof e}getCallbackStub(e){return"object"==typeof e&&"stubId"in e?e.stubId:void 0}invokeCallbackAction(e,...t){this.invokeCallback("action",e,...t)}invokeCallbackFunction(e,...t){return this.invokeCallback("function",e,...t)}getCallbackReplacement(e,t){if(this.stubFunctionCallbacks){const s=this.getCallbackStub(t);return s?(...t)=>this.context.data.invokeCallbackFn(e,s,...t):void 0}return t}invokeCallback(e,t,...s){if(this.stubFunctionCallbacks){const i=this.getCallbackStub(t);if(i)return this.context.data.invokeCallbackFn(e,i,...s)}else if("function"==typeof t)return t(...s)}}})),
define("MsPortalImpl/ReactServices/CacheService",["require","exports","Fx/DependencyInjection","MsPortalImpl/ReactServices/ReactServiceContext","MsPortalImpl/ReactServices/ReactServiceBase"],(function(e,t,s,i,o){"use strict";t.ReactCacheService=void 0;let n=t.ReactCacheService=class extends o.ReactServiceBase{constructor(e){super("cache",e),e.data.queryStore.subscribe((e=>{this.fireEvent("entryUpdated",e)}))}async updateEntry(e){this.contextData.queryStore.setEntry(e)}};__decorate([__metadata("fx:diagnostics",[e,"ReactCacheService.prototype"]),(0,o.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Promise)],n.prototype,"updateEntry",null),t.ReactCacheService=n=__decorate([__metadata("fx:diagnostics",[e,"ReactCacheService"]),s.Class("reactview"),__metadata("design:paramtypes",[i.ReactServiceContext])],n)})),
define("MsPortalImpl/UI/UI.DesktopManager",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";t.PreviouslyFocusedElement=t.DesktopManagerMode=t.BladeDescriptor=void 0;let i=t.BladeDescriptor=class{};t.BladeDescriptor=i=__decorate([__metadata("fx:diagnostics",[e,"BladeDescriptor"]),s.Value("composition")],i);let o=t.DesktopManagerMode=class{constructor(){this.value=ko.observable(0)}};t.DesktopManagerMode=o=__decorate([__metadata("fx:diagnostics",[e,"DesktopManagerMode"]),s.Class()],o);let n=t.PreviouslyFocusedElement=class{constructor(){this.value=ko.observable()}};t.PreviouslyFocusedElement=n=__decorate([__metadata("fx:diagnostics",[e,"PreviouslyFocusedElement"]),s.Class()],n)})),
define("MsPortalImpl/ReactServices/NavigationService",["require","exports","Fx/DependencyInjection","MsPortalImpl/ReactServices/ReactServiceContext","MsPortalImpl/UI/UI.BladeOpener","Fx/Composition/Selectable","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/ReactServices/ReactServiceBase","MsPortalImpl/Base/Base.Events","FxInternal/AsyncLoader"],(function(e,t,s,i,o,n,r,a,l,c){"use strict";t.ReactNavigationService=void 0;let d=t.ReactNavigationService=class extends a.ReactServiceBase{constructor(e){super("navigation",e),this.contextData.diContainer.get(l.PortalCustomEvents).addHandler(this.contextData.lifetime,"fxdeeplinkchanged",(()=>{this.fireEvent("currentDeepLinkChanged",location.hash)}))}closeChildView(){return this.verifyBladeOnlyApiAvailable("closeChildView"),this.contextData.getContainer().closeChildBlade()}closeContextPane(){return this.verifyBladeOnlyApiAvailable("closeContextPane"),this.contextData.getContainer().closeContextBlade()}closeCurrentView(e){this.verifyBladeOnlyApiAvailable("closeCurrentView"),this.contextData.getContainer().closeCurrentBlade(e)}async getNavigationHistory(){return(await this.contextData.diContainer.getAsync(c.get("MsPortalImpl/UI/Compositions/UI.Composition.BladeHistory","BladeHistory"))).getEntries().map((e=>{let t=e.bladeReference.parameters;if(t)try{structuredClone(t)}catch(s){MsPortalFx.Base.Diagnostics.Telemetry.trace({source:"AzHost",action:"GetRecentBlades",actionModifier:"stripParameters",data:{reference:{bladeName:e.bladeReference.bladeName,extensionName:e.bladeReference.extensionName},error:s?.message}}),t=void 0}return{timestamp:e.timestamp,duration:e.duration,viewReference:{extensionName:e.bladeReference.extensionName,parameters:t,viewName:e.bladeReference.bladeName}}}))}navigateToDeepLink(e){this.contextData.router.route(e,{openedBy:4})}openView(e,t={}){this.verifyBladeOnlyApiAvailable("openView");const s=this.convertViewToPdlBladeReference(e),i=this.getOpenBladeOptions(t);return this.contextData.diContainer.get(o.BladeOpener).openBlade(s,i)}convertViewToPdlBladeReference(e){const t=this.isValidCallback(e.onClosed)?(t,s)=>this.invokeCallbackAction(e.onClosed,this.convertBladeClosedReason(t),s):void 0;let s;return s="parameterProvider"===e.referenceType?new n.ParameterProviderBladeReference(e.viewName,e.extensionName,{parameters:e.parameters,onClosed:t,supplyInitialData:e.initialData&&(()=>FxImpl.fromSerializableObject(e.initialData)),supplyProviderConfig:e.providerConfig&&(()=>e.providerConfig),receiveResult:this.isValidCallback(e.receiveResult)&&(t=>{this.invokeCallbackAction(e.receiveResult,FxImpl.toSerializableObject(t))})}):"menu"===e.referenceType?new n.MenuBladeReference(e.viewName,e.menuId,e.extensionName,{contentBladeReference:e.contentViewReference&&this.convertViewToPdlBladeReference(e.contentViewReference),parameters:e.parameters,onClosed:t}):"provisioning"===e.referenceType?new n.ProvisioningBladeReference(void 0,e.extensionName,{assetType:e.assetType,assetKind:e.assetKind,catalogId:e.catalogId,telemetryId:e.telemetryId,marketplaceId:e.marketplaceId,subscriptionId:e.subscriptionId},{parameters:e.parameters,onClosed:t}):new n.PdlBladeReference(e.viewName,e.extensionName,{parameters:e.parameters,onClosed:t}),FxImpl.shellInterface(s,FxImpl.shellInterface(e)),s}convertBladeClosedReason(e){return"ChildClosedSelf"}getOpenBladeOptions(e){const t=this.contextData.getContainer(),s=this.contextData.reactFrameType,i=this.getOpenBladeFlags(e,!1),o=5!==s&&this.contextData.diContainer.get(r.BladeDescriptor)?.flags,n=MsPortalFx.isFeatureEnabled("sidebarnotparent")&&!!(256&o);return{container:n?void 0:t,flags:i,telemetryName:"AzHost",context:{openedBy:n?1:0}}}getOpenBladeFlags(e,t){let s;return e?.asNewJourney?s|=8:e?.asContextPane?(s|=1,s|=this.contextData.inContextPane&&4):this.contextData.hasParentMenu&&e?.preserveParentMenu&&(s|=4),s|=e?.asSubJourney&&2,s|=t&&16,s|="closed"===e?.helpPane&&64,s|="minimized"===e?.helpPane&&128,s}};__decorate([__metadata("fx:diagnostics",[e,"ReactNavigationService.prototype"]),(0,a.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],d.prototype,"closeChildView",null),__decorate([__metadata("fx:diagnostics",[e,"ReactNavigationService.prototype"]),(0,a.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],d.prototype,"closeContextPane",null),__decorate([__metadata("fx:diagnostics",[e,"ReactNavigationService.prototype"]),(0,a.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],d.prototype,"closeCurrentView",null),__decorate([__metadata("fx:diagnostics",[e,"ReactNavigationService.prototype"]),(0,a.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],d.prototype,"getNavigationHistory",null),__decorate([__metadata("fx:diagnostics",[e,"ReactNavigationService.prototype"]),(0,a.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",void 0)],d.prototype,"navigateToDeepLink",null),__decorate([__metadata("fx:diagnostics",[e,"ReactNavigationService.prototype"]),(0,a.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",Promise)],d.prototype,"openView",null),t.ReactNavigationService=d=__decorate([__metadata("fx:diagnostics",[e,"ReactNavigationService"]),s.Class("reactview"),__metadata("design:paramtypes",[i.ReactServiceContext])],d)})),
define("MsPortalImpl/Services/Services.ExtensionTokensManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Services/Services.SecurityTokens","FxInternal/ExtensionRuntime"],(function(e,t,s,i,o,n){"use strict";t.ExtensionTokensManager=void 0;var r=MsPortalFx.Base,a=r.Security,l=FxImpl.Security,c=r.Diagnostics.Telemetry;const d=r.Diagnostics.createLog(e),p=l.tokenErrors,u=p.accessDenied,m=p.sessionEnded;class g{constructor(e,t,s){this._shellTokenManager=e,this._extensions=t,this._postBootCache=s,this.createAuthTokenCache=MsPortalFx.memoize((e=>{const t=a.createAuthTokenCache((t=>this.getSecurityToken({...t,extensionName:e,resourceName:t.resourceName||"",skipCache:t.skipCache})));return{getToken:s=>{const i=s&&s.resourceName;return this._shellTokenManager.portalAuthHandlerPromise.then((o=>null!==o?this._postBootCache.get(e).then((({extensionEnvironment:o})=>{try{o="string"==typeof o?JSON.parse(o):o}catch(e){d.warning(new MsPortalFx.Errors.Error({message:"Unable to parse the extensionEnvironment configuration. Error: "+MsPortalFx.getLogFriendlyMessage(e),innerErrors:e})),o=null}let r="",a="";const l=o?.authorization,c=n.getExtensionDefinedResourceAccessInfo({resourceName:i,extensionName:e,authorization:l});return c&&(r=c.resource,a=c.useInfrastructureTenant?FxImpl.internalEnv.fxAadInfrastructureTenantId:""),t.getToken({...s,audience:r,tenantId:a})})):t.getToken(s)))}}}))}getSecurityToken(e){const{extensionName:t,resourceName:s,skipCache:i,wwwAuthHeader:o,requestedScopes:n}=e,r=this._extensions[t]??{},a=r.flags,l=this._shellTokenManager.shellTokenCache,d=!!(16&a);if(s&&d)return Promise.resolve({error:u});if(this._shellTokenManager.isSessionEnded())return Promise.resolve({error:m});const p=!s,g="telemetrytoken"===s.toLowerCase(),h=s.toLowerCase()===FxImpl.nonCaeArmAliasLowerCase;if(l&&(p||g||h)&&!i&&!e.tenantId)return l.getToken({resourceName:s,wwwAuthHeader:o,isThirdPartyExtension:d,requestedScopes:n}).then((e=>({token:e})));const f=c.start({source:"ExtensionTokensManager",action:"GetToken",name:e.extensionName}),x=this._shellTokenManager.getToken({...e,extensionIsSideloaded:r.isSideloaded,isThirdPartyExtension:d});return x.then((e=>{c.endTrace(f,!!e.token,{resourceName:s,requestedScopes:n})})),x}async getPopToken(e){const t=await this._shellTokenManager.getPopToken(e);return{header:t.authHeader,expiresAt:t.expiresAt}}async getSshCertToken(e){const t=await MsPortalEarly.extensionAuthMetadataInPortalConfig||{};let s;try{s=t[e.extensionName.toLowerCase()].oAuthClientId}catch(e){return Promise.reject(`Failed to get extensionClientId. Error: ${e}`)}const i=await this._shellTokenManager.getSshCertToken({...e,extensionClientId:s});return i?.token?.header?{header:i.token.header,expiresAt:i.token.expiresAt}:i.error||i.errorMessage?Promise.reject(`Failed to fetch token. Status: ${i.error}, Message: ${i.errorMessage}`):Promise.reject("Unknown error resulting in an empty token header.")}static create(e,t,s){return new g(e,FxImpl.mapValues(t.extensionsAsMap,(e=>({flags:e.flags,isSideloaded:e.isSideloaded}))),s)}}t.ExtensionTokensManager=g,__decorate([__metadata("fx:diagnostics",[e,"ExtensionTokensManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.SecurityTokensManager,i.ExtensionManagerOptions,i.PostBootCache]),__metadata("design:returntype",g)],g,"create",null)})),
define("MsPortalImpl/UI/Compositions/UI.Composition.Graph",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition"],(function(e,t,s,i,o){"use strict";t.CompositionGraph=void 0;let n=t.CompositionGraph=class{constructor(){this._entries=new Map,this._idIndex=new Map}getStartBoard(){return this._startBoard}find(e){return this._idIndex.get(e)}findBlades(e,t,s){let n=[];if(e instanceof i.Locator)this._entries.forEach(((t,s)=>{s.getCompositionType()===o.CompositionType.Blade&&s.locator.equals(e)&&n.push(s)}));else if(e){const t=this._entries.get(e);n=t?.opened.slice()||[]}else{if(s||t)throw new Error("Criteria is null or undefined.  Searching for the help blade or a docked blade requires a locator or parent composition");if(this._startBoard){const e=this._entries.get(this._startBoard);let t=e?.opened[0];for(;t;){n.push(t);const e=this._entries.get(t);t=e?.opened[0]}}}return n.filter((e=>!(256&e.flags)&&512&(s?e.flags:~e.flags)&&32&(t?e.flags:~e.flags)))}getParentBlade(e){const t=this._entries.get(e);return t?.openedBy?.parent?.parent}setStartBoard(e){if(!this._entries.has(e)){const t={instance:e,opened:[]};this._addEntry(t),this._startBoard=e}}addBlade(e,t){let s=this._entries.get(e);if(s||(s={instance:e,openedBy:t,opened:[]},this._addEntry(s)),t.getCompositionType()===o.CompositionType.Part||t.getCompositionType()===o.CompositionType.StartboardPart){const s=this._entries.get(t);s&&s.opened.push(e)}let i=t.getCompositionType()===o.CompositionType.StartboardPart||t.getCompositionType()===o.CompositionType.Part?t.parent:t;i&&i.getCompositionType()===o.CompositionType.Lens&&(i=i.parent),i&&(s=this._entries.get(i),s||(s={instance:i,opened:[]},this._addEntry(s)),s.opened.push(e),s.instance.getCompositionType()===o.CompositionType.Blade&&s.instance.onDetailContainersChanged())}addPart(e){let t=this._entries.get(e);t||(t={instance:e,opened:[]},this._addEntry(t)),e.registerForDispose((()=>this.removePart(e)))}removeBlade(e,t=!0){this.findBlades(e,!!(32&e.flags),!!(512&e.flags)).forEach((e=>this.removeBlade(e,!1))),this._deleteEntry(e),this._entries.forEach((s=>{if(MsPortalFx.remove(s.opened,e).length&&t){const e=s.instance.getCompositionType()===o.CompositionType.Blade&&s.instance;e&&!e.isDisposed()&&e.onDetailContainersChanged()}}))}removeAllBlades(e){const t=this._entries.get(e);if(t){t.opened.slice().forEach((e=>{32&~e.flags&&512&~e.flags&&this.removeBlade(e)}))}}removePart(e){this._deleteEntry(e)}_addEntry(e){this._entries.set(e.instance,e),this._idIndex.set(e.instance.id,e.instance)}_deleteEntry(e){this._entries.delete(e),this._idIndex.delete(e.id)}};t.CompositionGraph=n=__decorate([__metadata("fx:diagnostics",[e,"CompositionGraph"]),s.Class()],n)})),
define("MsPortalImpl/UI/Compositions/UI.Composition.Finder",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Graph"],(function(e,t,s,i,o){"use strict";t.Finder=void 0;let n=t.Finder=class{constructor(e){this._graph=e}find(e){return this._graph.find(e)}findPart(e,t){let s=MsPortalFx.find(t.children,(t=>t.id===e));if(!s)for(const i of t.children)if(s=MsPortalFx.find(i.children,(t=>t.id===e)),s)break;return s}findBlades(e=null,t=!1,s=!1){return this._graph.findBlades(e,t,s)}findSiblingBlades(e,t=!1,s=!1){return this._graph.findBlades(this.findPartsContainer(e),t,s)}findPartsContainer(e){if(!e)return this._graph.getStartBoard();for(;e&&!r(e);)e=e.parent;return e}findParentMenuBlade(e){if(16&e.flags)for(let t=e;t;t=this._graph.getParentBlade(t)){const e=t?.bladeDefinition;if(e?.menuBlade||e?.tabMenuBlade)return t}else{const t=this._graph.getParentBlade(e),s=t?.bladeDefinition;if(s?.menuBlade||s?.tabMenuBlade)return t}return null}};function r(e){return e.getCompositionType()===i.CompositionType.Startboard||e.getCompositionType()===i.CompositionType.Blade}t.Finder=n=__decorate([__metadata("fx:diagnostics",[e,"Finder"]),s.Class(),__metadata("design:paramtypes",[o.CompositionGraph])],n)})),
define("MsPortalImpl/ReactViews/ShellReactQueries",["require","exports","MsPortalImpl/ReactViews/ReactQueryStore","FxInternal/Experimentation","MsPortalImpl/Services/Services.ExtensionTokensManager","FxInternal/RpcEndPointsCore","MsPortalImpl/UI/Compositions/UI.Composition.Finder"],(function(e,t,s,i,o,n,r){"use strict";t.selectedSubscriptionsQuery=t.resourceGroupsQuery=t.provisioningContextQuery=t.locationsForCreateQuery=t.locationDisplayNamesQuery=t.initialDropdownValuesQuery=t.globalSubscriptionsQuery=t.globalResourceFilterNameQuery=t.extensionExperimentationAssignmentsQuery=t.experimentationShellAssignmentsQuery=t.essentialsResourceInfoQuery=t.authTokenQuery=void 0,t.stubProvisioningContext=c,t.subscriptionQuery=void 0;t.authTokenQuery=(0,s.registerQuery)({name:"Shell::AuthToken",cacheOptions:{scope:"session",staleAfter:e=>e?.expiresAt?e.expiresAt-6e5:0,expires:e=>Math.max(e?.expiresAt?e.expiresAt-3e5:0,Date.now()+1e4)},getArgsKey:(e,t,s)=>JSON.stringify([{resourceName:"",...s,isBackground:void 0}]),query:(e,t,s)=>e.get(o.ExtensionTokensManager).createAuthTokenCache(t).getToken({resourceName:"",...s})}),t.essentialsResourceInfoQuery=(0,s.registerQuery)({name:"Shell::EssentialsResourceInfo",cacheOptions:{scope:"view"},getArgsKey:(e,t,s)=>JSON.stringify([t,s]),query:async(e,t,s)=>{const i=await MsPortalFx.require("FxInternal/Controls/Essentials");return await i.getEssentialsResourceInfo(e,t,s).then((e=>({...e,resourceId:t})))}}),t.experimentationShellAssignmentsQuery=(0,s.registerQuery)({name:"Shell::ExperimentationShellAssignments",cacheOptions:{scope:"session",staleAfter:Number.MAX_SAFE_INTEGER},getArgsKey:()=>"[]",query:async e=>{const t=await e.get(i.ExperimentationManager).shellAssignments.whenAvailable();return t?t.data:{flights:[],assignmentContext:null,variables:{}}}}),t.extensionExperimentationAssignmentsQuery=(0,s.registerQuery)({name:"Shell::ExtensionExperimentationAssignments",cacheOptions:{scope:"session",staleAfter:Number.MAX_SAFE_INTEGER},getArgsKey:(e,t)=>JSON.stringify([t]),query:async(e,t)=>n.getVariantAssignmentsForExtension.invoke(e.get(FxImpl.Rpc.Client),"fxw",t)}),t.globalResourceFilterNameQuery=(0,s.registerQuery)({name:"Shell::GlobalResourceFilterName",cacheOptions:{scope:"session",staleAfter:Number.MAX_SAFE_INTEGER},getArgsKey:()=>"[]",query:async e=>{const t=await MsPortalFx.require("MsPortalImpl/Services/Services.Subscriptions"),s=e.get(t.SubscriptionsUserContext);if(await s.useAdvancedFiltersPromise){const t=await MsPortalFx.require("MsPortalImpl/Services/Services.GlobalResourceFilters"),s=await e.getAsync(t.ResourceFilterManager);return s.currentFilterObservable()?.name??""}return""}});const a=t.globalSubscriptionsQuery=(0,s.registerQuery)({name:"Shell::GlobalSubscriptions",cacheOptions:{scope:"session",staleAfter:Number.MAX_SAFE_INTEGER},getArgsKey:()=>"[]",query:async e=>{const t=await MsPortalFx.require("MsPortalImpl/Services/Services.Subscriptions");return e.get(t.SubscriptionsUserContext).getInSessionDisplayedSubscriptions().then((e=>e.subscriptions))}}),l=(t.selectedSubscriptionsQuery=(0,s.registerQuery)({name:"Shell::SelectedSubscriptions",cacheOptions:{scope:"session",staleAfter:Number.MAX_SAFE_INTEGER},getArgsKey:()=>"[]",query:async e=>MsPortalFx.require("MsPortalImpl/Services/Services.Subscriptions").then((t=>e.get(t.SubscriptionsUserContext).getInSessionSelectedSubscriptions().then((e=>e()))))}),t.subscriptionQuery=(0,s.registerQuery)({name:"Shell::Subscription",cacheOptions:{scope:"session",staleAfter:Number.MAX_SAFE_INTEGER},getArgsKey:(e,t)=>JSON.stringify([t]),query:async(e,t)=>MsPortalFx.require("MsPortalImpl/Services/Services.Subscriptions").then((s=>e.get(s.SubscriptionsUserContext).getSubscription(t)))}),t.initialDropdownValuesQuery=(0,s.registerQuery)({name:"Shell::InitialDropdownValues",cacheOptions:{scope:"session"},getArgsKey:()=>"[]",query:async(e,t)=>Promise.all([MsPortalFx.require("MsPortalImpl/Services/Services.ProvisioningInitialValues"),a.bind(t,e).get()]).then((([t,s])=>t.determineInitialValues(e,s)))}));t.locationDisplayNamesQuery=(0,s.registerQuery)({name:"Shell::LocationDisplayNames",cacheOptions:{scope:"session",staleAfter:Number.MAX_SAFE_INTEGER},query:async()=>FxImpl.memoizePromise((()=>MsPortalFx.Azure.getLocations()))()}),t.locationsForCreateQuery=(0,s.registerQuery)({name:"Shell::LocationsForCreate",cacheOptions:{scope:"view"},getArgsKey:({subscriptionId:e,resourceTypes:t})=>JSON.stringify([e,t?.sort().join(",")]),query:async e=>FxImpl.Azure.getLocationsForCreate(FxImpl.Rpc.client,e)}),t.resourceGroupsQuery=(0,s.registerQuery)({name:"Shell::ResourceGroups",cacheOptions:{scope:"view"},query:async e=>MsPortalFx.require("FxInternal/ResourceManagement/ResourceGroups").then((t=>t.getArmResourceGroups(e)))}),t.provisioningContextQuery=(0,s.registerQuery)({name:"Shell::ProvisioningContext",cacheOptions:{scope:"view"},getArgsKey:(e,t,s,i)=>""+(i?"true":"false"),query:async(e,t,s,i)=>{if(i){const i=c(await l.bind(t,e,t).get()),o=s&&e.get(r.Finder).find(s);return i.marketplaceItem.launchingContext={...i.marketplaceItem.launchingContext,source:[...o?[o.locator.name,o.toString()]:[],...s?[s]:[]]},i}}});function c(e){const t=MsPortalFx.getUniqueId();return{initialValues:e,referenceType:{extensionName:void 0,marketplaceId:void 0,assetType:void 0,assetKind:void 0},marketplaceItem:{categoryIds:[],id:"Microsoft.Portal",itemDisplayName:"NoMarketplace",products:[],version:"",productsWithNoPricing:[],publisherDisplayName:"Microsoft.Portal",deploymentName:"NoMarketplace",launchingContext:{telemetryId:t,source:[],galleryItemId:""},deploymentTemplateFileUris:{},uiMetadata:null},telemetryId:t,provisioningConfig:void 0}}})),
define("MsPortalImpl/Base/Base.ItemCache",["require","exports"],(function(e,t){"use strict";t.ItemArrayCache=t.BaseItemCache=void 0,t.rotAdd=function(e,t){const s=(d++).toString();return c.set(s,t),e.registerForDispose((()=>{c.delete(s)})),s},t.rotFind=function(e){return c.get(e)};const s=MsPortalFx.remove,i=MsPortalFx.find,o=MsPortalFx.findIndex,n=Date.now;function r(e){return t=>e(t.item)}function a(e){return n()-e}function l(e,t){let s;return e&&(t&&(e.age=n()),s=e.item),s}t.BaseItemCache=class{constructor(e=12e4,t){this._map=t,this._maxAge=e,setTimeout((()=>this._reduceCache()),1e3)}dispose(){this.flush()}hasEntry(e){return e in this._map}getEntry(e){return l(this._map[e],!0)}peekEntry(e){return l(this._map[e])}removeEntry(e){e in this._map&&this._delete(e)}_removeEach(e){for(const t in this._map)e.call(this,t)&&this._delete(t)}removeEach(e){this._removeEach(e)}flush(){this._removeEach()}_delete(e){delete this._map[e]}_isExpired(e){return a(this._map[e].age)>this._maxAge}_reduceCache(){this._removeEach(this._isExpired)}};t.ItemArrayCache=class{constructor(e=12e4){this._cache=[],this._maxAge=e,setTimeout((()=>this._reduceCache()),1e3)}dispose(){this.clear()}first(e,t){return l(i(this._cache,r(e)),!t)}peekFirst(e){return this.first(e,!0)}pushEntry(e){this._cache.push(function(e){return{age:n(),item:e}}(e))}removeEntry(e){this.removeFirst((t=>MsPortalFx.deepEquals(t,e)))}removeFirst(e){const t=o(this._cache,r(e));t>=0&&this._cache.splice(t,1)}removeEach(e){s(this._cache,r(e))}clear(){this._cache=[]}_isEntryExpired(e){return a(e.age)>this._maxAge}_reduceCache(){s(this._cache,(e=>this._isEntryExpired(e)))}};const c=new Map;let d=1})),
define("MsPortalImpl/Extension/ExtensionRpc.Manifest",["require","exports","FxInternal/AsyncLoader","MsPortalImpl/Extension/Extension.Manifest"],(function(e,t,s,i){"use strict";t.getAllExtensionFeatures=async function(e){if(!e)return{};const t={},s=e.get(i.ManifestCache),o=s.getHostOverride();return await s.getManifests("extensionConfiguration",((e,s)=>{if(!s?.extensionConfiguration)return;const i=r(s,o)?.features;if(i){const s=[];Object.keys(i).forEach((e=>{const t={};t[e]=i[e],s.push(t)}));const o=new FxImpl.Features(FxImpl.features.shellFeatures,e,s);t[e]=o}})),t},t.getExtensionConfiguration=n,t.getManifestHandler=t.getManifestEnvironmentHandler=void 0,t.processExtensionConfiguration=r;const o=window;t.getManifestHandler=s.defineHandler(FxImpl.Extension.getManifestEndPoint,(e=>{const t=function(e){switch(e){case"createUiDefinition":case"viewDefinition":case"declarativeDefinitions":return"uiDefinition";case"flags":return"assetTypes";default:return null}}(e.messageArg.propertyName);if(t)return e.diContainer.get(i.ManifestCache).getManifestAsync(e.messageArg.extensionName,t).then((t=>t[e.messageArg.propertyName])).then((e=>e&&"object"==typeof e?Array.isArray(e)?e.slice():{...e}:e))})),t.getManifestEnvironmentHandler=s.defineHandler(FxImpl.Extension.CreateUiDef.getExtensionConfigurationEndPoint,(e=>n(e.diContainer,e.messageArg.extensionName)));function n(e,t){const s=e.get(i.ManifestCache),o=s.getHostOverride();return s.getManifestAsync(t,"extensionConfiguration").then((e=>r(e,o)))}function r(e,t){const s=e.extensionConfiguration||{},i=o.location.hostname,n=s[s[t]&&t||s[i]&&i||MsPortalFx.find(Object.keys(s),(e=>i.endsWith(e)))||"*"];return MsPortalFx.clone(n,!1)}})),
define("MsPortalImpl/Services/Services.BrowseCuration",["require","exports","FxHubs/RpcEndPoints","MsPortalImpl/Resources/ImplScriptResources","FxInternal/AsyncLoaderCore","Fx","Fx/Experimentation","MsPortalImpl/Extension/ExtensionRpc.Manifest"],(function(e,t,s,i,o,n,r,a){"use strict";t.getAllServicesAdditionalData=t.browseCurationFile=t.Impl=t.DEV=t.BrowseCurationStringConstants=void 0,t.getBrowseCuration=S,t.getMergedAssetType=function(e,t,s){const i=Array.isArray(t)?t:[t];return{base:e,associated:i,infoTextOverride:s}},t.getSharedCuration=t.getResourceTypesCategorizationForTest=t.getResourceTypesCategorizationEndPoint=void 0,t.handleInvalidCurationFileError=w,t.initializeRpc=function(){l.Curation.getSharedCurationEndpoint.register(d.client,["HubsExtension","fx"],(()=>I()))},t.isHubEnabled=M,t.mapCategoryIdToName=T,t.testReset=t.resetMapResourceTypeToCategoryResourceName=void 0;var l=s,c=MsPortalFx.Base,d=FxImpl.Rpc,p=MsPortalFx.Hubs.Notifications;const u=window.fx.environment,m=c.Diagnostics.createLog(e),g=/^[a-z_][\w\-]*$/i,h=i.BrowseCuration,f=i.BrowseCategories,x=MsPortalFx.lowerCaseAllStrings;var b;function y(e){if(!e||g.test(e))return e;m.warning(`Invalid curation file name: <${e}>, skipping this curation file.`)}!function(e){e.ServiceHubExperimentFormat="servicehub-{0}-{1}",e.ServiceHubExtensionFeatureFormat="servicehub-{0}"}(b||(t.BrowseCurationStringConstants=b={}));const v=t.browseCurationFile=y((0,n.getFeatureValue)("browsecuration"))||y(u.browseCuration)||"default";t.getAllServicesAdditionalData=(0,n.memoizePromise)((()=>MsPortalFx.require("MsPortalImpl/Services/BrowseCuration/AllServicesCardData").then((e=>e.getAdditionalAssetTypeAndCategoryData())).catch((e=>{let t="Failed to get the additional data file";return e&&e.statusText?t+=`: ${e.status||""} (${e.statusText})`:e&&e.message&&(t+=`: ${e.message}`),m.warning(t),{}}))));function w(e){let t=`Failed to get the browse curation file <${v}>`;e&&e.statusText?t+=`: ${e.status||""} (${e.statusText})`:e&&e.message&&(t+=`: ${e.message}`),m.warning(t),p.ClientNotification.publish({title:h.noCurationTitle,description:h.noCuration,status:p.NotificationStatus.Warning})}function M(e,t,s){if(!e?.extensionName||!e?.serviceMenuId)return{isEnabled:!1,reason:"MissingHubInfo"};const{extensionName:i,serviceMenuId:o}=e,n=s?.[i],r=b.ServiceHubExtensionFeatureFormat.format(o.toLowerCase()),a="true"===n?.getValue?.(r),l=n?.isEnabled?.(r);if(a||l)return{isEnabled:!0,reason:"ViaFeature"};const c=b.ServiceHubExperimentFormat.format(i,o);return t.getBooleanValue(c,"azureportal")?{isEnabled:!0,reason:"ViaExp"}:{isEnabled:!1,reason:"NoExpOrFeature"}}var C;function S(e){return C.getBrowseCuration(e)}!function(e){e.getBrowseCuration=async e=>{const t=await MsPortalFx.require(`MsPortalImpl/Services/BrowseCuration/${v}`);try{const[s,i]=await Promise.all([t.getCuration(e),(0,a.getAllExtensionFeatures)(e?.diContainer)]);return e?.getRawCuration?s:async function(e,t,s){if(!s?.applyServiceHubVisibility||!s?.diContainer){const t=e.categories.map((e=>({...e,items:e.items.filter((e=>!e.expToShow)),serviceHubs:[]})));return{...e,categories:t}}const i=s.diContainer.get(r.Experimentation).shellAssignments,o=e.categories.map((e=>({...e,items:e.items.filter((e=>e.expToHide?!M({extensionName:e.expToHide.split("::")[0],serviceMenuId:e.expToHide.split("::")[1]},i,t).isEnabled:!e.expToShow||M({extensionName:e.expToShow.split("::")[0],serviceMenuId:e.expToShow.split("::")[1]},i,t).isEnabled)),serviceHubs:e.serviceHubs?.filter((e=>M(e,i,t).isEnabled))||[]})));return{...e,categories:o}}(s,i,e)}catch(e){return w(e),{}}}}(C||(t.Impl=C={}));const I=t.getSharedCuration=(0,n.memoizePromise)((()=>S().then((e=>({mergedAssetTypes:x(e&&e.mergedAssetTypes)})))));t.testReset=MsPortalFx.noop;const P={},_={};const F=/(^|[^A-Za-z0-9]*)([A-Za-z0-9]+)/g;function T(e){return f[(t=e,t.replace(F,((e,t,s)=>s&&(s||"").toLowerCase())))]||e;var t}t.getResourceTypesCategorizationEndPoint=(0,o.defineHandler)(l.Curation.getResourceTypesCategorizationEndPoint,(()=>async function(){if(MsPortalFx.isEmptyObject(_)){const e=await s.AssetTypes.getAssetTypesInformationEndPoint.invoke(d.client,"fxw",void 0);(await S()).categories.forEach((e=>e.items.forEach((t=>{const s=FxImpl.Assets.getAssetTypeOrResourceTypeId(t.extensionName?.toLowerCase(),t.assetType?.toLowerCase());P[s]={categoryId:e.id||"uncurated",categoryDisplayName:T(e.id)}})))),e.forEach((e=>{const t=FxImpl.Assets.getAssetTypeOrResourceTypeId(e.extensionName?.toLowerCase(),e.assetType?.toLowerCase()),s=P[t],i=e.compositeDisplayName?.service||e.compositeDisplayName?.plural;i&&(_[e.lowerCaseResourceType]={categoryId:s?.categoryId||"uncurated",categoryDisplayName:s?.categoryDisplayName||f.uncurated,assetDisplayName:i,lowerCaseResourceType:e.lowerCaseResourceType,assetTypeIcon:e.icon,assetTypeKeywords:e.keywords})}))}return _}()))})),
define("MsPortalImpl/Services/Services.AssetTypes",["require","exports","Fx/DependencyInjection","Fx/Ajax","Fx/ResourceManagement","FxHubs/ResourceManagement","FxHubs/ArmClient","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.ArmIdHelpers","MsPortalImpl/Base/Base.ItemCache","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Extension/Extension.Manifest","FxHubs/ArtHelpers/ArgBrowseHelpers","MsPortalImpl/Services/Services.Settings","FxInternal/Features","ShellWorker/AssetTypeRequirements","MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers","Fx","FxInternal","MsPortalImpl/Notifications/NotificationsClientStrings","MsPortalImpl/Services/Services.BrowseCuration","FxInternal/AsyncLoader","Fx/Experimentation"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x,b,y,v,w,M,C,S,I){"use strict";t.Internal=t.Impl=t.AssetTypeService=void 0,t.assetTypeMeetsRequirements=ge,t.assetTypesMemo=function(e){return ve.assetTypesMemo(e)},t.assetTypesWithVariantsMemo=function(e){return ve.assetTypesWithVariantsMemo(e)},t.compareAssetId=function(e,t){const s=o.ArmId.parse(e,!0),i=o.ArmId.parse(t,!0);0!==s.kind&&0!==i.kind&&ne(e,t);return MsPortalFx.deepEquals(e,t)},t.createViewModelDisposedError=xe,t.featureCardsMemo=t.failedToFindAssetTypePrefix=void 0,t.getAssetId=function(e,t,s){t===F.BrowseResourceGroupBlade&&(t=F.ResourceGroups);return R.getAssetTypeOrResourceTypeIdByWindowId(e,t)+(s?"."+s.toLowerCase():"")},t.getBrowseAllDeeplink=Fe,t.getBrowseBladeReference=Ee,t.getBrowseBladeUri=ke,t.lowerCaseResourcesWithTagType=t.lowerCaseResourceGroupsType=t.lowerCaseResourceGroupsId=t.lowerCaseAllResourcesType=t.lowerCaseAllResourcesId=void 0,t.provideCategoryName=function(e){let t;return se.some((s=>(t=s.provideCategoryName(e),!!t))),t||e},t.provideSubCategoryName=function(e){let t;return se.some((s=>(t=s.provideSubCategoryName(e),!!t))),t||e},t.registerStringProvider=ie;var P=MsPortalFx.Base,_=P.Constants,F=_.AssetNames,T=F.NonAssetResource,k=_.ResourceTypes,E=_.BladeNames.Hubs,D=E.ResourceMenuBlade,A=E.UnavailableAssetBlade,B=MsPortalFx.Extension,N=(B.BrowseType,P.Images),R=FxImpl.Assets,L=B.ResourceRoutingType,z=MsPortalFx.Errors,H=MsPortalFx.Helpers,O=MsPortalFx.Hubs.Notifications.NotificationStatus;const U=window.fx.environment,W=P.Diagnostics.createLog(e),V=N.Polychromatic.ResourceDefault(),q={image:N.Polychromatic.Preview(),width:40},$={icon:V,previewIcon:V,bladeName:D,bladeExtension:"HubsExtension"},j="BrowseRecentResources.ReactView";let G=e=>W.warning(e);const K="Timeout trying to load extension manifest",J=MsPortalFx.remove,X=P.Diagnostics.createIgnoreUnhandledRejectionError,Z=R.getAssetTypeOrResourceTypeId,Y=P.Images.Polychromatic.ResourceDefault(),ee=a.BrowseCuration.Description,te={},se=(t.failedToFindAssetTypePrefix="Could not find the asset type",[]);function ie(e){se.push(e)}function oe(e){return(e||"").toLowerCase()}function ne(e,t){return e===t||oe(e)===oe(t)}const re=/(^|[^A-Za-z0-9]*)([A-Za-z0-9]+)/g;function ae(e){return e.replace(re,((e,t,s)=>s&&oe(s)))}const le=/^https?:\/\//i;function ce(e){const t=e.text||e.name,s=e.pluralDisplayName||t;return{plural:s,singular:e.singularDisplayName||t,lowerPlural:e.lowerPluralDisplayName||t,lowerSingular:e.lowerSingularDisplayName||t,service:e.serviceDisplayName||s}}function de(e){return{plural:e.pluralDisplayName,singular:e.singularDisplayName,lowerPlural:e.lowerPluralDisplayName,lowerSingular:e.lowerSingularDisplayName,service:e.serviceDisplayName}}function pe(e,t,s){let i;return se.some((o=>(i=o.provideAssetTypeKeywords(e,t,s),!!i))),i}function ue(e){const t=e.resourceType;return t&&oe(t.resourceTypeName)}function me(e,t,s=null,i=null,o=null){if(!e)return{icon:P.Images.Polychromatic.ResourceDefault(),selection:FxImpl.ViewModels.getBladeSelection("HubsExtension",D,{id:t})};const n=e.assetTypeManifest;i=i||n.bladeExtensionName||e.extension,(s=s||n.bladeName)||(s=n.resourceType?D:A,i="HubsExtension");return{icon:o||e.icon,selection:FxImpl.ViewModels.getBladeSelection(i,s,{id:t}),isPreview:e.isPreview}}function ge(e,t){const s=e.assetTypeManifest;return(0,b.assetTypeMeetsRequirements)({browseType:s?.browseType,browseLinkUri:s?.browseLinkUri,resourceType:s?.resourceType?.resourceTypeName},t)}function he(e,t,s){return X(`Asset type does not specify a resource type. Extension <${t}> : AssetType <${s}> : ${e}`)}function fe(e){return X(`Resource ID <${(0,l.sanitizeId)(e)}> is not a subscription ID, resource group ID or resource ID.`)}function xe(e,t,s){return new Error(`The ${e} view model was already disposed. Extension <${t}> : ViewModel <${"string"==typeof s?s:s.name}>`)}function be(e,t,s){const i=MsPortalFx.makeArray(t);if(i.length){const t=e.length+i.length-s;t>0&&e.splice(0,t),e.push(...i)}}function ye(e,t){return MsPortalFx.find(e,t,-1)}var ve;ie({provideCategoryName:e=>(0,C.mapCategoryIdToName)(e),provideSubCategoryName:e=>a.BrowseSubCategories[ae(e)]||e,provideAssetTypeKeywords:(e,t,s)=>{const i=a.AssetTypeKeywords[function(e,t,s){return ae(e+" "+t+s||(s?" "+s:""))}(e,t,s)];return i?i.split(","):[]}}),function(e){e.assetTypesMemo=(0,v.memoizePromise)((e=>e.assetTypesComplete.then((()=>e.assetTypes.map((t=>e.mapAssetTypeToResourceTypeAssetTypeInformation(t))))))),e.assetTypesWithVariantsMemo=(0,v.memoizePromise)((e=>e.assetTypesComplete.then((()=>e.assetTypes.map((t=>e.mapAssetTypeToResourceTypeAssetTypeInformation(t,!0)))))))}(ve||(t.Impl=ve={}));t.featureCardsMemo=(0,v.memoizePromise)((e=>e.assetTypesComplete.then((()=>e.featureCardMap))));const we=t.Internal={};function Me(e){let t=3;return(e.privateBrowse||(0,n.supportsAnyOption)(e.options,3))&&(t-=2),(e.isPreview||e.isDisabled)&&(t-=1),t}const Ce=t.lowerCaseAllResourcesId="hubsextension_browseallresources",Se=t.lowerCaseAllResourcesType="microsoft.resources/resources",Ie=t.lowerCaseResourceGroupsId="hubsextension_resourcegroups",Pe=t.lowerCaseResourceGroupsType="microsoft.resources/subscriptions/resourcegroups",_e=t.lowerCaseResourcesWithTagType="microsoft.resources/resourceswithtag";function Fe(){return(0,v.isFeatureEnabled)("artbrowse")?"#blade/HubsExtension/BrowseAll":"#blade/HubsExtension/BrowseAllResourcesBlade/resourceType/Microsoft.Resources%2Fresources"}const Te={};function ke(e,t,s,i,o,r,a){if(t===Ce)return Promise.resolve(Fe());if(t===Ie)return Promise.resolve((0,v.isFeatureEnabled)("artbrowse")?"#blade/HubsExtension/BrowseResourceGroups":"#blade/HubsExtension/BrowseResourceGroupBlade/resourceType/Microsoft.Resources%2Fsubscriptions%2FresourceGroups");const l=i?.assetTypeManifest;if(l?.resourceType){if(!a&&l.browseDeepLink)return Promise.resolve(l.browseDeepLink);const i=(0,n.supportsContract)(l.contracts,16384),c=!(0,n.supportsContract)(l.contracts,2)&&(l.resourceType.routingType||L.Default)===L.Default;let d=l.argBrowseOption;const p=!!d,u=(e.get(I.Experimentation).shellAssignments.getStringValue("forcedisableargtypes")||"").split(",").map((e=>e.trim())),m=!p&&(i||(l.resourceType.routingType||L.Default)===L.Default)&&!u.includes(l.resourceType.resourceTypeName);if(m&&(d=3),(i||c||p||m)&&(0,v.isFeatureEnabled)("artbrowse")&&4!==d){let n=s;const a=()=>{if(t===Ie){n=`#blade/HubsExtension/${r?"ARGBrowseResourceGroupsInMenu":"BrowseResourceGroups"}`}else{n=`#blade/HubsExtension/${r?"ARGBrowseResourcesInMenu":"BrowseResource"}/resourceType/${encodeURIComponent(l.resourceType.resourceTypeName)}`,o&&(n=n+"/kind/"+encodeURIComponent(o))}};if(3===d)return a(),Promise.resolve(n);if(h.canOptIn(d,{resourceType:l.resourceType?.resourceTypeName,contracts:l.contracts,browseType:l.browseType})){return e.get(f.SettingsManager).querySetting(15,"argBrowsePreference").then((e=>{const s=e?.[t],o=!i&&c&&void 0===d?3:d;return(!0===s||void 0===s&&[2,3].includes(o))&&(a(),Te[t]!==s&&(Te[t]=s,P.Diagnostics.Telemetry.trace({source:"Shell",action:"ArgBrowseOption",name:t,data:{setting:s,argBrowseOption:o}}))),n}))}}}return Promise.resolve(s)}async function Ee(e,t){const{resourceType:s,kind:i,inMenu:o,ignoreDeepLink:n}=t,r=(s||"").toLowerCase();if(r===Se)return Promise.resolve(function(e){return e?(0,v.isFeatureEnabled)("artbrowse")?{blade:"ARGBrowseAllInMenu",extension:"HubsExtension"}:{blade:"BrowseAllInMenu",extension:"HubsExtension",parameters:{resourceType:Se}}:(0,v.isFeatureEnabled)("artbrowse")?{blade:"BrowseAll",extension:"HubsExtension"}:{blade:"BrowseAllResourcesBlade",extension:"HubsExtension",parameters:{resourceType:Se}}}(o));if(r===Pe)return Promise.resolve(function(e){return e?(0,v.isFeatureEnabled)("artbrowse")?{blade:"ARGBrowseResourceGroupsInMenu",extension:"HubsExtension"}:{blade:"BrowseGroupsInMenu",extension:"HubsExtension",parameters:{resourceType:Pe}}:(0,v.isFeatureEnabled)("artbrowse")?{blade:"BrowseResourceGroups",extension:"HubsExtension"}:{blade:"BrowseResourceGroupBlade",extension:"HubsExtension",parameters:{resourceType:Pe}}}(o));const a=e.get(Ae);return w.tryImmediateResolve(a.assetTypesComplete,(async()=>{const t=a.getAssetTypeByResourceType(s);if(!t)return null;const r=await ke(e,t.id.toLowerCase(),null,t,i,o,n)||a.getAssetTypeDeepLink(t,i,o,n);if(!r||"string"!=typeof r||!r.startsWith("#blade/")&&!r.startsWith("#view/"))return null;const l=r.split("?")[0].split("/");let c="";if(!l.length||l.length<3)return null;l.length>3&&"~"===l[3]&&l.splice(3,1),l.length%2!=1&&(c=l[l.length-1],l.pop());const d=l[1].trim(),p=l[2].trim(),u={};for(let e=3;e<l.length;e+=2)u[l[e]]=decodeURIComponent(l[e+1]);return c&&(u.menuid=c),{blade:p,extension:d,parameters:u}}))}let De=class{constructor(e,t,s,i,n,r){this._diContainer=e,this._viewModelManager=t,this._manifestCache=s,this._redirectMap=i,this.assetTypes=[],this.featureCardMap=FxImpl.lowerCaseStringMap(),this._resourceTypeMap={},this._assetTypeByIdBrowseLink={},this._assetTypeByResourceTypePromises=[],this._selectionFromResourceIdPromises=[],this._bladeInfoPromises=[],this._memoizedManifestsLoadedError=MsPortalFx.memoize((e=>X(e))),this._serviceMenuEnabled=n.isEnabled("servicemenu"),this._lifetimeManager=new FxImpl.TriggerableLifetimeManager,this._cachedUser=r.getCurrentUser(),n.isEnabled("policyforrestypes")?(this._policyForResourceTypesPromise=w.tryImmediateResolve(Q((0,f.readUserSettings)(this._diContainer.get(f.SettingsManager),["resourceTypeRestrictions"])),(e=>{try{const t=e?.resourceTypeRestrictions;return t&&JSON.parse(t)}catch(e){return void W.warning(new z.Error({message:"Failed to deserialize resource type restrictions from user settings",innerErrors:[e]}))}})),w.tryImmediateResolve(Q((0,y.lazyUserDataMemo)(this._diContainer)),(e=>{w.tryImmediateResolve(Q(this._policyForResourceTypesPromise),(async t=>{const s=(e,t)=>(t=t||[],(e=e||[]).length===t.length&&e.every((e=>t.some((t=>t?.toLowerCase()===e?.toLowerCase())))));let i,n=!0,r=e.policyForResourceTypes;if(r){const e=async()=>{const e=await this._getPolicyForResourceTypes();return!e.ignore&&(r={deny:e.policies.deny,required:e.policies.required},i=e.policies.policyObjectMap,n=!1,!0)};if(r.hasErrors)return void W.warning(new z.Error({message:"Failed loading the policy restrictions for resource types"}));if(r.isIncomplete&&(W.warning(new z.Error({message:"Did not finish loading the policy restrictions for resource types on server, retrying from client"})),!await e()))return;const l=async()=>{if(!s(t?.required,r?.required)||!s(t?.deny,r?.deny)){if(n){if(W.warning(new z.Error({message:"Policy restrictions for resource types from server did not match cached policy, retrying from client"})),!await e())return;return void await l()}const c=t?.policyObjectMap,d=[],p=[],u=[];let m=!1;if(c&&i){m=!0;const e=Object.keys(c),t=Object.keys(i);e.forEach((e=>{t.includes(e)?s(c[e].required,i[e].required)&&s(c[e].deny,i[e].deny)||u.push(e):d.push(e)})),t.forEach((t=>{e.includes(t)||p.push(t)}))}const g={required:r?.required||[],deny:r?.deny||[],policyObjectMap:i};if(g?(0,f.writeUserSettings)(this._diContainer.get(f.SettingsManager),{resourceTypeRestrictions:JSON.stringify(g)},0,0):(0,f.deleteUserSettings)(this._diContainer.get(f.SettingsManager),["resourceTypeRestrictions"]),await(0,f.flush)(this._diContainer.get(f.SettingsManager)),this.assetTypesComplete.isPending())this._policyForResourceTypesPromise=Promise.resolve(g);else{const e={oldPolicies:{required:t?.required||[],deny:t?.deny||[]},newPolicies:{required:g?.required||[],deny:g?.deny||[]}};m&&(e.newPolicyObjectMap=i,e.oldPolicyObjectMap=c),P.Diagnostics.Telemetry.trace({source:"Shell",action:"PolicyForResourceTypesUpdate",name:"Services.AssetTypes",data:e});const s=()=>{let e=a.ResourceTypeRestrictions.policyChangeDescription;if(m){const t=(e,t,s)=>{let i="<br/><br/>"+t+"<br/><br/>";return e.slice(0,4).forEach((e=>{const t=o.ArmId.parse(e);i+=s?'<a target="_blank" href="#view/Microsoft_Azure_Policy/AssignmentDetail.ReactView/id/'+encodeURIComponent(e)+'">'+t.resourceName+"</a><br/>":t.resourceName+"<br/>"})),e.length>4&&(i+=a.ResourceTypeRestrictions.additionalPolicies+"<br/>"),i};d.length&&(e+=t(d,a.ResourceTypeRestrictions.policyChangeDescriptionRemovedPoliciesFormat,!1)),p.length&&(e+=t(p,a.ResourceTypeRestrictions.policyChangeDescriptionAddedPoliciesFormat,!0)),u.length&&(e+=t(u,a.ResourceTypeRestrictions.policyChangeDescriptionChangedPoliciesFormat,!0))}return e+='<br /><br/><a target="_blank" href="#view/Microsoft_Azure_Policy/PolicyMenuBlade/~/Assignments">'+a.ResourceTypeRestrictions.seePolicies+"</a>","<div>"+e+"</div>"};this._diContainer.getAsync(S.get("MsPortalImpl/UI/Hubs/UI.NotificationManager","NotificationHandler")).then((e=>e.showModalNotification({diContainer:this._diContainer,messageContext:{srcWindowId:_.Shell,destWindowId:_.Shell,callStack:null},messageArg:{primaryButtonClickAction:2,primaryButtonText:M.AssetTypesNotification.primaryButtonText,secondaryButtonText:M.AssetTypesNotification.secondaryButtonText,notification:{title:a.ResourceTypeRestrictions.policyChangeTitle,description:s(),descriptionAsHtml:!0,status:O.Warning,timestamp:new Date}}})))}}};await l()}}))}))):this._policyForResourceTypesPromise=Promise.resolve(void 0),this.assetTypesComplete=Q(this._listenForExtensions())}_getPolicyForResourceTypes(){const e=new MsPortalFx.Base.UriBuilder(`/providers/microsoft.management/managementgroups/${this._cachedUser.tenantId}/providers/microsoft.policyinsights/checkPolicyRestrictions?api-version=2022-03-01`);return(0,i.batch)({type:"POST",uri:e.toString(),content:{pendingFields:[{field:"type"}]},setTelemetryHeader:"PolicyForResourceTypesFromClient"}).then((e=>{const t=[],s=[];let i=0;const o={};return e?.content?.fieldRestrictions?.forEach((e=>{"type"===e?.field&&(++i,e.restrictions?.forEach((e=>{switch(e?.result){case"Deny":t.push(...e.values),o[e.policy.policyAssignmentId]={deny:e.values,required:[]};break;case"Required":s.push(...e.values),o[e.policy.policyAssignmentId]={deny:[],required:e.values}}})))})),W.verbose("Policy resource types loaded client-side. Data: "+JSON.stringify({tenantId:this._cachedUser.tenantId,source:"ARM",totalPolicies:i})),{policies:{deny:t,required:s,policyObjectMap:o}}})).catch((()=>(W.warning("Policy resource types failed to load client-side. Data: "+JSON.stringify({tenantId:this._cachedUser.tenantId})),{policies:{deny:[],required:[]},ignore:!0})))}dispose(){MsPortalFx.disposeDisposable(this._memoizedManifestsLoadedError,this._lifetimeManager,this._resourceIdSelectionCache)}getMappedBladeLocator(e,t){if(1===e.type){const t=this._mappedBrowseBlades.get(e.getExtensionName());if(t?.get(e.name))return u.resourceMenu}if(1===t?.type){const e=this._mappedBrowseBlades.get(t.getExtensionName());if(e?.get(t.name))return u.resourceMenu}return e}getAssetType(e,t,s){if(e&&t){const i=e.toLowerCase(),o=t.toLowerCase();return ye(this.assetTypes,(e=>e.lowerCaseExtension===i&&e.lowerCaseAssetType===o&&ge(e,s)))}}getAssetTypeById(e,t){if(e){const s=e.toLowerCase();return ye(this.assetTypes,(e=>e.lowerCaseAssetTypeId===s&&ge(e,t)))}}getAssetTypeByResourceType(e,t){if(e){const s=e.toLowerCase();let i=ye(this.assetTypes,(e=>e.lowerCaseResourceType===s&&ge(e,t)));return!i&&this._diContainer.get(I.Experimentation).shellAssignments.getBooleanValue("parseextensiontypes")&&(i=ye(this.assetTypes,(e=>e.lowerCaseResourceType&&s.endsWith(e.lowerCaseResourceType)&&ge(e,t)))),i}}getAssetTypeByResourceTypeWithFallback(e,t){let s=this.getAssetTypeByResourceType(e,t);return s||(s=MsPortalFx.clone(this.getAssetType("HubsExtension",T,t)),s.assetTypeManifest.resourceType={resourceTypeName:e}),s}getAssetTypeDeepLink(e,t,s,i){const o=e.assetTypeManifest,r=o.name,a=o.bladeName,l=e.extension,c=o.bladeExtensionName||l,p=o.resourceType,u=p?.resourceTypeName,m=(e,t)=>(0,d.getBladeDeepLink)("HubsExtension",e,t);let g="";const h=this._serviceMenuEnabled&&o.serviceMenuBlade;if(!i&&o.browseDeepLink)g=o.browseDeepLink;else if(h)g=(0,d.getBladeDeepLink)(o.serviceMenuBladeExtension||e.extension,h,{id:o.serviceMenuItemId});else{const i=FxImpl.lowerCaseStringMap();switch(i.set(k.AllResources,{blade:E.BrowseAllResourcesBlade,inMenuBlade:"BrowseAllInMenu"}),i.set(k.ResourceGroups,{blade:E.BrowseResourceGroupBlade,inMenuBlade:"BrowseGroupsInMenu"}),i.set(k.RecentResources,{blade:j,inMenuBlade:j}),o.browseType){case 1:{const e=i.get(u||k.AllResources)||{blade:E.BrowseResourceBlade,inMenuBlade:"BrowseInMenu"};g=m(s?e.inMenuBlade:e.blade,t?{resourceType:u,kind:t}:{resourceType:u});break}case 2:if("HubsExtension"===c){const e=FxImpl.lowerCaseStringMap();e.set(E.BrowseAllResourcesBlade,{resourceType:k.AllResources,bladeName:E.BrowseAllResourcesBlade}),e.set(j,{bladeName:j});const t=e.get(a);t&&(g=m(t.bladeName,t.resourceType?{resourceType:t.resourceType}:null))}else(0,n.supportsContract)(o.contracts,32768)&&(g=m(E.AssetMenuBlade,{assetName:r,extensionName:l}));if(!g){g="Dashboard"===r&&"HubsExtension"===c?"#":(0,d.getBladeDeepLink)(c,a),r===F.Gallery&&(g+="/selectedMenuItemId/home")}break;case 3:g=this.getBrowseLinkUri(e)}}return!g&&u&&W.error(`<${u}> asset type does not have a deep link. Side bar & search results will not be able to open any blades.`),g}getBrowseLinkUri(e){const t=this._assetTypeByIdBrowseLink[e.id];if(t)return t;const s=this._formatBrowseLinkUri(e.assetTypeManifest.browseLinkUri);return this._assetTypeByIdBrowseLink[e.id]=s,s}_formatBrowseLinkUri(e){const t=this._cachedUser;if(e){const s=U.links.classicPortal.format({domain:t?.tenantDomain});e=e.format({accountPortal:U.links.accountPortal,classicPortal:s,domain:t?.tenantDomain,tenantId:t?.tenantId})}return e}getAssetTypeInformation(e,t){const s=we.getAssetTypeInformationOverride;return s?s(e,t):w.tryImmediateResolve(this._getAssetTypePromise(e,t),(s=>{if(!s)throw X(`Asset type not found: AssetType <${e}:${t}>`);return this.mapAssetTypeToAssetTypeInformation(s)}))}getResourceTypeAssetTypeInformation(e){const t=we.getResourceTypeAssetTypeInformationOverride;if(t)return t(e);const s=(e,t)=>({resourceType:e,topLevelTenantAlias:null,topLevelResourceTypeAlias:null,extensionName:null,assetType:null,browseType:-1,compositeDisplayName:null,icon:null,viewModelLocator:null,viewModel:null,viewModelExtensionName:null,contracts:0,lowerCaseExtension:null,lowerCaseAssetType:null,lowerCaseResourceType:oe(e),reason:MsPortalFx.getLogFriendlyMessage(t)}),i=[],o=[],n=FxImpl.lowerCaseStringMap();return e.forEach((e=>{e.split("/").length>=2?n.set(e,!0):o.push(e)})),i.push(...o.map((e=>s(e,"Invalid resource type")))),n.forEach(((e,t)=>{const o=w.tryImmediateResolve(this.assetTypesComplete,(()=>{const e=this.getAssetTypeByResourceType(t);return e?this.mapAssetTypeToResourceTypeAssetTypeInformation(e):s(t,"Asset type not found")}));i.push(o)})),Promise.all(i)}mapAssetIdToResourceId(e){const t=e.extensionName,s=e.assetType,i=e.assetId,n=o.ArmId.parse(i,!0);return 1===n.kind||4===n.kind||(0,l.isResourceAtAnyLevel)(n)?Promise.resolve(i):Promise.reject(X("Asset ID not a resource ID. "+`Extension <${t}> : AssetType <${s}> : ID _REDACTED_`))}mapResourceIdToAssetId(e){return w.tryImmediateResolve(this._getAssetTypeByResourceId(e),(t=>{if(!t)throw X(`Asset type not found: ResourceId <${(0,l.sanitizeId)(e)}>`);const s=t.assetTypeManifest,i=s.name,o=s.resourceType,n=t.extension;if(!o)throw he(`ResourceId <${(0,l.sanitizeId)(e)}>`,n,i);return{extensionName:n,assetType:i,assetId:e}}))}mapAssetIdToDynamicSelectionAndIcon(e,t){const s=e.extensionName,i=e.assetType,n=e.assetId;return w.tryImmediateResolve(this._getAssetTypePromise(s,i),(r=>{if(r){e.assetId=n&&ko.unwrap(n);const s=o.ArmId.parse(e.assetId,!0);if(function(e){return 1===e.kind||4===e.kind||(0,l.isResourceAtAnyLevel)(e)}(s)){if(0===s.kind)throw fe(e.assetId);return this._getDynamicSelectionAndIconFromResourceId(r,e.assetId,s,e,t)}return this._getDynamicSelectionAndIconFromAssetId(r,e)}throw X(`Asset type not found: AssetType <${s}:${i}>`)}))}getBrowseBladeReference(e){return Ee(this._diContainer,e)}mapResourceIdToDynamicSelectionAndIcon(e,t){const s=o.ArmId.parse(e,!0);if(this._resourceIdSelectionCache=this._resourceIdSelectionCache||new c.ItemArrayCache(216e5),0===s.kind)return Promise.reject(fe(e));const i=this._resourceIdSelectionCache.first((t=>ne(t.resourceId,e)));return i?Promise.resolve(i.value):w.tryImmediateResolve(w.tryImmediateResolve(this._getAssetTypeByResourceId(e),(i=>{if(!i)throw X(`Asset type not found: ResourceId <${(0,l.sanitizeId)(e)}>`);const o=i.assetTypeManifest,n=o.name;if(!o.resourceType)throw he(`ResourceId <${(0,l.sanitizeId)(e)}>`,i.extension,n);return w.tryImmediateResolve(this.mapResourceIdToAssetId(e),(o=>this._getDynamicSelectionAndIconFromResourceId(i,e,s,o,t)))})),(t=>(this._resourceIdSelectionCache.pushEntry({resourceId:e,value:t}),t)))}mapResourceIdAndKindToBladeInfo(e,t){e=e||"";const s=(t=t||"").toLowerCase(),i=o.ArmId.parse(e,!0),n=o.ResourceName.getDisplayName({id:e,armId:i});let r;r=1===i.kind?w.tryImmediateResolve(MsPortalFx.Azure.getSubscriptionInfo(i.subscription),(e=>e.displayName),(()=>n)):Promise.resolve(n);const a=e.startsWith("/")?`#resource${e}`:`#resource/${e}`,l=i.resourceType||"",c=l.toLowerCase(),d=ye(this._bladeInfoPromises,(e=>e.resourceKind===s&&e.resourceType===c));let p=d?.promise;return p||(p=w.tryImmediateResolve(this.getResourceTypeAssetTypeInformation([l,o.ArmId.parse(e).resourceType]),(e=>{const i=e&&e[0].assetType&&e[0]||e[1]||{},o=i.kindMap&&(i.kindMap[s]||i.kindMap[i.defaultKind]),n=o||{},r=n.singularDisplayName||i.compositeDisplayName?.singular||l,a=n.icon||i.icon||V,d=r?N.CustomImageWithOptions(a,{title:r}):a,p=(void 0!==n.isPreview?n.isPreview:i.isPreview)?N.CustomImageWithBadge(d,q):d;let u=D,m="HubsExtension";const g=n.bladeName||i.bladeName;g&&(u=g,m=n.bladeExtensionName||i.bladeExtensionName||i.extensionName);const h={icon:d,previewIcon:p,bladeName:u,bladeExtension:m};return t&&!o||be(this._bladeInfoPromises,{resourceType:c,resourceKind:s,promise:Promise.resolve(h)},200),h}),(()=>$))),w.tryImmediateResolve(p,(({icon:e,previewIcon:t,bladeName:s,bladeExtension:i})=>w.tryImmediateResolve(r,(o=>({displayName:o,deepLink:a,icon:e,previewIcon:t,bladeName:s,bladeExtension:i})))))}mapAssetTypeToAssetTypeInformation(e){const t=e.assetTypeManifest,s=t.keywords;return{extensionName:e.extension,assetType:t.name,options:t.options,browseType:void 0!==t.browseType?t.browseType:-1,browseLinkUri:this.getBrowseLinkUri(e),compositeDisplayName:e.compositeDisplayName,icon:e.icon,viewModelLocator:t.viewModelLocator,viewModel:t.viewModel,viewModelExtensionName:t.viewModelExtensionName,contracts:t.contracts,isPreview:e.isPreview,isDisabled:t.isDisabled,privateBrowse:t.privateBrowse,keywords:s?s.split(","):void 0,hiddenCommands:t.hiddenCommands,browseCommandExperiments:t.browseCommandExperiments,extensibleCommandsApiVersions:t.extensibleCommandsApiVersions}}mapAssetTypeToResourceTypeAssetTypeInformation(e,t){const s=e.assetTypeManifest,i=s.resourceType||{},o=s.browseType,n=s.keywords;let r=i.proxyRoutingFilters;r||"microsoft_azure_marketplace"!==e.lowerCaseExtension||"galleryrpitem"!==e.lowerCaseAssetType||(r=[1,3]);const a={resourceType:i.resourceTypeName,topLevelTenantAlias:i.topLevelTenantAlias,topLevelResourceTypeAlias:i.topLevelResourceTypeAlias,apiVersion:i.apiVersion,routingType:i.routingType,bladeName:s.bladeName,bladeExtensionName:s.bladeExtensionName,partName:s.partName,partExtensionName:s.partExtensionName,kinds:i.kinds,kindMap:e.kindMap,defaultKind:e.defaultKind,proxyRoutingFilters:r,extensionName:e.extension,assetType:s.name,options:s.options,browseType:void 0!==o?o:-1,browseLinkUri:this.getBrowseLinkUri(e),compositeDisplayName:e.compositeDisplayName,icon:e.icon,viewModelLocator:s.viewModelLocator,viewModel:s.viewModel,viewModelExtensionName:s.viewModelExtensionName,contracts:s.contracts,isPreview:e.isPreview,isDisabled:s.isDisabled,noPdlCreateBlade:s.noPdlCreateBlade,noPdlCreateExtension:s.noPdlCreateExtension||e.extension,noPdlCreateParameters:s.noPdlCreateParameters,claimedMarketplaceIds:s.claimedMarketplaceIds,postCreateBlade:s.postCreateBlade,marketplaceItemId:s.marketplaceItemId,marketplaceMenuItemId:s.marketplaceMenuItemId,staticOverview:s.staticOverview,privateBrowse:s.privateBrowse,keywords:n?.split(","),lowerCaseAssetType:e.lowerCaseAssetType,lowerCaseExtension:e.lowerCaseExtension,lowerCaseResourceType:e.lowerCaseResourceType,description:s.description,links:s.links,armBrowseOption:s.armBrowseOption,argBrowseOption:s.argBrowseOption,browseDeepLink:s.browseDeepLink,showArgColumns:s.showArgColumns,hiddenCommands:s.hiddenCommands,hideBrowseInfoBox:s.hideBrowseInfoBox,browseCommandExperiments:s.browseCommandExperiments,extensibleCommandsApiVersions:s.extensibleCommandsApiVersions,featureCardOptions:s.featureCardOptions};return s.variant&&(a.variant=s.variant),t&&s.variants&&(a.variants=s.variants.map((e=>({name:e.name,compositeDisplayName:de(e),viewModel:e.viewModel,viewModelExtensionName:e.viewModelExtensionName,contracts:e.contracts,partName:e.partName,partExtensionName:e.partExtensionName,bladeName:e.bladeName,bladeExtensionName:e.bladeExtensionName,options:e.options,browseType:e.browseType,browseLinkUri:e.browseLinkUri,browseRequiresRdfe:e.browseRequiresRdfe,resourceType:e.resourceType?.resourceTypeName,topLevelTenantAlias:e.resourceType?.topLevelTenantAlias,topLevelResourceTypeAlias:e.resourceType?.topLevelResourceTypeAlias,apiVersion:e.resourceType?.apiVersion,routingType:e.resourceType?.routingType,kinds:e.resourceType?.kinds,icon:e.icon,noPdlCreateBlade:e.noPdlCreateBlade,noPdlCreateExtension:e.noPdlCreateExtension,noPdlCreateParameters:e.noPdlCreateParameters,postCreateBlade:e.postCreateBlade,marketplaceItemId:e.marketplaceItemId,marketplaceMenuItemId:e.marketplaceMenuItemId,isPreview:e.isPreview,staticOverview:e.staticOverview,keywords:e.keywords,serviceMenuBlade:e.serviceMenuBlade,serviceMenuBladeExtension:e.serviceMenuBladeExtension,serviceMenuItemId:e.serviceMenuItemId,description:e.description,links:e.links,browseDeepLink:e.browseDeepLink})))),a}_getAssetTypePromiseWorker(e){const t=e();return t?Promise.resolve(t):w.tryImmediateResolve(this.assetTypesComplete,(()=>e()))}_getAssetTypeByResourceId(e){const t=o.ArmId.parse(e,!0);return 0===t.kind?Promise.reject(fe(e)):w.tryImmediateResolve(this._getAssetTypeByResourceType(t.resourceType),(t=>{if(!t){const t=o.ArmId.parse(e);return w.tryImmediateResolve(this._getAssetTypeByResourceType(t.resourceType),(e=>e))}return t}))}_getAssetTypeByResourceType(e,t){const s=oe(e),i=ye(this._assetTypeByResourceTypePromises,(e=>e.resourceType===s&&e.requirements===t));if(i)return i.promise;const o=Q(this._getAssetTypePromiseWorker((()=>this.getAssetTypeByResourceType(e,t))));if(!o.isRejected()){const e={resourceType:s,promise:o,requirements:t};be(this._assetTypeByResourceTypePromises,e,200),o.isPending()&&o.catch((t=>{t.message===K&&W.warning(K),J(this._assetTypeByResourceTypePromises,e)}))}return o}_getDynamicSelectionAndIconFromAssetId(e,t){const s=me(e,t.assetId);if((0,n.supportsContract)(e.assetTypeManifest.contracts,32768)){const t=s.selection;t.extension="HubsExtension",t.detailBlade=E.AssetMenuBlade,t.detailBladeInputs={assetName:e.assetTypeManifest.name,extensionName:e.extension}}return Promise.resolve(s)}_getDynamicSelectionAndIconFromResourceId(e,t,s,i,a){const l=me(e,i.assetId),c=l.selection,d=e?.assetTypeManifest;if(1===s.kind||4===s.kind)return c.extension="HubsExtension",c.detailBlade=D,Promise.resolve(l);const p=d?.resourceType;if(p&&p.routingType===L.Extension&&!(0,n.supportsContract)(d.contracts,64))return Promise.resolve(l);if(d&&(0,n.supportsContract)(d.contracts,128))return c.extension="HubsExtension",c.detailBlade=D,Promise.resolve(l);const u=ye(this._selectionFromResourceIdPromises,(e=>e.resourceId===t));if(u)return u.promise;let m;if(d&&(!p?.kinds||(0,n.supportsContract)(d.contracts,512)&&!(0,n.supportsAnyContract)(d.contracts,13312)))m=Promise.resolve(l);else{let s;if((0,n.supportsContract)(d.contracts,64)){const i=e.assetTypeManifest.viewModelLocator||e.assetTypeManifest.viewModel,n=this._lifetimeManager.createChildLifetime();s=this._viewModelManager.getViewModel(e.extension,i,11).then((s=>{let r=!1;if(n.registerForDispose((()=>{r=!0,this._viewModelManager.releaseViewModel(s)})),!r)return s.content().getResource(t).then((e=>MsPortalFx.extend2(e,{armId:o.ArmId.parse(e.id,!0)})));throw xe("asset type service",e.extension,i)})).finally((()=>n.dispose()))}else s=(0,r.getResource)(t,a);m=w.tryImmediateResolve(s,(t=>{if(!d||d.name===T)return Promise.resolve(l);if((0,n.supportsOption)(d.options,2))return Promise.resolve(l);const s=e.kindMap&&(e.kindMap[(t.kind||"").toLowerCase()]||e.kindMap[(e.defaultKind||"").toLowerCase()]);if(s&&(0,n.supportsOption)(s.options,2))return Promise.resolve(l);let i=!1;return(0,n.supportsContract)(d.contracts,8)&&(c.extension="HubsExtension",c.detailBlade=D,i=!0),w.tryImmediateResolve(MsPortalFx.require("MsPortalImpl/Services/Services.AssetTypesDelayed"),(s=>{if(p?.kinds){let o=!1,r=!1,a=!1;if(s.getIconAndBladeFromAssetTypeInformation(t,e.kindMap,e.defaultKind,null,(e=>{e?(0,n.supportsContract)(d.contracts,16)&&(c.extension="HubsExtension",c.detailBlade=D,i=!0):i=!1}),(e=>{r||(r=!0,l.isPreview=e)}),(e=>{o||(o=!0,l.icon=e)}),((t,s)=>{a||i||(a=!0,c.extension=t||e.extension,c.detailBlade=s)})),a||i)return l}return l}))})).catch((s=>{const o=function(e,t,s){let i;return z.isInstanceOfErrorType(e,z.Error)?i=X(e,s):H.isXMLHttpRequestLike(e)?(i=X(e.message||t,e.stack,s),MsPortalFx.shallowCopyFromObject(i,e,["readyState","status","statusText","responseText"])):i=X(new z.Error({message:t,data:s,innerErrors:e})),i}(s,"_getDynamicSelectionAndIconFromResourceId have unexpected error.",{assetType:e,resourceId:t,assetId:i,telemetry:a});throw o}))}const g={resourceId:t,promise:m};return be(this._selectionFromResourceIdPromises,g,200),m.catch((e=>{MsPortalFx.remove(this._selectionFromResourceIdPromises,g)})),m}_preventDuplicateResourceTypes(e,t,s){if(this._resourceTypeMap[e]){const i=ye(this.assetTypes,(t=>t.lowerCaseResourceType&&t.lowerCaseResourceType===e)),o=Me(i.assetTypeManifest),n=Me(s);if(!(o<n))return o>n||W.verbose(`Extension <${t}> has duplicate resource type <${e}> also found in <${i.extension}> extension`),!1;delete this._resourceTypeMap[e],MsPortalFx.remove(this.assetTypes,i)}return!0}_listenForExtensions(){const e=this._mappedBrowseBlades=FxImpl.lowerCaseStringMap(),t={system:!0,"v2.0,system":!0,"v12.0,system":!0},s=(0,v.isFeatureEnabled)("artbrowse");return w.tryImmediateResolve(Q(this._policyForResourceTypesPromise),(i=>{let o;i&&(o={required:i.required?.length&&FxImpl.lowerCaseStringMap(),deny:i.deny?.length&&FxImpl.lowerCaseStringMap()},i.required?.forEach((e=>o.required.set(e,!0))),i.deny?.forEach((e=>o.deny.set(e,!0))));const r=[];return this._manifestCache.getManifests("assetTypes",((i,a)=>{e.has(i)||e.set(i,FxImpl.lowerCaseStringMap());const l=a?.assetTypes;l&&l&&l.forEach((l=>{if(4===l.browseType)return;if(3===l.browseType&&!(l.browseLinkUri||"").match(le))return;const c=this._redirectMap.getAssetRedirect(i+"_"+l.name),d=c&&c.toExtension===i&&c.toAsset===l.name;if(c&&!d)return;const p=l.resourceType,u=p?.resourceTypeName,m=ue(l);if(1===l.armBrowseOption&&!s)return void G(`Skipping asset type <${l.name}> due to lack of ARG support and ARM browse options 'no fallback'`);if(u){if(u.split("/").length<2)return void G(`Skipping asset type <${l.name}> with invalid resource type <${u}> in extension <${i}>`);if(!this._preventDuplicateResourceTypes(m,i,l))return;this._resourceTypeMap[m]=!0,r.push(u.toLowerCase())}const g=(t,s,o)=>{if(t&&o){const o=s||i;e.has(o)||e.set(o,FxImpl.lowerCaseStringMap()),e.get(o).set(t,!0)}},h=p?.kinds,f=(0,n.supportsContract)(l.contracts,8);if(h?.length){if(h.forEach((e=>{g(e.bladeName||l.bladeName,e.bladeExtensionName||l.bladeExtensionName,void 0!==e.useResourceMenu?e.useResourceMenu:f),e.filterMap=MsPortalFx.extendArrayIntoMap(Object.create(null),e.kinds||[e.name],(e=>oe(e)),(e=>!0)),e.isDefault&&(e.filterMap[""]=!0)})),"SqlAzureExtension"===i&&"Database"===l.name){const e=MsPortalFx.find(h,(e=>"v12.0,user,datawarehouse"===oe(e.name))),t=MsPortalFx.find(h,(e=>"v12.0,user,datawarehouse,gen2"===oe(e.name)));e&&t&&(e.filterMap[oe(e.name)]=!0,e.filterMap[oe(t.name)]=!0,t.filterMap[oe(e.name)]=!0,t.filterMap[oe(t.name)]=!0)}}else g(l.bladeName,l.bladeExtensionName,f);!function(e,t){const s=(e,t)=>MsPortalFx.unique([...(e||"").split(",").filter((e=>!!e)),...t]).join(","),i=t.name,o=pe(e,i,"");o?.length&&(t.keywords=s(t.keywords,o)),((t.resourceType||{}).kinds||[]).forEach((t=>{const o=oe(t.name),n=pe(e,i,o);n?.length&&(t.keywords=s(t.keywords,n))}))}(i,l),function(e,t){try{if(!e||!t?.name)return;if(!Object.keys(te)?.length){const e=Object.keys(ee);for(const t of e)for(const e of Object.keys(ee[t])){const s=t.toLowerCase()+"_"+e.toLowerCase();if("string"==typeof ee[t][e])te[s]=ee[t][e];else if("object"==typeof ee[t][e]){const i=Object.keys(ee[t][e]);if(i.length)for(const o of i){const i=s+"."+o.toLowerCase();te[i]=ee[t][e][o]}}}}const s=e.split("_").join("").toLowerCase()+"_"+t.name.toLowerCase();t.description||(t.description=te[s]);for(const e of t.resourceType?.kinds||[]){const t=s+"."+e.name.replace(/[.,]/g,"").toLowerCase();e.description||(e.description=te[t])}}catch(e){W.verbose(`Failed to update asset type description. Error: ${e}`)}}(i,l);const x=Z(i,l.name),b=function(e,t,s,i,o){const r=i.resourceType?.kinds||[],a=MsPortalFx.find(r,(e=>e.isDefault));let l=(0,n.supportsOption)(i.options,16);return!l&&o&&i.resourceType?.resourceTypeName&&(o.required&&(l=l||!o.required.has(i.resourceType?.resourceTypeName)),o.deny&&(l=l||o.deny.has(i.resourceType?.resourceTypeName))),l&&(i.isDisabled=l),{lowerCaseAssetType:oe(i.name),lowerCaseExtension:oe(e),lowerCaseAssetTypeId:oe(t),lowerCaseResourceType:ue(i)||"",kindMap:MsPortalFx.extendArrayIntoMap(Object.create(null),r,(e=>oe(e.name)),MsPortalFx.identity),defaultKind:a&&oe(a.name),assetTypeManifest:i,id:t,extension:e,compositeDisplayName:ce(i),icon:i?.icon||Y,isPreview:s.isPreview||!!i.isPreview}}(i,x,a,l,o);void 0===l.options&&(l.privateBrowse&&(l.options=1|l.options),"microsoft.sql/servers/databases"===m&&b.kindMap&&(0,v.forEachKey)(b.kindMap,((e,s)=>{t[e]&&void 0===s.options&&(s.options=2|s.options)}))),"microsoft_azure_datafactory"!==i.toLowerCase()||"datafactory"!==l.name.toLowerCase()&&"datafactoryv2"!==l.name.toLowerCase()||void 0!==l.argBrowseOption||(l.argBrowseOption=4),this.assetTypes.push(b)}))})).then((()=>(r.unshift(Se),r.unshift(_e),(0,C.getBrowseCuration)()))).then((e=>this._manifestCache.getManifests("featureCards",((t,s)=>{const i=s?.featureCards;e.featureCardAllowList&&i?.filter((s=>e.featureCardAllowList.some((e=>e.extension.toLowerCase()===t.toLowerCase()&&e.id.toLowerCase()===s.id.toLowerCase()))))?.sort(((s,i)=>e.featureCardAllowList.findIndex((e=>e.extension.toLowerCase()===t.toLowerCase()&&e.id.toLowerCase()===s.id.toLowerCase()))-e.featureCardAllowList.findIndex((e=>e.extension.toLowerCase()===t.toLowerCase()&&e.id.toLowerCase()===i.id.toLowerCase()))))?.forEach((e=>{if(e.resourceTypes){const s=FxImpl.lowerCaseStringMap();MsPortalFx.forEachKey(e.resourceTypes,((e,t)=>s.set(e,t))),r.forEach((i=>{(s.has(i)||s.has("*"))&&(this.featureCardMap.has(i)||this.featureCardMap.set(i,[]),this.featureCardMap.get(i).push({extension:t,manifest:e}))}))}}))}))))}))}_getAssetTypePromise(e,t,s){return this._getAssetTypePromiseWorker((()=>this.getAssetType(e,t,s)))}};De=__decorate([__metadata("fx:diagnostics",[e,"AssetTypeServiceImpl"]),s.Class(),__metadata("design:paramtypes",[s.Container,p.ViewModelManager,g.ManifestCache,g.RedirectMap,x.Features,m.AuthStateManager])],De);class Ae{static create(e){return e}}t.AssetTypeService=Ae,__decorate([__metadata("fx:diagnostics",[e,"AssetTypeService"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[De]),__metadata("design:returntype",Ae)],Ae,"create",null)})),
define("MsPortalImpl/Services/Services.GlobalResourceFilters",["require","exports","Fx/DependencyInjection","Weave","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Subscriptions","FxHubs/RpcEndPoints","MsPortalImpl/Resources/ImplScriptResources","FxInternal/AsyncLoader","FxInternal/ResourceManagement/GlobalResourceFilters","FxInternal/Weave","Fx/Telemetry"],(function(e,t,s,i,o,n,r,a,l,c,d,p){"use strict";t.getGlobalResourceFilterObservableHandler=t.ResourceFilterManager=void 0;var u,m=l,g=MsPortalFx.Base,h=g.Diagnostics.Telemetry;r.Subscriptions.CountTypeEnum;const f=g.Diagnostics.createLog(e),x="selected.subscriptions",b={currentFilterId:"",filters:Object.create(null),optedIn:void 0};function y(e,t){e.setSettings({store:19,settings:{currentFilterId:t.currentFilterId,filters:t.filters,optedIn:t.optedIn}})}let v=t.ResourceFilterManager=u=class{static async create(e){const t=await e.getAsync(o.SettingsManager),s=await async function(e){let t,s;try{t=await e.queryStore(19)}catch(e){return f.warning(`Error retrieving global resource filter settings from user settings. Error details: ${MsPortalFx.getLogFriendlyMessage(e)}`),b}if(!t)return b;try{s=t.filters||b.filters}catch(e){f.warning(new MsPortalFx.Errors.Error({message:`Error parsing global resource filter settings. Error details: ${MsPortalFx.getLogFriendlyMessage(e)}`,innerErrors:e})),s=b.filters,t.currentFilterId=b.currentFilterId}let i={currentFilterId:t.currentFilterId||b.currentFilterId,filters:s,optedIn:t.optedIn};i.currentFilterId&&!s[i.currentFilterId]&&(i={...i,currentFilterId:b.currentFilterId}),MsPortalFx.deepEquals(i,t)||y(e,i);const o=i.filters[i.currentFilterId],n={filterCount:Object.keys(i.filters).length};return o?(n.currentFilterId=o.id,n.facetCount=o.facets.length):n.currentFilterId="<default>",(0,p.trace)({source:"ResourceFilterManager",action:"getFilterSettingsFromUserSettings",data:n}),i}(t);return new u(e,s)}constructor(e,t){this._diContainer=e,this._lifetime=new FxImpl.TriggerableLifetimeManager,MsPortalImpl.sessionStorage.getItem("subscriptions_selected_migrated")&&(MsPortalImpl.sessionStorage.removeItem("subscriptions_selected_migrated"),e.getAsync(m.get("MsPortalImpl/UI/Hubs/UI.NotificationManager","NotificationManager")).then((e=>e.addSingleNotification({title:a.filtersOptInSuccessTitle,description:a.filtersOptInSuccessMessage,status:4}))));const s=[];MsPortalFx.forEachKey(t.filters,((e,t)=>s.push(t))),this._filters=(0,i.makeArrayComputation)(s),this._filtersMap=this._filters.compose((e=>e.reduce(((e,t)=>(e[t.id]=t,e)),Object.create(null)))),this._currentFilterId=(0,i.makeWritableComputation)(t.currentFilterId?t.currentFilterId:""),(0,i.subscribe)(this._lifetime,[this._filtersMap,this._currentFilterId],(async(e,s)=>{y(await this._diContainer.getAsync(o.SettingsManager),{filters:e||Object.create(null),currentFilterId:s||"",optedIn:t.optedIn})})),this._currentFilterComputation=(0,i.composeComputation)([this._currentFilterId,this._filtersMap],((e,t)=>t[e]||null)),this.canAddFilter=this._filters.compose((e=>e.length<10)),this.currentFilterObservable=(0,d.toObservable)(this._lifetime,this.currentFilter)}get filters(){return this._filters}get currentFilter(){return this._currentFilterComputation}activateFilter(e){if(!MsPortalFx.isNullOrUndefined(e))return""===e?this._currentFilterId(b.currentFilterId):void((0,i.evaluate)(this._lifetime,this._filtersMap)[e]?this._currentFilterId(e):f.warning(`Attempted to activate filter with ID "${e}" which does not exist.`))}addFilter(e,t,s=!1){if(this._filters.value.length>=10)return null;const i=MsPortalFx.newGuid(),o={id:i,name:e,facets:t};return this._filters.push(o),s&&this._currentFilterId(i),o}deleteFilter(e){if(!e)return;const t=MsPortalFx.findIndex(this._filters.value,(t=>t.id===e));t<0?f.warning(`Filter with ID "${e}" could not be located.`):(this._currentFilterId.value===e&&this._currentFilterId(b.currentFilterId),this._filters.splice(t,1))}updateFilter(e){if(!e)return;const t=e?.id;if(!t)return;const s=MsPortalFx.findIndex(this._filters.value,(e=>e.id===t));s<0?f.warning(`Filter with ID "${t}" could not be located.`):this._filters.set(s,e)}async createSelectedSubscriptionsFilter(){const e=(0,i.evaluate)(this._lifetime,this._filtersMap)[x],t=h.startTrace({source:"ResourceFilterManager",action:"MigrateSelectedSubscriptions"}),s=await this._diContainer.getAsync(n.SubscriptionsUserContext),o=(await s.getGlobalSelectedSubscriptions())().map((e=>e.subscriptionId)),r=await s.getAllSubscriptionsCount();if(!o.length)return h.completeTrace(t,{data:{selectedSubscriptionCount:0}}),e&&(this.deleteFilter(x),this.activateFilter("")),null;if(1===r.type&&o.length===r.value)return h.completeTrace(t,{data:{allSelected:!0}}),e&&(this.deleteFilter(x),this.activateFilter("")),null;const l={id:x,name:a.UiSettings.selectedSubscriptionsFilterName,facets:[{type:"subscriptionId",operator:"==",value:o}]};return e?this.updateFilter(l):this._filters.push(l),this._currentFilterId(x),h.completeTrace(t,{data:{previouslyMigrated:!!e,selectedSubscriptionCount:o.length}}),l}};__decorate([__metadata("fx:diagnostics",[e,"ResourceFilterManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container]),__metadata("design:returntype",Promise)],v,"create",null),t.ResourceFilterManager=v=u=__decorate([__metadata("fx:diagnostics",[e,"1"]),s.Class(),__metadata("design:paramtypes",[s.Container,Object])],v);t.getGlobalResourceFilterObservableHandler=(0,l.defineHandler)(c.getGlobalResourceFilterObservableEndPoint,(e=>e.diContainer.getAsync(v).then((e=>e.currentFilterObservable))))})),
define("MsPortalImpl/Services/Services.Permissions",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","Fx/ResourceManagement","Fx","FxHubs/Helpers/PermissionsHelpers"],(function(e,t,s,i,o,n,r){"use strict";t.hasPermissionsToShell=t.PermissionsManager=t.PermissionsChecker=void 0,t.isRDFEAction=d;var a=FxImpl.Extension;const l=window,c=()=>MsPortalFx.require(e.normalize("./PermissionsHelpers"));function d(e){return e&&1===e.length&&"rdfe"===e[0]}class p{static create(e){return new u(e)}}t.PermissionsManager=p,__decorate([__metadata("fx:diagnostics",[e,"PermissionsManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container]),__metadata("design:returntype",p)],p,"create",null);class u{constructor(e){this._diContainer=e;const t=m(((e,t)=>c().then((s=>s.getPermissions(e,t)))));this._cachedPermissionsGetter=t,this._getPermissionsCallback=(e,s)=>t.getPermissions(e,s)}hasPermission(e,t,s){if(d(t))return c().then((i=>i.hasPermissionsImpl(this._diContainer,e,t,s)));return 0===o.ArmId.parse(e,!0).kind?Promise.resolve("The entity ID for hasPermission must be a resource ID, a subscription ID or a resource group ID"):c().then((i=>i.hasPermission(e,t,null,this._getPermissionsCallback,s)))}getDiagnosticsData(){const e=[],t=this._cachedPermissionsGetter.getCachedPermissions(),s=[];return Object.keys(t).forEach((i=>{e.push(t[i]().then((e=>{s.push({entityId:i,permissions:e})})))})),Promise.all(e).then((()=>s))}}t.hasPermissionsToShell=i.defineHandler(a.hasPermissionsToShell,(e=>e.diContainer.get(p).hasPermission(e.messageArg.entityId,e.messageArg.requestedActions,e.messageContext.srcWindowId)));function m(e,t){if(!t&&l.fxDisableRbacCache)return{getPermissions:e,getCachedPermissions:()=>({}),clear:MsPortalFx.noop};{let t;const s=()=>(t=t||{},t);return{getPermissions:(t,i)=>{const o=s();return(o[t]||(o[t]=(0,n.memoizePromise)((t=>e(t,i)))))(t)},getCachedPermissions:s,clear:e=>{const t=s()[e];t&&t.clear()}}}}class g{constructor(e,t){this._permissionsCache=m((t=>c().then((s=>s.getPermissionsFromArm(t,e)))),t)}hasPermission(e,t,s,i){return d(t)?this.hasRdfePermissions(e):c().then((o=>o.hasPermission(e,t,s,(e=>this._permissionsCache.getPermissions(e,i)),i)))}getDiagnostics(){return this._permissionsCache.getCachedPermissions()}hasRdfePermissions(e){const t=o.ArmId.parse(e,!0);return 1!==t.kind?Promise.resolve(!1):MsPortalFx.Azure.getSubscriptionInfo(t.subscription).then(r.subscriptionRequiresRdfe)}static create(){return new g("HubsExtension")}}t.PermissionsChecker=g,__decorate([__metadata("fx:diagnostics",[e,"PermissionsChecker"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",g)],g,"create",null)})),
define("MsPortalImpl/ReactServices/ResourceService",["require","exports","Fx/DependencyInjection","MsPortalImpl/ReactServices/ReactServiceContext","MsPortalImpl/ReactServices/ReactServiceBase","MsPortalImpl/ReactViews/ShellReactQueries","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Services/Services.GlobalResourceFilters","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.Permissions","Fx/ResourceManagement","FxHubs/ArmHelpers/ArmApisStartup","FxHubs/RpcEndPoints","MsPortalImpl/Services/Services.ArmEvents","FxHubs/ArmHelpers/ArmIds"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g){"use strict";t.ReactResourceService=void 0;let h=t.ReactResourceService=class extends o.ReactServiceBase{constructor(e){super("resource",e),this.fxArmEventHandler=e=>{const t=[];for(const s of e){const e=d.ArmId.parse(s.assetId,!0);let i;i="microsoft.resources/subscriptions/resourcegroups/write"===s.operationName&&4===e.kind?"WriteToResourceGroup":s.operationName.endsWith("/write")&&g.ResourceArmIdKindMap[e.kind]?"WriteToResource":"microsoft.resources/subscriptions/resourcegroups/delete"===s.operationName&&4===e.kind?"ResourceGroupDeleted":s.operationName.endsWith("/delete")&&g.ResourceArmIdKindMap[e.kind]?"ResourceDeleted":"Unknown",t.push({...s,eventType:i})}return t},this.getCurrentFilterObservable().then((e=>{e?.subscribe(this.contextData.lifetime,(e=>{n.globalResourceFilterNameQuery.bind(this.contextData.queryStore,this.contextData.diContainer).set(e?.name??""),n.globalSubscriptionsQuery.bind(this.contextData.queryStore,this.contextData.diContainer).get({force:!0})}))})),this.contextData.diContainer.get(m.ArmEvents).subscribeToArmEvent({status:"succeeded"},(e=>{this.fireEvent("armEvent",this.fxArmEventHandler(e))}))}async getGlobalResourceFilterName(){return n.globalResourceFilterNameQuery.bind(this.contextData.queryStore,this.contextData.diContainer).get()}async getEssentialsResourceInfo(e){return n.essentialsResourceInfoQuery.bind(this.contextData.queryStore,this.contextData.lifetime,e,!0).get()}async setResourceTags(e,t){const s=await MsPortalFx.require("FxHubs/ArmHelpers/ArmTags"),i=await s.handleTagsContextPaneResults(new Map([[e,t]])),o=i.armErrorsMap.get(e);if(o)throw o.armError;return i.newTagsMap.get(e)}async setSoftDeleteInfo(e,t,s){return MsPortalFx.require("FxHubs/ArmHelpers/ArmSoftDelete").then((i=>i.updateSoftDeleteInfo(e,t.softDeleteEnabled,t.softDeleteEnabled,s.retentionTime)))}async getLocalizedResourceTypes(e){return this.contextData.diContainer.get(l.AssetTypeService).getResourceTypeAssetTypeInformation(e)}async hasPermission(e){const{actions:t,resourceId:s}=e;return!0===await this.contextData.diContainer.get(c.PermissionsManager).hasPermission(s,t,MsPortalFx.Base.Constants.Shell)}async getResourceViewReference(e,t){return this.contextData.diContainer.get(l.AssetTypeService).mapResourceIdAndKindToBladeInfo(e,t).then((t=>({viewName:t.bladeName,extensionName:t.bladeExtension,referenceType:"common",parameters:{id:e}})))}async addRecentResource(e){(0,d.addRecentResource)(e)}async getLatestApiVersionForResource(e){return(0,p.getLatestApiVersion)(e)}async getRecentResources(){return u.AssetTypes.getRecentResourcesEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",{})}async notifyResourceDeleted(e){MsPortalFx.UI.AssetManager.notifyResourceDeleted(e)}async getCurrentFilterObservable(){return this.contextData.diContainer.get(r.SubscriptionsUserContext).useAdvancedFiltersPromise.then((e=>{if(e)return this.contextData.diContainer.getAsync(a.ResourceFilterManager).then((e=>e.currentFilterObservable))}))}};__decorate([__metadata("fx:diagnostics",[e,"ReactResourceService.prototype"]),(0,o.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],h.prototype,"getGlobalResourceFilterName",null),__decorate([__metadata("fx:diagnostics",[e,"ReactResourceService.prototype"]),(0,o.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",Promise)],h.prototype,"getEssentialsResourceInfo",null),__decorate([__metadata("fx:diagnostics",[e,"ReactResourceService.prototype"]),(0,o.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[String,Object]),__metadata("design:returntype",Promise)],h.prototype,"setResourceTags",null),__decorate([__metadata("fx:diagnostics",[e,"ReactResourceService.prototype"]),(0,o.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[String,Object,Object]),__metadata("design:returntype",Promise)],h.prototype,"setSoftDeleteInfo",null),__decorate([__metadata("fx:diagnostics",[e,"ReactResourceService.prototype"]),(0,o.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[Array]),__metadata("design:returntype",Promise)],h.prototype,"getLocalizedResourceTypes",null),__decorate([__metadata("fx:diagnostics",[e,"ReactResourceService.prototype"]),(0,o.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Promise)],h.prototype,"hasPermission",null),__decorate([__metadata("fx:diagnostics",[e,"ReactResourceService.prototype"]),(0,o.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[String,String]),__metadata("design:returntype",Promise)],h.prototype,"getResourceViewReference",null),__decorate([__metadata("fx:diagnostics",[e,"ReactResourceService.prototype"]),(0,o.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Promise)],h.prototype,"addRecentResource",null),__decorate([__metadata("fx:diagnostics",[e,"ReactResourceService.prototype"]),(0,o.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",Promise)],h.prototype,"getLatestApiVersionForResource",null),__decorate([__metadata("fx:diagnostics",[e,"ReactResourceService.prototype"]),(0,o.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],h.prototype,"getRecentResources",null),__decorate([__metadata("fx:diagnostics",[e,"ReactResourceService.prototype"]),(0,o.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Promise)],h.prototype,"notifyResourceDeleted",null),t.ReactResourceService=h=__decorate([__metadata("fx:diagnostics",[e,"ReactResourceService"]),s.Class("reactview"),__metadata("design:paramtypes",[i.ReactServiceContext])],h)})),
define("MsPortalImpl/ReactServices/SubscriptionService",["require","exports","Fx/DependencyInjection","MsPortalImpl/ReactServices/ReactServiceContext","MsPortalImpl/ReactServices/ReactServiceBase","MsPortalImpl/ReactViews/ShellReactQueries","MsPortalImpl/Services/Services.Subscriptions"],(function(e,t,s,i,o,n,r){"use strict";t.ReactSubscriptionService=void 0;let a=t.ReactSubscriptionService=class extends o.ReactServiceBase{constructor(e){super("subscription",e);this.contextData.diContainer.get(r.SubscriptionsUserContext).getInSessionSelectedSubscriptions().then((e=>{e.subscribe(this.contextData.lifetime,(e=>{n.selectedSubscriptionsQuery.bind(this.contextData.queryStore,this.contextData.diContainer).set(e)}))}))}async canRegisterSubscriptionWithRPs(e){const{resourceProviders:t,subscriptionId:s}=e;return(await MsPortalFx.require("FxInternal/ResourceManagement/ArmTemplate")).canRegisterSubscriptionWithRPs(this.contextData.diContainer,s,t)}async getGlobalSubscriptions(){return n.globalSubscriptionsQuery.bind(this.contextData.queryStore,this.contextData.diContainer).get()}async getSelectedSubscriptions(){return n.selectedSubscriptionsQuery.bind(this.contextData.queryStore,this.contextData.diContainer).get()}async getSubscription(e){return n.subscriptionQuery.bind(this.contextData.queryStore,this.contextData.diContainer,e).get()}async getSubscriptionsIsPartialSet(){return this.contextData.diContainer.get(r.SubscriptionsUserContext).getInSessionDisplayedSubscriptions().then((e=>e.isPartialSet))}async setSelectedSubscriptions(e){const t=new Set(e.map((e=>e.subscriptionId))),s=(await this.getGlobalSubscriptions()).map((e=>e.subscriptionId)).filter((e=>t.has(e)));this.contextData.diContainer.get(r.SubscriptionsUserContext).setInSessionSelectedSubscriptions(s)}};__decorate([__metadata("fx:diagnostics",[e,"ReactSubscriptionService.prototype"]),(0,o.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Promise)],a.prototype,"canRegisterSubscriptionWithRPs",null),__decorate([__metadata("fx:diagnostics",[e,"ReactSubscriptionService.prototype"]),(0,o.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],a.prototype,"getGlobalSubscriptions",null),__decorate([__metadata("fx:diagnostics",[e,"ReactSubscriptionService.prototype"]),(0,o.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],a.prototype,"getSelectedSubscriptions",null),__decorate([__metadata("fx:diagnostics",[e,"ReactSubscriptionService.prototype"]),(0,o.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",Promise)],a.prototype,"getSubscription",null),__decorate([__metadata("fx:diagnostics",[e,"ReactSubscriptionService.prototype"]),(0,o.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],a.prototype,"getSubscriptionsIsPartialSet",null),__decorate([__metadata("fx:diagnostics",[e,"ReactSubscriptionService.prototype"]),(0,o.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[Array]),__metadata("design:returntype",Promise)],a.prototype,"setSelectedSubscriptions",null),t.ReactSubscriptionService=a=__decorate([__metadata("fx:diagnostics",[e,"ReactSubscriptionService"]),s.Class("reactview"),__metadata("design:paramtypes",[i.ReactServiceContext])],a)})),
define("MsPortalImpl/ReactServices/ThemeService",["require","exports","Fx/DependencyInjection","MsPortalImpl/ReactServices/ReactServiceContext","MsPortalImpl/ReactServices/ReactServiceBase","MsPortalImpl/Base/Themes"],(function(e,t,s,i,o,n){"use strict";t.ReactThemeService=void 0;let r=t.ReactThemeService=class extends o.ReactServiceBase{constructor(e){super("theme",e);this.contextData.diContainer.get(n.ThemeManager).currentTheme.subscribe(this.contextData.lifetime,(e=>{this.fireEvent("themeChanged",{mode:1===e.mode?"dark":"light"})}))}};t.ReactThemeService=r=__decorate([__metadata("fx:diagnostics",[e,"ReactThemeService"]),s.Class("reactview"),__metadata("design:paramtypes",[i.ReactServiceContext])],r)})),
define("MsPortalImpl/Interactions/Interactions.ContextMenuTouch",["require","exports"],(function(e,t){"use strict";t.ReactionDelayMillis=t.MoveTolerancePixels=t.HintClassIdentifier=void 0,t.register=function(e){e.on("touchstart",h)},t.setReactionDelayMillis=function(e){t.ReactionDelayMillis=s=e},t.unregister=function(e){e.off("touchstart",h),p(!0,e)};let s=t.ReactionDelayMillis=550;const i=t.MoveTolerancePixels=10,o=t.HintClassIdentifier="fxs-contextMenuTouchHint",n=$(FxImpl.createElement("div",{class:o})),r=110,a=".cmtevt";let l,c={startTime:0,target:null,targetX:0,targetY:0};function d(e){const t=e.originalEvent,s=t&&t.touches,i=s&&1===s.length,o=s&&s[0];return i?o:null}function p(e,t){t.off(a),clearTimeout(l),function(e){if(e){const e={opacity:.2},t={opacity:1};n.animate(e,25).animate(t,25).animate(e,25).animate(t,25)}n.animate({width:0,height:0,top:"+="+r/2,left:"+="+r/2},75,(function(){n.detach()}))}(e),c={startTime:0,target:null,targetX:0,targetY:0}}function u(e){p(!0,$(e.currentTarget))}function m(e){const t=d(e)||{clientX:0,clientY:0},s=Math.abs(c.targetX-t.clientX),o=Math.abs(c.targetY-t.clientY);(s>i||o>i)&&p(!0,$(e.currentTarget))}function g(e){const t=$(e.currentTarget);if(c.startTime){if(Math.abs(Date.now()-c.startTime)>=s){t.off("contextmenu"+a);const e=$.Event("contextmenu");e.clientX=c.targetX,e.clientY=c.targetY,$(c.target).trigger(e)}}p(!1,t)}function h(e){const t=d(e),i=$(e.currentTarget);t?c&&0!==c.startTime||(c={startTime:Date.now(),target:e.target,targetX:t.clientX,targetY:t.clientY},l=setTimeout((()=>{!function(){const e={width:0,height:0,top:c.targetY,left:c.targetX};n.css(e),$.querySelectorAll("body").append(n),n.animate({width:r,height:r,top:"-="+(r/2+5),left:"-="+r/2},75)}()}),s),i.on("contextmenu"+a,(function(){return!1})).on("touchmove"+a,m).on("touchcancel"+a,u).on("touchend"+a,g)):p(!0,i)}})),
define("MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip",["require","exports","MsPortalImpl/Base/Base.Timers"],(function(e,t,s){"use strict";t.register=function(e){e.on("mouseenter",i,r)},t.unregister=function(e){e.off("mouseenter",i,r)};const i=".msportalfx-tooltip-overflow,.msportalfx-text-ellipsis",o="fxs-autotooltip",n="title",r=(0,s.throttleByAnimationFrame)((e=>{const t=e.currentTarget,s=$(t);t.offsetWidth<t.scrollWidth&&(!t.title||s.hasClass(o))?(s.attr(n,s.text()||s.val()||s.attr("placeholder")||null),s.hasClass(o)||s.addClass(o)):t.offsetWidth>=t.scrollWidth&&s.hasClass(o)&&s.removeAttr(n).removeClass(o)}))})),
define("MsPortalImpl/Widgets/AzHome/FreeTrial/FreeTrialConstants",["require","exports"],(function(e,t){"use strict";t.WelcomeDialogConstants=t.TelemetrySourceConstants=t.TelemetryActionConstants=t.ServicesConstants=t.ResourcesConstants=t.Links=t.CostCardConstants=t.AlertsConstants=void 0;t.ServicesConstants={DeployTemplateLink:"#view/Microsoft_Azure_Resources/Templates.ReactView",DeployServiceLink:"#view/Microsoft_Azure_Resources/DeployServices.ReactView",DeployAIAgentLinkFormatter:"https://ai.azure.com?tid={0}&sessionId={1}&CID=portalFRE",DeployFromGitHubLink:"#view/Microsoft_Azure_Resources/DeployFromGitHub.ReactView"},t.Links={learnMore:"https://learn.microsoft.com/en-us/azure/cost-management-billing/manage/upgrade-azure-subscription"},t.CostCardConstants={ViewCosts:"#view/Microsoft_Azure_CostManagement/Menu/~/costanalysis/openedBy/AzurePortal",UpgradeLinkFormatter:"#blade/Microsoft_Azure_Billing/SubscriptionUpgradeBlade/azureSubscriptionId/{0}/appId/AzPortal_TrialLandingUpgrade"},t.AlertsConstants={ViewAlertsLink:"#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/alertsV2",SetUpAlertsLink:"#view/Microsoft_Azure_Monitoring/CreateAlertRuleBlade/scopes~/%5B%5D/signals~/%5B%5D",ViewServiceIssuesLink:"#view/Microsoft_Azure_Health/AzureHealthBrowseBlade/~/serviceIssues",ServiceIssue:"ServiceIssue",Severity:"severity",FREGetServiceHealthAlerts:"FREGetServiceHealthAlerts",FREGetResourceAlertsData:"FREGetResourceAlertsData"},t.ResourcesConstants={MaxResources:12,AlertsMenuId:"alerts",RecentsTab:"recents",FavoritesTab:"favorites",SeeAllRecentsLink:"#view/Microsoft_Azure_Resources/ResourceManagerBlade/~/recents",SeeAllFavoritesLink:"#view/Microsoft_Azure_Resources/ResourceManagerBlade/~/favorites"},t.WelcomeDialogConstants={FreeTrialHomeShowWelcomeDialog:"FreeTrialHomeShowWelcomeDialog"},t.TelemetrySourceConstants={FREHome:"FREHome",FREServicesCard:"FREServicesCard",FRECreditBadge:"FRECreditBadge",FRECostCard:"FRECostCard",FREAlertsCard:"FREAlertsCard",FREResourcesCard:"FREResourcesCard",FREWelcomeDialog:"FREWelcomeDialog"},t.TelemetryActionConstants={FirstVisit:"FirstVisit",LandingPage:"LandingPage",ReturningPage:"ReturningPage",DeployTemplateClick:"DeployTemplateClick",CreateResourceClick:"CreateResourceClick",DeployAIAgentClick:"DeployAIAgentClick",ImportFromGithubClick:"ImportFromGithubClick",UpgradeButtonClick:"UpgradeButtonClick",LearnMoreButtonClick:"LearnMoreButtonClick",ReloadButtonClick:"ReloadButtonClick",ViewCostsButtonClick:"ViewCostsButtonClick",AlertsQueryFailure:"AlertsQueryFailure",ViewAlertsClick:"ViewAlertsClick",ViewServiceIssuesClick:"ViewServiceIssuesClick",SetUpAlertsClick:"SetUpAlertsClick",RecentlyViewedTabClick:"RecentlyViewedTabClick",FavoritesTabClick:"FavoritesTabClick",ResourceNameClick:"ResourceNameClick",AlertsClick:"AlertsClick",ViewAllRecentsClick:"ViewAllRecentsClick",ViewAllFavoritesClick:"ViewAllFavoritesClick",EmptyRecentsButtonClick:"EmptyRecentsButtonClick",EmptyFavoritesButtonClick:"EmptyFavoritesButtonClick",WelcomeDialogCloseButtonClick:"WelcomeDialogCloseButtonClick",WelcomeDialogContinueButtonClick:"WelcomeDialogContinueButtonClick"}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.AzureHome.css",["module"],(function(e){"use strict";return{css:".fxs-home-target{flex-direction:column}.fxs-home-container,.fxs-home-toggle{padding-left:16px;padding-right:16px;font-size:13px;max-width:1063px;margin:0 auto}.fxs-react-home-vertical-padding{padding-top:24px;padding-bottom:24px}.fxs-home-fragments{padding:24px 21.33333333px 0;font-size:13px;max-width:1063px;margin:0 auto}.fxs-home-toggle.fxs-az-home-react-toggleOn~.fxs-home-fragments{max-width:1340px;min-width:288px}.fxs-home-container.fxs-az-home-react-toggleOn,.fxs-home-toggle.fxs-az-home-react-toggleOn{max-width:1340px;min-width:288px}.fxs-home-container.fxs-frehome-react{max-width:1340px;min-width:288px}.fxs-home-fragments:empty{display:none}.fxs-home-title{display:flex;align-items:center;font-weight:600;font-size:18px;margin-block-start:0;margin-bottom:16px;min-width:300px}.fxs-home-section{display:flex;flex-wrap:wrap}.fxs-home-section:not(:last-child){margin-bottom:40px}.fxs-home-feature-tile{height:100px;width:100px;flex:0 0 auto;cursor:pointer;text-align:center;border:1px solid transparent;margin:0 0 0 7px;box-sizing:border-box}.fxs-home-feature-name{max-width:100%;display:block;display:-webkit-box;line-height:17px;max-height:34px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:2;-webkit-box-orient:vertical}.fxs-home-feature-link{padding:14px 4px 9px 4px;box-sizing:border-box}a.fxs-home-feature-link,a.fxs-home-ad-link{height:100%;width:100%;display:flex;align-items:center}a.fxs-home-feature-link:hover,a.fxs-home-ad-link:hover{text-decoration:none}a.fxs-home-feature-link{flex-direction:column}@media(min-width:1211px){.fxs-sidebar-hamburger-mode .fxs-home-feature-tile-container{justify-content:space-between}}@media(min-width:1259px){.fxs-sidebar-is-collapsed~.fxs-portal-content .fxs-home-feature-tile-container{justify-content:space-between}}@media(min-width:1436px){.fxs-home-feature-tile-container{justify-content:space-between}}.fxs-home-feature-tile-container{padding-left:0;list-style:none;margin-top:-7px;margin-left:-7px;display:flex;flex-wrap:wrap}.fxs-home-tile-loading{display:flex;cursor:default;position:relative}.fxs-home-icon-container{display:flex;justify-content:center}.fxs-home-resource-icon{flex:0 0 auto;height:32px;width:32px;margin-bottom:9px}.fxs-home-explore-container{margin-top:-14px;margin-left:-22px;padding:0;list-style:none;display:flex;flex-wrap:wrap}.fxs-home-explore-tile{margin-top:14px;height:60px;width:253px;box-sizing:border-box;border:1px solid transparent;margin-left:10px}a.fxs-home-explore-link{display:flex;align-items:center;padding:16px 12px}a.fxs-home-explore-link:hover{text-decoration:none}.fxs-home-explore-icon{height:28px;width:28px;margin-right:18px}.fxs-home-ad-link{padding:12px;box-sizing:border-box}.fxs-home-ad-container{padding-left:0;list-style:none;margin:-17px 0 0 -22px;display:flex;flex-wrap:wrap}.fxs-home-ad-tile{height:110px;width:253px;margin-top:17px;box-sizing:border-box;border:1px solid transparent;margin-left:10px}.fxs-home-ad-icon-container{height:84px;width:36px;flex:0 0 auto}.fxs-home-ad-icon{height:36px;width:36px}.fxs-home-ad-desc{margin:4px 0;max-width:100%;overflow:hidden;height:57px}.fxs-home-ad-desc .fxs-portal-text{display:block;display:-webkit-box;line-height:19px;max-height:57px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:3;-webkit-box-orient:vertical}.fxs-home-learn-tile .fxs-home-ad-title svg{height:12px;width:12px}.fxs-sandboxexplorer-browseprojects-header,.fxs-home-recent-header,.fxs-home-favorite-header{font-weight:600}.fxs-home-grid-scrollarea{overflow-x:auto;width:100%}.fxs-sandboxexplorer-browseprojects-headerrow,.fxs-sandboxexplorer-browseprojects-row,.fxs-home-recent-row,.fxs-home-recent-headerrow,.fxs-home-favorite-row,.fxs-home-favorite-headerrow{display:grid;grid-template-columns:4fr 4fr}.fxs-home-recent-loading{position:relative;width:100%;height:224px}.fxs-home-favorite-loading{position:relative;width:100%;height:224px}.fxs-sandboxexplorer-browseprojects-row,.fxs-home-recent-row,.fxs-home-favorite-row{align-items:center;height:32px;border-top-width:1px;border-top-style:solid}.fxs-sandboxexplorer-browseprojects-row:last-of-type,.fxs-home-recent-row:last-of-type,.fxs-home-favorite-row:last-of-type{border-bottom-width:1px;border-bottom-style:solid}.fxs-sandboxexplorer-browseprojects-cell,.fxs-home-recent-cell,.fxs-home-favorite-cell{line-height:32px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-sandboxexplorer-browseprojects-cell:nth-of-type(1),.fxs-home-recent-cell:nth-of-type(1),.fxs-home-favorite-cell:nth-of-type(1){grid-column-start:1;grid-column-end:2}.fxs-sandboxexplorer-browseprojects-cell:nth-of-type(2),.fxs-home-recent-cell:nth-of-type(2),.fxs-home-favorite-cell:nth-of-type(2){grid-column-start:2;grid-column-end:3}.fxs-sandboxexplorer-browseprojects-cell:nth-of-type(3),.fxs-home-recent-cell:nth-of-type(3),.fxs-home-favorite-cell:nth-of-type(3){grid-column-start:3;grid-column-end:4}.fxs-home-recent-icon-container{height:100%;width:100%}.fxs-sandboxexplorer-browseprojects-subscriptiontext,.fxs-home-recent-link-wrapper,.fxs-home-favorite-link-wrapper,.fxs-home-recent-lastviewed,.fxs-home-recent-typenam,.fxs-home-favorite-typenamee{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-home-recent-link,.fxs-home-favorite-link{vertical-align:middle}.fxs-sandboxexplorer-browseProjects-row-icon,.fxs-home-recent-icon,.fxs-home-favorite-icon{vertical-align:middle;line-height:18px}.fxs-sandboxexplorer-browseProjects-row-icon svg,.fxs-home-recent-icon svg,.fxs-home-favorite-icon svg{width:100%;height:100%}.fxs-home-resource-icon-container{display:inline-block;height:18px;margin-right:7px;position:relative;width:18px}.fxs-home-preview-icon{bottom:0;height:10px;left:0;position:absolute;width:10px}.fxs-sandboxexplorer-browseprojects-grid,.fxs-home-recent-grid,.fxs-home-favorite-grid{width:100%;min-width:400px}.fxs-home-link:hover{text-decoration:underline}.fxs-home-linkicon{vertical-align:middle;margin-left:4px}.fxs-home-info{flex-direction:column}.fxs-home-info .fxs-home-info-content{display:flex;flex-wrap:wrap;margin-bottom:17px;margin-left:-12px;margin-right:12px}.fxs-home-info .fxs-home-title{min-width:170px}.fxs-home-info svg{height:12px;width:12px}.fxs-home-learnmore{flex:0 0 auto;max-width:789px;margin-bottom:40px}.fxs-home-mobilelinks{flex:0 0 auto}.fxs-home-learn-section{flex:0 0 calc(253px + 10px - 12px);margin-left:12px}.fxs-home-ad-content{width:100%;padding:0 11px}.fxs-home-mobilelinks>.fxs-home-mobile{display:flex}.fxs-home-mobilelinks>.fxs-home-mobile .fxs-home-mobile-img{height:34px;width:116px;padding-left:1px}.fxs-home-mobilelinks>.fxs-home-mobile .fxs-home-mobile-img:focus{outline-offset:1px}.fxs-home-mobilelinks>.fxs-home-mobile .fxs-home-mobile-img:first-of-type{margin-right:8px}.fxs-home-allservices svg{transform:rotate(90deg);width:24px}.fxs-home-resource-tabs{overflow:hidden;transition:height .3s;transition-timing-function:cubic-bezier(.8,0,.2,1);width:100%}.fxs-home-see-all{display:flex;padding-top:8px}.fxs-home-empty-icon{opacity:.5;height:50px;width:50px;margin-left:auto;margin-right:auto;margin-top:20px}.fxs-home-empty-header{margin-top:12px;text-align:center}.fxs-home-empty-text{margin-top:4px;text-align:center}.fxs-home-empty-button{margin-top:12px;text-align:center}@media(min-width:480px){.fxs-home-container,.fxs-home-fragments,.fxs-home-toggle{padding-left:32px;padding-right:32px}.fxs-sandboxexplorer-browseprojects-headerrow,.fxs-sandboxexplorer-browseprojects-row,.fxs-home-recent-row,.fxs-home-recent-headerrow,.fxs-home-favorite-row,.fxs-home-favorite-headerrow{display:grid;grid-template-columns:5fr 4fr 2fr}.fxs-sandboxexplorer-browseProjects-cell:nth-of-type(3),.fxs-home-recent-cell:nth-of-type(3),.fxs-home-favorite-cell:nth-of-type(3){display:flex}.fxs-home-recent-row .fxs-home-recent-lastviewed{display:flex}.fxs-home-section{min-width:300px}}@media(min-width:960px){.fxs-home-container,.fxs-home-fragments,.fxs-home-toggle{padding-left:64px;padding-right:64px}.fxs-home-explore-container{margin-top:-28px}.fxs-home-explore-tile{margin-top:28px}.fxs-home-info{flex-direction:row}.fxs-home-learnmore{flex:3 3 calc(3*(253px + 10px))}.fxs-home-mobilelinks{flex:1 1 calc(253px - 12px)}}.fxs-home-feature-tile-asset,.fxs-attach-hover-card,.fxs-home-recent-link-hover-card-dock{-webkit-touch-callout:none}",moduleId:e.id}})),
define("MsPortalImpl/Widgets/Widgets.AzureHome",["require","exports","MsPortalImpl/Widgets/Widgets.WidgetBase","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.AzureHome.css","Weave","MsPortalImpl/Services/Services.Subscriptions","Fx/Experimentation","MsPortalImpl/Widgets/AzHome/FreeTrial/FreeTrialConstants","FxHubs/ArtHelpers/ArtApis"],(function(e,t,s,i,o,n,r,a,l,c){"use strict";t.Widget=t.ViewModel=void 0,t.getFreeTrialSubscriptionInfo=async function(e){let t=0,s=null;const i=e.get(r.SubscriptionsUserContext),o=d.start({source:l.TelemetrySourceConstants.FREHome,action:"getAllSubscriptionsCount"}),n=await i.getAllSubscriptionsCount(),a=1===n.type?n.value:0;if(d.completeTrace(o,{count:a}),1===a){const e=d.start({source:l.TelemetrySourceConstants.FREHome,action:"getGlobalDisplayedSubscriptions"});s=(await i.getGlobalDisplayedSubscriptions())[0],d.completeTrace(e,{subscriptionId:s.subscriptionId,subscriptionQuotaId:s.subscriptionPolicies?.quotaId}),"freetrial_2014-09-01"===s.subscriptionPolicies?.quotaId?.toLowerCase()?t=["active","enabled","pastdue"].includes(s.state?.toLowerCase())?1:2:("payasyougo_2014-09-01"===s.subscriptionPolicies?.quotaId?.toLowerCase()||(s=null),t=3)}else a>1&&(t=3);return MsPortalFx.isFeatureEnabled("testtrialuser")?{count:1,subscription:null,subscriptionState:1}:{count:a,subscription:s,subscriptionState:t}},t.getPortalTrialUserPromise=async function(e){let t;const s=e.get(r.SubscriptionsUserContext),i=d.start({source:"AzureHomeTrialPage",action:"getAllSubscriptionsCount"}),o=await s.getAllSubscriptionsCount();let n=!1;if(d.completeTrace(i,{count:o}),1===o.value&&1===o.type){const e=d.start({source:"AzureHomeTrialPage",action:"getGlobalDisplayedSubscriptions"}),i=(await s.getGlobalDisplayedSubscriptions())[0];d.completeTrace(e,{subscriptionId:i.subscriptionId,subscriptionQuotaId:i.subscriptionPolicies?.quotaId}),"freetrial_2014-09-01"===i.subscriptionPolicies?.quotaId?.toLowerCase()&&["active","enabled","pastdue"].includes(i.state?.toLowerCase())&&(n=!0,t=i)}return{isTrial:MsPortalFx.isFeatureEnabled("testtrialuser")||n,freeTrialSubscription:t}},t.getResourcesCount=async function(e){let t=-1;const s=d.start({source:`AzureHome.${e}`,action:"getResourcesCount"}),i=e=>{d.endTrace(s,"failed",{errorThrown:e})},o={query:"resources | count",options:{$top:1}};let n;try{n=await(0,c.getDataFromArt)(o,"AzureHome.getResourcesCount",1,{apiVersion:"2021-03-01"})}catch(e){return i(MsPortalFx.getLogFriendlyMessage(e)),t}const r=MsPortalFx.convertArrayToMap(n?.data?.columns||[],(e=>e.name),((e,t)=>t));if(!Object.keys(r).length){return i("Response from ARG contained no columns"),t}const a=n?.data?.rows||[];if(1!==a.length){return i(`Response from ARG for resource count contained ${a.length} rows (expect 1)`),t}const l=r.Count;if(MsPortalFx.isNullOrUndefined(l)){return i("Unable to find row index for column 'Count' in response from ARG for resource count"),t}return t=a[0][l],d.completeTrace(s,t),t},(0,i.injectCss)(o);var d=MsPortalFx.Base.Diagnostics.Telemetry;class p extends s.ViewModel{constructor(e,t){super(),this.openRoute=e,this.trialTiles=(0,n.makeArrayComputation)(),this.portalTrialUser=(0,n.makeWritableComputation)(),this.showTrialLandingUpgradeExperience=(0,n.makeWritableComputation)(!1),this.enableCreditsRemaining=MsPortalFx.isFeatureEnabled("triallandingremainingcredits")||t.get(a.Experimentation).shellAssignments.getBooleanValue("triallandingremainingcredits")}}t.ViewModel=p;class u extends s.Widget{constructor(e,t,s){super(e,t)}}t.Widget=u})),
define("MsPortalImpl/Widgets/Widgets.ContextMenu",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Base/Base.Events","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip","MsPortalImpl/Widgets/Widgets.WidgetBase","WeaveDOM/DirectRender/DataAttribute","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css"],(function(e,t,s,i,o,n,r,a,l,c,d,p){"use strict";t.Widget=t.ViewModel=void 0;var u=s;(0,d.injectCss)(p);var m=MsPortalFx.Base.Diagnostics;const g=window,h=m.createLog(e),f="fxs-contextMenu",x="fxs-contextMenu-active",b="fxs-contextMenu-item",y="fxs-popup",v="fxs-portal-bg-txt-br",w="msportalfx-shadow-level2",M=u.tsx(s.Root,null,u.tsx("ul",{role:"menu",class:"fxs-contextMenu-itemList","data-bind":{attr:{"aria-label":"ariaLabel"}}},u.tsx(s.KoForEach,{items:"commands"},u.tsx("li",{role:"menuitem",class:"fxs-contextMenu-item msportalfx-command-like-button",tabindex:"0","data-bind":{css:{"fxs-portal-hover":"enabled","fxs-contextMenu-itemDisabled msportalfx-command-like-button-disabled":"!enabled()","fxs-contextMenu-extensioncommand":"!!$data._extension"},attr:{title:"$data.tooltip()","aria-disabled":"!enabled()","aria-label":"ariaLabel","aria-posinset":"$index() + 1","aria-setsize":"$parent.commands().length"}}},u.tsx("div",{class:"fxs-contextMenu-icon","data-bind":{image:"icon"}}),u.tsx("div",{class:"fxs-contextMenu-text msportalfx-text-ellipsis","data-bind":{text:"text"}})))));function C(e,t){return t||h.error(`ContextMenuViewModel.${e} is not accessible. Please call registerForCleanup first.`),t}function S(e){return e.isShellCommand}class I extends l.ViewModel{constructor(){super(),this.visible=ko.observable(!1),this.menuItems=ko.observableArray(),this.topOffsetCorrection=0}getOrderedMenuItemsCommandsComputed(){return C("orderedMenuItemsCommands",this._orderedMenuItemsCommands)}getOrderedMenuItemsComputed(){return C("orderedMenuItems",this._orderedMenuItems)}get hasVisibleCommands(){return C("hasVisibleCommands",this._hasVisibleCommands)}registerForCleanup(e){const t=this.menuItems,s=this._ltm=e.createChildLifetime(),i=this._orderedMenuItemsCommands=t.filter(s,(e=>e.visible()&&!S(e)&&!e.hasPopup())),o=this._orderedMenuItems=t.filter(s,(e=>e.visible()&&S(e)&&e.enabled()));this._hasVisibleCommands=ko.computed(s,(()=>i().length+o().length>0)),s.registerForDispose((()=>{this._ltm=this._orderedMenuItemsCommands=this._orderedMenuItems=this._hasVisibleCommands=null}))}}t.ViewModel=I;class P extends l.Widget{constructor(e,t,s){super(e,t),this._newRenderFlag=s,this._lastShowArgs=ko.observable(null);const i=this.ltm,r=e=>{const t=this.element[0];return t===e||$.contains(t,e)?0:2},a={dismissFn:()=>{this.hide()},shouldDismissOnMouseDownFn:r,shouldDismissOnMouseWheelFn:r,logName:"contextmenu"};s||(t.registerForCleanup(i),e.html(M).addClass(`${f} ${y} ${v} ${w}`),this._bindDescendants({ariaLabel:o.ContextMenu.ariaLabel,commands:ko.explicitComputed(i,[t.getOrderedMenuItemsComputed(),t.getOrderedMenuItemsCommandsComputed()],((e,t)=>e.concat(t)))}));const l=new MutationObserver((()=>this.updateRenderedPositionFromLastShow()));l.observe(e.find(".fxs-contextMenu-itemList")[0],{childList:!0}),i.registerForDispose((()=>l.disconnect())),this._initializeHandlers(),t.visible.subscribeAndRun(i,(e=>{const t=this.element,s=this._lastShowArgs.peek();if(e){const e=t.find("[role=menu]").attr("id");s?.ariaControls?.(e),s?.ariaExpanded?.(!0);const i=document.activeElement;a.restoreFocus=()=>{n.validatePreviousFocusedElement(a,i)&&i.focus()},t.css(this._ensureInViewPort(this._lastShowArgs())).addClass(x),this.setFocus(),n.register(a)}else s?.ariaControls?.(null),s?.ariaExpanded?.(!1),this._lastShowArgs(null),t[0].contains(document.activeElement)&&a.restoreFocus&&a.restoreFocus(),t.removeClass(x),n.unregister(a)}))}dispose(){this.hide(),this._cleanElement(f,y,v,w),super.dispose()}hide(){this.options.visible(!1)}show(e=0,t=0,s=!1,o,n){i.isFullscreen()?this.hide():(this._lastShowArgs({xCoord:e,yCoord:t,forceLeft:s,ariaExpanded:o,ariaControls:n}),this.options.visible(!0))}updateRenderedPositionFromLastShow(){const e=this._lastShowArgs();e&&this.element.css(this._ensureInViewPort(e))}setFocus(){Promise.resolve().then((()=>{this.element.find("[tabindex=0]:first-of-type").focus()}))}_initializeHandlers(){const e=this.element,t=this.ltm,s=e=>{if(e.stopPropagation(),e.preventDefault(),$(e.currentTarget).hasClass("fxs-contextMenu-itemDisabled"))return;this.hide();const t=this._newRenderFlag?(0,c.getElementData)(e.currentTarget):ko.dataFor(e.target);t&&t.enabled()&&t.execute(!0)};new r.KeyboardNavigation(this.ltm,{element:e}),a.register(e),ko.computed(t,(()=>{this._lastShowArgs()&&(this.options.menuItems().forEach((e=>{e.enabled()})),this.updateRenderedPositionFromLastShow())})),t.registerForDispose([()=>{a.unregister(e)},e.setEvents(["contextmenu",e=>!1]),e.find("ul").setEvents(["click",`.${b}`,s],["keydown",`.${b}`,e=>{13===e.which&&s(e)}])])}_ensureInViewPort(e){const{xCoord:t,yCoord:s,forceLeft:i}=e;let o=s,n="auto";const r=this.element,a=r.outerHeight(),l=r.outerWidth();this._isRtl()?(n=t-l,(i||n-l<0)&&(n+=l,o+=this.options.topOffsetCorrection)):(n=t,(i||n+l>g.innerWidth)&&(n-=l,o+=this.options.topOffsetCorrection));const c=g.innerHeight;return o+a>c&&(o-a>=0?o-=a:o=a<c?MsPortalFx.truncate((c-a)/2):0,o+=this.options.topOffsetCorrection),{top:o,left:n}}}t.Widget=P})),
define("MsPortalImpl/Interactions/Interactions.PortalReader",["require","exports"],(function(e,t){"use strict";t.PortalReader=void 0;const s=document;if(!s.getElementById("PortalReader")){s.body.appendChild(FxImpl.createElement("div",{id:"PortalReader",class:"fxs-hide-accessible-label","aria-atomic":"false","aria-live":"polite"}))}const i=s.getElementById("PortalReader");t.PortalReader=class{constructor(e,t){this._nextId=MsPortalFx.getUniqueIdGenerator(t?.idPrefix);const s=t?.removalDelayMs>=0?t?.removalDelayMs:6e4;this._expirationDelayMs=t?.expirationDelayMs>=0?t?.expirationDelayMs:2e4;const o=this._liveRegion=FxImpl.createElement("div",{id:this._nextId(),class:"fxs-hide-accessible-label","aria-live":"polite","aria-atomic":"false","aria-relevant":"additions"});i.appendChild(o),e.registerForDispose((()=>{setTimeout((()=>{i.removeChild(o)}),s)}))}read(e){const t=FxImpl.createElement("div",{id:this._nextId()});t.textContent=e,this._liveRegion.appendChild(t),setTimeout((()=>{t.remove()}),this._expirationDelayMs)}}})),
define("MsPortalImpl/Widgets/Widgets.UIElementBase",["require","exports","MsPortalImpl/Widgets/Widgets.WidgetBase"],(function(e,t,s){"use strict";t.Widget=t.ViewModel=void 0;const i="Not implemented in base class.";class o extends s.ViewModel{constructor(e){super(),this.locked=ko.observable(!0),this.id=e}getViewSettings(){throw new Error(i)}applyViewSettings(e){throw new Error(i)}}t.ViewModel=o;const n=new WeakMap;class r extends s.Widget{constructor(e,t,s=!1){if(super(e,t,s),!t.id||"string"!=typeof t.id)throw new Error("An unique identifier is required and it must be a string.");r.attachId(e,t.id)}dispose(){r.detachId(this.element),super.dispose()}static attachId(e,t){const s=e[0];s&&n.set(s,t)}static detachId(e){const t=e[0];t&&n.delete(t)}static getId(e){const t=e[0];return t&&n.get(t)}addChild(e){throw new Error(i)}insertChild(e,t){throw new Error(i)}removeChild(e){throw new Error(i)}moveChild(e,t,s,o){throw new Error(i)}saveViewSettings(){throw new Error(i)}setSize(e,t){throw new Error(i)}discardStateOfUnusedChildren(){return{stateDiscarded:!1}}}t.Widget=r,r.viewSettingsChanged="viewSettingsChanged"})),
define("MsPortalImpl/Widgets/Widgets.ContextPane",["require","exports","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.BrowserDetection","Weave","Fx/Experimentation","FxInternal/AsyncLoader","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u){"use strict";t.Widget=t.ViewModel=void 0;var m=MsPortalFx.Base.Diagnostics.Telemetry;(0,p.injectCss)(u);const g="fxs-react-contextpane",h="fxs-contextpane-content",f="fxsContextPaneTitle",x=$(document),b=window;class y extends i.ViewModel{constructor(e){super("fxs-contextpane-identifier"),this.diContainer=e,this.opened=(0,l.makeWritableComputation)(!1),this.loading=(0,l.makeWritableComputation)(!1),this.enableResize=(0,l.makeWritableComputation)(!1),this.hideExpandButton=(0,l.makeWritableComputation)(!0),this.openedFromTopBar=(0,l.makeWritableComputation)(!1),this.childElementCount=(0,l.makeWritableComputation)(0),this.enableFullScreenResize=!1,this.close=MsPortalFx.noop}setWidget(e){this._widget=e}getWidget(){return this._widget}getRootElement(){return this._widget.element}}t.ViewModel=y;class v extends i.Widget{constructor(e,t){super(e,t,!0),this._prewarmContextPanes=!1,this._announce=new n.PortalReader(this.ltm,{idPrefix:"contextpane"}),this._screenMaxResize=920,t.setWidget(this),this._$progress=$(e[0].querySelector(".fxs-contextpane-loadindicator"));const s=this.element.find(".fxs-portal-contextpane-docked-resize-curtain"),i=this.element.find(".fxs-portal-contextpane-docked-resize-splitter");(0,l.subscribe)(this.ltm,[t.loading],(e=>{e?this._announce.read(r.Shell.Reader.contextPaneLoading):this._announce.read(r.Shell.Reader.contextPaneReady)})),(0,l.subscribe)(this.ltm,[t.opened],(e=>{e||this._announce.read(r.Shell.Reader.contextPaneClosed)})),(0,l.subscribe)(this.ltm,[t.enableResize],(t=>{t?(s.removeClass("fxs-display-none"),i.removeClass("fxs-display-none"),$(s).attr({"aria-label":r.ContextPane.Resize.ariaLabel,"aria-valuenow":e.width().toString(),"aria-valuemin":this.getContextPaneWidth().toString(),"aria-valuemax":this._screenMaxResize<b.innerWidth?this._screenMaxResize.toString():b.innerWidth.toString()})):s.addClass("fxs-display-none")})),t.diContainer.get(c.Experimentation).shellAssignments.whenAvailable().then((e=>this._prewarmContextPanes=e.getBooleanValue("PrewarmContextPanes"))),s.on("mousedown",(t=>{const o=t.clientX,n=e.width();let r,a,l=!1;i.css("pointerEvents","all"),x.on("mousedown",(e=>{e.preventDefault(),l=!0,this._setScreenMaxResize()})).on("mousemove",a=t=>{if(t.preventDefault(),s.css("cursor","col-resize"),l){l=!1;const s=n+o-t.clientX;l=this._resizeContextPane(e,s)}}).on("mouseup",r=()=>{m.trace({source:"Shell",action:"SideCarResized",data:{eventType:"mousemove",resizedWidth:e.width().toString()}}),s.attr("aria-valuenow",e.width().toString()),i.css("pointerEvents","none"),x.off("mousemove",a),x.off("mouseup",r),l=!1})})),s.on("keydown",(t=>{if(!(t.ctrlKey||t.altKey||t.shiftKey||37!==t.keyCode&&39!==t.keyCode&&36!==t.keyCode&&35!==t.keyCode&&13!==t.keyCode)){let i=e.width();switch(this._setScreenMaxResize(),t.keyCode){case 37:i=e.width()+20;break;case 39:i=e.width()-20;break;case 36:i=this.getContextPaneWidth();break;case 35:i=this._screenMaxResize;break;case 13:i=e.width()===this.getContextPaneWidth()?this._screenMaxResize:this.getContextPaneWidth()}if(i!==e.width()){this._resizeContextPane(e,i)&&(t.stopPropagation(),s.attr("aria-valuenow",e.width().toString()))}}})).on("keyup",(t=>{m.trace({source:"Shell",action:"SideCarResized",data:{eventType:"keydown",resizedWidth:e.width().toString()}})}))}dispose(){this._cleanElementClasses([g]),this._disposeHandler(),super.dispose()}hasContent(){return!!this._$content}addChild(e){this._addChild(e)}insertChild(e,t){this._addChild(e,t)}_addChild(e,t){if(!e)throw new Error("Can't add null child.");if($(b).on("resize",this._resizeWindowHandler=()=>{const e=$.querySelectorAll(".fxs-portal-region")?.find(".fxs-portal-contextpane-docked.fxs-contextpane-visible");if(e?.length>0){const t=this._currentViewPortWidth();if(e.hasClass("fxs-contextpane-docked-maximized")){const s=t-this.getDockedSideBarWidth();e.width(s)}else(t<1280||t>=1280&&e.width()<this.getContextPaneWidth())&&e.width(this.getContextPaneWidth())}}),this._prewarmContextPanes&&async function(e,t){if(!t)return!1;const s=t.name;let i=s?.toLowerCase().endsWith(".ReactView".toLowerCase());if(i)return!0;if(!s?.toLowerCase().endsWith("_dx"))return!1;const[n,r]=await Promise.all([d.get("MsPortalImpl/Extension/DxDefinitionCache","getRuntimeBlade"),e.getAsync(o.ExtensionManagerOptions)]),a=t.extensionName,l=r.getNormalizedMetadata(a,!0),c=await n(e,l,s);return i=c?.bladeName?.toLowerCase().endsWith(".ReactView".toLowerCase()),i}(this.options.diContainer,e.options?.bladeName).then((e=>{this.element.toggleClass(g,e)})),this._setScreenMaxResize(),this.hasContent()&&!t&&this.removeChild(null),t>=0){const e=$(this._getChildElement()[t-1]);e&&e.addClass("fxs-display-none")}const i=this._$content=e.element?e.element:e;i.addClass(h).insertBefore(this._$progress),s.waitForReactElement(i[0],".fxs-contextpane-title, .fxs-blade-title-titleText").then((e=>{const t=e.attr("id");t?this.element.attr("aria-labelledby",t):(this.element.attr("aria-labelledby",f),e.attr("id",f))})),this.options.hideExpandButton(!i.hasClass("fxs-partgallery-container")),this.options.childElementCount(this.options.childElementCount.value+1)}_resizeContextPane(e,t){return this._currentViewPortWidth()<1280&&(t=this.getContextPaneWidth()),t<this.getContextPaneWidth()?t=this.getContextPaneWidth():t>this._screenMaxResize&&(t=this._screenMaxResize),e.width(t),e.addClass("fxs-contextpane-docked-resized"),!0}_setScreenMaxResize(){this.options.enableFullScreenResize&&(this._screenMaxResize=this._currentViewPortWidth()-this.getDockedSideBarWidth())}removeChild(e,t){const s=this._$content;if(!s)return!0;t?s.detach():s.remove(),s.removeClass(h);const i=this.options.childElementCount;if(i(Math.max(i.value-1,0)),i.value>0){const e=$(this._getChildElement()[i.value-1]);e.removeClass("fxs-display-none"),this._$content=e}else this._$content=null;return this._disposeHandler(),!0}clear(){return this.removeChild(null)}setFocus(){if(!a.isAndroidOrMobile){const e=this._$content;e&&s.waitForBindings(this.element[0]).then((()=>{let t;const s=e.find(".fxs-blade-content-container");s&&(t=s.findFirstTabbable()),s&&0!==t.length||(t=e.findFirstTabbable()),0!==t.length&&t.focus()}))}}getBladeHost(e,t){return MsPortalFx.require("MsPortalImpl/Widgets/Widgets.Blade").then((s=>{const i=new s.ViewModel(MsPortalFx.getUniqueId(),this.options.diContainer);i.title(t.title),i.defaultContent.title(t.title),i.defaultContent.bladeStyle(4),i.defaultContent.bladeWidth(t.bladeWidth),i.defaultContent.reflowReady(!0);const o=s.createBladeWidget($(FxImpl.createElement("section")),i,this.ltm);return o.initializeLayout(),o.getContentWidget().initializeLayout(),o.getContentWidget().addChild(e),i.loaded(!0),i.defaultContent.loaded(!0),i.close=e=>{this.options.close(e)},o}))}getContextPaneWidth(){return this._currentViewPortWidth()>1280?480:320}getDockedSideBarWidth(){const e=$.querySelectorAll(".fxs-sidebar-collapse-button");if(e.length>0){const t=e.width();if(t&&t>0)return t}const t=$.querySelectorAll(".fxs-sidebar-leftnav-container");if(t.length>0){const e=t.width();if(e&&e>0)return e}return 0}_currentViewPortWidth(){return $.querySelectorAll(".fxs-portal-region")?.width()||b.innerWidth}_getChildElement(){return this.element.children(".fxs-contextpane-content")}_disposeHandler(){this._resizeWindowHandler&&($(b).off("resize",this._resizeWindowHandler),this._resizeWindowHandler=null)}}t.Widget=v})),
define("MsPortalImpl/Widgets/Widgets.Portal.State",["require","exports","Fx/DependencyInjection","Weave"],(function(e,t,s,i){"use strict";t.PortalState=void 0;let o=t.PortalState=class{constructor(){this.displayMode=(0,i.makeWritableComputation)("None"),this.inOrganizeMode=ko.observable(!1),this.settingsFlyoutState=(0,i.makeWritableComputation)(0)}};t.PortalState=o=__decorate([__metadata("fx:diagnostics",[e,"PortalState"]),s.Class()],o)})),
define("MsPortalImpl/Widgets/Widgets.ContextMenu.Component",["require","exports","Weave/DirectMode","MsPortalImpl/Resources/ImplScriptResources","Weave","FxInternal/Weave","FxInternal/Weave/Util"],(function(e,t,s,i,o,n,r){"use strict";function a(e){return e+1}t.ContextMenu=function(e){const{vm:t,className:l}=e,c=(0,o.composeComputation)([(0,n.toComputation)(t.getOrderedMenuItemsComputed()),(0,n.toComputation)(t.getOrderedMenuItemsCommandsComputed())],((e,t)=>e.concat(t)));return s("div",{className:["fxs-contextMenu","fxs-popup","fxs-portal-bg-txt-br","msportalfx-shadow-level2","msportalfx-unselectable",l]},s("ul",{role:"menu",className:"fxs-contextMenu-itemList","aria-label":i.ContextMenu.ariaLabel},s(o.ForEach,{collection:c,fn:({item:e,index:t,length:i})=>{const o=(0,n.toComputation)(e.enabled),l=o.compose(r.negation),c=t.compose(a);return s("li",{role:"menuitem",className:["fxs-contextMenu-item msportalfx-command-like-button",{"fxs-portal-hover":o,"fxs-contextMenu-itemDisabled":l,"msportalfx-command-like-button-disabled":l,"fxs-contextMenu-extensioncommand":e._extension}],tabindex:"0",title:(0,n.toComputation)(e.tooltip),"aria-disabled":l,"aria-label":(0,n.toComputation)(e.ariaLabel),"aria-posinset":c,"aria-setsize":i,data:e},s("div",{className:"fxs-contextMenu-icon",image:(0,n.toComputation)(e.icon)}),s("div",{className:"fxs-contextMenu-text"},(0,n.toComputation)(e.text)))}})))}})),
define("MsPortalImpl/Widgets/Widgets.ContextPane.Component",["require","exports","Weave/DirectMode","FxInternal/Weave/Components/LoadingIndicator"],(function(e,t,s,i){"use strict";t.ContextPane=function(e){const{vm:t,className:o}=e,n=t.opened,r=t.loading;return s("div",{className:["fxs-contextpane fxs-portal-bg-txt-br az-noprint",o,{"fxs-contextpane-visible":n,"fxs-contextpane-loading":r}],role:"complementary","aria-labelledby":"fxsContextPaneTitle"},s("div",{className:"fxs-contextpane-loadindicator"},s(i.LoadingIndicator,null)),s("div",{className:"fxs-portal-contextpane-docked-resize-curtain fxs-display-none",role:"separator",tabindex:"0"}),s("div",{className:"fxs-portal-contextpane-docked-resize-splitter fxs-display-none"}))}})),
define("MsPortalImpl/Services/Services.MenusManager",["require","exports","Fx/DependencyInjection","FxHubs/RpcEndPoints","FxInternal/AsyncLoader","MsPortalImpl/Extension/Extension.Manifest","Fx/Experimentation","MsPortalImpl/Extension/ExtensionRpc.Manifest","Fx/Ajax"],(function(e,t,s,i,o,n,r,a,l){"use strict";t.getBrowseMenuHandler=t.MenusManager=t.DEV=void 0,t.getMenuGlobalUniqueId=d,t.getMenuHandler=void 0;const c=MsPortalFx.Base.Diagnostics.createLog(e);function d(e,t){return`${e}::${t}`}let p=t.MenusManager=class{constructor(e,t,s){this._manifestCache=e,this._diContainer=t,this._experimentation=s,this._cachedMenus={},this._cachedBrowseMenus={}}async isOps360Enrolled(){if(!this._experimentation.shellAssignments.getBooleanValue("servicemenucheckops360enrollment"))return!0;try{const e=this._experimentation.shellAssignments.getStringValue("ops360enrollmentapiversion")||"2025-09-01-preview",t=await(0,l.batch)({type:"GET",uri:`/providers/Microsoft.PortalServices/settings/default?api-version=${e}`,setTelemetryHeader:"FetchOps360EnrollmentStatus"});return"Approved"===t.content?.properties?.ops360Settings?.status}catch(e){return c.error("Failed to fetch Ops360 enrollment status.",e),!1}}async getAllServiceMenus(){const e={};return await this._manifestCache.getManifests("browseMenus",((t,s)=>{for(const i of s?.browseMenus||[]){const s=d(t,i.name),o=async()=>{const e=await u(t,i,this._diContainer);if(e){if(s===d(MsPortalFx.getFeatureValue("OverrideOps360ExtensionName")||"Microsoft_Azure_Ops360","Ops360")){await this.isOps360Enrolled()||(e.items=[],e.groups=[])}this._cachedBrowseMenus[s]={rawServiceMenuManifest:i,serviceMenuManifest:e,extension:t,globalId:s}}};e[s]=o()}})),await Promise.all(Object.values(e)),this._cachedBrowseMenus}async getServiceMenu(e){const t=d(e.extensionName,e.menuId);return this._cachedBrowseMenus[t]||await this.getAllServiceMenus(),this._cachedBrowseMenus[t]}async getAllMenus(){const e={};return await this._manifestCache.getManifests("menus",((t,s)=>{for(const i of s?.menus||[]){const s=d(t,i.name);e[s]=u(t,i,this._diContainer)?.then((e=>{this._cachedMenus[s]=e}))}})),await Promise.all(Object.values(e)),this._cachedMenus}async getMenu(e){const t=d(e.extensionName,e.menuId);if(this._cachedMenus[t])return this._cachedMenus[t];const s=(await this._manifestCache.getManifestAsync(e.extensionName,"menus")).menus.find((t=>t.name===e.menuId));if(!s)throw new Error(`Menu with id ${e.menuId} not found in manifest.`);return this._cachedMenus[t]=await u(e.extensionName,s,this._diContainer),this._cachedMenus[t]}};async function u(e,t,s){if(!t)return null;const i={...t};if(i.overview){const t=await m(e,i.overview,s);i.overview=t}if(i.items?.length){const t=[];for(const o of i.items){const i=await m(e,o,s);i&&t.push(i)}i.items=t}if(i.groups?.length){const t=[];for(const o of i.groups){const i={...o};if(i.items?.length){const t=[];for(const o of i.items){const i=await m(e,o,s);i&&t.push(i)}i.items=t}i.items?.length&&t.push(i)}i.groups=t}return i.items?.length||i.groups?.length||i.overview?i:null}async function m(e,t,s){if(!("fx.experiment"in t)&&!("fx.feature"in t))return t;const i="fx.experiment"in t,o=i?t["fx.experiment"]:t["fx.feature"],n=o.name;let l;if(i){const e=s.get(r.Experimentation).shellAssignments;l=e?.getStringValue(n)||""}else{const t=await async function(e,t){const s=await(0,a.getExtensionConfiguration)(e,t),i=s?.features||{};return i}(s,e);l=t[n]?.toString()||""}const c=o.value||"";if("replaceWhen"in o){if(g(o.replaceWhen,c,l))return o.replacement}else if("includeWhen"in o){if(!g(o.includeWhen,c,l))return null}return t}function g(e,t,s){const i=s.toString();switch(e){case"Enabled":return"true"===i.toLowerCase();case"Disabled":return"true"!==i.toLowerCase();case"ValueEquals":return i===t;case"ValueNotEquals":return i!==t;default:return!1}}t.MenusManager=p=__decorate([__metadata("fx:diagnostics",[e,"MenusManager"]),s.Class(),__metadata("design:paramtypes",[n.ManifestCache,s.Container,r.Experimentation])],p);t.getBrowseMenuHandler=(0,o.defineHandler)(i.Menus.getBrowseMenuEndpoint,(({diContainer:e,messageArg:t})=>e.get(p).getServiceMenu({extensionName:t.extensionName,menuId:t.menuId}).then((e=>e.serviceMenuManifest)))),t.getMenuHandler=(0,o.defineHandler)(i.Menus.getMenuEndpoint,(({diContainer:e,messageArg:t})=>e.get(p).getMenu({extensionName:t.extensionName,menuId:t.menuId})))})),
define("MsPortalImpl/Services/Services.PortalServicesManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/Extension.Manifest","FxInternal/AsyncLoader","FxHubs/RpcEndPoints","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Extension/ExtensionRpc.Manifest","Fx/Experimentation"],(function(e,t,s,i,o,n,r,a,l){"use strict";t.getPortalServiceHandler=t.PortalServicesManager=t.DEV=void 0;const c=MsPortalFx.Base.Diagnostics.createLog(e);function d(e,t){return`${e}::${t}`}const p={};let u=t.PortalServicesManager=class{constructor(e,t,s){this._diContainer=e,this._manifestCache=t,this._assetTypeService=s,this._initializedAllPortalServices=!1,this._cachedPortalServices={}}async getPortalServiceVisibilityUnderHub(e){const t=this._diContainer.get(l.Experimentation).shellAssignments,s={};try{const i=await async function(e,t){if(p[t])return p[t];const s=await(0,a.getExtensionConfiguration)(e,t),i=s?.serviceMenuOptions||{};return p[t]=i,i}(this._diContainer,e.extensionName),o=i?.[e?.portalServiceManifest?.name]?.[e?.serviceHubId];"string"==typeof o?.showInAllServices?s.showInAllServices=t.getBooleanValue(`serviceMenuOptions-${e.extensionName}-${o.showInAllServices}`,"AzurePortal"):"boolean"==typeof o?.showInAllServices&&(s.showInAllServices=o.showInAllServices),"string"==typeof o?.showInGlobalSearch?s.showInGlobalSearch=t.getBooleanValue(`serviceMenuOptions-${e.extensionName}-${o.showInGlobalSearch}`,"AzurePortal"):"boolean"==typeof o?.showInGlobalSearch&&(s.showInGlobalSearch=o.showInGlobalSearch)}catch(t){c.error(`Failed to get portal service visibility for ${e.globalId}. Error: ${JSON.stringify(t)}`),s.showInAllServices=!1,s.showInGlobalSearch=!1}return s}async getAllPortalServices(){try{if(this._initializedAllPortalServices)return this._cachedPortalServices;await this._assetTypeService.assetTypesComplete;const e={};await this._manifestCache.getManifests("portalServices",((t,s)=>{for(const i of s?.portalServices||[]){const s=d(t,i.name);e[s]=this.getPortalServiceFromManifest(t,i).then((e=>{this._cachedPortalServices[s]=e}))}})),await Promise.all(Object.values(e)),this._initializedAllPortalServices=!0}catch(e){c.error(`Failed to get all portal services. Error: ${JSON.stringify(e)}`)}return this._cachedPortalServices}async getPortalService(e){await this.getAllPortalServices();const t=this._cachedPortalServices[d(e.extensionName,e.portalServiceId)];return t||c.error(`Portal service not found for extension ${e.extensionName} and portal service id ${e.portalServiceId}`),t}async getPortalServiceFromManifest(e,t){let s,i,o,n;if("defaultBlade"in t&&t.defaultBlade)n={name:t.defaultBlade.name,extension:t.defaultBlade.extension||e,parameters:t.defaultBlade.parameters};else if("defaultBrowse"in t&&t.defaultBrowse){const a=t.defaultBrowse;if(a.includes("::")){const t=a.split("::"),l=t[0],c=t[1];i=t[2],o=this._assetTypeService.getAssetType(l,c);if(s="browseallresources"===o.assetTypeManifest.name?.toLowerCase()?r.lowerCaseAllResourcesType:o.assetTypeManifest.resourceType?.resourceTypeName,s){const t=await this._assetTypeService.getBrowseBladeReference({resourceType:s,kind:i});n={name:t.blade,extension:t.extension||e,parameters:{resourceType:s,kind:i,...t.parameters}}}else{n=function(e){const t=e.split("?")[0].split("/");let s="";if(!t.length||t.length<3)return null;t.length>3&&"~"===t[3]&&t.splice(3,1);t.length%2!=1&&(s=t[t.length-1],t.pop());const i=t[1].trim(),o=t[2].trim(),n={};for(let e=3;e<t.length;e+=2)n[t[e]]=decodeURIComponent(t[e+1]);s&&(n.menuid=s);return{name:o,extension:i,parameters:n}}(this._assetTypeService.getAssetTypeDeepLink(o,i))}}}return{extensionName:e,globalId:d(e,t.name),portalServiceManifest:t,bladeReference:n,assetType:o,kind:i,assetId:o&&(0,r.getAssetId)(e,o.assetTypeManifest?.name,i),resourceType:s}}};t.PortalServicesManager=u=__decorate([__metadata("fx:diagnostics",[e,"PortalServicesManager"]),s.Class(),__metadata("design:paramtypes",[s.Container,i.ManifestCache,r.AssetTypeService])],u);t.getPortalServiceHandler=(0,o.defineHandler)(n.PortalServices.getPortalServiceEndpoint,(async({diContainer:e,messageArg:t})=>{const s=await e.get(u).getPortalService({extensionName:t.extensionName,portalServiceId:t.portalServiceId});return{portalServiceManifest:s?.portalServiceManifest,bladeReference:s?.bladeReference}}))})),
define("MsPortalImpl/Services/Services.ServiceHubsManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.PortalServicesManager","MsPortalImpl/Services/Services.MenusManager","MsPortalImpl/Services/Services.BrowseCuration","MsPortalImpl/Extension/ExtensionRpc.Manifest","Fx/Experimentation"],(function(e,t,s,i,o,n,r,a){"use strict";t.ServiceHubsManager=void 0,t.getEnabledServiceHubsFromCuration=c;const l=MsPortalFx.Base.Diagnostics.createLog(e);async function c(e){try{const t=await(0,n.getBrowseCuration)({diContainer:e,applyServiceHubVisibility:!0});return t.categories.reduce(((e,t)=>(t.serviceHubs?.forEach((t=>{e.add((0,o.getMenuGlobalUniqueId)(t.extensionName,t.serviceMenuId))})),e)),new Set)}catch(e){return l.warning(`Error retrieving enabled service hubs from curation: ${e}`),new Set}}let d=t.ServiceHubsManager=class{constructor(e,t,s,i){this._portalServicesManager=e,this._menusManager=t,this._diContainer=s,this._experimentation=i}async getAllServiceHubs(){let e={};try{e=await this._menusManager.getAllServiceMenus()}catch(e){l.error(`Error retrieving all service menus. Error: ${JSON.stringify(e)}`)}const t=await c(this._diContainer),s=[];for(const i of Object.keys(e)){const o=e[i],n=o.serviceMenuManifest.name,r=o.extension,a=o.serviceMenuManifest,c=[a.overview,...a.items,...a.groups.flatMap((e=>e.items))],d=[];for(const e of c){if("portalService"in e&&e.portalService){const s=e.portalService;try{const o=await this._portalServicesManager.getPortalService({extensionName:s.extension||r,portalServiceId:s.name});o&&d.push({...o,menuUri:`#view/HubsExtension/ServiceMenuBlade/extension/${r}/menuId/${n}/itemId/${e.id}`,serviceHubId:i,serviceHubDisplayName:a.display,isEnabled:t.has(i)})}catch(t){l.error(`Error retrieving portal service for menu item ${e.id}:`,t)}}if("tabItems"in e&&e.tabItems){const s=e.tabItems;for(const e of s)if("portalService"in e&&e.portalService){const s=e.portalService;try{const o=await this._portalServicesManager.getPortalService({extensionName:s.extension||r,portalServiceId:s.name});o&&d.push({...o,menuUri:`#view/HubsExtension/ServiceMenuBlade/extension/${r}/menuId/${n}/itemId/${e.id}`,serviceHubId:i,serviceHubDisplayName:a.display,isEnabled:t.has(i)})}catch(t){l.error(`Error retrieving portal service for tab menu item ${e.id}:`,t)}}}}await Promise.all(d.map((async e=>{const t=await this._portalServicesManager.getPortalServiceVisibilityUnderHub(e);e.showInAllServices=t.showInAllServices,e.showInGlobalSearch=t.showInGlobalSearch}))),s.push({globalId:i,menuUri:`#view/HubsExtension/ServiceMenuBlade/extension/${r}/menuId/${n}`,portalServices:d,serviceMenuManifest:a})}return s}async getServiceHubCurationStatus(e){const t=await(0,n.getBrowseCuration)({getRawCuration:!0}),s={};for(const i of t.categories)for(const t of i.serviceHubs||[]){const n=(0,o.getMenuGlobalUniqueId)(t.extensionName,t.serviceMenuId);e.includes(n)&&(s[n]||(s[n]=[]),s[n].push(i.id))}return s}async getServiceHubEnabledStatus(e){const t=await(0,r.getAllExtensionFeatures)(this._diContainer),s=this._experimentation.shellAssignments,i={};for(const o of e){const[e,r]=o.split("::"),a=(0,n.isHubEnabled)({extensionName:e,serviceMenuId:r},s,t);i[o]=a}return i}async getHubServicesVisibility(e){const t=(await this.getAllServiceHubs()).reduce(((e,t)=>(e[t.globalId]=t,e)),{}),s={};for(const i of e){const e=t[i];if(e){s[i]={};for(const t of e.portalServices)s[i][t.globalId]={showInAllServices:t.showInAllServices||!1,showInGlobalSearch:t.showInGlobalSearch||!1}}}return s}async getAllServiceMenus(e){const t=MsPortalFx.clone(await this._menusManager.getAllServiceMenus());if(e?.includeServiceHubCurationStatus){const e=await this.getServiceHubCurationStatus(Object.keys(t));for(const s of Object.keys(t))t[s].serviceHubCurationStatus=e[s]||[]}if(e?.includeServiceHubEnabledStatus){const e=await this.getServiceHubEnabledStatus(Object.keys(t));for(const s of Object.keys(t))t[s].serviceHubEnabledStatus=e[s]}if(e?.includeServiceHubServiceVisibilityStatus){const e=await this.getHubServicesVisibility(Object.keys(t));for(const s of Object.keys(t))t[s].serviceHubServiceVisibilityStatus=e[s]}return t}};t.ServiceHubsManager=d=__decorate([__metadata("fx:diagnostics",[e,"ServiceHubsManager"]),s.Class(),__metadata("design:paramtypes",[i.PortalServicesManager,o.MenusManager,s.Container,a.Experimentation])],d)})),
define("MsPortalImpl/UI/Hubs/UI.PortalServices",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";t.PortalServiceUIManager=void 0;const i=/\s+/g;let o=t.PortalServiceUIManager=class{constructor(){this._portalServiceFavoriteTypes={}}getFavoriteType(e){const t=`PortalService::${e.serviceHubId}::${e.globalId}`.toLowerCase();if(this._portalServiceFavoriteTypes[t])return this._portalServiceFavoriteTypes[t];const s=e.portalServiceManifest.display,o={portalService:e,id:t,image:e.portalServiceManifest.icon,isFavorite:ko.observable(!1),isFilteredOut:ko.observable(!1),isHidden:ko.observable(!1),label:s,labelId:s.replaceAll(i,""),keywords:e.portalServiceManifest.keywords?.split(","),matches:ko.observable(),uri:e.menuUri,opensExternal:!1,isPreview:!1,assetType:e.assetType,kind:e.kind,resourceType:e.resourceType,boost:0,relevanceScore:ko.observable(),subCategoryId:null,isDisabled:!1,isPartner:!1};return this._portalServiceFavoriteTypes[t]=o,o}};t.PortalServiceUIManager=o=__decorate([__metadata("fx:diagnostics",[e,"PortalServiceUIManager"]),s.Class(),__metadata("design:paramtypes",[])],o)})),
define("MsPortalImpl/UI/Hubs/UI.ServiceHubs",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.ServiceHubsManager","MsPortalImpl/UI/Hubs/UI.PortalServices","Fx/Telemetry"],(function(e,t,s,i,o,n){"use strict";t.ServiceHubUIManager=void 0;const r=/\s+/g;let a=t.ServiceHubUIManager=class{constructor(e,t){this._serviceHubsManager=e,this._portalServiceUIManager=t,this._serviceHubFavoriteTypes={},this._portalServiceFavoriteTypes={},this._portalServiceMapHub={},this._initialized=!1}async initialize(){if(!this._initialized){this._initialized=!0;try{const e=await this._serviceHubsManager.getAllServiceHubs();for(const t of e){const e=this.getFavoriteType(t);for(const s of t.portalServices){const t=this._portalServiceUIManager.getFavoriteType(s);this._portalServiceMapHub[t.id]=e,this._portalServiceFavoriteTypes[t.id]=t}}}catch(e){(0,n.trace)({source:"UI.ServiceHubs",action:"FailedToInitialize",data:{error:e}})}}}getParentFavoriteType(e){return this._portalServiceMapHub[e.id]}getAllServiceHubFavoriteTypes(){return this._serviceHubFavoriteTypes}getAllPortalServiceFavoriteTypes(){return this._portalServiceFavoriteTypes}getFavoriteType(e){const t=`ServiceHub::${e.globalId}`.toLowerCase();if(this._serviceHubFavoriteTypes[t])return this._serviceHubFavoriteTypes[t];const s=e.serviceMenuManifest.display,i={serviceHub:e,includes:e.portalServices.map((e=>e.portalServiceManifest.display)),id:t,image:e.serviceMenuManifest.icon,isFavorite:ko.observable(!1),isFilteredOut:ko.observable(!1),isHidden:ko.observable(!1),label:s,labelId:s.replaceAll(r,""),keywords:e.serviceMenuManifest.keywords?.split(","),matches:ko.observable(),uri:e.menuUri,opensExternal:!1,isPreview:!1,assetType:null,kind:null,resourceType:null,boost:0,relevanceScore:ko.observable(),subCategoryId:null,isDisabled:!1,isPartner:!1};return this._serviceHubFavoriteTypes[t]=i,i}};t.ServiceHubUIManager=a=__decorate([__metadata("fx:diagnostics",[e,"ServiceHubUIManager"]),s.Class(),__metadata("design:paramtypes",[i.ServiceHubsManager,o.PortalServiceUIManager])],a)})),
define("MsPortalImpl/Services/Services.Recents",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.Settings","FxHubs/RpcEndPoints","MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers","MsPortalImpl/Services/Services.SecurityTokens","FxInternal","MsPortalImpl/UI/Hubs/UI.ServiceHubs"],(function(e,t,s,i,o,n,r,a,l,c){"use strict";t.RecentServicesManager=t.MruTokensSettingsManager=t.DEV=void 0,t.loadRecentsFromLazyData=function(e){(0,r.lazyUserDataMemo)(e).then((e=>{e.recentResources&&n.AssetTypes.setRecentResourcesEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",{recentResourcesMap:e.recentResources})}))};var d=MsPortalFx.Base.Diagnostics,p=d.Telemetry;const u=d.createLog(e),m=new Set(["Microsoft_AAD_IAM","Microsoft_AAD_UsersAndTenants","Microsoft_AAD_Devices","InternalSamplesExtension"]);let g=t.RecentServicesManager=class{constructor(e,t,s){this._settingsManager=e,this._assetTypesService=t,this._serviceHubUIManager=s}addFavoriteTypeToRecent(e){if(e.serviceHub)this.addService({type:"serviceHub",serviceHubFavoriteTypeId:e.id});else if(e.portalService)this.addService({type:"portalService",portalServiceFavoriteId:e.id});else if(e.assetType){const t=e.assetType,s=e.kind;t&&this.addService({type:"assetType",assetId:t.id+(s?"."+s:"")})}}async addService(e){if("assetType"===e.type||"portalService"===e.type||"serviceHub"===e.type){let t,s,i;await this._ensureServices(),"assetType"===e.type?t=e.assetId?.toLowerCase():"portalService"===e.type?s=e.portalServiceFavoriteId:"serviceHub"===e.type&&(i=e.serviceHubFavoriteTypeId);const o=this._services;if(t){const e=this._assetTypesService.getAssetTypeById(t);if(e?.assetTypeManifest?.isDisabled)return;MsPortalFx.remove(o,(e=>e.assetId===t)),o.unshift({assetId:t,timeStamp:Date.now()})}else s?(MsPortalFx.remove(o,(e=>e.portalServiceFavoriteId===s)),o.unshift({portalServiceFavoriteId:s,timeStamp:Date.now()})):i&&(MsPortalFx.remove(o,(e=>e.serviceHubFavoriteTypeId===i)),o.unshift({serviceHubFavoriteTypeId:i,timeStamp:Date.now()}));o.length>10&&o.pop(),this._settingsManager.setSetting(16,"recentServices",{version:1,data:this._services}),this._azureHomeStoreModule&&this._azureHomeStoreModule.useAzureHomeStore.setState({leftNavRecentServicesLoading:!0})}else"favoriteType"===e.type&&this.addFavoriteTypeToRecent(e.favoriteType)}getServices(){return l.tryImmediateResolve(this._ensureServices(),(()=>this._services))}_ensureServices(){return void 0===this._services?MsPortalFx.require("MsPortalImpl/Widgets/AzureHome/AzureHome.Store").then((e=>(this._azureHomeStoreModule=e,l.tryImmediateResolve(Q(this._settingsManager.querySetting(16,"recentServices")),(e=>l.tryImmediateResolve(Promise.all([this._assetTypesService.assetTypesComplete,this._serviceHubUIManager.initialize()]),(()=>{this._services=((e||{}).data||[]).filter((e=>{if(e.serviceHubFavoriteTypeId){return this._serviceHubUIManager.getAllServiceHubFavoriteTypes()[e.serviceHubFavoriteTypeId]}if(e.portalServiceFavoriteId){return this._serviceHubUIManager.getAllPortalServiceFavoriteTypes()[e.portalServiceFavoriteId]}const t=(e.assetId||"").split("."),s=t.length>1?t.slice(0,t.length-1).join("."):e.assetId,i=t.length>1?t[t.length-1]:void 0,o=this._assetTypesService.getAssetTypeById(s);if(!o)return!1;if(o?.assetTypeManifest?.isDisabled)return!1;const n=o.kindMap&&(i&&o.kindMap[i?.toLowerCase()]||o.kindMap[o.defaultKind?.toLowerCase()]);return n?!!(1&~n.options):!!(1&~o.assetTypeManifest.options)}))}))))))):Promise.resolve()}};t.RecentServicesManager=g=__decorate([__metadata("fx:diagnostics",[e,"RecentServicesManager"]),s.Class(),__metadata("design:paramtypes",[o.SettingsManager,i.AssetTypeService,c.ServiceHubUIManager])],g);let h=t.MruTokensSettingsManager=class{constructor(e,t){this._settingsManager=e;const s=this._mruTokensMap={},i=this._mruTokensQueue=[],o=this._mruExtensionTokensMap={};this._loadInitialSettingsPromise=this._settingsManager.querySetting(16,"mruTokens").then((e=>{MsPortalFx.forEachKey(e,((e,t)=>{t.length&&"string"==typeof t[0]?(s[e]=t.map((e=>({resource:e,audience:""}))),t.forEach((t=>{i.push({extension:e,resource:t,audience:""})}))):(s[e]=t,t.forEach((t=>{i.push({extension:e,resource:t.resource,audience:t.audience})})))}))})).then((()=>{MsPortalFx.isFeatureEnabled("msaljs")&&MsPortalFx.isFeatureEnabled("msaljsprefetch")&&MsPortalFx.forEachKey(s,((e,s)=>{s.forEach((s=>{s.audience&&t.getToken({extensionName:e,resourceName:s.resource,audience:s.audience,skipCache:!1,isBackground:!0})}))}))})),this._loadInitialExtensionMRUTokenMapPromise=this._settingsManager.querySetting(16,"mruTokensByExtension").then((e=>{const t=e?.data;MsPortalFx.forEachKey(t,(e=>{o[e]=t[e]})),this._pauseTokenPrefetchUntil=e?.pauseTokenPrefetchUntil})),t.saveMruTokenFunc=e=>{e?e.extension?e.resource&&Promise.all([this._loadInitialSettingsPromise,this._loadInitialExtensionMRUTokenMapPromise]).then((()=>{this.addMruEntry(e)})):u.warning("The 'entry.extension' to save to MRU token settings was null."):u.warning("The 'entry' to save to MRU token settings was null.")},t.prefetchTokenThrottlingHandler=()=>{this._pauseTokenPrefetchUntil=Date.now()+36e5,this._settingsManager.setSetting(16,"mruTokensByExtension",{pauseTokenPrefetchUntil:this._pauseTokenPrefetchUntil,data:this._mruExtensionTokensMap})}}addMruEntry(e){const t=e.extension,s=e.resource;if("fx"===t||!s)return;const i=this._mruTokensQueue,o=this._mruTokensMap,n=this._mruExtensionTokensMap,r=o[t]||[],a=n[t]||[];if(r.some((e=>e.resource===s)))MsPortalFx.remove(i,(e=>e.resource===s&&e.extension===t)),i.unshift(e);else{if(i.length>=5){const e=i.pop(),t=e.extension;MsPortalFx.remove(o[t],(t=>t.resource===e.resource)),o[t].length||delete o[t]}i.unshift(e),r.push({resource:s,audience:e.audience}),o[t]=r,this._settingsManager.setSetting(16,"mruTokens",o)}a.some((e=>e.resource===s))?MsPortalFx.remove(a,(e=>e.resource===s)):a.length>=(m.has(t)?5:4)&&a.pop(),a.unshift({resource:e.resource,audience:e.audience}),n[t]=a,Date.now()>this._pauseTokenPrefetchUntil&&(this._pauseTokenPrefetchUntil=void 0),this._settingsManager.setSetting(16,"mruTokensByExtension",{pauseTokenPrefetchUntil:this._pauseTokenPrefetchUntil,data:n})}getExtensionMRUList(e){if(!this._pauseTokenPrefetchUntil||Date.now()>this._pauseTokenPrefetchUntil){this._pauseTokenPrefetchUntil=void 0,this._settingsManager.setSetting(16,"mruTokensByExtension",{pauseTokenPrefetchUntil:this._pauseTokenPrefetchUntil,data:this._mruExtensionTokensMap});return(this._mruExtensionTokensMap[e]?this._mruExtensionTokensMap[e]:[]).slice(0,m.has(e)?5:4)}return p.trace({source:"Services.Recents",action:"getExtensionMRUListThrottled",data:{pauseTokenPrefetchUntil:this._pauseTokenPrefetchUntil,extensionName:e}}),null}};t.MruTokensSettingsManager=h=__decorate([__metadata("fx:diagnostics",[e,"MruTokensSettingsManager"]),s.Class(),__metadata("design:paramtypes",[o.SettingsManager,a.SecurityTokensManager])],h)})),
define("MsPortalImpl/Services/Services.FavoritesSettings",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.SettingsProcessor","FxInternal/AsyncLoader","FxInternal/DirectoryManagement","Fx/Telemetry"],(function(e,t,s,i,o,n,r,a){"use strict";t.saveUserDirectorySettingsHandler=t.getUserDirectorySettingsHandler=t.UserDirectorySettingsManager=t.UserDirectorySettings=t.FavoritesSettingsManager=t.FavoritesSettings=void 0;const l=MsPortalFx.Base.Diagnostics.createLog(e);let c=!1;class d extends o.SettingsProcessor{static create(e){return o.create(d,e,new p,8,!0)}}t.FavoritesSettingsManager=d,__decorate([__metadata("fx:diagnostics",[e,"FavoritesSettingsManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.SettingsManager]),__metadata("design:returntype",Promise)],d,"create",null);class p{constructor(){this.favorites=ko.observable(""),this.version=ko.observable(0)}static create(e){return e.value}}t.FavoritesSettings=p,__decorate([__metadata("fx:diagnostics",[e,"FavoritesSettings"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[d]),__metadata("design:returntype",p)],p,"create",null);class u extends o.SettingsProcessor{static create(e){return o.create(u,e,new m,7,!0)}}t.UserDirectorySettingsManager=u,__decorate([__metadata("fx:diagnostics",[e,"UserDirectorySettingsManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.SettingsManager]),__metadata("design:returntype",Promise)],u,"create",null);class m{constructor(){this.favoriteDirectoriesList=ko.observableArray(),this.userDefaultDirectory=ko.observable(),this.signInToLastVisitedDirectory=ko.observable(!0),this.recentDirectoriesList=ko.observableArray()}static create(e){return e.value}addRecentDirectory(e){if(c||!e)return;const t=e.toLowerCase(),s=this.recentDirectoriesList(),i=s.indexOf(t);i>-1&&s.splice(i,1),s.unshift(t),this.recentDirectoriesList(s.slice(0,3)),c=!0}}t.UserDirectorySettings=m,__decorate([__metadata("fx:diagnostics",[e,"UserDirectorySettings"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[u]),__metadata("design:returntype",m)],m,"create",null);t.getUserDirectorySettingsHandler=(0,n.defineHandler)(r.getUserDirectorySettingsEndPoint,(e=>{const t=e.diContainer.get(u).value;return(0,a.trace)({source:"Services.FavoritesSettings",action:"getUserDirectorySettingsRpc",data:{callingExtension:e.messageContext.srcWindowId}}),Promise.resolve({favoriteDirectoriesList:t.favoriteDirectoriesList(),userDefaultDirectory:t.userDefaultDirectory()})})),t.saveUserDirectorySettingsHandler=(0,n.defineHandler)(r.saveUserDirectorySettingsEndPoint,(e=>{const t=e.messageArg;let s=!1;const i=Object.create(null);i.callingExtension=e.messageContext.srcWindowId;try{const o=e.diContainer.get(u).value;if(t.favoriteDirectoriesList&&(i.newFavoritesCount=t.favoriteDirectoriesList.length,i.oldFavoritesCount=o.favoriteDirectoriesList().length,o.favoriteDirectoriesList(t.favoriteDirectoriesList)),t.userDefaultDirectory){const e=o.userDefaultDirectory(),s=e&&e.id;s!==t.userDefaultDirectory.id&&(i.oldDefaultId=s,i.newDefaultId=t.userDefaultDirectory.id,o.userDefaultDirectory(t.userDefaultDirectory))}s=!0}catch(e){l.error(new MsPortalFx.Errors.Error({message:`Failed to save user directory settings. Error: "${MsPortalFx.getLogFriendlyMessage(e)}"`,innerErrors:e}))}return(0,a.trace)({source:"Services.FavoritesSettings",action:"saveUserDirectorySettingsRpc",data:MsPortalFx.extend(i,{saveSuccess:s})}),Promise.resolve(s)}))})),
define("MsPortalImpl/UI/Hubs/UI.BrowseManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.AssetTypes"],(function(e,t,s,i){"use strict";t.BrowseManager=void 0,t.compareAssetTypeForSort=r;const o=MsPortalFx.Base.Constants.ResourceTypes.ResourceGroups.toLowerCase(),n=MsPortalFx.forEachKey;function r(e,t){const s=e.toLocaleLowerCase(),i=t.toLocaleLowerCase();return s===i?0:s<i?-1:1}let a=t.BrowseManager=class{constructor(e){this._assetTypeService=e,this._browsePackages={};(this._ltm=new FxImpl.TriggerableLifetimeManager).registerForDispose((()=>{n(this._browsePackages,((e,t)=>{t.cancel(),t.dispose()}))}))}dispose(){this._ltm.dispose()}getFilteredAssetTypes(){const e=[],t=[];return this._assetTypeService.assetTypes.forEach((t=>{const s=t.assetTypeManifest;this._assetTypeMeetsRequirements(s)&&e.push(t)})),e.length&&t.push(...MsPortalFx.stableSort(e,((e,t)=>r(e.compositeDisplayName.service||e.compositeDisplayName.plural,t.compositeDisplayName.service||t.compositeDisplayName.plural)))),t}_assetTypeMeetsRequirements(e){if(!e)return!1;if(void 0===e.browseType)return!1;const t=e.resourceType;if(!t)return!0;const s=t.resourceTypeName;if(s.toLowerCase()===o)return!0;return!(s.split("/").length<2)}};t.BrowseManager=a=__decorate([__metadata("fx:diagnostics",[e,"BrowseManager"]),s.Class(),__metadata("design:paramtypes",[i.AssetTypeService])],a)})),
define("MsPortalImpl/UI/Hubs/UI.FavoritesManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Services/Services.BrowseCuration","MsPortalImpl/Services/Services.FavoritesSettings","MsPortalImpl/UI/Hubs/UI.BrowseManager","Weave","FxHubs/ResourceManagement","FxInternal/AsyncLoader","MsPortalImpl/UI/Hubs/UI.ServiceHubs","MsPortalImpl/Services/Services.AssetTypes"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m){"use strict";t.FavoritesManager=void 0,t.findAssetTypeFavoriteItem=E,t.getAssetTypeDisplayText=_,t.getAssetTypeIcon=F,t.getAssetTypeKeywords=T,t.getAssetTypeKind=P,t.getFavoriteType=k;var g=MsPortalFx.Base,h=MsPortalFx.Extension,f=g.Diagnostics,x=f.Telemetry,b=(h.BrowseType,g.Promises.cancelOnDispose);const y=i.Favorites,v=y.Notification,w=(f.createLog(e),JSON.parse),M=JSON.stringify,C=/\s+/g,S=MsPortalFx.find,I={};function P(e,t){return t&&e.kindMap?.[(t||"").toLowerCase()]}function _(e,t){return t&&(t.serviceDisplayName||t.pluralDisplayName||y.assetPlusKindFormat.format(e.compositeDisplayName.service,t.name))||e.compositeDisplayName.service}function F(e,t){return t?.icon||e.icon}function T(e,t){return t&&t.keywords||e.assetTypeManifest.keywords}function k(e){const t=e.diContainer.get(o.AssetTypeService),s=e.assetType.assetTypeManifest,i=s&&(0,d.supportsOption)(s.options,1),n=P(e.assetType,e.kind),r=n&&(0,d.supportsOption)(n.options,1),a=n&&(0,d.supportsOption)(n.options,4),l=n?i?!a:r:i,c=_(e.assetType,n);return{id:e.assetTypeIdWithKind||e.assetType.id,image:F(e.assetType,n),isFavorite:ko.observable(!1),isFilteredOut:ko.observable(!1),isHidden:ko.observable(l),label:c,labelId:c.replaceAll(C,""),keywords:(T(e.assetType,n)||"").split(","),matches:ko.observable(),uri:t.getAssetTypeDeepLink(e.assetType,e.kind),opensExternal:3===s.browseType,isPreview:e.assetType.isPreview,assetType:e.assetType,kind:e.kind,resourceType:s.resourceType&&s.resourceType.resourceTypeName,boost:e.boost,relevanceScore:ko.observable(),subCategoryId:e.subCategory,isDisabled:e.assetType.assetTypeManifest.isDisabled,isPartner:e.assetType.extension.toLowerCase().startsWith(MsPortalFx.isFeatureEnabled("testpartnertag")?"internalsamplesextension":"azure_marketplace_"),commandsToolbarDetailView:ko.observable()}}function E(e,t,s,i){if(!t)return null;const o=t,r=t,a=s.get(n.RedirectMap).getAssetRedirect(t);let l,c;a&&(t=(0,m.getAssetId)(a.toExtension,a.toAsset,a.toKind)),a&&((i=i||s.get(D)).remove(o),i.add(t),x.trace({source:"SideBar",action:"FavoriteRedirected",name:r,data:{from:r,to:t}}));const d=t.indexOf(".");d>0&&(c=t,t=c.substring(0,d),l=c.substring(d+1));const p=t.toLowerCase(),u=MsPortalFx.find(e,(e=>e.id.toLowerCase()===p));return u&&k({assetType:u,kind:l,diContainer:s,assetTypeIdWithKind:c})}FxImpl.getAssetTypeMappingData=()=>I;let D=t.FavoritesManager=class{constructor(e,t,s,i,o){this._assetTypeService=e,this._browseManager=t,this._diContainer=s,this._serviceHubUIManager=o,this.favorites=(0,c.makeArrayComputation)(),this._notificationsForItems=ko.observable(),this._ltm=new FxImpl.TriggerableLifetimeManager,this._assetTypes=ko.observable(),this._serviceHubs={},this._portalServices={},this._mapAssetIdToPortalServices={},this._initialFavorites=[],this.remove=e=>{const t=this._savedFavorites().length&&w(this._savedFavorites())||[],s=t.indexOf(e);-1!==s&&(t.splice(s,1),this._savedFavorites(M(t)))},this.add=e=>{const t=this._savedFavorites()?w(this._savedFavorites()):[];t.includes(e)||(t.push(e),this._savedFavorites(M(t)))},this.move=e=>{const t=this._savedFavorites()?w(this._savedFavorites()):[],s=this.favorites.value[e],i=t.indexOf(s.id);t.splice(e,0,t.splice(i,1)[0]),this._savedFavorites(M(t))},this._savedFavorites=ko.observable(""),this.initializeFavorites(i)}setFavorites(e){this.favorites.setAll(e);const t=this.favorites.value.map((e=>e.id));this._savedFavorites(M(t))}async initializeFavorites(e){const t=this._savedFavorites=MsPortalFx.isFeatureEnabled("skipsavedfavorites")?ko.observable(""):e.favorites,s=!(!t||!t());s&&(MsPortalFx.isFeatureEnabled("skipfavoritesupgrade")||function(e,t,s){const i=[],o=[[],["Microsoft_AAD_IAM_AzureActiveDirectory","Microsoft_Azure_Monitoring_AzureMonitoring","Microsoft_Azure_Security_SecurityDashboard","Microsoft_Azure_Billing_Billing","Microsoft_Azure_Support_HelpAndSupport"],["Microsoft_Azure_Expert_AzureAdvisor"]];if(s&&e.version()<o.length-1){const t=e.favorites,s=t().toLowerCase(),n=w(t());for(let t=(e.version()||0)+1;t<o.length;t++)o[t].forEach((e=>{const t=e.toLowerCase();s.includes(t)||(n.push(e),i.push(e))}));t(M(n))}t(i),e.version(o.length-1)}(e,this._notificationsForItems,s),this._initialFavorites=w(t())),await Promise.all([this._assetTypeService.assetTypesComplete,this._serviceHubUIManager.initialize()]);const i=this._browseManager.getFilteredAssetTypes()||[];i.length&&this._assetTypes(i),this._serviceHubs=this._serviceHubUIManager.getAllServiceHubFavoriteTypes(),this._portalServices=this._serviceHubUIManager.getAllPortalServiceFavoriteTypes(),Object.values(this._portalServices).forEach((e=>{e.portalService?.assetId&&(this._mapAssetIdToPortalServices[e.portalService.assetId.toLowerCase()]=e)})),this.loadFavorites()}async loadFavorites(){const e=this._savedFavorites?.().length&&(e=>{const t=[];return e.forEach((e=>{switch(typeof e){case"string":if(e.startsWith("{"))try{const s=w(e);"string"==typeof s.typeId&&s.typeId&&t.push(s.typeId)}catch(e){}else t.push(e);break;case"object":e&&"string"==typeof e.typeId&&t.push(e.typeId)}})),this._savedFavorites(M(t)),t})(w(this._savedFavorites()))||[],t=[],s=(e,s)=>{const i=E(this._assetTypes(),e,this._diContainer,this),o=this._serviceHubs[e],n=this._portalServices[e];if(i)if(i.isHidden()){const e=this._mapAssetIdToPortalServices[i.id?.toLowerCase()];e&&!t.some((t=>t.id===e.id))&&(e.isFavorite(!0),t.push(e),this.add(e.id))}else i.isFavorite(!0),t.some((e=>e.id===i.id))||t.push(i);else o?(o.isFavorite(!0),t.some((e=>e.id===o.id))||t.push(o)):n&&(n.isFavorite(!0),t.some((e=>e.id===n.id))||t.push(n))},i=()=>{const e=this._notificationsForItems()||[],s=[...e];e.forEach((e=>{const i=S(t,(t=>e===t.id));if(i){const t=v.titleFmt.format(i.label),o=i.assetType?.assetTypeManifest||{};this._diContainer.getAsync(p.get("MsPortalImpl/UI/Hubs/UI.NotificationManager","NotificationManager")).then((e=>{e.addSingleNotification({title:t,description:v.Description[(o.name||"").toLowerCase()]||t,status:0,linkTo:i.uri})})),MsPortalFx.remove(s,e)}})),this._notificationsForItems(s),this.favorites.setAll(t)};return e.length?(e.forEach(((e,t)=>{e&&s(e)})),i(),Promise.resolve()):b(this._ltm,(0,r.getBrowseCuration)({diContainer:this._diContainer,applyServiceHubVisibility:!1})).then((e=>{const t=this._initialFavorites;e.favorites?.forEach((e=>{const s=(0,m.getAssetId)(e.extensionName,e.assetType,e.kind);t.push(s)})),this._initialFavorites.forEach(((e,t)=>{s(e)})),this._savedFavorites(M(t)),i()}))}dispose(){this._ltm.dispose()}};t.FavoritesManager=D=__decorate([__metadata("fx:diagnostics",[e,"FavoritesManager"]),s.Class(),__metadata("design:paramtypes",[o.AssetTypeService,l.BrowseManager,s.Container,a.FavoritesSettings,u.ServiceHubUIManager])],D)})),
define("_generated/MsPortalImpl/Svg/Library/Polychromatic/AllServices.svg",["require","exports"],(function(e,t){"use strict";t.type=t.data=void 0;t.type=385,t.data="<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><defs><linearGradient id='6eb68591-04e5-482e-a692-1a1a5a65161f' x1='1.65' x2='1.65' y1='6.09' y2='3.44' gradientUnits='userSpaceOnUse'><stop offset='0' stop-color='#5e9624'/><stop offset='.4' stop-color='#65a227'/><stop offset='1' stop-color='#76bc2d'/></linearGradient><linearGradient id='e607fda0-4f2a-49ea-aa46-868ccb6548e1' x1='1.65' x2='1.65' y1='10.47' y2='7.83' gradientUnits='userSpaceOnUse'><stop offset='0' stop-color='#5e9624'/><stop offset='.54' stop-color='#6aa928'/><stop offset='1' stop-color='#76bc2d'/></linearGradient><linearGradient id='bf6f34ea-cde2-4734-8e82-b044d8035668' x1='1.65' x2='1.65' y1='15.02' y2='12.37' gradientUnits='userSpaceOnUse'><stop offset='0' stop-color='#5e9624'/><stop offset='.54' stop-color='#6aa928'/><stop offset='1' stop-color='#76bc2d'/></linearGradient></defs><rect width='13.97' height='1.45' x='3.73' y='4.04' fill='#8a8a8a' rx='.73'/><rect width='13.97' height='1.45' x='3.73' y='8.42' fill='#8a8a8a' rx='.73'/><rect width='13.97' height='1.45' x='3.73' y='12.97' fill='#8a8a8a' rx='.73'/><rect width='2.64' height='2.64' x='.32' y='3.44' fill='url(#6eb68591-04e5-482e-a692-1a1a5a65161f)' rx='1.32'/><rect width='2.64' height='2.64' x='.32' y='7.83' fill='url(#e607fda0-4f2a-49ea-aa46-868ccb6548e1)' rx='1.32'/><rect width='2.64' height='2.64' x='.32' y='12.37' fill='url(#bf6f34ea-cde2-4734-8e82-b044d8035668)' rx='1.32'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Library/Polychromatic/Dashboard.svg",["require","exports"],(function(e,t){"use strict";t.type=t.data=void 0;t.type=350,t.data="<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><defs><linearGradient id='fbe660f3-11d5-4892-bb16-0138699ce2b6' x1='9' x2='9' y1='790.787' y2='774.125' gradientTransform='matrix(1 0 0 -1 0 791.516)' gradientUnits='userSpaceOnUse'><stop offset='0' stop-color='#6cc6b9'/><stop offset='.46' stop-color='#6ac4b7'/><stop offset='.64' stop-color='#62bdb0'/><stop offset='.77' stop-color='#56b1a4'/><stop offset='1' stop-color='#258277'/></linearGradient></defs><path fill='url(#fbe660f3-11d5-4892-bb16-0138699ce2b6)' d='M.549 2.636h16.912a.518.518 0 0 1 .539.489v11.75a.518.518 0 0 1-.539.489H.549A.528.528 0 0 1 0 14.875V3.145a.529.529 0 0 1 .548-.509z'/><rect width='1.532' height='9.349' x='12.459' y='4.206' opacity='.9' rx='.147' class='msportalfx-svg-c01'/><rect width='8.572' height='1.937' x='1.628' y='11.629' opacity='.6' rx='.159' class='msportalfx-svg-c01'/><rect width='1.532' height='5.524' x='14.808' y='8.031' opacity='.9' rx='.113' class='msportalfx-svg-c01'/><path d='m9.117 4.772-2.13 3.79-2.253-2.295-2.322 3.011.544.427 1.842-2.376 2.338 2.386L9.72 5.119l-.603-.347z' class='msportalfx-svg-c01'/><ellipse cx='4.761' cy='6.795' rx='.876' ry='.881' class='msportalfx-svg-c01'/><ellipse cx='7.136' cy='8.979' rx='.876' ry='.881' class='msportalfx-svg-c01'/><ellipse cx='9.341' cy='5.055' rx='.876' ry='.881' class='msportalfx-svg-c01'/><ellipse cx='2.775' cy='9.363' rx='.876' ry='.881' class='msportalfx-svg-c01'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Startup/Home.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=335,t.data="<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><defs><linearGradient id='5543b141-0212-4423-8465-d7ca07a2a3ef' x1='9' x2='9' y1='17.66' y2='.34' gradientUnits='userSpaceOnUse'><stop offset='0' stop-color='#0078d4'/><stop offset='.17' stop-color='#1c84dc'/><stop offset='.38' stop-color='#3990e4'/><stop offset='.59' stop-color='#4d99ea'/><stop offset='.8' stop-color='#5a9eee'/><stop offset='1' stop-color='#5ea0ef'/></linearGradient></defs><path fill='url(#5543b141-0212-4423-8465-d7ca07a2a3ef)' d='M17.8 8.29 9.41.5a.61.61 0 0 0-.82 0L.2 8.29a.62.62 0 0 0 .47 1.06h1.72a.3.3 0 0 1 .3.3v7.4a.61.61 0 0 0 .61.61h11.4a.61.61 0 0 0 .61-.61v-7.4a.3.3 0 0 1 .3-.3h1.72a.62.62 0 0 0 .47-1.06z'/><path fill='#e6e6e6' d='M7.07 12.4h3.86a.36.36 0 0 1 .32.38v4.88h-4.5v-4.88a.36.36 0 0 1 .32-.38z'/><path fill='#005ba1' d='M.67 9.35h.53l7.39-6.86a.61.61 0 0 1 .82 0l7.39 6.86h.53a.62.62 0 0 0 .47-1.06L9.41.5a.61.61 0 0 0-.82 0L.2 8.29a.62.62 0 0 0 .47 1.06z'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Startup/MonochromeHome.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=398,t.data="<svg viewBox='0 0 2048 2048' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m1024 165 941 942-90 90-83-82v805h-640v-640H896v640H256v-805l-83 82-90-90 941-942zm640 1627V987l-640-640-640 640v805h384v-640h512v640h384z'/></g></svg>"})),
define("MsPortalImpl/Widgets/Widgets.SideBar",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/Hubs/UI.FavoritesManager","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/MsPortalImpl/Svg/Startup/Home.svg","_generated/MsPortalImpl/Svg/Startup/MonochromeHome.svg","MsPortalImpl/Services/Services.Recents","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Services/Services.GeneralSettings","_generated/MsPortalImpl/Svg/Library/Polychromatic/Dashboard.svg","_generated/MsPortalImpl/Svg/Library/Polychromatic/AllServices.svg","Weave","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css","MsPortalImpl/Base/Base.BrowserDetection","Fx/Experimentation"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x,b){"use strict";t.Widget=t.ViewModel=void 0,t.reorderFavorite=T,(0,h.injectCss)(f);var y=MsPortalFx.Base,v=y.Images,w=y.Promises.cancelOnDispose;const M=window.fx.environment,C="fxs-sidebar-bar",S="li.fxs-sidebar-item",I=o.SideBar,P=MsPortalFx.isNullOrUndefined;let _=t.ViewModel=class extends r.ViewModel{setCollapsed(e,t=!0){this.focusBehavior(t),this.isCollapsed(e)}openCreate(){F("SideBarNewMenuOpened"),this.launchBlade((0,i.getGalleryDeepLink)("hub"))}reorderFavorites(e){!function(e,t,s){const i=$(document.activeElement).parent(),o=40===s?i.next(S):i.prev(S);if(o.length>0){const s=T(o.attr("data-id"),e,t);s>=0&&Promise.resolve().then((()=>{const e=t.favoritesManager.favorites.value[s].uri,i=$.querySelectorAll(`.${C} [href|='${e}']`)[0];i?.focus()}))}}($(document.activeElement).parent().attr("data-id"),this,e)}openExternal(e){window.open(e,"_blank")}setWidget(e){this._widget=e}getRootElement(){return this._widget?.element}constructor(e,t,s){super(),this.diContainer=e,this.favoritesManager=t,this._recentsManager=s,this.isCollapsed=(0,g.makeWritableComputation)(!0),this.layoutMode=(0,g.makeWritableComputation)(),this.hamburgerMode=(0,g.makeWritableComputation)(!0),this.focusBehavior=(0,g.makeWritableComputation)(!0),this.hamburgerButton=new g.ElementRef,this.extensionSideBar=ko.observable(""),this.openFavorite=(e,t,s)=>{let i;if(i="number"==typeof e?this.favoritesManager.favorites.value[e]:e,i){if(i.opensExternal)return this.openExternal(i.uri),!0;if(!t&&!s)return this._recentsManager.addService({type:"favoriteType",favoriteType:i}),this.launchBlade(i.uri,i),!0}};let n=MsPortalFx.isFeatureEnabled("brandingsidebar")?M.branding.browseLabel:I.allServices;e.get(b.Experimentation).shellAssignments.getBooleanValue("azHome")&&(n=I.services);const r=MsPortalFx.isFeatureEnabled("monochromehomeicon")?l:a;this.topSectionLinks=[!M.chrome.hideCreateButton&&{classes:"fxs-sidebar-create",title:I.createTooltip,text:I.createResource,shortText:o.SideBarFlyout.DetailView.createResources,icon:v.Add({customClass:"msportalfx-fill-success"}),href:(0,i.getGalleryDeepLink)("hub"),onClick:e=>{y.Diagnostics.Telemetry.trace({source:e??"SideBar",action:"SideBarNewMenuOpened"})}},MsPortalFx.isFeatureEnabled("azurehome")&&{classes:"fxs-sidebar-home",title:o.AzureHome.azureHome,text:o.AzureHome.home,icon:r,href:(0,i.getHomeDeeplink)(),onClick:e=>{y.Diagnostics.Telemetry.trace({source:e??"SideBar",action:"AzureHomeLinkClicked"})}},!MsPortalFx.isFeatureEnabled("hidedashboards")&&{classes:"fxs-sidebar-dashboard",title:o.NavBar.home,text:o.NavBar.home,icon:u,href:(0,i.getDefaultDashboardDeeplink)(),onClick:e=>{y.Diagnostics.Telemetry.trace({source:e??"SideBar",action:"DashboardNavigation"})}},!MsPortalFx.isFeatureEnabled("hideallservices")&&{classes:"fxs-sidebar-browse",title:n,text:n,icon:m,href:(0,i.getAllServicesDeeplink)(),onClick:e=>{y.Diagnostics.Telemetry.trace({source:e??"SideBar",action:"AllServicesMenuOpened"})}}].filter(MsPortalFx.identity),this.favorites=t.favorites,this.effectiveFavorites=this.favorites.cFilter((e=>!!e)),this.hamburgerMode(!(0,p.isSideBarDocked)(e)),this.extensionSideBar(e.get(FxImpl.Features).getValue("extensionsidebar"))}};function F(e,t,s){y.Diagnostics.Telemetry.trace({source:"SideBar",name:t,action:e,data:s})}function T(e,t,s){const i=s.favoritesManager.favorites,o=i.value,n=k(e,o),r=k(t,o);if(n>=0&&r>=0&&n!==r){F("SideBarFavoriteMoved",t,{oldIndex:r,newIndex:n});const e=i.value[r];return i.removeAt(r),i.insert(n,e),s.favoritesManager.move(n),n}return-1}t.ViewModel=_=__decorate([__metadata("fx:diagnostics",[e,"ViewModel"]),s.Class(),__metadata("design:paramtypes",[s.Container,n.FavoritesManager,c.RecentServicesManager])],_);function k(e,t){for(let s=0;s<t.length;++s)if(t[s]&&t[s].id===e)return s;return-1}t.Widget=class{constructor(e,t,s,i){this.ltm=e,this.element=t,this.options=s,this._diContainer=i,this._renderGuard=!1,s.setWidget(this);const o=this.ltm;this._lastFocusedElement=document.activeElement,this._settings=s.diContainer.get(p.GeneralSettings),s.hamburgerMode(!(0,p.isSideBarDocked)(s.diContainer)),this.render(window.innerWidth,window.innerHeight),this._settings.sideBarLayout.subscribe(o,(()=>{s.hamburgerMode(!(0,p.isSideBarDocked)(s.diContainer)),s.hamburgerMode.value||2!==s.layoutMode.value?s.setCollapsed(!0):2===s.layoutMode.value&&s.setCollapsed(this._settings.sideBarCollapsedKey()),this.render()})),(0,g.subscribe)(o,[s.isCollapsed],(e=>{e?d.unregister(this._dismissHandle):s.focusBehavior.value&&t[0]&&d.register(this._dismissHandle),this.render(),F("SideBarCollapsedChanged","",e?"collapsed":"expanded")}));const n=e=>!s.hamburgerMode.value&&2===s.layoutMode.value||this.element[0]===e||$.contains(this.element[0],e)?0:2;this._dismissHandle={dismissFn:()=>{s.setCollapsed(!0),d.unregister(this._dismissHandle)},shouldDismissOnFocusOutFn:n,shouldDismissOnMouseDownFn:n,shouldDismissOnMouseWheelFn:n,logName:"sidebar"};const r=()=>{x.isAndroidOrMobile||this.render(window.innerWidth,window.innerHeight)};window.addEventListener("resize",r),o.registerForDispose((()=>window.removeEventListener("resize",r))),this._attachEventHandlers()}render(e,t){if(this._renderGuard)return;this._renderGuard=!0;const s=this.options,i=s.isCollapsed,o=s.hamburgerMode,n=s.layoutMode.value;let r=n;var a;if(P(e)||P(t)||(a=e,r=t<500||a<640?0:a<1024?1:2,P(n)||r===n||F("SideBarLayoutChanged","",function(e){switch(e){case 0:return"SideBarFlyout";case 1:return"SideBarCollapsed";case 2:return"SideBarExpanded"}}(r))),r!==n&&(o.value||2!==r?s.setCollapsed(!0):2===r&&s.setCollapsed(this._settings.sideBarCollapsedKey())),!o.value&&n!==r&&2===r){const e=document.getElementsByClassName("fxs-part-reactframe"),t=document.createEvent("Event");t.initEvent("resize",!0,!0);for(let s=0;s<e.length;s++)e[s].dispatchEvent(t)}if(s.focusBehavior.value&&(o.value||0===r))if(i.value){const e=this.element[0],t=document.activeElement;e&&$.contains(e,t)&&d.validatePreviousFocusedElement(this._dismissHandle,this._lastFocusedElement)&&$(this._lastFocusedElement).focus()}else this.setFocus();n!==r&&s.layoutMode(r),this._renderGuard=!1}setFocus(){this._lastFocusedElement=document.activeElement;(this._diContainer.get(b.Experimentation).shellAssignments.getBooleanValue("LeftNav")?document.getElementsByClassName("fxs-sidebar-leftnav").item(0).getElementsByTagName("A")[0]:this.options.hamburgerButton).focus()}_attachEventHandlers(){w(this.ltm,Promise.all([MsPortalFx.require(e.normalize("MsPortalImpl/Widgets/Widgets.HoverCard")),MsPortalFx.require(e.normalize("MsPortalImpl/Widgets/ServiceHoverCard"))])).then((([e,t])=>{e.attach(this.ltm,this.element,".fxs-sidebar-favorite-item",(s=>{const i=this.options.favorites.value,o=i[k($(s.currentTarget).attr("data-id"),i)],n=this.element.find(`.fxs-hover-card-balloon[data-name='${o.id}']`).first(),r=new t.ViewModel(o,$(s.currentTarget),this._diContainer,"SidebarFavorite");return r.favoriteOnDismiss=!0,r.positionHint=4,y.Diagnostics.Telemetry.trace({source:"HoverCard",name:o.id,action:"InitialReveal",data:{hoverCardLocation:"SidebarFavorite"}}),new e.Widget(n,r,this._diContainer)}),this._diContainer)}))}}})),
define("_generated/MsPortalImpl/Svg/Startup/DoubleChevron.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=345,t.data="<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M14.65 15.53 8 8.88l-6.65 6.65-.7-.71L8 7.47l7.35 7.35-.7.71z'/><path d='M14.65 8.53 8 1.88 1.35 8.53l-.7-.71L8 .47l7.35 7.35-.7.71z'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Startup/Ellipsis.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=176,t.data="<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M2 7a1 1 0 0 1 .39.08.94.94 0 0 1 .53.53 1 1 0 0 1 0 .78.94.94 0 0 1-.53.53 1 1 0 0 1-.78 0 .94.94 0 0 1-.53-.53 1 1 0 0 1 0-.78.94.94 0 0 1 .53-.53A1 1 0 0 1 2 7zm6 0a1 1 0 0 1 .39.08.94.94 0 0 1 .53.53 1 1 0 0 1 0 .78.94.94 0 0 1-.53.53 1 1 0 0 1-.78 0 .94.94 0 0 1-.53-.53 1 1 0 0 1 0-.78.94.94 0 0 1 .53-.53A1 1 0 0 1 8 7zm6 0a1 1 0 0 1 .39.08.94.94 0 0 1 .53.53 1 1 0 0 1 0 .78.94.94 0 0 1-.53.53 1 1 0 0 1-.78 0 .94.94 0 0 1-.53-.53 1 1 0 0 1 0-.78.94.94 0 0 1 .53-.53A1 1 0 0 1 14 7z'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Startup/Hamburger.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=313,t.data="<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M1 4.5v-1h14v1zm0 4v-1h14v1zm0 4v-1h14v1z'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Startup/Hyperlink.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=31,t.data="<svg viewBox='0 0 16 15' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M14.3 1H10V0h6v6h-1V1.7l-8 8-.7-.7z'/><path d='M11 8v5a.9.9 0 0 1-1 1H2a.9.9 0 0 1-1-1V6a.9.9 0 0 1 1-1h6l1-1H2a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7z'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Startup/Star.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=283,t.data="<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m6 .3 1.5 4.3 4.5.1-3.6 2.7 1.3 4.3L6 9.1l-3.7 2.6 1.3-4.3L0 4.7l4.5-.1z'/></g></svg>"})),
define("MsPortalImpl/Widgets/Widgets.SideBar.Component",["require","exports","Weave/DirectMode","Weave","MsPortalImpl/Widgets/Widgets.SideBar","_generated/MsPortalImpl/Svg/Startup/Hyperlink.svg","_generated/MsPortalImpl/Svg/Startup/Ellipsis.svg","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Services/Services.GeneralSettings","_generated/MsPortalImpl/Svg/Startup/DoubleChevron.svg","_generated/MsPortalImpl/Svg/Startup/Star.svg","_generated/MsPortalImpl/Svg/Startup/Hamburger.svg","MsPortalImpl/UI/UI.BladeOpener","Fx/Composition/Selectable"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h){"use strict";t.SideBar=function(e){const{vm:t,className:x}=e,b=n,y=r,v=t.isCollapsed,w=t.extensionSideBar(),M=(0,i.composeComputation)([t.hamburgerMode,v],((e,t)=>!(e&&t||w)));let C;if(w){const[,e,s]=w.split("/");t.diContainer.get(g.BladeOpener).openBlade(new h.PdlBladeReference(s,e),{flags:512})}return s(i.GetContext,{fn:({diContainer:e})=>s(i.LifetimeManagerScoped,{fn:n=>s("div",{className:[x,w&&"fxs-extension-sidebar fxs-portal-background",{"fxs-sidebar-is-collapsed":v,"fxs-display-none":!!f.chrome.hideSidebarNav}],role:"presentation",onDragOver:({event:e})=>{e.preventDefault()},onDrop:({event:e})=>{const s=e.target,i=$(s).closest(".fxs-sidebar-droppable")[0];e.preventDefault(),i&&(0,o.reorderFavorite)(i.getAttribute("data-id"),C,t)},afterMount:s=>{new o.Widget(n,$(s),t,e)}},s("nav",{className:"fxs-sidebar-bar msportalfx-shadow-level3","aria-label":l.SideBar.svcNavLabel,onKeyDown:({event:e})=>{if(32===e.keyCode&&4!==(0,c.getModifierKeys)(e)){const t=e.target;t.click(),t.classList.contains("fxs-sidebar-filter-input")||e.preventDefault(),e.stopPropagation()}}},s("div",{className:"fxs-sidebar-header"},s("button",{className:"fxs-sidebar-item-link fxs-sidebar-hamburger fxs-sidebar-button",title:l.SideBar.hamburger,"aria-label":l.SideBar.hamburger,onClick:I,ref:t.hamburgerButton},s("div",{className:"fxs-sidebar-icon",image:m})),s("div",{className:"fxs-sidebar-divider2"})),s(i.Once,{"data-odebug":"16",condition:M,trueFn:()=>s(i.Fragment,null,s("div",{className:"fxs-sidebar-top fxs-sidebar-menu-activated-hidden"},s("button",{className:"fxs-sidebar-collapse-button fxs-sidebar-button",title:v.compose((e=>e?l.SideBar.expand:l.SideBar.collapse)),image:p,onClick:()=>{const e=!t.isCollapsed.value;2===t.layoutMode.value&&t.diContainer.get(d.GeneralSettings).sideBarCollapsedKey(e),t.setCollapsed(e)}}),t.topSectionLinks.map((e=>s("a",{className:"fxs-sidebar-item-link "+e.classes,href:e.href,title:e.title,"aria-label":e.title,onClick:()=>{e.onClick(),I()}},s("div",{className:"fxs-sidebar-icon",image:e.icon}),s("div",{className:"fxs-sidebar-label"},e.text))))),MsPortalFx.isFeatureEnabled("hidefavoritesdivider")?null:s("div",{className:"fxs-sidebar-favorites-section fxs-sidebar-menu-activated-hidden"},s("div",{className:"fxs-sidebar-divider"}),s("div",{className:"fxs-sidebar-fav-icon",image:u}),s("span",{className:"fxs-sidebar-myfavorites"},l.SideBar.myFavorites),s("div",{className:"fxs-sidebar-divider"})),s("div",{className:"fxs-sidebar-middle fxs-sidebar-menu-activated-hidden"},s("ul",{className:"fxs-sidebar-favorites fxs-sidebar-list","aria-label":l.SideBar.svcList,afterMount:(e,t)=>{const s=new MutationObserver((()=>{if(!e.querySelector('.fxs-sidebar-item-link[tabindex="0"]')){const t=e.querySelector(".fxs-sidebar-item-link");t&&t.setAttribute("tabindex","0")}}));s.observe(e,{childList:!0}),t.registerForDispose((()=>s.disconnect())),new a.KeyboardNavigation(t,{element:$(e),tabTriggers:12,itemSelector:".fxs-sidebar-item-link"})}},s(i.ForEach,{collection:t.effectiveFavorites,fn:({item:e})=>s("li",{className:"fxs-sidebar-item fxs-sidebar-favorite-item fxs-sidebar-draggable fxs-sidebar-droppable",draggable:"true","data-id":e.id,onDragStart:S},s("a",{tabindex:"-1",className:"fxs-sidebar-item-link",href:e.uri,title:e.label,"aria-label":e.label,onClick:P},s("div",{className:"fxs-sidebar-icon",image:e.image}),s("div",{className:"fxs-sidebar-label"},e.label,e.portalService?` (${e.portalService.serviceHubDisplayName})`:null),e.opensExternal?s("div",{className:"fxs-sidebar-external",image:b}):null,s("div",{className:"fxs-sidebar-handle",image:y})),s("div",{className:"fxs-hover-card-balloon",style:{display:"hidden"},"data-name":e.id,"data-source":"SidebarFavorite"}))})))),falseFn:()=>s("div",{className:"fxs-sidebar-content"})}),s("div",{className:"fxs-sidebar-shadow"})))})});function S(e){const t=e.event,s=t.currentTarget,i=t.dataTransfer;if(i){i.setData("text","fxs-draganddrop"),i.effectAllowed="move";const e=s.querySelector(".fxs-sidebar-item-link");if(e){const t=e.cloneNode(!0),s=e;t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.width=s.offsetWidth+"px",t.style.height=s.offsetHeight+"px",t.style.backgroundColor=window.getComputedStyle(s).backgroundColor,t.style.pointerEvents="none",t.style.zIndex="-1",document.body.appendChild(t),i.setDragImage(t,s.offsetWidth/2,s.offsetHeight/2),setTimeout((()=>{document.body.contains(t)&&document.body.removeChild(t)}),0)}}C=s.getAttribute("data-id")??""}function I(){(t.hamburgerMode.value||2!==t.layoutMode.value)&&t.setCollapsed(!0)}function P(e){const s=e.event,i=s.currentTarget.parentElement.getAttribute("data-id"),o=t.favorites.value,n=o[function(e,t){for(let s=0;s<t.length;++s)if(t[s]&&t[s].id===e)return s;return-1}(i,o)];if(MsPortalFx.Base.Diagnostics.Telemetry.trace({source:"SideBar",name:i,action:"SideBarItemOpened",data:{isFavorite:n.isFavorite()}}),(0,c.isCtrlOrCommandOnly)(s)||s.shiftKey)return!0;t.openFavorite(n)&&s.preventDefault(),I()}};const f=window.fx.environment})),
define("MsPortalImpl/Utilities/UrlUtilities",["require","exports"],(function(e,t){"use strict";t.getDebugAnalyzerHostname=function(){if(location.hostname.endsWith("microsoft.scloud"))return"extensionanalyzer.appservice.microsoft.scloud";return location.hostname.endsWith("eaglex.ic.gov")?"extensionanalyzer.appservice.eaglex.ic.gov":"extensionanalyzer.azure-test.net"},t.getUnsafeParams=function(e){const t=["clientoptimizations","feature.customportal","l","feature.consoletelemetry","feature.telemetryinsights","feature.usertype","homeview"],s=new URLSearchParams(new URL(location.href).search),i=new Map;for(const[e,o]of s)t.includes(e.toLowerCase())||i.set(e,o);return e?new Map(Array.from(i).slice(0,e)):i},t.isTestEnvironment=function(){return location.hostname.endsWith("azure-test.net")||"localhost"===location.hostname||"onestb.cloudapp.net"===location.hostname||"local-prod.portal.azure.com"===location.hostname}})),
define("MsPortalImpl/Resources/Resources.Images",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=[{MsPortalImpl:[{AdvisorNotifications:[{AdvisorDashboard:["cscz.svg","dede.svg","enus.svg","eses.svg","frfr.svg","huhu.svg","itit.svg","jajp.svg","kokr.svg","nlnl.svg","plpl.svg","ptbr.svg","ptpt.svg","ruru.svg","svse.svg","trtr.svg","zhcn.svg","zhtw.svg"]}]},{AvatarMenu:[{AvatarMenu:["defaultAvatarSmall.png"],Badge:["github.png"]}]},{AzHome:[{AzHome:["fRE_Dark.avif","fRE_Light.avif"]}]},{Blade:[{Blade:["icon.gif"]}]},{ControlsWizard:[{ControlsWizard:["loadingImage.gif"]}]},{General:[{FlowLayout:["gridShadow.png"]}]},{Notice:[{Notice:["comingSoon.png","noSubscription.png","unauthorized.png"]}]},{PartError:[{PartError:["icon.png"]}]},{PartGallery:[{PartGallery:["collectionPartWithRollup.svg","collectionSummary.svg","donutChart.svg","donutChartPartial.svg","extensions.svg","gridWithMoreData.svg","map.svg","multiLineChartMultiTrendLine.svg","multiScatterChart.svg","multiStackedBarChart.svg","mutliLineChart.svg","pricingTier.svg","quotaGauge.svg","resourceMap.svg","singleAreaChart.svg","singleAreaChartSingleThreshold.svg","singleAreaChartSingleTrendline.svg","singleBarChartLarge.svg","singleBarChartSmall.svg","singleLineChart.svg","singleScatterChart.svg","singleScatterSingleThreshold.svg","singleValueGauge.svg","splitBarChart.svg","stackedAreaChart.svg"]}]},{ProvisioningPart:[{ProvisioningPart:["running.gif"]}]}]}];["AdvisorDashboard","AvatarMenu","Badge","AzHome","Blade","ControlsWizard","FlowLayout","Notice","PartError","PartGallery","ProvisioningPart"].forEach((e=>{var i;t["get"+e]=(i=e,()=>MsPortalFx.getImages(s,i))}))})),
define("MsPortalImpl/Widgets/Widgets.DropMenu",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","Fx/Telemetry","MsPortalImpl/Weave/Util","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css"],(function(e,t,s,i,o,n,r,a,l,c){"use strict";t.Widget=t.ViewModel=void 0;var d=s;(0,l.injectCss)(c);const p="fxs-dropmenu-button",u="fxs-dropmenu-hidden",m="fxs-dropmenu-is-open",g="fxs-dropmenu-invisible",h="aria-label",f=d.tsx(s.Root,null,d.tsx("div",{class:"fxs-dropmenu",role:"presentation"},d.tsx("button",{class:"fxs-dropmenu-button","aria-haspopup":"true","aria-expanded":"false"}),d.tsx("div",{class:"fxs-dropmenu-content fxs-text-link",role:"menu"})));class x extends o.ViewModel{constructor(e,t,s,i,o){super(),this.isMenuOpen=ko.observable(!1),this.buttonLabel=ko.observable(),this.buttonDescribedBy=ko.observable(),this.buttonTooltip=ko.observable(),this.menuLabel=ko.observable(),this.buttonTemplate=e,this.menuTemplate=t,this.togglesVisibility=!!i,this.itemSelector=s,this.telemetrySource=o,this.autoDismissMenu=!0}open(){this.isMenuOpen(!0)}close(){this.isMenuOpen(!1)}toggle(){this.isMenuOpen(!this.isMenuOpen.peek())}}t.ViewModel=x;class b extends o.Widget{constructor(e,t,s,i=!1){super(e,t,i),this._newRender=s;const o=this.ltm;if(s){const t=e[0].querySelector(".fxs-dropmenu"),s=t.querySelector(".fxs-dropmenu-button"),i=t.querySelector(".fxs-dropmenu-content");this._dropMenu=$(t),this._dropMenuButton=$(s),this._dropMenuContent=$(i)}else{const s=MsPortalFx.getUniqueId(),i=this._dropMenu=$(FxImpl.createElement("div",{trustedInnerHTML:f}).children[0]);this._dropMenuButton=i.find(`.${p}`).attr("id",t.buttonId||null).addClass(t.buttonClass).addClass("fxs-popup-button").html(t.buttonTemplate).attr("aria-controls",s),this._dropMenuContent=i.find(".fxs-dropmenu-content").html(t.menuTemplate).attr("id",s).addClass("fxs-popup").addClass("fxs-portal-bg-txt-br").addClass("msportalfx-shadow-level2").addClass(0===t.alignMenu?"fxs-dropmenu-right":"fxs-dropmenu-left"),e.append(this._dropMenu)}const n=this._dropMenuButton,a=this._dropMenuContent,l=this._dropMenu;if(t.isMenuOpen[s?"subscribe":"subscribeAndRun"](o,(e=>{e?(t.telemetrySource&&(0,r.trace)({source:t.telemetrySource,action:"DropMenuOpened"}),this._show()):this._hide()})),!s){let e,s;ko.reactor(o,(()=>{n.attr("title",t.buttonTooltip()).attr(h,t.buttonLabel()),a.attr(h,t.menuLabel())}));const i="click";l.on(i,`.${p}`,e=e=>{e.preventDefault(),t.toggle()}),a.on(i,t.itemSelector,s=e=>{t.close()}),o.registerForDispose((()=>{l.off(i,`.${p}`,e),a.off(i,t.itemSelector,s)}))}let c;window.addEventListener("resize",(()=>{this.options.close()}));const d="contextmenu";e.on(d,c=e=>{if(t.isMenuOpen())return!1}),o.registerForDispose((()=>{e.off(d,c)}))}_show(){this._newRender||(this._dropMenuButton.attr("aria-expanded",!0),this._dropMenuContent.removeClass(`${g} ${u}`).addClass(m).attr("aria-hidden",!1));const e=this._dropMenuContent;if(this.options.autoDismissMenu){if(!this._dismissHandle){const e=e=>$.contains(this._dropMenu[0],e)?0:2;this._dismissHandle={dismissFn:()=>{this.options.close()},shouldDismissOnFocusOutFn:()=>$.contains(this._dropMenu[0],document.activeElement)?0:1,shouldDismissOnMouseDownFn:e,shouldDismissOnMouseWheelFn:e,restoreFocus:()=>{this._dropMenuButton[0].focus()},logName:"dropMenu"}}if(!this._dismissLifetime||this._dismissLifetime.isDisposed()){const t=this._dismissLifetime=this.ltm.createChildLifetime(),s=this._dismissHandle;i.register(s),new n.KeyboardNavigation(this._dismissLifetime,{element:e,tabTriggers:12,itemSelector:this.options.itemSelector}),t.registerForDispose([()=>{i.unregister(s)}])}}else this._dismissLifetime&&this._dismissLifetime.dispose();this.options.containInViewport&&requestAnimationFrame((()=>{const e=window.innerWidth-this._dropMenuContent[0].getBoundingClientRect().right-20;e<0&&this._dropMenuContent.css({left:`${e}px`})})),this.options.setItemFocusWhenOpen&&(this._newRender?(0,a.tryFocusAfterChangePropagation)(e[0]):e.focus())}_hide(){this._newRender||(this._dropMenuButton.attr("aria-expanded",!1),this._dropMenuContent.addClass(this.options.togglesVisibility?g:u).removeClass(m).attr("aria-hidden",!0)),this.options.containInViewport&&this._dropMenuContent.css({left:""}),this._dismissLifetime&&this._dismissLifetime.dispose()}setFocus(){this.options.isMenuOpen.peek()?this._newRender?(0,a.tryFocusAfterChangePropagation)(this._dropMenuContent[0]):this._dropMenuContent.focus():this._newRender?(0,a.tryFocusAfterChangePropagation)(this._dropMenuButton[0]):this._dropMenuButton.focus()}}t.Widget=b})),
define("MsPortalImpl/Widgets/Widgets.DropMenu.Component",["require","exports","Weave/DirectMode","MsPortalImpl/Widgets/Widgets.DropMenu","FxInternal/Weave","Weave","FxInternal/Weave/Util"],(function(e,t,s,i,o,n,r){"use strict";function a(e){const t=e.vm,i=MsPortalFx.getUniqueId(),a=(0,o.toComputation)(t.isMenuOpen),l=a.compose(r.negation),c=MsPortalFx.getUniqueId(),d=(0,o.toComputation)(t.buttonDescribedBy);return s("div",{className:"fxs-dropmenu",role:"presentation"},s("button",{id:t.buttonId,"aria-controls":i,className:["fxs-dropmenu-button","fxs-popup-button",t.buttonClass],"aria-haspopup":"true","aria-expanded":a,title:(0,o.toComputation)(t.buttonTooltip),"aria-label":e.buttonLabel||(0,o.toComputation)(t.buttonLabel),"aria-describedby":d.compose((e=>e?c:null)),onClick:({event:e})=>{e.preventDefault(),t.toggle()}},e.button),s(n.If,{condition:d,concealmentBehavior:"remove",trueFn:()=>s("div",{id:c,className:"az-display-none"},d)}),s("div",{id:i,className:["fxs-dropmenu-content","fxs-text-link","fxs-popup","fxs-portal-bg-txt-br","msportalfx-shadow-level2",0===t.alignMenu?"fxs-dropmenu-right":"fxs-dropmenu-left",{"fxs-dropmenu-is-open":a,[t.togglesVisibility?"fxs-dropmenu-invisible":"fxs-dropmenu-hidden"]:l}],role:"menu","aria-hidden":l,"aria-label":(0,o.toComputation)(t.menuLabel),onClick:({event:e})=>{const s=e.currentTarget;let i=e.target;for(i&&!i.matches&&(Element.prototype.matches=Element.prototype.msMatchesSelector);i&&!i.matches(t.itemSelector)&&i!==s;)i=i.parentElement;i&&i.matches(t.itemSelector)&&t.close()}},e.content))}t.DropMenu=function(e){return s("div",{className:e.className,afterMount:(t,s)=>{s.registerForDispose(new i.Widget($(t),e.vm,!0))}},s(a,{button:e.button,buttonLabel:e.buttonLabel,content:e.content,vm:e.vm}))},t.DropMenuInner=a})),
define("_generated/MsPortalImpl/Svg/Internal/LockedShieldIcon.svg",["require","exports"],(function(e,t){"use strict";t.type=t.data=void 0;t.type=1,t.data="<svg viewBox='0 0 14 14' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path fill-rule='evenodd' clip-rule='evenodd' d='M7 3.5a1 1 0 0 0-1 1V5h2v-.5a1 1 0 0 0-1-1Zm-2 1V5a1.5 1.5 0 0 0-1.5 1.5v3A1.5 1.5 0 0 0 5 11h4a1.5 1.5 0 0 0 1.5-1.5v-3A1.5 1.5 0 0 0 9 5v-.5a2 2 0 1 0-4 0Zm2 4A.75.75 0 1 0 7 7a.75.75 0 0 0 0 1.5Z' class='msportalfx-svg-c01'/></g></svg>"})),
define("MsPortalImpl/Widgets/Widgets.AvatarMenu.Component",["require","exports","Weave/DirectMode","MsPortalImpl/Widgets/Widgets.DropMenu.Component","FxInternal/Weave","Weave","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Resources/Resources.Images","_generated/MsPortalImpl/Svg/Internal/LockedShieldIcon.svg"],(function(e,t,s,i,o,n,r,a,l){"use strict";t.AvatarMenu=function(e){const{vm:t,className:c}=e;let d,p=0;const u=()=>d&&d(),m=a.getAvatarMenu().defaultAvatarSmall,g=(0,n.composeComputation)([t.userIdentity,t.avatarImage],((e,t)=>e&&!e.isAnonymous&&(t||e.defaultAvatarUri||"").trim()||m)),h=s("div",{className:["fxs-avatarmenu-header",{"fxs-avatarmenu-open":(0,o.toComputation)(t.dropMenuOptions.isMenuOpen)}],title:t.tooltip,onTouchStart:x,onMouseDown:x,onTouchEnd:u,onMouseUp:u},s("div",{className:"fxs-avatarmenu-tenant-container"},s("div",{className:"fxs-avatarmenu-username"},t.displayName),s("div",{className:"fxs-avatarmenu-tenant"},t.tenantDisplayName)),s("div",{className:"fxs-avatarmenu-tenant-image-container"},s("img",{className:"fxs-avatarmenu-tenant-image",src:g,alt:""}),t.userIdentity.compose((e=>MsPortalFx.isFeatureEnabled("mfaavatarshield")&&e?.isMfa?s("span",{image:l,className:"fxs-avatarmenu-tenant-image-overlay"}):e?.gitHubUserId?s("img",{className:"fxs-avatarmenu-tenant-image-overlay",src:MsPortalFx.Base.Resources.getVersionlessContentUri("Content/static/MsPortalImpl/AvatarMenu/badge_github.png"),alt:""}):"")))),f=s("div",{className:"fxs-flyout"});return s(n.GetContext,{fn:({diContainer:e})=>s("div",{className:["fxs-avatarmenu",c],afterMount:(s,i)=>{d=()=>{p&&Date.now()-p>t.showDiagnosticsDelay&&MsPortalFx.require("MsPortalImpl/UI/UI.Portal.Actions").then((i=>{i.showDebugPrompt(e,s,t)})),p=0},i.registerForDispose((()=>d=null))}},s(i.DropMenuInner,{vm:t.dropMenuOptions,buttonLabel:(0,n.composeComputation)([t.displayName,t.tenantDisplayName],((e,t)=>`${r.AvatarMenu.label} ${t?r.AvatarMenu.userWithTenantLabel.format(e,t):r.AvatarMenu.userLabel.format(e)}`)),button:h,content:f}))});function x(){p=Date.now()}}})),
define("_generated/MsPortalImpl/Svg/Startup/Close.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=55,t.data="<svg viewBox='0 0 15.8 15.8' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m8.7 7.9 7.1 7.1-.8.8-7.1-7.1-7.1 7.1L0 15l7.1-7.1L0 .8.8 0l7.1 7.1L15 0l.8.8z'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Startup/Search.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=248,t.data="<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m10.5 0 1.5.2a3.8 3.8 0 0 1 1.3.6l1.1.8.9 1.1a6.9 6.9 0 0 1 .5 1.3 7.7 7.7 0 0 1 .2 1.5 7.7 7.7 0 0 1-.2 1.5 6.9 6.9 0 0 1-.5 1.3l-.9 1.1-1.1.9-1.3.5-1.5.2a5.8 5.8 0 0 1-1.9-.3 5.4 5.4 0 0 1-1.6-1L.9 15.9H.1a.8.8 0 0 1 0-.8L6.3 9a5.4 5.4 0 0 1-1-1.6A5.8 5.8 0 0 1 5 5.5 7.7 7.7 0 0 1 5.2 4a3.8 3.8 0 0 1 .6-1.3 4.4 4.4 0 0 1 .8-1.1L7.7.8A3.8 3.8 0 0 1 9 .2zm0 10a3.9 3.9 0 0 0 1.8-.4 4.2 4.2 0 0 0 1.4-.9 4.2 4.2 0 0 0 .9-1.4 3.9 3.9 0 0 0 .4-1.8 3.3 3.3 0 0 0-.4-1.7 3.8 3.8 0 0 0-.9-1.5 4.2 4.2 0 0 0-1.4-.9 3.9 3.9 0 0 0-1.8-.4 3.3 3.3 0 0 0-1.7.4 3.8 3.8 0 0 0-1.5.9 3.8 3.8 0 0 0-.9 1.5A3.3 3.3 0 0 0 6 5.5a3.9 3.9 0 0 0 .4 1.8 4.2 4.2 0 0 0 .9 1.4 3.8 3.8 0 0 0 1.5.9 3.3 3.3 0 0 0 1.7.4z'/></g></svg>"})),
define("MsPortalImpl/Widgets/Widgets.Search.Component",["require","exports","Weave/DirectMode","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Weave/Util","FxInternal/Weave","Weave","_generated/MsPortalImpl/Svg/Startup/Search.svg","_generated/MsPortalImpl/Svg/Startup/Close.svg"],(function(e,t,s,i,o,n,r,a,l){"use strict";t.Search=function(e){const{vm:t,className:c}=e,d=i.KeyboardShortcuts.search,p=(0,n.toComputation)(t.filter).compose(o.negation),u=MsPortalFx.isFeatureEnabled("asyncsearch")||MsPortalFx.isFeatureEnabled("globalsearch")?i.Search.globalPlaceholder:i.Search.placeholder,m=new r.ElementRef;return s("div",{className:["fxs-search",c,{"fxs-search-activated":t.isExpanded,"fxs-search-showmenu":(0,n.toComputation)(t.showMenu)}],role:"search"},s("div",{className:["fxs-search-wrapper",{"fxs-searching":(0,n.toComputation)(t.showSearching)}]},s("div",{"aria-hidden":"true",className:"fxs-search-icon-mini",image:a}),s("div",{className:"fxs-search-box fxs-topbar-input"},s("input",{"aria-autocomplete":"list",type:"text",className:"azc-input","aria-label":u,placeholder:u,autocomplete:"off",maxlength:100,ref:m})),s("div",{className:"fxs-search-indicator"},s("div",null),s("div",null),s("div",null)),s("div",{role:"presentation",className:["fxs-search-clear",{"fxs-display-none":p}],image:l})),s("a",{href:"#",className:"fxs-search-icon fxs-topbar-button",role:"button",title:d,"aria-label":d,image:a,onFocus:g,onMouseDown:g}),s("div",{className:"fxs-search-menu fxs-dropmenu-content fxs-portal-background msportalfx-shadow-level4"}));function g(e){e.event.preventDefault(),t.isExpanded(!0),m.focus()}}})),
define("MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding",["require","exports","MsPortalImpl/Controls/ControlBindings","Fx/DependencyInjection","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl.Controls/Controls/Base/WidgetBinding","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl/Base/Base.LruMap"],(function(e,t,s,i,o,n,r,a,l){"use strict";t.getTrustedFragment=function(e,t,s,i,o){return C(e,t,s?1:0,i,o)},t.shouldDisableKO=D,t.testDisableKoVmUndefined=void 0;var c=ko.utils,d=ko.bindingHandlers;const p=c.domData,u=MsPortalFx.Base.Diagnostics.createLog(e),m="htmlTemplate",g="stringOrHtmlContent",h="untrustedHtml",f="untrustedContent",x="trustedHtml",b="trustedContent",y=document.createRange(),v=new l.LruMap(1e3),w=new l.LruMap(1e3),M=new l.LruMap(1e3);function C(t,s,i,n,r,a){let l;if(s){const c=(1===i?M:n?w:v).getOrAdd(s,(s=>{if(1!==i){const i=n?o.KODeniedTemplateSanitizer:o.KOAllowedTemplateSanitizer;s=t.get(i).sanitize({diContainer:t,value:s,localRequire:e,windowContext:r,contextData:a}).sanitizedMarkup}return s&&y.createContextualFragment(s)}));c&&(l=c.cloneNode(!0))}return l}const S=e=>{const t=e.$ctl;return t?.isTrusted},I=T(0,h,S),P=T(1,x),_=[null,null,I,d.pcControl.update,P];function F(e,t,s,i,o){return{controlsDescendantBindings:!0}}function T(e,t,s){return(o,r,a,l,d)=>{const p=ko.unwrap(r());let u,m,g,h,f=p;null!==p&&"object"==typeof p&&(f=ko.unwrap(p.html),m=p.data,u=ko.unwrap(m),g=ko.unwrap(p.isolated),h=!!p.disableKO),ko.ignoreDependencies((()=>{let r=e;0===r&&s?.(d)&&(r=1);const a=C(d.$dicontainer||i.container,f,r,h,o,{BindingName:t});g?d=n.createIsolatedContext(u||l,d):m&&(d=d.createChildContext(u)),c.cleanDescendantNodes(o),a?(o.innerHTML="",o.appendChild(a),ko.applyBindingsToDescendants(d,o)):o.innerHTML=""}))}}function k(e,t,s,i){return(o,n,l,d,u)=>{let m=ko.unwrap(n())||"",g=1;ko.ignoreDependencies((()=>{let n=e;0===n&&s?.(u)&&(n=1);const l=p.get(o,t);if(m.controlType&&!i)g=3;else if(m.htmlTemplate){g=1===n?4:2;const e=m.htmlTemplate,t=m.viewModel,s=D(e,t,1===n,u?.$extensionName,u?.$partName);m={html:e,data:t,disableKO:s}}if(p.set(o,t,g),3===l){r.cancelBindings(o);const e=a.getWidget($(o));MsPortalFx.disposeDisposable(e)}l&&1!==l&&c.cleanDescendantNodes(o),1===g?o.textContent=m:o.innerHTML=""})),1!==g&&_[g](o,(()=>m),l,d,u)}}d[m]={init:F,update:T(0,m)},d[h]={init:F,update:I},d[x]={init:F,update:P},d[f]={init:F,update:k(0,f,S)},d[b]={init:F,update:k(1,b)},d[g]={init:F,update:k(0,g,null,!0)};const E=t.testDisableKoVmUndefined=ko.observable();function D(e,t,s,i,o){const n=!s&&void 0===t,r=function(){if(void 0!==E())return E();const e=fx?.environment?.trustedParentOrigin??"",t=e.startsWith("https://localhost")||e.startsWith("https://onestb.cloudapp.net"),s=FxImpl.getShellAssignments();if(!s?.isAvailable)return t;const i=s.getBooleanValue("disablekovmundefined");return void 0===i?t:i}();if(n&&/\bdata-bind\b/.test(e)){const t="Knockout template with data-bind {0} blocked by disablekovmundefined experiment. Please provide a viewModel or supply null for the viewModel instead of undefined",s={htmlTemplate:e,extension:i,part:o};r?u.error(t.format("was"),void 0,s):u.warning(t.format("would be"),void 0,s)}return r&&n}})),
define("MsPortalImpl/Weave/Components",["require","exports","Weave","WeaveDOM/Core/InternalUtil","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Weave/Util","MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding"],(function(e,t,s,i,o,n,r){"use strict";function a(e){return"string"==typeof e.content?l(e.content,e.require,e.skipSanitization||!1):e.content?e.content.compose((t=>l(t,e.require,e.skipSanitization||!1))):void 0}function l(e,t,s){return{type:"html",data:{content:e,moduleName:t.normalize(),skipSanitization:s}}}function c(e){return{type:"external",applyBindingHandler:p,content:e.content,skipSanitization:e.skipSanitization||!1}}function d(e,t,s){return e?"string"==typeof e?s?e:a({skipSanitization:!1,content:e,require:t}):c({skipSanitization:!1,content:e,require:t}):null}function p(t,a,l){const c=a.dynamicNodeId,d=this.skipSanitization,p=t.getDynamicNodeMetadata(c),m=p.selfLtm.innerLtmRoot,{commentStart:g,commentEnd:h}=p;let f;(0,s.subscribeAndRun)(m,[this.content],(s=>{if(f&&f.dispose(),f=m.createChildLifetime(),u(g,h),t.clear(a),s&&s.htmlTemplate){const t=(0,r.shouldDisableKO)(s.htmlTemplate,s.viewModel,d,l?.extensionName,l?.partName),a=d?s.htmlTemplate:l.diContainer.get(t?o.KODeniedTemplateSanitizer:o.KOAllowedTemplateSanitizer).sanitize({value:s.htmlTemplate,localRequire:e,windowContext:$(g.parentElement),diContainer:l.diContainer,contextData:{weaveCommentNodeText:p.commentStart.textContent}}).sanitizedMarkup;(0,i.insertHtmlBeforeNode)(h,a),function(e,t,s,i){if(ko.isObservable(t)){let o;t.subscribeAndRun(e,(t=>{if(o&&o.dispose(),o=e.createChildLifetime(),ko.isObservable(t)){let e;t.subscribeAndRun(o,(t=>{e&&e.dispose(),e=o.createChildLifetime(),i((0,n.weaveContextToKoContext)(s,e,t))}))}else i((0,n.weaveContextToKoContext)(s,o,t))}))}else i((0,n.weaveContextToKoContext)(s,e,t))}(f,s.viewModel,l,(e=>{u(g,h),function(e,t,s){const o=t.nextSibling;let n=o;const r=ko.bindingProvider.instance,a=r.preprocessNode;if(a){for(;n&&n!==s;){const e=ko.virtualElements.nextSibling(n);a.call(r,n),n=e}n=o}for(;n&&n!==s;){const t=ko.virtualElements.nextSibling(n);((0,i.isNodeType)(n,1)||(0,i.isNodeType)(n,8))&&ko.applyBindings(e,n),n=t}}(e,g,h)}))}})),m.registerForDispose((()=>{u(g,h)}))}function u(e,t){let s=e.nextSibling;for(;s!==t;){const e=s.nextSibling;ko.cleanNode(s),s=e}}t.HtmlOrKo=function(e){return(0,s.isComputation)(e.content)?e.content.compose((t=>d(t,e.require,!1))):d(e.content,e.require,!1)},t.Ko=c,t.ShellHtml=a,t.TextOrKo=function(e){return(0,s.isComputation)(e.content)?e.content.compose((t=>d(t,e.require,!0))):d(e.content,e.require,!0)}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.ModalToast.css",["module"],(function(e){"use strict";return{css:".fxs-modaltoast-item{position:absolute;top:50%;left:50%;padding:24px;transform:translate(-50%,-50%);width:400px;border-radius:2px;overflow-y:auto;max-width:calc(90% - 32px);max-height:calc(90% - 32px)}.fxs-modaltoast-modalimage{padding-top:8px;padding-bottom:12px}.fxs-modaltoast-description{padding-bottom:12px;width:100%}.fxs-modaltoast-title{font-size:18px;font-weight:600;width:100%;padding-bottom:4px;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}.fxs-modaltoast-inlineform{text-align:center}.fxs-modaltoast-inlineform .fxc-section{display:flex}.fxs-modaltoast-inlineform .fxc-simplebutton{margin-right:5px}.fxs-modaltoast-inlineform .fxc-simplebutton .fxs-button{display:inline-flex;max-width:100%}.fxs-modaltoast-inlineform .fxs-button-text{display:inline-block;width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-modaltoast-close{position:absolute;top:8px;right:8px;background:none;border:0;cursor:pointer}.fxs-modaltoast-close svg{height:12px;width:12px}.fxs-mode-dark .fxs-modaltoast-close{background-color:#323130}",moduleId:e.id}})),
define("MsPortalImpl/Widgets/Widgets.ModalToast",["require","exports","Weave/DirectMode","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Interactions/Interactions.DismissHandler","_generated/Less/MsPortalImpl/Widgets/Widgets.ModalToast.css","Weave","MsPortalImpl/Weave/Components","MsPortalImpl/Resources/ImplScriptResources"],(function(e,t,s,i,o,n,r,a,l){"use strict";let c;t.ModalToast=function(t){const{vm:m}=t,g=m.modalToast;let h;const f={dismissFn:()=>{x()},logName:"modalToast"},x=()=>{h.dispose(),o.unregister(f);const e=g.value;e&&e.onDismissFn&&e.onDismissFn(!1),c.focus()};return o.register(f),s("div",{className:"fxs-portal-shield"},s(r.Css,{css:n}),s("div",{className:"fxs-portal-modaltoast",role:"presentation",afterMount:(e,t)=>{h=new i.KeyboardNavigation(t,{element:$(e)}),c=$(document.activeElement);const s=$(e).find(".fxs-modaltoast-description").findFirstTabbable();if(s.length>0)return s.focus();const o=$(e).find(".fxs-modaltoast-inlineform").findFirstTabbable();o.length>0?o.focus():$(e).findFirstTabbable().focus()}},s(r.If,{condition:g,trueFn:()=>s("div",{className:"fxs-modaltoast-item fxs-portal-bg-txt-br fxs-popup msportalfx-shadow-level3",style:{width:g.value.modalNotificationData?.width||"400px"}},s("button",{tabindex:0,className:"fxs-modaltoast-close fxs-portal-svg fxs-button-default","aria-label":l.ModalToast.closeModal,image:MsPortalFx.Base.Images.Close(),onClick:({event:e})=>{x(),e.preventDefault()},title:l.NotificationMenu.dismissModalToast},l.NotificationMenu.dismissModalToast),s(r.If,{condition:g.compose((e=>e.modalNotificationData?.image?.imageUrl)),trueFn:()=>{const e=g.value.modalNotificationData.image;return s("div",{className:"fxs-modaltoast-modalimage",afterMount:(e,t)=>{const s=$(e);if(s.children("img").hasClass(p)){let e=0,i=0;const o=new ResizeObserver((t=>{if((0===e&&s.outerHeight()>0||e<s.outerHeight())&&(e=s.outerHeight()),e>0){const e=t[0].target.clientHeight,o=document.querySelector(".fxs-modaltoast-item");o.scrollHeight>o.clientHeight&&(0===i&&(i=o.scrollHeight),s.attr("hidden",!0)),e*u>i+2*d&&s.attr("hidden",!1)}}));o.observe(document.body),t.registerForDispose((()=>{o.unobserve(document.body)}))}}},s("img",{src:e.imageUrl,alt:e.alternativeText||"",className:!0===e.showOnZoom||"true"===e.showOnZoom?"":p,style:{width:e.imageWidth||"100%",height:e.imageHeight||"auto"},role:"image"}))}}),s("div",{className:"fxs-modaltoast-title fxs-portal-text",tabindex:"-1"},g.compose((e=>e.title))),s("div",{className:"fxs-modaltoast-description fxs-portal-title",tabindex:"-1"},s(a.ShellHtml,{content:g.compose((e=>"string"==typeof e.description?e.description:e.description.htmlTemplate)),require:e})),g.compose((e=>e.formSection?e.formSection.section("msportalfx-form fxs-modaltoast-inlineform"):null)))})))};const d=16,p="msportalfx-modalimage-hideonzoom",u=.9})),
define("MsPortalImpl/Widgets/Widgets.ModalToastViewModel",["require","exports","Weave"],(function(e,t,s){"use strict";t.ViewModel=void 0;t.ViewModel=class{constructor(){this.modalToast=(0,s.makeWritableComputation)()}addModalToast(e){if(!this.modalToast.value){this.modalToast(e);const t=e.formSection;if(t){const s=t.buttons;s.forEach(((t,i)=>{const o=s[i].onClick;s[i].onClick=()=>{o(),e.onDismissFn&&e.onDismissFn(!0,i)}}))}}}}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.NotificationsPane.css",["module"],(function(e){"use strict";return{css:"@keyframes fxs-notificationmenu-indeterminate-progress{from{left:-100%}to{left:150%}}.fxs-notificationspane-progressbar{position:absolute;overflow:hidden;height:2px;top:35px;left:1px;bottom:1px;right:1px;transition:opacity 1.5s ease-in-out 1s}.fxs-notificationspane-progressbar>div{position:absolute;width:60%;height:100%;animation:fxs-notificationmenu-indeterminate-progress 1.5s linear infinite;background-color:#00bcf2}.fxs-notificationspane-button-unreadcount{font-size:10px;position:absolute;top:5px;right:5px;border-radius:16px;text-align:center}.fxs-notificationspane-button-unreadcount-circle{height:16px;width:16px}.fxs-notificationspane-button-unreadcount-oval{width:28px}.fxs-notificationspane-header{padding:0 20px 10px}.fxs-notificationspane{width:525px;max-width:100%;height:100%;box-sizing:border-box;font-size:13px;line-height:normal;display:flex;flex-direction:column;overflow:hidden}.fxs-notificationspane-label{color:#fff;padding-bottom:3px}.fxs-notificationspane-top{overflow:auto;width:100%;padding:0 20px;box-sizing:border-box}.fxs-notificationspane-top .nodata-content{padding:15px 0;text-align:center;font-weight:bold;font-size:14px}.fxs-notificationspane-dismisscontainer{margin-left:auto;display:flex}.fxs-notificationspane-dismissitem{display:flex}.fxs-notificationspane-list{overflow:hidden;list-style:none;padding:0;margin:0;width:100%}.fxs-notificationmenu-notification-wrapper{padding:10px 5px 10px 10px;display:flex;position:relative}.fxs-notificationmenu-notification-li.fxs-portal-border{border-top-width:1px;border-top-style:solid}.fxs-notificationmenu-notification-li.fxs-portal-border:last-child{border-bottom-width:1px;border-bottom-style:solid}.fxs-notificationmenu-notificationclick:hover{text-decoration:underline}.fxs-notificationmenu-notification-dismissIcon{cursor:pointer;background-color:transparent;border:0;margin:0;padding:0;height:14px;width:10px;opacity:.4;margin-left:4px;padding-right:15px;padding-bottom:8px;flex:0 0 auto;position:absolute;top:8px;right:0;opacity:1}.fxs-notificationmenu-notification-dismissIcon svg{padding:5px}.fxs-mode-light .fxs-notificationmenu-notification-dismissIcon svg{fill:#605e5c}.fxs-notificationmenu-notification-expandIcon{cursor:pointer;background-color:transparent;border:0;margin:0;padding:0;height:8px;width:8px;opacity:.4}.fxs-notificationmenu-notification-dismissIcon:hover,.fxs-notificationmenu-notification-expandIcon:hover{opacity:1}.fxs-notificationmenu-notification-details{margin-top:10px;text-decoration:underline;cursor:pointer}.fxs-notificationmenu-notification-iconVerticalTransform{transform:scale(-1,-1);background-color:rgba(255,255,255,.3);padding-bottom:9px}.fxs-notificationmenu-notification-title{display:flex;padding-bottom:2px;max-width:calc(100% - 20px)}.fxs-notificationmenu-notification-title-icon{margin-right:4px;min-width:16px}.fxs-notificationmenu-notification-title-icon svg{height:16px;width:16px;vertical-align:middle}.fxs-notificationmenu-notification-title-text{font-size:14px;display:block;display:-webkit-box;line-height:19px;max-height:38px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow-wrap:break-word;margin:0 4px;flex:1 0 0;font-weight:600}.fxs-notificationmenu-notification-title-subtitle{font-size:13px;line-height:normal}.fxs-notificationmenu-notification-description{font-size:13px;line-height:normal;display:block;line-height:18px;max-height:144px;overflow:hidden;position:relative;padding-top:5px;text-overflow:ellipsis;white-space:pre-wrap;width:100%}.fxs-notificationmenu-notification-expandedDescription{max-height:100%;overflow-y:auto}.fxs-notification-inlineform{padding-top:15px}.fxs-notification-inlineform .fxc-section{display:flex}.fxs-notification-inlineform .fxc-simplebutton{display:grid;margin-right:5px}.fxs-notification-inlineform .fxc-simplebutton .fxs-button{display:inline-flex;max-width:100%}.fxs-notification-inlineform .fxs-button-text{display:inline-block;width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-notification-inlineform.fxs-notification-action-link{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-notification-inlineform.fxs-notification-action-link:hover{text-decoration:underline}.fxs-notification-inlineform:has(.ext-copilot-error-notification-icon) .fxs-button-icon{display:flex;height:20px;width:20px}.fxs-notificationmenu-notification-progressbar{margin-top:10px}.fxs-notification-dropdown-button-icon{height:14px;width:14px;display:flex;align-items:center;justify-content:center;cursor:pointer}.fxs-notification-dropdown-button-icon>svg{height:100%;width:100%}.fxs-notification-dropdown-button-container{display:flex;align-items:center}.fxs-notification-dropdown-button{margin:4px 5px 0;padding:4px 5px;opacity:.7;border:0;width:100%;text-align:left}.fxs-notifications-empty{display:flex;flex-direction:column;align-items:center;justify-content:center}.fxs-notifications-emptyicon{height:100px;width:100px;padding-top:40px;padding-bottom:20px;opacity:.4}.fxs-notification-header-content{display:flex;flex:1 1 auto;padding-top:15px}.fxs-notification-action-menu{margin-top:-5px}.fxs-notification-user-time-info{min-height:20px;padding-top:10px;text-decoration:#7a7a7a;display:flex}.fxs-notification-user-time-info .fxs-notification-user-time-info-part{margin-left:auto}.fxs-notification-user-time-info .fxs-notification-user-time-info-part:first-child{margin-left:0}.fxs-notification-seemore-link{display:flex;width:fit-content}.fxs-notification-feedback-wrapper{float:right;margin-left:auto;min-height:20px;padding-top:10px}.fxs-notification-is-this-helpful,.fxs-notification-thank-you{color:#292827;display:inline-flex;font-size:12px;font-weight:normal;line-height:15px}.fxs-notification-is-this-helpful{margin-right:6px}.fxs-notification-like-button,.fxs-notification-dislike-button{color:#0078d4;cursor:pointer;display:inline-block;fill:#0078d400;height:11px;margin:-1px 0 0 7px;stroke:#0078d4;width:13px;transform:scale(-1,1)}.fxs-notification-like-button:focus,.fxs-notification-dislike-button:focus{color:#106ebe;fill:#106ebe00;stroke:#106ebe;transform:scale(-1.1,1.1)}.fxs-notification-like-button:hover,.fxs-notification-dislike-button:hover{color:#106ebe;fill:#106ebe00;stroke:#106ebe;transform:scale(-1.1,1.1)}.fxs-notification-like-button.fxs-notification-feedback-selected,.fxs-notification-dislike-button.fxs-notification-feedback-selected{color:#106ebe;fill:#106ebe;stroke:#106ebe}.fxs-notification-dislikeButton{margin:3px 0 0 14px}.fxs-notification-hide{display:none}.fxs-notification-see-more-less{padding-right:5px}.fxs-notificationmenu-notification{width:100%}.fxs-notificationmenu-arrow{padding-top:2px;padding-left:3px;height:10px;width:10px}",moduleId:e.id}})),
define("MsPortalImpl/UI/Hubs/UI.NotificationHelper",["require","exports","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.ModalToastViewModel","MsPortalImpl/Widgets/Widgets.ModalToast","MsPortalImpl/Resources/PortalNotificationsTelemetry","MsPortalImpl/Notifications/IrisNotificationsTelemetry","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Weave/Components","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.NotificationsPane.css"],(function(e,t,s,i,o,n,r,a,l,c,d,p){"use strict";t.DEV=void 0,t.constructDescription=function(t,s){if("string"==typeof t)return s?(0,c.ShellHtml)({skipSanitization:!1,content:t,require:e}):t;return(0,c.ShellHtml)({skipSanitization:!1,content:t.htmlTemplate,require:e})},t.iconMap=void 0,t.showToastAndUpdateCount=function(e,t,a,c){3===t.status&&(w++,(0,i.unhide)($.querySelectorAll(".fxs-topbar-notifications>.fxs-notificationspane-progressbar")));if(4===t.toastDuration){if(!C){C=!0;const s=new o.ViewModel,i=new FxImpl.TriggerableLifetimeManager;return s.addModalToast({modalNotificationData:t.modalNotificationData,title:t.title,description:t.description,formSection:t.formSection,onDismissFn:(s,o)=>{i.dispose(),I(e,t,s?r.Action.NotificationClicked+(t.inlineForm?.buttons[o]?.id||o):r.ActionModifier.NotificationDismissed,r.Source.ToastTray)}}),void(0,l.appendToElement)({element:$.querySelectorAll("body")[0],ltm:i,weaveContext:{diContainer:e},weaveNode:(0,n.ModalToast)({vm:s})})}f.warning(`Modal toast already shown. Showing current toast as sticky. Details: ${JSON.stringify(t.irisNotificationDetails)}; Correlation ids: ${t.correlationIds.join(",")}`)}a.isPaneOpen()?Array.isArray(t.inlineForm?.buttons||t.actions)?(t.inlineForm?.buttons||t.actions||[]).forEach((e=>{e.id=r.Action.NotificationClicked+e.id})):t.actions&&"object"==typeof t.actions&&(t.actions.id=r.Action.NotificationClicked+t.actions.id):(Array.isArray(t.inlineForm?.buttons||t.actions)?(t.inlineForm?.buttons||t.actions||[]).forEach((e=>{e.id=r.Action.ToastClicked+e.id})):t.actions&&"object"==typeof t.actions&&(t.actions.id=r.Action.ToastClicked+t.actions.id),!S&&t.timestamp.getTime()>=a.lastPaneOpenedTime()&&P(++M),c.addToasts({notificationId:t.notificationId,icon:v[t.status],title:t.title,description:t.description||"",descriptionAsHtml:t.descriptionAsHtml,time:t.timestamp.toString({hour:"numeric",minute:"numeric"}),ids:t.correlationIds,descriptiveText:s.Toast.description.format(t.title),data:t,clickable:!!(t.asset||t.linkedBlade||t.uri||t.linkTo),formSection:t.formSection,duration:t.toastDuration,onDismissFn:()=>{I(e,t,r.Action.ToastDismissed,r.Source.ToastTray)},uri:t.uri}))},t.updateNotificationCount=function(e,t){!S&&!t.isPaneOpen()&&e.timestamp.getTime()>=t.lastPaneOpenedTime()&&M&&P(--M);3!==e.status||--w||(0,i.hide)($.querySelectorAll(".fxs-topbar-notifications>.fxs-notificationspane-progressbar"))},t.updateUnreadCountOnButton=P,(0,d.injectCss)(p);var u=MsPortalFx.Base,m=u.Diagnostics,g=u.Images.StatusBadge,h=MsPortalFx.Hubs.Notifications.NotificationStatus;const f=m.createLog(e),x="fxs-notificationspane-button-unreadcount",b="fxs-notificationspane-button-unreadcount-oval",y="fxs-notificationspane-button-unreadcount-circle",v=t.iconMap={};v[h.Information]=g.Info(),v[h.Warning]=g.Warning(),v[h.Error]=g.Error(),v[h.InProgress]=u.Images.Loading.EllipsisSquare(),v[h.Success]=g.Success();let w=0,M=0,C=!1;const S=MsPortalFx.isFeatureEnabled("enablecustomnotificationsprovider");function I(e,t,s,i){const o=t.irisNotificationDetails;o?(0,a.irisTelemetryHandler)({diContainer:e,messageArg:{irisNotificationDetails:o,action:s},messageContext:null}):m.Telemetry.trace({source:i,action:s,data:{notificationId:t.notificationId}})}function P(e){const t=$.querySelectorAll(".fxs-topbar-notifications");M=e,t.attr("aria-label",s.NotificationMenu.overflowTitle.format(e)),t.find(`.${x}`).remove(),e>20?t.append(FxImpl.createElement("div",{class:`${x} ${b}`},MsPortalFx.encodeHtml(s.NotificationMenu.overflowCountMessage))):e&&t.append(FxImpl.createElement("div",{class:`${x} ${y}`},e+""))}})),
define("MsPortalImpl/Widgets/Widgets.ToastViewModel",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/PortalNotificationsTelemetry","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","Weave"],(function(e,t,s,i,o,n,r){"use strict";t.ViewModel=void 0,t.addToasts=d,t.clearItemTimeout=a;FxImpl.Hubs.Notifications.ToastDuration;function a(e){const t=e?.timeoutID;t&&clearTimeout(t.value)}class l extends n.ViewModel{constructor(e={}){super(),this.items=(0,r.makeArrayComputation)(),this.eventHandlers=ko.observableArray(),this.addOSToast=null,this.displayCount=e.displayCount||4}static create(){return new l}addToasts(e){d(this,e)}removeToast(e){a(e),c(e),this.items.remove(e)}removeAllToasts(){this.items.value.forEach((e=>{a(e),c(e)})),this.items.clear()}startRemoveTimer(e){const t=e.duration?e.duration.value:0;2!==t&&e.timeoutID(setTimeout((()=>{this.items.remove(e),c(e)}),1===t?3e4:5e3))}}function c(e){const t=e?.data?.value||null,s=(t||Object.create(null)).inlineForm,o=(t||Object.create(null)).actions;s?.buttons?.length||Array.isArray(o)?(s?.buttons||o||[]).forEach((e=>{e.id&&e.id.startsWith(i.Action.ToastClicked)&&(e.id=i.Action.NotificationClicked+e.id.substring(i.Action.ToastClicked.length))})):o&&"object"==typeof o&&o.id?.startsWith(i.Action.ToastClicked)&&(o.id=i.Action.NotificationClicked+o.id.substring(i.Action.ToastClicked.length))}function d(e,t){const s=Array.isArray(t)?t:[t];s.length&&s.forEach((t=>{const s=e.items.value,n=t.icon,l=t.title,c=t.description,d=t.descriptionAsHtml,p=t.uri,u=t.time,m=t.ids||[],g=t.data||null,h=t.duration||0,f=t.htmlContent||"",x=!1!==t.clickable,b=t.descriptiveText||o.Toast.description.format(t.title),y=t.notificationId;if(3===h)return;let v;if(m.length>0&&(v=MsPortalFx.find(s,(e=>{const t=e.ids.value;return m.some((e=>t.includes(e)))}))),v)v.icon(n),v.title(l),v.description(c),v.descriptionAsHtml(d),v.uri(p),v.time(u),v.ids(m),v.data(g),v.clickable(x),v.htmlContent(f),v.descriptiveText(b),v.duration(h),v.formSection(t.formSection),a(v),e.startRemoveTimer(v);else{const i={icon:(0,r.makeWritableComputation)(n),title:(0,r.makeWritableComputation)(l),description:(0,r.makeWritableComputation)(c),descriptionAsHtml:(0,r.makeWritableComputation)(d),uri:(0,r.makeWritableComputation)(p),time:(0,r.makeWritableComputation)(u),ids:(0,r.makeWritableComputation)(m),data:(0,r.makeWritableComputation)(g),htmlContent:(0,r.makeWritableComputation)(f),timeoutID:(0,r.makeWritableComputation)(null),clickable:(0,r.makeWritableComputation)(x),onDismissFn:t.onDismissFn,descriptiveText:(0,r.makeWritableComputation)(b),duration:(0,r.makeWritableComputation)(h),formSection:(0,r.makeWritableComputation)(t.formSection),notificationId:y};(s.length<e.displayCount||function(e,t){const s=e.items.value;for(let i=0;i<=t+0;i++)for(let t=s.length-1;t>=0;t--){const o=s[t];if(o.duration.value===i)return e.removeToast(o),!0}return!1}(e,h))&&e.items.unshift(i);const o=g||{};if(Array.isArray(o.actions||o.inlineForm?.buttons)){const s=o.actions?.slice(0,3)||o.inlineForm?.buttons?.slice(0,3),n=t.formSection,r=n?.buttons?.slice(0,3);r?.length&&s&&MsPortalFx.isArrayOrObservableArray(s)&&s.forEach(((t,s)=>{if(!t.endpoint){const t=r[s].onClick;r[s].onClick=()=>{t(),e.removeToast(i)}}}))}else if(o.actions&&"object"==typeof o.actions){const s=o.actions,n=t.formSection,r=n?.link,a=s?.action;if(r&&a){const t=r.onClick;r.onClick=()=>{t(),e.removeToast(i)}}}e.startRemoveTimer(i)}MsPortalFx.Base.Diagnostics.Telemetry.trace({source:i.Source.ToastTray,action:i.Action.ToastAdded,data:{notificationId:y}}),e.addOSToast&&e.addOSToast(t)}))}t.ViewModel=l,__decorate([__metadata("fx:diagnostics",[e,"ViewModel"]),(0,s.Factory)(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",l)],l,"create",null)})),
define("MsPortalImpl/Widgets/Widgets.Toast.Component",["require","exports","MsPortalImpl/Widgets/Widgets.ToastViewModel","Weave/DirectMode","_generated/MsPortalImpl/Svg/Startup/Close.svg","MsPortalImpl/Resources/PortalNotificationsTelemetry","WeaveDOM/DirectRender/DataAttribute","Weave","FxInternal/Weave/Util","FxInternal/Weave","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Weave/Components","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css","MsPortalImpl/UI/Hubs/UI.NotificationHelper"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h){"use strict";t.Toast=function(t){const n=MsPortalFx.getFeatureValue("rapidtoasts");if("0"===n||"true"===n)return null;const{vm:m,className:g}=t;return i(a.GetContext,{fn:({diContainer:t})=>{const n=(0,c.toComputation)(t.get(d.GeneralSettings).notificationToastEnabledKey);return i(a.Once,{"data-odebug":"22",condition:(0,a.composeComputation)([n,m.items],((e,t)=>e&&t&&t.length>0)),trueFn:()=>i("div",{role:"presentation",className:g,afterMount:(e,t)=>{const s=$(e);m.eventHandlers.map(t,((e,t)=>{e.registerForDispose(s.setEvents([t.events,t.selector,e=>t.handler(e,(0,r.getElementData)($(e.target).closest(".fxs-toast-item")[0]))]))}))}},i("ul",{role:"presentation",className:["fxs-toast",{"fxs-display-none":n.compose(l.negation)}]},i(a.ForEach,{collection:m.items,fn:({item:t})=>{const n=()=>(0,s.clearItemTimeout)(t),r=()=>t.duration&&m.startRemoveTimer(t);return i("li",{data:t,className:"fxs-toast-item fxs-popup fxs-portal-bg-txt-br msportalfx-shadow-level4",role:"alert","aria-live":"polite","aria-atomic":"true","aria-label":t.descriptiveText,onFocusIn:n,onFocusOut:r,onMouseEnter:n,onMouseLeave:r},i(a.If,{condition:t.htmlContent,concealmentBehavior:"remove",trueFn:()=>i("div",{className:"fxs-toast-content","aria-hidden":"true"},i(u.ShellHtml,{content:t.htmlContent,skipSanitization:!0,require:e})),falseFn:()=>i("div",{className:"fxs-toast-wrapper"},i("div",{className:"fxs-toast-header"},i("div",{className:"fxs-toast-icon",image:t.icon}),i(a.If,{condition:t.clickable,concealmentBehavior:"remove",trueFn:()=>i("a",{href:"#",className:"fxs-toast-title fxs-toast-link",onClick:({event:e})=>{e.preventDefault(),t.clickable.value&&(MsPortalFx.Base.Diagnostics.Telemetry.trace({source:f.ToastTray,action:x.ToastClicked,data:{notificationId:t.notificationId||t.data&&t.data.value.notificationId}}),$(e.currentTarget).trigger("fxtoastclick"),m.removeToast(t))}},t.title),falseFn:()=>i("div",{className:"fxs-toast-title fxs-portal-text"},t.title)})),i("div",{className:"fxs-toast-description fxs-portal-title"},t.description.compose((e=>(0,h.constructDescription)(e,t.descriptionAsHtml.value)))),t.formSection?t.formSection.compose((e=>e?e.section("msportalfx-form fxs-notification-inlineform"):null)):null)}),i("button",{className:"fxs-toast-close fxs-portal-svg","aria-label":p.NotificationMenu.dismissToast,image:o,title:p.NotificationMenu.dismissToast,onClick:({event:e})=>{e.preventDefault(),t.onDismissFn?t.onDismissFn():MsPortalFx.Base.Diagnostics.Telemetry.trace({source:f.ToastTray,action:x.ToastDismissed,data:{notificationId:t.notificationId}}),m.removeToast(t)}}))}})))})}})},(0,m.injectCss)(g);var f=n.Source,x=n.Action})),
define("_generated/MsPortalImpl/Svg/Internal/AzureCopilot.svg",["require","exports"],(function(e,t){"use strict";t.type=t.data=void 0;t.type=1,t.data="<svg viewBox='0 0 17 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M12.17 1.99A1.46 1.46 0 0 0 10.788 1h-.9c-.701 0-1.303.499-1.433 1.188l-.931 4.945.463-1.584a1.458 1.458 0 0 1 1.4-1.049h2.878l1.244 1.629L14.617 4.5h-.552c-.624 0-1.18-.398-1.38-.99l-.516-1.52Z' fill='url(#46595a40-2b8b-4e79-8284-83699bd69d88)'/><path d='M5.003 14.004c.199.595.756.996 1.383.996h1.466c.796 0 1.445-.638 1.458-1.434l.073-4.431-.385 1.317a1.458 1.458 0 0 1-1.4 1.048h-2.89l-1.23-1.085L2.57 11.5h.547c.628 0 1.184.401 1.383.996l.503 1.508Z' fill='url(#de770df9-e634-48cd-8d28-5d89aa32a5df)'/><path d='M10.5 1H4.668C3 1 2 3.202 1.334 5.405c-.79 2.609-1.823 6.099 1.167 6.099h2.69c.65 0 1.223-.431 1.402-1.058a769.97 769.97 0 0 1 1.855-6.402c.306-1.034.561-1.922.953-2.474.22-.31.585-.57 1.1-.57Z' fill='url(#4a239a8d-3502-4118-9ee4-05eeae1435b9)'/><path d='M10.5 1H4.668C3 1 2 3.202 1.334 5.405c-.79 2.609-1.823 6.099 1.167 6.099h2.69c.65 0 1.223-.431 1.402-1.058a769.97 769.97 0 0 1 1.855-6.402c.306-1.034.561-1.922.953-2.474.22-.31.585-.57 1.1-.57Z' fill='url(#3fd891bb-eb7e-40d8-80a6-aaef81d35581)'/><path d='M6.5 15h5.832C14 15 15 12.798 15.665 10.596c.79-2.61 1.824-6.098-1.166-6.098h-2.69c-.651 0-1.223.43-1.402 1.057a771.726 771.726 0 0 1-1.855 6.401c-.306 1.034-.561 1.922-.953 2.475-.22.31-.586.569-1.1.569Z' fill='url(#3eeb9104-9954-4845-813b-548afc399452)'/><path d='M6.5 15h5.832C14 15 15 12.798 15.665 10.596c.79-2.61 1.824-6.098-1.166-6.098h-2.69c-.651 0-1.223.43-1.402 1.057a771.726 771.726 0 0 1-1.855 6.401c-.306 1.034-.561 1.922-.953 2.475-.22.31-.586.569-1.1.569Z' fill='url(#fabd43b2-208d-4d75-8edf-1e347c831410)'/><defs><radialGradient id='46595a40-2b8b-4e79-8284-83699bd69d88' cx='0' cy='0' r='1' gradientUnits='userSpaceOnUse' gradientTransform='rotate(-128.772 8.512 .33) scale(6.41931 6.01261)'><stop offset='.096' stop-color='#00AEFF'/><stop offset='.773' stop-color='#2253CE'/><stop offset='1' stop-color='#0736C4'/></radialGradient><radialGradient id='de770df9-e634-48cd-8d28-5d89aa32a5df' cx='0' cy='0' r='1' gradientUnits='userSpaceOnUse' gradientTransform='matrix(3.56223 4.4232 -4.3144 3.4746 3.806 11.066)'><stop stop-color='#FFB657'/><stop offset='.634' stop-color='#FF5F3D'/><stop offset='.923' stop-color='#C02B3C'/></radialGradient><radialGradient id='3eeb9104-9954-4845-813b-548afc399452' cx='0' cy='0' r='1' gradientUnits='userSpaceOnUse' gradientTransform='matrix(-4.6081 13.17265 -15.78492 -5.52192 14.799 3.47)'><stop offset='.066' stop-color='#8C48FF'/><stop offset='.5' stop-color='#F2598A'/><stop offset='.896' stop-color='#FFB152'/></radialGradient><linearGradient id='4a239a8d-3502-4118-9ee4-05eeae1435b9' x1='4.318' y1='2.273' x2='5.151' y2='11.9' gradientUnits='userSpaceOnUse'><stop offset='.156' stop-color='#0D91E1'/><stop offset='.487' stop-color='#52B471'/><stop offset='.652' stop-color='#98BD42'/><stop offset='.937' stop-color='#FFC800'/></linearGradient><linearGradient id='3fd891bb-eb7e-40d8-80a6-aaef81d35581' x1='5.046' y1='1' x2='5.5' y2='11.504' gradientUnits='userSpaceOnUse'><stop stop-color='#3DCBFF'/><stop offset='.247' stop-color='#0588F7' stop-opacity='0'/></linearGradient><linearGradient id='fabd43b2-208d-4d75-8edf-1e347c831410' x1='15.259' y1='3.856' x2='15.253' y2='6.717' gradientUnits='userSpaceOnUse'><stop offset='.058' stop-color='#F8ADFA'/><stop offset='.708' stop-color='#A86EDD' stop-opacity='0'/></linearGradient></defs></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Internal/UpdateIcon.svg",["require","exports"],(function(e,t){"use strict";t.type=t.data=void 0;t.type=1,t.data="<svg viewBox='0 0 14 14' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><circle cx='7' cy='7' r='6.5' fill='none' stroke='#000'/><g fill='none' stroke='#000' clip-path='url(#548c5d5e-109c-40b2-a201-7885e1b994fd)'><path d='M4.778 6.611 7 4.39l2.222 2.22M7 4.389v5.778'/></g><defs><clipPath id='548c5d5e-109c-40b2-a201-7885e1b994fd'><path d='M3 3.5h8v8H3z' class='msportalfx-svg-c01'/></clipPath></defs></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Library/ArrowRight.svg",["require","exports"],(function(e,t){"use strict";t.type=t.data=void 0;t.type=262,t.data="<svg viewBox='0 0 14.2 9.7' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m8.6 9 3.7-3.6H0v-1h12.3L8.6.7l.8-.7 4.8 4.9-4.8 4.8z'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Startup/Bug.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=391,t.data="<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><rect width='10' height='12' x='4' y='5' fill='none' stroke='#000' rx='5'/><path fill='none' stroke='#000' d='M14 8.25a2 2 0 0 1 2 2v1.5m-14 0v-1.5a2 2 0 0 1 2-2M14.5 2.5V4a2 2 0 0 1-2 2H12M6 6h-.5a2 2 0 0 1-2-2V2.5m10.5 10a3 3 0 0 1 0 4m-10 0a3 3 0 0 1 0-4M6 1l1.5 1.5M12 1l-1.5 1.5M7.65 5.4a2 2 0 0 1 0-3 2 2 0 0 1 2.7 0 2 2 0 0 1 0 3'/></g></svg>"})),
define("MsPortalImpl/Widgets/Widgets.TopBar.Component",["require","exports","Weave","MsPortalImpl/Resources/ImplScriptResources","_generated/MsPortalImpl/Svg/Startup/Bug.svg","_generated/MsPortalImpl/Svg/Startup/Hamburger.svg","_generated/MsPortalImpl/Svg/Library/ArrowRight.svg","_generated/MsPortalImpl/Svg/Internal/UpdateIcon.svg","_generated/MsPortalImpl/Svg/Internal/AzureCopilot.svg","MsPortalImpl/Services/Services.GeneralSettings","Weave/DirectMode","MsPortalImpl/Widgets/Widgets.Search.Component","MsPortalImpl/Widgets/Widgets.AvatarMenu.Component","MsPortalImpl/Widgets/Widgets.Toast.Component","FxInternal/Weave/Util","FxInternal/Weave","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.AuthStateManager","FxInternal/Weave/Components/Button","Fx/Experimentation","MsPortalImpl/Utilities/UrlUtilities","MsPortalImpl/Services/Services.Copilot"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x,b,y,v,w){"use strict";t.TopBar=function(e){const{vm:t}=e,M=t.loadingIdList.compose(g.isEmptyArray);return d(s.LifetimeManagerScoped,{fn:e=>d(s.GetContext,{fn:P=>{const _=P.diContainer,F=_.get(FxImpl.Features),T=(0,v.getUnsafeParams)(),k=_.get(y.Experimentation).shellAssignments.getBooleanValue("showUnsafeURLCustomizationWarning"),E=T.size>0&&!(0,v.isTestEnvironment)()&&k,D=F.isEnabled("canmodifyextensions")||F.isEnabled("renderdevmodeux"),A=F.isEnabled("hideSkipLink")||MsPortalFx.isFeatureEnabled("hideSkipLink"),B=_.get(x.AuthStateManager),N=F.getValue("showbugreportlink"),R="force"===N||"true"===N&&B.isInternal&&!F.isEnabled("ci"),L=(0,s.makeWritableComputation)(),z=(0,s.makeWritableComputation)();_.get(c.GeneralSettings).landingPage.subscribeAndRun(e,(()=>{const e=(0,c.isLandingPageDashboard)(_);L(e?i.Dashboard.defaultTitle:i.AzureHome.home),z(e?"#dashboard":"#home")}));const H=()=>{I("CustomizeModeExited",{dashboardChanged:!!t.dashboardChanged.value,onDashboard:!!t.dashboardVisible.value}),t.exitOrganizeMode()},O=_.get(f.DesktopManagerMode).value,U=(0,s.composeComputation)([t.dashboardChanged,t.newDashboardSaveEnabled,t.displayMode],((e,t,s)=>t&&e&&"Dashboard"!==s||e&&!t)),W=(0,s.composeComputation)([t.dashboardVisible,t.newDashboardSaveEnabled],((e,t)=>e&&!t)),V=(0,s.composeComputation)([(0,h.toComputation)(O),t.newDashboardSaveEnabled],((e,t)=>1===e&&!t));return d("div",{className:["fxs-topbar az-noprint msportalfx-unselectable",{"fxs-topbar-devmode fxs-bg-warning":D||E,"fxs-topbar-dashboard-changed":U,"fxs-topbar-dashboard-visible":W,"fxs-topbar-search-activated":t.searchViewModel.isExpanded}],role:"presentation"},A?null:d("a",{href:"#","aria-label":i.TopBar.skipLink,title:i.TopBar.skipLink,role:"button",onClick:S,onKeyDown:({event:e})=>{32!==e.keyCode&&13!==e.keyCode||(S({event:e}),e.stopPropagation())},className:"fxs-topbar-skip-link"},i.TopBar.skipLink),d(s.Once,{"data-odebug":"23",condition:V,trueFn:()=>d("div",{className:"fxs-topbar-exit-customize"},d("div",{className:"fxs-topbar-exit-customize-message"},i.TopBar.exitCustomizeText),d(b.Button,{className:"fxs-topbar-exit-customize-button",text:i.ShellCommands.exitOrganizeMode,onClick:H,style:0}))}),d("div",{className:["fxs-topbar-content",{"fxs-hide-in-customize":t.newDashboardSaveEnabled.compose(g.negation)}],role:"banner","aria-labelledby":"bannerlabel"},d("div",{className:"fxs-cloud-menu-button"}),d("div",{className:"fxs-microsoft-cloud-menu"}),C.chrome.hideSidebarNav?null:d("a",{href:"#","aria-label":i.TopBar.hamburger,title:i.TopBar.hamburger,className:["fxs-topbar-sidebar-collapse-button","fxs-topbar-button msportalfx-svg-flip-horizontal fxs-topbar-search-activated-hidden"],image:n,role:"button",onClick:({event:e})=>{e.preventDefault(),I("TopBarHamburgerButtonClicked"),$(e.currentTarget).trigger("fxtogglesidebar")},onKeyDown:({event:e})=>{32===e.keyCode&&($(e.currentTarget).trigger("click"),e.preventDefault(),e.stopPropagation())}}),d("h1",{className:("false"!==F.getValue("internalonly")?"fxs-topbar-preview":"fxs-topbar-brand")+" fxs-topbar-search-activated-hidden",id:"bannerlabel"},d("a",{className:"fxs-topbar-home",title:fx.environment.branding.productName,href:z,role:"link",onClick:()=>I("BannerButtonClicked")},"false"!==F.getValue("internalonly")?d(s.Fragment,null,d("div",{className:"fxs-topbar-internal fxs-internal-short"},i.TopBar.internalText),d("div",{className:"fxs-topbar-internal fxs-internal-full"},fx.environment.branding.productName," (",i.TopBar.internalText,")")):`${fx.environment.branding.productName}`)),D||E?d("a",{className:"fxs-topbar-exitdevmode fxs-topbar-debug-button fxs-topbar-search-activated-hidden",href:"#",role:"button",onClick:({event:e})=>{e.preventDefault(),t.exitDevMode()}},i.TopBar.exitDevModeLinkText):null,R?d("a",{href:"#",className:"fxs-topbar-reportbug fxs-topbar-debug-button fxs-topbar-search-activated-hidden",role:"button",title:i.TopBar.reportBugTitle,"aria-label":i.TopBar.reportBug,onClick:({event:e})=>{e.preventDefault(),t.reportBug()}},d("span",{className:"fxs-topbar-reportbug-icon",image:o}),d("span",{className:"fxs-topbar-reportbug-text"},i.TopBar.reportBug)):null,d(s.If,{condition:t.canUpgradeSubscription,concealmentBehavior:"remove",trueFn:()=>d("a",{href:t.upgradeableSubscription.compose((e=>`#blade/Microsoft_Azure_Billing/SubscriptionUpgradeBlade/azureSubscriptionId/${e.subscriptionId}/appId/AzPortal_UpgradeBtn`)),className:"fxs-topbar-upgradebutton fxs-topbar-search-activated-hidden",role:"button",title:i.TopBar.upgradeText,"aria-label":i.TopBar.upgradeButtonText,onClick:()=>{MsPortalFx.Base.Diagnostics.Telemetry.trace({action:"FreeTrialUpgradeClicked",source:"TopBar",data:{subscriptionId:t.upgradeableSubscription.value.subscriptionId,creditsRemaining:t.upgradeableSubscription.value.remaining}})}},d("span",{className:"fxs-topbar-upgradebutton-icon",image:a}),d("span",{className:"fxs-topbar-upgradebutton-text"},i.TopBar.upgradeButtonText))}),d("div",{className:"fxs-topbar-placeholder fxs-topbar-search-activated-hidden"}),d("a",{href:"#",tabindex:"-1",className:"fxs-search-back-icon fxs-topbar-button msportalfx-svg-flip-horizontal",role:"button",title:i.TopBar.back,"aria-label":i.TopBar.back,image:r,onClick:({event:e})=>e.preventDefault()}),d(p.Search,{className:"fxs-topbar-search",vm:t.searchViewModel}),d(s.If,{condition:(0,h.toComputation)(t.copilotEnabled),trueFn:()=>d("a",{href:"#",className:["fxs-topbar-button","fxs-topbar-copilot","fxs-topbar-home",(0,h.toComputation)(t.isCopilotOpen).compose((e=>e?" fxs-topbar-copilot-active":""))],role:"button",title:i.TopBar.copilot,"aria-label":i.TopBar.copilot,onClick:({event:e})=>{e.preventDefault(),t.settingsFlyoutState(0),_.getAsync(w.CopilotShellAPIs).then((e=>e.toggleCopilotBlade()))}},d("span",{image:l,className:"fxs-topbar-copilot-button-icon"}),d("span",{className:["fxs-topbar-copilot-text"]},i.TopBar.copilot))}),d("div",{className:"fxs-topbar-buttons-container fxs-topbar-search-activated-hidden"},t.actionDefinitions.map((e=>e.showNotification?d("div",{className:(0,h.toComputation)(e.active||ko.observable(!1)).compose((t=>e.classNames+(t?" fxs-topbar-active":""))),onClick:({event:t})=>{t.preventDefault(),e.clickHandler()}},d("a",{href:"#",className:"fxs-topbar-button",role:"button",title:e.name,"aria-label":e.name,image:(0,h.toValueOrComputation)(e.icon)}),d("div",{className:"fxs-notificationspane-progressbar fxs-display-none"},d("div",null)),(0,h.toComputation)(e.showNotification).compose((e=>e?d("div",{className:"fxs-notificationspane-button-unreadcount fxs-notificationspane-button-unreadcount-circle"}):null))):d("a",{href:"#",className:["fxs-topbar-button",e.classNames],role:"button",title:e.name,"aria-label":e.name,"aria-expanded":e.ariaExpanded,"aria-controls":e.ariaControls,image:(0,h.toValueOrComputation)(e.icon),onClick:({event:t})=>{t.preventDefault(),e.clickHandler()}})))),d(m.Toast,{className:"fxs-topbar-toast",vm:t.toastViewModel}),d("div",{className:"fxs-topbar-actionsmenu fxs-topbar-search-activated-hidden"}),d(u.AvatarMenu,{className:["fxs-topbar-avatarmenu","fxs-topbar-search-activated-hidden"],vm:t.avatarMenuVM})),d(s.Once,{"data-odebug":"24",condition:U,trueFn:()=>{const e=t.dashboardWritable.compose((e=>e?i.TopBar.saveDashboardButton:i.TopBar.saveDashboardCopyButton)),o=t.dashboardWritable.compose((e=>e?i.TopBar.saveMessage:i.TopBar.saveCopyMessage)),n=t.displayMode,r=(0,s.composeComputation)([(0,h.toComputation)(t.isInOrganizeMode),n],((e,t)=>e&&"Dashboard"===t)),a=n.compose((e=>"Dashboard"!==e)),l=(0,s.composeComputation)([r,a],((e,t)=>!e&&t)),c=n.compose((e=>"Dashboard"===e)),p=c.compose(g.negation),u=(0,s.composeComputation)([r,a,c],((e,t,s)=>!e&&!t&&s));return d("div",{className:"fxs-topbar-dashboard"},d("div",{className:"fxs-topbar-dashboard-message",role:"alert","aria-live":"assertive","aria-atomic":!0},o),d(b.Button,{className:["fxs-topbar-dashboard-done-customize",{"fxs-display-none":r.compose(g.negation)}],text:i.TopBar.exitCustomizeButton,onClick:H,style:0,visible:r}),d(b.Button,{className:["fxs-topbar-dashboard-view",{"fxs-display-none":a.compose(g.negation)}],text:i.TopBar.viewDashboardButton,style:l.compose((e=>e?0:1)),onClick:()=>{I("DashboardView"),MsPortalFx.ViewModels.navigateToDashboardEndPoint.invoke(FxImpl.Rpc.client,"fx",["TopBar"])}}),d(b.Button,{className:["fxs-topbar-dashboard-save",{"fxs-display-none":p}],text:e,style:u.compose((e=>e?0:1)),onClick:()=>{const e=t.dashboardWritable.value,s=e?1:2;I(e?"DashboardPublish":"DashboardSaveACopy"),t.finishDashboardEdit(s,"TopBar")}}),d(b.Button,{className:["fxs-topbar-dashboard-discard",{"fxs-display-none":p}],text:i.TopBar.discardDashboardButton,style:1,onClick:()=>{I("DashboardDiscard"),t.finishDashboardEdit(3)}}))}}),d("div",{className:["fxs-loading5dots-container fxs-blade-progress-translucent",{"fxs-display-none":M}]},d("div",null),d("div",null),d("div",null),d("div",null),d("div",null)))}})})};var M=MsPortalFx.Base;const C=window.fx.environment;function S({event:e}={}){let t;e?.preventDefault?.(),I("SkipLinkClicked");const s=$.querySelectorAll(".fxs-portal-main"),i=s.find(".fxs-contextpane.fxs-portal-contextpane-right");if(i.hasClass("fxs-contextpane-visible")){const e=i.find("iframe.fxs-part-frame").first();t=e[0]?e:i.findFirstTabbable()}else if(s.find(".fxs-home-container").length>0)t=s.find(".fxs-home-container").findFirstTabbable();else{const e=s.find("iframe.fxs-part-frame.fxs-reactview-frame-active").first();t=e[0]?e:s.find(".fxs-panorama .fxs-blade").last().find(".fxs-bladecontent").findFirstTabbable()}$(document.activeElement).blur(),t.focus()}function I(e,t){M.Diagnostics.Telemetry.trace({source:"TopBar",action:e,data:t})}})),
define("MsPortalImpl/Widgets/Widgets.Portal.html",["require","exports","Weave/DirectMode","Weave","Weave/Core/Computation","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.SideBar.Component","MsPortalImpl/Widgets/Widgets.ContextPane.Component","MsPortalImpl/Widgets/Widgets.ContextMenu.Component","FxInternal/Weave/Components/LoadingIndicator","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Widgets/Widgets.TopBar.Component","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Services/Services.BrowseCuration","Fx/Experimentation","FxInternal/Weave","MsPortalImpl/Services/Services.HomeViewSettings"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x,b){"use strict";t.Journey=C,t.renderPortal=function(e,t,o,r){const d=window.fx.getTimestamp(),h=m.isIOS&&!m.isSafari&&MsPortalFx.getEnvironmentValue("branding").iosAppId&&!function(e){const t=e.get(g.StorageService).getValue(g.ComponentName.AppBanner,"dismiss",0);return t&&parseInt(t)>=Date.now()-6048e5}(o),y=o.get(FxImpl.Features).isEnabled("outagebanner"),v=o.get(FxImpl.Features).isEnabled("infobanner"),w=function(e){if(e.isEnabled("electrondeprecationbannerforce"))return!0;return(window.portalAppApi||window.nodeRequire)&&e.isEnabled("electrondeprecationbanner")}(o.get(FxImpl.Features)),C=o.get(f.Experimentation).shellAssignments,S=C.getBooleanValue("LeftNav"),I=C.getBooleanValue("relocateDockedPane"),E=C.getBooleanValue("azhome"),D=o.get(b.HomeViewSettings),A=(0,i.composeComputation)([(0,x.toComputation)(D.showAzHome),(0,x.toComputation)(D.homeview),(0,x.toComputation)(D.userTypeHint)],((e,t,s)=>S||(E||"startup"===s)&&e||"startup"===t)),B=s(i.PromiseFragment,{"data-odebug":"p5",promise:F(v,o)});t.contextMenuViewModel.registerForCleanup(r);const N=s(i.Fragment,null,h?s(i.PromiseFragment,{"data-odebug":"p6",promise:P()}):null,s(i.PromiseFragment,{"data-odebug":"p7",promise:T(!1)}),B,s(u.TopBar,{vm:t.topBar}),s("div",{className:"fxs-global-notification-banner fxs-blade-statusbg fxs-bg-warning az-noprint"},y?s(i.PromiseFragment,{"data-odebug":"p8a",promise:k(o)}):null),w?s(i.PromiseFragment,{"data-odebug":"p8b",promise:_()}):null,s("div",{className:"fxs-portal-tip az-noprint"}),s("div",{className:"fxs-portal-region"},s("div",{className:"fxs-portal-main-region"},s("div",{className:["fxs-portal-main",{"fxs-topbar-dashboard-changed":t.topBar.dashboardChanged}]},s(i.If,{condition:A,trueFn:()=>s(i.Fragment,{children:[]}),falseFn:()=>s(a.SideBar,{className:"fxs-sidebar az-noprint msportalfx-unselectable",vm:t.sideBar})}),s("div",{className:"fxs-sidebar-leftnav-container az-noprint"}),s(M,{vm:t}),s(l.ContextPane,{className:"fxs-portal-contextpane-right msportalfx-shadow-level3",vm:t.rightContextPane}),s(l.ContextPane,{className:"fxs-portal-contextpane-shell msportalfx-shadow-level3",vm:t.shellContextPane}),I?s(l.ContextPane,{className:"fxs-portal-contextpane-docked",vm:t.dockedContextPane}):null),s("div",{className:"fxs-portal-console az-noprint",id:"consoleRegionId",role:"presentation"})),I?null:s("div",null,s(l.ContextPane,{className:"fxs-portal-contextpane-docked",vm:t.dockedContextPane}))),s(c.ContextMenu,{className:"fxs-commands-contextMenu az-noprint",vm:t.contextMenuViewModel}),s(i.PromiseFragment,{"data-odebug":"p9",promise:T(!0)})),R=window.fx.getTimestamp();(0,n.applyToElement)({element:e,ltm:r,weaveNode:N,weaveContext:{diContainer:o},opName:"portal"});return o.get(p.PortalStartupMarkers).portalTsx={beforeStart:d,tsxFnEnd:R},Promise.all([MsPortalFx.require("MsPortalImpl/Widgets/AzureHome/AzureHome.Store"),MsPortalFx.require("MsPortalImpl/Widgets/LeftNav/LeftNavRenderer.React"),MsPortalFx.require("MsPortalImpl/Widgets/MicrosoftCloudMenu/MicrosoftCloudMenuTopBarButton.React")]).then((([e,s,i])=>{const n=o.get(b.HomeViewSettings).showAzHome();e.useAzureHomeStore.setState({azHomeExperienceToggleOn:n}),s.renderLeftNav(o,r.createChildLifetime(),t.sideBar.topSectionLinks,document.getElementsByClassName("fxs-sidebar-leftnav-container")[0]),i.renderMicrosoftCloudMenuTopBarButton(o,r.createChildLifetime())}))};var y=MsPortalFx.Base.Diagnostics.Telemetry;const v=fx?.environment?.writesDisallowedTenants||[];const w=MsPortalFx.isFeatureEnabled("allServicesWithOverview");function M(e){const{vm:t}=e;return s("main",{className:"fxs-panorama fxs-portal-content"},s(i.Fragment,null,s(i.Once,{"data-odebug":"15",condition:t.displayMode.compose((e=>"AllServices"===e)),trueFn:()=>s(i.PromiseFragment,{"data-odebug":"p10",promise:S(t),whilePending:s(d.LoadingIndicator,null)})}),s(i.If,{condition:t.settingsFlyoutState,trueFn:()=>s(i.PromiseFragment,{"data-odebug":"p11",promise:I(t),whilePending:s(d.LoadingIndicator,null)})}),s("div",{className:["fxs-startboard fxs-startboard-target fxs-theme-context-start fxs-portal-text",{"fxs-startboard-notfound":t.startboardNotFound,"fxs-startboard-loading":t.startboardLoading}],"aria-label":r.Dashboard.ariaLabel}),s("div",{className:"fxs-home-target"}),s(C,null)))}function C(){return s("div",{className:"fxs-journey-target"},s("div",{className:["fxs-journey-breadcrumb","fxs-portal-bg-txt-br","az-noprint","msportalfx-unselectable","fxs-display-none"]}),s("div",{className:"fxs-journey-layout"}))}async function S(e){const[t,n]=await Promise.all([MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AllServicesMenu"),MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AllServicesMenu.Component"),w&&MsPortalFx.require("MsPortalImpl/Services/BrowseCuration/AllServicesCardData"),MsPortalFx.require(`MsPortalImpl/Services/BrowseCuration/${h.browseCurationFile}`).catch((e=>{(0,h.handleInvalidCurationFileError)(e)}))]),r=y.start({source:"AllServicesMenu",action:"AllServicesMenuLoad"});return performance.mark("AllServicesMenuLoadStart"),s(i.GetContext,{fn:a=>{const l=a.diContainer,c=n.AllServicesMenu,d=new t.ViewModel;return d.filterInputValue=e.allServicesMenuInput.filter,d.categoryInputValue=e.allServicesMenuInput.category,s("div",{className:"fxs-sidebar-flyout fxs-portal-background",role:"presentation",afterMount:(e,s)=>{const n=new t.Widget($(e),d,l),a=s.createChildLifetime();s.registerForDispose(n),(0,i.subscribeAndRun)(a,[d.isLoading],(e=>{e||(a.dispose(),(0,o.invokeAfterChangePropagation)((()=>{performance.mark("AllServicesMenuLoadEnd"),performance.measure("AllServicesMenuLoad","AllServicesMenuLoadStart","AllServicesMenuLoadEnd"),y.completeTrace(r)})))}))}},s(c,{vm:d}))}})}async function I(e){return(await MsPortalFx.require("MsPortalImpl/Weave/Components/SettingsFlyout.Component")).getFlyoutComponent(e.settingsFlyoutState)}async function P(){const{AppBanner:e}=await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AppBanner.Component");return s(e,null)}async function _(){const{ElectronDeprecatedBanner:e}=await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.ElectronDeprecatedBanner.Component");return s(e,null)}async function F(e,t){if(e&&!function(e){return!!e.get(g.StorageService).getValue(g.ComponentName.GlobalInfoBanner,"acknowledge",0)}(t)){const e=await MsPortalFx.Base.Security.getUserInfo();if(!!~v.indexOf(e?.directoryId)){const{GlobalInfoBanner:e}=await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.GlobalInfoBanner.Component");return s(e,null)}}return null}async function T(e){const t=await MsPortalEarly.preload,i=t?.securityClassification,o=t?.securityBannerColor;if(i&&o){const{GlobalSecurityBanner:t}=await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.GlobalSecurityBanner.Component");return s("div",e?{className:"fxs-global-security-banner-bottom"}:{className:"fxs-global-security-banner-top"},s(t,{classification:i,color:o}))}return null}async function k(e){const t=await MsPortalEarly.preload,i=t?.outages||[],{GlobalNotificationBanner:o}=await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.GlobalNotificationBanner.Component");return s(o,{notifications:i,container:e})}})),
define("MsPortalImpl/Interactions/Interactions.RightClick",["require","exports","MsPortalImpl/Base/Base.KeyboardHelper"],(function(e,t,s){"use strict";t.setup=function(e,t,o){let n,r,a,l=o&&o.formTarget;function c(){e.removeClass(i);const s=t();s&&s.forEach((e=>{e.dispose()})),n&&(e.off("fxcontextmenurequest",n),n=null),r&&(e.off("keydown",r),r=null),a&&(e.off("remove",a),a=null)}function d(s){const i=t();i&&i.length>0&&(s.preventDefault(),s.stopPropagation(),function(s,i){const o=$.Event("fxcontextmenu");o.clientX=s,o.clientY=i,l||(l=e.hasClass("fxs-bladecontent")?e:null);e.trigger(o,{commands:t(),formTarget:l,srcElement:e[0]})}(s.clientX,s.clientY))}return e.addClass(i),e.on("fxcontextmenurequest",n=(e,t)=>{d(e)}),e.on("keydown",r=(e,t)=>{if(121===e.which&&4===s.getModifierKeys(e)){const t=e.target.getClientRects()[0];e.clientX=t&&t.left,e.clientY=t&&t.top,d(e)}}),e.on("remove",a=c),{dispose:c}};const i="fx-rightClick"})),
define("MsPortalImpl/UI/Compositions/UI.Composition.PartSize",["require","exports"],(function(e,t){"use strict";t.GridSpacingWidth=t.GridSpacingHeight=t.CellWidth=t.CellSpacingWidth=t.CellSpacingHeight=t.CellHeight=t.AllSizes=t.AllCssClasses=void 0,t.getCorrespondingStandardSize=function(e,t){let s=MsPortalFx.find(p,(s=>{const i=s&&s.size;return s&&i.width===e&&i.height===t}));s||(s=u(i.Custom),s.size={width:e,height:t},s.span=function(e,t){return{colSpan:d(e,o,r),rowSpan:d(t,n,a)}}(e,t));return $.extend(!0,{},s)},t.getDefaultSize=function(){return u(i.Normal)},t.getGridPixelSize=function(e,t){const s=e=>Math.ceil(Math.min(Math.max(e,1),25));return c(s(e),s(t))},t.getSize=u,t.isAdaptiveWidth=function(e){const t=m(e);return f.some(t)},t.isFixedSize=function(e){const t=m(e);return g.some(t)},t.isVariableSize=function(e){const t=m(e);return h.some(t)};var s=MsPortalFx.Parts,i=s.PartSize;const o=t.CellWidth=85,n=t.CellHeight=85,r=t.CellSpacingWidth=5,a=t.CellSpacingHeight=5;t.GridSpacingWidth=o+r,t.GridSpacingHeight=n+a;function l(e,t,s){return e<0?-1:0===e?0:Math.max(0,e*t+(e-1)*s)}function c(e,t){return{width:l(e,o,r),height:l(t,n,a)}}function d(e,t,s){return Math.ceil(e/(t+s))}const p=t.AllSizes=(()=>{const e=[],t=(t,i,o)=>{e[t]={name:t,css:"fxs-tilesize-"+s.PartSize[t].toLowerCase(),size:c(i,o),span:{colSpan:i,rowSpan:o}}};return t(i.Mini,1,1),t(i.Small,2,1),t(i.Normal,2,2),t(i.Wide,4,2),t(i.Tall,2,4),t(i.HeroWide,6,4),t(i.HeroTall,4,6),t(i.HeroWideFitHeight,6,0),t(i.FullWidthFitHeight,-1,0),t(i.FitToContainer,-1,-1),t(i.Large,4,4),t(i.Hero,6,6),t(i.Custom,0,0),e})();t.AllCssClasses=p.map((e=>e.css));function u(e){return $.extend(!0,{},MsPortalFx.find(p,(t=>t&&t.name===e)))}function m(e){return t=>t===e}const g=[i.Mini,i.Small,i.Normal,i.Wide,i.Tall,i.Large,i.HeroWide,i.HeroTall,i.Hero,i.Custom];const h=[i.HeroWideFitHeight,i.FullWidthFitHeight,i.FitToContainer];const f=[i.FullWidthFitHeight,i.FitToContainer]})),
define("MsPortalImpl/Widgets/Widgets.LayoutBase",["require","exports"],(function(e,t){"use strict";var s;t.Orientation=void 0,function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(s||(t.Orientation=s={}))})),
define("MsPortalImpl/Widgets/Widgets.TileActionBar.Component",["require","exports","Weave/DirectMode","FxInternal/Weave","Weave","MsPortalImpl/Resources/ImplScriptResources"],(function(e,t,s,i,o,n){"use strict";t.TileActionBar=function(e){const{vm:t}=e,r=n.ContextMenu.partActions;return s("div",{className:"fxs-tile-actionbar-actionlist fxs-portal-background",role:"menubar","aria-label":(0,o.composeComputation)([t.ariaLabel,t.partTitle],((e,t)=>`${e||t} ${r}`))},s(o.Once,{"data-odebug":"21",condition:t.visible,trueFn:()=>s(o.ForEach,{collection:t.actions.cFilter((e=>(0,i.toComputation)(e.command.enabled))),fn:({item:e})=>{const t=e.command;return s("button",{type:"button",className:["fxs-tile-actionbar-action fxs-portal-svg",e.className],role:"menuitem",title:(0,i.toComputation)(t.text),"aria-label":(0,i.toComputation)(t.text),image:(0,i.toComputation)(t.icon),onClick:({event:e})=>{e.stopPropagation(),MsPortalFx.Base.Diagnostics.Telemetry.trace({source:"TileAction",action:"TileActionClicked",name:t.commandName}),t.execute(!1)}})}})}))}})),
define("MsPortalImpl/Widgets/Widgets.Tile.Component",["require","exports","Weave/DirectMode","FxInternal/Weave/Components/LoadingIndicator","Weave","MsPortalImpl/Widgets/Widgets.TileActionBar.Component"],(function(e,t,s,i,o,n){"use strict";function r(e){const t=e.vm,r=(0,o.composeComputation)([t.isInBlockingLoadingState,t.hasOngoingOperation],((e,t)=>{let s=0;return e?s=2:t&&(s=1),s}));return s(o.Fragment,null,s("div",{className:"fxs-tile-actionbarcontainer"},s("div",{className:"fxs-tile-actions"},s(n.TileActionBar,{vm:t.actionBarViewModel})),s("div",{className:"fxs-tile-actions-contextmenu"})),s("div",{className:"fxs-tile-overlay"}),s("div",{className:["fxs-tile-progress-transparent fxs-loading5dots-container",{"fxs-display-none":r.compose((e=>1!==e))}]},s("div",{className:"fxs-portal-background"}),s("div",{className:"fxs-portal-background"}),s("div",{className:"fxs-portal-background"}),s("div",{className:"fxs-portal-background"}),s("div",{className:"fxs-portal-background"})),s(i.LoadingIndicator,{className:["fxs-tile-progress fxs-portal-background",{"fxs-display-none":r.compose((e=>2!==e))}]}))}t.Tile=function(e){const t=e.vm;return s("div",{id:t.tsxRootElementId,className:"fxs-tile fxs-portal-bg-txt-br"},s(r,{vm:t}))},t.TileInner=r})),
define("MsPortalImpl/Widgets/Widgets.TileActionBar",["require","exports","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Base/Base.BrowserDetection","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css","Weave"],(function(e,t,s,i,o,n,r,a){"use strict";t.widgetClassName=t.actionClassName=t.Widget=t.ViewModel=t.TileActionViewModel=void 0,(0,n.injectCss)(r);const l="fxs-tile-actionbar-actionlist",c="fxs-tile-actionbar",d=[];t.widgetClassName=c,t.actionClassName="fxs-tile-actionbar-action";t.TileActionViewModel=class{};class p extends s.ViewModel{constructor(){super(...arguments),this.actions=(0,a.makeArrayComputation)(),this.visible=(0,a.makeWritableComputation)(!1),this.partTitle=(0,a.makeWritableComputation)(),this.ariaLabel=(0,a.makeWritableComputation)()}update(){this.visible.value&&this.actions.value.forEach((e=>{e.command.activate(),e.bindCommand()}))}}t.ViewModel=p;class u extends s.Widget{constructor(e,t,s,o){super(e,s);const n=this.options,r=this.ltm;d.push(this),e.addClass(c);const p=new i.ViewModel;p.topOffsetCorrection=25;const u=this.contextMenuWidget=new i.Widget(t,p);r.registerForDispose(e.setEvents(["click","."+l,e=>{const t=e.target;$(t).hasClass(l)&&(o(t),e.preventDefault(),e.stopPropagation())}])),(0,a.subscribeAndRun)(r,[n.visible],(t=>{if(!t){const e=document.activeElement;this.has(e)&&o(e)}t?n.update():u.hide(),$(e).toggleClass("fxs-tile-transparent",!t),t&&d.forEach((e=>{e!==this&&e.options.visible(!t)}))})),r.registerForDispose((()=>{u.dispose(),p.menuItems.removeAll(),this.contextMenuWidget=null,MsPortalFx.remove(d,this)})),this._bindDescendants()}dispose(){this._cleanElement(c),super.dispose()}showTileManagementContextMenu(){this.options.actions.value.forEach((e=>{const t=e.command;"function"==typeof t._getActionClassIdentifier&&"opencontextmenu"===t._getActionClassIdentifier()&&t.execute(!1)}))}setFocus(){!o.isAndroidOrMobile&&this.options.visible.value&&this.element.findFirstTabbable().focus()}has(e){return!(!this.element.has(e).length&&!this.contextMenuWidget.element.has(e).length)}}t.Widget=u})),
define("MsPortalImpl/Widgets/Widgets.Tile",["require","exports","Weave/DirectMode","MsPortalImpl/Interactions/Interactions.RightClick","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Widgets/Widgets.TileActionBar","MsPortalImpl/Widgets/Widgets.UIElementBase","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Widgets/Widgets.Tile.Component","Weave","Fx","FxInternal"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m){"use strict";t.actionBarContainerClassName=t.Widget=t.ViewModel=void 0,t.createTileWidget=function(e,t,s,i,o){return new M(e,t,s,i,o)},t.widgetClassName=t.overlayClassName=void 0,(0,a.injectCss)(l);var g=MsPortalFx.Base.Diagnostics,h=MsPortalFx.Parts.PartSize;const f=g.createLog(e),x="fxs-tile",b="fxs-tile-overlay",y="fxs-portal-bg-txt-br";t.widgetClassName=x,t.overlayClassName=b,t.actionBarContainerClassName="fxs-tile-actionbarcontainer";let v=0;class w extends r.ViewModel{constructor(e,t){super(e),this.isInBlockingLoadingState=(0,p.makeWritableComputation)(!1),this.hasOngoingOperation=(0,p.makeWritableComputation)(!1),this.size=ko.observable(),this.gridHeight=ko.observable(),this.gridWidth=ko.observable(),this.supportedSizes=ko.observableArray(),this.commands=[],this.actionBarViewModel=new n.ViewModel,this.selected=ko.observable(!1),this.selectedFromHover=ko.observable(!1),this.userResizable=ko.observable(!1),this.inLockedContext=!1,this.tsxRootElementId=`__tile_${v++}__`,this.applyViewSettings(t)}getViewSettings(){return{NormalState:{size:this.size()}}}applyViewSettings(e){e&&e.NormalState&&void 0!==e.NormalState.size&&(this.size=ko.observable(e.NormalState.size))}}t.ViewModel=w;class M extends r.Widget{constructor(e,t,n,r,a){super(e,t),this._tsxRender=r,this._getActions=a;const l=this.ltm;t.size&&void 0!==t.size()||(f.warning("No initial size was set on the Tile view model."),t.size=ko.observable(o.getDefaultSize().name));const p=o.getSize(t.size());if(e.addClass(p&&p.css),r||((0,c.applyToElement)({element:e[0],ltm:this.ltm,weaveNode:s(d.TileInner,{vm:t}),weaveContext:{diContainer:n}}),e.addClass(x).addClass(y)),h.Custom===p.name){const s=o.getGridPixelSize(t.gridWidth(),t.gridHeight());e.css({width:s.width,height:s.height})}else o.isFixedSize(t.size())&&(t.gridWidth(p.span.colSpan),t.gridHeight(p.span.rowSpan));this._attachEventHandlers();const u=i.setup(e,ko.observableArray(t.commands));l.registerForDispose(u)}dispose(){this._actionBarWidget&&(this._actionBarWidget.dispose(),this._actionBarWidget=null),this._tsxRender?this.element.removeClass(o.AllCssClasses.join(" ")):this._cleanElement(o.AllCssClasses.join(" "),x,y),super.dispose()}addChild(e){if(!e)throw new Error("Can't add null child.");(e.element||e).insertBefore($(this.element).find(`.${b}`))}removeChild(e){return!1}saveViewSettings(){return this.options.getViewSettings()}setSize(e,t){let s=o.getCorrespondingStandardSize(e,t);s||(s=o.getDefaultSize());const i=s.size,n=this.options,r=n.size(),a=this.element;if(r&&r===s.name){if(r!==h.Custom)return;if(parseInt(a.css("height"))===i.height&&parseInt(a.css("width"))===i.width)return}n.size(s.name),n.gridHeight(s.span.rowSpan),n.gridWidth(s.span.colSpan),a.css({height:"",width:""}).removeClass(o.AllCssClasses.join(" ")).addClass(s.css),s.name===h.Custom&&a.css({height:i.height,width:i.width});a.handleTransitionEndOnce("height",300,(e=>{!this.ltm.isDisposed()&&a.trigger("fxsizechanged",[s.name])}))}get actionBarWidget(){return this._actionBarWidget}setFocus(e){const t=this._actionBarWidget;if(!e&&t&&t.options.visible.value)t.setFocus();else{const e=this.element.find(".fxs-part");e&&e.focus()}}showTileManagementContextMenu(){const e=this.options,t=this.actionBarWidget;!e.locked()&&e.selected()&&t&&t.showTileManagementContextMenu()}_createActionBarWidget(){if(!this._actionBarWidget){const e=this.element,t=this.options,s=t.actionBarViewModel,i=this._getActions;s.actions.setAll(i&&i()),this._actionBarWidget=new n.Widget(e.find(".fxs-tile-actions"),e.find(".fxs-tile-actions-contextmenu"),s,(s=>{e[0].contains(s)&&(this.setFocus(!0),u.nextTick((()=>{t.selectedFromHover(!1)})))}))}}_attachEventHandlers(){const e=this.element,t=this.options,s=this.ltm;if(t.size.subscribe(s,(()=>{e.trigger(r.Widget.viewSettingsChanged,this.saveViewSettings())})),t.userResizable.subscribeAndRun(s,(e=>{e&&m.tryImmediateResolve(MsPortalFx.require("MsPortalImpl/Interactions/Interactions.FlowLayoutUserResize"),(e=>{e.addUserResizeBehavior(this)}))})),ko.computed(s,t.locked,(t=>{e.trigger("fxsizechanged")})).extend({deferred:!0}),ko.computed(s,(()=>{const s=t.selected(),i=t.selectedFromHover(),o=s||i;ko.ignoreDependencies((()=>{o&&this._createActionBarWidget()})),t.actionBarViewModel.visible(o),e.toggleClass("fxs-tile-selected",s)})),!t.inLockedContext){const i=e=>{t.selectedFromHover()||t.selectedFromHover(!0)},o=e=>{!t.selectedFromHover()||this.actionBarWidget&&this.actionBarWidget.has(document.activeElement)||t.selectedFromHover(!1)};let n=!1;const r=t=>{const s=e[0],i=s.contains(t.target)&&(s.contains(t.relatedTarget)||n);return n=!1,i},a=e=>{!r(e)&&i(e)},l=e=>{!r(e)&&o(e)},c=e[0],d=e=>{27===e.keyCode&&e.target&&c.contains(e.target)&&this.setFocus(!0)},p=e=>{n=!0};e.on("mouseenter",i).on("mouseleave",o).on("keydown",".fxs-tile-actionbar-action",d).on("mousedown",".fxs-tile-actionbar-action",p),c.addEventListener("focus",a,!0),c.addEventListener("blur",l,!0),s.registerForDispose((()=>{e.off("mouseenter",i).off("mouseleave",o).off("keydown",d).off("mousedown",p),c.removeEventListener("focus",a,!0),c.removeEventListener("blur",l,!0)}))}}}t.Widget=M})),
define("MsPortalImpl/Widgets/Widgets.FlowLayout",["require","exports","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.LayoutBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","Weave","MsPortalImpl/Widgets/Widgets.Tile.Component","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Weave/Util","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css","FxInternal"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g){"use strict";t.calculateSpan=t.calculateSize=t.Widget=t.ViewModel=t.FlowLayoutPositioningEngine=t.FlowLayoutPositionConflictResolver=void 0,t.validateGrid=function(e){const t=new k;let s,i=!0;for(let o=0;o<e.length;o++){const n=e[o],r=n.position,a=r.row,l=r.col,c=n.rowSpan,d=n.colSpan;if(!t.isRectangleFree(l,a,c,d)){i=!1,s={misplacedPart:n.id,overlappedParts:[]};for(let e=l;e<l+d;e++)for(let i=a;i<a+c;i++){const o=t.getItemAt(e,i);o&&!s.overlappedParts.includes(o.id)&&s.overlappedParts.push(o.id)}break}t.markOccupancy(n)}return{success:i,result:s}};var h=MsPortalFx.Base.Diagnostics,f=MsPortalFx.Parts.PartSize,x=o.Orientation;(0,u.injectCss)(m);const b=h.createLog(e),y=r.Widget.getId,v=i.Widget.getWidget,w="fxs-flowlayout",M="fxs-flowlayout-childcontainer",C="fxs-flowlayout-element",S=(e,t,s)=>Math.min(25,Math.ceil((e+s)/(t+s)));t.calculateSpan=S;const I=(e,t,s)=>e*t+(e-1)*s;t.calculateSize=I;const P={38:1,39:2,40:3,37:4};class _ extends r.ViewModel{constructor(e,t){super(e),this._positions=[],this.minColumns=(0,l.makeWritableComputation)(1),this.minRows=(0,l.makeWritableComputation)(1),this.maxColumns=(0,l.makeWritableComputation)(999),this.maxRows=(0,l.makeWritableComputation)(999),this.columnSize=a.CellWidth,this.rowSize=a.CellHeight,this.gutterSize=a.CellSpacingWidth,this.orientation=x.Horizontal,this.allowReorder=!1,this.allowOverflow=!1,this.allowGaps=!1,this.resolutionGuides=!1,this.resolutionGuidesOffset={x:0,y:0},this.childContainerHeight=(0,l.makeWritableComputation)(""),this.childContainerWidth=(0,l.makeWritableComputation)(""),this.positionUpdatedSignal=ko.observable(0),this.applyViewSettings(t)}getViewSettings(){return{positions:this.positions}}applyViewSettings(e){e&&e.positions&&(this.positions=e.positions,this.positionUpdatedSignal(this.positionUpdatedSignal()+1))}get positions(){return this._positions}set positions(e){this._positions=e||[]}}t.ViewModel=_;class F extends r.Widget{constructor(e,t,s){super(e,t,s),this._tsxRender=s,this._dropPlaceholder=null,this._childContainer=null,this._engine=new D(t),this._engine.positions=t.positions,s||(e.addClass(w).html("<div class='"+M+"'></div>"),t.resolutionGuides&&this._addResolutionGuides()),this._childContainer=$(this.element[0].querySelector("."+M)),this._initializeComputed(),s||this._relayoutPositions(),this._attachEventHandlers()}dispose(){this._childElements.forEach((e=>{e.removeClass(C),ko.cleanNode(e[0]),e.remove()})),ko.cleanNode(this._childContainer[0]),this._childContainer.remove(),this.element.removeClass(w),super.dispose()}get _childElements(){const e=this._childContainer.children("."+C),t=[];return $.each(e,(function(e,s){t.push($(s))})),t}get dropPlaceholder(){return this._dropPlaceholder}createTiles(e,t){if(0===e.length)return[];const s=new Array(e.length),i=(0,p.createFragment)(e.map(((e,t)=>(0,l.Once)({condition:s[t]=(0,l.makeWritableComputation)(!1),falseFn:()=>(0,c.Tile)({vm:e.vm})})))),o=this.ltm.createChildLifetime();return(0,l.subscribeAndRun)(o,[(0,l.makeLiftedArrayComputation)(s).cEvery(g.identity)],(e=>{e&&o.dispose()})),(0,d.appendToElement)({element:this._childContainer[0],ltm:o,weaveNode:i,weaveContext:{diContainer:t},opName:"Tiles"}),e.map(((e,i)=>{const o=$(document.getElementById(e.vm.tsxRootElementId)),r=n.createTileWidget(o,e.vm,t,!0,e.getActions),a=s[i];return r.ltm.registerForDispose((()=>a(!0))),this._postProcessAddChild(o),r}))}addChild(e){if(!e)throw new Error("Cannot add a null child.");const t=e.element?e.element:e;this._childContainer.append(t),this._postProcessAddChild(t)}_postProcessAddChild(e){e.css("visibility","hidden"),e.addClass(C);const t=this._getChildDimensions(e),s=this.options;try{s.positions=this._engine.append(y(e),t.rowSpan,t.colSpan)}catch(t){return b.warning("New element could not be appended to the grid. {0}".format(t.toString())),e.removeClass(C),void e.remove()}s.positions=this._engine.positions,this._refreshElementSize(e),this._setContainerSize(),this._relayoutPositions(),this.element.trigger("layoutUpdated"),e.css("visibility","")}removeChild(e,t){const i=MsPortalFx.findIndex(this._childElements,(function(t){return y(t)===e})),o=this._childElements[i];if(!o)return!1;return this.options.positions=this._engine.remove(e),this.element.trigger("layoutUpdated"),s.hide(o).removeClass(C),t?o.detach():o.remove(),this._setContainerSize(),this._relayoutPositions(),!0}resizeChild(e,t,s,i){const o=this.options,n=o.rowSize,a=o.columnSize,l=o.gutterSize,c=MsPortalFx.find(this._childElements,(function(t){return y(t)===e}));if(!c)return;const d=MsPortalFx.find(this._engine.positions,(function(t){return t.id===e}));t=Math.max(t,a),s=Math.max(s,n);const p=S(s,n,l),u=S(t,a,l),m=this._engine.resize(e,u,p,i);o.positions=m;const g=MsPortalFx.find(m,(function(t){return t.id===e})),h=I(g.rowSpan,n,l),f=I(g.colSpan,a,l);if(this._setContainerSize(!0),this._relayoutPositions(),i){d.rowSpan===g.rowSpan&&d.colSpan===g.colSpan||this.element.trigger("layoutUpdated");const e=v(c,r.Widget);this._setElementSize(e,c,f,h)}}moveChild(e,t,s,i){const o=y(e),n=this._getChildDimensions(e),r=this._engine.move(o,{col:t,row:s},n.colSpan,n.rowSpan,i);this.options.positions=r,this._setContainerSize(!0),this._relayoutPositions(),i&&this.element.trigger("layoutUpdated")}refreshLayout(){this.options.positions=this._engine.positions,this._setContainerSize(),this._relayoutPositions(),this._refreshSizes()}saveViewSettings(){const e=this.options;return e.positions=this._engine.positions,e.getViewSettings()}createDropPlaceholder(e,t){this._dropPlaceholder&&this.disposeDropPlaceholder(),this._dropPlaceholder=$(FxImpl.createElement("div",{class:"fxs-flowlayout-drop-placeholder"})).css({width:e,height:t}),this._childContainer.append(this._dropPlaceholder)}disposeDropPlaceholder(){this._dropPlaceholder&&this._dropPlaceholder.remove(),this._dropPlaceholder=null}moveDropPlaceholder(e){this._setElementPositioningCss(this.dropPlaceholder,e)}resizeDropPlaceholder(e,t){const s=this.options,i=s.rowSize,o=s.columnSize,n=s.gutterSize,r=S(t,i,n),a=S(e,o,n),l=I(r,i,n),c=I(a,o,n);this._dropPlaceholder.css({width:c,height:l})}getDomOrderedChildren(){return this._engine.getNaturalDomElementOrder()}discardStateOfUnusedChildren(){let e=[];const t={stateDiscarded:!1};return this._engine&&(e=e.concat(this._engine.discardUnusedPositions())),e.length&&(t.stateDiscarded=!0,t.message="Removed Positions: "+JSON.stringify(e)),t}_initializeComputed(){const e=this.options,t=this.ltm;(0,l.subscribeAndRun)(t,[e.minRows,e.maxRows,e.minColumns,e.maxColumns],(()=>this._setContainerSize())),e.positionUpdatedSignal.subscribe(t,(()=>{this._engine.positions=e.positions}))}_getChildDimensions(e){const t=this.options,s=v(e,n.Widget),i=s&&s.options,o=i&&i.size();let r,l;a.isFixedSize(o)?(r=a.getSize(o),l=o===f.Custom?a.getGridPixelSize(i.gridWidth(),i.gridHeight()):r.size):l=this._getChildAccurateDimensions(e);return{rowSpan:S(l.height,t.rowSize,t.gutterSize),colSpan:S(l.width,t.columnSize,t.gutterSize)}}_getChildAccurateDimensions(e){if(!e[0])return b.warning("Attempted to measure a non-existant item in _getChildAccurateDimensions. Assuming 0 as size."),{height:0,width:0};const t=e[0].getBoundingClientRect();return{height:Math.round(t.height),width:Math.round(t.width)}}_setContainerSize(e){const t=this.options,s=this._engine.getMaxOccupiedPositions(e?t.positions:null),i=Math.max(t.minRows.value,s.row),o=Math.max(t.minColumns.value,s.col),n=I(i,t.rowSize,t.gutterSize),r=I(o,t.columnSize,t.gutterSize);this._tsxRender?(t.childContainerHeight(n+"px"),t.childContainerWidth(r+"px")):this._childContainer.css({height:n,width:r})}_relayoutPositions(){let e,t,s,i;for(let o=0;o<this._childElements.length;o++)t=this._childElements[o],e=y(t),s=MsPortalFx.find(this.options.positions,(function(t){return t.id===e})),i=s?s.position:{row:0,col:0},this._setElementPositioningCss(t,i)}_setElementPositioningCss(e,t){const s=this.options,i=t.col*(s.columnSize+s.gutterSize),o=t.row*(s.rowSize+s.gutterSize);let n;n=this._isRtl()?{right:i,top:o}:{left:i,top:o},e.css(n)}_refreshSizes(){this._childElements.forEach(this._refreshElementSize,this)}_refreshElementSize(e){const t=this.options,s=v(e,r.Widget);if(s){const i=y(e),o=MsPortalFx.find(t.positions,(function(e){return e.id===i})),n=I(o.rowSpan,t.rowSize,t.gutterSize),r=I(o.colSpan,t.columnSize,t.gutterSize);this._setElementSize(s,e,r,n)}}_setElementSize(e,t,s,i){e?e.setSize(s,i):t.css({width:s,height:i})}_moveFocusInDirection(e){const t=$(document.activeElement).closest("."+n.widgetClassName),s=y(t);if(!s)return;const i=this._engine.getAdjacentElement(s,e),o=MsPortalFx.find(this._childElements,(e=>i===y(e)));if(!o)return;const r=v(o,n.Widget);r&&r.setFocus()}_attachEventHandlers(){const e=this.element,t=(e,t,s,i,o)=>{this.resizeChild(t,s,i,void 0===o||o),e.stopPropagation()},s=e=>{const t=$(e.target);if(t.is("input[type=text], textarea, select")||t.closest(".fxs-contextMenu").length)return;const s=e.which,i=P[s]||0;0!==i&&(e.preventDefault(),e.stopPropagation(),this._moveFocusInDirection(i))};e.on("fxsizechange",t),e.on("keydown",s),this.ltm.registerForDispose((()=>{e.off("fxsizechange",t),e.off("keydown",s)}))}_addResolutionGuides(){const e=this.options.resolutionGuidesOffset;[{x:1024,y:768},{x:1366,y:768},{x:1440,y:900},{x:1920,y:1080},{x:3840,y:2160}].forEach((t=>{const s=$(FxImpl.createElement("div",{class:`fxs-flowlayout-resolutionguide fxs-flowlayout-resolutionguide-${t.x}x${t.y} fxs-hide-in-normal`}));(e.x||e.y)&&s.css({top:e.y+"px",left:e.x+"px"}),this.element.prepend(s)}))}}var T;t.Widget=F,function(e){e.top=function(e){return e.position.row},e.bottom=function(e){return e.position.row+e.rowSpan},e.left=function(e){return e.position.col},e.right=function(e){return e.position.col+e.colSpan}}(T||(T={}));class k{constructor(){this._occupancyGrid=[]}reset(e){this._occupancyGrid.length=0,e&&e.forEach((e=>{this.markOccupancy(e)}))}isRectangleFree(e,t,s,i){const o=e+i,n=t+s;for(let s=e;s<o;s++)for(let e=t;e<n;e++)if(this.isPositionOccupied(s,e))return!1;return!0}isPositionOccupied(e,t){return!!this._occupancyGrid[e]&&!!this._occupancyGrid[e][t]}getItemAt(e,t){const s=this._occupancyGrid[e];return s?s[t]:null}markOccupancy(e,t){const s=T.top(e),i=T.bottom(e),o=T.left(e),n=T.right(e),r=this._occupancyGrid;for(let a=o;a<n;a++)for(let o=s;o<i;o++)r[a]||(r[a]=[]),r[a][o]||(r[a][o]=null),r[a][o]=t?null:e}}const E={};class D{constructor(e){this._occupancyGrid=new k,this._items=[],this._filledPositions={},this._gridOptions=e}append(e,t,s){let i=this._getExistingItem(e);if(this._filledPositions[e]=!0,i)return this._items;const o=this._maxRows(),n=this._maxCols();if(!this._gridOptions.allowOverflow&&(t>o||s>n))throw new Error("The element cannot fit in this grid. ElementRowSpan: {0}, ElementColSpan: {1}, GridMaxRowSpan: {2}, GridMaxColSpan: {3}".format(t,s,o,n));const r=this._findNextAvailablePositionForRectangle(t,s);if(!r)throw new Error("The element cannot fit in the remaining space available in the grid.");return i={id:e,position:r,rowSpan:t,colSpan:s},this._items.push(i),this._occupancyGrid.markOccupancy(i),this._items}move(e,t,s,i,o){const n={id:e,position:t,colSpan:s,rowSpan:i};let r;this._applyGridConstraints(n);const a=new A(this._items,n,this._gridOptions);return r=a.resolved?a.getItems():this._items,o&&(a.resolved&&(this._items.length=0,this._items.push(...r||[])),this._occupancyGrid.reset(this._items),this.collapseGaps()),r}resize(e,t,s,i){const o=this._getExistingItem(e),n=o.position,r={id:o.id,position:{col:n.col,row:n.row},colSpan:t,rowSpan:s},a=r.position;let l;if(this._applyGridConstraints(r),a.row<0||a.col<0)return this._items;const c=Math.max(0,t-o.colSpan),d=Math.max(0,s-o.rowSpan);let p=a.col,u=a.row;this._gridOptions.allowGaps||(p=Math.min(p,Math.max(0,n.col-c)),u=Math.min(u,Math.max(0,n.row-d)));for(let i=p;i<=a.col;i++){for(let o=u;o<=a.row;o++){const n={id:e,position:{col:i,row:o},colSpan:t,rowSpan:s},r=new A(this._items,n,this._gridOptions);if(r.resolved&&((!l||r.shiftCost<l.shiftCost)&&(l=r),l&&0===l.shiftCost))break}if(l&&0===l.shiftCost)break}const m=l?l.getItems():this._items;return i&&(l&&(this._items.length=0,this._items.push(...m||[])),this._occupancyGrid.reset(this._items),this.collapseGaps()),m}remove(e){const t=this._getExistingItem(e);this._filledPositions[e]=!1;const s=this._items.indexOf(t);return-1===s||(this._items.splice(s,1),this._occupancyGrid.markOccupancy(t,!0),this.collapseGaps()),this._items}collapseGaps(){if(this._gridOptions.allowGaps)return;const e={grid:this,isPositionOccupied:function(e,t){return this.grid._occupancyGrid.isPositionOccupied(e,t)},getMaxPositions:function(){return this.grid.getMaxOccupiedPositions()},getMinSize:function(){return{col:this.grid._minCols(),row:this.grid._minRows()}},getItemAt:function(e,t){return this.grid._occupancyGrid.getItemAt(e,t)},shiftItem:function(e,t){e.position.col-=t}},t={grid:this,isPositionOccupied:function(e,t){return this.grid._occupancyGrid.isPositionOccupied(t,e)},getMaxPositions:function(){const e=this.grid.getMaxOccupiedPositions();return{col:e.row,row:e.col}},getMinSize:function(){return{col:this.grid._minRows(),row:this.grid._minCols()}},getItemAt:function(e,t){return this.grid._occupancyGrid.getItemAt(t,e)},shiftItem:function(e,t){e.position.row-=t}};this._orientation()===x.Horizontal?(this._collapseGapsWithGridVisitor(e),this._collapseGapsWithGridVisitor(t)):(this._collapseGapsWithGridVisitor(t),this._collapseGapsWithGridVisitor(e))}getNaturalDomElementOrder(){const e=[],t=this.getMaxOccupiedPositions();for(let s=0;s<t.row;s++)for(let i=0;i<t.col;i++){const t=this._occupancyGrid.getItemAt(i,s);if(t){const s=t.id;e.includes(s)||e.push(s),i+=t.colSpan-1}}return e}getAdjacentElement(e,t){const s=this._getExistingItem(e);if(!s)return e;const i=E[t];return(i?i(this,s):s).id}get positions(){return this._items}set positions(e){this._items.length=0,this._items=e||[],this._occupancyGrid.reset(this._items)}discardUnusedPositions(){const e=[];return this._items.slice(0).forEach((t=>{this._filledPositions[t.id]||(e.push(t),this.remove(t.id))})),e}_orientation(){return this._gridOptions.orientation}_minRows(){return this._gridOptions.minRows.value}_maxRows(){return this._gridOptions.maxRows.value}_minCols(){return this._gridOptions.minColumns.value}_maxCols(){return this._gridOptions.maxColumns.value}getMaxOccupiedPositions(e){let t;const s=e||this._items;let i=0,o=0;for(t=0;t<s.length;t++){const e=s[t],n=e.position;i=Math.max(i,n.col+e.colSpan),o=Math.max(o,n.row+e.rowSpan)}return{col:i,row:o}}_getExistingItem(e){return MsPortalFx.find(this._items,(function(t){return t.id===e}))}_applyGridConstraints(e){let t;if(this._gridOptions.allowOverflow)return;const s=e.position;t=T.bottom(e)-this._maxRows(),t>0&&(s.row-=t),t=T.right(e)-this._maxCols(),t>0&&(s.col-=t)}_findNextAvailablePositionForRectangle(e,t){const s=this._maxCols()-t+1,i=this._maxRows()-e+1;let o,n;if(this._orientation()===x.Horizontal){for(n=0;n<s;n++)for(o=0;o<i;o++)if(this._isRectangleFree(n,o,e,t))return{col:n,row:o};if(this._gridOptions.allowOverflow){return{col:0,row:this.getMaxOccupiedPositions().row}}}else{for(o=0;o<i;o++)for(n=0;n<s;n++)if(this._isRectangleFree(n,o,e,t))return{col:n,row:o};if(this._gridOptions.allowOverflow){return{col:this.getMaxOccupiedPositions().col,row:0}}}}_isRectangleFree(e,t,s,i){const o=e+i,n=t+s;return!(!this._gridOptions.allowOverflow&&(n>this._maxRows()||o>this._maxCols()))&&this._occupancyGrid.isRectangleFree(e,t,s,i)}_collapseGapsWithGridVisitor(e){let t=e.getMaxPositions(),s=t.col,i=t.row;const o=[];let n,r,a=!1;if(!(s<=e.getMinSize().col))for(let l=0;l<s;l++){r=null;for(let t=0;t<i;t++){a=!1,o[t]=this._findGap(t,l,s,e);const i=o[t].colSpan;if(0===i)return;if((!r||i<r)&&(r=i),t>0&&!this._gapsAreContiguous(o[t-1],o[t]))break;a=!0}if(a){n={};for(let t=0;t<i;t++)for(let i=T.right(o[t]);i<s;i++){const s=e.getItemAt(i,t);s&&(n[s.id]=s)}$.each(n,((t,s)=>{e.shiftItem(s,r)})),this._occupancyGrid.reset(this._items),t=e.getMaxPositions(),s=t.col,i=t.row}}}_gapsAreContiguous(e,t){const s=T.left(t),i=T.right(t),o=T.left(e);return T.right(e)>=s&&o<=i}_findGap(e,t,s,i){let o=t;const n={id:"",position:{row:e,col:0},rowSpan:1,colSpan:0};for(;o<s&&i.isPositionOccupied(o,e);)o++;for(n.position.col=o;o<s&&!i.isPositionOccupied(o,e);)n.colSpan++,o++;return n}static _scanAdjacentUp(e,t){const s=t.position,i=s.col,o=s.row-1,n=s.col+t.colSpan;for(let t=o;t>=0;t--)for(let s=i;s<n;s++){const i=e._occupancyGrid.getItemAt(s,t);if(i)return i}return t}static _scanAdjacentRight(e,t){const s=t.position,i=s.col+t.colSpan,o=s.row,n=e.getMaxOccupiedPositions().col,r=s.row+t.rowSpan;for(let t=i;t<n;t++)for(let s=o;s<r;s++){const i=e._occupancyGrid.getItemAt(t,s);if(i)return i}return t}static _scanAdjacentDown(e,t){const s=t.position,i=s.col,o=s.row+t.rowSpan,n=s.col+t.colSpan,r=e.getMaxOccupiedPositions().row;for(let t=o;t<r;t++)for(let s=i;s<n;s++){const i=e._occupancyGrid.getItemAt(s,t);if(i)return i}return t}static _scanAdjacentLeft(e,t){const s=t.position,i=s.col-1,o=s.row,n=s.row+t.rowSpan;for(let t=i;t>=0;t--)for(let s=o;s<n;s++){const i=e._occupancyGrid.getItemAt(t,s);if(i)return i}return t}}t.FlowLayoutPositioningEngine=D,E[1]=D._scanAdjacentUp,E[2]=D._scanAdjacentRight,E[3]=D._scanAdjacentDown,E[4]=D._scanAdjacentLeft;class A{constructor(e,t,s){this.shiftCost=0,this.resolved=!1,this._resolvedItems=[],this._occupancyGrid=new k,this._gridOptions=s,e.forEach((e=>{let s;t.id!==e.id&&(s=$.extend(!0,{},e),this._resolvedItems.push(s),this._occupancyGrid.markOccupancy(s))})),this.resolved=this._resolveConflict(t);const i=$.extend(!0,{},t);this._resolvedItems.push(i),this._occupancyGrid.markOccupancy(i)}getItems(){return this._resolvedItems}_orientation(){return this._gridOptions.orientation}_maxRows(){return this._gridOptions.maxRows.value||999}_maxCols(){return this._gridOptions.maxColumns.value||999}_resolveConflict(e){let t=!1;return this._orientation()===x.Horizontal?(t=this._tryMoveConflictsLeft(e,{})||t,t=this._tryMoveConflictsUp(e,{})||t,t=this._tryMoveConflictsDown(e,{})||t,t=this._tryMoveConflictsRight(e,{})||t):(t=this._tryMoveConflictsUp(e,{})||t,t=this._tryMoveConflictsLeft(e,{})||t,t=this._tryMoveConflictsRight(e,{})||t,t=this._tryMoveConflictsDown(e,{})||t),t}_tryMoveConflictsUp(e,t){t[e.id]=!0;for(let s=T.left(e);s<T.right(e);s++)for(let i=T.top(e);i<T.bottom(e);i++){const o=this._occupancyGrid.getItemAt(s,i);if(o&&!t[o.id]){t[o.id]=!0,i=T.bottom(o);const s=T.top(e)-T.bottom(o),n=this._getConflictArea(o,0,s);if(T.bottom(n)>this._maxRows()||T.top(n)<0)return!1;if(!this._tryMoveConflictsUp(n,t))return!1;this._moveItem(o,0,s),t[o.id]=!1}}return!0}_tryMoveConflictsDown(e,t){t[e.id]=!0;for(let s=T.left(e);s<T.right(e);s++)for(let i=T.bottom(e)-1;i>=T.top(e);i--){const o=this._occupancyGrid.getItemAt(s,i);if(o&&!t[o.id]){t[o.id]=!0,i=T.top(o);const s=T.bottom(e)-T.top(o),n=this._getConflictArea(o,0,s);if(T.bottom(n)>this._maxRows()||T.top(n)<0)return!1;if(!this._tryMoveConflictsDown(n,t))return!1;this._moveItem(o,0,s),t[o.id]=!1}}return!0}_tryMoveConflictsLeft(e,t){t[e.id]=!0;for(let s=T.top(e);s<T.bottom(e);s++)for(let i=T.left(e);i<T.right(e);i++){const o=this._occupancyGrid.getItemAt(i,s);if(o&&!t[o.id]){t[o.id]=!0,i=T.right(o);const s=T.left(e)-T.right(o),n=this._getConflictArea(o,s,0);if(T.right(n)>this._maxCols()||T.left(n)<0)return!1;if(!this._tryMoveConflictsLeft(n,t))return!1;this._moveItem(o,s,0),t[o.id]=!1}}return!0}_tryMoveConflictsRight(e,t){t[e.id]=!0;for(let s=T.top(e);s<T.bottom(e);s++)for(let i=T.right(e)-1;i>=T.left(e);i--){const o=this._occupancyGrid.getItemAt(i,s);if(o&&!t[o.id]){t[o.id]=!0,i=T.left(o);const s=T.right(e)-T.left(o),n=this._getConflictArea(o,s,0);if(T.right(n)>this._maxCols()||T.left(n)<0)return!1;if(!this._tryMoveConflictsRight(n,t))return!1;this._moveItem(o,s,0),t[o.id]=!1}}return!0}_getConflictArea(e,t,s){const i=s<0,o=t<0,n=e.position;return{id:e.id,position:{row:i?n.row+s:n.row,col:o?n.col+t:n.col},rowSpan:e.rowSpan+Math.abs(s),colSpan:e.colSpan+Math.abs(t)}}_moveItem(e,t,s){this._occupancyGrid.markOccupancy(e,!0);const i=e.position;i.col+=t,i.row+=s,this._occupancyGrid.markOccupancy(e),this.shiftCost+=e.colSpan*e.rowSpan}}t.FlowLayoutPositionConflictResolver=A})),
define("MsPortalImpl/Widgets/Widgets.StartBoard",["require","exports","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.RightClick","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Widgets/Widgets.FlowLayout","MsPortalImpl/Widgets/Widgets.LayoutBase","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.Timers","MsPortalImpl/UI/UI.DesktopManager","Viva.Controls/Util/Viva.Resize","Weave","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css","MsPortalImpl/Services/Services.GeneralSettings"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h){"use strict";t.Widget=t.ViewModel=void 0,(0,m.injectCss)(g);const f=MsPortalFx.Base.Diagnostics.createLog(e),x=s.Dashboard,b=window.fx.environment;class y extends l.ViewModel{constructor(e,t,i,o,l,c,d){super(e),this.loading=l,this.notFound=c,this.diContainer=d,this.title=(0,u.makeWritableComputation)(s.Dashboard.defaultTitle),this.dashboardList=(0,u.makeWritableComputation)(),this.headerMode=(0,u.makeWritableComputation)(0),this.isShared=(0,u.makeWritableComputation)(!1),this.notFoundMessage=(0,u.makeWritableComputation)(""),this.subscriptionsInfo=(0,u.makeWritableComputation)(""),this.dashboardErrorMessage=(0,u.makeWritableComputation)(""),this.dashboardChanged=(0,u.makeWritableComputation)(!1),this.dashboardSaveInProgress=(0,u.makeWritableComputation)(!1),this.userPermissions=(0,u.makeWritableComputation)({canModify:!1,canDelete:!1}),this.finishDashboardEdit=$.noop,this.locked(!1);const p=this.flowLayoutOptions=new r.ViewModel("fxs-flowlayout-instanceid");p.allowReorder=!0,p.allowOverflow=!0,p.allowGaps=!0,p.resolutionGuides=!0,p.resolutionGuidesOffset.y=-88,p.orientation=a.Orientation.Vertical,p.minColumns(4),p.maxColumns(6),p.minRows(4),p.locked(!1),this.filtersWidgetViewModel=i,this.dashboardDropMenuViewModel=new n.ViewModel(void 0,void 0,".fxs-startboard-dropdown-dashboard, .fxs-startboard-button-browse"),this.dashboardDropMenuViewModel.alignMenu=0,this.dashboardDropMenuViewModel.telemetrySource="Dashboard",this.commands=o,this.applyViewSettings(t)}getViewSettings(){return{NormalState:{layoutSettings:this.flowLayoutOptions.getViewSettings()}}}applyViewSettings(e){e&&e.NormalState&&e.NormalState.layoutSettings&&this.flowLayoutOptions.applyViewSettings(e.NormalState.layoutSettings)}setWidget(e){this._widget=e}getWidget(){return this._widget}exitOrganizeMode(){this.diContainer.get(d.DesktopManagerMode).value(0);const e=this._widget.element.find(".fxs-startboard-button-edit>.azc-toolbarButton-container");e.length&&e.focus()}}t.ViewModel=y;class v extends l.Widget{constructor(e,t,n){super(e,t,!0),this._focusToDropMenu=n,this._layout=null,this._setFocusOnAnimationFrame=c.throttleByAnimationFrame((()=>{let e;if(this._$lastFocused&&$.contains(this.element[0],this._$lastFocused[0])&&o.isVisible(this._$lastFocused)&&(this._$lastFocused.focus(),e=!0),!e){const e=this._layout.element.findFirstTabbable();1===e.length?e.focus():this._focusToDropMenu()}})),t.setWidget(this);const a=this.ltm;let l;this._features=t.diContainer.get(FxImpl.Features),(0,u.subscribeAndRun)(a,[t.title],(e=>{const i=t.diContainer.get(h.GeneralSettings).landingPage();2!==i&&4!==i||(document.title=s.Portal.windowTitleFormat.format(e,b.branding.title))})),this._layout=new r.Widget($(e[0].querySelector(".fxs-startboard-layout")),t.flowLayoutOptions,!0);const m=e=>{l=e;const s=Math.max(6,Math.floor((e-420)/90));t.flowLayoutOptions.maxColumns(s)},g=t.diContainer.get(d.DesktopManagerMode).value;g.subscribe(this.ltm,(e=>{1===e&&m(this.element.width())})),p.track(this.ltm,this.element.first(),(e=>{1===g()&&l!==e&&m(e)})),this._initializeCommands(a,e),this._attachEventHandlers(e),a.registerForDispose([i.setup(e,ko.observableArray(t.commands))])}dispose(){this._layout.dispose(),super.dispose()}createTiles(e){return this._layout.createTiles(e,this.options.diContainer)}addChild(e){if(!e)throw new Error("Can't add null child.");this._layout.addChild(e)}removeChild(e){return this._layout.removeChild(e)}moveChild(e,t,s,i){this._layout.moveChild(e,t,s,i)}setFocus(){this._features.isEnabled("skipautofocus")||this._setFocusOnAnimationFrame()}saveViewSettings(){return this.options.getViewSettings()}discardStateOfUnusedChildren(){return f.assert(!!this._layout,"FlowLayout not defined."),this._layout?this._layout.discardStateOfUnusedChildren():{stateDiscarded:!1}}getDomOrderedChildren(){return this._layout.getDomOrderedChildren()}_attachEventHandlers(e){this.ltm.registerForDispose(e.setEvents(["layoutUpdated",t=>{e.trigger(l.Widget.viewSettingsChanged,this.saveViewSettings()),t.stopPropagation()}],["focusout",e=>{this._$lastFocused=$(e.target)}]))}_initializeCommands(e,t){const s=this.options,i=s.dashboardDropMenuViewModel,o=c.debounce((()=>{this._focusToDropMenu()}));i.isMenuOpen.subscribe(e,(e=>{e&&s.refreshDashboardList&&(s.dashboardList(void 0),s.refreshDashboardList((e=>{s.dashboardList(e),o()})))})),(0,u.subscribeAndRun)(this.ltm,[s.title],(e=>{i.buttonTooltip(e),i.buttonLabel(x.switcherLabel),i.buttonDescribedBy(x.switcherDescribedby.format(e))}))}}t.Widget=v})),
define("MsPortalImpl/Widgets/Widgets.AsyncSearch",["require","exports","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","Weave","Weave/Core/Computation","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css"],(function(e,t,s,i,o,n,r,a){"use strict";t.searchClass=t.searchBoxClass=t.Widget=t.ViewModel=void 0;var l=MsPortalFx.Base.Images;(0,r.injectCss)(a);t.searchClass="fxs-search";const c=t.searchBoxClass="fxs-search-box",d=s.Search,p=s.SideBarFlyout.disabledMessage;class u extends i.ViewModel{constructor(){super(),this._ltm=new FxImpl.TriggerableLifetimeManager,this._dropdownInitialized=Promise.withResolvers(),this.isExpanded=(0,o.makeWritableComputation)(!1),this.showMenu=ko.observable(!1),this.showResults=ko.observable(!1),this.showSearching=ko.observable(!1),this.showNoResults=ko.observable(!1),this.noResultsMessage=ko.observable(),this.noResultsChangeSubscriptionsText=d.Pills.noResultsMessageWithLinks.format(`<a href="#settings/directory">${d.Pills.directoryAndSubscriptionSettings}</a>`),this.showChangeSubscriptions=ko.observable(!1),this.isSearchComplete=ko.observable(!1),this.text={...d,DisabledByPolicyMessage:p},this.filter=ko.observable(""),this.searchInFilterText=ko.observable(),this.showSubscriptionSummaryAndLink=ko.observable(MsPortalFx.isFeatureEnabled("artbrowse")),this.subscriptionSummary=ko.observable(),this.mruItems=ko.observableArray(),this.searchHistory=ko.observableArray(),this.recentServices=ko.observableArray(),this.additionalSearchProviders=ko.observableArray(),this.resultsPanel=ko.observableArray(),this.pillsCollection=ko.observable(),this.currentPill=ko.observable(),this.menuId=MsPortalFx.getUniqueId(),this.showAzureCopilotLink=ko.observable(!1),this.azureCopilotLinkHtml=ko.observable(),this.icons={hyperlink:l.Hyperlink(),favorite:l.Star({palette:99}),notFavorite:l.Favorite({palette:99})}}isDropdownInitialized(){return this._dropdownInitialized.promise}dispose(){this._ltm.dispose()}setFocus(){this._widget&&this._widget.setFocus()}setWidget(e){this._widget=e}getWidget(){return this._widget}getRootElement(){return this._widget.element}}t.ViewModel=u;class m extends i.Widget{constructor(e,t,s){super(e,t,!0),this._documentCategoryDisplayName=d.documentation,t.setWidget(this),t.showMenu.subscribe(this.ltm,(e=>{e||(t.filter(""),this._textField&&this._textField.val(""))})),window.fx.environment.chrome.hideSearchBox&&e.addClass("fxs-display-none"),this._textField=$(e[0].querySelector(`.${c} input`));const i=e=>{o.dispose(),t.showMenu(!0),MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AsyncSearchDeferred").then((e=>{e.initialize(this.ltm,s,t,this._textField),t._dropdownInitialized.resolve()}))};e[0].addEventListener("focusin",i);const o=this.ltm.createChildLifetime();o.registerForDispose((()=>e[0].removeEventListener("focusin",i)))}setFocus(){this.options.isExpanded(!0);const e=document.activeElement;(0,n.invokeAfterChangePropagation)((()=>{e===document.activeElement&&this._textField.focus()}))}}t.Widget=m})),
define("MsPortalImpl/UI/UI.PassthroughUser",["require","exports","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/UI.DialogManager","Fx/Telemetry","MsPortalImpl/UI/UI.AuthStateManager"],(function(e,t,s,i,o,n,r){"use strict";t.checkPassthroughUserWithNoSubs=async function(e){if(FxImpl.features.isEnabled("forcecheckpassthroughuser"))return!0;if(!FxImpl.features.isEnabled("checkpassthroughuser"))return!1;const[t,i]=await Promise.all([e.get(r.AuthStateManager).getCurrentUser(),e.get(s.SubscriptionsUserContext).getAllSubscriptionsCount()]),o=!t.objectId&&t.tenantId!==FxImpl.internalEnv.fxAadInfrastructureTenantId&&!t.hasAaiClaim&&[4,1].includes(i.type)&&0===i.value;return(0,n.trace)({source:"UI.PassthroughUser",action:"PassthroughUser",data:{isPassthroughUser:o}}),o},t.launchPassthroughModalDialog=async function(e,t){const s=await e.getAsync(o.DialogManager);if(3===await s.showModalDialog({title:a.dialogTitle,description:a.dialogContent,buttons:4,defaultButtonText:a.dialogDefaultButtonText,cancelButtonText:a.dialogCancelButtonText}))return t()};MsPortalFx.ViewModels;const a=i.Passthrough})),
define("_generated/MsPortalImpl/Svg/Library/Feedback.svg",["require","exports"],(function(e,t){"use strict";t.type=t.data=void 0;t.type=228,t.data="<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M7.484 10.375a5.6 5.6 0 0 1 1.438.828 5.376 5.376 0 0 1 1.109 1.2 5.682 5.682 0 0 1 .711 1.461A5.5 5.5 0 0 1 11 15.5v.5h-1v-.5a4.385 4.385 0 0 0-.352-1.75 4.459 4.459 0 0 0-.968-1.43 4.654 4.654 0 0 0-1.43-.961A4.458 4.458 0 0 0 5.5 11a4.385 4.385 0 0 0-1.75.352 4.459 4.459 0 0 0-1.43.968 4.654 4.654 0 0 0-.961 1.43A4.458 4.458 0 0 0 1 15.5v.5H0v-.5a5.391 5.391 0 0 1 .969-3.1 5.7 5.7 0 0 1 1.109-1.187 5.614 5.614 0 0 1 1.438-.836 3.359 3.359 0 0 1-.633-.563 3.551 3.551 0 0 1-.477-.687 3.387 3.387 0 0 1-.3-.781A3.858 3.858 0 0 1 2 7.5a3.391 3.391 0 0 1 .273-1.359 3.525 3.525 0 0 1 1.86-1.86A3.5 3.5 0 0 1 5.5 4a3.391 3.391 0 0 1 1.359.273 3.525 3.525 0 0 1 1.86 1.86A3.5 3.5 0 0 1 9 7.5a3.424 3.424 0 0 1-.1.836 3.311 3.311 0 0 1-.3.781 4.035 4.035 0 0 1-.477.695 3.076 3.076 0 0 1-.639.563ZM5.5 10a2.424 2.424 0 0 0 .969-.2 2.523 2.523 0 0 0 .789-.532 2.6 2.6 0 0 0 .539-.8 2.478 2.478 0 0 0 .008-1.946 2.46 2.46 0 0 0-.539-.789 2.746 2.746 0 0 0-.8-.539A2.348 2.348 0 0 0 5.5 5a2.424 2.424 0 0 0-.969.2A2.537 2.537 0 0 0 3.2 6.531a2.505 2.505 0 0 0 0 1.938 2.631 2.631 0 0 0 .532.8 2.436 2.436 0 0 0 .8.539A2.484 2.484 0 0 0 5.5 10ZM16 0v8h-2l-3 3V8h-1V7h2v1.586L13.586 7H15V1H5v1.8a8.641 8.641 0 0 0-.5.078 2.926 2.926 0 0 0-.5.141V0Z'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Library/LaunchCurrent.svg",["require","exports"],(function(e,t){"use strict";t.type=t.data=void 0;t.type=227,t.data="<svg viewBox='0 0 16 15' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M14.3 1H10V0h6v6h-1V1.7l-8 8-.7-.7z'/><path d='M11 8v5a.9.9 0 0 1-1 1H2a.9.9 0 0 1-1-1V6a.9.9 0 0 1 1-1h6l1-1H2a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7z'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Library/Mail.svg",["require","exports"],(function(e,t){"use strict";t.type=t.data=void 0;t.type=267,t.data="<svg viewBox='0 0 16 10' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M16 0v10H0V0zm-1 9V2.1L8 5.6 1 2.1V9zM1.1 1 8 4.4 14.9 1z'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Library/Person.svg",["require","exports"],(function(e,t){"use strict";t.type=t.data=void 0;t.type=44,t.data="<svg viewBox='0 0 14 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M9.4 9.4a6.9 6.9 0 0 1 1.9 1 7.5 7.5 0 0 1 1.5 1.6 5.6 5.6 0 0 1 .9 1.9A7.1 7.1 0 0 1 14 16h-1a6.4 6.4 0 0 0-.5-2.4 7.6 7.6 0 0 0-1.2-1.9 7.6 7.6 0 0 0-1.9-1.2A6.4 6.4 0 0 0 7 10l-1.6.2-1.5.6-1.2.9-.9 1.2-.6 1.5A7.8 7.8 0 0 0 1 16H0a8.3 8.3 0 0 1 .3-2.2 6.4 6.4 0 0 1 1-1.8 7 7 0 0 1 1.4-1.6l1.9-1-1.1-.8-.8-1a5 5 0 0 1-.5-1.3A5.1 5.1 0 0 1 2 5a4.1 4.1 0 0 1 .4-1.9 3.8 3.8 0 0 1 1.1-1.6A3.8 3.8 0 0 1 5.1.4 4.1 4.1 0 0 1 7 0a4.1 4.1 0 0 1 1.9.4 3.8 3.8 0 0 1 1.6 1.1 3.8 3.8 0 0 1 1.1 1.6A4.1 4.1 0 0 1 12 5a5.1 5.1 0 0 1-.2 1.3 5 5 0 0 1-.5 1.3l-.8 1zM3 5a4.1 4.1 0 0 0 .3 1.6 3.4 3.4 0 0 0 .9 1.2 3.4 3.4 0 0 0 1.2.9A4.1 4.1 0 0 0 7 9a4.1 4.1 0 0 0 1.6-.3 3.4 3.4 0 0 0 1.2-.9 3.4 3.4 0 0 0 .9-1.2A4.1 4.1 0 0 0 11 5a4.1 4.1 0 0 0-.3-1.6 3.4 3.4 0 0 0-.9-1.2 3.4 3.4 0 0 0-1.2-.9A4.1 4.1 0 0 0 7 1a4.1 4.1 0 0 0-1.6.3 3.4 3.4 0 0 0-1.2.9 3.4 3.4 0 0 0-.9 1.2A4.1 4.1 0 0 0 3 5z'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Library/Signout.svg",["require","exports"],(function(e,t){"use strict";t.type=t.data=void 0;t.type=226,t.data="<svg viewBox='0 0 14 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m9.2 2.3 1.9 1a12.1 12.1 0 0 1 1.6 1.6 6.6 6.6 0 0 1 .9 1.9A5.7 5.7 0 0 1 14 9a12.3 12.3 0 0 1-.2 1.9 8 8 0 0 1-.8 1.6 3.8 3.8 0 0 1-1.1 1.4 3.8 3.8 0 0 1-1.4 1.1l-1.6.8L7 16l-1.9-.2-1.6-.8a3.8 3.8 0 0 1-1.4-1.1A3.8 3.8 0 0 1 1 12.5a4.6 4.6 0 0 1-.7-1.6A6.3 6.3 0 0 1 0 9a5.7 5.7 0 0 1 .4-2.2 6.6 6.6 0 0 1 .9-1.9 12.1 12.1 0 0 1 1.6-1.6l1.9-1 .4 1a4.6 4.6 0 0 0-1.7.9 5.7 5.7 0 0 0-1.4 1.3 8 8 0 0 0-.8 1.6A5.8 5.8 0 0 0 1 9a7.8 7.8 0 0 0 .2 1.6l.6 1.4a4 4 0 0 0 1 1.2 4 4 0 0 0 1.2 1l1.4.6L7 15l1.6-.2 1.4-.6a4 4 0 0 0 1.2-1 4 4 0 0 0 1-1.2l.6-1.4A7.8 7.8 0 0 0 13 9a5.8 5.8 0 0 0-.3-1.9 8 8 0 0 0-.8-1.6 5.7 5.7 0 0 0-1.4-1.3 4.6 4.6 0 0 0-1.7-.9zM7.5 8h-1V0h1z'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Startup/DirectoryFilter.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=392,t.data="<svg viewBox='0 0 19.723 20' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M3.578 0a1.766 1.766 0 0 0-.744.166A2.153 2.153 0 0 0 2.217.6a2.13 2.13 0 0 0-.433.621 1.762 1.762 0 0 0-.165.739V4H0v1.418h1.619v6.589H0v1.415h1.619v2.044a1.893 1.893 0 0 0 .154.762 1.969 1.969 0 0 0 .42.623 1.944 1.944 0 0 0 .625.421 1.91 1.91 0 0 0 .75.152h7.459v-1.415H6.485V1.416h9.13v6h1.415V0zm1.5 16.009H3.7a.645.645 0 0 1-.26-.051.686.686 0 0 1-.212-.144.711.711 0 0 1-.145-.214 1.861 1.861 0 0 1-.047-.387v-1.791h.7v-1.415h-.7V5.418h.7V4h-.7V2.084a.493.493 0 0 1 .054-.22.88.88 0 0 1 .39-.391.5.5 0 0 1 .22-.057h1.382z'/><path d='M19.514 8.63H8.826v1.894l.061.061 3.454 4.442V20h3.867v-4.973l3.454-4.442.061-.061V8.63zm-4.637 5.755-.061.061v4.164h-1.085v-4.168l-.061-.061-3.376-4.364h7.961z'/></g></svg>"})),
define("MsPortalImpl/ViewModels/AvatarMenuCommon",["require","exports","_generated/MsPortalImpl/Svg/Startup/DirectoryFilter.svg","_generated/MsPortalImpl/Svg/Library/Feedback.svg","MsPortalImpl/Resources/ImplScriptResources","_generated/MsPortalImpl/Svg/Library/LaunchCurrent.svg","_generated/MsPortalImpl/Svg/Library/Mail.svg","_generated/MsPortalImpl/Svg/Library/Person.svg","_generated/MsPortalImpl/Svg/Library/Signout.svg","MsPortalImpl/Widgets/Widgets.WidgetBase","Weave"],(function(e,t,s,i,o,n,r,a,l,c,d){"use strict";t.ViewModel=void 0;var p=MsPortalFx.Base.Images;const u=fx.environment;class m extends c.ViewModel{constructor(){super(...arguments),this.avatarImage=(0,d.makeWritableComputation)(),this.contactInfoEnabled=ko.observable(!1),this.hideTenant=(0,d.makeWritableComputation)(),this.icons={contactInfo:r,feedback:i,launchCurrent:n,person:p.CustomImageWithOptions(a,{palette:99}),signout:l,switchDirectory:s},this.links=u.links,this.listOfTenants=(0,d.makeArrayComputation)(),this.showDiagnosticsDelay=2e3,this.text=o.AvatarMenu,this.userIdentity=(0,d.makeWritableComputation)(),this.userInfo=(0,d.makeWritableComputation)(),this.gitHubUserInfo=(0,d.makeWritableComputation)()}}t.ViewModel=m})),
define("MsPortalImpl/Widgets/Widgets.SimpleAvatarMenuFlyout",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Common","Weave"],(function(e,t,s,i,o,n){"use strict";t.Widget=void 0;var r=s;const a=r.tsx("div",{class:"fxs-avatarmenu-dropdown"},r.tsx("ul",{class:"fxs-avatarmenu-list-system fxs-portal-border fxs-dropmenu-line-separator",role:"presentation"},r.tsx("li",{class:"fxs-portal-hover",role:"presentation"},r.tsx("a",{href:"",class:"fxs-avatarmenu-signout fxs-avatarmenu-dropdown-item",role:"menuitem","data-bind":{attr:{title:"data.text.signOutLabel"}}},r.tsx("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.signOutLabel"}}),r.tsx("div",{class:"fxs-dropmenu-image fxs-fill-error","data-bind":{image:"data.icons.signout"}})))),r.tsx("div",{class:"fxs-avatarmenu-scrollviewer"},r.tsx("div",{class:"fxs-avatarmenu-list-system"},r.tsx("ul",{role:"presentation"},r.tsx("li",{class:"fxs-portal-hover","data-bind":{visible:"changePasswordLink"},role:"presentation"},r.tsx("a",{tabindex:"-1",class:"fxs-avatarmenu-changepassword fxs-avatarmenu-dropdown-item",role:"menuitem",target:"_blank",rel:"noopener noreferrer","data-bind":{attr:{href:"changePasswordLink",title:"data.text.changePasswordLabel"}}},r.tsx("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.changePasswordLabel"}}),r.tsx("div",{class:"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"data.icons.launchCurrent"}}))),r.tsx("li",{class:"fxs-portal-hover","data-bind":{visible:"data.contactInfoEnabled"},role:"presentation"},r.tsx("a",{tabindex:"-1",class:"fxs-avatarmenu-contactinfo fxs-avatarmenu-dropdown-item",role:"menuitem",href:""},r.tsx("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.contactInfo"}}),r.tsx("div",{class:"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"data.icons.contactInfo"}}))),r.tsx("li",{class:"fxs-portal-hover",role:"presentation"},r.tsx("a",{tabindex:"-1",class:"fxs-avatarmenu-myaccess fxs-avatarmenu-dropdown-item",role:"menuitem",href:""},r.tsx("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.myAccessLabel"}}),r.tsx("div",{class:"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"data.icons.person"}}))),r.tsx("li",{class:"fxs-portal-hover","data-bind":{visible:"!!data.links.submitAnIdea"},role:"presentation"},r.tsx("a",{tabindex:"-1",class:"fxs-avatarmenu-feedback fxs-avatarmenu-dropdown-item",role:"menuitem",href:"",target:"_blank",rel:"noopener noreferrer","data-bind":{attr:{href:"data.links.submitAnIdea",title:"data.text.feedbackLabel"}}},r.tsx("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.feedbackLabel"}}),r.tsx("div",{class:"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"data.icons.feedback"}}))),r.tsx("li",{class:"fxs-portal-hover","data-bind":{visible:"data.links.accountPortal"},role:"presentation"},r.tsx("a",{tabindex:"-1",class:"fxs-avatarmenu-billing fxs-avatarmenu-dropdown-item",role:"menuitem",href:"",rel:"noopener noreferrer"},r.tsx("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.billingLabel"}}),r.tsx("div",{class:"fxs-dropmenu-image fxs-portal-svg","data-bind":{visible:"data.links.accountPortal && data.links.accountPortal.startsWith('#')"}}))),r.tsx(s.KoIf,{condition:"showSwitchDirectoryOption"},r.tsx("li",{class:"fxs-portal-hover",role:"presentation"},r.tsx("a",{tabindex:"-1",class:"fxs-avatarmenu-switchdirectory fxs-avatarmenu-dropdown-item",role:"menuitem",href:""},r.tsx("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"data.text.switchDirectoryLabel"}}),r.tsx("div",{class:"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"data.icons.switchDirectory"}}))))))));class l extends i.Widget{constructor(e,t){super(e,t);const s=this.ltm;e.html(a);const i=ko.observable();(0,n.subscribeAndRun)(s,[t.userIdentity],(e=>{e&&i(e.changePasswordUri)})),this._bindDescendants({changePasswordLink:i,showSwitchDirectoryOption:!MsPortalFx.isFeatureEnabled("hideswitchdiroption")}),this._attachEventHandlers()}dispose(){this._cleanElement("fxs-avatarmenu-dropdown"),super.dispose()}_attachEventHandlers(){const e=this.options,t=e.links,s=this.element,i="click";this.ltm.registerForDispose(s.setEvents([i,".fxs-avatarmenu-signout",t=>{e.signedOut(),t.preventDefault()}],[i,".fxs-avatarmenu-billing",s=>{e.openAccountPortal(),t.accountPortal.startsWith("#")&&s.preventDefault()}],[i,".fxs-avatarmenu-switchdirectory",t=>{t.preventDefault(),e.switchDirectory()}],[i,".fxs-avatarmenu-myaccess",t=>{t.preventDefault(),e.showMyAccessBlade()}],[i,".fxs-avatarmenu-contactinfo",t=>{t.preventDefault(),e.showContactInfoBlade()}]))}setFocus(){o.waitForBindings(this.element[0]).then((()=>{this.element.find(".fxs-avatarmenu-signout").focus()}))}}t.Widget=l})),
define("MsPortalImpl/Widgets/Widgets.AvatarMenu",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/ViewModels/AvatarMenuCommon","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.SimpleAvatarMenuFlyout","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Services/Services.FavoritesSettings","Weave","FxInternal/Weave/Util","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css","MsPortalImpl/UI/UI.PassthroughUser"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m){"use strict";t.Widget=t.ViewModel=void 0,(0,p.injectCss)(u);var g=MsPortalFx.Base.Diagnostics,h=g.Telemetry;const f=fx.environment.meControl,x=g.createLog(e),b="TopBar",y=h.start,v=h.endTrace,w=h.completeTrace,M=s.tsx("div",{class:"fxs-flyout","data-bind":{stopBindings:"true"}}),C=s.tsx("div",{class:"fxs-avatarmenu-header","data-bind":{attr:{title:"tooltip"},css:{"fxs-avatarmenu-open":"isMenuOpen"}}},s.tsx("div",{class:"fxs-avatarmenu-tenant-container"},s.tsx("div",{class:"fxs-avatarmenu-username","data-bind":{text:"displayName"}}),s.tsx("div",{class:"fxs-avatarmenu-tenant","data-bind":{text:"currentTenantDisplayName"}})),s.tsx("div",{class:"fxs-avatarmenu-tenant-image-container"},s.tsx("img",{class:"fxs-avatarmenu-tenant-image","data-bind":{attr:{src:"avatarUri"}},alt:""})));function S(e){return(e||"").toLowerCase()}const I=/^(?:f(?:irst)?|l(?:ast)?)\s?name$/i;class P extends i.ViewModel{constructor(){var e,t;super(),this.displayName=this.userIdentity.compose((e=>(e=e||{}).preferredUsername||e.emailAddress||function(e){const t=e.firstName||"",s=e.lastName||"";return!t&&!s||I.test(t)&&I.test(s)?"":o.AvatarMenu.displayNameFormat.format(t,s)}(e)||this.text.defaultDisplayName)),this.tenantDisplayName=(0,c.makeWritableComputation)(""),this.dropMenuOptions=new a.ViewModel(C,M,".fxs-avatarmenu-dropdown-item"),this.dropMenuOptions.buttonId="fxs-avatarmenu-button",this.dropMenuOptions.buttonClass="fxs-menu-account",this.tooltip=(e=this,t=this.dropMenuOptions.buttonTooltip,(0,c.composeComputation)([e.userIdentity,e.hideTenant,e.listOfTenants],((s,i,o)=>{if(!s)return"";const n=e.text.Tooltip,r=n.tenant,a=[];(s.firstName||s.lastName)&&a.push(n.name.format(s.firstName||"",s.lastName||""));const l=s.preferredUsername||s.emailAddress;if(l&&a.push(n.email.format(l)),!i){const e=MsPortalFx.find(o,(e=>s.tenantId===e.id));if(e&&!i){a.push(r.format(e.displayName,e.id));const t=e.domainName||"",i=s.tenantDomain;a.push(i&&S(t)!==S(i)?r.format(t,i):n.domain.format(t))}}MsPortalFx.isFeatureEnabled("mfaavatarshield")&&s?.isMfa&&a.push(n.signedInWithMfa);const c=a.join("\n");return t(c),c})))}}t.ViewModel=P;class _ extends r.Widget{constructor(e,t,s){super(e,t,!0),this._isMeControlOpen=ko.observable(!1),this.meControlState=0;const i=this.ltm,n=(0,d.hasValueAsync)(i,t.userIdentity);let r;!MsPortalFx.isFeatureEnabled("usesimpleavatarmenu")&&f.baseUri&&f.aadAuthority&&(this.meControlState=1);const p=t.dropMenuOptions;this._dropMenuWidget=new a.Widget(e,p,!0,!0),p.isMenuOpen.subscribe(i,(e=>{const t=this.element.find(".fxs-flyout"),o=(e,s)=>{this.element.find("#mectrl_main_body").parent().parent().remove(),v(s,"failed",{message:e.message,stack:e.stack}),x.warning(MsPortalFx.getLogFriendlyMessage(e)),this.meControlState=2,r&&r.dispose(),this._loadSimpleAvatarMenu(t)};if(1===this.meControlState){if(!r&&e){const e=y({source:b,action:"MeControlAvatarMenuOpen"});n.then((o=>MsPortalFx.Base.Promises.cancelOnDispose(i,(()=>MsPortalFx.require("MsPortalImpl/Widgets/Widgets.MeControl"))).then((n=>(r=new n.Widget(t,this.options,s,o,this._isMeControlOpen),i.registerForDispose(r),r.getInitializedPromise().then((()=>{w(e)}))))))).catch((t=>{o(t,e)}))}}else this._loadSimpleAvatarMenu(t)}));const u=t.tenantDisplayName;Promise.all([(0,d.hasValueAsync)(i,t.userInfo),(0,m.checkPassthroughUserWithNoSubs)(s)]).then((([e,i])=>{const n=e.directoryId&&e.directoryId.toLowerCase(),r=e.uniqueDirectoryName||"";i?u(o.AvatarMenu.passthrough):t.hideTenant.value?u(""):r&&r.toLowerCase()!==n?u(r):s.getAsync(l.UserDirectorySettings).then((e=>{const t=e.userDefaultDirectory()||{};(t.id||"").toLowerCase()===n&&u(t.displayName)}))})),(0,c.subscribe)(this.ltm,[t.displayName,u],(()=>{this.trigger("fxavatartextchange")}))}_loadSimpleAvatarMenu(e){if(this.ltm&&!this.ltm.isDisposed()){const t=y({source:b,action:"SimpleAvatarMenuOpen"});this._simpleFlyout||(this._simpleFlyout=new n.Widget(e,this.options),this.ltm.registerForDispose(this._simpleFlyout)),this._dropMenuWidget.setFocus(),w(t)}}dispose(){this._dropMenuWidget.dispose(),this._cleanElementClasses(["fxs-avatarmenu"]),super.dispose()}getDropMenuOpenObservable(){return 1===this.meControlState?this._isMeControlOpen:this._dropMenuWidget.options.isMenuOpen}}t.Widget=_})),
define("_generated/MsPortalImpl/Svg/Startup/Chevron.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=158,t.data="<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m8.2 6-5.5 5.5.6.5 6-6-6-6-.6.5z'/></g></svg>"})),
define("MsPortalImpl/Widgets/Widgets.Search",["require","exports","_generated/MsPortalImpl/Svg/Startup/Hyperlink.svg","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/MsPortalImpl/Svg/Startup/Search.svg","_generated/MsPortalImpl/Svg/Startup/Close.svg","_generated/MsPortalImpl/Svg/Startup/Chevron.svg","Weave","Weave/Core/Computation","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css"],(function(e,t,s,i,o,n,r,a,l,c,d,p){"use strict";t.searchClass=t.searchBoxClass=t.Widget=t.ViewModel=void 0,(0,d.injectCss)(p);t.searchClass="fxs-search";const u=t.searchBoxClass="fxs-search-box",m=i.Search;class g extends o.ViewModel{initOptions(e){this._initOptions=e}constructor(){super(),this._ltm=new FxImpl.TriggerableLifetimeManager,this._dropdownInitialized=Promise.withResolvers(),this.isExpanded=(0,l.makeWritableComputation)(!1),this.showMenu=ko.observable(!1),this.showResults=ko.observable(!1),this.showSearching=ko.observable(!1),this.showExternalColumn=ko.observable(!1),this.showAllSubscriptionsSearch=ko.observable(!1),this.showChangeSubscriptions=ko.observable(!1),this.icons={search:n,close:r,chevron:a,hyperlink:s},this.text=m,this.filter=ko.observable(),this.searchInFilterText=ko.observable(),this.subscriptionSummary=ko.observable(),this.mruItems=ko.observableArray(),this.results=ko.observableArray()}isDropdownInitialized(){return this._dropdownInitialized.promise}dispose(){this._ltm.dispose()}setFocus(){this._widget&&this._widget.setFocus()}setWidget(e){this._widget=e}getWidget(){return this._widget}getRootElement(){return this._widget.element}}t.ViewModel=g;class h extends o.Widget{constructor(e,t,s){super(e,t),t.setWidget(this),window.fx.environment.chrome.hideSearchBox&&e.addClass("fxs-display-none"),this._textField=$(e[0].querySelector(`.${u} input`));const i=s=>{e.off("focusin",i),t.showMenu(!0);const o=t._initOptions;(o&&o()||Promise.resolve(void 0)).then((()=>{MsPortalFx.require("MsPortalImpl/Widgets/Widgets.SearchDeferred").then((e=>{t._dropdownInitialized.resolve(),e.initialize(this.ltm,t,this._textField)}))}))};this.ltm.registerForDispose(e.setEvents(["focusin",i]))}setFocus(){this.options.isExpanded(!0);const e=document.activeElement;(0,c.invokeAfterChangePropagation)((()=>{e===document.activeElement&&this._textField.focus()}))}}t.Widget=h})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.TopbarActionsMenu.css",["module"],(function(e){"use strict";return{css:".fxs-topbaractions-item{display:flex}.fxs-topbaractions-item .fxs-dropmenu-image{padding-left:10px}.fxs-topbaractions-flyout{max-height:calc(100vh - 40px);overflow-x:hidden;overflow-y:auto}",moduleId:e.id}})),
define("MsPortalImpl/Widgets/Widgets.TopbarActionsMenu",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.DropMenu","_generated/MsPortalImpl/Svg/Startup/Ellipsis.svg","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.TopbarActionsMenu.css"],(function(e,t,s,i,o,n,r,a){"use strict";t.Widget=t.ViewModel=void 0,(0,r.injectCss)(a);const l=s.tsx("div",{class:"fxs-topbaractions-dropmenu"}),c=s.tsx("div",{class:"fxs-topbaractions-button fxs-topbar-button","data-bind":{image:"ellipsis",css:{"fxs-topbar-active":"isMenuOpen"}}}),d=s.tsx("div",{class:"fxs-topbaractions-flyout"},s.tsx("ul",{class:"fxs-topbaractions-list-commands",role:"presentation","data-bind":{foreach:"topbarActions"}},s.tsx("li",{class:"fxs-portal-hover",role:"presentation"},s.tsx("a",{href:"#",class:"fxs-topbaractions-item",role:"menuitem","data-bind":{attr:{"aria-label":"name",title:"name"},css:"classNames",click:"clickHandler"}},s.tsx("div",{class:"fxs-dropmenu-list-content fxs-portal-text","data-bind":{text:"name"}}),s.tsx("div",{class:"fxs-dropmenu-image fxs-portal-svg","data-bind":{image:"menuIcon"}})))));class p extends i.ViewModel{constructor(e){super(),this.ariaLabel=ko.observable(),this.dropMenuOptions=new o.ViewModel(c,d,".fxs-topbaractions-item"),this.topbarActions=e||[]}}t.ViewModel=p;class u extends i.Widget{constructor(e,t){super(e,t);const s=this.element;s.html(l),t.dropMenuOptions.setItemFocusWhenOpen=!0,t.dropMenuOptions.buttonTooltip(t.ariaLabel()),t.dropMenuOptions.buttonLabel(t.ariaLabel()),this.ltm.registerForDispose(new o.Widget(e.find(".fxs-topbaractions-dropmenu"),t.dropMenuOptions,!1,!0)),ko.applyBindingsToDescendants({topbarActions:t.topbarActions,ellipsis:n,isMenuOpen:t.dropMenuOptions.isMenuOpen},s[0])}openMenu(e=!0){this.element.hasClass("fxs-display-none")||(e||(this.options.dropMenuOptions.autoDismissMenu=!1),this.options.dropMenuOptions.open(),e||(this.options.dropMenuOptions.autoDismissMenu=!0))}closeMenu(){this.options.dropMenuOptions.close()}}t.Widget=u})),
define("_generated/MsPortalImpl/Svg/Library/Gear.svg",["require","exports"],(function(e,t){"use strict";t.type=t.data=void 0;t.type=103,t.data="<svg viewBox='0 0 15.9 15.9' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M13.9 7.7V8l2 1.3-1.2 3-2.4-.3-.3.3.5 2.4-3 1.2-1.3-2h-.5l-1.3 2-3-1.2.6-2.4-.4-.3-2.4.5-1.2-3 2-1.3v-.4L0 6.4l1.2-3 2.4.6a.8.8 0 0 1 .4-.4l-.6-2.4 3-1.2 1.3 2h.5l1.3-2 3 1.2-.5 2.4.3.4 2.4-.6 1.2 3zm-.9 1V7.2l1.8-1.1-.7-1.7-2.1.5a1.2 1.2 0 0 0-.5-.5 1.2 1.2 0 0 0-.5-.5l.5-2.1-1.7-.7-1.1 1.8H7.2L6.1 1.1l-1.7.7.5 2.1a1.2 1.2 0 0 0-.5.5 1.2 1.2 0 0 0-.5.5l-2.1-.5-.7 1.7 1.8 1.1v1.5L1.1 9.8l.7 1.7 2.1-.5.5.5.5.5-.5 2.1 1.7.7L7.2 13h1.5l1.1 1.8 1.7-.7L11 12l.5-.5.5-.5 2.1.5.7-1.7zM8 5l1.1.2a2.2 2.2 0 0 1 .9.7 3.1 3.1 0 0 1 .7.9 4.3 4.3 0 0 1 .2 1.2 4.3 4.3 0 0 1-.2 1.1 2.2 2.2 0 0 1-.7.9 2.2 2.2 0 0 1-.9.7l-1.1.2-1.2-.2a3.1 3.1 0 0 1-.9-.7 2.2 2.2 0 0 1-.7-.9A4.3 4.3 0 0 1 5 8a4.3 4.3 0 0 1 .2-1.2 3.1 3.1 0 0 1 .7-.9 3.1 3.1 0 0 1 .9-.7zm0 5h.8l.6-.5.5-.6A2.5 2.5 0 0 0 10 8a2.8 2.8 0 0 0-.1-.9l-.5-.6-.6-.4a1.3 1.3 0 0 0-.8-.2 1.5 1.5 0 0 0-.9.2l-.6.4-.4.6a1.5 1.5 0 0 0-.2.9 1.3 1.3 0 0 0 .2.8l.4.6.6.5z'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Startup/Console.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=333,t.data="<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M15 2v12H1V2h14m1-1H0v14h16V1z'/><path d='M12.5 12h-4c-.3 0-.5-.2-.5-.5s.2-.5.5-.5h4c.3 0 .5.2.5.5s-.2.5-.5.5zM7.8 8.1s0-.1 0 0v-.5L3.7 4.3c-.2-.2-.5-.2-.7 0-.2.3-.1.6.1.7l3.5 3-3.5 3c-.2.2-.2.5-.1.7.1.1.2.2.4.2.1 0 .2 0 .3-.1l3.9-3.3v-.1c.2-.2.2-.2.2-.3 0 .1 0 0 0 0z'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Startup/DirectoryFilteredSet.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=393,t.data="<svg viewBox='0 0 19.723 20' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M19.514 8.63H8.826v1.894l.061.061 3.454 4.442V20h3.867v-4.973l3.454-4.442.061-.061V8.63zm-4.637 5.755-.061.061v4.164h-1.085v-4.168l-.061-.061-3.376-4.364h7.961z'/><path d='m13.67 14.381.061.061v4.168h1.086v-4.164l.06-.061 3.378-4.369h-7.962l3.377 4.365z' class='msportalfx-svg-c33'/><path d='M3.578 0a1.766 1.766 0 0 0-.744.166A2.153 2.153 0 0 0 2.217.6a2.13 2.13 0 0 0-.433.621 1.762 1.762 0 0 0-.165.739V4H0v1.418h1.619v6.589H0v1.415h1.619v2.044a1.893 1.893 0 0 0 .154.762 1.969 1.969 0 0 0 .42.623 1.944 1.944 0 0 0 .625.421 1.91 1.91 0 0 0 .75.152h7.459v-1.415H6.485V1.416h9.13v6h1.415V0zm1.5 16.009H3.7a.645.645 0 0 1-.26-.051.686.686 0 0 1-.212-.144.711.711 0 0 1-.145-.214 1.861 1.861 0 0 1-.047-.387v-1.791h.7v-1.415h-.7V5.418h.7V4h-.7V2.084a.493.493 0 0 1 .054-.22.88.88 0 0 1 .39-.391.5.5 0 0 1 .22-.057h1.382z'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Startup/Feedback.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=1,t.data="<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M7.484 10.375a5.6 5.6 0 0 1 1.438.828 5.376 5.376 0 0 1 1.109 1.2 5.682 5.682 0 0 1 .711 1.461A5.5 5.5 0 0 1 11 15.5v.5h-1v-.5a4.385 4.385 0 0 0-.352-1.75 4.459 4.459 0 0 0-.968-1.43 4.654 4.654 0 0 0-1.43-.961A4.458 4.458 0 0 0 5.5 11a4.385 4.385 0 0 0-1.75.352 4.459 4.459 0 0 0-1.43.968 4.654 4.654 0 0 0-.961 1.43A4.458 4.458 0 0 0 1 15.5v.5H0v-.5a5.391 5.391 0 0 1 .969-3.1 5.7 5.7 0 0 1 1.109-1.187 5.614 5.614 0 0 1 1.438-.836 3.359 3.359 0 0 1-.633-.563 3.551 3.551 0 0 1-.477-.687 3.387 3.387 0 0 1-.3-.781A3.858 3.858 0 0 1 2 7.5a3.391 3.391 0 0 1 .273-1.359 3.525 3.525 0 0 1 1.86-1.86A3.5 3.5 0 0 1 5.5 4a3.391 3.391 0 0 1 1.359.273 3.525 3.525 0 0 1 1.86 1.86A3.5 3.5 0 0 1 9 7.5a3.424 3.424 0 0 1-.1.836 3.311 3.311 0 0 1-.3.781 4.035 4.035 0 0 1-.477.695 3.076 3.076 0 0 1-.639.563ZM5.5 10a2.424 2.424 0 0 0 .969-.2 2.523 2.523 0 0 0 .789-.532 2.6 2.6 0 0 0 .539-.8 2.478 2.478 0 0 0 .008-1.946 2.46 2.46 0 0 0-.539-.789 2.746 2.746 0 0 0-.8-.539A2.348 2.348 0 0 0 5.5 5a2.424 2.424 0 0 0-.969.2A2.537 2.537 0 0 0 3.2 6.531a2.505 2.505 0 0 0 0 1.938 2.631 2.631 0 0 0 .532.8 2.436 2.436 0 0 0 .8.539A2.484 2.484 0 0 0 5.5 10ZM16 0v8h-2l-3 3V8h-1V7h2v1.586L13.586 7H15V1H5v1.8a8.641 8.641 0 0 0-.5.078 2.926 2.926 0 0 0-.5.141V0Z'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Startup/Help.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=130,t.data="<svg viewBox='2 2 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M8 2a6 6 0 1 1 0 12A6 6 0 0 1 8 2Zm0 1a5 5 0 1 0 0 10A5 5 0 0 0 8 3Zm0 7.5A.75.75 0 1 1 8 12a.75.75 0 0 1 0-1.5Zm0-6a2 2 0 0 1 2 2c0 .73-.212 1.14-.754 1.708l-.264.27C8.605 8.87 8.5 9.082 8.5 9.5a.5.5 0 0 1-1 0c0-.73.212-1.14.754-1.708l.264-.27C8.895 7.13 9 6.918 9 6.5a1 1 0 0 0-2 0 .5.5 0 0 1-1 0 2 2 0 0 1 2-2Z'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Startup/HelpMin.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=1,t.data="<svg viewBox='0 0 24 24' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><circle cx='17.75' cy='6.611' r='6'/><circle cx='10' cy='18.86' r='.75'/><path d='M10 10.11a2.5 2.5 0 0 1 1.651 4.378l-.154.125-.219.163-.087.072a1.968 1.968 0 0 0-.156.148 2.216 2.216 0 0 0-.535 1.614.5.5 0 0 1-1 0 3.2 3.2 0 0 1 .805-2.298 3.107 3.107 0 0 1 .356-.323l.247-.184.118-.1A1.5 1.5 0 1 0 8.5 12.61a.5.5 0 1 1-1 0 2.5 2.5 0 0 1 2.5-2.5Z'/><path d='M17.75 13.61a7.04 7.04 0 0 1-.838-.054 7.037 7.037 0 1 1-6.074-5.89 7.023 7.023 0 0 1-.086-1.017A8.087 8.087 0 0 0 10 6.61a8.056 8.056 0 1 0 7.93 6.99c-.06.002-.12.01-.18.01Z'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Startup/Notifications.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=342,t.data="<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M14 12v1h-4a2.4 2.4 0 0 1-.2.8l-.4.6-.6.4-.8.2-.8-.2-.6-.4-.4-.6A2.4 2.4 0 0 1 6 13H2v-1h1V6a5.9 5.9 0 0 1 .2-1.3 6.1 6.1 0 0 1 .5-1.2 3.9 3.9 0 0 1 .8-1 3.9 3.9 0 0 1 1-.8l1.2-.5L8 1l1.3.2 1.2.5a3.9 3.9 0 0 1 1 .8 3.9 3.9 0 0 1 .8 1 6.1 6.1 0 0 1 .5 1.2A5.9 5.9 0 0 1 13 6v6zm-2 0V6a4.5 4.5 0 0 0-.3-1.6 2.7 2.7 0 0 0-.9-1.2 2.7 2.7 0 0 0-1.2-.9 4.4 4.4 0 0 0-3.2 0 2.7 2.7 0 0 0-1.2.9 2.7 2.7 0 0 0-.9 1.2A4.5 4.5 0 0 0 4 6v6zm-4 2h.4l.3-.2.2-.3A.7.7 0 0 0 9 13H7a.6.6 0 0 0 .1.4l.2.3.3.2z'/></g></svg>"})),
define("MsPortalImpl/Widgets/Widgets.TopBar",["require","exports","Fx/DependencyInjection","Fx/Experimentation","FxInternal/AsyncLoader","Weave","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.AvatarMenu","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Search","MsPortalImpl/Widgets/Widgets.AsyncSearch","MsPortalImpl/Widgets/Widgets.TopbarActionsMenu","_generated/MsPortalImpl/Svg/Library/Gear.svg","_generated/MsPortalImpl/Svg/Startup/Console.svg","_generated/MsPortalImpl/Svg/Startup/DirectoryFilter.svg","_generated/MsPortalImpl/Svg/Startup/DirectoryFilteredSet.svg","_generated/MsPortalImpl/Svg/Startup/Feedback.svg","_generated/MsPortalImpl/Svg/Startup/Help.svg","_generated/MsPortalImpl/Svg/Startup/HelpMin.svg","_generated/MsPortalImpl/Svg/Startup/Notifications.svg","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Base/Base.Events","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/Services/Services.Subscriptions","FxInternal/Weave","MsPortalImpl/Widgets/Widgets.Portal.State","MsPortalImpl/Widgets/Widgets.ToastViewModel","Viva.Controls/Util/Viva.Resize","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Copilot"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x,b,y,v,w,M,C,S,I,P,_,F,T,k,E){"use strict";t.Widget=t.ViewModel=t.HelpAction=void 0,t.displayCopilotBubble=K,t.shouldNotShowBubble=function(e){const t="complete"===e.action,s="dismiss"===e.action&&"dismissButton"===e.source,i="dismiss"===e.action&&"refresh"===e.source;return t||s||i||e.viewCount>3},(0,F.injectCss)(T);const D=window.fx.environment,A="fxs-topbar-avatarmenu",B="fxs-avatarmenu-imageonly",N="fxs-display-none",R=MsPortalFx.isFeatureEnabled,L=r.TopBar,z=R("azureconsole"),H=R("feedback"),O=R("asyncSearch")||D.globalSearch?.pills?.length;let U=t.ViewModel=class extends l.ViewModel{constructor(e,t,s){super(),this.toastViewModel=e,this.reportBug=$.noop,this.exitDevMode=$.noop,this.directoryFilterIcon=ko.observable(g),this.newDashboardSaveEnabled=(0,n.makeWritableComputation)(!1),this.copilotEnabled=ko.observable(!1),this.isCopilotOpen=ko.observable(!1),this.commandIconsVisible=ko.observable(!1),this.dashboardChanged=(0,n.makeWritableComputation)(!1),this.dashboardWritable=(0,n.makeWritableComputation)(!1),this.dashboardVisible=(0,n.makeWritableComputation)(!1),this.exitOrganizeMode=$.noop,this.finishDashboardEdit=$.noop,this.settingsButtonClick=$.noop,this.loadingIdList=(0,n.makeArrayComputation)(),this.searchViewModel=O?new d.ViewModel:new c.ViewModel,this.avatarMenuVM=new a.ViewModel,this.consoleButtonClick=MsPortalFx.noop,this.canUpgradeSubscription=(0,n.makeWritableComputation)(!1),this.upgradeableSubscription=(0,n.makeWritableComputation)(),this.displayMode=s.displayMode,this.isInOrganizeMode=s.inOrganizeMode,this.settingsFlyoutState=s.settingsFlyoutState,this.actionDefinitions=function(e,t){const s=[],i=MsPortalFx.getEnvironmentValue("topBar")?.customTopBarButtons;if(i?.length>0){let e=0;i.slice(0,3).forEach((i=>{if(!i.flagName||i.flagName&&MsPortalFx.isFeatureEnabled(i.flagName)){const o="fxs-topbar-custom-button-"+e;s.push({name:G(i.textAriaResxKey),icon:j(i.iconName),classNames:["fxs-topbar-custom-button",o],clickHandler:()=>{t.settingsFlyoutState(0),t.customTopBarButtonClick&&t.customTopBarButtonClick(i.bladeTarget,i.extensionName,o)}}),e++}}))}z&&s.push({name:L.console,icon:m,classNames:"fxs-topbar-console",ariaExpanded:!1,ariaControls:"consoleRegionId",clickHandler:()=>{t.settingsFlyoutState(0),t.consoleButtonClick()}});D.notifications?.hideNotificationButton||s.push({name:L.notifications,icon:y,classNames:"fxs-topbar-notifications",clickHandler:()=>{t.settingsFlyoutState(0),t.notificationButtonClick&&t.notificationButtonClick()},showNotification:ko.observable(!1)});s.push({name:L.settings,icon:u,classNames:["fxs-topbar-settings fxs-menu-settings",{"fxs-topbar-active":t.settingsFlyoutState}],clickHandler:()=>{t.settingsButtonClick&&t.settingsButtonClick()}}),D.chrome.hideHelpButton||s.push(e.get(V));H&&s.push({name:L.feedback,icon:f,classNames:"fxs-topbar-feedback fxs-menu-feedback",clickHandler:()=>{t.settingsFlyoutState(0),t.feedbackButtonClick&&t.feedbackButtonClick()}});return s.forEach((e=>{e.menuIcon=e.menuIcon||e.icon})),s}(t,this)}dispose(){this.searchViewModel.dispose()}setWidget(e){this._widget=e}getWidget(){return this._widget}getRootElement(){return this._widget&&this._widget.element}};t.ViewModel=U=__decorate([__metadata("fx:diagnostics",[e,"ViewModel"]),s.Class(),__metadata("design:paramtypes",[P.ViewModel,s.Container,I.PortalState])],U);class W extends l.Widget{constructor(e,t,s,o){super(e,t,!0),this._reactiveLayoutInitialized=!1;const l=this.ltm;if(t.setWidget(this),this.options.copilotEnabled((0,E.isCopilotEnabled)(s)),ko.computed(l,(async()=>{const e=this.options.copilotEnabled(),i=this.options.commandIconsVisible();e&&i&&K(s,t),e&&s.getAsync(E.CopilotShellAPIs).then((e=>{e.copilotBladeState.subscribe(l,(e=>{this.options.isCopilotOpen("opened"===e)}))}))})),this.toggleConsole=MsPortalFx.noop,z&&(t.consoleButtonClick=this.toggleConsole=()=>{s.get(M.ToggleCloudShell).invoke(void 0)}),!R("hidedirectorypanebutton")&&!D.chrome.hideDirectoryPaneButton){const e=s.get(C.SubscriptionsUserContext);Promise.all([e.getAllSubscriptionsCount(),e.getGlobalSelectedSubscriptions(),e.useAdvancedFiltersPromise]).then((([e,s,i])=>{if(i)return t.directoryFilterIcon(g);s.subscribeAndRun(l,(s=>{t.directoryFilterIcon(s.length===e.value?g:h)}))}))}s.get(i.Experimentation).shellAssignments.whenAvailable().then((e=>{t.newDashboardSaveEnabled(e.getBooleanValue("DashboardSaveExperience"))})),this._topbarActionsViewModel=new p.ViewModel(t.actionDefinitions),this._topbarActionsViewModel.ariaLabel(r.TopBar.actionsMenuButtonLabel);const u=new a.Widget(this._findByClassName(A),t.avatarMenuVM,s);let m;if(m=O?new d.Widget(this._findByClassName("fxs-topbar-search"),t.searchViewModel,s):new c.Widget(this._findByClassName("fxs-topbar-search"),t.searchViewModel,s),MsPortalFx.isFeatureEnabled("globalsearchonecolumn")){$.querySelectorAll(".fxs-topbar-search").addClass("fxs-search-onecolumn")}l.registerForDispose([u,m]),this.topBarHasExpandedItem=(0,n.composeComputation)([(0,S.toComputation)(t.searchViewModel.showMenu),(0,S.toComputation)(this._topbarActionsViewModel.dropMenuOptions.isMenuOpen),(0,S.toComputation)(u.getDropMenuOpenObservable()),this.options.settingsFlyoutState],((e,t,s,i)=>e||t||s||!!i))}_findByClassName(e){return $(this.element[0].querySelector("."+e))}initReactiveLayout(e){if(this._reactiveLayoutInitialized)return;this._reactiveLayoutInitialized=!0;let t,s,i,o,n,r,a,l,c,d,u,m,g=!0;const h=this._findByClassName("fxs-topbar-search"),f=this._findByClassName("fxs-topbar-buttons-container"),x=this._findByClassName(A),b=this._findByClassName("fxs-internal-full"),y=this._findByClassName("fxs-topbar-exitdevmode"),M=this._findByClassName("fxs-topbar-reportbug"),C=this._findByClassName("fxs-topbar-reportbug-text"),S=this._findByClassName("fxs-internal-short"),I=this._findByClassName("fxs-topbar-sidebar-collapse-button"),P=this._findByClassName("fxs-topbar-copilot"),F=this.options.copilotEnabled()&&e.getBooleanValue("copilotnexttosearch");let T=800,k=280,E=400,D=0;F&&(MsPortalFx.isFeatureEnabled("globalsearchonecolumn")&&(T=520,k=364,E=520),D=16);const R=v.throttleByAnimationFrame((()=>{const e=this._findByClassName("fxs-topbar-upgradebutton"),v=this._findByClassName("fxs-topbar-upgradebutton-text");let w;g&&(i=q(this.element,"fxs-avatarmenu-tenant-image-container"),s=q(f),o=q(this.element,"fxs-topbar-brand"),n=q(b),r=q(S),a=q(y),l=q(M),c=q(this.element,"fxs-topbar-reportbug-icon"),d=q(e),u=q(this.element,"fxs-topbar-upgradebutton-icon"),m=q(this.element,"fxs-topbar-copilot")+D),t?w=t:x.hasClass(B)?w=180+i:(w=x.width(),this._findByClassName("fxs-avatarmenu-tenant").text()&&this._findByClassName("fxs-avatarmenu-username").text()&&(t=w));const _=function(e,t){const{topbarWidth:s,commandIconsWidth:i,copilotIconAndTextWidth:o,searchBarMaxInWideScreen:n,searchBarWidth:{min:r,max:a,collapsed:l,margin:c},avatarMenuWidth:{normal:d,imageOnly:p},others:{debugModeWidth:u,reportBugExpendedWidth:m,reportBugIconWidth:g,previewWidth:h,previewShortWidth:f,sidebarHamburgerWidth:x,upgradeIconWidth:b,upgradeExpandedWidth:y},firstTime:v}=t;let w=0;const M=m>0?m+7:0,C=g>0?33:0,S=y>0?y+7:0,I=b>0?33:0,P=x+t.logoWidth+t.others.previewWidth+u+M+S+7,_=c+i+d+o,F=c+40+p,T=P+n+_,k=T-M-S+C+I-n+r,E=k-_+F,D=E-r-c+40,A=D-h+f,B=A-C,N=B-I,R=s>=k?n:a;if(s>=E){let e=P,t=_;s<T&&(e=e-M+C-y+S),s<k&&(t=F);const i=(s-R)/2,o=i+R;w=i<e?Math.max(0,s-e-t-R,s-T):Math.max(0,s-o-t)}const L=s>=k;v&&e.commandIconsVisible(L);return{searchBar:{expanded:s>=E,width:s>=E?Math.min(R,Math.max(r,s-E+r)):l,rightToCommands:w+c},commandIconsVisible:L,avatarMenuExpanded:s>=k,others:{reportABugVisible:s>=A,debugModeVisible:s>=B,previewExpanded:s>=D,reportBugExpanded:s>=T,upgradeVisible:s>=N,upgradeExpanded:s>=T}}}(this.options,{topbarWidth:this.element.width(),logoWidth:o,searchBarMaxInWideScreen:T,searchBarWidth:{min:k,max:E,collapsed:40,margin:15},commandIconsWidth:s,copilotIconAndTextWidth:m,avatarMenuWidth:{normal:w,imageOnly:i},others:{previewWidth:n,previewShortWidth:r,debugModeWidth:a,reportBugExpendedWidth:l,reportBugIconWidth:c,upgradeExpandedWidth:d,upgradeIconWidth:u,sidebarHamburgerWidth:q(I)},firstTime:g});g=!1,this.element.toggleClass("fxs-topbar-state-searchcollapsed",!_.searchBar.expanded);const A=_.searchBar.expanded?_.searchBar.rightToCommands:"";F?(P.css("margin-right",A),P.css("margin-left",16)):h.css("margin-right",A),h.css("max-width",_.commandIconsVisible?T:400),x.toggleClass(B,!_.avatarMenuExpanded),f.toggleClass(N,!_.commandIconsVisible),M.toggleClass(N,!_.others.reportABugVisible),y.toggleClass(N,!_.others.debugModeVisible),b.toggleClass(N,!_.others.previewExpanded),S.toggleClass(N,_.others.previewExpanded),C.toggleClass(N,!_.others.reportBugExpanded),e.toggleClass(N,!_.others.upgradeVisible),v.toggleClass(N,!_.others.upgradeExpanded),_.commandIconsVisible||this.options.dropMenuWidget||(this.options.dropMenuWidget=new p.Widget(this._findByClassName("fxs-topbar-actionsmenu"),this._topbarActionsViewModel),this.ltm.registerForDispose(this.options.dropMenuWidget));this._findByClassName("fxs-topbaractions-dropmenu").toggleClass(N,_.commandIconsVisible),this.options.dropMenuWidget?.closeMenu()}));_.track(this.ltm,this.element.first(),R),this.ltm.registerForDispose([this.element.setEvents(["fxavatartextchange",R]),$(document).setEvents([w.fullscreen,R])])}dispose(){this._cleanElement(),super.dispose()}}t.Widget=W;let V=t.HelpAction=class extends FxImpl.TriggerableLifetimeManager{constructor(e,t){super(),this.name=L.help,this.icon=x,this.menuIcon=ko.observable(x),this.classNames="fxs-topbar-helpmenu",this.showNotification=ko.observable(!1),this.active=ko.observable(!1),this.visible=ko.observable(!0),this.clickHandler=()=>{t.settingsFlyoutState(0),e.getAsync(o.get("MsPortalImpl/UI/UI.HelpPane","HelpPane")).then((e=>e.toggle()))},this.showNotification.subscribe(this,(e=>{this.menuIcon(e?b:x)}))}};function q(e,t){const s=(t?e.find(`.${t}`):e)[0];return s?s.offsetWidth:0}function j(e){const t=MsPortalFx.Base.Images[e];return t&&"function"==typeof t?t():MsPortalFx.Base.Images.Question()}function G(e){const t=e?.split("_");if(3===t?.length){const e=t[1],s=t[2],i=r.TopBar[e];if(i){return i[s]??r.TopBar.CustomButton.default}}return r.TopBar.CustomButton.default}async function K(e,t){if(MsPortalFx.isFeatureEnabled("ci")||!MsPortalFx.isFeatureEnabled("copilotbubble"))return;const s=e.get(k.SettingsManager),i=await s.querySettings({store:7,keys:["WelcomeSequence","CopilotBubble","WelcomeSequenceCopilotStep"]}),o=i.CopilotBubble||{},n="complete"===o.action,a="dismiss"===o.action&&"dismissButton"===o.source,l="dismiss"===o.action&&"refresh"===o.source;if(n||a||l||o.viewCount>3)return;const c=e.get(FxImpl.Features),d=c.isEnabled("guidedtour")&&(!i||!i.WelcomeSequence)&&!c.isEnabled("ci"),p=i.WelcomeSequenceCopilotStep;if(!d&&!p){const i=await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.TeachingBubble"),n=$.querySelectorAll(".fxs-topbar-copilot")[0];i.createTeachingBubble({teachingBubbleOptions:[{targetElement:n,directionalHint:"up",title:r.TopBar.Copilot.TeachingBubble.title,description:r.TopBar.Copilot.TeachingBubble.message,actionButtonText:r.TopBar.Copilot.TeachingBubble.tryItOut,learnMoreLink:"https://aka.ms/azurecopilot/learnmore",width:360,showDismissButton:!0,showFeedbackButton:!1}],onCompletion:()=>{s.setSetting(7,"CopilotBubble",{viewed:+Date.now(),action:"complete",source:"",viewCount:(o.viewCount||0)+1}),t.settingsFlyoutState(0),e.get(E.CopilotService).nudge({source:"teachingbubble"})},onDismiss:e=>{s.setSetting(7,"CopilotBubble",{viewed:+Date.now(),action:"dismiss",source:e,viewCount:(o.viewCount||0)+1})},isCoachmark:!0,diContainer:e,featureName:"CopilotTopBarTeachingBubble"})}}t.HelpAction=V=__decorate([__metadata("fx:diagnostics",[e,"HelpAction"]),s.Class(),__metadata("design:paramtypes",[s.Container,I.PortalState])],V)})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Portal.css",["module"],(function(e){"use strict";return{css:'.fxs-portal{position:fixed;left:0;right:0;top:0;bottom:0;overflow:hidden;z-index:0;display:flex;flex-direction:column;font-size:13px;line-height:normal}.fxs-portal-main{display:flex;flex-flow:row nowrap;align-items:stretch;position:relative;flex:1 1 auto;min-height:0;height:100%}.fxs-portal-region{display:flex;overflow:hidden;min-height:0;height:100%;min-width:0;width:100%}.fxs-portal-main-region{display:flex;flex-direction:column;width:100%;height:100%;min-height:0;min-width:0;position:relative}.fxs-portal-content{flex:1 1 auto;position:relative;overflow:hidden;z-index:1}.fxs-portal-controlloadfailed>svg{vertical-align:bottom;height:18px}.fxs-portal-tip-content{max-width:400px}.fxs-portal-tip.azc-balloon .azc-balloon-content{padding:0}.fxs-portal-shield{position:fixed;width:100%;height:100%;background-color:rgba(0,0,0,.7);z-index:9;display:table}.fxs-portal-shield-middle{display:table-cell;vertical-align:middle}.fxs-portal-shield-icon{position:absolute;height:40px;width:40px;top:-20px;display:flex;justify-content:center;align-items:center}.fxs-portal-shield-icon>svg{width:20px;height:20px}.fxs-portal-shield-icon-warning{background-color:#ffdfb8}.fxs-portal-shield-icon-error{background-color:#fdd8db}.fxs-portal-shield-modaldialog{width:430px;max-width:100vw;margin:auto;padding:20px;position:relative}.fxs-panorama{position:relative}.fxs-panorama .fxs-startboard-target,.fxs-panorama .fxs-home-target,.fxs-panorama .fxs-journey-target,.fxs-panorama .fxs-sidebar-flyout{display:none;position:absolute;top:0;left:0;height:100%;width:100%;z-index:0}.fxs-panorama .fxs-settings-flyout{position:absolute;top:0;left:0;height:100%;width:100%;z-index:202}.fxs-panorama>div[data-popup="true"].azc-control{z-index:150}.fxs-home-target{overflow-y:auto}.fxs-show-startboard .fxs-startboard-target,.fxs-panorama .fxs-journey-target{display:flex}.fxs-journey-target{pointer-events:none}.fxs-show-journey .fxs-journey-target,.fxs-journey-target .fxs-part-frame{pointer-events:all}.fxs-show-home .fxs-home-target,.fxs-show-allservices .fxs-sidebar-flyout,.fxs-show-settings .fxs-settings-flyout{display:block}.fxs-input{padding:0;margin:0;box-sizing:border-box;border-width:1px;border-style:solid;outline:0;height:24px;text-indent:10px}.fxs-button.fxt-button:focus,.azc-button.fxt-button:focus{outline:0}.fxt-button{min-width:80px;border-radius:2px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.fxs-button{position:relative;box-sizing:border-box;height:24px;font-size:13px;line-height:20px;font-weight:600;cursor:pointer;border-width:1px;border-style:solid;padding:0 20px;margin:0}.fxs-button.fxs-button-disabled{cursor:default}.fxs-inner-solid-border{position:relative}.fxs-inner-solid-border:focus::after{content:"";position:absolute;top:1px;left:1px;right:1px;bottom:1px;display:block;border-width:1px;border-style:solid;pointer-events:none}.fxs-inner-solid-border:focus::after.fxs-button-default{border-color:#605e5c}.fxs-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-full-height{height:100%}.fxs-full-width{width:100%}@keyframes fxs-progress-animatedEllipses{0%{transform:scale(1);opacity:.3}36.1%{transform:scale(1.06);opacity:1}50%{transform:scale(1.06);opacity:1}86.1%{transform:scale(1);opacity:.3}}@keyframes fxs-progress-animatedEllipsesShadow{0%{transform:scale(1);opacity:0}36.1%{transform:scale(1.06);opacity:.4}50%{transform:scale(1.06);opacity:.4}86.1%{transform:scale(1);opacity:0}}fxs-progress,.fxs-progress{position:absolute;width:100%;height:100%;top:0;z-index:194}.fxs-progress-nozindex{z-index:initial}.fxs-progress-dots{position:absolute;top:calc(50% - 10px/2);width:100%;line-height:0;justify-content:center;display:grid}.fxs-progress-dots-dot,.fxs-progress-dots-dot-shadow{height:10px;width:10px;margin:0 5px;border-radius:5px;grid-row-start:1}.fxs-progress-dots-dot:nth-child(1),.fxs-progress-dots-dot-shadow:nth-child(1),.fxs-progress-dots-dot:nth-child(4),.fxs-progress-dots-dot-shadow:nth-child(4){grid-column-start:1;animation-delay:0s}.fxs-progress-dots-dot:nth-child(2),.fxs-progress-dots-dot-shadow:nth-child(2),.fxs-progress-dots-dot:nth-child(5),.fxs-progress-dots-dot-shadow:nth-child(5){grid-column-start:2;animation-delay:.125s}.fxs-progress-dots-dot:nth-child(3),.fxs-progress-dots-dot-shadow:nth-child(3),.fxs-progress-dots-dot:nth-child(6),.fxs-progress-dots-dot-shadow:nth-child(6){grid-column-start:3;animation-delay:.25s}.fxs-progress-dots-dot{animation:fxs-progress-animatedEllipses 1.8s infinite;background-color:#3471ff;opacity:.3}.fxs-progress-dots-dot-shadow{animation:fxs-progress-animatedEllipsesShadow 1.8s infinite;background-color:transparent;opacity:0;box-shadow:0 3px 3px 0 #0078d4}.fxs-progress-small .fxs-progress-dots,.fxs-bladecontent-unlocked .fxs-tile .fxs-progress-dots,.fxs-startboard-layout .fxs-tile .fxs-progress-dots{top:calc(50% - 6px/2)}.fxs-progress-small .fxs-progress-dots-dot,.fxs-bladecontent-unlocked .fxs-tile .fxs-progress-dots-dot,.fxs-startboard-layout .fxs-tile .fxs-progress-dots-dot,.fxs-progress-small .fxs-progress-dots-dot-shadow,.fxs-bladecontent-unlocked .fxs-tile .fxs-progress-dots-dot-shadow,.fxs-startboard-layout .fxs-tile .fxs-progress-dots-dot-shadow{height:6px;width:6px;margin:0 3px;border-radius:3px}.fxs-progress-small .fxs-progress-dots-dot-shadow,.fxs-bladecontent-unlocked .fxs-tile .fxs-progress-dots-dot-shadow,.fxs-startboard-layout .fxs-tile .fxs-progress-dots-dot-shadow{box-shadow:0 2px 2px 0 #0078d4}.azc-fabric .azc-formControl{border-radius:2px!important}.azc-fabric .azc-textBox-wrapper .azc-input,.azc-fabric .azc-password-wrapper .azc-input,.azc-fabric .azc-numericTextBox-wrapper .azc-input{border-radius:2px}',moduleId:e.id}})),
define("MsPortalImpl/Widgets/Widgets.Portal",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Interactions/Interactions.ContextMenuTouch","MsPortalImpl/Interactions/Interactions.FullScreenMode","MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.ContextPane","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Widgets/Widgets.Portal.State","MsPortalImpl/Widgets/Widgets.SideBar","MsPortalImpl/Widgets/Widgets.TopBar","MsPortalImpl/Base/Base.Events","MsPortalImpl/ReactViews/ReactFrame.FramePool","MsPortalImpl/Widgets/Widgets.Portal.html","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Weave/DirectRender","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.Portal.css","Weave","Fx/Experimentation","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Services/Services.HomeViewSettings","MsPortalImpl/Widgets/Widgets.AzureHome","MsPortalImpl/Widgets/AzHome/FreeTrial/FreeTrialConstants","MsPortalImpl/Services/Services.Settings"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x,b,y,v,w,M,C,S,I,P,_,F){"use strict";t.Widget=t.ViewModel=void 0,(0,v.injectCss)(w);const T=window,k=T.fx.environment,E=T.fx.getTimestamp,D=MsPortalFx.Base.Diagnostics,A=D.Telemetry,B=D.createLog(e),N="HomeScriptLoadStart",R="HomeScriptLoadEnd",L="AzureHomeLoad",z={start:`${L}Start`,end:`${L}End`};let H=t.ViewModel=class extends p.ViewModel{constructor(e,t,s,i,o){super("fxsportalroot"),this.sideBar=e,this.topBar=t,this.customEvents=s,this._diContainer=i,this._widgetCreatePromise=Q.defer(),this.rightContextPane=new c.ViewModel(this._diContainer),this.shellContextPane=new c.ViewModel(this._diContainer),this.dockedContextPane=new c.ViewModel(this._diContainer),this.contextMenuViewModel=new b.ViewModel,this.startboardLoading=(0,M.makeWritableComputation)(!1),this.startboardNotFound=(0,M.makeWritableComputation)(!1),this.allServicesMenuInput={filter:(0,M.makeWritableComputation)(),category:""},this.displayMode=o.displayMode,this.inOrganizeMode=o.inOrganizeMode,this.settingsFlyoutState=o.settingsFlyoutState}getDisplayMode(){return this.displayMode.value}setRootPageDisplayType(e){this._rootPageDisplayType=e}getRootPageDisplayType(){let e=this._rootPageDisplayType;return"Home"!==e&&"Dashboard"!==e&&"AllServices"!==e&&(e=(0,a.isLandingPageDashboard)(this._diContainer)?"Dashboard":"Home"),e}showStartboard(){if("Dashboard"===this.displayMode.value)return;this.displayMode("Dashboard");const e=this.getStartBoardWidget();e&&e.setFocus()}getStartBoardArea(){return $(this._widget.element[0].querySelector(".fxs-startboard-target"))}getJourneyArea(){return $(this._widget.element[0].querySelector(".fxs-journey-target"))}getStartBoardWidget(){return l.Widget.getWidget(this.getStartBoardArea(),d.Widget)}getJourneyWidget(){const e=l.Widget.getWidgets(this.getJourneyArea());if(e.length>1)throw new Error("The journey target has been initialized with more than one widget.");return e[0]}async loadAzureHome(e){return this.getWidget().loadAzureHome(e)}setWidget(e){this._widget=e,this.customEvents.setElement(e.element),this._widgetCreatePromise.resolve(!0)}getWidget(){return this._widget}getRootElement(){return this._widget&&this._widget.element}onWidgetCreate(){return this._widgetCreatePromise.promise}};t.ViewModel=H=__decorate([__metadata("fx:diagnostics",[e,"ViewModel"]),s.Class(),__metadata("design:paramtypes",[m.ViewModel,g.ViewModel,h.PortalCustomEvents,s.Container,u.PortalState])],H);class O extends p.Widget{static create(e,t,s){return new O(e.portal,t,s)}constructor(e,t,s){super(e,t,!0),this._diContainer=s,t.setWidget(this),t.setRootPageDisplayType(t.displayMode.value);const i=t.displayMode;e.addClass("fxs-portal fxs-desktop-normal"),t.inOrganizeMode.subscribe(this.ltm,(t=>{e.toggleClass("fxs-desktop-organize",t),e.toggleClass("fxs-desktop-normal",!t)})),(0,x.renderPortal)(e[0],t,s,this.ltm);const l=s.get(a.GeneralSettings),d=s.get(I.HomeViewSettings),p=this.ltm,u=t.sideBar;ko.computed(p,(()=>{const t=!(0,a.isSideBarDocked)(s);e.toggleClass("fxs-sidebar-hamburger-mode",t).toggleClass("fxs-sidebar-docked-mode",!t),t&&u.setCollapsed(!0)}),[l.sideBarLayout,d.showAzHome,d.homeview]);const h=this._findByClassName("fxs-sidebar");h.toggleClass("fxs-display-none",!!k.chrome.hideSidebarNav),new m.Widget(this.ltm,h,u,s);const b=t.topBar,y=this._findByClassName("fxs-topbar"),v=new g.Widget(y,b,s,this._findByClassName("fxs-portal-console")),w=FxImpl.features.getValue("extensionsidebar");if(w){const[,e,t]=w.split("/");s.get(S.ViewModelManager).tryEarlyGetViewModel(e,t,{},{inSideBar:!0,isPrefetch:!0})}s.get(f.ReactFramePool).setFrameRoot(this.element[0].querySelector(".fxs-journey-layout"));const C=new c.Widget(this._findByClassName("fxs-portal-contextpane-right"),t.rightContextPane),P=new c.Widget(this._findByClassName("fxs-portal-contextpane-shell"),t.shellContextPane),_=new c.Widget(this._findByClassName("fxs-portal-contextpane-docked"),t.dockedContextPane);o.register(e),r.register(e),(0,M.subscribe)(p,[i],(e=>{"Journey"!==e&&(t.setRootPageDisplayType(e),s.get(n.FullScreenMode).exit()),this.element.toggleClass("fxs-show-journey","Journey"===e),this.element.toggleClass("fxs-show-startboard","Dashboard"===e),this.element.toggleClass("fxs-show-home","Home"===e),this.element.toggleClass("fxs-show-allservices","AllServices"===e),b.dashboardVisible("Dashboard"===e)})),(0,M.subscribe)(p,[this.options.dockedContextPane.opened],(e=>{C.element.toggleClass("fxs-portal-contextpane-docked-opened",e)})),this.ltm.registerForDispose([v,C,P,_,()=>{o.unregister(e),r.unregister(e)},this.element.setEvents(["fxloadingontopbar",(e,t)=>{t.cancel?b.loadingIdList.removeIf((e=>e===t.id)):b.loadingIdList.push(t.id);const s=this.options.getJourneyWidget();s&&s.loadingHint(t.id,!t.cancel)}],["fxtoggleconsole",()=>{v.toggleConsole()}],["fxtogglesidebar",(e,t)=>{const s=t?.collapse??!u.isCollapsed.value;2===u.layoutMode.value&&t?.updateSettings&&l.sideBarCollapsedKey(s),u.setCollapsed(s)}])])}async loadAzureHome(e){const t=this._diContainer.get(I.HomeViewSettings),s=async(e,t=!1)=>{if("frehome"===e.homeview()&&"landingPage"===e.freHomePage()){await(0,P.getResourcesCount)("frehome")>0&&(e.freHomePage("returningPage"),t&&U(_.TelemetryActionConstants.ReturningPage))}};if(this._azureHomeLoaded){if(await s(t,!0),"frehome"===t.homeview()){(await MsPortalFx.require("MsPortalImpl/Widgets/AzHome/FreeTrial/Cost.Store")).useCostStore.setState({lastUpdatedCurrentTimestamp:Date.now()})}}else try{const i=FxImpl.features.isNativePerf&&T.performance,o=E();i&&(i.mark(z.start),i.mark(N));const[n,r,a,l,c,d]=await Promise.all([MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AzureHome"),MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AzureHome.Component"),MsPortalFx.require("MsPortalImpl/Widgets/AzureHome/PerfIndicator"),this._diContainer.get(C.Experimentation).shellAssignments.whenAvailable(),MsPortalFx.require("MsPortalImpl/Widgets/AzureHome/AzureHome.Store"),MsPortalFx.require("MsPortalImpl/Widgets/AzHome/FreeTrial/Cost.Store")]),p=l.getBooleanValue("azHome")||"startup"===t.userTypeHint(),u="frehome"===t.homeview();let m,g,h;u?h=await MsPortalFx.require("MsPortalImpl/Widgets/AzHome/FreeTrial/FreeTrialHomeRenderer.React"):p?m=await MsPortalFx.require("MsPortalImpl/Widgets/AzHome/AzHomeToggling.React"):g=await MsPortalFx.require("MsPortalImpl/Widgets/AzureHome/AzureHomeRenderer"),i&&(i.mark(R),i.measure("HomeScriptLoad",N,R));const f=E(),x=this._findByClassName("fxs-home-target"),b=new n.ViewModel(this.options.sideBar.launchBlade,this._diContainer),v=E();if((0,y.applyToElement)({element:x[0],ltm:this.ltm,weaveNode:r.AzureHomeInner({vm:b}),weaveContext:{diContainer:this._diContainer},opName:"AzureHome"}),u){if(!d.useCostStore.getState().freeTrialSubscriptionInfo){let e=!1;const i=await(0,P.getFreeTrialSubscriptionInfo)(this._diContainer);3===i.subscriptionState?(t.userTypeHint("freeTrialToPayG"),e=!0):2===i.subscriptionState&&t.userTypeHint("freeTrialInactive"),await s(t),c.useAzureHomeStore.setState({azHomeView:"frehome"}),d.useCostStore.setState({freeTrialSubscriptionInfo:i,freeTrialUpgraded:e})}t.freHomePage.subscribeAndRun(this.ltm,(e=>{let t=1;"returningPage"===e&&(t=100),c.useAzureHomeStore.setState({daysExperience:t})})),t.freHomeCredits.subscribeAndRun(this.ltm,(e=>{let t=!0,s=!1,i=!1,o=!1,n=!1,r=!1;const a=d.useCostStore.getState().freeTrialSubscriptionInfo;if(e)if(e.expirationDate){const s=new Date(e.expirationDate).getTime(),l=(new Date).getTime()>s;i=!l,3===a.subscriptionState&&(i=t=!(l||0===e.amount.value),r=!0),(2===a.subscriptionState||3!==a.subscriptionState&&l)&&(o=!0,l||0!==e.amount.value||(n=!0,o=!1))}else 3===a.subscriptionState?(t=!1,r=!0):2===a.subscriptionState?(o=!0,i=!0):(s=!0,i=!0,t=!0);else 3===a.subscriptionState?(t=!1,r=!0):2===a.subscriptionState?(o=!0,i=!0):1===a.subscriptionState?i=!0:(t=!1,i=!1);d.useCostStore.setState({showDefaultCredits:s,showCredits:i,showCosts:!s,showCreditBadge:t,showFTExpiredUpgrade:o,showOutOfCreditsUpgrade:n,freeTrialUpgraded:r,freeTrialCredits:e})}));const e=this._diContainer.get(F.SettingsManager),i=await e.querySetting(0,_.WelcomeDialogConstants.FreeTrialHomeShowWelcomeDialog),o=MsPortalFx.isNullOrUndefined(i);c.useAzureHomeStore.setState({shouldShowWelcomeDialog:o}),U(c.useAzureHomeStore.getState().daysExperience>1?_.TelemetryActionConstants.ReturningPage:_.TelemetryActionConstants.LandingPage),h.renderFreeTrialHome(this._diContainer,this.ltm)}else p?m.renderHomeWithToggle({diContainer:this._diContainer,lifetime:this.ltm}):g.renderAzureHome(this._diContainer);const w=E();a.getFirstLoadPerfIndicators(this._diContainer).then((t=>{i&&(i.mark(z.end),i.measure(L,z.start,z.end));const s=t.assetsLoadDuration,n=t.recentsLoadDuration,r=t.favoritesLoadDuration;A.trace({source:"Shell",action:"AzureHomeLoad",data:{assets:s,recents:n,favorites:r,render:w-v,scripts:f-o,fullyReady:Math.max(s,n),endAzureHomeRender:w}}),e&&A.trace({source:"Shell",action:"TotalTimeToInitialRoute",name:"Home",duration:E(),data:{startScriptLoadTime:o,scriptsLoadedTime:f,assetsLoadedTime:t.assetsLoadedTs,recentsLoadedTime:t.recentsLoadedTs,favoritesLoadedTime:t.favoritesLoadedTs}})})),this._azureHomeLoaded=!0}catch(e){return B.error("failed to load and initialize azure-home",null,MsPortalFx.getLogFriendlyMessage(e)),this._azureHomeLoaded=!1,this._azureHomeLoaded}return this._azureHomeLoaded}_findByClassName(e){return $(this.element[0].querySelector("."+e))}}function U(e){A.trace({source:_.TelemetrySourceConstants.FREHome,action:e})}t.Widget=O,__decorate([__metadata("fx:diagnostics",[e,"Widget"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.RootElements,H,s.Container]),__metadata("design:returntype",O)],O,"create",null)})),
define("MsPortalImpl/Widgets/Widgets.Portal.init",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Widgets/Widgets.Portal"],(function(e,t,s,i){"use strict";t.getPortalViewModel=function(e){return e.get(i.ViewModel)},ko.components.register("fxs-progress",{template:s.tsx("div",{class:"fxs-progress-dots"},s.tsx("div",{class:"fxs-progress-dots-dot"}),s.tsx("div",{class:"fxs-progress-dots-dot"}),s.tsx("div",{class:"fxs-progress-dots-dot"}),s.tsx("div",{class:"fxs-progress-dots-dot-shadow"}),s.tsx("div",{class:"fxs-progress-dots-dot-shadow"}),s.tsx("div",{class:"fxs-progress-dots-dot-shadow"}))})})),
define("MsPortalImpl/ReactServices/ViewHostService",["require","exports","MsPortalImpl/Interactions/Interactions.FullScreenMode","MsPortalImpl/Widgets/Widgets.SideBar","MsPortalImpl/Widgets/Widgets.Portal.init","FxInternal/AsyncLoader","Fx/DependencyInjection","FxInternal/Weave","MsPortalImpl/ReactServices/ReactServiceContext","MsPortalImpl/ReactServices/ReactServiceBase","MsPortalImpl/AzFramework/AzExtensionCore","MsPortalImpl/ReactServices/NavigationService","MsPortalImpl/Services/Services.GeneralSettings"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u){"use strict";t.ReactViewHostService=void 0;let m=t.ReactViewHostService=class extends c.ReactServiceBase{constructor(e,t){super("viewHost",e),this.diContainer=t;e.data.diContainer.get(s.FullScreenMode).isActive.subscribe(e.data.lifetime,(e=>{this.fireEvent("fullScreenModeChanged",{active:e})}));const{layoutMode:n}=e.data.diContainer.get(i.ViewModel),{sideBarLayout:r}=e.data.diContainer.get(u.GeneralSettings),l=(0,a.toObservable)(e.data.lifetime,n);ko.explicitComputed(e.data.lifetime,[l,r],(e=>(0,u.isSideBarDocked)(t)?1===e?"collapsed":2===e?"expanded":"flyout":"flyout")).subscribe(e.data.lifetime,(e=>{this.fireEvent("sideBarLayoutModeChanged",e)}));const c=(0,o.getPortalViewModel)(this.contextData.diContainer);this.contextData.inDockedContextPane?this.subscribeToViewLayoutModeChangeEvents(c.dockedContextPane.getRootElement()):this.contextData.inContextPane&&this.subscribeToViewLayoutModeChangeEvents(c.rightContextPane.getRootElement())}async hasParentMenuItem(e){this.verifyBladeOnlyApiAvailable("hasParentMenuItem");return(await this.contextData.diContainer.getAsync(n.get("MsPortalImpl/UI/UI.SupportContext","SupportContext"))).hasMenuItem(e)}setAlertOnViewCloseMessage(e){this.verifyBladeOnlyApiAvailable("setAlertOnViewCloseMessage");const t=this.contextData.getContainer();e?t.form.configureAlertOnClose(ko.observable({showAlert:!0,message:e})):t.form.configureAlertOnClose(1)}setViewError(e){this.verifyBladeOnlyApiAvailable("setViewError");const t=Date.now(),s=this.contextData.getContainer();let i=!0;switch(e.kind){case"fail":s.fail(e),i=!1;break;case"handledError":s.handledError("message"in e?e:"No message");break;case"noData":s.noDataMessage(e.message);break;case"notFound":s.notFound("message"in e?e:void 0);break;case"unauthorized":s.unauthorized("message"in e?e:void 0)}this.contextData.disposeReactContent({viewLoadTimestamp:i?t:void 0})}setViewTitle(e,t=""){this.verifyBladeOnlyApiAvailable("setViewTitle");const s=this.contextData.getViewModel();this.contextData.hasParentMenu?(s.menuContent.title(e),s.menuContent.subtitle(t)):(s.title(e),s.subtitle(t))}setViewIcon(e){this.verifyBladeOnlyApiAvailable("setViewIcon");const t=this.contextData.getViewModel(),s=t.icon(),i=this.toImage(e);s&&i&&s.data===i.data||t.icon(i)}setSelectedParentMenuItem(e,t){this.verifyBladeOnlyApiAvailable("setSelectedParentMenuItem"),this.contextData.getContainer().menu.switchItem(e,t?this.diContainer.get(p.ReactNavigationService).convertViewToPdlBladeReference(t):void 0)}async setViewLayoutMode(e){if(this.verifyBladeOnlyApiAvailable("setViewLayoutMode"),this.contextData.inDockedContextPane&&"minimized"!==e){(0,o.getPortalViewModel)(this.contextData.diContainer).dockedContextPane.getRootElement().trigger("maximized"===e?"maximized":"restore")}}toggleFullScreenMode(){this.contextData.diContainer.get(s.FullScreenMode).toggle()}toggleSideBar(){$.querySelectorAll(".fxs-topbar-sidebar-collapse-button").trigger("fxtogglesidebar",{updateSettings:!0})}subscribeToViewLayoutModeChangeEvents(e){const t=()=>{this.fireEvent("viewLayoutModeChanged","maximized")},s=()=>{this.fireEvent("viewLayoutModeChanged","minimized")},i=()=>{this.fireEvent("viewLayoutModeChanged","normal")};e.on("maximized",t),e.on("minimized",s),e.on("restore",i),this.contextData.lifetime.registerForDispose((()=>{e.off("maximized",t),e.off("minimized",s),e.off("restore",i)}))}toImage(e){return e&&(0,d.isValidUri)(e)?MsPortalFx.Base.Images.ImageUri(e):null}};__decorate([__metadata("fx:diagnostics",[e,"ReactViewHostService.prototype"]),(0,c.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",Promise)],m.prototype,"hasParentMenuItem",null),__decorate([__metadata("fx:diagnostics",[e,"ReactViewHostService.prototype"]),(0,c.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",void 0)],m.prototype,"setAlertOnViewCloseMessage",null),__decorate([__metadata("fx:diagnostics",[e,"ReactViewHostService.prototype"]),(0,c.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],m.prototype,"setViewError",null),__decorate([__metadata("fx:diagnostics",[e,"ReactViewHostService.prototype"]),(0,c.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[String,Object]),__metadata("design:returntype",void 0)],m.prototype,"setViewTitle",null),__decorate([__metadata("fx:diagnostics",[e,"ReactViewHostService.prototype"]),(0,c.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",void 0)],m.prototype,"setViewIcon",null),__decorate([__metadata("fx:diagnostics",[e,"ReactViewHostService.prototype"]),(0,c.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[String,Object]),__metadata("design:returntype",void 0)],m.prototype,"setSelectedParentMenuItem",null),__decorate([__metadata("fx:diagnostics",[e,"ReactViewHostService.prototype"]),(0,c.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",Promise)],m.prototype,"setViewLayoutMode",null),__decorate([__metadata("fx:diagnostics",[e,"ReactViewHostService.prototype"]),(0,c.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],m.prototype,"toggleFullScreenMode",null),__decorate([__metadata("fx:diagnostics",[e,"ReactViewHostService.prototype"]),(0,c.ProxyMethod)(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],m.prototype,"toggleSideBar",null),t.ReactViewHostService=m=__decorate([__metadata("fx:diagnostics",[e,"ReactViewHostService"]),r.Class("reactview"),__metadata("design:paramtypes",[l.ReactServiceContext,r.Container])],m)})),
define("MsPortalImpl/ReactServices/ReactServiceFactory",["require","exports","MsPortalImpl/ReactServices/CacheService","MsPortalImpl/ReactServices/NavigationService","MsPortalImpl/ReactServices/ResourceService","MsPortalImpl/ReactServices/SubscriptionService","MsPortalImpl/ReactServices/ThemeService","MsPortalImpl/ReactServices/ViewHostService","FxInternal/AsyncLoader","MsPortalImpl/ReactServices/ReactServiceBase"],(function(e,t,s,i,o,n,r,a,l,c){"use strict";t.getReactServiceLookup=function(e,t){if(!t)for(const t of d)e.get(t);return{getService:async(t,s={})=>{const{methodNameToVerify:i}=s,o=await function(e){if(void 0===u[e]){const t=p[e];if(!t)throw new Error(`Proxy service name "${e}" not found`);u[e]=t()}return u[e]}(t);if(i&&!(0,c.isServiceProxyMethod)(o.prototype,i))throw new Error(`Method "${i}" is not a registered method on proxy service "${t}".`);const n=e.get(o);if(i&&"function"!=typeof n[i])throw new Error(`Method "${i}" not found on proxy service "${t}".`);return n}}};const d=[s.ReactCacheService,i.ReactNavigationService,o.ReactResourceService,n.ReactSubscriptionService,r.ReactThemeService,a.ReactViewHostService],p={authentication:()=>l.get("MsPortalImpl/ReactServices/AuthenticationService","ReactAuthenticationService"),assetType:()=>l.get("MsPortalImpl/ReactServices/AssetTypeService","ReactAssetTypeService"),assetViewReference:()=>l.get("MsPortalImpl/ReactServices/AssetViewReferenceService","ReactAssetViewReferenceService"),browse:()=>l.get("MsPortalImpl/ReactServices/BrowseService","ReactBrowseService"),cache:()=>l.get("MsPortalImpl/ReactServices/CacheService","ReactCacheService"),cloudShell:()=>l.get("MsPortalImpl/ReactServices/CloudShellService","ReactCloudShellService"),fetch:()=>l.get("MsPortalImpl/ReactServices/FetchService","ReactFetchService"),icon:()=>l.get("MsPortalImpl/ReactServices/IconService","ReactIconService"),location:()=>l.get("MsPortalImpl/ReactServices/LocationService","ReactLocationService"),navigation:()=>l.get("MsPortalImpl/ReactServices/NavigationService","ReactNavigationService"),policy:()=>l.get("MsPortalImpl/ReactServices/PolicyService","ReactPolicyService"),provisioning:()=>l.get("MsPortalImpl/ReactServices/ProvisioningService","ReactProvisioningService"),resource:()=>l.get("MsPortalImpl/ReactServices/ResourceService","ReactResourceService"),resourceGroup:()=>l.get("MsPortalImpl/ReactServices/ResourceGroupService","ReactResourceGroupService"),subscription:()=>l.get("MsPortalImpl/ReactServices/SubscriptionService","ReactSubscriptionService"),support:()=>l.get("MsPortalImpl/ReactServices/SupportService","ReactSupportService"),tenant:()=>l.get("MsPortalImpl/ReactServices/TenantService","ReactTenantService"),viewHost:()=>l.get("MsPortalImpl/ReactServices/ViewHostService","ReactViewHostService")},u={}})),
define("MsPortalImpl/Services/Services.PersistentStorage",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.Settings","FxInternal/AsyncLoader","FxInternal/RpcEndPointsCore","MsPortalImpl/Base/Base.ImplUtils"],(function(e,t,s,i,o,n,r){"use strict";t.writeSettingHandler=t.removeSettingsHandler=t.readSettingsHandler=t.getAllKeysHandler=t.clearHandler=t.StorageCapacityExceededError=t.PersistentStorageSettings=t.KeySizeExceededError=void 0;var a=MsPortalFx.Base.Diagnostics.Telemetry;const l=e=>`${e}PersistentStorage`,c=e=>`__fx_metadata__${e}`;let d=t.PersistentStorageSettings=class{constructor(e){this._settingsManager=e,this._cache={}}writeSetting(t,s,i,o=[]){const n=s=>((0,r.logToExtension)(e,t,2,s),Promise.reject(s));if(s.length>241)return n(new u(s.length));const a=l(t),d=this._traceAction(t,"WritePersistentSettings");return this._getCacheStorage(t).then((e=>{const r=[[s,i]];o.length&&r.push([c(s),JSON.stringify({readers:o})]);const l=r.reduce(((t,s)=>t+this._estimateExistingSize(e,s[0])),0),p=r.reduce(((e,t)=>e+this._estimateSize(t[0],t[1])),0),u=p-l,h=function(e){return g.includes(e)}(t)?102400:10240;return u+e.size>h?n(new m({keyValuePairsSize:u,cacheSize:e.size})):Promise.all(r.map((t=>{const[s,i]=t,o=this._estimateSize(s,i);let n=0;return e.storage.has(s)&&(n=this._estimateExistingSize(e,s)),e.size+=o-n,e.storage.set(s,i),this._settingsManager.setSetting(a,s,i)}))).then((()=>{d({sizeAdded:p})}))}))}readSettings(e,t,s=e){const i=this._traceAction(e,"ReadPersistentSettings");return this._getCacheStorage(e).then((o=>{const n=t.reduce(((t,i)=>{const n=o.storage.get(i),r=o.storage.get(c(i))||"",a=r.length?JSON.parse(r):{},l=a?.readers;return(e===s||"*"===l||l?.includes(s))&&void 0!==n&&(t[i]=n),t}),{});return i({numberOfRequestedKeys:t.length,numberOfReturningPairs:Object.keys(n).length}),n}))}removeSettings(e,t){const s=l(e),i=t.concat(t.map(c)),o=this._traceAction(e,"RemovePersistentSettings");return this._getCacheStorage(e).then((e=>(i.forEach((t=>{e.storage.has(t)&&(e.size-=this._estimateExistingSize(e,t),e.storage.delete(t));const s=c(t);e.storage.has(s)&&(e.size-=this._estimateExistingSize(e,s),e.storage.delete(s))})),this._settingsManager.deleteSettings({store:s,keys:i}).then(o).catch((e=>{p.error(e)})))))}clear(e){const t=this._traceAction(e,"ClearPersistentStorage");return this.getAllSettingsKeys(e).then((s=>this.removeSettings(e,s).then((()=>{t({numberOfKeysRemoved:s.length})}))))}getAllSettingsKeys(e){return this._getCacheStorage(e).then((e=>Array.from(e.storage.keys()).filter((e=>!e.startsWith("__fx_metadata__")))))}_getCacheStorage(e){const t=Date.now();return this._cache[e]?.expires>t?Promise.resolve(this._cache[e]):this._settingsManager.querySettings({store:l(e)}).then((s=>{let i=0;const o=Object.keys(s).map((e=>(i+=this._estimateSize(e,s[e]),[e,s[e]])));return this._cache[e]={expires:t+36e5,storage:new Map(o),size:i},this._cache[e]})).catch((e=>(p.error(e),{expires:t+36e5,storage:new Map,size:0})))}_estimateSize(e,t){return 2*(e.length+t.length)}_estimateExistingSize(e,t){return e.storage.has(t)?this._estimateSize(t,e.storage.get(t)||""):0}_traceAction(e,t){const s=MsPortalFx.startTimer(),i=e=>e&&{size:e.size,numberOfKeys:Array.from(e.storage.keys()).length},o=i(this._cache[e]);return n=>{const r=i(this._cache[e]);a.trace({source:"Services.PersistentStorage",action:t,actionModifier:a.ActionModifier.Complete,name:e,data:{initialCacheState:o,finalCacheState:r,extraData:n,duration:s()}})}}};t.PersistentStorageSettings=d=__decorate([__metadata("fx:diagnostics",[e,"PersistentStorageSettings"]),s.Class(),__metadata("design:paramtypes",[i.SettingsManager])],d);const p=MsPortalFx.Base.Diagnostics.createLog(e);class u extends Error{constructor(e){super(`Attempting to set a key/value pair that has a key size that exceeds the portal's limit: 241 characters. (Key length: ${e} characters)`),this.name="KeySizeExceededError"}}t.KeySizeExceededError=u;class m extends Error{constructor(e){super(`Attempting to set a key/value pair which when combined with all settings would exceed the portal's limit: 10240 bytes. (Requested: ${e.keyValuePairsSize} bytes, Current: ${e.cacheSize} bytes)`),this.name="StorageCapacityExceededError"}}t.StorageCapacityExceededError=m;t.writeSettingHandler=(0,o.defineHandler)(n.writeSettingEndPoint,(e=>e.diContainer.get(d).writeSetting(e.messageContext.srcWindowId,e.messageArg.key,e.messageArg.value,e.messageArg.readers))),t.readSettingsHandler=(0,o.defineHandler)(n.readSettingsEndPoint,(e=>e.diContainer.get(d).readSettings(e.messageArg.extensionName,e.messageArg.keys,e.messageContext.srcWindowId))),t.removeSettingsHandler=(0,o.defineHandler)(n.removeSettingsEndPoint,(e=>e.diContainer.get(d).removeSettings(e.messageContext.srcWindowId,e.messageArg.keys))),t.clearHandler=(0,o.defineHandler)(n.clearEndPoint,(e=>e.diContainer.get(d).clear(e.messageContext.srcWindowId))),t.getAllKeysHandler=(0,o.defineHandler)(n.getAllKeysEndPoint,(e=>e.diContainer.get(d).getAllSettingsKeys(e.messageContext.srcWindowId)));const g=["Microsoft_Azure_Health","Microsoft_AAD_IAM"]})),
define("MsPortalImpl/UI/UI.NavigationHelpers",["require","exports","MsPortalImpl/Services/Services.Settings","MsPortalImpl/UI/UI.AuthStateManager","FxInternal/Redirect","FxInternal/AsyncLoader","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/UI/UI.NavigationManager"],(function(e,t,s,i,o,n,r,a){"use strict";t.redirect=h,t.refreshPortalHandler=void 0,t.requestNavigationToTrustedUrlImpl=function(e,t){const s=t?.forceRelogin||!1;if(URL.canParse(e.url)){const t=new URL(e.url);x.has(t.origin)?(c.trace({source:"RequestNavigationToTrustedUrl",action:"NavigationSuccessful",data:{source:e.source,target:t.origin+t.pathname}}),e.diContainer.get(a.WindowManager).redirect({uri:t.href,redirectAction:s?1:0})):c.trace({source:"RequestNavigationToTrustedUrl",action:"NavigationFailed",actionModifier:"UrlNotTrusted",data:{source:e.source,target:t.origin+t.pathname}})}else c.trace({source:"RequestNavigationToTrustedUrl",action:"NavigationFailed",actionModifier:"UrlNotValid",data:{source:e.source,target:e.url}})},t.switchTenantHandler=void 0,t.switchTenantImpl=f;var l=MsPortalFx.Base,c=l.Diagnostics.Telemetry,d=l.UriBuilder,p=l.Resources;const u=(0,MsPortalFx.ensureSuffix)(p.getAppRelativeUri("/"),"/"),m=e=>u+e.slice(1);function g(e){return(e||"").toLowerCase()}async function h(e){const{diContainer:t,tenant:o,hash:n,reason:a,telemetrySource:l}=e||{},p=t.get(i.AuthStateManager),u=p.getCurrentUser(),g=o?.domainName||u.tenantDomain,h=n||(0,r.getHashQueryStringSegment)(location.href),f=t.get(FxImpl.Features).isEnabled("preferredusername")?u.preferredUsername:u.emailAddress,x=await t.getAsync(s.SettingsManager);await x.flushSettings();const b=new d(m(p.bootstrapState.loginReplyUrlPath));b.path+="@"+g,c.trace({source:l,action:"Redirect",actionModifier:a,data:{uri:b.toString(),hash:n,hashQueryString:h,telemetrySource:l}}),(0,r.redirectWithCdn)(t,{uri:b.toString(),parameters:f?{loginHint:f}:null,hash:n||h,redirectAction:18,reason:a})}async function f(e){const{tenant:t,diContainer:s,telemetrySource:o}=e||{};if(!t?.tenantId||!t?.domainName)return void await h({diContainer:s,hash:"#settings/directory",reason:"NavigateToSettings",telemetrySource:o});const n=t.tenantId,r=s.get(i.AuthStateManager).getCurrentUser();r&&g(n)!==g(r.tenantId)&&(c.trace({source:o,action:"SwitchTenant",actionModifier:"RedirectToTenant",data:{tenantId:n}}),await h({diContainer:s,tenant:t,hash:"#home",reason:"SwitchTenant",telemetrySource:o}))}const x=new Set(["https://signup.azure.com","https://signup-staging.azure.com"].map((e=>e.toLowerCase())));t.refreshPortalHandler=(0,n.defineHandler)(o.refreshPortal,(e=>h({reason:e.messageArg.reason,hash:e.messageArg.hash,diContainer:e.diContainer,telemetrySource:e.messageArg.telemetrySource}))),t.switchTenantHandler=(0,n.defineHandler)(o.switchTenant,(e=>f({diContainer:e.diContainer,tenant:e.messageArg.tenant,telemetrySource:e.messageArg.telemetrySource})))})),
define("MsPortalImpl/UI/UI.NavigationManager.ForceSignIn",["require","exports","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Base/Base.ImplUtils"],(function(e,t,s,i,o,n){"use strict";t.forceSignIn=async function(e,t,l){const c=a.startTrace({source:"UI.NavigationManager",action:"ForceSignInHandler"}),d=e.get(s.AuthStateManager),p=await d.getUserInfo(),u={callingExtension:l,reason:t.reason,tenantSource:"Options"},m=d.getSignedInUserTenant();let g=t.tenantId;g?g.toLowerCase()!==m.toLowerCase()&&(u.newTenantId=g):(g=m,u.tenantSource="Current");const h=new MsPortalFx.Base.UriBuilder(fx.environment.applicationPath);if(h.setRelativePath(`${h.getRelativePath()}/${g}`),t.bladeDeepLink)h.fragment=MsPortalFx.sanitizeMessage(t.bladeDeepLink);else if(t.bladeReference){const e=t.bladeReference,s=(0,o.getBladeDeepLink)(e.extensionName,e.bladeName,e.parameters,{selectedMenuItemId:t.bladeReference.menuId});u.deepLink=MsPortalFx.sanitizeMessage(s),h.fragment=s}h.query=new r.QueryStringBuilder((0,n.getQueryStringSegment)(location.href)),h.query.setParameter("loginHint",MsPortalFx.isFeatureEnabled("preferredusername")?p.preferredUsername:p.email),h.query.setParameter("forcesignin","true"),h.query.setParameter("feature.msaljs",MsPortalFx.isFeatureEnabled("msaljs")+"");const f=new URLSearchParams(location.search).get("exp.msaljsloginexp");f&&h.query.setParameters((0,s.getMsalJsLoginQueryParameters)(f+""));if(t.signInParameters){const e=function(e){const t=Object.create(null);return Object.keys(e).forEach((s=>{"acr_values"!==s&&"amr_values"!==s&&"claims"!==s||(t[s]=e[s])})),t}(t.signInParameters);h.query.setParameter("signInParameters",JSON.stringify(e)),u.providedSignInParameters=Object.keys(t.signInParameters),u.effectiveSignInParameters=Object.keys(e)}a.completeTrace(c,u),e.get(i.WindowManager).redirect({uri:h.toString(),redirectAction:3,reason:"forceSignIn"})};var r=MsPortalFx.Base,a=r.Diagnostics.Telemetry})),
define("MsPortalImpl/AzFramework/AzHost",["require","exports","Fx","Fx/Composition/Selectable","FxInternal/AsyncLoader","Weave","FxInternal/Controls/Essentials","FxInternal/UriScrubber","FxInternal/Weave","FxHubs/RpcEndPoints","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Base.ImplUtils","MsPortalFx/Globalization","MsPortalImpl/AzFramework/AzExtensionCore","MsPortalImpl/Services/Services.ArmEvents","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Services/Services.Tenants","MsPortalImpl/Services/Services.PersistentStorage","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.Permissions","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Services/Services.GlobalResourceFilters","MsPortalImpl/Services/Services.ExtensionTokensManager","MsPortalImpl/Services/Services.PortalIdleState","MsPortalImpl/Interactions/Interactions.FullScreenMode","MsPortalImpl/ReactViews/ShellReactQueries","MsPortalImpl/AzFramework/AzHost.Browse","MsPortalImpl/Widgets/Widgets.SideBar","MsPortalImpl/ReactViews/ReactFrame.Constants","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/UI/UI.BladeOpener","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.NavigationManager.ForceSignIn","MsPortalImpl/UI/UI.NavigationHelpers","MsPortalImpl/Base/Themes","MsPortalImpl/ReactServices/ReactServiceContext","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/ReactServices/ReactServiceFactory","MsPortalImpl/ReactViews/ReactFederatedModules"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x,b,y,v,w,M,C,S,I,P,_,F,T,k,E,D,A,B,N,R,L,z){"use strict";t.create=function({lifetime:t,getToken:V,parameters:q,defaultTokenPromise:j,telemetryContextState:ie,initializedDeferred:oe,onMessageReceived:ne,extensionName:re,extensionVersion:ae,diContainer:le,selectedSubscriptions:ce,getUserInfo:de,theme:pe,frameWindow:ue,features:me,router:ge,reactFrameType:he,extensionStorage:fe,getSafeLink:xe,queryStore:be,globalResourceFilter:ye,hasParentMenu:ve,inContextPane:we,inDockedContextPane:Me,frameId:Ce,menuRenderer:Se,onBladeApiCalled:Ie,onFCP:Pe}){const _e=re,Fe=(()=>{const e=arguments[0];return Ie&&5===he?["container","viewModel","contentRevealedDeferred","provisioningContext","setContextPaneWidth","bladeTelemetryData"].reduce(((e,t)=>(Object.defineProperty(e,t,{get:()=>{throw Ie(),new Error("Not reachable")}}),e)),{}):e})(),Te=16&le.get(R.ExtensionManagerOptions).getNormalizedMetadata(re).flags,ke=Ie&&5===he?e=>{throw Ie(e),new Error("Not reachable")}:()=>{};let Ee;const De=ie&&W.usingState((()=>(Ee=J(),W.getCurrentValues())),ie)||{Blade:{id:"Ambient",instanceId:"Ambient"}},Ae=Ee?.id;let Be,Ne,Re=ce;const Le=FxImpl.internalEnv.blockUntrustedDomains||MsPortalFx.isFeatureEnabled("blockuntrusteddomains"),ze=async()=>le.getAsync(o.get("MsPortalImpl/Services/Services.TourGuideManager","TourGuideManager")),He=e=>{if(Re=e,!Re){const e=le.get(h.SubscriptionsUserContext).getInSessionSelectedSubscriptions();Re={get:()=>e.then((e=>e())),onChangedPromise:e}}Be&&Be.dispose(),Be=t.createChildLifetime(),Re.onChangedPromise.then((e=>e.subscribe(Be,(e=>{qe(1005,{subscriptions:e})}))))};He(ce);const{registerFunction:Oe,callRegisteredFunction:Ue,validStubId:We}=function(){let e=1;const t={};function s(s,o){if(s){const n=e++;return t[n]=o?function(){i(n),s.apply(null,arguments)}:s,n}}function i(e){n(e)&&delete t[e]}function o(e){const{responseStubId:s,response:i}=e;t[s].call(null,i)}function n(e){return"number"==typeof e}return{registerFunction:s,callRegisteredFunction:o,validStubId:n}}(),Ve=[];let qe=function(e,t){Ve.push({kind:e,data:t})};function $e(e,t){qe(1001,{stubId:e,args:t})}function je(e){const{bladeName:t,parameters:s,marketplaceId:o,createAssetKind:n,telemetryId:r,marketplaceOptions:a,onClosed:l,referenceType:c,initialData:d,providerConfig:p,receiveResult:u,menuId:m,contentBladeReference:g,extensionName:h,createAssetType:f,subscriptionId:x,catalogId:b}=e,y=We(l)&&((e,t)=>{$e(l,[e,t])})||null;let v;if(1===c)v=new i.ParameterProviderBladeReference(t,h,{parameters:s,onClosed:y,supplyInitialData:d&&(()=>FxImpl.fromSerializableObject(d)),supplyProviderConfig:p&&(()=>p),receiveResult:We(u)&&(e=>{$e(u,[e&&FxImpl.toSerializableObject(e)])})});else if(2===c){const e=g&&je(g);v=new i.MenuBladeReference(t,m,h,{contentBladeReference:e,parameters:s,onClosed:y})}else if(3===c){let e;!f||h||[MsPortalFx.Base.Constants.ExtensionNames.Marketplace,MsPortalFx.Base.Constants.Shell].includes(_e)||(e=`${MsPortalFx.Base.Constants.Shell}::${_e}`);const l=f?{extensionName:e,assetType:f,assetKind:n,catalogId:b,subscriptionId:x,marketplaceId:o,telemetryId:r}:null;v=new i.ProvisioningBladeReference(t,h,l||o||a,{parameters:s,onClosed:y})}else v=new i.PdlBladeReference(t,h,{parameters:s,onClosed:y});return FxImpl.shellInterface(v,FxImpl.shellInterface(e)),v}function Ge(e){return{bladeName:e.bladeName,extensionName:e.extensionName,parameters:e.parameters}}function Ke(e,t){qe(1033,{responseStubId:e.responseStubId,response:{result:t,calleeEndTime:Date.now()}})}function Je(e){const t=e.options.onClosed;e.options.onClosed=function(e,s){Ft(),t?.(e,s)}}const Qe=e=>Te?Promise.reject("Not allowed for third party extensions"):e(),Xe=new FxImpl.TriggerableLifetimeManager;function Ze(e,s){H.Promises.cancelOnDispose(Xe,e).then((e=>Ke(s,e))).catch((e=>{t.isDisposed()||qe(1033,{responseStubId:s.responseStubId,response:{error:se(e),calleeEndTime:Date.now()}})}))}function Ye(e,t){const s=function(e){const{inContextPane:t,fromMenu:s,options:i}=e;let o;return i?.asNewJourney?o|=8:t?(o|=1,o|=we&&4):s&&(o|=s&&4),o|=i?.asSubJourney&&2,o|=we&&16,o|=1===i?.helpPane&&64,o|=2===i?.helpPane&&128,o}(e),i=5!==he&&le.get(E.BladeDescriptor)?.flags,o=MsPortalFx.isFeatureEnabled("sidebarnotparent")&&!!(256&i);return{container:o?void 0:t,flags:s,telemetryName:"AzHost",context:{openedBy:o?1:0}}}const et=(()=>{const e=[];return{request:t=>{const{bladeReferenceStubId:s,fromMenu:i}=t,o=e[s]=Promise.withResolvers();let n=o.promise;i&&(n=o.promise.then((e=>(Je(e),e))));const{container:r}=Fe,a=Ye(t,r),l=le.get(k.BladeOpener).openBlade(n,a);i&&l.then(_t),Ze(l,t)},response:t=>{const{responseStubId:s,response:i}=t;te(e[s],{...i,result:i.result?je(i.result):null})}}})(),tt=e=>{e.subscribe(t,(e=>{He(null),I.globalSubscriptionsQuery.bind(be,le).clear(),qe(3082,{name:e?.name})}))};let st=ye;st?tt(st):le.get(h.SubscriptionsUserContext).useAdvancedFiltersPromise.then((e=>{e&&(st?tt(st):le.getAsync(w.ResourceFilterManager).then((e=>{st=e.currentFilterObservable,tt(st)})))}));le.get(g.ArmEvents).subscribeToArmEvent({status:"succeeded"},(e=>qe(1030,e))),Z||async function(){}();const it=()=>location.hash?.replace("#","");le.get(d.PortalCustomEvents).addHandler(t,"fxdeeplinkchanged",(()=>{qe(1031,it())}));const ot=j&&H.Promises.cancelOnDispose(t,j).then((e=>({result:e}))).catch((e=>({error:e}))),nt=H.Promises.cancelOnDispose(t,de?de():le.get(T.AuthStateManager).getUserInfo()).then((e=>({result:e}))).catch((e=>({error:e})));function rt(e,t){ne?.[e]&&ne[e]();const s=ht.get(e);s?s(t):K.error(`Handler[${e}] is undefined`,null,{extension:re,context:De})}function at(e){W.usingState((()=>{O.Telemetry.trace({source:"AzHost",action:"ReactViewErrors",actionModifier:"complete",data:{frameId:Ce,...e,capturedErrors:Mt}})}),ie)}const lt=Promise.withResolvers(),ct=Promise.withResolvers(),dt=Promise.withResolvers(),pt=(()=>{const e=FxImpl.Rpc.client;return()=>FxImpl.Rpc.client===e&&!Z})(),ut=e=>{pt()&&FxImpl.Extension.traceToExtensionEndPoint.invoke(FxImpl.Rpc.client,re,[e,ie]),"HubsExtension"!==re&&U.trace(e)},mt=()=>"HubsExtension"===re?"LighthousePerfVizClientTelemetry":"LighthousePerfVizExtTelemetry",gt=e=>({bladeId:Ae,tableName:mt(),...e&&{shellVersions:JSON.stringify(e?.shellVersions||[]),extensionVersions:JSON.stringify(e?.extensionVersions||[]),features:JSON.stringify(e?.features||[]).replace(/"/g,'\\"')}}),ht=new Map,ft=()=>{qe(1,function(){const e=FxImpl.internalEnv.extensionTelemetryUri,s=FxImpl.internalEnv.extensionTraceUri,i=MsPortalFx.sessionId,o=MsPortalFx.extend2(FxImpl.getStandardHeaders(re,ae),{"Accept-Language":u.displayLanguage,"x-ms-effective-locale":FxImpl.Intl.effectiveLocale,"x-ms-client-session-id":i});let n;if(ko.computed(t,(()=>function(){const{currentTheme:e,highContrastMode:t}=pe;return{mode:e().mode,highContrastMode:t()}}())).subscribe(t,(e=>{const t=le.get(B.ThemeManager).getCurrentThemeColorCssModuleId();MsPortalFx.require(t).then((t=>{qe(1004,{theme:e,cssModule:t})}))})),!Z){const{layoutMode:e}=le.get(_.ViewModel),{sideBarLayout:s}=le.get(v.GeneralSettings),i=(0,l.toObservable)(t,e);n=ko.explicitComputed(t,[i,s],(e=>(0,v.isSideBarDocked)(le)?e:0)),n.subscribe(t,(e=>{qe(3078,e)}))}return{parameters:q,sessionId:i,diagnostics:{telemetryContext:De,headers:o,telemetryUri:e,loggingUri:s},features:me,deepLink:it(),sideBarLayoutMode:n?.(),...5!==he&&{openedBy:Fe.bladeTelemetryData?.openedBy,openedByBladeName:Fe.bladeTelemetryData?.openedByBladeName}}}()),ot.then((e=>qe(2,{token:e}))),nt.then((e=>qe(4,{userInfo:e})))};Z?ht.set(0,ft):ft();const xt=le.createChildContainer("reactview"),bt={};let yt=0;const vt=(0,s.memoizePromise)((()=>{const e={};return MsPortalFx.require("FxInternal/Composition/ViewModelAdapters.DoesProvisioning").then((({setProvisioning:t})=>{const{container:s,provisioningContext:i}=Fe;return i.then((i=>(t(le,e,i,s,Ee,Xe),e)))}))}),{onError:t=>((0,p.logToExtension)(e,re,2,t),!0)});xt.set(N.ReactServiceContext,new N.ReactServiceContext({extensionName:re,diContainer:le,inContextPane:we,inDockedContextPane:Me,hasParentMenu:ve,lifetime:t,queryStore:be,reactFrameType:he,router:ge,stubFunctionCallbacks:!0,telemetryContext:De,disposeReactContent:e=>{Tt(e.viewLoadTimestamp?{timestamp:e.viewLoadTimestamp}:void 0)},invokeCallbackFn:(e,t,...s)=>{if("function"===e){const e=++yt;qe(3119,{stubId:t,responseStubId:e,args:s});const i=Promise.withResolvers();return bt[e]=i,i.promise}qe(3119,{stubId:t,args:s})},invokeEventHandlerFn:(e,t,s)=>{qe(3122,{serviceName:e,eventType:t,eventData:s})},getContainer:()=>Fe.container,getViewModel:()=>Fe.viewModel,provisioningMemo:vt}));const wt=(0,L.getReactServiceLookup)(xt,Boolean(Z));ht.set(3118,(e=>{const s=e.serviceName,i=e.methodName,o="string"==typeof e.methodArgs?JSON.parse(e.methodArgs):e.methodArgs,n=wt.getService(s,{methodNameToVerify:i}).then((e=>e[i].apply(e,o)));e.ignoreResponse||H.Promises.cancelOnDispose(Xe,n).then((t=>{qe(3119,{stubId:e.responseStubId,args:[{result:t,calleeEndTime:Date.now()}]})})).catch((s=>{t.isDisposed()||qe(3119,{stubId:e.responseStubId,args:[{error:JSON.parse(se(s,!0)),calleeEndTime:Date.now()}]})}))})),ht.set(3121,(e=>{const t=bt[e.responseStubId];t&&(delete bt[e.responseStubId],e.response.error?t.reject(e.response.error):t.resolve(e.response.result))})),ht.set(1e3,(e=>{e.forEach((e=>rt(e.kind,e.data)))})),ht.set(1010,(()=>{ke("revealContent");const{contentRevealedDeferred:e,container:t}=Fe;e.resolve(),t.revealContent()})),ht.set(1011,(()=>oe.resolve())),ht.set(1012,(e=>{ke("setTitle");const t=e&&e.title,s=e&&e.subtitle,{viewModel:i}=Fe;i.title(t),i.subtitle(s)})),ht.set(1014,(e=>{ke("openBlade");const{bladeReference:t,fromMenu:s}=e,i=je(t);s&&Je(i);const{container:o}=Fe,n=Ye(e,o),r=le.get(k.BladeOpener).openBlade(i,n);s&&r.then(_t),Ze(r,e)})),ht.set(1015,(e=>(ke("openBladeAsync"),et.request(e)))),ht.set(1016,et.response),ht.set(1028,(()=>{window.location.hash="#menu/directory"})),ht.set(3006,(e=>{Ze(I.resourceGroupsQuery.bind(be,e.subscriptionIds).get(),e)})),ht.set(3007,(e=>{const t=le.get(y.PermissionsManager).hasPermission(`/subscriptions/${e.subscriptionId}`,["Microsoft.Resources/subscriptions/resourcegroups/write"],H.Constants.Shell).then((t=>MsPortalFx.ViewModels.getValidationResult(t?void 0:MsPortalFx.Resources.Strings.ResourceGroup.Validation.subscriptionHasNoPermissionsMessage.format(e.subscriptionId))));Ze(MsPortalFx.Azure.ResourceGroups.validateResourceGroupName(e.resourceGroupName,e.subscriptionId,e.existingResourceGroupNames,void 0,t).then((e=>({valid:e.valid,message:e.message}))),e)})),ht.set(3004,(e=>{Ze(I.essentialsResourceInfoQuery.bind(be,t,e.resourceId,e.includeTags).get(),e)})),ht.set(3025,(e=>{Ze(le.get(b.AssetTypeService).mapResourceIdAndKindToBladeInfo(e.resourceId,e.resourceKind).then((t=>({bladeName:t.bladeName,extensionName:t.bladeExtension,parameters:{id:e.resourceId}}))),e)})),ht.set(3232,(async e=>{const t=()=>V({resourceName:e.resourceName}).then((e=>e.header));Ze(Qe((()=>MsPortalEarly.getEntraUxSettings(t,e.forceRefetch))),e)})),ht.set(3233,(async e=>{const t=()=>V({resourceName:e.resourceName}).then((e=>e.header));Ze(Qe((()=>MsPortalEarly.getEntraTenantType(t,e.forceRefetch))),e)})),ht.set(3234,(async e=>{const t=()=>V({resourceName:e.resourceName}).then((e=>e.header));Ze(Qe((()=>MsPortalEarly.getEntraSubscribedSkus(t,e.forceRefetch))),e)})),ht.set(3026,(e=>{const t=new r.TagResourcesBladeReference(e);Ze(Promise.resolve(Ge(t)),e)})),ht.set(3028,(e=>{const t=new r.EditTagsBladeReference({resource:e.resourceId,tagName:e.tagName});Ze(Promise.resolve(Ge(t)),e)})),ht.set(3042,(async e=>{const{handleTagsContextPaneResults:t}=await MsPortalFx.require("FxHubs/ArmHelpers/ArmTags");Ze(t(e.resourceToTagsMap).then((t=>{if(t.armErrorsMap.get(e.resourceId))return;const s=t.newTagsMap.get(e.resourceId);return Object.keys(s).map((e=>({key:e,value:s[e]})))})),e)})),ht.set(3124,(async e=>{const{updateSoftDeleteInfo:t}=await MsPortalFx.require("FxHubs/ArmHelpers/ArmSoftDelete");Ze(t(e.resourceId,e.currentSoftDeleteEnabled,e.newSoftDeleteEnabled,e.newRetentionTime),e)})),ht.set(3029,(e=>{const t=new i.PdlBladeReference("RmAddResourceWizardBlade","Microsoft_Azure_ResourceMove",{parameters:e});Ze(Promise.resolve(Ge(t)),e)})),ht.set(3060,(e=>{Ze(le.get(b.AssetTypeService).getBrowseBladeReference(e.browseBladeReferenceOptions).then((e=>e&&{bladeName:e.blade,extensionName:e.extension,parameters:e.parameters})),e)})),ht.set(1017,(e=>{ke("closeChildBlade");const{container:t}=Fe;Ze(t.closeChildBlade(),e)})),ht.set(1018,(e=>{ke("closeContextPane");const{container:t}=Fe;Ze(t.closeContextBlade(),e)})),ht.set(1019,(e=>{const{partReferences:t,options:s}=e;Ze(MsPortalFx.require("Fx/Pinner").then((({pin:e})=>e(t.map(Y),{notify:s?.notify}))),e)}));const Mt=[];ht.set(3059,(e=>{Mt.push(e)})),ht.set(1020,(e=>{ke("fail");const t={...e,capturedErrors:Mt},{container:s}=Fe;s.fail({...e,error:{data:t}}),oe.reject(t),at(e),Tt()})),ht.set(1032,(e=>{ke("handledError");const{message:t,timestamp:s}=e,{container:i}=Fe;i.handledError(t??"No message"),at(t),Tt({timestamp:s})})),ht.set(1023,(e=>{ke("noData");const{message:t,timestamp:s}=e,{container:i}=Fe;i.noDataMessage(t),at({message:t}),Tt({timestamp:s})})),ht.set(1021,(e=>{ke("notFound");const{message:t,timestamp:s}=e,{container:i}=Fe;i.notFound(t),at(t),Tt({timestamp:s})})),ht.set(1022,(e=>{ke("unauthorized");const{message:t,timestamp:s}=e,i=t&&"string"!=typeof t?function(e){const{header:t,title:s,description:i,callToActionText:o,callToActionUri:n,imageType:r}=e;return{noticeHeader:t,noticeTitle:s,noticeDescription:i,noticeCallToActionText:o,noticeCallToActionUri:n,noticeImageType:r}}(t):t,{container:o}=Fe;o.unauthorized(i),at({message:i}),Tt({timestamp:s})})),ht.set(3096,(async e=>{const{mapAndExecuteAzureAsyncOperation:t}=await MsPortalFx.require("MsPortalImpl/AzFramework/AzHost.Notifications");t(e,re)})),ht.set(3090,(async e=>{const{mapAndPublishInternalNotification:t}=await MsPortalFx.require("MsPortalImpl/AzFramework/AzHost.Notifications");t(e,re)})),ht.set(3091,(async e=>{const{mapAndPublishInternalPendingNotification:t}=await MsPortalFx.require("MsPortalImpl/AzFramework/AzHost.Notifications");t(e,re)})),ht.set(3092,(async e=>{const{mapAndPublishInternalPollingNotification:t}=await MsPortalFx.require("MsPortalImpl/AzFramework/AzHost.Notifications");t(e,re)})),ht.set(1003,Ue),ht.set(1006,(e=>{const{resourceName:t,isBackground:s,requestedScopes:i}=e;Ze(V(t&&{resourceName:t,isBackground:s,requestedScopes:i}),e)})),ht.set(3094,(e=>{Ze(le.get(M.ExtensionTokensManager).getPopToken({...e,extensionName:re}),e)})),ht.set(3114,(e=>{Ze(le.get(M.ExtensionTokensManager).getSshCertToken({...e,extensionName:re}),e)})),ht.set(1007,(e=>{Ze(Re.get(),e)})),ht.set(3084,(e=>{Ze(MsPortalFx.require("Fx/Notifications/IrisNotifications").then((({getIrisContent:t})=>t(e))),e)})),ht.set(3103,(e=>{Ze(MsPortalFx.require("MsPortalImpl/Services/Services.Copilot").then((({isCopilotEnabled:e})=>e(le))),e)})),ht.set(3085,(e=>{Ze(MsPortalFx.require("Fx/Notifications/IrisNotifications").then((({sendIrisSignal:t})=>t(e))),e)})),ht.set(3055,(e=>{MsPortalFx.UI.AssetManager.notifyResourceDeleted(e.resourceId)})),ht.set(3077,(e=>{Ze(le.getAsync(o.get("MsPortalImpl/UI/Compositions/UI.Composition.BladeHistory","BladeHistory")).then((e=>e.getEntries().map((e=>{if(e.bladeReference.parameters)try{structuredClone(e.bladeReference.parameters)}catch(t){return O.Telemetry.trace({source:"AzHost",action:"GetRecentBlades",actionModifier:"stripParameters",data:{reference:{bladeName:e.bladeReference.bladeName,extensionName:e.bladeReference.extensionName},error:t?.message}}),{...e,bladeReference:{...e.bladeReference,parameters:void 0}}}return e})))),e)}));const Ct=()=>I.globalSubscriptionsQuery.bind(be,le).get();ht.set(3001,(e=>{Ze(Ct(),e)})),ht.set(3235,(e=>{Ze((async()=>{const e=await MsPortalFx.require("MsPortalImpl/Services/Services.Subscriptions");return le.get(e.SubscriptionsUserContext).getInSessionDisplayedSubscriptions().then((e=>e.isPartialSet))})(),e)})),ht.set(3002,(e=>{const t=Promise.withResolvers(),s=e.subscriptions.reduce(((e,t)=>(e[t.subscriptionId]=!0)&&e),{});Ct().then((e=>{const i=e.map((e=>e.subscriptionId)).filter((e=>s[e]));le.get(h.SubscriptionsUserContext).setInSessionSelectedSubscriptions(i).then((()=>t.resolve(!0)))})),Ze(t.promise,e)})),ht.set(3095,(e=>{Ze(I.initialDropdownValuesQuery.bind(be,le,be).get(),e)})),ht.set(3081,(e=>{const t=st?.();Ze(Promise.resolve(t?.name),e)})),ht.set(3015,(e=>{Ze(I.locationsForCreateQuery.bind(be,{subscriptionId:e.subscriptionId,resourceTypes:e.resourceTypes}).get(),e)})),ht.set(3080,(e=>{Ze((0,s.memoizePromise)((()=>MsPortalFx.Azure.getLocations()))(),e)})),ht.set(3037,(e=>{Ze(le.get(x.PersistentStorageSettings).writeSetting(re,e.key,e.value,e.readers),e)})),ht.set(3108,(e=>{Ze(ze().then((t=>t.readTourGuideSetting(e.key))),e)})),ht.set(3109,(e=>{Ze(ze().then((t=>t.writeTourGuideSetting(e.key,e.value))),e)})),ht.set(3110,(e=>{Ze(ze().then((t=>t.getTourGuideActiveTours(e.key))),e)})),ht.set(3111,(e=>{Ze(ze().then((t=>t.setTourGuideActiveTours(e.key,e.value))),e)})),ht.set(3112,(e=>{Ze(ze().then((t=>t.setTourGuideActivatedToursCount(e.count))),e)})),ht.set(3038,(e=>{Ze(le.get(x.PersistentStorageSettings).readSettings(e.extensionName??re,e.keys,re),e)})),ht.set(3039,(e=>{Ze(le.get(x.PersistentStorageSettings).removeSettings(re,e.keys),e)})),ht.set(3040,(e=>{Ze(le.get(x.PersistentStorageSettings).clear(re),e)})),ht.set(3041,(e=>{Ze(le.get(x.PersistentStorageSettings).getAllSettingsKeys(re),e)})),ht.set(3018,(e=>{Ze(le.get(b.AssetTypeService).getResourceTypeAssetTypeInformation(e.resourceTypes),e)})),ht.set(3019,(e=>{Ze(le.get(h.SubscriptionsUserContext).getSubscription(e.subscriptionId),e)})),ht.set(1026,(e=>{const{dashboardId:t}=e;ge.navigateWithRoute("dashboard",null,{dashboardId:t})})),ht.set(3067,(()=>{ge.goToLandingPage({interactionSource:"Blade",replaceHistory:!1})})),ht.set(3068,(()=>{$.querySelectorAll(".fxs-topbar-sidebar-collapse-button").trigger("fxtogglesidebar",{updateSettings:!0})})),ht.set(3071,(e=>{ge.route(e,{openedBy:4})})),ht.set(3043,(e=>{const{reason:t,bladeReference:s,signInParameters:i,tenantId:o}=e,n=s&&je({extensionName:s.extensionName,bladeName:s.bladeName,parameters:s.parameters,referenceType:null,menuId:null});Ze((0,D.forceSignIn)(le,{bladeReference:n,reason:t,signInParameters:i,tenantId:o},re),e)})),ht.set(1029,(async e=>{const t=e.forceSvg?{customClass:"forceSvg"}:{symbol:!0},{GetImageData:s}=await MsPortalFx.require("MsPortalImpl/Base/Base.ImageHelper");Ze(s({type:e.type,options:t},{bypassCache:!0}).then((e=>e.map((e=>e.outerHTML)).join(""))),e)})),ht.set(3020,(e=>{Ze(MsPortalFx.require("Fx/Assets/AssetTypes").then((({getAllAssetTypes:t})=>t(e))),e)})),ht.set(3240,(async e=>{const{ServiceHubsManager:t}=await MsPortalFx.require("MsPortalImpl/Services/Services.ServiceHubsManager");Ze(le.get(t).getAllServiceMenus(e).catch((()=>{})),e)})),ht.set(3117,(async e=>{const{getLatestApiVersion:t}=await MsPortalFx.require("FxHubs/ArmHelpers/ArmApisStartup");Ze(t(e.resourceId),e)})),ht.set(3005,(e=>{Ze(le.get(f.TenantsService).getTenants().then((e=>e.tenants)),e)})),ht.set(3123,(e=>{const{extensionName:t,modulePrefix:s}=e;Ze(le.get(z.ReactFederatedModules).getFederatedModulesRequireConfig(t,s).catch((()=>null)),e)})),ht.set(2e3,(e=>{ke("setIcon");const{viewModel:t}=Fe,s=t,i=s.icon(),o=(n=e.iconUri)&&(0,m.isValidUri)(n)?H.Images.ImageUri(n):null;var n;i&&o&&i.data===o.data||s.icon(o)})),ht.set(2001,(e=>{ke("setOnPin");const{stubId:s}=e,i=We(s)?()=>{const e=Promise.withResolvers();return qe(1002,{stubId:s,responseStubId:Oe((t=>{te(e,{...t,result:t.result?Y(t.result):null})}),!0)}),H.Promises.cancelOnDispose(t,e.promise)}:null,{viewModel:o}=Fe;o.setOnPinHandler(i)})),ht.set(3113,(()=>{le.getAsync(S.FullScreenMode).then((e=>{e.toggle()}))})),5!==he&&Fe.provisioningContext.then((e=>{e&&vt()})),ht.set(3008,(e=>{ke("doesProvisioning");Ze(vt().then((e=>({initialValues:e.initialValues,marketplaceItem:e.marketplaceItem,resourceGroupName:e.resourceGroupName,telemetryId:e.telemetryId,referenceType:e.referenceType}))),e)})),ht.set(3009,(async e=>{ke("validateTemplate");Ze((await vt()).validateTemplate(e),e)}));const St=Object.create(null);ht.set(3010,(async e=>{ke("deployTemplate");const t=(await vt()).deployTemplate(e),s=Promise.withResolvers();t.finally((()=>setTimeout(s.resolve,5e3))),Ze(t,e)})),ht.set(3075,(async e=>{ke("deployStack");const t=(await vt()).deployStack(e),s=Promise.withResolvers();t.finally((()=>setTimeout(s.resolve,5e3))),Ze(t,e)})),ht.set(3011,(async e=>{ke("initDeployCustom");const t=await vt(),s=Promise.withResolvers(),i=MsPortalFx.getUniqueId();St[i]=s,t.deployCustom({provisioningPromise:s.promise}),Ke(e,i)})),ht.set(3012,(e=>{St[e.deploymentId].resolve()})),ht.set(3076,(async e=>{ke("setMarketplaceId");return(await vt()).setMarketplaceId(e)})),ht.set(3013,(async e=>{ke("getArmErrorsBladeReference");const t=(await vt()).getArmErrorsBladeReference(e);Ke(e,{bladeName:t.bladeName,extensionName:t.extensionName,parameters:t.parameters})})),ht.set(3014,(async e=>{ke("getAutomationBladeReference");const t=(await vt()).getAutomationBladeReference(e);Ke(e,{bladeName:t.bladeName,extensionName:t.extensionName,parameters:t.parameters})})),ht.set(3016,(e=>{oe.resolve(e)})),ht.set(3017,(e=>{Ze(MsPortalFx.require("MsPortalImpl/UI/UI.LinkHandler").then((s=>{const i=s.getUriAndHandler(t,le,e,!1);return i.uriPromise?i.uriPromise().then((()=>FxImpl.ensureAbsoluteUri(i.uri()))):FxImpl.ensureAbsoluteUri(i.uri())})),e)})),ht.set(2002,(e=>{ke("closeCurrentBlade");const{container:t}=Fe;Ze(t.closeCurrentBlade(e.returnedData),e)})),ht.set(2003,(e=>{ke("switchMenuItem");const{id:t,parametersOrOverrideBlade:s}=e,{container:i}=Fe;i.menu.switchItem(t,s?je(s):null)})),ht.set(2004,(e=>{ke("setMenuTitleSuffix");const t=e&&e.title,s=e&&e.subtitle,{viewModel:i}=Fe,o=i.menuContent;o.title(t),o.subtitle(s)})),ht.set(2005,(e=>{ke("configureAlertOnClose");const{container:t}=Fe;e?t.form.configureAlertOnClose(ko.observable(e)):t.form.configureAlertOnClose(1)})),ht.set(3030,(t=>{if(new MsPortalFx.Base.UriBuilder(t.url).getAuthority().includes(FxImpl.origin))return;if(t.headers.Authorization&&MsPortalFx.isUriAbsolute(t.url)){if(!FxImpl.getDomainValidator(t.extTrustedDomains,!0).validateDomain(t.url)){const s=new MsPortalFx.Base.UriBuilder(t.url).getAuthority().toLowerCase(),i="Security issue: Request to send auth token to untrusted domain '{0}'. Only a fixed set of domains should be configured to receive auth tokens. Command name: {1}".format(s,t.headers["x-ms-command-name"]||"<not provided>");if(FxImpl.isDevelopmentMode||Le)return(0,p.logToExtension)(e,re,1,i),new Response(i,{status:403,statusText:i});(0,p.logToExtension)(e,re,2,i)}}Ze((async()=>{const e=await window.fetch(t.url,{headers:new Headers(t.headers),method:t.method,body:t.body}),s={};e.headers.forEach(((e,t)=>{s[t]=e}));const i=await e.text();return{responseHeaders:s,responseText:i,status:e.status,statusText:e.statusText}})(),{responseStubId:t.responseStubId})})),ht.set(3098,(e=>{(async()=>{const e=await MsPortalFx.require("MsPortalImpl/Services/Services.CopilotManager");return le.get(e.CopilotBrokerService)})().then((t=>t.postActivity(e)))})),ht.set(3061,(async e=>{const{getResourceFromArg:s}=await MsPortalFx.require("FxHubs/ArtHelpers/ResourceHoverCardHelpers");Ze(s(e.manifestColumns,e.projectedColumns,e.browseQuery,e.armId,e.resourceId,e.assetTypes,e.locations,e.directoriesMap,t),e)})),ht.set(3062,(async e=>{const t=await c.ArtBrowse.getBrowsePrereqsEndpoint.invoke(FxImpl.Rpc.client,"fxw",{...e});Promise.all([MsPortalFx.require("FxHubs/ArtHelpers/ResourceHoverCardHelpers"),MsPortalFx.require("FxHubs/ArtHelpers/ArgBrowseHelpers"),MsPortalFx.require("FxHubs/ResourceCommands/BrowseBulkCommandConfig")]).then((([{defaultProperties:s},{columnIdToArgColumn:i,columnIdToStringMap:o},{BulkCommandDefinitions:n}])=>{Ke(e,{browsePrereqs:t,bulkCommandDefinitions:n,defaultProperties:s,columnIdToStringMap:o,columnIdToArgColumn:i})}))})),ht.set(3093,(e=>{e?window.sessionStorage.setItem(F.SESSION_STORAGE_THROTTLE,Ee.id):window.sessionStorage.removeItem(F.SESSION_STORAGE_THROTTLE)})),ht.set(3063,(e=>{MsPortalFx.require("FxHubs/ResourceCommands/BrowseBulkCommandImpl").then((({BulkCommandImpl:s})=>{new s(t,"ResourceHoverCard",{resourceType:e.resourceType,hasSelectedItems:ko.observable(!0),selectedBrowseItems:ko.observable([{name:e.resourceName,id:e.resourceId,type:e.resourceType}])},e.commandDefinition).execute({button:6})}))})),ht.set(3064,(e=>{Ze(c.AssetTypes.isResourceFavoriteEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",{resourceId:e.resourceId}),e)})),ht.set(3065,(e=>{Ze(c.AssetTypes.removeFavoriteResourceEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",{resourceId:e.resourceId,telemetrySource:e.telemetrySource}),e)})),ht.set(3066,(e=>{Ze(c.AssetTypes.addFavoriteResourceEndPoint.invoke(FxImpl.Rpc.client,"HubsExtension",{...e}),e)})),ht.set(3241,(e=>{try{const s=le.get(w.ResourceFilterManager);st=s.currentFilterObservable,Ke(e,(0,n.evaluate)(t,s.filters))}catch{Ke(e,[])}})),ht.set(3242,(e=>{le.get(w.ResourceFilterManager).activateFilter(e)})),ht.set(3243,(e=>{MsPortalFx.require("MsPortalImpl/Services/Services.SubscriptionsDeferred").then((({fetchFilteredSubscriptions:t})=>{Ze(t(le,e.filter).then((e=>e?.subscriptions)),e)}))})),(0,P.registerBrowseHandlers)(ht,Ze,Ke,t,le,be);const It=le.get(C.PortalIdleStateService);let Pt;if(ht.set(3052,(()=>It.signalBusy(1,he))),ht.set(3051,(()=>It.signalIdle(1))),!Z){Pt=fe.registerChangeListener((e=>{qe(3024,e)})),ht.set(3021,(e=>{fe.setItem(e)})),ht.set(3022,(e=>{fe.removeItem(e)})),ht.set(3023,(e=>{fe.clear(e)})),be.subscribe((e=>{qe(3115,e)})),ht.set(3116,(e=>{be.setEntry(e)})),ht.set(3031,(e=>{Ze(Promise.resolve({uri:xe(e.uri,re)}),e)})),ht.set(3035,(e=>{["keyup","keydown"].includes(e.type)&&window.document.dispatchEvent(new KeyboardEvent(e.type,e.event))})),ht.set(3044,(e=>{ke("setContextPaneWidth");const{setContextPaneWidth:t}=Fe;t?.(e)})),ht.set(3045,(e=>{Ze(G.invoke(FxImpl.Rpc.client,"HubsExtension",{}),e)})),ht.set(3047,(e=>{MsPortalFx.require("Fx/ResourceManagement").then((({addRecentResource:t})=>t(e)))})),ht.set(3048,(e=>{Ze(le.getAsync(o.get("MsPortalImpl/UI/UI.SupportContext","SupportContext")).then((t=>t.hasMenuItem(e.menuId))),e)})),ht.set(3049,(e=>{Ke(e,it())})),ht.set(3050,(async e=>{const t=MsPortalFx.clone(await lt.promise,!0);if(t?.data){const e=t.data;delete e.ajaxCalls,delete e.longTasks}const{bladeTelemetryData:s}=Fe;W.usingState((()=>{ut({name:Ae,source:"AzHost",action:"ReactViewReady",actionModifier:"complete",extension:re,data:{...e.profileData,...t&&{lighthouse:t},experiments:e.experiments,startupMetrics:e.startupMetrics,frameId:Ce,versions:e.versions,...s?.openedBy&&{openedBy:s.openedBy},...s?.openedByBladeName&&{openedByBladeName:s.openedByBladeName}},duration:e.duration}),U.trace({name:Ae,action:"ReactViewDependencies",source:"AzHost",extension:re,data:{dependencies:e.dependencies}})}),ie)})),ht.set(3057,(e=>{Ze((async()=>{(await le.getAsync(o.get("MsPortalImpl/UI/UI.HelpPane","HelpPane"))).open(e,ie)})(),e)})),ht.set(3058,(t=>{let s;MsPortalFx.isFeatureEnabled("azureconsole")?s=le.getAsync(o.get("MsPortalImpl/UI/UI.AzureConsole","AzureConsole")).then((e=>e.executeInCloudShell(t,ie))).catch((e=>(K.error(FxImpl.createError("Failed to execute in CloudShell",{innerErrors:e})),!1))):((0,p.logToExtension)(e,re,1,"Azure Console feature is not enabled in this environment."),s=Promise.resolve(!1)),Ze(s,t)}));const t=e=>{const t=e?.featureGates.reduce(((e,t)=>{const[s,i]=t.split("X");return e[s]=i,e}),{})||{};return{instanceId:e.instanceId,data:{...e.data,featureFlags:t},lighthouseMetrics:e.LighthouseMetrics}},s=async(...e)=>{const{KustoClient:t,QueryType:s}=await MsPortalFx.require("MsPortalImpl/Services/Kusto/KustoClient"),i=await le.getAsync(t);return i.getPrimaryData.apply(i,[s[e[0]],e[1],e[2]])};ht.set(3069,(e=>{Ze(s("LoadLighthousePerfProfiles",gt(e),!0).then((e=>e.data.map(t))),e)})),ht.set(3070,(e=>{const i=e.instanceId;Ze(s("LoadLighthousePerfProfile",{tableName:mt(),instanceId:i},!0).then((e=>{if(1===e.data.length)return t(e.data[0]);throw new Error("Load failed")})),e)})),ht.set(3086,(e=>{Ze(Promise.all([s("LighthouseTimelineSummary",gt(e),!0),s("LighthouseScoreSummary",gt(e),!0)]).then((([e,t])=>{const s=e.data,[i]=t.data;return{profileData:s,lighthouseMetrics:i}})),e)})),ht.set(3089,(()=>{const e=MsPortalFx.Resources.Strings.Azure.Subscriptions.DropDown,t=MsPortalFx.ViewModels.getValidationResultPromise;return async s=>{const i=s.subscription,{canRegisterSubscriptionWithRPs:o}=await MsPortalFx.require("FxInternal/ResourceManagement/ArmTemplate");try{const n=await o(le,i.subscriptionId,s.resourceProviders);if(n.success)return Ze(t(),s);{const o=i.uniqueDisplayName||i.subscriptionId,r=n.disallowedRPs||[];return r.length?Ze(t(e.subDisallowedRP.format(o,r.join(", "))),s):Ze(t(e.subCantRegisterWithRP.format(o,n.failedRPs.join(", "))),s)}}catch(e){return t()}}})()),ht.set(3237,(e=>{(0,A.switchTenantImpl)({tenant:e.tenant,telemetrySource:e.telemetrySource,diContainer:le})})),ht.set(3238,(e=>{(0,A.redirect)({diContainer:le,hash:e.hash,reason:e.reason,telemetrySource:e.telemetrySource,tenant:e.tenant})})),ht.set(3125,(e=>{(0,A.requestNavigationToTrustedUrlImpl)({url:e.url,diContainer:le,source:Ee.id},{forceRelogin:e.forceRelogin})})),ht.set(3079,(e=>{Ne&&window.removeEventListener("message",Ne),window.addEventListener("message",Ne=t=>{const{signature:s,href:i}=t.data;if("OAuthRequest"===s&&"string"==typeof i){Ze(new Promise((e=>{const s=t.source.opener,o=t.origin,n=window.location.origin,r=s?.parent?.parent,a=/\/extensionname\/(\w+)(?=[^a-z0-9])/i.exec(i)?.[1]||"";s===ue&&o===n&&r===window&&a.toLowerCase()===re.toLowerCase()?e(i):e("")})),e)}})})),ht.set(3083,(e=>{Ze(s("LoadLighthousePerfProfilesMetadata",gt(),!0).then((({data:e})=>({shellVersions:e[0].shellVersions,extensionVersions:e[0].extensionVersions}))),e)})),ht.set(3100,(e=>{MsPortalFx.require("MsPortalImpl/Services/Services.CopilotInteractions").then((({processCopilotInteraction:t})=>{Ze(t(le,e),e)}))})),ht.set(3101,(e=>{Ze(MsPortalFx.require("MsPortalImpl/Services/Services.CopilotManager").then((({CopilotBrokerService:t})=>le.get(t).nudgeCopilot(e.internal))),e)})),ht.set(3102,(e=>{Ze(MsPortalFx.require("MsPortalImpl/Services/Services.CopilotManager").then((({CopilotBrokerService:t})=>le.get(t).addViewContextAdditionalDetailsCopilot({bladeId:Ae,...e}))),e)})),(()=>{const e=e=>{const t=Promise.withResolvers();return()=>(qe(1002,{stubId:e,responseStubId:Oe((e=>{te(t,{...e,result:e.result?je(e.result):null})}),!0)}),t.promise)};ht.set(3104,(t=>{Se.render(t,e)})),ht.set(3105,(t=>{Se.update(t,e)})),ht.set(3106,(({error:e,handled:t})=>{at(null),Se.onFailed(e,t)}))})()}let _t=MsPortalFx.noop,Ft=MsPortalFx.noop,Tt=MsPortalFx.noop;return{initialize:e=>{const{setOnMessage:i,reactViewOptions:n,getFirstHiddenOrOfflineTime:r}=e;if(({postMessage:qe}=e),n){const{dispose:e,onUnloaded:i,hide:l,show:c}=n,d=Promise.withResolvers();let p;ht.set(3034,(()=>{d.resolve(void 0)}));let u,m,g=!1;ht.set(3053,(({data:e,complete:t,valid:s})=>{p=e,t&&h(!1,s),!g&&p&&"FirstContentfulPaint"in p&&(g=!0,Pe())})),ht.set(3126,(e=>{ct.resolve(e)})),ht.set(3054,(e=>{u=e})),Promise.all([ct.promise,Promise.race([dt.promise,(0,s.delay)(9e4,u)])]).then((e=>{const t=e[0].data,s=[t.CLS?.value,t.FCP,t.LCP,u],i=s.every(Boolean),o=i?s.reduce(((e,t)=>e+t.score),0):null;ut({name:Ae,source:"Shell",action:"BladeLighthouse10",duration:o,actionModifier:i?"complete":"cancel",data:{version:2,INP:u,CLS:t.CLS,FCP:t.FCP,LCP:t.LCP}})}));const h=(e,t)=>{m||(m=!0,lt.resolve(t?p:null),5!==he&&FxImpl.TelemetryContext.usingState((()=>{const s=r(),i=p?.data?.interactiveTime,o=(s&&i&&s<i)??!1,n=!e&&t&&!o;pt()&&FxImpl.Extension.onReactViewInteractiveEndPoint.invoke(FxImpl.Rpc.client,re,{bladeInstanceId:Ee.instanceId,time:n?i:void 0}),ut({name:Ae,source:"Shell",action:"BladeLighthouse",actionModifier:n?"complete":"cancel",extension:re,duration:p?.data?.score,data:{...p,data:{...p?.data,ajaxCallCount:p?.data?.ajaxCalls?.length||0,ajaxCalls:function(e){const t=[];if(e?.ajaxCalls){const s={},i={};for(const o of e.ajaxCalls){const{name:e,nameIsUrl:n,startTime:r,duration:l}=o,c=n?(0,a.scrubUri)(e)||"REDACTED_URL":e,d=(s[c]||0)+1;s[c]=d,d<=Q?t.push({name:c,startTime:r,duration:l}):i[c]?i[c].duration+=l:i[c]={name:c,startTime:r,duration:l}}for(const e of Object.values(i)){const{name:i,startTime:o,duration:n}=e;t.push({name:`${i} [${s[i]-Q} more calls]`,startTime:o,duration:n})}}return t.slice(0,X)}(p?.data),hiddenOrOfflineDuringRendering:o}}})}),ie))},f=32&(5!==he&&le.get(E.BladeDescriptor)?.flags)?le.getAsync(o.get("MsPortalImpl/UI/UI.HelpPaneState","HelpPaneState")):void 0,x=async(t=!1)=>{const o=void 0!==f&&(await f).isMinimized();Pt&&Pt(),qe(3033,{waitForPendingPromises:!t,isMinimized:o});const n=d.promise.then((()=>{e(),Xe.dispose()})),r=(0,s.delay)(1e3).then((()=>h(t)));dt.resolve(u),await Promise.allSettled([n,r]),i()};ht.set(3087,(e=>{W.usingState((()=>{O.Telemetry.trace({...e,extension:re,source:Ee.id})}),ie)})),_t=l,Ft=c,Tt=e=>{e&&oe.resolve(e),l(),x(!0)},t.registerForDispose({dispose:()=>{const e=[];MsPortalFx.forEachKey(St,((t,s)=>e.push(s.promise))),Promise.allSettled(e).finally((()=>{x()}))}})}i(rt),Ve.forEach((e=>qe(e.kind,e.data)))},toggleDevTools:()=>qe(3046),toggleTelemetryInsights:e=>qe(3088,e),showTours:e=>qe(3107,e),executeCopilotHandler:(e,s,i)=>{const o=Promise.withResolvers();return qe(3097,{handlerId:e,conversationId:s,handlerArguments:i,responseStubId:Oe((e=>{ee(o,e)}),!0)}),H.Promises.cancelOnDispose(t,o.promise)},togglePerfTools:()=>{const e=Promise.withResolvers();return qe(3056,{responseStubId:Oe((t=>{ee(e,t)}),!0)}),H.Promises.cancelOnDispose(t,e.promise)}}};var H=MsPortalFx.Base,O=MsPortalFx.Base.Diagnostics,U=O.Telemetry,W=FxImpl.TelemetryContext,V=MsPortalFx.Parts.PartSize,q=MsPortalFx.Composition.PartReference,j=MsPortalFx.Errors.Error,G=c.AssetTypes.getRecentResourcesEndPoint;const K=H.Diagnostics.createLog(e),J=U.Context.getBladeContext,Q=10,X=100,Z=window.azTestHooks;function Y(e){const{extensionName:t,partName:s,parameters:i,initialSize:o,resourceId:n}=e;if(n)return e;let r,a,l;return"number"==typeof o?r=o:o&&(r=V.Custom,a=o.height,l=o.width),new q(s,i||{},{extensionName:t,initialSize:r,initialHeight:a,initialWidth:l})}function ee(e,t){"result"in t?e.resolve(t.result):e.reject(new Error(t.error))}function te(e,t){t.result?e.resolve(t.result):e.reject(new Error(t.error))}function se(e,t){let s;try{s=JSON.stringify(e,((e,t)=>{let s=t;return j.isBaseOf(t)?s={message:t.message,stack:t.stack,isError:!0,statusText:t.data?.statusText,status:t.data?.status,requestId:t.data?.requestId,uri:t.data?.uri}:t instanceof Error&&(s={message:t.message,stack:t.stack,isError:!0}),s}))}catch(e){s="<Failed to serialize error>",t&&(s=JSON.stringify({message:s}))}return s}})),
define("MsPortalImpl/Base/Base.HomeView",["require","exports"],(function(e,t){"use strict";t.HomeViewMap=void 0;t.HomeViewMap={startup:"#view/Microsoft_Azure_Startups/AzureForStartups.ReactView"}})),
define("MsPortalImpl/Base/Base.KnockoutExtensions",["require","exports"],(function(e,t){"use strict";const s="fxs-display-none",i=ko.bindingHandlers,o=ko.virtualElements.allowedBindings,n=ko.utils,r=n.domData,a=MsPortalFx.wrap({controlsDescendentBindings:!0});i.commands={update:function(e,t,s,i,o){const r=ko.unwrap(t());if(r&&r.group){const t=$(e),s=e=>{const s=ko.unwrap(r.viewModel),i=$.Event("rightclick",{target:e.target,clientX:e.clientX,clientY:e.clientY});t.trigger(i,{commandGroup:r.group,viewModel:s,entityType:2}),e.preventDefault(),e.stopPropagation()};t.on("fxcontextmenurequest",s),n.domNodeDisposal.addDisposeCallback(e,(e=>{t.off("fxcontextmenurequest",s)}))}}},i.visible={update:function(e,t){const i=ko.unwrap(t()),o=e.classList;o?o.toggle(s,!i):$(e).toggleClass(s,!i)}},i.keyedCss={update:function(e,t){const s=[],i=[];MsPortalFx.forEachKey(ko.unwrap(t()),((t,o)=>{const a=ko.unwrap(o);if("string"!=typeof a)MsPortalFx.forEachKey(a,((e,t)=>{ko.unwrap(t)?s.push(e):i.push(e)}));else{t="_fxCss_"+t;const o=r.get(e,t)||[],l=a.split(" ").filter(MsPortalFx.identity)||[];n.compareArrays(o,l,{sparse:!0}).forEach((e=>{void 0===e.moved&&("added"===e.status?s.push(e.value):"deleted"===e.status&&i.push(e.value))})),r.set(e,t,l)}})),$(e).removeClass(i.join(" ")).addClass(s.join(" "))}},o.vtext=o.text,i.vtext=i.text,o.text=!1,i.text={init:a,update:function(e,t){let s=ko.unwrap(t());s=void 0===s?"":s,e.textContent=s}}})),
define("_generated/Less/MsPortalImpl/Widgets/CopyField.css",["module"],(function(e){"use strict";return{css:".fxs-copyfield{display:none;position:absolute;width:24px;top:0;right:0}.fxs-copyfield .fxc-copyablelabel{padding:0;margin:-3px 0 -3px -.5px}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox{display:none}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{padding:0;border:0;margin:0;height:auto;background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button{padding:2px 1px 0;margin:0;background-color:transparent;outline-width:1px}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button:hover{background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button svg{height:90%;width:90%}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button .fxc-copyablelabel-copyimage{height:22px;width:22px}.fxs-copyfield-container .fxs-copyfield-wrapper{position:absolute;top:0;right:0;width:24px;height:24px}.fxs-copyfield-container .fxs-copyfield{display:block}.fxs-copyfield-container.fxs-copyfield-copied .fxc-copyablelabel{padding-right:24px}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield-wrapper{width:100%}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield{width:100%}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-textbox{display:block}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-copybutton{margin-right:-24px}.fxs-part-resourcesummary .fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{font-size:13px}.fxs-mode-light .fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton:focus-visible{outline:1px solid #605e5c}.fxs-mode-dark .fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton:focus-visible{outline:1px solid #fff}",moduleId:e.id}})),
define("MsPortalImpl/Base/Base.KnockoutExtensions.Copy",["require","exports","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Widgets/Widgets.Common","Fx/Controls/CopyableLabel","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/CopyField.css"],(function(e,t,s,i,o,n,r){"use strict";t.CopyField=void 0,t.initializeCopyBinding=d;var a=FxImpl.TriggerableLifetimeManager,l=MsPortalFx.Base;(0,n.injectCss)(r);l.Diagnostics.createLog(e);const c="opacity";t.CopyField=void 0;function d(e,t,n,r){const l=$(e),d=r||new a,p=function(e,t,n,r,a){const l="fxs-copyfield",d="fxs-copyfield-copied",p=$(t),u=$(FxImpl.createElement("div",{class:`${l}-wrapper`,"data-bind":"stopBindings: true"})),m=$(FxImpl.createElement("div",{class:l,"data-bind":"pcCopyableLabel: $data"}));m.appendTo(u),u.appendTo(p);const g=o.create(e,r);return g.readOnly(!0),ko.reactor(e,(()=>{const e=ko.unwrap(n);g.value(e),p.toggleClass("fxs-copyfield-container",!MsPortalFx.isNullOrWhiteSpace(e))})),ko.applyBindingsToDescendants(g,u[0]),e.registerForDispose([p.setEvents(["fxcopybuttonclick",()=>{p.addClass(d)}],["mouseleave",()=>{p.removeClass(d)}]),()=>{u&&(a||ko.utils.cleanDescendantNodes(u),u.remove())}]),s.isIeOrEdgeNonChromium&&i.waitForBindings(m[0]).then((()=>{const t=m.find(".fxc-copyablelabel-copybutton");e.registerForDispose([t.setEvents(["keydown",e=>{const s=e.which;if(13===s||32===s){t.focus();const e=t.find(".fxc-copyablelabel-clicked")[0];e&&ko.contextFor(e).$ctl._showClickedTooltip()}}])])})),m.css(c,"0"),m}(d,e,t,n,!!r);let u=!1;const m=ko.observable(!1),g=ko.observable(!1);d.registerForDispose(l.setEvents(["focusin",()=>{m(!0)}],["focusout",()=>{m(!1)}],["mouseenter",()=>{g(!0)}],["mouseleave",()=>{g(!1)}])),ko.computed(d,[m,g],((e,t)=>{const s=e||t;s!==u&&(e=>{u=e,p.css(c,e?"1":"0")})(s)})),r||ko.utils.domNodeDisposal.addDisposeCallback(e,(()=>d.dispose()))}ko.bindingHandlers.copy={init:(e,t)=>d(e,t())}})),
define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding",["require","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.ImplUtils"],(function(e,t,s){"use strict";MsPortalFx.Base.Diagnostics;const i=ko.bindingHandlers;function o(s,i,o,n){const r=function(s,i,o,n){if(i&&"object"==typeof i){const r={};return Object.getOwnPropertyNames(i).forEach((a=>{if(!MsPortalFx.isSerializableProperty(a))return;const l=ko.unwrap(i[a]);if(t.getAllowListedAttr().includes(a))r[a]=l||null;else switch(a){case"href":if(l){const c="string"!=typeof l?i:t.sanitizeLinkUri(l,{diContainer:s,localRequire:e,windowContext:n});!1!==c?r[a]=c:o.push(`The value "${l}" is not a valid absolute URI or deep link, which should start with "http://" or "https://" or "#".`)}else r[a]=null;break;case"poster":case"src":l?t.validateUriOrBlank(l,null,{diContainer:s,localRequire:e,windowContext:n})||"src"===a&&t.validateDataImage(l)?r[a]=l:o.push(`The value "${l}" is not a valid absolute URI, which should start with "http://" or "https://", nor a valid "data:image" entry.`):r[a]=null;break;default:o.push("The attribute '{0}' is not allowed.".format(a))}})),r}return null}(s,ko.unwrap(i()),o,n);return()=>r}i.sanitizedAttr={init:function(e,t,s,n,r){const a=i.attr;if(a.init){const i=o(r.$dicontainer,t,[],e);return a.init(e,i,s,n,r)}return null},update:function(t,n,r,a,l){const c=[];try{const e=o(l.$dicontainer,n,c,t);return i.attr.update(t,e,r,a,l)}catch(e){c.push(e)}finally{if(c.length>0){const i=c.reduce(((e,s)=>{const i=t.getAttribute("data-bind")||"None";return e+="Sanitization error found in 'sanitizedAttr' binding\nTag name: {0}; Binding attribute: \"{1}\"\nMessage: {2}".format(String(t.tagName),i,s)+"\n"}),"");s.logToExtension(e,t,2,i)}}}}})),
define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding",["require","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Base/Base.ImplUtils"],(function(e,t,s){"use strict";const i="Sanitization error found in 'sanitizedCss' binding\nTag name: {0}; Binding attribute: \"{1}\"\nDisallowed class name(s): {2}",o=ko.bindingHandlers,n=o.css;function r(e,s){const i=function(e,s){if(e&&"object"==typeof e){const i={};return Object.getOwnPropertyNames(e).forEach((o=>{MsPortalFx.isSerializableProperty(o)&&(t.isAllowedCssClassName(o)?i[o]=e[o]:o&&s.push(o))})),i}{const i=String(e||"").split(" ");return Array.prototype.map.call(i,(e=>(e=String(e||""),t.isAllowedCssClassName(e)?e:(e&&s.push(e),"")))).join(" ")}}(ko.unwrap(e()),s);return()=>i}o.sanitizedCss={init:function(e,t,s,i,o){if(n.init){const a=r(t,[]);return n.init(e,a,s,i,o)}return null},update:function(t,o,a,l,c){const d=[],p=r(o,d);return d.length&&function(t,o,n){const r=o.getAttribute("data-bind")||"None",a=i.format(String(o.tagName),r,n.join(", "));(0,s.logToExtension)(e,o,2,a,{diContainer:t})}(c.$dicontainer,t,d),n.update(t,p,a,l,c)}}})),
define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding",["require","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","Fx/DependencyInjection"],(function(e,t,s){"use strict";const i=ko.bindingHandlers,o=i.html;i.sanitizedHtml={init:function(e,t,s,i,n){return o.init(e,t,s,i,n)},update:function(i,n,r,a,l){let c=ko.unwrap(n());null==c&&(c="");const d=c.toString().substring(0,1e5),p=s.container.get(t.KODeniedTemplateSanitizer).sanitize({value:d,localRequire:e,windowContext:i,diContainer:l.$dicontainer||s.container}),u=MsPortalFx.wrap(p.sanitizedMarkup);return o.update(i,u,r,a,l)}},i.html=i.sanitizedHtml})),
define("MsPortalImpl/Base/Base.Pipeline",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","Fx"],(function(e,t,s,i,o){"use strict";t.PipelineDescriptor=t.Pipeline=void 0,t.Step=function(e){return function(t,s,i){const o=Reflect.getOwnMetadata("fximpl:pipelinesteps",t)||[];o[e]=s,Reflect.defineMetadata("fximpl:pipelinesteps",o,t)}},t.Task=void 0,t.createDescriptor=function(e,t,s){return new l(e,t,s)},t.createPipelineInstance=d;var n=MsPortalFx.Base.Promises.cancelOnDispose;let r=1,a=t.Task=class{};t.Task=a=__decorate([__metadata("fx:diagnostics",[e,"Task"]),s.Value("pipeline")],a);class l{constructor(e,t,s){this.configurationClass=e,this.resourcesClass=t,this.taskArgsClass=s,this._pipelineFactories=[]}register(e){this._registerFactory((t=>this._createInstance(t,e)))}registerAsync(e,t,s,o=0){this._registerFactory(((o,r,a,l,c)=>{if(s(a,l,c))return n(r,i.get(e,t)).then((e=>this._createInstance(o,e)))}),o)}registerFactory(e,t=0){this._registerFactory(((t,s,i,n,r)=>{function a(t){return{factory:e,steps:t||[]}}const l=e(t,s,i,n,r);return o.isPromiseLike(l)?l.then((e=>a(e))):a(l)}))}_registerFactory(e,t=0){const s=this._pipelineFactories.length&&this._pipelineFactories[t]||[];s.push(e),this._pipelineFactories[t]=s}registerAsyncFactory(e,t,s,i){this._registerFactory((function(o,n,r,a,l){return s(r,a,l)?MsPortalFx.require(e,i).then((e=>({factory:t,steps:t(n,e,r,a,l)}))):void 0}))}getHandlers(e,t,s,i,o,n=0){return(this._pipelineFactories[n]||[]).map((n=>n(e,t,s,i,o)))}getRegisteredStepsCount(){return(this._pipelineFactories||[]).length}createPipeline(e,t,s,i){return d(e,t,this,s,i)}_createInstance(e,t){if(e.isDisposed())throw new MsPortalFx.Errors.CanceledError;const s=e.get(t);return{factory:t,steps:(Reflect.getOwnMetadata("fximpl:pipelinesteps",t.prototype)||[]).map((e=>(t,i)=>s[e](t,i)))}}}t.PipelineDescriptor=l;class c{constructor(e,t,s,i,o){this._diContainer=e,this._lifetime=t,this._descriptor=s,this._configuration=i,this._resources=o}async startTask(e){const t=this._descriptor,s=this._lifetime.createChildLifetime(),i=this._diContainer.createChildContainer("pipeline"),n=r++,l=ko.observable(!1),c={pipeline:this,indicateTaskComplete:()=>{l(!0)},taskId:n,lifetime:s};i.set(a,c),t.configurationClass&&i.set(t.configurationClass,this._configuration),t.resourcesClass&&i.set(t.resourcesClass,this._resources),t.taskArgsClass&&i.set(t.taskArgsClass,e);const d=n=>function(e,t,s,i,n,r,a){const l=t.getHandlers(s,i,n,r,a,e).filter((e=>!!e));let c;return l.forEach(((e,t)=>{o.isPromiseLike(e)&&(c||(c=[]),c[t]=e.then((e=>{l[t]=e})))})),c?Promise.all(c.filter((e=>!!e))).then((()=>l.filter((e=>!!e)))):l}(n,t,i,s,this._configuration,this._resources,e);function p(e,t){function s(s){s.forEach((s=>{s.steps.forEach(((s,i)=>{if(i>=t){const t=e[i]||{step:i,handlers:[]};t.handlers.push(s),e[i]=t}}))}))}const i=d(t);return i instanceof Array?void s(i):i.then(s)}let u=d(0);o.isPromiseLike(u)&&(u=await u),await(async n=>{const r=function(e){const t=[],s=Math.max(...e.map((e=>e.steps.length)));for(let i=0;i<s;i++)e.forEach((e=>{if(e.steps[i]){const s=t[i]||{step:i,handlers:[]};s.handlers.push(e.steps[i]),t[i]=s}}));return t}(n);let a,d=!0;try{await async function(e,t,s,i,n,r,a,l){const c=new Promise((e=>{r.registerForDispose(e)}));n.registerForDispose((()=>s(!0)));const d=Math.max(e.length,l);for(let n=0;n<d&&!s();n++){if(!s()&&n){const t=a(e,n);t&&await Promise.race([t,c])}if(e[n])for(let r=0;r<e[n].handlers.length&&!s();r++){const s=e[n].handlers[r](i,t);o.isPromiseLike(s)&&await Promise.race([s,c])}}}(r,e,l,c,this._lifetime,s,p,t.getRegisteredStepsCount())}catch(e){d=!1,a=e}finally{if(await i.disposeAsync().then((()=>s.dispose())),!d)throw a}})(u)}}function d(e,t,s,i,o){return new c(e,t,s,i,o)}t.Pipeline=c})),
define("MsPortalImpl/UI/UI.ContextPane",["require","exports","Fx/DependencyInjection","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Portal.init","Weave","FxInternal","Fx/Experimentation"],(function(e,t,s,i,o,n,r,a,l,c){"use strict";t.ShellContextPane=t.RightContextPane=t.DockedContextPane=t.ContextPaneImpl=t.ContextPane=void 0;var d=MsPortalFx.Base.Diagnostics.Telemetry;class p{}t.ContextPane=p;class u{constructor(e,t){this._viewModel=t,this._onMinimizeCallbacks=$.Callbacks(),this._allowFullScreenResize=!1,this.opened=this._viewModel.opened,this.loading=this._viewModel.loading;const s={dismissFn:()=>{this.close()},logName:"contextPane"},o=(0,r.getPortalViewModel)(e);l.tryImmediateResolve(o.onWidgetCreate(),(()=>{const e=this._containerLifetime=t.getWidget().ltm;this._contentLifetime=e.createChildLifetime(),(0,a.subscribeAndRun)(e,[t.opened],(e=>{e?i.register(s):i.unregister(s)})),o.customEvents.addHandler(e,"fxdeeplinkchanged",(()=>{this._handleNavigationChanged()}))})),t.close=e=>{e.stopPropagation(),this.close()},t.getWidget()&&t.getRootElement().on("minimized",(()=>{this._viewModel.enableResize&&d.trace({source:"Shell",action:"SideCarMinimized",data:{}}),this._onMinimizeCallbacks.fire()})),t.getWidget()&&t.getRootElement().on("maximized",(()=>{const e=t.getWidget().getDockedSideBarWidth();t.getWidget().element.width($.querySelectorAll(".fxs-portal-region").width()-e),t.getWidget().element.addClass("fxs-contextpane-docked-maximized"),t.getRootElement().find(".fxs-blade-restore").removeClass("fxs-display-none"),t.getRootElement().find(".fxs-blade-maximized").addClass("fxs-display-none"),d.trace({source:"Shell",action:"SideCarMaximized",data:{}})})),t.getWidget()&&t.getRootElement().on("restore",(()=>{const e=t.getWidget().getContextPaneWidth();t.getWidget().element.width(e+"px"),t.getWidget().element.removeClass("fxs-contextpane-docked-maximized"),t.getWidget().element.removeClass("fxs-contextpane-docked-resized"),t.getRootElement().find(".fxs-blade-maximized").removeClass("fxs-display-none"),t.getRootElement().find(".fxs-blade-restore").addClass("fxs-display-none"),d.trace({source:"Shell",action:"SideCarRestored",data:{}})})),e.get(c.Experimentation).extensionAssignments.whenAvailable().then((e=>{this._allowFullScreenResize=e.getBooleanValue("allowfullscreenresize")}))}hasContent(e){return this._contentProvider===e}getContent(){return this._contentProvider}get contentLifetime(){return this._contentLifetime}tryOpen(e,t,s){if(this._contentProvider===e)return this._viewModel.getWidget().setFocus(),Promise.resolve(!0);const i=!!t||this._tryRemoveContent();if(i){this._contentProvider=e,t?this._contentProviderStack.push(e):this._contentProviderStack=[e],this._previouslyFocusedElement=document.activeElement;const n=this._viewModel;return n.opened(!0),n.loading(!0),e.onAddingContent(this._viewModel,t).finally((()=>o.waitForBindings(this._viewModel.getRootElement()[0]).finally((()=>{const e=n.getWidget();if(n.enableResize(s??!1),e.element.hasClass("fxs-portal-contextpane-docked")&&e.element.removeAttr("style"),this._allowFullScreenResize){n.enableFullScreenResize=!0;const t=e.element.findByClassName("fxs-blade-maximized");t?.removeClass("fxs-display-none")}n.loading(!1)})))).then((()=>(this._viewModel.getWidget().setFocus(),i)))}return Promise.resolve(i)}close(e){if(!this._contentProvider)return!0;let t=!0;if(e?this._clearContent():t=this._tryRemoveContent(),t){const e=this._viewModel;0===e.childElementCount.value&&e.opened(!1),e.loading(!1),this._restoreFocus()}return t}onMinimized(e){this._onMinimizeCallbacks.add(e)}_clearContent(){const e=this._contentProvider;e&&e.onRemovingContent(this._viewModel),this._contentProviderStack.pop(),0===this._contentProviderStack.length?this._contentProvider=null:this._contentProvider=MsPortalFx.last(this._contentProviderStack);const t=this._contentLifetime;t&&(t.dispose(),this._contentLifetime=this._containerLifetime.createChildLifetime())}_tryRemoveContent(){const e=this._contentProvider;if(!e)return!0;const t=!e.canRemoveContent||e.canRemoveContent();return t&&this._clearContent(),t}_restoreFocus(){const e=this._previouslyFocusedElement;if(e){let t=$(e).closest(".fxs-blade");if(t.length){t=t.parent().children(".fxs-blade").last();const e=n.Widget.getWidgets(t),s=e.length&&e[0];if(s?.setFocus)return void s.setFocus()}(document.activeElement===document.body||$.contains(this._viewModel.getRootElement()[0],document.activeElement))&&e.focus()}}_handleNavigationChanged(){if(this._viewModel.opened.value){const e=this._viewModel.getWidget();if(e){const t=e.element;t.hasClass("fxs-portal-contextpane-docked")&&t.hasClass("fxs-contextpane-docked-maximized")&&this._viewModel.getRootElement().trigger("restore")}}}}t.ContextPaneImpl=u;class m extends p{static create(e){const t=(0,r.getPortalViewModel)(e);return new u(e,t.rightContextPane)}}t.RightContextPane=m,__decorate([__metadata("fx:diagnostics",[e,"RightContextPane"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container]),__metadata("design:returntype",m)],m,"create",null);class g extends p{static create(e){const t=(0,r.getPortalViewModel)(e);return new u(e,t.shellContextPane)}}t.ShellContextPane=g,__decorate([__metadata("fx:diagnostics",[e,"ShellContextPane"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container]),__metadata("design:returntype",g)],g,"create",null);class h extends p{static create(e){const t=(0,r.getPortalViewModel)(e);return new u(e,t.dockedContextPane)}}t.DockedContextPane=h,__decorate([__metadata("fx:diagnostics",[e,"DockedContextPane"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container]),__metadata("design:returntype",h)],h,"create",null)})),
define("MsPortalImpl/Base/Telemetry",["require","exports"],(function(e,t){"use strict";t.isDesktopTraceEnabled=void 0;t.isDesktopTraceEnabled=!!MsPortalFx.trace.desktop})),
define("MsPortalImpl/Services/Services.EditScopeManagement",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/Extension/ExtensionManager"],(function(e,t,s,i,o){"use strict";t.updateEditScopeIsSavingState=t.saveSerializedEditScope=t.loadSerializedEditScope=t.EditScopeManagerImpl=t.EditScopeManager=void 0;var n=FxImpl.Data,r=FxImpl.Rpc;class a{constructor(e,t){this._editScopes={},this._extensionManager=e,this._rpcClient=t,e.onUnload((e=>(this._onExtensionUnloaded(e),!0)))}onEditScopeCreated(e){this._ensureEditScope(e,!0)}onEditScopeDisposed(e){this._getDirtyExtensionSettings(e).forEach((t=>{const s=this._extensionManager.getExtension(c(t.key).extension);s&&s.isLoaded()&&n.onEditScopeDiscardedEndPoint.invoke(this._rpcClient,s.name,e)})),this._deleteEditScope(e)}getStateObservable(e){const t=this._ensureEditScope(e);if(!t.stateObservable){const s=ko.observable();t.stateObservable=ko.pureComputed((()=>{s();return this._getDirtyExtensionSettings(e).length>0?t.savingRefCount()>0?2:1:0})),this._loadEditScope(e).then((()=>{s(!0)}))}return t.stateObservable}logEditsToConsole(e){const t=this._editScopes[e]&&this._editScopes[e].settings;t&&t.extensionSettings().forEach((e=>{const t=c(e.key);console.debug('Edits for editScopeId: {0}, extension: "{1}"'.format(t.editScopeId,t.extension)),n.logEditsToConsole(e.settings)}))}loadEditScopeForExtension(e,t){return this._loadEditScope(e).then((()=>{const s=this._editScopes[e];if(!s)return null;const i=s.settings;if(i){const s=l(e,t),o=MsPortalFx.find(i.extensionSettings(),(e=>e.key===s));return o?o.settings:null}return null}))}saveEditScopeForExtension(e,t,s){const i=this._editScopes[e];let o;if(!this._canEditScopeBeUpdated(i))return;const n=l(e,t),r=MsPortalFx.findIndex(i.settings.extensionSettings(),(e=>e.key===n));r<0?i.settings.extensionSettings.push({key:n,settings:s}):(o=i.settings.extensionSettings()[r],o.settings=s,i.settings.extensionSettings.splice(r,1,o)),i.settings.keys.includes(n)||i.settings.keys.push(n)}updateEditScopeIsSavingStateForExtension(e,t,s){const i=this._editScopes[e];if(!i)return;const o=i.savingRefCount()||0;s?i.savingRefCount(o+1):o>0&&i.savingRefCount(o-1)}trackingEditScope(e){return!!this._editScopes[e]}_canEditScopeBeUpdated(e){return!!e&&!!e.loadPromise}_deleteEditScope(e){delete this._editScopes[e]}_loadEditScope(e){const t=this._ensureEditScope(e);return t.justCreated&&(t.settings={keys:[],extensionSettings:ko.observableArray()},t.loadPromise=Promise.resolve(),t.justCreated=!1),t.loadPromise||(t.loadPromise=this._getAndProcessSettings(e)),t.loadPromise}_getAndProcessSettings(e){return this._editScopes[e].settings={keys:[],extensionSettings:ko.observableArray()},Promise.resolve()}_getDirtyExtensionSettings(e){const t=this._editScopes[e]&&this._editScopes[e].settings;return t&&t.extensionSettings().filter((e=>{const t=e.settings;return t&&t.edits.length>0}))||[]}_onExtensionUnloaded(e){for(const t in this._editScopes){const s=this._editScopes[t];if(s.savingRefCount()>0){s.settings&&s.settings.extensionSettings().some((t=>e===c(t.key).extension&&t.settings.edits.length>0))&&(this._clearEditScopeEdits(t),s.savingRefCount(0))}}}_clearEditScopeEdits(e){const t=this._editScopes[e];if(!this._canEditScopeBeUpdated(t))return;const s=t.settings&&t.settings.extensionSettings;s().forEach((e=>{e.settings=null})),s(s())}_ensureEditScope(e,t=!1){let s=this._editScopes[e];return s||(s=this._editScopes[e]={savingRefCount:ko.observable(0),justCreated:t}),s}}function l(e,t){return"{0}-{1}-{2}".format("editScopes",e,t)}function c(e){const t=e.split("-");return{editScopeId:t.slice(1,t.length-1).join("-"),extension:t[t.length-1]}}t.EditScopeManagerImpl=a;class d{static create(e,t){return new a(e,t)}}t.EditScopeManager=d,__decorate([__metadata("fx:diagnostics",[e,"EditScopeManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.ExtensionManager,r.Client]),__metadata("design:returntype",d)],d,"create",null);t.loadSerializedEditScope=i.defineHandler(n.loadSerializedEditScopeEndPoint,(e=>e.diContainer.get(d).loadEditScopeForExtension(e.messageArg,e.messageContext.srcWindowId))),t.saveSerializedEditScope=i.defineHandler(n.saveSerializedEditScopeEndPoint,(e=>{e.diContainer.get(d).saveEditScopeForExtension(e.messageArg.editScopeId,e.messageContext.srcWindowId,e.messageArg.edits)})),t.updateEditScopeIsSavingState=i.defineHandler(n.updateEditScopeIsSavingStateEndPoint,(e=>{e.diContainer.get(d).updateEditScopeIsSavingStateForExtension(e.messageArg.editScopeId,e.messageContext.srcWindowId,e.messageArg.isSaving)}))})),
define("MsPortalImpl/UI/UI.DesktopManagerView",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/Widgets/Widgets.Portal.init"],(function(e,t,s,i,o,n){"use strict";t.DesktopManagerView=void 0;var r=MsPortalFx.Base.Diagnostics;const a=r.createLog(e);function l(e,t){i.isDesktopTraceEnabled&&a.verbose("[DesktopManager] {0}\n  {1}\n  Model: {2}.".format(e,t.toString(),ko.toJSON(t.getInputsOnlyViewModel())))}let c=t.DesktopManagerView=class{constructor(e,t,s){this._contextPane=t,this._dockedContextPane=s,this._portal=(0,n.getPortalViewModel)(e)}composeStartBoard(e){e&&e.compose(this._portal.getWidget())}addPartToStartBoard(e){e.compose(this._portal.getStartBoardWidget())}addBlade(e,t){l("Adding blade to desktop.",e);const s=e.parent,i=s.children;return r.Telemetry.trace({action:"JourneyLength",source:"Desktop",data:{count:i.length,blades:i.map((e=>{const t=e.locator;return{bladeName:t.name,extension:t.getExtensionName()}}))},journeyId:s&&s.id}),512&e.flags?this._dockedContextPane.tryOpen(e,!!(16&e.flags),!!(1024&e.flags)).then(MsPortalFx.noop):1&e.flags?this._contextPane.tryOpen(e,!!(16&e.flags)).then(MsPortalFx.noop):(e.compose(this._portal.getJourneyWidget(),t),Promise.resolve())}removeBlade(e){l("Removing blade from desktop.",e);let t=this._contextPane;if(512&e.flags&&(t=this._dockedContextPane),t.hasContent(e))t.close(!0);else{const t=this._portal.getJourneyWidget();t&&t.removeChild(e.id)}}removeAllBlades(e){const t=this._portal.getJourneyWidget();t&&t.removeChildren(e)}};t.DesktopManagerView=c=__decorate([__metadata("fx:diagnostics",[e,"DesktopManagerView"]),s.Class(),__metadata("design:paramtypes",[s.Container,o.RightContextPane,o.DockedContextPane])],c)})),
define("MsPortalImpl/UI/UI.JourneyManager",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Telemetry","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.Graph","MsPortalImpl/UI/UI.DesktopManagerView","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Widgets/Widgets.Portal.init"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u){"use strict";t.getLastResourceIdInJourney=t.JourneyManager=void 0;const m=o.Desktop,g=MsPortalFx.Base.Diagnostics.createLog(e);var h=MsPortalFx.deepEquals;const f={noActiveJourney:"Desktop has no active journey.",noBladeInJourney:"Blade '{0}' does not exist in the current journey.",noTileInDesktop:"Tile with id '{0}' was not found on the desktop."};var x=MsPortalFx.getUniqueId,b=MsPortalFx.Base.Diagnostics.Telemetry;t.getLastResourceIdInJourney=i.defineHandler(FxImpl.Extension.getLastResourceIdInJourneyEndPoint,(e=>{const t=e.diContainer.get(y).activeJourney();return t&&t.getCurrentResourceId()}));let y=t.JourneyManager=class{constructor(e,t,s,i,o){let n;this._diContainer=e,this._browser=t,this._finder=s,this._compositionGraph=i,this._view=o,this.activeJourney=ko.observable(null),this._loadingJourneyGuid=null,this._portal=(0,u.getPortalViewModel)(e);let r,a=!1,l=0,c=!1;const d=()=>{this._portal.customEvents.trigger("fxjourneychanged",{openedAsHome:c,wasCtxPaneRoot:a})},p=e=>{l++||(n=this.activeJourney(),r=n&&n.children&&n.children.length,a=n&&n.isStartedWithContextBlade()),c=e},m=e=>{if(! --l){const t=n&&n.children&&n.children.length;e||n===this.activeJourney()&&r===t||d(),n=void 0,a=!1,c=!1}};this._changeJourney=(e,t,s)=>{p(t);try{return e()}finally{m(s)}}}configure(e){this._startBoard=e}setActiveJourney(e){this.activeJourney(e),e&&n.isFullscreen()&&n.exitFullscreen()}async openBlade(e,t){const s=0===e.containerType,i=!!MsPortalFx.find(this._sideBarJourney?.children||[],(t=>t.id===e.id));this._createJourney||await this._loadModules(),this._finder.findBlades(e).forEach(((e,s)=>{if(e.locator.equals(t.locator)&&e.masterPartId===t.masterPartId&&e.masterInvocationProperty===t.masterInvocationProperty&&0===s&&e.locator.equals(t.locator)){const s=e.containerWidget;return s&&s.setFocus(),r.isDesktopTraceEnabled&&g.verbose("[DesktopManager] Found a previously opened detail blade."+"\n  Existing blade: {0}. Model: {1}.".format(e.toString(),ko.toJSON(e.getInputsOnlyViewModel()))+"\n  Requested Descriptor: {0}.".format(ko.toJSON(t))),Promise.resolve(e)}}));try{this._createNewJourneyPromise&&await this._createNewJourneyPromise}catch{}return s&&0===this._finder.findBlades(e).length||i||32&t.flags||512&t.flags||256&t.flags?this.createJourney(!i&&t.masterPartId,t).then((e=>{if(e&&e.children&&e.children.length>0)return e.children[0];throw new MsPortalFx.Errors.Error("Failed to create new journey")})):this._changeJourney((()=>{const o=this._createBlade(this._diContainer,t,e),n=this._finder.findPart(t.masterPartId,e);this._compositionGraph.addBlade(o,n||e);const r=s||i?0:1+this._findFirstItemIndex(this.activeJourney().children,e.id,f.noBladeInJourney.format(e.id));return this.activeJourney().addChild(o,r),this._view.addBlade(o,{assetType:t.originAssetType,index:r,focus:!0}).catch((e=>{g.error(e)})),o}))}async createJourney(e,t,s){let i,o;const n=!!(32&t?.flags),r=!!(256&t?.flags),a=!!(512&t?.flags);if(this._createJourney||await this._loadModules(),o||(i=this._startBoard,o=MsPortalFx.find(i.children,(t=>t.id===e))),!o&&e)throw g.error(f.noTileInDesktop.format(e)),g.verbose(ko.toJSON(this.getDiagnosticsData(),null,2)),new MsPortalFx.Errors.Error(f.noTileInDesktop.format(e));const l=Promise.withResolvers();if(s||(s=x(),this._loadingJourneyGuid=s,this._createNewJourneyPromise=l.promise),l.promise.finally((()=>{this._loadingJourneyGuid===s&&(this._loadingJourneyGuid=null,this._createNewJourneyPromise=null)})),!1===o?.isComposed&&await o.await(7),n||r||a||this.tryDeactivateJourney(s))try{const e=this._createJourney(this._diContainer,o),s=v("Desktop","JourneyOpened",w(o),void 0,e.id);n?this._helpPaneJourney=e:r?this._sideBarJourney=e:a?this._dockedContextPaneJourney=e:this.setActiveJourney(e);const c=t.openedByContext,d=c&&c.openedAsHome;this._changeJourney((()=>{const s=this._createBlade(this._diContainer,t,i);e.addChild(s),e.compose(this._portal.getWidget()),this._compositionGraph.addBlade(s,o||i),this._view.addBlade(s,{assetType:t.originAssetType,resourceType:t.model?.resourceType,kind:t.model?.kind,focus:!0}).catch((e=>{g.error(e)})),l.resolve(e)}),d),b.completeTrace(s)}catch(e){l.reject(e)}else l.reject(new MsPortalFx.Errors.Error("tryDeactivateJourney returned false"));return l.promise}getDiagnosticsData(){const e=this._startBoard,t=this.activeJourney();return{startboard:e&&e.getDiagnosticsData(),activeJourney:t&&t.getDiagnosticsData()}}tryDeactivateJourney(e){const t=this.activeJourney();if(t){if(!this.confirmBladesCanClose(t.children))return!1;const e=t.children.filter((e=>!e.isRestorable()));for(let t=e.length-1;t>=0;t--)this.forceCloseBlade(e[t]);const s=v("Desktop","JourneyDeactivated",w(t.originTile),void 0,t.id);this._closeActiveJourney(!0),b.completeTrace(s)}else this._startBoard&&this._compositionGraph.removeAllBlades(this._startBoard);return this._loadingJourneyGuid=e||null,!0}closeChildBlades(e){const t=this.discardEditsOfBlade(e,{includeSelf:!1,includeDescendants:!0});if(t.successful){const t=this._finder.findBlades(e);for(let e=t.length-1;e>=0;e--)this.forceCloseBlade(t[e],1)}return t}tryCloseBlade(e,t){if(32&e.flags||512&e.flags||MsPortalFx.findIndex(this.activeJourney()?.children,(t=>t.id===e.id))>=0){const s=this.confirmBladesCanClose([e]);return s&&this.forceCloseBlade(e,t),s}return!0}confirmBladesCanClose(e,t,s){const i=t||this.activeJourney();if(!MsPortalFx.find(e,(e=>!this.canCloseBlade(e,{bladeJourney:i,validateHidden:s}))))return!0;e.forEach((e=>{if(!this._compositionGraph.find(e.id))throw new Error(f.noBladeInJourney.format(e.id))}));const o=[];return MsPortalFx.pushUnique(o,MsPortalFx.mapMany(e,(e=>this._getAlertMessageRecursive(e)))),this._browser.confirm(o.join("\n")||m.confirmEditScopeDiscard)}forceCloseBlade(e,t,s){if(!this.activeJourney()&&!this._helpPaneJourney&&!this._dockedContextPaneJourney)throw new Error(f.noActiveJourney);const i=s&&s.openBlade;this._changeJourney((()=>{const s=e.parent,i=this._findFirstItemIndex(s.children,e.id,f.noBladeInJourney.format(e.id)),o=this._finder.findBlades(this._startBoard);1===o.length&&o[0].id===e.id?this.forceDiscardJourney(s.id,t):(0===i?this.forceDiscardJourney(s.id,t):this._closeBladeRecursive(e,i,t),this._compositionGraph.removeBlade(e))}),void 0,i)}canCloseBlade(e,t){const s=t?.bladeJourney||this.activeJourney();if(!s)return!0;const i=e=>{const o=!(!e.bladeDefinition||!e.bladeDefinition.actionBar);if(!ko.unwrap(e.editScopeId)&&e.shouldAlertOnClose({legacyMode:o,validateHidden:t?.validateHidden}))return!0;if(e.isInitialized&&!e.children.some((e=>e.children.some((e=>e.suppressAlert()))))&&s.ambientSettings.getItemsInPath(e.journeyPath).some((e=>{const t=e.value,s=t&&t.editScope;return s&&s.dirty&&!s.saving})))return!0;const n=this._finder.findBlades(e);return 0!==n.length&&n.some((e=>i(e)))};return!i(e)}forceDiscardJourney(e,t){this.activeJourney()?.id===e?this._changeJourney((()=>{this._closeActiveJourney(!1,t)})):e===this._helpPaneJourney?.id?this._helpPaneJourney.children.slice(0).forEach((e=>{this._compositionGraph.removeBlade(e),e.isDisposed()||this._closeBladeRecursive(e,0,t,!1)})):e===this._dockedContextPaneJourney?.id&&this._dockedContextPaneJourney.children.slice(0).forEach((e=>{this._compositionGraph.removeBlade(e),e.isDisposed()||this._closeBladeRecursive(e,0,t,!1)}))}tryDiscardJourney(e){let t=!1;return(this.canDiscardJourney(e)||this._browser.confirm(m.confirmEditScopeDiscard))&&(this.forceDiscardJourney(e),t=!0),t}canDiscardJourney(e){const t=this.activeJourney()?.id===e&&this.activeJourney(),s=t&&t.ambientSettings.getObservable().peek().some((e=>{const t=e.value,s=t&&t.editScope;return s&&s.dirty&&!s.saving&&s.disposeOnJourneyDiscard}));return!t||!s}discardEditsOfBlade(e,t){return this._discardEditsOfContainer(e,t.force,(s=>{const i=s.value,o=s.path,n=e.journeyPath,r=h(o,n),a=!r&&(1===i.type||o.length>=n.length+2);return i&&i.editScope&&(t.includeSelf&&r||t.includeDescendants&&a)}))}dispose(){this.activeJourney()&&(this.activeJourney().dispose(!0),this.activeJourney(null)),this._helpPaneJourney&&(this._helpPaneJourney.dispose(),this._helpPaneJourney=null),this._sideBarJourney&&(this._sideBarJourney.dispose(),this._sideBarJourney=null),this._dockedContextPaneJourney&&(this._dockedContextPaneJourney.dispose(),this._dockedContextPaneJourney=null)}getJourneyIdForTile(e){const t=this.activeJourney();let s;return t&&t.originTile.id===e&&(s=t.id),s}_discardEditsOfContainer(e,t,s){let i=[];const o={confirmationRequired:!1,successful:!1},n=this.activeJourney();if(!n)throw new Error(f.noActiveJourney);const r=n.ambientSettings;return(0===e.containerType||e.isInitialized)&&(i=r.getItemsInPath(e.journeyPath).filter(s)),o.confirmationRequired=!t&&i.filter((e=>{const t=e.value.editScope;return t.dirty&&!t.saving})).length>0,o.confirmationRequired&&!this._browser.confirm(m.confirmEditScopeDiscard)||(o.successful=!0,i.forEach((e=>{r.removeItem(e.path),this._diContainer.get(a.EditScopeManager).onEditScopeDisposed(e.value.editScope.editScopeId)}))),o}_closeActiveJourney(e,t){const s=this.activeJourney();this.setActiveJourney(null),this._compositionGraph.removeAllBlades(this._startBoard),s&&(s.children.slice(0).reverse().forEach((s=>{s.isDisposed()||this._closeBladeRecursive(s,0,t,e)})),s.dispose(e)),this._view.removeAllBlades((e=>{g.error("DesktopManager: Found un-tracked blade '{0}' in view after closing active journey. It will be forcefully removed.".format(e))}))}_closeBladeRecursive(e,t,s,i){this._removeBladesFromUIRecursive(e),this._disposeBladesRecursive(e,t,i),i||(e.parent.save(),this._portal.customEvents.trigger("fxbladeclosed",{id:e.id,reason:s,masterPartId:e.masterPartId}))}_removeBladesFromUIRecursive(e){const t=this._finder.findBlades(e);for(let e=t.length-1;e>=0;e--)this._removeBladesFromUIRecursive(t[e]);this._view.removeBlade(e)}_disposeBladesRecursive(e,t,s){const i=e.parent.children.indexOf(e,t);s?e.dispose(!0):e.parent.removeChildAt(i,void 0),this._finder.findBlades(e).forEach((e=>{this._disposeBladesRecursive(e,i,s)}))}_getAlertMessageRecursive(e){return(e=>{const t=MsPortalFx.mapMany(this._finder.findBlades(e),(e=>e.getAlertOnCloseMessages()));return MsPortalFx.union(e.getAlertOnCloseMessages(),t)})(e)}_findFirstItemIndex(e,t,s){const i=MsPortalFx.findIndex(e,(e=>e.id===t));if(-1===i)throw g.verbose(ko.toJSON(this.getDiagnosticsData(),null,2)),new Error(s);return i}getJourneyWidget(){return this._portal.getJourneyWidget()}async _loadModules(){if(!this._createJourney){const[e,t]=await Promise.all([i.get("MsPortalImpl/UI/Compositions/UI.Composition.Journey","create"),i.get("MsPortalImpl/UI/Compositions/UI.Composition.Blade","create")]);this._createJourney=e,this._createBlade=t}}};function v(e,t,s,i,o){return b.startTrace({source:e,action:t,name:s,assetType:i,journeyId:o})}function w(e){return e?.locator?.toFriendlyString()}t.JourneyManager=y=__decorate([__metadata("fx:diagnostics",[e,"JourneyManager"]),s.Class(),__metadata("design:paramtypes",[s.Container,p.Browser,l.Finder,c.CompositionGraph,d.DesktopManagerView])],y)})),
define("MsPortalImpl/Base/Base.Router",["require","exports","Fx/ResourceManagement","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.DeepLink","FxInternal/Shared/lib/LinkUtils","MsPortalImpl/Base/Base.HistoryManager","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.Portal.init","MsPortalImpl/Shared/RedirectCommon","Weave","Fx","FxInternal","Fx/Experimentation","MsPortalImpl/Services/Services.HomeViewSettings","MsPortalImpl/Base/Base.HomeView","MsPortalImpl/Widgets/Widgets.AzureHome","MsPortalImpl/Widgets/AzHome/FreeTrial/FreeTrialConstants"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x,b,y,v,w,M,C,S,I,P,_,F,T){"use strict";t.convertToBrowseRouteUrlOnValidBrowseBlade=t.Router=t.Internal=void 0;var k=MsPortalFx.Base,E=k.Diagnostics;const D=window,A=E.createLog(e),B=n.Portal.defaultPageTitle.format(n.Dashboard.defaultTitle,D.fx.environment.branding.title);const N=FxImpl.getErrorMap({linkFormat:"",invalidLink:"",unfoundAsset:"",noResourceAsset:""});function R(e,t){const s=new Date;e.getAsync(o.get("MsPortalImpl/UI/Hubs/UI.NotificationManager","NotificationManager")).then((e=>{e.addClientNotification({title:n.Shell.deepLinkInvalidTitle,description:t,status:MsPortalFx.Hubs.Notifications.NotificationStatus.Error,timestamp:s,correlationIds:[s.getTime().toString()]})}))}var L;function z(e,t,s,i,o,n){return MsPortalFx.extend({extensionName:e,assetType:t,assetId:s,detailBladeInputs:i,defaultMenuItemId:o},n)}function H(e){return!(e.isEnabled("hidedirectorypanebutton")||D?.chrome?.hideDirectoryPaneButton)}function O(e,t){const s=t.portal,i=t.baseRouter;return{navigateTo:(t,o)=>i.tryCleanupJourney()?(s.settingsFlyoutState(0),o.interactionSource||(o.interactionSource="Router"),E.Telemetry.trace({source:o.interactionSource||"Base.Router",action:"DashboardNavigation"}),MsPortalFx.isNullOrWhiteSpace(o.dashboardId)&&(o.dashboardId=t&&(0,r.getDashboardIdFromUri)(t)),e.get(m.SwitchDashboardPortalFunc).invoke({id:o.dashboardId,title:o.dashboardId},o.interactionSource).then((()=>{i.updateTitle(),s.customEvents.trigger("fxdeeplinkchanged")}))):Promise.reject()}}function U(e,t,s){return t.loadAzureHome(s).then((t=>MsPortalFx.require("MsPortalImpl/Widgets/AzureHome/AzureHome.DataSource").then((t=>t.reloadRecentsAndFavorites(e)))))}function W(e,t){const s=e.get(FxImpl.Features),i=t.portal,o=t.baseRouter;return{navigateTo:(t,n)=>{if(n=n||{},E.Telemetry.trace({source:"Base.Router",action:"AzureHomeNavigation"}),o.tryCleanupJourney()){o.ensureRouteInView("Home");const t=s.getValue("bladeashomedeeplink");if(!t){const t=e.get(P.HomeViewSettings);return Promise.all([MsPortalFx.require("MsPortalImpl/Widgets/AzureHome/AzureHome.Store"),MsPortalFx.require("MsPortalImpl/Widgets/AzHome/FreeTrial/Cost.Store")]).then((([r,a])=>{if("classic"===s.getValue("homeview"))return t.homeview("classic"),t.userTypeHint(""),t.showAzHome(!1),t.freHomeCredits(null),t.freHomePage(""),U(e,i,n.invokedByInitRoute);if("startup"===t.homeview()){r.useAzureHomeStore.setState({azHomeView:"startup"});const e=new c.Uri(_.HomeViewMap.startup);return o.navigateWithRoute("view",e,{openedByContext:{deepLink:e.hash,openedAsHome:!0}})}if("startup"===t.userTypeHint())return U(e,i,n.invokedByInitRoute);if("startup"===t.userTypeHint()||"startup"!==s.getValue("homeview"))return"frehome"===t.homeview()||"frehome"!==s.getValue("homeview")&&!FxImpl.getShellAssignments()?.getBooleanValue("frehome")?U(e,i,n.invokedByInitRoute):(0,F.getFreeTrialSubscriptionInfo)(e).then((s=>(1===s.subscriptionState&&(t.homeview("frehome"),t.userTypeHint("freeTrial"),t.freHomePage("landingPage"),t.freHomeCredits({amount:{value:200,currency:"USD"},subscriptionId:s.subscription?.subscriptionId,lastUpdatedTime:Date.now(),expirationDate:""}),r.useAzureHomeStore.setState({azHomeView:"frehome"}),a.useCostStore.setState({showDefaultCredits:!0,showCredits:!0,showCosts:!1,freeTrialSubscriptionInfo:s}),E.Telemetry.trace({source:T.TelemetrySourceConstants.FREHome,action:T.TelemetryActionConstants.FirstVisit})),U(e,i,n.invokedByInitRoute))));{const e=new c.Uri(_.HomeViewMap.startup);t.homeview("startup"),t.userTypeHint("startup"),t.showAzHome(!0),r.useAzureHomeStore.setState({azHomeExperienceToggleOn:!0,azHomeView:"startup"}),o.navigateWithRoute("view",e,{openedByContext:{deepLink:e.hash,openedAsHome:!0}})}})).then((()=>{o.updateTitle(),i.customEvents.trigger("fxdeeplinkchanged")}))}{const e=new c.Uri("#"+t),s={deepLink:e.hash,openedAsHome:!0};o.navigateWithRoute("blade",e,{openedByContext:s})}return o.updateTitle(),i.customEvents.trigger("fxdeeplinkchanged"),Promise.resolve()}return Promise.reject()}}}function V(e,t){const s=t.portal,i=t.baseRouter;return{navigateTo:e=>{if(i.tryCleanupJourney()){const t=e.getHashParts().rest.split("/");let o,n="";if(t?.length){switch(t[0].toLowerCase()){case"category":o=t[3],n=t[1];break;case"filter":o=t[1],n=t[3]}}i.ensureRouteInView("AllServices");const a=o&&decodeURIComponent(o);s.allServicesMenuInput.filter(a),s.allServicesMenuInput.category=n&&decodeURIComponent(n),"allservices"!==(0,r.getCurrentUri)().getHashParts().category&&l.pushState({data:{},url:e.hash}),i.updateTitle()}return Promise.resolve()}}}function q(e,t){const s=e.get(f.JourneyManager),i=t.portal,o=t.lifetime,n=t.baseRouter,a=e.get(I.Experimentation).shellAssignments.getBooleanValue("newsettingsmenu"),c={2:"directory",3:a?"subscriptions":"filters",6:"contact",4:"appearance"};const d=(t,r)=>{const l=t.getHashParts().rest,c=e.get(FxImpl.Features),d=function(e,t){let s=1;if(t.enableOverview||(s=t.enableDirectorySettings?2:4),!e)return s;let i,o=e.toLowerCase();switch(e.startsWith("#settings")&&(o=e.split("/")[1]),o){case"directory":t.enableDirectorySettings&&(i=2);break;case"filters":(t.enableGlobalResourceFilters||a)&&(i=3);break;case"contact":t.enableContactInfo&&(i=6);break;case"appearance":i=4;break;case"subscriptions":i=t.enableGlobalResourceFilters||a?3:2}return MsPortalFx.isNullOrUndefined(i)&&(i=s),i}(l,{enableDirectorySettings:H(c),enableGlobalResourceFilters:r,enableContactInfo:c.isEnabled("contactinfo"),enableOverview:!c.isEnabled("hidesettingsoverview")});if(i.settingsFlyoutState(d),0!==i.settingsFlyoutState.value){e.get(g.RightContextPane).close(!0);const t=e.get(h.DialogManager);t.hasOpenDialog&&(E.Telemetry.trace({source:"Base.Router",action:"SettingsFlyoutClosedDialogsOnOpen"}),t.dismissOpenDialog())}const p=o.createChildLifetime();(0,M.subscribe)(p,[i.settingsFlyoutState],(async e=>{if(0===e){const e=s.activeJourney();e&&e.children.length||await n.goToLandingPage({interactionSource:"Router",replaceHistory:!1,invokedByInitRoute:!0,skipFocus:!0}),p.dispose()}}))};return(0,M.subscribe)(o,[i.settingsFlyoutState],(e=>{if(0===e){const e=(0,r.getCurrentUri)().getHashParts();return void(e.category&&"settings"===e.category&&(n.updateNavHistory(),n.updateTitle()))}const t=c[e];l.pushState({data:{},url:(0,r.getCurrentUri)().setHash("#settings"+(t?`/${t}`:"")).href}),i.customEvents.trigger("fxdeeplinkchanged"),n.updateTitle()})),{navigateTo:t=>e.get(u.SubscriptionsUserContext).useAdvancedFiltersPromise.then((e=>d(t,e)))}}!function(e){e.RouterImpl=class{constructor(e,t,s){this._diContainer=e,this._portal=s,this._ltm=new FxImpl.TriggerableLifetimeManager,this._journeyManager=e.get(f.JourneyManager),this._features=e.get(FxImpl.Features);const i={portal:s,lifetime:this._ltm,baseRouter:{goToLandingPage:e=>this.goToLandingPage(e),tryCleanupJourney:()=>this._tryCleanupJourney(),ensureRouteInView:e=>this.ensureRouteInView(e),updateTitle:()=>this._updateTitle(),updateNavHistory:e=>this._updateNavHistory(e),navigateWithRoute:(e,t,s)=>this.navigateWithRoute(e,t,s)}},o=function(e,t){const s=e.get(p.AssetTypeService),i=e.get(f.JourneyManager),o=t.portal,d=t.baseRouter,u={["MyAccessBlade".toLowerCase()]:"MyAccess.ReactView",["RPStatusBlade".toLowerCase()]:"RPStatus.ReactView"};function g(e,t){const s=(e||"").split("/"),i=s.length;if(i<2)return null;if(!s[1])return null;let o,n=0;t?s[2]===a.DeepLinkV2TypeMarker.MenuBlade&&(n=2,o=decodeURI(s[3])):(n=i%2,1===n&&(o=decodeURI(s[2])));const l=(0,r.parseBladeInputs)(s.slice(2+n),e,{parseJSON:!0,v2DeepLink:t});return{extension:s[0],detailBlade:s[1],detailBladeInputs:l,defaultMenuItemId:o}}const h=(e,t,s)=>{const i=new c.Uri(e),o=g(i.getHashParts().rest,"view"===i.getHashParts().category),n=(0,w.getReactBrowseRedirectBlade)({bladeName:o.detailBlade,resourceType:s,variantAssignments:t}),r=i.getHashParts().rest.split("/").slice(2).join("/");return`#${i.getHashParts().category}/HubsExtension/${n}/${r}`};return{navigateTo:(t,a)=>{const f="view"===t.getHashParts().category,x=t.getHashParts().rest;let b=a&&a.route||g(x,f);b.openedByContext=a&&a.openedByContext,o.settingsFlyoutState(0);let y=Promise.resolve(),v=Promise.resolve();const w=e.get(I.Experimentation).shellAssignments.whenAvailable();if(b.extension&&b.extension.toLowerCase()==="HubsExtension".toLowerCase()){const C=(b.detailBlade||"").toLowerCase(),P=e.get(FxImpl.Features);if("contactinfoblade"===C&&P.isEnabled("contactinfo"))return void o.settingsFlyoutState(6);if("settingsblade"===C)return E.Telemetry.trace({source:"Base.Router",action:"SettingsFlyoutRedirect"}),l.pushState({data:{},url:(0,r.getCurrentUri)().setHash("#menu/settings").href}),o.customEvents.trigger("fxdeeplinkchanged"),d.navigateWithRoute("menu",new c.Uri("#menu/settings"),{});function _(e){return v=w.then((s=>{if(!s)return;const i=h(t.hash,s,e),o=t.hash!==i;if(E.Telemetry.trace({source:"Base.Router",action:"BrowseResourceReactRedirect",actionModifier:o?"Redirected":"NotRedirected",data:{originalUri:t.hash,newUri:i,resourceType:e,reactRedirectApplied:o}}),o){const e=g((t=new c.Uri(i)).getHashParts().rest,"view"===t.getHashParts().category);b=e}}))}const F=(i,o)=>{y=S.tryImmediateResolve(s.assetTypesComplete,(()=>{let n,r="";if(i===k.Constants.ResourceTypes.AllResources?r=p.lowerCaseAllResourcesId:(n=s.getAssetTypeByResourceType(i),n&&(r=n.id.toLowerCase())),r)return(0,p.getBrowseBladeUri)(e,r,t.hash,n,o).then((e=>{if(t.hash!==e){const s=g((t=new c.Uri(e)).getHashParts().rest,"view"===t.getHashParts().category);b=s}}))}))},T=["resources","browseresource","browseresourceblade","browseresource.reactview"],D=b.detailBladeInputs||{},A=D.resourceType||"",B=D.kind||"",N=T.includes(C);"browseallresourcesblade"===C?F(k.Constants.ResourceTypes.AllResources):"browseresourceblade"===C?F(A,B):"browseresourcegroupblade"===C?F(k.Constants.ResourceTypes.ResourceGroups):Object.keys(u).includes(C)&&(b.detailBlade=u[C]),N&&_(A)}const M=i.activeJourney();return y.then((()=>v)).then((()=>Promise.resolve().then((()=>M&&M.getDeepLink()||Promise.resolve(""))).catch((()=>"")).then((s=>{if(t.hash!==s)return e.get(m.CreateJourneyForBladeFunc).invoke(b).then(MsPortalFx.identity,(t=>{throw R(e,n.Shell.deepLinkErrorLoading.format(x)),t}))})).then((()=>{w.then((e=>{if(e.getBooleanValue("browseroute")){const{isBrowseBlade:e,newRouteUrl:s}=j({extension:b.extension,detailBlade:b.detailBlade,detailBladeInputs:b.detailBladeInputs,v2DeepLink:f,hashQueryString:t.hashQueryString});e&&s&&l.replaceState({data:{},url:s})}}))}))))}}}(e,i);this._routeConfigMapping={allservices:V(e,i),asset:Z(e,i),blade:o,view:o,cloudshell:this._features.isEnabled("azureconsole")?G(e,i):void 0,create:J(e,i),catalog:K(e,i),dashboard:O(e,i),menu:X(e,i),home:this._features.isEnabled("azurehome")?W(e,i):void 0,resource:Y(e,i),settings:q(e,i),browse:ee(e,i),servicemenu:te(e,i)},MsPortalFx.ViewModels.navigateToDashboardEndPoint.register(t,null,(([e,t])=>{this.navigateWithRoute("dashboard",null,{interactionSource:e,dashboardId:t})}))}navigateWithRoute(e,t,s){const i=this._routeConfigMapping[e];return i?i.navigateTo(t,s):Promise.reject("Invalid route type")}_getRouteConfig(e){const t=e.getHashParts().category;return this._routeConfigMapping[t]}ensureRouteInView(e){this._portal.settingsFlyoutState(0),this._portal.displayMode.value!==e&&this._portal.displayMode(e)}route(e,t){return this._route(new c.Uri(e),{openedByContext:t})}_route(e,t={}){const s=MsPortalFx.extend(t.openedByContext||{},{deepLink:e.hash});return S.tryImmediateResolve(Promise.resolve(),(()=>{if(this._features.isEnabled("azureconsole")&&this._routeConfigMapping.cloudshell.onNavAway(),"Dashboard"===this._portal.displayMode.value){const e=this._portal.getStartBoardWidget();if(this._portal.inOrganizeMode()||e.options.dashboardChanged.value){if(!this._diContainer.get(x.Browser).confirm(n.Desktop.confirmEditScopeDiscard))return;this._portal.topBar.finishDashboardEdit(3)}}e.isHashEmpty()&&(e.setHash((0,b.isLandingPageDashboard)(this._diContainer)?"dashboard":"home"),l.replaceState({data:{},url:e.href}),e=(0,r.getCurrentUri)());const i=this._getRouteConfig(e);return i?i.navigateTo(e,{skipFocus:t.skipFocus,openedByContext:s,invokedByInitRoute:t.invokedByInitRoute}):Promise.reject(FxImpl.createError("{0} is not a valid deep link".format(e.hashWithHashQueryString)))})).then((()=>this._portal.customEvents.trigger("fxdeeplinkchanged")))}initialRoute(e,t){const s=(0,r.getCurrentUri)();let i;return i=this._getRouteConfig(s)?this._route(s,t).catch(e):e(),this.startListening(),i.catch((e=>(A.warning(e,1,"Unable to load initial route."),this.goToLandingPage(t))))}startListening(){let e=this._isListening;e&&e.dispose(),e=this._isListening=this._ltm.createChildLifetime(),this._portal.customEvents.addHandler(e,"fxjourneychanged",((e,t)=>{(t=t||{openedAsHome:!1}).wasCtxPaneRoot?this._updateTitle():this._updateNavHistory({addToHistory:!0,openedAsHome:t.openedAsHome})})),this._portal.customEvents.addHandler(e,"fxbladerebound",(()=>{this._updateNavHistory()})),e.registerForDispose([$(window).setEvents(["hashchange",()=>{const e=(0,r.getCurrentUri)(),t=(0,r.getCurrentUri)();this._route(t,{skipFocus:!1}).catch((s=>{this._updateNavHistory(),E.Telemetry.trace({source:"Base.Router",action:"UriHashChange",data:{originalUri:e,replacedUri:t,reason:s}})}))}])])}stopListening(){const e=this._isListening;e&&e.dispose(),this._isListening=null}dispose(){this.stopListening(),this._ltm.dispose(),window.location.hash=""}goToLandingPage(e){const t=(0,b.isLandingPageDashboard)(this._diContainer);E.Telemetry.trace({source:e.interactionSource||"Base.Router",action:"LandingPageNavigation"});const s=(0,r.getCurrentUri)().setHash(t?"dashboard":"home");return(e.replaceHistory?l.replaceState:l.pushState)({data:{},url:s.href}),this.navigateWithRoute(t?"dashboard":"home",null,e)}_tryCleanupJourney(){if(this._journeyManager.tryDeactivateJourney()){if(!this._getActiveJourneyId()){const e=this._portal.getJourneyWidget();e&&e.close()}return!0}return!1}_updateTitle(){const e=this._journeyManager.activeJourney();this._titleLifetime&&this._titleLifetime.dispose(),this._titleLifetime=null;const t=e=>n.Portal.windowTitleFormat.format(e,D.fx.environment.branding.title);if(0!==this._portal.settingsFlyoutState.value)D.document.title=t(n.TopBar.settings);else if(e&&e.children.length>0){this._titleLifetime=this._ltm.createChildLifetime();const s=e.children[e.children.length-1].containerWidget,i=s&&s.options;i&&i.crumb.subscribeAndRun(this._titleLifetime,(e=>{MsPortalFx.isNullOrUndefined(e)||(D.document.title=t(e))}))}else new Promise((e=>{switch(this._portal.getDisplayMode()){case"Home":e(t(n.AzureHome.home));break;case"Dashboard":MsPortalFx.require("MsPortalImpl/UI/UI.DesktopManagerImpl").then((({DesktopManagerImpl:s})=>{const i=this._diContainer.get(s).startBoard,o=i&&i.getDashboard()||{};o.title?e(t(o.title)):e(B)}));break;default:e(t(FxImpl.getShellAssignments()?.getBooleanValue("azhome")?n.SideBar.services:n.SideBar.allServices))}})).then((e=>D.document.title=e))}_getActiveJourneyId(){const e=this._journeyManager.activeJourney();return!e||e.isStartedWithContextBlade()?"":e.id}_updateNavHistory(e){const t=e&&e.addToHistory?l.pushState:l.replaceState,s=e&&e.skipFocus,i=this._journeyManager.activeJourney();let o=!0;if(!i){let e;switch(this._portal.getRootPageDisplayType()){case"Dashboard":e="dashboard";break;case"Home":e="home";break;default:e="allservices"}const i=(0,r.getCurrentUri)(),o=i.getHashParts().category;return MsPortalFx.localeCompareIgnoreCase(o,"dashboard")&&MsPortalFx.localeCompareIgnoreCase(o,"home")&&MsPortalFx.localeCompareIgnoreCase(o,"allservices")&&t({data:null,url:i.setHash(e).href}),this._route((0,r.getCurrentUri)(),{skipFocus:s})}return S.tryImmediateResolve(i.getDeepLink(),(n=>{if(!this._getActiveJourneyId())return;const a=i.children,l=a[a.length-1],c=l&&l.bladeDefinition;if(c&&(c.menuBlade||c.tabMenuBlade))return void(o=!1);let d;const p=(0,r.getCurrentUri)();return e&&e.openedAsHome?p.setHash("#home"):(d=Object.keys(_.HomeViewMap).find((e=>_.HomeViewMap[e]===n)),d?p.setHash("#home"):p.setHash(n)),p.href.toLowerCase()!==location.href.toLowerCase()&&(t({data:{},url:p.href}),this._portal.customEvents.trigger("fxdeeplinkchanged")),d&&d!==this._diContainer.get(P.HomeViewSettings).homeview()?this._route(p,{skipFocus:s}):void 0}),(e=>{A.warning(new MsPortalFx.Errors.Error({message:"Failed to update address bar.",data:{id:this._getActiveJourneyId(),key:i.templateKey},innerErrors:e}))})).finally((()=>{o&&this._updateTitle()}))}}}(L||(t.Internal=L={}));const j=e=>{let t="";const s=e.extension,i=e.detailBlade,o=e.detailBladeInputs||{},n=e.v2DeepLink,r=o.resourceType||"",l=e.hashQueryString||"",c={browseallresourcesblade:"all","browseall.reactview":"all",browseall:"all",browseresourcegroupblade:"resourcegroups",browseresourcegroups:"resourcegroups",resources:r,browseresourceblade:r,browseresources:r,browseresource:r,"browseresource.reactview":r,"browsefavoriteresources.reactview":"favorites","browserecentresources.reactview":"recents"},d=s?.toLowerCase()==="HubsExtension".toLowerCase()&&i?.toLowerCase()in c;if(!d)return{isBrowseBlade:!1,newRouteUrl:t};let u=c[i.toLowerCase()]||"";switch(u){case p.lowerCaseAllResourcesType:u="all";break;case p.lowerCaseResourceGroupsType:u="resourcegroups";break;case p.lowerCaseResourcesWithTagType:u="resourceswithtag"}t=u?.length>0?`#browse/${encodeURIComponent(u)}`:"#browse",r&&delete o.resourceType;const{serializedInputs:m}=(0,a.serializeViewInputs)(o,n);return t+=m,l.length>0&&(t+=l),{isBrowseBlade:d,newRouteUrl:t}};function G(e,t){function s(){return e.getAsync(o.get("MsPortalImpl/UI/UI.AzureConsole","AzureConsole"))}let i=!1;return{navigateTo:()=>(i=!0,s().then((e=>e.showFullscreen()))),onNavAway:()=>i?s().then((e=>e.minimizeIfOpen())):Promise.resolve()}}function K(e,t){const s=(0,C.memoizePromise)((()=>MsPortalFx.require("MsPortalImpl/Base/Base.Selectable2.Provisioning"))),i=t.baseRouter;return{navigateTo:async(t,o)=>{const a=t&&t.getHashParts().rest;let l=(a||"").split("/");if(!l.length)return R(e,n.Shell.deepLinkInvalid.format(a)),Promise.reject(FxImpl.createError(`Deep link ${a} should be #{routeTypes.catalog}/{package-id} or #{routeTypes.catalog}/subscription/{subscriptionId}/{package-id}.`));E.Telemetry.trace({source:"Gallery",action:"DeepLinkVisited",name:a});const[c,d,p,...u]=l,m=(0,r.parseBladeInputs)(l,a),g=await s();if("subscription"===c.toLowerCase()&&(l=u,!d))return R(e,n.Shell.deepLinkInvalid.format(a)),Promise.reject(FxImpl.createError(`Deep link ${a} is missing subscription id.`));const h="subscription"===c.toLowerCase()?await g.getDynamicCreateBladeReference(e,{catalogId:p,subscriptionId:d,inputs:m}):await g.getDynamicCreateBladeReference(e,{catalogId:c,inputs:m});return h.defaultMenuItemId=l[2],o.route=h,await i.navigateWithRoute("blade",t,o)}}}function J(e,t){const s=(0,C.memoizePromise)((()=>MsPortalFx.require("MsPortalImpl/Base/Base.Selectable2.Provisioning"))),i=t.baseRouter;return{navigateTo:async(t,o)=>{const a=t&&t.getHashParts().rest,l=(a||"").split("/");if(!l.length)return R(e,n.Shell.deepLinkInvalid.format(a)),Promise.reject(FxImpl.createError(`Deep link ${a} should be #{routeTypes.create}/{package-id}.`));E.Telemetry.trace({source:"Gallery",action:"DeepLinkVisited",name:a});const d=l.shift(),p=(0,r.parseBladeInputs)(l,a);if("hub"!==d){const n=await s(),r=await n.getDynamicCreateBladeReference(e,{galleryItemId:d,inputs:p});return r.defaultMenuItemId=l[2],o.route=r,await i.navigateWithRoute("blade",t,o)}{const e="{0}/{1}/package/{2}/additionalConfig/{3}/selectedMenuItemId/undefined/createLanding/undefined".format(MsPortalFx.Base.Constants.ExtensionNames.Marketplace,MsPortalFx.Base.Constants.BladeNames.Hubs.CreateHubBlade,encodeURIComponent(d),encodeURIComponent(JSON.stringify(p)));return i.navigateWithRoute("blade",new c.Uri("#blade/"+e),o)}}}}function X(e,t){const s=/^[\w-]+$/,i=t.portal,o=t.baseRouter,n=e=>{const t=new c.Uri(e.toString());return t.setHash("#settings"),o.navigateWithRoute("settings",t,{})};return{navigateTo:t=>{const r=t.getHashParts().rest;s.test(r)||N.linkFormat(r);const a=r.toLowerCase();if("directory"===a&&H(e.get(FxImpl.Features)))return n(t);if("subscriptions"===a)return n(t);const l="fxs-menu-"+a;let c=i.getRootElement().find(`.${l}`);c.length>1&&(c=y.filterVisible(i.getRootElement()[0],"."+l)),1!==c.length&&N.invalidLink(r),o.updateNavHistory({skipFocus:!0}),c[0].click()}}}function Z(e,t){const i=e.get(d.ManifestCache);return{navigateTo:(t,o)=>{const r=t.getHashParts().rest,a=/([^/]+)\/([^/]+)\/(.+)/.exec(r);if(!a||a.length<4)return R(e,n.Shell.deepLinkInvalid.format(r)),Promise.reject(FxImpl.createError(`'${r}' is invalid. Correct format is #asset/{ExtensionName}/{AssetType}/{AssetId}`));const l=decodeURI(a[1]);let c=decodeURI(a[2]),d=decodeURI(a[3]);const p="string"==typeof d&&s.ArmId.parse("/"+d,!0);return p&&0!==p.kind&&(d="/"+d),S.tryImmediateResolve(i.getManifestAsync(l,"assetTypes"),(t=>{const s=c.toLowerCase(),i=MsPortalFx.find(t.assetTypes,(e=>e.name.toLowerCase()===s));return i||(R(e,n.Shell.deepLinkNotFound.format(c)),N.unfoundAsset(c)),c=i.name,E.Telemetry.trace({source:"Asset",action:"DeepLinkVisited",name:l,data:c}),e.get(m.CreateJourneyForAssetFunc).invoke(z(l,c,d,{},null,o))}),(t=>{throw R(e,n.Shell.deepLinkNotFound.format(l)),t}))}}}function Y(e,t){const i=e.get(p.AssetTypeService);return{navigateTo:(t,o)=>{let r=t.getHashParts().rest;r="/"+r.replace(/^\//,""),r=decodeURI(r);const a=r.split("/");let l=null;return a.length%2==0&&(l=a[a.length-1],r=r.slice(0,r.length-l.length-1)),S.tryImmediateResolve(Q(),(()=>S.tryImmediateResolve(i.assetTypesComplete,(()=>{const t=i.getAssetTypeByResourceType(s.ArmId.parse(r,!0).resourceType)||i.getAssetTypeByResourceTypeWithFallback(s.ArmId.parse(r).resourceType),a=t.assetTypeManifest,c=a.name,d=t.extension,p=a.resourceType.resourceTypeName;return c||(R(e,n.Shell.deepLinkNotFound.format(p)),N.noResourceAsset(p)),E.Telemetry.trace({source:"Resource",action:"DeepLinkVisited",name:d,data:p||MsPortalFx.Base.Constants.AssetNames.NonAssetResource}),e.get(m.CreateJourneyForAssetFunc).invoke(z(d,c,r,{},l,o))}))),(t=>{throw R(e,n.Shell.deepLinkErrorLoading.format(r)),t}))}}}function ee(e,t){const i=t.baseRouter;return{navigateTo:(t,o)=>e.get(I.Experimentation).shellAssignments.whenAvailable().then((async e=>{if(!e.getBooleanValue("browseroute")){const e="Browse Route experiment unavailable";return N.invalidLink(e),Promise.reject(FxImpl.createError(e))}{const e=t.getHashParts().rest.split("/");if(e?.length){const n=e.shift().toLowerCase(),d=e.join("/");let u="",m="";switch(n){case"all":case"resourceswithtag":u=p.lowerCaseAllResourcesType;break;case"resourcegroups":u=p.lowerCaseResourceGroupsType;break;case"recents":m="BrowseRecentResources.ReactView";break;case"favorites":m="BrowseFavoriteResources.ReactView";break;default:u=decodeURIComponent(n)}const g=(0,r.parseBladeInputs)(e,d,{parseJSON:!0,v2DeepLink:!0}),h=g.view,f=g.kind,x=g.filter,b=await(0,s.getBrowseBladeReference)({resourceType:u,kind:f});let y="";if(b||m){let e;if(""!==m)e={detailBlade:m,extension:"HubsExtension",detailBladeInputs:null,defaultMenuItemId:null},y=`#view/HubsExtension/${m}`;else{const t="resourceswithtag"===n?p.lowerCaseResourcesWithTagType:"",s={...b.parameters};h&&(s.view=h),x&&(s.filter=x),t&&(s.resourceType=t),e={detailBlade:b.blade,extension:b.extension,detailBladeInputs:s,defaultMenuItemId:null};const{serializedInputs:i}=(0,a.serializeViewInputs)(s,!0);y=`#view/${b.extension}/${b.blade}`+i}i.navigateWithRoute("view",new c.Uri(y),{openedByContext:o.openedByContext,route:e}).then((()=>{"browse"!==(0,r.getCurrentUri)().getHashParts().category&&(0,r.getCurrentUri)().hash!==t.hash&&l.replaceState({data:{},url:t.hash})}))}else y=`#view/HubsExtension/BrowseResource/resourceType/${n}`,i.navigateWithRoute("view",new c.Uri(y),{openedByContext:o.openedByContext}).then((()=>{l.replaceState({data:{},url:t.hash})}))}i.updateTitle()}}))}}function te(e,t){return{navigateTo:async(s,i)=>{const o=await function(e){return e.get(I.Experimentation).shellAssignments.whenAvailable().then((e=>e.getBooleanValue("servicemenuroute")))}(e);if(o){const o=t.baseRouter,r=s.getHashParts().rest.split("/"),a=r[0]||"",l=r[1]||"";if(!a||!l){const t=s.hash;return void R(e,n.Shell.deepLinkInvalid.format(t))}const c=r[2]||"",d={detailBlade:"ServiceMenuBlade",extension:"HubsExtension",detailBladeInputs:{extension:a,menuId:l,...c.length>0&&{itemId:c}},defaultMenuItemId:null};o.navigateWithRoute("view",s,{openedByContext:i.openedByContext,route:d})}}}}t.convertToBrowseRouteUrlOnValidBrowseBlade=j;class se{static create(e,t){return new L.RouterImpl(e,t,(0,v.getPortalViewModel)(e))}}t.Router=se,__decorate([__metadata("fx:diagnostics",[e,"Router"]),i.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.Container,FxImpl.Rpc.Client]),__metadata("design:returntype",se)],se,"create",null)})),
define("MsPortalImpl/Base/Base.Selectable2.Common",["require","exports","Fx/DependencyInjection"],(function(e,t,s){"use strict";t.OpenBladeTaskArgs=t.OpenBladeResources=t.OpenBladeConfig=void 0;let i=t.OpenBladeResources=class{};t.OpenBladeResources=i=__decorate([__metadata("fx:diagnostics",[e,"OpenBladeResources"]),s.Class("pipeline")],i);let o=t.OpenBladeConfig=class{};t.OpenBladeConfig=o=__decorate([__metadata("fx:diagnostics",[e,"OpenBladeConfig"]),s.Class("pipeline")],o);let n=t.OpenBladeTaskArgs=class{};t.OpenBladeTaskArgs=n=__decorate([__metadata("fx:diagnostics",[e,"OpenBladeTaskArgs"]),s.Class("pipeline")],n)})),
define("MsPortalImpl/Base/Base.Selectable2",["require","exports","Fx/Composition/Selectable","MsPortalImpl/Base/Base.Events","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Base/Base.ItemCache","MsPortalImpl/Base/Base.Selectable2.Common","MsPortalImpl/Base/Base.Pipeline","MsPortalImpl/UI/UI.BladeOpener"],(function(e,t,s,i,o,n,r,a,l){"use strict";t.createListSelectable=function(e,t){return g(e,t)},t.findExtensionViewModel=f,t.getFxClickSelectable=function(e,t,s,n,r){const a=n+"idmap",c=f(s);let d=MsPortalFx.Base.ProxiedObservables.data(c,a);d||(d=c?MsPortalFx.Base.ProxiedObservables.data(c,a,{}):{});const p=r;d[p]||(d[p]=ko.observable(),t.registerForDispose((()=>delete d[p])));const u=d[p],m=b(e,n,c,(e=>{const i=s.closest(".fxs-tile").data(o.CompositionInstanceDataName)||t.createChildLifetime(),n=e;ko.reactor(i,(()=>{const t=n.activationState();if(t){const s=t.previous&&t.previous.item,i=t.current&&t.current.item;s&&d[s]&&d[s](void 0),i&&d[i]&&d[i](e.value())}}))}));return{activated:u,invokeClick:(e,t,o)=>{if(m){const n=o?.target||s[0];m.invokeClickCallback(2,c,e,t,(0,i.getOrCreateFxElement)(n,c.internal.elements),p)}else t(null)},openBlade:m?async(t,s)=>{e.get(l.BladeOpener).openBlade(t,{selectable:m,telemetryName:s})}:(e,t)=>{},openContextPane:m?async(t,s)=>{e.get(l.BladeOpener).openBlade(t,{selectable:m,flags:1,telemetryName:s})}:(e,t)=>{}}},t.getOrCreate=g,t.getOrCreateCachedFxElement=function(e){if(e){const t=$(e),s=f(t),o=s?.internal?.elements||ko.observableArray();return(0,i.getOrCreateFxElement)(t[0],o)}return null},t.getOrCreateOpenBladeSelectable=b,t.isProvisioningBladeReference=x,t.setSelectableContext=function(e,t,s){const i=n.rotAdd(e,t);s.attr(h,i),e.registerForDispose((()=>{s.removeAttr(h)}))};var c=MsPortalFx.Base.ProxiedObservables,d=FxImpl.shellInterface;let p=1;const u=a.createDescriptor(r.OpenBladeConfig,r.OpenBladeResources,r.OpenBladeTaskArgs);u.registerAsync("MsPortalImpl/Base/Base.Selectable2.Pipeline","OpenBladeRequestHandler",(()=>!0)),u.registerAsync("MsPortalImpl/Base/Base.Selectable2.SupplyBladeReference","SupplyBladeReferenceHandler",((e,t,s)=>!s.bladeRequest)),u.registerAsync("MsPortalImpl/Base/Base.Selectable2.PPV3","ParameterProviderV3SelectableHandler",((e,t,s)=>function(e){const t=d(e);return t&&20560===t.type}(s.bladeRequest.bladeReference)),2),u.registerAsync("MsPortalImpl/Base/Base.Selectable2.Provisioning","OpenBladeHandler",((e,t,s)=>x(s.bladeRequest.bladeReference)),2);class m extends FxImpl.TriggerableLifetimeManager{isClickable(){return!0}constructor(e,t){super(),this.id=p++,this.isCanceled=!1,this.callbacks=ko.observableArray();const s=ko.observable(),i=FxImpl.shellInterface(t),o=ko.observable(!1),n={selectable:this,selectedValue:s,extensionVm:i,callbacks:this.callbacks},r=u.createPipeline(e,this,{},n);let a,l,c,d=0;this.setLifetimeReference=(e,t)=>{e===(d&e)&&(d|=e,t.registerForDispose({dispose:()=>{d^=e,d||this.dispose()}}))},this.value=ko.computed(this,{read:()=>{const e=o()?s():void 0;return void 0!==e?(c&&c!==l&&(c=l),l=a):l&&(c=l,l=void 0),e},write:e=>{void 0===e&&(o(!1),s(void 0))}}),this.processRequest=e=>{let t;if(a=e,e){if(3!==e.reason&&4!==e.reason||o(!0),4===e.reason)return void m(e.operationId,!!(2&e.flags),e.initialWidth);if(3===e.reason){let s;t=new Promise((e=>s=e)),r.startTask({bladeRequest:e,notifyBladeOpenCompleted:t=>s({operationId:e.operationId,success:t})})}}return t};const m=(e,t,i)=>{const n=this.createChildLifetime(),r=setTimeout((function(){let o=16;o|=t?8:0,s({operationId:e||MsPortalFx.getUniqueId(),flags:o,initialWidth:i})}),500),a=()=>{n.dispose()};s.subscribe(n,a),o.subscribe(n,a),n.registerForDispose((()=>{clearTimeout(r)}))};this.isSelected=ko.computed(this,{read:()=>o(),write:e=>{if(o()!==e)if(o(e),!0===e){const e=MsPortalFx.getUniqueId();m(e),this.isCanceled=!1,r.startTask({operationId:e,notifyBladeOpenCompleted:e=>{e||(this.isCanceled=!0)}})}else s(void 0)}}),this.onClick=()=>{this.isSelected(!0)},this.invokeClickCallback=(e,s,i,o,n,r,a,l)=>{s.invokeClickHandler(e,i,o,t,n,r,a,l)};const g=e=>e?{item:e.selectedItem,metadata:e.controlMetadata}:void 0;this.activationState=ko.computed(this,(()=>{this.value();return{previous:g(c),current:g(l)}})),this.refresh=()=>{const e=MsPortalFx.getUniqueId();m(e),r.startTask({operationId:e,notifyBladeOpenCompleted:MsPortalFx.noop})}}}function g(e,t){const s="Selectable";let i=c.disposableData(t,s);if(!i){i=function(e){const t=new FxImpl.TriggerableLifetimeManager;return e.setLifetimeReference(1,t),{selectable:e,dispose:()=>{t.dispose()}}}(new m(e,t)),c.disposableData(t,s,i)}return i.selectable}const h="data-fxselectable";function f(e){const t=(e=$(e[0].closest(`[${h}]`))).attr(h);return n.rotFind(t)}function x(e){const t=d(e);return t&&19792===t.type}function b(e,t,i,o){if(!i)return;const n=FxImpl.shellInterface(i.container),r=n.selectables();let a=r[t];const l=!a;if(l){const e=$.extend(!1,r);a=e[t]=new s.Selectable2({supplyBladeReference:MsPortalFx.noop}),n.selectables(e)}const c=g(e,a);return l&&o&&o(c),c}})),
define("MsPortalImpl/Base/Base.Selectable2.ClickContext",["require","exports"],(function(e,t){"use strict";function s(){return MsPortalFx.require("../UI/Compositions/UI.Composition.Selectable2Registrar",e)}t.getListSelectableWithClickHandler=function(e,t,i,o){const n=ko.observable();return{onClick:r=>{n()?n().onClick(r):s().then((s=>{n()||n(s.getListSelectableWithClickHandler(e,t,i,o)),n().onClick(r)}))},activationState:ko.pureComputed((()=>n()?n().activationState():{previous:void 0,current:void 0}))}},t.getSelectableWithClickHandler=function(e,t,i,o){const n=new FxImpl.TriggerableLifetimeManager,r=ko.observable();let a,l;function c(){s().then((s=>{if(!r()){const a=s.getSelectableWithClickHandler(e,ko.unwrap(t),i,o);a&&(a.registerForDispose(n),r(a))}r()&&(a&&(a=!1,r().onClick()),l&&(l=!1,r().isSelected(!0)))}))}ko.isObservable(t)&&t.subscribe(n,(()=>{r(void 0)}));const d=ko.computed(n,{read:()=>r()?r().isSelected():l,write:e=>{r()&&r().isSelected(e),e&&!l&&(l=!0,c())}}),p=ko.pureComputed((()=>!!r()&&r().isClickable())),u=ko.pureComputed((()=>r()?r().value():void 0));return{isSelected:d,isClickable:p,value:u,onClick:function(){r()?r().onClick():a||(a=!0,c())}}}})),
define("MsPortalImpl/Base/ClaimsIdentity",["require","exports","MsPortalImpl/Services/Services.Storage"],(function(e,t,s){"use strict";t.getAvatarImage=function(e,t,i,o,a){if(MsPortalFx.isFeatureEnabled("disableaadgraphendpoint"))return Promise.resolve(i);let l=i;if(t){const c=s.ComponentName.Avatar,d=0;if(l=!a&&o.getValue(c,e,d),!l)return n.ajax({uri:t,type:"GET",dataType:"binary",responseType:"arraybuffer",isBackgroundTask:!0,setAuthorizationHeader:{resourceName:"microsoft.graph"}}).then((e=>function(e){const t=Promise.withResolvers(),s=new FileReader,i="data:image/jpeg;base64,";return s.onload=e=>{let s=e.target.result,o="";const n=new Uint8Array(s);for(let e=0;e<n.byteLength;e++)o+=String.fromCharCode(n[e]);try{atob(o),s=i+o}catch(e){if(5!==e.code)return void t.reject(e);s=i+btoa(o)}t.resolve(s)},s.onerror=e=>t.reject(FxImpl.createError("Error reading thumbnail photo. Error:"+s.error)),s.readAsArrayBuffer(e),t.promise}(e)),(e=>{const t=e.jqXHR&&e.jqXHR.status;return 404!==t&&403!==t&&r.warning(`Failed to get user's profile image. Status code: ${t}. Error: \n${e}`),i})).then((t=>(o.setValue(c,e,t,d),t)))}return Promise.resolve(l)};var i=MsPortalFx.Base,o=i.Diagnostics,n=i.Net2;const r=o.createLog(e)})),
define("MsPortalImpl/Base/JQueryExtensions",["require","exports","MsPortalImpl/Base/JQueryHelper"],(function(e,t,s){"use strict";t.focusableSelector=void 0;var i=s.findByClassName;const o=window.document,n="msportalfx-skip-initial-focus",r=$.fn,a=t.focusableSelector="a[href], select, button, input, textarea, [tabindex]:not([tabindex='-1'])";function l(e){return function(t){return[a].reduce(((i,o)=>i&&i.length?i:function(e,t,i){const o=MsPortalFx.find(e,(e=>{const t=$(e);return!t.hasClass(n)&&!t.hasClass("fxs-display-none")&&!t.attr("tabindex")?.startsWith("-")&&s.isVisible(t)&&(!i||i(t))}),t?-1:0);return o?$(o):$([])}(this.find(o).toArray(),e,t)),null)}}r.setEvents=function(...e){let t=this;const s=function(s){const i=function(){return t[s].apply(t,arguments)};e.forEach((e=>{const t=e[0],s=e[1];if("function"==typeof s)i(t,s);else{const o=e[2];o&&i(t,s,o)}}))};return s("on"),{dispose:function(){t&&(s("off"),t=null)}}},r.findByClassName=function(e){return i(this,e)},r.findFirstTabbable=l(),r.findLastTabbable=l(!0),r.isInScrollView=function(e){let t;const s=e?this.closest("."+e):t=this.scrollParent();if(!s.length||!s[0].offsetParent||!s.is(t||this.scrollParent())&&!this.isInScrollView())return!1;const i=s.offset().top,o=i+s.height(),n=this.offset().top,r=n+this.height();return n>=i&&n<=o&&(r<=o&&r>=i)},r.handleTransitionEndOnce=function(e,t,s){let i,o=!1;this.on("transitionend",i=(t,...n)=>{const r=t&&t.originalEvent;r&&r.propertyName!==e||o||(o=!0,this.off("transitionend",i),s.apply(this,[t].concat(n)))});const n=function(){const t=$.Event("transitionend",{originalEvent:{propertyName:e}});i(t)};return $.fx.off?n():setTimeout(n,t),this},$.enableAnimations=function(e){const t="fxs-transition-off-style-head-marker",s=$(FxImpl.createElement("style")).addClass(t).text("* {transition: none !important;animation-iteration-count: .5 !important;animation-duration: 0s !important;animation-delay: 0s !important;}"),o=$.querySelectorAll("head");$.fx.off=!e,e?i(o,t).remove():0===i(o,t).length&&o.append(s)},$.querySelectorAll=function(e){return $(o.querySelectorAll(e))}})),
define("MsPortalImpl/Controls/ControlBindings.Async",["require","exports","MsPortalImpl/Controls/ControlBindings","MsPortalImpl/Widgets/Widgets.Common"],(function(e,t,s,i){"use strict";t.initialize=function(){c.forEach((e=>{ko.bindingHandlers[e.name]=i.getAsyncBindingHandler(e.moduleId,e.initOptions)}))},t.portalControlBindings=void 0;const o=[];function n(e,t,s,i){o.push({name:t,moduleId:e+s,initOptions:i})}function r(e,t,s){n("MsPortalImpl.Controls/",e,t,s)}function a(e,t,s){n("MsPortalImpl/Controls/",e,t,s)}const l={controlsDescendantBindings:!1};r("pcAccordion","Controls/Accordion"),r("pcButton","Controls/SimpleButton"),r("pcChart","Controls/Visualization/Chart"),r("pcCheckBoxField","Fields/CheckBoxField"),r("pcClipboardButton","Controls/ClipboardButton"),r("pcConsole","Controls/Console"),r("pcCopyableLabel","Controls/Forms/CopyableLabel"),r("pcCreatorAndSelectorV2","Fields/CreatorAndSelectorFieldV2"),r("pcCustomHtmlField","Fields/CustomHtmlField"),r("pcCustomValueSlider","Fields/CustomValueSliderField"),r("pcCustomRangeSlider","Fields/CustomRangeSlider"),r("pcDatePickerField","Fields/DatePickerField"),r("pcDateTimePickerField","Fields/DateTimePickerField"),r("pcDateTimeRangePickerField","Fields/DateTimeRangePickerField"),r("pcDayPickerField","Fields/DayPickerField"),r("pcDiffEditor","Controls/Documents/DiffEditor"),r("pcDockedBalloon","Controls/DockedBalloon"),r("pcDonut","Controls/Visualization/Donut"),r("pcDropDownField","Fields/DropDownField"),r("pcDurationPickerField","Fields/DurationPickerField"),r("pcEditor","Controls/Documents/Editor"),r("pcFilterComboField","Fields/FilterComboField"),r("pcGraph","Controls/Visualization/Graph"),r("pcGrid","Controls/Lists/Grid1/Grid1"),r("pcEditableGrid","Controls/Lists/Grid2/Grid2.EditableGrid.ctl"),r("pcDataGrid","Controls/Lists/Grid2/Grid2.DataGrid.ctl"),r("pcDocsControl","Controls/DocsControl"),r("pcPagedDataGrid","Controls/Lists/Grid2/Grid2.PagedDataGrid.ctl"),r("pcSequentialDataGrid","Controls/Lists/Grid2/Grid2.SequentialDataGrid.ctl"),r("pcPager","Controls/Pager"),r("pcPager2","Controls/Pager2"),r("pcHeatMap","Controls/HeatMap"),r("pcIFrame","Controls/IFrame"),r("pcIFrame2","Controls/IFrameV2"),r("pcLegend","Controls/Visualization/Legend"),r("pcList2","Controls/Lists/List2/ListView"),r("pcObsoleteListView1","Controls/Lists/List1/ListView1"),r("pcLogStream","Controls/LogStream"),r("pcMap","Controls/Visualization/Map"),r("pcMenu","Controls/Lists/Menu"),r("pcMetrics","Controls/Visualization/Metrics"),r("pcMonitorChart","Controls/Visualization/MonitorChartV2/MonitorChartV2"),r("pcMonitorChartV2","Controls/Visualization/MonitorChartV2/MonitorChartV2"),r("pcMetricGrid","Controls/Visualization/MonitorChartV2/MetricGrid"),r("pcMultiLineTextField","Fields/MultiLineTextField"),r("pcNumericTextBoxField","Fields/NumericTextBoxField"),r("pcOAuthButtonField","Fields/OAuthButtonField"),r("pcOAuthButtonV2Field","Fields/OAuthButtonV2Field"),r("pcOptionsGroupField","Fields/OptionsGroupField"),r("pcPairedTimeline","Controls/Visualization/PairedTimeline"),r("pcPairedTimelineBadges","Controls/Visualization/PairedTimelineBadges"),r("pcPasswordField","Fields/PasswordField"),r("pcPricingControl","Controls/PricingControl"),r("pcPreviewTag","Controls/PreviewTag"),r("pcProgressBar","Controls/Visualization/ProgressBar"),r("pcQuotaGauge","Controls/Visualization/QuotaGauge"),r("pcRangeSliderField","Fields/RangeSliderField"),r("pcSearchBox","Controls/SearchBox"),r("pcResourceFilter","Controls/ResourceFilter"),r("pcSection","Fields/Section"),r("pcSelectorField","Fields/SelectorField"),r("pcSimpleButton","Controls/SimpleButton"),r("pcSingleValueGauge","Controls/Visualization/SingleValueGauge"),r("pcSliderField","Fields/SliderField"),r("pcSplitter","Fields/Splitter",l),r("pcSplitter2","Fields/Splitter2"),r("pcSummary","Controls/Summary"),r("pcTextBlock","Controls/TextBlock"),r("pcTextBox","Fields/TextField"),r("pcTextField","Fields/TextField"),r("pcTimePickerField","Fields/TimePickerField"),r("pcToolbar","Controls/Toolbars/Toolbar"),r("pcTreeView","Controls/Lists/Tree1/TreeView"),r("pcTriStateCheckBox","Fields/TriStateCheckBox"),r("pcMarkdown","Controls/Markdown"),r("pcVideo","Controls/Video"),r("pcRecommendations","Controls/Recommendations/Recommendations"),a("pcAsyncFileUpload","Forms/AsyncFileUpload"),a("pcDeleteAssetConfirmation","Controls.DeleteAssetConfirmation"),a("pcEssentials","Controls.Essentials"),a("pcFileDownloadButton","Controls.FileDownloadButton"),a("pcResourceDropDown","Forms/ResourceDropDown"),a("pcHeroBanner","Controls.HeroBanner"),a("pcHotSpot","Controls.HotSpot",l),a("pcInfoBox","Controls.InfoBox"),a("pcNotice","Controls.Notice"),a("pcPickerV3","Controls.PickerV3"),a("pcPill","Controls.Pill"),a("pcPillCollection","Controls.PillCollection"),a("pcPillList","Controls.PillList"),a("pcTagsByResource","Controls.TagsByResource"),a("pcIntuneAppFileUpload","Forms/IntuneAppFileUpload"),a("pcFileShareDropDown","Storage/FileShareDropDown"),a("pcArmErrorList","ArmErrorList/Controls.ArmErrorList"),a("pcStorageAccountDropDown","Storage/StorageAccountDropDown"),a("pcToggle","Controls.Toggle"),a("pcBlobContainerDropDown","Storage/BlobContainerDropDown"),a("pcGroupDropDownField","Forms/DropDown"),a("pcManagementGroupDropDown","Forms/HierarchicalDropDown"),a("pcOpenCesCvaSurvey","Controls.OpenCesCvaSurvey"),r("pcTabMenu","Controls/Lists/TabMenu");const c=t.portalControlBindings=o})),
define("MsPortalImpl/InitShellWorker",["require","exports","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Extension/Extension","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Services/Services.AssetTypes","ShellWorker/ExtensionWorkerPrewarmer","ShellWorker/IFrameExtensionLoader","ShellWorker/AuthorizationState","ShellWorker/Browse","ShellWorker/Locations","ShellWorker/Subscriptions","ShellWorker/GlobalResourceFilters","ShellWorker/UserInfo","ShellWorker/AssetTypes","ShellWorker/FeatureCards","ShellWorker/PreloadData"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x,b,y,v){"use strict";t.init=function(e,t){S(e,t).then((()=>{P(e,t)}))},t.initWorker=I,t.initWorkerFromContainer=S,t.pushShellState=_,t.pushShellStateFromContainer=P;var w=MsPortalEarly.ExtensionLoader.getLoadType;const M="browse_columns",C="favorite_views";function S(e,t){const a=new MessageChannel;FxImpl.localRpcPort=a.port1;const l=a.port2;return Promise.all([e.getAsync(r.AuthStateManager),e.getAsync(o.ExtensionManagerOptions),e.getAsync(n.InitializedManifestCache),e.getAsync(i.ManifestCache),e.getAsync(FxImpl.Rpc.Client),e.getAsync(s.ExtensionManager)]).then((([e,s,i,o,n])=>{const r=e.getCurrentUser();I({extensions:s.extensionsAsMap,manifests:FxImpl.mapValues(s.extensionsAsMap,(e=>o.getManifest(e.name,"assetTypes"))),extensionRedirectMap:s.extensionRedirectMap,authState:MsPortalFx.extend2(e,{userObjectId:r.objectId,userTenantId:r.tenantId})},l,t),function(e,t,s){s?.registerForDispose((()=>{e=null})),t.onTokensUpdated((t=>{const{bootstrapState:s,tokenCache:i}=t,o=s?.oAuthToken;e&&u.pushShellAuthTokensEndPoint.invoke(e,"fxw",{portalToken:o&&{header:o.authHeader,expiresAt:o.expiresAt},extensionTokens:i})})),(()=>{const t=Object.create(null);p.loadExtensionInIFrameEndPoint.register(e,"fxw",(s=>{let i;const o=new Promise((e=>{i=t=>{e({telemetry:MsPortalFx.extend2(r.telemetry,{loadType:0}),error:t})}})),n=e.detachPort("fxw",s.portId),r=new MsPortalEarly.ExtensionLoader.IFrameLoadContext({...s,errorHandler:i,port:n});return r.initializeReceived.then((()=>{i()})),r.startLoad(),t[s.iframeId]=()=>{r.cleanup(),delete t[s.iframeId]},o})),p.disposeExtensionIFrameEndPoint.register(e,"fxw",(({iframeId:e})=>{const s=t[e];s?.()}))})(),(()=>{const t=Object.create(null);s?.registerForDispose((()=>{MsPortalFx.forEachKey(t,(e=>{t[e].terminate()}))}));const i=s?MsPortalEarly.ExtensionLoader.createPrewarmer():MsPortalEarly.ExtensionLoader.prewarmer;i.setListener({onCreated:({workerId:s,bootstrapPort:i,terminate:o})=>{let n;if(t[s]={terminate:()=>{n?.(),o()}},e){const t=e.acquireWindow("fxw",0,i);n=()=>{t.dispose()},d.pushNewWorkerEndPoint.invoke(e,"fxw",{workerId:s,portId:t.value})}},onBootComplete:(s,i)=>{e&&t[s]&&d.onWorkerBootCompleteEndPoint.invoke(e,"fxw",{workerId:s,error:i}),i&&delete t[s]}}),d.terminateWorkerEndPoint.register(e,"fxw",(({workerId:e})=>{const s=t[e];delete t[e],s?.terminate()})),d.onGetWorkerCalledEndPoint.register(e,"fxw",(()=>{i.onGetWorkerCalled()}))})()}(n,e,t)}))}function I(e,t,s){const i={onBootstrapError:e=>{MsPortalFx.Base.Diagnostics.Log.writeEntry2(2,"InitShellWorker",e.message||"unknown error from worker",9999,e.error&&[e.error,e])},uploadDiagnostics:e=>{const{telemetryEvent:t,logEntry:s,flush:i}=e;t&&MsPortalFx.Base.Diagnostics.Telemetry.trace(t),s&&MsPortalFx.Base.Diagnostics.Log.writeEntry2(s.level,s.area,s.message,s.code,s.args),1&i&&MsPortalFx.Base.Diagnostics.Telemetry.flush(),2&i&&MsPortalFx.Base.Diagnostics.Upload.flush()}};MsPortalEarly.ShellWorkerLoader.initWorker(function(e){const{extensions:t,manifests:s,extensionRedirectMap:i,authState:o}=e,{host:n,protocol:r,origin:a,pathname:l}=location,{bootstrapState:c,tokenCache:d,userObjectId:p,userTenantId:u}=o,m=(fx?.environment?.writesDisallowedTenants||[]).includes(u),g=c?.oAuthToken,h={portalToken:g&&{header:g.authHeader,expiresAt:g.expiresAt},extensionTokens:d||{},userObjectId:p,isWritesDisallowedTenant:m},f=fx.internalEnv,x=fx.environment;return{internalEnv:f,environment:MsPortalFx.extend2(x,{requireConfig:MsPortalFx.extend2(f.fxRequireConfig,{deps:[]})}),location:{host:n,protocol:r,origin:a,pathname:l},shellFeatures:FxImpl.features.shellFeatures,initOptions:{extensions:t,manifests:FxImpl.mapValues(s,(({pageVersion:e,prewarmerScript:t,weaveBladesMap:s,enableExperimentation:i})=>({pageVersion:e,prewarmerScript:t,weaveBladesMap:s,enableExperimentation:i}))),loadTypes:FxImpl.mapValues(s,(({flags:e},s)=>w(t[s],e))),extensionRedirectMap:i,authorizationState:h,effectiveLocale:FxImpl.Intl.effectiveLocale},userQuery:MsPortalEarly.userQuery}}(e),t,i,s)}function P(e,t){const s=e.getAsync(l.SubscriptionsUserContext),i=e.getAsync(l.ServicesSubscriptions);_(e.get(FxImpl.Rpc.Client),{locations:(0,a.lazyUserDataMemo)(e).then((({locations:e})=>e.value)),preloadedData:MsPortalEarly.preload,startupSubscriptionsInfo:i.then((e=>e.startupSubscriptionsInfoMemo())).then((({subscriptionsMap:e})=>({subscriptions:FxImpl.mapValues(e,(({subscription:e})=>e))}))),subscriptionsCount:s.then((e=>e.getAllSubscriptionsCount())),inSessionSelectedSubscriptions:s.then((e=>e.getInSessionSelectedSubscriptions())),userInfo:e.getAsync(r.AuthStateManager).then((e=>e.getUserInfo())),assetTypes:e.getAsync(c.AssetTypeService).then((e=>(0,c.assetTypesMemo)(e))),globalSelectedSubscriptions:s.then((e=>e.useAdvancedFiltersPromise)).then((e=>e?i.then((e=>e.globalSelectedSubscriptionsObservable)):void 0)),globalResourceFilter:(async()=>{const t=await s;if(await t.useAdvancedFiltersPromise)return MsPortalFx.require("MsPortalImpl/Services/Services.GlobalResourceFilters").then((t=>e.getAsync(t.ResourceFilterManager))).then((e=>e.currentFilterObservable))})(),featureCards:e.getAsync(c.AssetTypeService).then((e=>(0,c.featureCardsMemo)(e)))},t)}function _(e,t,s){s?.registerForDispose((()=>{e=null}));const{preloadedData:i}=t;if(i){const t=MsPortalFx.require("MsPortalImpl/Services/Services.Settings");i.then((async s=>{e&&v.pushPreloadDataEndPoint.invoke(e,"fxw",{variants:s?.variants});const i=s?.settings,[{Internal:o,SettingStore:n},r]=await Promise.all([t,MsPortalEarly.getCachedManifestUri("assetTypesBrowse")]),a=o.getSettingStoreName(15),l={15:i?.[a]?.[M],6:i?.[o.getSettingStoreName(6)]?.[M]},c=i?.[a]?.[C];e&&m.pushBrowseMetadataEndPoint.invoke(e,"fxw",{columns:l,favoriteViewIds:c,browseManifestsUri:MsPortalEarly.siteRelUriToAbsolute(r)})}))}t.locations?.then((t=>{const s=MsPortalFx.extendArrayIntoMap(Object.create(null),t,(e=>e.name),(e=>{const t=e.metadata||{};return{displayName:e.displayName,latitude:t.latitude,longitude:t.longitude}}));e&&g.pushLocationsEndPoint.invoke(e,"fxw",s)})),t.inSessionSelectedSubscriptions?.then((t=>{t.subscribeAndRun(new FxImpl.TriggerableLifetimeManager,(t=>{e&&t&&h.pushSelectedSubscriptionsEndpoint.invoke(e,"fxw",{inSession:t})}))})),t.globalSelectedSubscriptions?.then((t=>{t?.subscribe(new FxImpl.TriggerableLifetimeManager,(t=>{e&&h.pushGlobalFilterSubscriptionsEndpoint.invoke(e,"fxw",t)}))})),t.globalResourceFilter?.then((t=>{t?.subscribeAndRun(new FxImpl.TriggerableLifetimeManager,(t=>{e&&t&&f.pushActiveGlobalResourceFilterEndPoint.invoke(e,"fxw",t)}))})),t.startupSubscriptionsInfo?.then((t=>{e&&h.pushStartupSubscriptionsEndpoint.invoke(e,"fxw",t)})),t.subscriptionsCount?.then((t=>{e&&h.pushSubscriptionsCountEndpoint.invoke(e,"fxw",t)})),t.userInfo?.then((t=>{e&&x.pushUserInfoEndpoint.invoke(e,"fxw",t)})),t.assetTypes?.then((t=>{e&&b.pushAssetTypesEndPoint.invoke(e,"fxw",t)})),t.featureCards?.then((t=>{const s=Object.create(null);t.forEach(((e,t)=>s[t]=e)),e&&y.pushFeatureCardsEndPoint.invoke(e,"fxw",s)}))}})),
define("_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css",["module"],(function(e){"use strict";return{css:".fxs-keyboardshortcuts{width:355px;height:100%;max-width:100%}.fxs-keyboardshortcuts-scrollcontent{padding-top:10px;overflow:auto;height:100%}.fxs-keyboardshortcuts-category{margin-top:20px}.fxs-keyboardshortcuts-shortcut{display:flex}.fxs-keyboardshortcuts-key{flex:0 0 auto;width:113px}",moduleId:e.id}})),
define("MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/Widgets/Widgets.Portal","MsPortalImpl/Base/Base.Router","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.DeepLink","FxInternal/Css","_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css"],(function(e,t,s,i,o,n,r,a,l,c,d,p){"use strict";t.KeyboardShortcutHandler=void 0,t.fakeMacOS=function(){x=!0},t.setup=P,(0,d.injectCss)(p);var u=MsPortalFx.Base.Diagnostics,m=u.Telemetry;const g=window,h="#blade/HubsExtension/BrowseAllResourcesBlade/resourceType/Microsoft.Resources%2Fresources",f="#blade/HubsExtension/BrowseResourceGroupBlade/resourceType/Microsoft.Resources%2Fsubscriptions%2FresourceGroups";let x=l.isMac;const b=i.KeyboardShortcuts,y=b.GoTo,v=u.createLog(e),w=m.trace,M=[49,50,51,52,53,54,55,56,57,48],C=[97,98,99,100,101,102,103,104,105,96];function S(e){const t=function(e){return"Journey"===e.getDisplayMode()&&e.getJourneyWidget()}(e);let s=t&&t.getFocusedBlade();return s=s||t&&MsPortalFx.last(t.getBlades()),s}let I=t.KeyboardShortcutHandler=class{static create(e,t,s,i,o){return P(e,t,(()=>s.invoke()),(()=>i.invoke()),(()=>o.invoke()),null,g.fx.environment.chrome.hideShortcuts)}};function P(e,t,s,i,o,n,r){return new _(e,t,s,i,o,n,r)}__decorate([__metadata("fx:diagnostics",[e,"KeyboardShortcutHandler"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[r.ViewModel,a.Router,n.DownloadDiagnosticsJson,n.ShowDebugTools,n.ShowTelemetryInsights]),__metadata("design:returntype",I)],I,"create",null),t.KeyboardShortcutHandler=I=__decorate([__metadata("fx:diagnostics",[e,"KeyboardShortcutHandler"]),s.Class()],I);class _{constructor(e,t,s,i,o,n,r){this._keyShortcuts={},this._goToShortcuts={},this._eventHandlers=[],this._errorLoggingFunc=n||(e=>{v.error(e)}),this._registerShortcut(b.showDiagnostics,s,65,9),this._registerShortcut(b.showDebugHelper,i,68,9),MsPortalFx.isFeatureEnabled("telemetryinsights")&&this._registerShortcut(b.showTelemetryOverlay,o,84,9),r||(this._addKeyShortcuts(e),this._addGoToShortcuts(t,e),this._registerShortcut(b.moveFavoritesUp,(()=>{e.sideBar.reorderFavorites(38)}),38,5),this._registerShortcut(b.moveFavoritesDown,(()=>{e.sideBar.reorderFavorites(40)}),40,5)),this._attachEventHandlers()}dispose(){this._removeEventHandlers()}_attachEventHandlers(){this._removeEventHandlers();let e=!1;const t=this._eventHandlers;t.push({eventType:"keydown",handler:t=>{if(t.repeat)return;const s=o.getModifierKeys(t),i=t.keyCode;if(71===i&&0===s)return void(e=!0);const n=e?this._goToShortcuts[i]:this._keyShortcuts[i],r=n&&n[s];if(!r)return;const a=$(document.activeElement);a.length>0&&0===s&&(a.is("input")||a.is("textarea")||["azc-editableControl","fxc-editor","fxc-console"].some((e=>a.closest("."+e).length>0)))||(r.handler(),w({source:"KeyboardShortcuts",action:"KeyboardShortcutExecuted",name:r.id}),t.preventDefault())}},{eventType:"keyup",handler:t=>{71===t.keyCode&&(e=!1)}}),t.forEach((e=>{g.document.addEventListener(e.eventType,e.handler)}))}_removeEventHandlers(){this._eventHandlers.forEach((e=>{g.document.removeEventListener(e.eventType,e.handler)}))}_registerShortcut(e,t,s,i=0){const o=this._keyShortcuts[s];let n=i;x&&8&n&&e!==b.showDebugHelper&&(n=8^n|2);const r=this._generateIdForKeyboardShortcut(s,n),a={description:e,handler:t,id:r};o?o[n]&&this._errorLoggingFunc("Duplicate shortcut: "+r):this._keyShortcuts[s]=[],this._keyShortcuts[s][n]=a}_addKeyShortcuts(e){this._registerGotoShortcut(b.toggleFocusSideAndTopBar,(()=>{const e=$(document).find(".fxs-topbar-home")[0],t=$(document).find(".fxs-topbar-sidebar-collapse-button")[0];$(document.activeElement)[0]===e?$(t).is(":visible")?t.focus():$(document).find(".fxs-sidebar-collapse-button")[0].focus():e.focus()}),190),this._registerGotoShortcut(b.moveFocusToCommandBar,(()=>{const t=S(e),s=t&&t.getContentWidget();s&&s.setFocusOnCommandBar()}),188),this._registerShortcut(b.bladeSearch,(()=>{const t=S(e);t&&t.focusSearchBox()}),191,8),this._registerShortcut(b.bladeSearch,(()=>{const t=S(e);t&&t.focusSearchBox()}),55,12)}_registerGotoShortcut(e,t,s){const i=this._goToShortcuts[s],o=this._generateIdForKeyboardShortcut(s,0,!0),n={description:e,handler:t,id:o};i?i[0]&&this._errorLoggingFunc("Duplicate goto shortcut: "+o):this._goToShortcuts[s]=[],this._goToShortcuts[s][0]=n}_addGoToShortcuts(e,t){this._registerGotoShortcut(b.browse,(()=>{g.location.href=(0,c.getAllServicesDeeplink)()}),66),this._registerGotoShortcut(b.new,(()=>{t.sideBar.openCreate()}),78),this._registerGotoShortcut(b.search,(()=>{t.topBar.searchViewModel.setFocus()}),191),[[y.allResources,h,65],[y.resourceGroups,f,82]].forEach((t=>{this._registerGotoShortcut(t[0],(()=>{e.route(t[1],{openedBy:8})}),t[2])})),this._registerGotoShortcut(y.dashboard,(()=>{e.navigateWithRoute("dashboard",null,{interactionSource:"KeyboardShortcuts"})}),68);const s=(e,s)=>{const i=s+1;this._registerGotoShortcut(y.sideBarItem+i,(()=>{t.sideBar.openFavorite(s)}),e)};M.forEach(s),C.forEach(s)}_generateIdForKeyboardShortcut(e,t,s=!1){let i=s?"G+":"";return t>15&&this._errorLoggingFunc("Not allowed modifier!"),8&t&&(i+="CTRL+"),1&t&&(i+=x?"OPT+":"ALT+"),2&t&&(i+=x?"CMD+":"WIN+"),i+=o.mapKeyCodeToString(!(4&~t),e),i}getShortcuts(){return{key:this._keyShortcuts,goTo:this._goToShortcuts}}}})),
define("_generated/Less/MsPortalImpl/Interactions/Interactions.PrintHandler.css",["module"],(function(e){"use strict";return{css:'@media print{html,#web-container{-webkit-print-color-adjust:exact;color-adjust:exact}body{color-adjust:economy;background:none!important}@page{margin:.4in .2in}.fxs-show-startboard{background-color:inherit}pre,blockquote,tr,img,svg,[role="row"],[role="figure"],[role="img"],.fxc-chart{break-inside:avoid}p,h2,h3,h4,h5,h6{orphans:3;widows:3}h2,h3,h4,h5,h6{break-after:avoid}.fxs-blade,.fxs-blade-content-container,.fxs-blade-content-wrapper{display:block!important}.fxs-journey-target,.fxs-journey-layout,.fxs-bladecontent{display:block!important}.fxs-blade-content-container-default,.fxs-blade-content-container-details{width:100%!important}.fxs-portal-main,.fxs-portal-content{flex:0 0 auto;display:block!important}.fxs-panorama{width:100%}#web-container,.fxs-home-target,.fxs-startboard-target,.fxs-sidebar-flyout,.fxs-journey-target{position:static!important}body,#web-container,.fxs-panorama,.fxs-home-target,.fxs-startboard-target,.fxs-sidebar-flyout,.fxs-journey-target,.fxs-journey-layout,.fxs-blade-content-wrapper{overflow:visible!important}.fxs-menublade .fxs-blade-content-container-default{display:none!important}.fxs-tabmenublade .fxs-blade-content-container-default{display:none!important}.fxs-blade{box-shadow:none!important;width:100%!important}.fxs-blade:not(:last-of-type){display:none!important}.fxs-bladecontent-unlocked{background-color:transparent!important}html.fxs-printbladerequest .fxs-blade:not(.fxs-bladetoprint){display:none!important}html.fxs-printbladerequest .fxs-blade.fxs-bladetoprint{display:block!important}.fxs-startboard-layout{padding:25px}}.fxs-printmaxwidth{max-width:750px}',moduleId:e.id}})),
define("MsPortalImpl/Interactions/Interactions.PrintHandler",["require","exports","Fx/DependencyInjection","MsPortalImpl/Widgets/Widgets.Portal","FxInternal/Css","_generated/Less/MsPortalImpl/Interactions/Interactions.PrintHandler.css","Fx"],(function(e,t,s,i,o,n,r){"use strict";t.PrintHandler=void 0,(0,o.injectCss)(n);const a=window,l=MsPortalFx.Base.Diagnostics.Telemetry,c=a.document.documentElement;let d=t.PrintHandler=class{constructor(e){this._portalVm=e}init(e){const t=this._portalVm,s=()=>{const e=t.displayMode.value;let s=this._telemetryName||`Shell/${e}`;const i=this._telemetrySource||"BrowserCommand";let o=this._menuBladeCtx;if("Shell/Journey"===s){const e=MsPortalFx.last(t.getJourneyWidget().getBlades());e&&(s=e.getContentWidget().options.getTelemetryName(),o=e.options.isMenuBlade.peek()?e.options.getTelemetryName():null)}const n={action:"PrintRequest",source:i,name:s,data:{displayMode:e,menuBladeCtx:o}};return this._telemetryName=null,this._telemetrySource=null,this._menuBladeCtx=null,n},i=()=>{$.querySelectorAll(".fxs-bladetoprint").removeClass("fxs-bladetoprint"),c.classList.remove("fxs-printbladerequest"),$.querySelectorAll(".fxs-vivaresize:not(.fxs-journey):not(.fxs-blade):not(.fxs-bladecontent):not(.fxs-blade-content)").removeClass("fxs-printmaxwidth"),t.getJourneyArea().trigger("fxbladerepos")},o=()=>{l.trace(s()),"Dashboard"!==this._portalVm.getDisplayMode()&&p()};a.addEventListener("beforeprint",o),a.addEventListener("afterprint",i),e.registerForDispose((()=>{a.removeEventListener("afterprint",i),a.removeEventListener("beforeprint",o)}))}printBlade(e,t){this._telemetryName=t.name,this._telemetrySource=t.source,this._menuBladeCtx=t.menuBladeCtx,c.classList.add("fxs-printbladerequest"),e.classList.add("fxs-bladetoprint"),p(),r.delay(333).then(a.print)}printDashboard(){this._telemetryName="Shell/Dashboard",this._telemetrySource="Dashboard",a.print()}};function p(){$.querySelectorAll(".fxs-vivaresize:not(.fxs-journey):not(.fxs-blade):not(.fxs-bladecontent):not(.fxs-blade-content)").addClass("fxs-printmaxwidth")}t.PrintHandler=d=__decorate([__metadata("fx:diagnostics",[e,"PrintHandler"]),s.Class(),__metadata("design:paramtypes",[i.ViewModel])],d)})),
define("MsPortalImpl/Services/Services.SessionManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Base/Base.BrowserDetection","FxInternal/AsyncLoader","FxHubs/RpcEndPoints"],(function(e,t,s,i,o,n,r){"use strict";t.getSessionHistoryHandler=t.SessionManager=void 0;const a={};function l(e,t){e.setSettings({store:22,settings:{SessionHistory:{...t}}})}function c(e){const t=(new Date).getTime();return{sessionStart:t,lastSeen:t,browserAgent:{client:p(),version:navigator.userAgent},tenantName:e,operatingSystem:u()}}function d(e){if(e.sessionEnd)return"Closed";return(new Date).getTime()-e.lastSeen>9e5?"Idle":"Active"}function p(){return o.isEdge?"Edge":o.isChromiumEdge?"Edge Chromium":o.isChrome?"Chrome":o.isOpera?"Opera":o.isSafari?"Safari":o.isChromeIos?"iOS Chrome":o.isAndroidOrMobile?"Android":"Unknown"}function u(){try{const e=navigator.userAgent;let t="Unknown";return e.includes("Win")&&(t="Windows"),e.includes("Mac")&&(t="Mac"),e.includes("X11")&&(t="Unix"),e.includes("Linux")&&(t="Linux"),t}catch(e){console.error("OS was not parsed: "+e)}}async function m(e){let t;return MsPortalFx.forEachKey(e,(s=>{(void 0===t||e[s].sessionStart<e[t].sessionStart)&&(t=s)})),t}let g=t.SessionManager=class{constructor(e){this._settingsManager=e}async initialize(e){const t={...await this._getSessionHistory(),[MsPortalFx.sessionId]:c(e)};for(;MsPortalFx.keysLength(t)>10;){delete t[await m(t)]}l(this._settingsManager,t),await this._settingsManager.flushSettings()}async removeSession(e){const t=await this._getSessionHistory();delete t[e],l(this._settingsManager,t)}async updateLastSeen(){const e=await this._getSessionHistory(),t=(new Date).getTime();e[MsPortalFx.sessionId]={...e[MsPortalFx.sessionId],lastSeen:t},l(this._settingsManager,e)}async endSession(e){const t=await this._getSessionHistory();if(!t[e].sessionEnd){const s=(new Date).getTime();t[e]={...t[e],lastSeen:s,sessionEnd:s}}l(this._settingsManager,t)}async getSessions(){const e=await this._getSessionHistory();let t=Object.keys(e);t=MsPortalFx.stableSort(t,((t,s)=>e[s].sessionStart-e[t].sessionStart));const s=new Array(t.length);return t.forEach(((i,o)=>{s[o]={...e[t[o]],status:d(e[t[o]]),sessionId:t[o]}})),s}_getSessionHistory(){return async function(e){return(await e.queryStore(22,!0)).SessionHistory||a}(this._settingsManager)}};t.SessionManager=g=__decorate([__metadata("fx:diagnostics",[e,"SessionManager"]),s.Class(),__metadata("design:paramtypes",[i.SettingsManager])],g);t.getSessionHistoryHandler=(0,n.defineHandler)(r.SessionManager.getSessionHistoryEndPoint,(async e=>await e.diContainer.get(g).getSessions()))})),
define("MsPortalImpl/Services/Services.PortalPollingManager",["require","exports","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/Services/Services.SessionManager","MsPortalImpl/Services/Services.Subscriptions","Fx/Ajax","Fx/DependencyInjection","Fx","Weave","Fx/Experimentation"],(function(e,t,s,i,o,n,r,a,l,c,d){"use strict";t.PollingManager=t.DEV=void 0;var p=MsPortalFx.Base.Diagnostics.Telemetry;const u=FxImpl.features.isEnabled("selftoken");let m=MsPortalFx.isFeatureEnabled("pollservicehealthalerts"),g=MsPortalFx.isFeatureEnabled("outagebanner"),h=!0;let f=t.PollingManager=class{constructor(e){this._diContainer=e,this._polledData=(0,c.makeWritableComputation)(),this._lifetime=new FxImpl.TriggerableLifetimeManager,e.get(d.Experimentation).shellAssignments.whenAvailable().then((e=>{this._sessionManagerEnabled=e.getBooleanValue("sessionManager")}))}startPolling(){this._pollingHandle||l.delay(12e4).then((()=>{const t=()=>{this._sessionManagerEnabled&&this._diContainer.get(o.SessionManager).updateLastSeen(),async function(t){const o=["whatsNew"],a=t.get(s.PrivateLinkState).isPrivateLinked.value,l=t.get(s.ServiceDependencyState).azureResourceGraphUnavailable.value;g&&o.push("outages"),!m||a||l||o.push("serviceHealthAlerts");const c=p.startTrace({action:"PollPortalOnDemandData",source:"PortalPollingManager"});let d,h;try{const s=await t.get(i.SecurityTokensManager).getToken({extensionName:"fx",resourceName:"",skipCache:!1,isBackground:!1})||{token:{}},c=(await t.get(n.SubscriptionsUserContext).getInSessionSelectedSubscriptions())().map((e=>e.subscriptionId));if(h=await(0,r.postJSON)({isBackgroundTask:!0,uri:"/api/Portal/GetOnDemandData",setAuthorizationHeader:!u||{resourceName:"self"},headers:{"x-ms-feature-flags":JSON.stringify(MsPortalEarly.earlyBaseFeatureFlags)}},{armAuthorizationHeader:s.token.header,subscriptionIds:c,queries:o}),c.length){const s=await MsPortalFx.require(e.normalize("MsPortalImpl/Services/LazyUserData/LazyUserData.Deferred"));a&&m&&!l&&(h.serviceHealthAlerts=await s.getServiceHealthAlerts(c,t))}}catch(e){d=e}return p.endTrace(c,"complete",{counts:{irisNotifications:Object.keys((h?.irisNotifications||{}).Notifications||{}).length,outages:(h?.outages||[]).length,whatsNew:(h?.whatsNew||[]).length,serviceHealthAlerts:(h?.serviceHealthAlerts||[]).length},error:d,queries:o}),h}(this._diContainer).then((e=>{e&&this._polledData(e),this._pollingHandle=setTimeout((()=>{t()}),6e5)}))};(h?Promise.resolve():l.delay(6e5)).then((()=>t()))}))}getPolledDataObservable(){return this._polledData}dispose(){this._pollingHandle&&clearTimeout(this._pollingHandle),this._lifetime.dispose(),h=!0}};t.PollingManager=f=__decorate([__metadata("fx:diagnostics",[e,"PollingManager"]),a.Class(),__metadata("design:paramtypes",[a.Container])],f)})),
define("MsPortalImpl/Notifications/NotificationsArea",["require","exports","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Services/LazyUserData/LazyUserDataHelpers","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/Services/Services.PortalPollingManager","Fx","Fx/DependencyInjection","Weave"],(function(e,t,s,i,o,n,r,a,l){"use strict";t.delayTimeout=t.defaultPollingInterval=t.DataContext=t.DEV=void 0;var c=MsPortalFx.Base.Diagnostics.Telemetry;const d=MsPortalFx.isFeatureEnabled("fasteventservice"),p=MsPortalFx.getFeatureValue("irismessagelimit"),u=(0,r.memoizePromise)((()=>(0,r.require)(e.normalize("./WhatsNewCheck")))),m=t.defaultPollingInterval=d?5e3:6e4*(MsPortalFx.isFeatureEnabled("slowpollevents")?30:10);let g=t.delayTimeout=MsPortalFx.isDevelopmentMode&&MsPortalFx.isFeatureEnabled("fasteventservice")?1e4:3e4;let h=function(t,s){const i=s?.Notifications;let o=0;o=Number(p||1)>1&&Array.isArray(i)?i.length:i?1:0,o&&(0,r.require)(e.normalize("./PortalNotifications")).then((e=>{e.init(t,s)})),c.trace({source:"NotificationsArea",action:o?"IrisNotificationPresent":"IrisNotificationNotPresent",data:{count:o,requestedCount:p}})};function f(t,s){s&&s.length?(0,r.require)(e.normalize("./PortalNotifications")).then((e=>{e.initServiceHealthAlerts(t,s)})):c.trace({source:"NotificationsArea",action:"NoServiceHealthAlertsShown"})}let x=t.DataContext=class{constructor(e,t){this._diContainer=e,this._lifetime=new FxImpl.TriggerableLifetimeManager;const s=FxImpl.features.isNativePerf,a=MsPortalFx.getFeatureValue("skipeventpoll"),c=MsPortalFx.isFeatureEnabled("portalpolling"),d=MsPortalFx.isFeatureEnabled("pollservicehealthalerts"),p=MsPortalFx.isFeatureEnabled("showservicehealthalerts");if("true"===a||s&&"false"!==a)return void(p&&(0,i.lazyUserDataMemo)(this._diContainer).then((e=>{const t=e.serviceHealthAlerts||[];f(this._diContainer,t)})));const x=ko.observable([]);t.getInSessionSelectedSubscriptions().then((e=>{e.subscribeAndRun(this._lifetime,(e=>x(e)))})),x.subscribeAndRun(this._lifetime,(e=>{if(e&&e.length&&!this._initialized&&(this._initialized=!0,!c&&d)){const t=()=>{this._diContainer.get(o.ServiceDependencyState).azureResourceGraphUnavailable.value||(0,r.delay)(m).then((()=>{(0,r.require)("MsPortalImpl/Services/LazyUserData/LazyUserData.Deferred").then((s=>{s.getServiceHealthAlerts(e.map((e=>e.subscriptionId)),this._diContainer).then((e=>{f(this._diContainer,e),t()}))}))}))};(0,r.delay)(g).finally(t)}})),s||(0,r.delay)(g).then((()=>{u().then((e=>{e.checkForPortalUpdates(this._diContainer)}))})),c&&(0,l.subscribeAndRun)(this._lifetime,[this._diContainer.get(n.PollingManager).getPolledDataObservable()],(e=>{if(e){if(MsPortalFx.getFeatureValue("testbillingdownload"))try{h(this._diContainer,{FormatCulture:"en-us",Notifications:JSON.parse(MsPortalFx.getFeatureValue("testbillingdownload")),RequestDate:Date.now()})}catch(e){}else e.irisNotifications&&h(this._diContainer,e.irisNotifications);e.whatsNew&&u().then((t=>{t.showWhatsNewNotification(this._diContainer,e.whatsNew)})),e.serviceHealthAlerts&&f(this._diContainer,e.serviceHealthAlerts)}})),s||MsPortalEarly.preload.then((e=>{if(e=e||{},MsPortalFx.getFeatureValue("testbillingdownload"))try{h(this._diContainer,{FormatCulture:"en-us",Notifications:JSON.parse(MsPortalFx.getFeatureValue("testbillingdownload")),RequestDate:Date.now()})}catch(e){}else e.irisNotifications&&h(this._diContainer,e.irisNotifications);e.whatsNew&&u().then((t=>{t.showWhatsNewNotification(this._diContainer,e.whatsNew)}))}))}dispose(){!this._lifetime.isDisposed()&&this._lifetime.dispose()}};t.DataContext=x=__decorate([__metadata("fx:diagnostics",[e,"DataContext"]),a.Class(),__metadata("design:paramtypes",[a.Container,s.SubscriptionsUserContext])],x)})),
define("MsPortalImpl/Notifications/PortalNotifications",["require","exports","MsPortalFx/Globalization","MsPortalImpl/Notifications/NotificationsClientStrings","MsPortalImpl/Resources/PortalNotificationsTelemetry","Fx/DependencyInjection","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Notifications/IrisNotificationsTelemetry","Fx/Experimentation"],(function(e,t,s,i,o,n,r,a,l,c){"use strict";t.PortalNotifications=t.DEV=void 0,t.getToastDuration=f,t.init=async function(e,t){await e.get(y).publishIrisNotifications(t)},t.initServiceHealthAlerts=function(e,t){e.get(y).publishServiceHealthNotifications(t)},t.irisDurationMap=void 0;var d=MsPortalFx.Base.Diagnostics.Telemetry,p=MsPortalFx.Hubs.Notifications.NotificationStatus,u=FxImpl.Hubs.Notifications.InternalClientNotification;const m=MsPortalFx.getUniqueId,g=new Map;g.set("serviceissue",i.ServiceHealthAlertTypeNames.serviceIssue),g.set("plannedmaintenance",i.ServiceHealthAlertTypeNames.plannedMaintenance),g.set("healthadvisory",i.ServiceHealthAlertTypeNames.healthAdvisory),g.set("securityadvisory",i.ServiceHealthAlertTypeNames.securityAdvisory);let h=(0,r.hideSmallModals)();function f(e){let t=b[(e.duration||"").toString().toLowerCase()];return void 0!==t?t:(t=Number.parseInt(e.duration),t||0)}function x(e,t,s){d.trace({source:o.Source.PortalNotifications,action:e,actionModifier:t,data:s||{}})}const b=t.irisDurationMap={0:0,1:1,2:2,3:3,4:4,modal:4,sticky:2,long:1,short:0,suppress:3};let y=t.PortalNotifications=class{constructor(e,t){this._irisNotificationsTelemetry=e,this._diContainer=t,this._contactabilityModalDetails=null,this._shouldShowContactability=MsPortalFx.isFeatureEnabled("testcontactabilitymodal"),this._shouldShowIrisAdvisor=!1,this._irisMessageLimit=Number(MsPortalFx.getFeatureValue("irismessagelimit")||1)}_makeIrisAdvisorContent(e,t,s){const i=`${o.Action.IrisNotification}_${o.Action.IrisAdvisor}`;return{timestamp:new Date,title:e.title,modalNotificationData:e.modalNotificationData,description:e.description,descriptionAsHtml:!0,status:e.status||p.Information,toastDuration:s,inlineForm:{buttons:(e.button&&[e.button])??null},irisNotificationDetails:{...t,notificationId:i},notificationId:i}}async _handleBillingDownload(e,t,s){await this._irisNotificationsTelemetry.logIrisNotificationTelemetry({irisNotificationDetails:t,action:o.ActionModifier.BillingDownloadNotificationReceived});const i=MsPortalFx.getFeatureValue("testbillingdownload"),n=MsPortalFx.isFeatureEnabled("showbillingdownload");if(n||i){const r=(await this._diContainer.get(c.Experimentation).shellAssignments.whenAvailable()).getBooleanValue("showbillingdownloadnotification");if(r||i)return await MsPortalFx.require("MsPortalImpl/Notifications/BillingDownloadHelper").then((o=>o.showBillingDownloadNotification(this._diContainer,e,t,s,{expFlag:r,featureFlag:n,testFlag:i}))).catch((e=>{x(o.Action.IrisNotification,o.ActionModifier.NotificationNotShown_LoadBillingDownloadHelperFailed,{expFlag:r,featureFlag:n,testFlag:i})}))}}_handleContactabilityNotification(e){return this._contactabilityModalDetails=e,this._shouldShowContactability=!0,this._irisNotificationsTelemetry.logIrisNotificationTelemetry({irisNotificationDetails:e,action:o.ActionModifier.ContactabilityNotificationReceived})}_handleIrisAdvisor(e,t,s){if(MsPortalFx.isFeatureEnabled("showirisadvisor"))return this._shouldShowIrisAdvisor=!0,this._irisAdvisorContent=this._makeIrisAdvisorContent(e,t,s),this._irisNotificationsTelemetry.logIrisNotificationTelemetry({irisNotificationDetails:t,action:o.ActionModifier.AdvisorNotificationReceived})}async publishIrisNotification(e){const t=e?.ad?.properties,s=e?.prm?._imp,n=e?.tracking?.baseUri;if(!t||!s||!n)return void x(o.Action.IrisNotification,o.ActionModifier.NotificationNotShown_InvalidContent,{ad:!!e.ad,adProperties:!!t,tracking:!!e.tracking,trackingBaseUri:!!n,prm:!!e.prm,prmImp:!!s,traceId:m()});const r=t||{},a=r.notificationId||o.Action.IrisNotification+MsPortalFx.getUniqueId(),c={actionBeaconUri:n,impressionsUri:s,notificationId:a};if("true"===r.isControl||!0===r.isControl)return await this._irisNotificationsTelemetry.logIrisNotificationTelemetry({irisNotificationDetails:c,action:o.ActionModifier.ControlNotificationReceived});if("contactability"===(r.type||"").toLowerCase())return this.contactabilityProperties=r?.properties,await this._handleContactabilityNotification({...c,notificationId:o.Source.UpdateContactabilityDialog});if(r.title&&r.description){let e=f(r);if(!r.type){4!==e||MsPortalFx.isFeatureEnabled("allowirismodalnotifications")||(e=1);const t=[];return r.button&&t.push(r.button),"true"===r.showOptOut&&t.push({label:i.Iris.Notification.OptOutButton.label,secondary:!0,endpoint:{uri:(0,l.replaceActionWithAction)("Dismiss",c.actionBeaconUri),method:"GET",successMessage:i.Iris.Notification.OptOutButton.successMessage,failureMessage:i.Iris.Notification.OptOutButton.failMessage,body:null}}),u.internalPublish({timestamp:new Date,title:r.title,modalNotificationData:r.modalNotificationData,description:r.description,descriptionAsHtml:!0,status:r.status||p.Information,toastDuration:e,inlineForm:{buttons:t.length>0?t:null},irisNotificationDetails:c,notificationId:a}),await this._irisNotificationsTelemetry.logIrisNotificationTelemetry({irisNotificationDetails:c,action:o.ActionModifier.NotificationShown})}if("advisor"===r.type.toLowerCase())return this._handleIrisAdvisor(r,c,e);if("downloadinvoice"===r.type.toLowerCase())try{return await this._handleBillingDownload(r,c,e)}catch(e){}if(r.type)return void x(o.Action.IrisNotification,o.ActionModifier.NotificationNotShown_InValidNotificationType,{actionASID:(0,l.scrapeIrisValue)(n,"asid"),actionPID:(0,l.scrapeIrisValue)(n,"pid"),description:r.description,title:r.title,impressionASID:(0,l.scrapeIrisValue)(s,"asid"),impressionPID:(0,l.scrapeIrisValue)(s,"pid"),messageLimit:this._irisMessageLimit,traceId:m(),type:r?.type})}x(o.Action.IrisNotification,o.ActionModifier.NotificationNotShown_NoTitleOrDescription,{actionASID:(0,l.scrapeIrisValue)(n,"asid"),actionPID:(0,l.scrapeIrisValue)(n,"pid"),description:r.description,title:r.title,impressionASID:(0,l.scrapeIrisValue)(s,"asid"),impressionPID:(0,l.scrapeIrisValue)(s,"pid"),messageLimit:this._irisMessageLimit,traceId:m()})}async publishIrisNotifications(e){const t=e?.Notifications;if(!t||0!==MsPortalFx.localeCompareIgnoreCase(s.formatCulture,e.FormatCulture))return void x(o.Action.IrisNotification,o.ActionModifier.NotificationNotShown_NoNotificationsOrCultureMismatch,{cultureMatch:0===MsPortalFx.localeCompareIgnoreCase(s.formatCulture,e&&e.FormatCulture),formatCulture:s.formatCulture,hasIrisNotifications:!(!e||!e.Notifications),irisFormatCulture:e&&e.FormatCulture,traceId:m()});const i=!MsPortalFx.isArrayOrObservableArray(t);if(1===this._irisMessageLimit&&i)return await this.publishIrisNotification(t);if(i)return void x(o.Action.IrisNotification,o.ActionModifier.NotificationNotShown_NoNotificationsOrCultureMismatch,{type:typeof t,traceId:m()});const n=[];t.forEach((e=>{n.push(this.publishIrisNotification(e))})),await Promise.allSettled(n)}publishServiceHealthNotifications(e){e.forEach((e=>{const t=e.eventType&&g.get((e.eventType||"").toLowerCase());if(t&&e.description)return u.internalPublish({timestamp:new Date,title:t,description:e.description,status:"serviceissue"===e.eventType.toLowerCase()?p.Error:p.Information,notificationId:o.Action.ServiceHealthAlertNotification+m(),correlationIds:[e.trackingId],isServerEvent:!0,uri:`#blade/Microsoft_Azure_Health/AzureHealthBrowseBlade/trackingId/${e.trackingId}`});x(o.Action.ServiceHealthAlertNotification,o.ActionModifier.NotificationNotShown_InvalidContent,{title:e.eventType,description:e.description,traceId:m()})}))}shouldShowContactability(){return this._shouldShowContactability}shouldShowIrisAdvisor(){return this._shouldShowIrisAdvisor}showIrisAdvisor(e){if(this._shouldShowIrisAdvisor=!1,!h)return this._irisAdvisorContent?(u.internalPublish(this._irisAdvisorContent),this._irisNotificationsTelemetry.logIrisNotificationTelemetry({irisNotificationDetails:this._irisAdvisorContent.irisNotificationDetails,action:o.ActionModifier.NotificationShown}),e.get(a.SubscriptionsUserContext).getAllSubscriptionsCount().then((e=>{0===e.value&&x(o.Action.IrisNotification,"AdvisorModelSkipped",{subscriptionsCountType:e.type,traceId:m()})}))):void 0}async showContactabilityModal(t){if(this.shouldShowContactability())return this._shouldShowContactability=!1,MsPortalFx.require(e.normalize("MsPortalImpl/Notifications/ContactabilityHelper")).then((e=>e.invokeContactabilityModal(t,this._contactabilityModalDetails,this.contactabilityProperties)))}};t.PortalNotifications=y=__decorate([__metadata("fx:diagnostics",[e,"PortalNotifications"]),(0,n.Class)(""),__metadata("design:paramtypes",[l.IrisNotificationsTelemetry,n.Container])],y)})),
define("MsPortalImpl/Interactions/Interactions.Command",["require","exports"],(function(e,t){"use strict";t.FileInputOptions=t.CommandImpl=t.CommandContext=void 0;t.CommandContext=class{constructor(e,t){this.target=e,this.getFormTarget=t}};t.FileInputOptions=class{constructor(e,t){this.accept=e,this.maxFiles=t,this.files=ko.observable(null)}};t.CommandImpl=class{constructor(e,t,s){this._ariaLabel=ko.observable(),this._inheritIcon=ko.observable(),this.fxEnabled=ko.observable(!0),this.hasPopup=ko.observable(!1),this.ariaLabel=this._ariaLabel,this.enabled=ko.observable(!0),this.visible=ko.observable(!0),this.unauthorized=ko.observable(!1),this.pressed=ko.observable(),this.fileInputOptions=ko.observable(null),this.tooltip=ko.observable(),this.isShellCommand=!1;const i=this._ltm=e.createChildLifetime();this.text=ko.isObservable(t)?t:ko.observable(t||""),this.enabled(void 0===s||s),this.icon=ko.computed(i,{read:this._inheritIcon,write:e=>this._inheritIcon(e&&MsPortalFx.extend2(e,{options:$.extend({palette:99},e.options)}))})}get canRebind(){return!0}activate(){}execute(e){}bind(e){const t=e&&e.getFormTarget;e.getFormTarget=()=>t().then((t=>{if(t&&"function"!=typeof t.showForm)throw new Error("invalid context"+JSON.stringify(e,((e,t)=>e+typeof t)));return t})),this._currentContext=e}dispose(){this._ltm.dispose()}}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding",["require","exports"],(function(e,t){"use strict";t.ReferenceScope=t.ReferenceCardinality=t.PropertyTransformerArgs=t.PropertyBindings=t.PropertyBinding=t.ObservableChangeArgs=void 0,t.extractTraceOptions=x,t.getModelValue=g,t.inferredReferenceType=void 0,t.isDynamicBindingWithNonLocalSource=function(e){return e.isDynamicBinding&&!v(e.source)},t.isOverridesOrContainerModelSourceReference=v,t.mapSourceModelToTargetModel=function(e,t,s,i){const n=x(i,o),r={};Array.isArray(t)&&t.forEach((t=>{const i=t.source,o=t&&i&&i.scope===c.CurrentContainer&&i.modelType===s&&g(e,i.property);o&&o.exists&&(b(n,t.targetProperty,o.value),h(r,t.targetProperty,ko.toJS(o.value)))}));return r},t.setModelValue=h;var s=FxImpl.TriggerableLifetimeManager;const i=MsPortalFx.Base.Diagnostics.createLog(e),o=MsPortalFx.trace.inputsset,n=Array.prototype.splice,r=FxImpl.quickApplyArrayEdits,a=MsPortalFx.applyCall;function l(e,t,...s){return a(n,this,[e,t].concat(s.map(ko.toJS)))}var c,d;!function(e){e[e.CurrentContainer=0]="CurrentContainer",e[e.MasterContainer=1]="MasterContainer",e[e.DetailsContainer=2]="DetailsContainer"}(c||(t.ReferenceScope=c={})),function(e){e[e.OneToOne=0]="OneToOne",e[e.OneToMany=1]="OneToMany",e[e.ManyToOne=2]="ManyToOne"}(d||(t.ReferenceCardinality=d={}));class p{constructor(e,t){this.kind=e,this.propertyName=t}static forObject(e,t,s){const i=new p(0,e);return i.propertyValue=t,i.propertyOldValue=s,i}static forArray(e,t){const s=new p(1,e);return s.propertyArrayEdits=t||[],s}static forNewArray(e,t){const s=new p(1,e);return s.propertyValue=t,s}}t.ObservableChangeArgs=p;class u{constructor(e,t,s,i,o){this.cancel=!1,this.propertyChanges=[],this.sourceModelId=e,this.sourceModel=t,this.sourceProperty=s,this.targetModel=i,this.targetProperty=o}}t.PropertyTransformerArgs=u;class m{constructor(e,t,s,i,n,r){this.transformers=[],this.compositionBindingDefinition=null,this._callbacks=$.Callbacks(),this._errCallbacks=$.Callbacks(),this._awaitBound=Promise.withResolvers(),this._tgtHasValue=!1,this.sourceProperty=e,this.targetProperty=t,this.targetModel=s,this._tgtModelName=i,this.transformers=n,this._tgtPropExists=r,this._traceOptions=x(i,o)}sourceModelName(){return this._srcModelName}get sourceModel(){return this._srcModel}get isBound(){return!!this._srcModel}get awaitBound(){return this._awaitBound.promise}get targetHasValue(){return this._tgtHasValue}addValueChangedHandler(e){e&&this._callbacks.add(e)}removeValueChangedHandler(e){this._callbacks.remove(e)}addErrorHandler(e){e&&this._errCallbacks.add(e)}bind(e,t,i=!0,o,n){if(!this.isBound){if(this.addValueChangedHandler(o),this.addErrorHandler(n),this._validateBinding(e,t)){this._srcModelName=e,this._srcModel=t;const o=this._getSrcValue(),n=ko.utils.peekObservable(o);let r;if(i&&void 0!==n&&this._changeTgtModel(p.forObject(this.targetProperty,n)),ko.isObservable(o)){let e;r=o,this._bindingLifetime=new s,r.subscribe(this._bindingLifetime,(t=>{let s,i,o;Array.isArray(t)?(i=t,s=t.slice(0)):s=t,(r.splice||r.map)&&(o="arrayChange"),e&&e.dispose(),e=this._bindingLifetime.createChildLifetime(),r.subscribe(e,(t=>{let n;if(e.dispose(),e=void 0,"arrayChange"===o&&(n=t,t=r()),Array.isArray(s)&&Array.isArray(t))if(i===t){n=n||ko.utils.compareArrays(s,t,{sparse:!0});const e=p.forArray(this.targetProperty);e.propertyArrayEdits=ko.utils.adjustArrayEdits(n),this._changeTgtModel(e)}else this._changeTgtModel(p.forNewArray(this.targetProperty,t));else this._changeTgtModel(p.forObject(this.targetProperty,r(),s))}),null,o)}),null,"beforeChange")}else i||this._err("Error when binding. The value is not an observable and importInitialValue is false.");this._awaitBound.resolve()}else this._awaitBound.reject();return this}this._err("Property binding is already bound.")}unbind(){this._bindingLifetime&&this._bindingLifetime.dispose(),this._srcModel=null,this._srcModelName=null,this._callbacks.empty(),this._errCallbacks.empty()}toString(){return"\n\nDetails:\nSource model id: '{0}'.\nSource property: '{1}'.\nTarget model id: '{2}'.\nTarget property: '{3}'.\nSource model: '{4}'.\nTarget model: '{5}'.".format(this._srcModelName||"<UNBOUND>",this.sourceProperty,this._tgtModelName,this.targetProperty||"<DYNAMIC>",this._srcModel?f(this._srcModel):"<UNBOUND>",f(this.targetModel))}_changeTgtModel(e){const t=new u(this._srcModelName,this._srcModel,this.sourceProperty,this.targetModel,this.targetProperty);let s,i;e&&t.propertyChanges.push(e),this._processTransformers(t)&&((t.propertyChanges||[]).forEach((e=>{if(e.propertyName){const t=this._traceOptions;if(0===e.kind)this._tgtHasValue=void 0!==e.propertyValue,b(t,e.propertyName,e.propertyValue),h(this.targetModel,e.propertyName,ko.toJS(e.propertyValue));else{s=g(this.targetModel,e.propertyName).value,i=ko.unwrap(s);const o=e.propertyArrayEdits;if(Array.isArray(i)){if(o)t&&t.verbose&&o.forEach((s=>{"added"===s.status&&b(t,e.propertyName,s.value)})),ko.isObservable(s)&&s.valueWillMutate(),this._tgtHasValue=!0,r(i,o,{inplaceFixup:!1,spliceFunc:l}),ko.isObservable(s)&&s.valueHasMutated();else if(e.propertyValue){this._tgtHasValue=!0;const t=e.propertyValue;s.splice?s.splice.apply(s,[0,i.length].concat(t)):s(t)}}else this._err("[Property Binding] Array change detected on source property, but target property is not an array.")}}})),this._callbacks.fire(t.propertyChanges))}_processTransformers(e){return this.transformers.some((t=>(t(e),e.cancel))),!e.cancel}_getSrcValue(){return g(this._srcModel,this.sourceProperty).value}_validateBinding(e,t){let s;const i=this.compositionBindingDefinition,o=!(i&&i.optional);return this._validateModel(e,t,this.sourceProperty,o,(e=>{s=e}))?this.sourceProperty?this._validateModel(this._tgtModelName,this.targetModel,this.targetProperty,this._tgtPropExists,(e=>{s=e}))||(s="[Property Binding] Invalid target model - {0}".format(s)):s="[Property Binding] Invalid source model - Source property must be defined.":s="[Property Binding] Invalid source model - {0}".format(s),s&&this._err(s),!s}_validateModel(e,t,s,i,o){let n;return e?t?s&&i&&!g(t,s).exists&&(n="Model is missing property '{0}'.".format(s)):n="Model is undefined.":n="Model is missing an identifier.",n&&o&&o(n+"\nModel id: '{0}'.".format(e||"N/A")),!n}_err(e){this.isBound&&(e+=""+this);const t=MsPortalFx.trace;(MsPortalFx.isDevelopmentMode||t&&t.diagnostics)&&i.error(e),this._errCallbacks.fire(e)}}function g(e,t,s){const i=t?t.split("."):[],o={exists:e&&i.length>0,value:void 0};let n=e,r=0;const a=s?ko.utils.peekObservable:ko.unwrap;for(;o.exists&&r<i.length;)n=a(n),n&&n.hasOwnProperty(i[r])?n=n[i[r]]:o.exists=!1,r++;return o.exists&&(o.value=n),o}function h(e,t,s){const i=s=>{if(!s||"object"!=typeof s)throw new Error(function(e,t){const s=f(t);return s?"{0}\nModel: '{1}'".format(e,s):e}("A property in model hierarchy is not an object. Path: '{0}'.".format(t),e));return s},o=t.split(".");let n,r=i(e);for(let e=0;e<o.length-1;e++)n=o[e],MsPortalFx.isNullOrUndefined(r[n])&&(r[n]={}),r=i(ko.unwrap(r[n]));n=MsPortalFx.last(o),r[n]&&ko.isObservable(r[n])?r[n](s):r[n]=s}function f(e){let t;try{t=ko.toJSON(e)}catch(e){return e.message}return t}t.PropertyBinding=m;function x(e,t){if(!t)return;const s=e.toLowerCase(),i=e=>!(!MsPortalFx.isPlainObject(e)||MsPortalFx.isEmptyObject(e))&&Object.keys(e).every((e=>s.includes(e.toLowerCase()))),o=i(t.debug),n=i(t.log),r=i(t.verbose);let a;return(n||o||r)&&(a={debugId:e,breakOnInputsSet:o,verbose:r}),a}function b(e,t,s){e&&e.verbose&&!MsPortalFx.canSendThroughPostMessage(s)&&i.verbose("Inputs should be simple data objects without functions/observables: {0} | {1} | {2}".format(e.debugId,t,ko.toJSON(s)))}t.PropertyBindings=class{constructor(e,t,s){this._properties=[],this._propertyChangedCallbacks=$.Callbacks(),this._aggregatePropertyChangedHandler=e=>{this._propertyChangedCallbacks.fire(e)},this._targetModel=t,this._targetModelName=e,this._validateTargetPropertiesExist=!1!==s}get properties(){return this._properties.slice(0)}get targetModelName(){return this._targetModelName}get targetModel(){return this._targetModel}get awaitAllBound(){const e=this._properties.map((e=>e.awaitBound));return Promise.all(e)}get allBound(){return this.properties.every((e=>e.isBound))}addPropertyChangedHandler(e){this._propertyChangedCallbacks.add(e)}addProperty(e,...t){const s=new m(e,e,this._targetModel,this._targetModelName,t,this._validateTargetPropertiesExist);return s.addValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.push(s),s}mapProperty(e,t,...s){const i=new m(e,t,this._targetModel,this._targetModelName,s,this._validateTargetPropertiesExist);return i.addValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.push(i),i}removeProperty(e){const t=this._properties.indexOf(e);t>=0&&(this._properties[t].unbind(),this._properties[t].removeValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.splice(t,1))}getProperty(e){return MsPortalFx.find(this._properties,(t=>t.targetProperty===e))}unbind(){this._properties.forEach((function(e){e.unbind()})),this._propertyChangedCallbacks.empty()}toString(){let e="";const t=this.properties,s=this.properties.length;for(let i=0;i<s;++i)e+="properties[{0}]: {1}".format(i,t[i].toString());return e}};const y=t.inferredReferenceType=-999;function v(e){return e&&e.modelType===y}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.ImplUtils","FxHubs/ResourceManagement","MsPortalImpl/Base/Telemetry","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding"],(function(e,t,s,i,o,n,r,a,l,c){"use strict";t.Resources=t.PartContainerSelectable_ViewModelPath=t.PartContainerSelectableValue_ViewModelPath=t.OpenerConfiguration=t.DefaultConfiguration=t.Configuration=void 0,t.bindOutputsToSelectable2=function(e,t,s,i,o){let n;t.setLifetimeReference(8,s);const r=()=>{if(i.length||(i=s.bladeDefinition&&s.bladeDefinition.outputs||[]),i.length){const t={};n=new c.PropertyBindings(s.id+"-"+e,t,!1);const r=s.getViewModel(1);let a;n.addPropertyChangedHandler((()=>{a=MsPortalFx.clone(t,!0)})),i.forEach((e=>{n.mapProperty(e,e).bind(s.id,r,!0)})),a&&o&&o(a),n.addPropertyChangedHandler((()=>{const e=MsPortalFx.clone(t,!0);o&&o(e)}))}};(i.length||o)&&(s.isComposed?r():s.await(7).then(r),s.onDispose((()=>{n&&(n.unbind(),n=null)})))},t.detailsIsPartContainer=y,t.getAssociatedDetailDefinition=function(e,t,s){const i=t&&t.container,o=s.details;if(i&&i.selectable===e)return MsPortalFx.find(o,(e=>y(e)));if(!e)return null;return MsPortalFx.find(o,(s=>{const i=s.invocationInputArguments,o=s.selectablePath;return i?i.some((s=>s.valuesFrom.some((s=>{const i=[];return s.property.split(".").some((s=>(i.push(s),g(t,i.join(".")).value===e)))})))):!!o&&g(t,o).value===e}))},t.getSelectablePath=function(e){return e.blade?e.selectablePath||"container.selectable":function(e){const t=b(e);if(t){let e=t.split(".");const s=e.length;if(s>1){const t=e[s-1];return["value","activatedItems","selectedItems","selectedItem"].some((e=>e===t))&&(e=e.slice(0,s-1)),e.join(".")}}return null}(e)},t.isSelectable=function(e,t){const s=2===arguments.length?g(e,t).value:e;if(s){return[s.selectedValue,s.value,s.isSelected,s.isActivated,s.isCommandSelected,s.hasChildEdits].every(ko.isObservable)}return!1},t.isSelectableLocked=function(e){return!!e.isLocked()},t.isSelectableSet=function(e,t){const s=2===arguments.length?g(e,t).value:e;if(s){return[s.selectableItems,s.selectedItems,s.activatedItems,s.itemsWithChildEdits].every(ko.isObservable)}return!1},t.mapDynamicSelectionToBladeLocator=function(e,t,s,i){const o=t,n=t,l=t;let c;const d={};if(function(e,t,s,i){let o;const n=i,r=i,a=i;i?n.detailBlade||r.assetType||a.resourceId?n.detailBlade&&r.assetType?o="'detailBlade' and 'assetType' cannot be specified at the same time.":n.detailBlade&&a.resourceId?o="'detailBlade' and 'resourceId' cannot be specified at the same time.":r.assetType&&a.resourceId?o="'assetType' and 'resourceId' cannot be specified at the same time.":i.detailBladeInputs||(o="Model must define a 'detailBladeInputs' property."):o="Either 'detailBlade', 'assetType' or 'resourceId' must be specified on the model. ":o="Dynamic selection must be specified. ";o&&p(e.get(FxImpl.Rpc.Client),t,o,s,i);return!o}(e,s.name,i,t)){if(t.extension){let i=t.extension;i=e.get(r.ExtensionManagerOptions).resolveExtensionName(i),s=a.Locator.forExtension(i)}const u=e.get(a.DefinitionFinder);o.detailBlade?c=s.withBlade(o.detailBlade):n.assetType&&u.tryLocate(s.withAssetType(n.assetType),d)?c=v(s.name,d.value):l.resourceId&&e.get(a.LocatorContext).tryLocateAssetDefinitionFromResourceId(l.resourceId,d)?c=v(d.extensionName,d.value):p(e.get(FxImpl.Rpc.Client),s.name,"Unable to locate asset. Error: '{0}'. ".format(d.error),i,t)}c||(c=s.withBlade("##NOT_SPECIFIED##"));return c},t.needContainerSelectable=function(e){if(e){if(!e.filter((e=>e&&!e.selectablePath&&!e.invocationInputArguments)).length){if(!e.filter((e=>e&&"container.selectable"===e.selectablePath)).length){if(!e.filter((e=>{const t=b(e);return"container.selectable.value"===t||!e.blade&&"container.selectable"===t})).length)return!1}}return!0}return!1},t.traceInvocationChange=function(e,t,s,i,o,r){n.isDesktopTraceEnabled&&e.verbose(`[BladeOpener] ${t}\n Master Identifier: ${i.masterModelId}.\n  Master Property: ${o.source.property}\n  Master Value: ${void 0!==r?ko.toJSON(r):"<undefined>"}.\n  Current Detail Blades from Container: ${s.get(l.Finder).findSiblingBlades(i.referenceComposition).map((e=>`\n    ${e.toString()}. Model: ${ko.toJSON(e.getInputsOnlyViewModel())}`)).join("")||"<None>"}`)},t.validateDetailsDefinition=function(e,t,s){let i;const o=e.invocationInputArguments,n=o&&1!==o.length,r=o&&!n&&o[0].valuesFrom,a=e.outputArguments;n?i="Invocation arguments must exist and have only one element.":r&&r.length>1?i="Multiple 'valuesFrom' not supported for invocation arguments.":!e.blade&&o[0].property?i="Static invocation property is not supported when omitting the details blade name.":r&&void 0!==r[0].constantValue?i="Constants are not allowed on invocation argument.":a&&a.length>0&&(a.some((e=>!e.property))?i="Output arguments must specify a target property.":a.some((e=>1!==e.valuesFrom.length))?i="Output arguments support only one valueFrom property.":a.some((e=>void 0!==e.valuesFrom[0].constantValue))?i="Constants are not allowed on output arguments.":a.some((e=>1!==e.valuesFrom[0].referenceType))&&(i="Output arguments only support source ReferenceType.BladeInput."));!i&&s&&(i=s(e));if(i)return t.push(i),!1;return!0};var d=MsPortalFx.Base.Constants;MsPortalFx.Base.Diagnostics;function p(t,s,o,n,r){const a=`Error invoking detail blade for master '${n}'. ${o} Selection model: '${JSON.stringify(r)}'`;(0,i.logToExtension)(e,s,2,a,{rpcClient:t})}const u=t.PartContainerSelectable_ViewModelPath="container.selectable",m=t.PartContainerSelectableValue_ViewModelPath=u+".value",g=c.getModelValue;t.DefaultConfiguration={masterModelId:null,masterModel:null,referenceComposition:null,referenceExtension:null,isBladeOpenedByMaster:null,invocationThrottleDuration:25,configureBladeDescriptor:MsPortalFx.noop,onBladesOpening:MsPortalFx.noop,onBladeOpened:MsPortalFx.noop,addOutputBindings:MsPortalFx.noop,removeOutputBindings:MsPortalFx.noop,getCloseOwnedDetailBladesHandler:MsPortalFx.wrap(null),getCloseOtherDetailBladesHandler:MsPortalFx.wrap(null)};let h=t.Configuration=class{};t.Configuration=h=__decorate([__metadata("fx:diagnostics",[e,"Configuration"]),s.Class("pipeline")],h);let f=t.OpenerConfiguration=class extends h{};t.OpenerConfiguration=f=__decorate([__metadata("fx:diagnostics",[e,"OpenerConfiguration"]),s.Class("composition")],f);let x=t.Resources=class{};function b(e){const t=e&&e.invocationInputArguments,s=t&&t[0],i=s&&s.valuesFrom,o=i&&i[0];return o&&o.property}function y(e){const t=b(e),s=e.selectablePath;let i=!0;return t?i=t===m:s&&(i=s===u),i}function v(e,t){if(!t)return null;const s=t.contracts;return(0,o.supportsContract)(s,8)?a.Locator.forExtension("HubsExtension").withBlade(d.BladeNames.Hubs.ResourceMenuBlade):a.Locator.forExtension(t.bladeExtensionName||e).withBlade(t.bladeName)}t.Resources=x=__decorate([__metadata("fx:diagnostics",[e,"Resources"]),s.Class("pipeline")],x)})),
define("MsPortalImpl/UI/Compositions/UI.Composition.PropertyTransformers",["require","exports","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding"],(function(e,t,s){"use strict";t.PropertyTransformers=void 0;const i=MsPortalFx.Base.Diagnostics.createLog(e);var o;!function(e){const t={invalidNewValue:"[DynamicSelectionTransformer] [{0}] Source value does not implement MsPortalFx.ViewModels.DynamicSelection. Transformer Args: '{1}'"},o={invalidNewValue:"[ManyToOneTransformer] [{0}]: Source value '{1}' must be an array."},n={invalidPropertyChange:"[OneToManyMergeTransformer] [{0}]: No property change detected on source. Transformer Args: '{1}'.",invalidNewValue:"[OneToManyMergeTransformer] [{0}]: Source cannot be an array. Transformer args: '{1}'",invalidCurrentValue:"[OneToManyMergeTransformer] [{0}]: Target value '{1}' must be an array."};e.getDynamicSelectionMapper=function(){return e=>{if(function(e){const s=e.propertyChanges||[],o=1===s.length&&s[0].propertyValue,n=(o||{}).hasOwnProperty("detailBladeInputs");return o&&!n&&i.error(t.invalidNewValue.format(e.sourceModelId,JSON.stringify(e))),n}(e)){const t=e.propertyChanges[0],s=t.propertyValue;t.propertyValue=s.detailBladeInputs}}},e.getModelToPropertyMapper=function(){return e=>{let t,i;const o=e.propertyChanges||[];if(1===o.length&&MsPortalFx.isPlainObject(o[0].propertyValue))for(i in t=e.propertyChanges[0].propertyValue,e.propertyChanges=[],t)t.hasOwnProperty(i)&&e.propertyChanges.push(s.ObservableChangeArgs.forObject(i,t[i]))}},e.getManyToOne=function(){return e=>{const t=ko.unwrap(s.getModelValue(e.sourceModel,e.sourceProperty).value)||[];let n;!function(e,t){let s=!0;return Array.isArray(t)?1!==t.length&&(s=!1):(i.error(o.invalidNewValue.format(e.sourceModelId,JSON.stringify(t))),s=!1),s}(e,t)?e.cancel=!0:(n=e.propertyChanges[0],n.kind=0,n.propertyValue=t[0],n.propertyArrayEdits=null)}},e.getOneToManyMerge=function(){let e=null;return t=>{const o=ko.unwrap(s.getModelValue(t.targetModel,t.targetProperty).value);let r,a,l;const c=function(e,t){return MsPortalFx.findIndex(e,(e=>MsPortalFx.deepEquals(e,t)))};(function(e,t){let s=!0;return!t||!t.propertyChanges||t.propertyChanges.length<1?(i.error(n.invalidPropertyChange.format(t.sourceModelId,JSON.stringify(t))),s=!1):Array.isArray(t.propertyChanges[0].propertyValue)||t.propertyChanges[0].propertyArrayEdits&&t.propertyChanges[0].propertyArrayEdits.length>0?(i.error(n.invalidNewValue.format(t.sourceModelId,JSON.stringify(t))),s=!1):Array.isArray(e)||(i.error(n.invalidCurrentValue.format(t.sourceModelId,e)),s=!1),s})(o,t)&&(a=void 0===e?-1:c(o,e),r=t.propertyChanges[0],l=ko.unwrap(r.propertyValue),r.propertyArrayEdits=[],r.kind=1,a>=0&&e!==l&&r.propertyArrayEdits.push({status:"deleted",index:a,moved:null,value:e}),void 0!==l&&-1===c(o,l)&&r.propertyArrayEdits.push({status:"added",index:0,moved:null,value:l}),e=l),t.cancel=!r||!r.propertyArrayEdits||!r.propertyArrayEdits.length}}}(o||(t.PropertyTransformers=o={}))})),
define("MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder",["require","exports","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.PropertyTransformers","FxInternal"],(function(e,t,s,i,o,n,r,a){"use strict";t.CompositionBinder=void 0,t.getOnInputsSetTimeout=function(){return p},t.setOnInputsSetTimeout=function(e){p=e};var l=FxImpl.TelemetryContext,c=MsPortalFx.Base.Diagnostics,d=s.ReferenceScope;let p=5e3;const u=MsPortalFx.trace,m=u.inputsset,g=u.shellinputsset,h=c.createLog(e),f=s.extractTraceOptions,x=s.ReferenceCardinality;function b(e){let t=Promise.resolve();return{getStateAsyncSequenced:()=>(t=t.then(e,e),t)}}var y;!function(e){function t(e,t,i,o,n){const a=(s,o)=>{const n=i.mapProperty(s.source.property,s.targetProperty);n.transformers=function(e){const t=[];e.source.cardinality===x.OneToMany?t.push(r.PropertyTransformers.getOneToManyMerge()):e.source.cardinality===x.ManyToOne&&t.push(r.PropertyTransformers.getManyToOne());e.opensDynamicBlades&&t.push(r.PropertyTransformers.getDynamicSelectionMapper());e.targetProperty||t.push(r.PropertyTransformers.getModelToPropertyMapper());return t}(s),n.compositionBindingDefinition=s,o?n.bind(o.sourceModelName,o.sourceModel):E(e,t,n)};o&&o.forEach((e=>{const t=n&&n(e),o=e.source.constantValue;if(t&&t.overridesConstantBindings)a(e,t);else if(void 0!==o){const t="[Constant: {0}]".format(ko.toJSON(o)),n={};s.setModelValue(n,e.source.property,o);const r=i.mapProperty(e.source.property,e.targetProperty);r.compositionBindingDefinition=e,r.bind(t,n)}else a(e,t)}))}function c(e,t,s){return MsPortalFx.mapMany(e,(e=>(e.valuesFrom||[]).map((o=>{const n={property:o.property,modelType:o.referenceType,constantValue:o.constantValue,scope:d.CurrentContainer,cardinality:e.valuesFrom.length>1?x.OneToMany:x.OneToOne},r={targetProperty:e.property,source:n,optional:!!e.optional,isIdentityInput:!!e.isIdentityInput},a=o.part,l=t.locator.name;return(0===o.referenceType||o.partCommand)&&(n.partLocator=t.locator.getExtensionLocator().withPartInstance(a||l),!(0,i.isPartComposition)(t)||a&&a!==l||(n.id=t.id)),4===o.referenceType&&(n.modelId=o.bladeCommand||o.partCommand),s&&s(r,o),r}))))}function u(e,t){let s=!1;return(0,i.isPartComposition)(e)&&!e.isDisposed()&&(s=t.id?e.id===t.id:e.eligibleForBinding&&e.locator.getExtensionLocator().withPartInstance(e.locator.name).equals(t.partLocator)),s}function y(e,i){const o=[],n={allInputsSet:ko.observable(!1),calledOnInputsSet:ko.observable(!1),failedOnInputsSet:ko.observable(!1),definitionBindings:[],propertyBindings:new s.PropertyBindings(i.bindableTarget.viewModelName,{},!1)};return M(i.referenceComposition,i.inputs,o,i.customInputBindingValidator)?(n.definitionBindings=c(i.inputs,i.referenceComposition),t(e,i.referenceComposition,n.propertyBindings,n.definitionBindings,i.customBindHandler),n.inputsWatcherConfig=v({bindableTarget:i.bindableTarget,allInputsSet:n.allInputsSet,calledOnInputsSet:n.calledOnInputsSet,failedOnInputsSet:n.failedOnInputsSet,propertyBindings:n.propertyBindings,referenceComposition:i.referenceComposition,referenceCompositionIsContainer:i.referenceCompositionIsContainer,notifyWhenInputsChangeWithSameValues:!1,beforeViewModelPropertyUpdate:i.beforeViewModelPropertyUpdate,inputsSetCalled:i.inputsSetCalled})):h.error("{0} Reference: {1}.".format(JSON.stringify(o),i.bindableTarget.viewModelName)),n}function v(e){return MsPortalFx.extend2(e,{propertyBindingsState:void 0,inputsSetTrace:m,shellInputsSetTrace:g,stateReader:!!e.getStateAsync&&b(e.getStateAsync)})}function w(e){let t;S(e,null,e.calledOnInputsSet()),e.allInputsSet()||(t=function(e){const t={handle:setTimeout((()=>{k(t);const s=[],i=[];e.properties.forEach((e=>{const t=T(e),o="Target Input Name: {0} \nSource Model Name: {1} \nSource Property Name: {2} \nOptional: {3}".format(e.targetProperty,e.isBound?e.sourceModelName():"<UNBOUND>",e.isBound?e.sourceProperty:"<UNBOUND>",t);e.targetHasValue||t?i.push(o):s.push(o)}));const o="onInputsSet is taking more time than expected for target model: {0}\n=== Missing Required Properties === \n{1}\n\n=== All Other Properties === \n{2}";h.warning(o.format(e.targetModelName,s.join("\n\n"),i.join("\n\n")))}),p)};return t}(e.propertyBindings),e.referenceComposition.onDispose((()=>{k(t)})));const s=e;s.onInputsSetDiagnosticsHandle=t,e.propertyBindings.addPropertyChangedHandler((()=>{s.onInputsSetCallsSuppressed||S(e,t)}))}function M(e,t,s,o){let n;const r=(0,i.isPartComposition)(e);return t&&t.some((e=>(e.property?e.valuesFrom&&1===e.valuesFrom.length?r||0!==e.valuesFrom[0].referenceType||e.valuesFrom[0].part?5===e.valuesFrom[0].referenceType&&void 0===e.valuesFrom[0].constantValue?n="'constantValue' must be defined if using 'Constant' reference type.":void 0!==e.valuesFrom[0].constantValue&&5!==e.valuesFrom[0].referenceType?n="'constantValue' can only be be defined when using 'Constant' reference type.":o&&(n=o(e)):n="Input binding that reference a Part must specify the source part name.":n="Input binding must define one and only one source valueFrom property.":n="Input binding must define a target property.",n||4!==e.valuesFrom[0].referenceType||(e.valuesFrom[0].bladeCommand||e.valuesFrom[0].partCommand?e.valuesFrom[0].bladeCommand&&e.valuesFrom[0].partCommand?n="Only one, 'bladeCommand' or 'partCommand' is allowed when using 'Command' reference type.":e.valuesFrom[0].part&&(n="'part' is not allowed when using 'Command' reference type."):n="'bladeCommand' or 'partCommand' is required if using 'Command' reference type."),!!n))),!n||(s.push(n),!1)}function C(e,t){const i=(...e)=>"| "+e.map((e=>(e.toString()+"                    ").slice(0,15))).join("");let o=["-----------",i("Optional","isBound","hasValue","Input: Value")];const n=t.properties.map((e=>"{0}{1}: {2}".format(i(T(e),e.isBound,e.targetHasValue),e.targetProperty,ko.toJSON(e.targetHasValue?s.getModelValue(t.targetModel,e.targetProperty).value:void 0))));o=o.concat(n),o.push("-----------"),h.verbose("{0} Target Model: {1}\n{2}".format(e,t.targetModelName,o.join("\n")))}function S(e,t,s,i,o,n){return I(e,t,s,!0,i).then((function(t){let s;return t&&(t.dontCallViewModelOnInputsSet=o,l.usingState((()=>{s=function(e,t){const s=e.bindableTarget.viewModel,{inputs:i,settings:o,traceOptions:n,viewModelName:r,inputsMetadata:a,dontCallViewModelOnInputsSet:l,dashboardFilters:c,partFilters:d}=t,p=s.updatePartInputValues(i,o,n,r,a,l,{dashboard:c||{},part:d});return _(e,t,p),p}(e,t)}),e.referenceComposition.getCreationState())),n?s:void 0}))}function I(e,t,s,i,o){const n=!e.propertyBindings.properties.some(F),r=f(e.bindableTarget.viewModelName,e.inputsSetTrace),l=r&&r.verbose;if(!n)return l&&C("onInputsSet not called, missing required properties.",e.propertyBindings),e.propertyBindingsState=void 0,Promise.resolve(null);const c=ko.toJS(e.propertyBindings.targetModel);if(!i&&!MsPortalFx.canSendThroughPostMessage(c))return e.propertyBindingsState=void 0,Promise.resolve(null);if(k(t),!s&&e.notifyWhenInputsChangeWithSameValues||o||!MsPortalFx.deepEquals(c,e.propertyBindingsState)){let t;return e.allInputsSet(!0),e.propertyBindingsState=c,t=e.beforeViewModelPropertyUpdate?a.tryImmediateResolve(e.beforeViewModelPropertyUpdate(c),(t=>{if(t)return P(e,r);l&&C("onInputsSet not called, RBAC check failed.",e.propertyBindings)})):P(e,r),a.tryImmediateResolve(e.getInputsMetadata&&e.getInputsMetadata()||Promise.resolve({}),(s=>a.tryImmediateResolve(t,(t=>{const i={inputs:c,settings:t,traceOptions:r,viewModelName:e.bindableTarget.viewModelName,inputsMetadata:s,dontCallViewModelOnInputsSet:void 0,dashboardFilters:e.getDashboardFilters&&e.getDashboardFilters(),partFilters:e.getPartFilters&&e.getPartFilters()};return function(e,t){const{inputs:s,settings:i}=t,o=t.traceOptions;if(i&&(!e.referenceComposition||!e.referenceComposition.isDisposed())){const t=e.bindableTarget.viewModelName,n=f(t,e.shellInputsSetTrace);return o&&o.verbose&&C("onInputsSet will be called, all required properties are set.",e.propertyBindings),n&&(h.verbose("Invoking onInputsSet of view model '{0}'.\nInputs: {1}.\nSettings: {2}".format(t,ko.toJSON(s),ko.toJSON(i))),n.breakOnInputsSet),!0}return!1}(e,i)?i:null}))))}return l&&C("onInputsSet not called, new values are the same as current values.",e.propertyBindings),Promise.resolve(null)}function P(e,t){const s=e.referenceComposition;if(!s||!s.isDisposed()){const s=e.bindableTarget;if(!s.viewModel||s.viewModel.updatePartInputValues){const s=e.stateReader;return s?s.getStateAsyncSequenced().then((e=>e||{}),(()=>{t&&t.verbose&&C("onInputsSet not called, failed to retrieve part settings.",e.propertyBindings),e.failedOnInputsSet(!0)})):Promise.resolve({})}}return Promise.resolve(null)}function _(e,t,s){e.calledOnInputsSet(!0),e.inputsSetCalled&&e.inputsSetCalled(t.inputs,s||Promise.resolve({}))}function F(e){return!e.targetHasValue&&!T(e)}function T(e){const t=e.compositionBindingDefinition,s=t&&t.optional,i=t&&t.source,o=i&&i.scope===d.DetailsContainer;return!!(s||o)}function k(e){e&&e.handle&&(clearTimeout(e.handle),e.handle=null)}function E(e,t,s){if(t&&!t.isDisposed()){const i=function(e,t,s){const i=e.get(n.Finder),o=i.findPartsContainer(t);let r;switch(s.scope){case d.MasterContainer:r=o.masterContainer;break;case d.DetailsContainer:{const e=i.findBlades(o).filter((e=>e&&!(2&e.flags)));e.length>1?h.error("Unable to bind composition to detail blade, multiple detail blades found. Reference Composition: '{0}', Detail Blades: '{1}'.".format(t.toString(),e.map((e=>e.toString())).join(","))):r=e[0];break}default:r=o}return r}(e,t,s.compositionBindingDefinition.source);D(i,s,s.compositionBindingDefinition.source)(e,t,i,s,s.compositionBindingDefinition.source)}}function D(e,t,s){return e?s.partLocator?4===s.modelType&&t.compositionBindingDefinition.source.scope!==d.MasterContainer?N:B:R:A}function A(e,t,s,i,o){const r=e.get(n.Finder).findPartsContainer(t);a.tryImmediateResolve(r.awaitContainer(t,(e=>function(e,t,s){const i=t.masterContainer;if(t.isDisposed())return!1;if(1!==t.locator.type)return!1;if(s.scope===d.MasterContainer)return e.masterContainer&&e.masterContainer.id===t.id;if(s.scope===d.DetailsContainer){const t=e.diContainer.get(n.Finder);return i&&i.id===e.id&&1===t.findBlades(e).length}return i&&i.id===e.id}(r,e,i.compositionBindingDefinition.source))),(s=>{D(s,i,i.compositionBindingDefinition.source)(e,t,s,i,i.compositionBindingDefinition.source)}))}function B(e,t,s,i,o){a.tryImmediateResolve(s.awaitComposedPart(t,(e=>u(e,o))),(s=>{L(e,t,s,i)}))}function N(e,t,s,i,o){L(e,t,t,i)}function R(e,t,s,i,o){L(e,t,s.getBindableContainer(),i)}function L(e,t,o,n){const r=n.compositionBindingDefinition.source,a=r.modelType,l=r.modelId,c="[Composition: {0}, ModelType:{1}, ModelId:{2}]".format(o.toString(),a,l||"<null>");if(1===a||8===a){const e=o.getViewModel(a,l);n.bind(c,e)}else{const e=e=>{o.isDisposed()||n.bind(c,e)};try{const t=o.getViewModel(a,l);s.getModelValue(t,n.sourceProperty).exists&&e(t)}catch{}n.isBound||o.getViewModelAsync(a,l).then(e,(()=>{t.isDisposed()||h.error("Failed to retrieve view model type '{0}' with id '{1}' from composition '{2}' to bind source property '{3}'.".format(i.referenceTypeMap[a]||a,l||"<none>",o.toString(),n.sourceProperty))}))}const d=()=>{n.unbind(),o.offDispose(p)},p=()=>{n.unbind(),n.compositionBindingDefinition.autoRebindWhenSourceDisposes&&E(e,t,n),t.offDispose(d)};o.onDispose(p),t.onDispose(d)}e.setupPropertyBindings=t,e.modelHasProperties=function(e,t,i){const o=(t||[]).every((e=>i&&s.getModelValue(i,e).exists));return o||h.error("Model '{0}' is missing properties. Expected properties:'{1}', model:'{2}'".format(e,JSON.stringify(t)||"<null>",JSON.stringify(ko.toJS(i))||"<null>")),o},e.modelHasPropertiesWithValue=function(e,t,i){const o=(t||[]).every((e=>{const t=i&&s.getModelValue(i,e);return t&&t.exists&&void 0!==ko.unwrap(t.value)}));return o||h.error("Model '{0}' is missing required properties or has them set to undefined. Required properties:'{1}', model:'{2}'".format(e,JSON.stringify(t)||"<null>",JSON.stringify(ko.toJS(i))||"<null>")),o},e.createObservableModel=function(e){const t={};for(const s in e)if(e.hasOwnProperty(s)){const i=ko.toJS(e[s]);t[s]=Array.isArray(i)?ko.observableArray(i):ko.observable(i)}return t},e.mapInputBindingDefinitions=c,e.bindingsFromJSON=function(e,t){return(t||[]).forEach((t=>{const s=t.source,i=s&&s.partLocator;i&&(s.partLocator=o.Locator.fromJSON(e,i))})),t},e.mapBindingsToFriendlyObjects=function(e){return(e||[]).map((e=>{const t={targetProperty:e.targetProperty};return e.source&&(t.sourceProperty=e.source.property,t.sourcePartLocator=e.source.partLocator&&e.source.partLocator.toString(),t.sourceType=i.referenceTypeMap[e.source.modelType]||e.source.modelType,t.sourceScope=d[e.source.scope],t.sourceCardinality=x[e.source.cardinality]),t}))},e.isSourcePart=u,e.bindViewModelInputs=function(e,t){const s=y(e,t);return s.inputsWatcherConfig&&w(s.inputsWatcherConfig),s},e.createBindViewModelResult=y,e.setupAllInputsSetWatcher=function(e){w(v(e))},e.createAllInputsSetWatcherConfigExtended=v,e.setupAllInputsSetWatcherFromExtendedConfig=w,e.validateInputBindings=M,e.callOnInputsSetIfNeeded=S,e.turnOnInputsSetSuppressionOn=function(e){e.onInputsSetCallsSuppressed=!0},e.turnOnInputsSetSuppressionOff=function(e,t=1,s=!1){const i=e;return i.onInputsSetCallsSuppressed=!1,S(e,i.onInputsSetDiagnosticsHandle,!!(1&t),!!(2&t),!!(4&t),s)},e.loadOnInputsSetParameters=I,e.notifyOnInputsSetCalled=_}(y||(t.CompositionBinder=y={}))})),
define("MsPortalImpl/UI/Commands/UI.ExtensionCommands",["require","exports","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/UI.JourneyManager","FxInternal/AsyncLoader"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h){"use strict";t.ExtensionCommandImplOptions=t.CompositionInstanceCommandContext=void 0,t.createExtensionCommand=N,t.getCommandSourceTelemetryContext=R,t.setBladeOpenerModule=function(e){k=Promise.resolve(e)};var f=MsPortalFx.Base,x=f.Diagnostics,b=x.Telemetry,y=FxImpl.TelemetryContext,v=f.Resources,w=MsPortalFx.ViewModels.Dialogs,M=a.CompositionType,C=c.CompositionBinder,S=d.ReferenceScope,I=f.Net2;const P=window,_=x.createLog(e),F=MsPortalFx.isNullOrUndefined,T=MsPortalFx.uncurryThis(Array.prototype.forEach);let k=null;const E={invocationInputArguments:[{valuesFrom:[{referenceType:4,property:"container.selectable"}]}]},D=n.FileDownloadCommand,A=n.UriCallbackCommand,B=412;function N(e,t,s,i){let o;return t.lc2?o=new Q(e,s,i):t.viewModel?o=new K(e,s,i):t.execute?o=new H(e,s,i):t.navigateUriCallback?o=new q(e,s,i):t.navigateUri?o=new O(e,s,i):t.listItems?o=new $(e,s,i):t.targetUri&&t.httpMethod?o=new G(e,s,i):(i.commandItem.commandDefinition.details||t.bladeName)&&(o=new J(e,s,i)),o}function R(e){const t=e;let s=null;if(!(e instanceof L))throw new Error("Command context was not an instance of CompositionInstanceCommandContext. All context objects are expected to be of that type.");const i=t.compositionInstance,o=i?.locator;return o&&(s={id:o.toFriendlyString(),instanceId:i.instanceId}),s}class L extends r.CommandContext{constructor(e,t,s){super(e,t),this.compositionInstance=s}}t.CompositionInstanceCommandContext=L;t.ExtensionCommandImplOptions=class{};class z{constructor(e,t,s){this._extension=s.extension,this._viewModelName=s.viewModelName,this.viewModel=t,this.commandItem=s.commandItem,this._commandContainer=s.container;const i=this._ltm=e.createChildLifetime();this._propertyBindings=s.propertyBindings,this._diContainer=s.diContainer;const n=s.diContainer.get(o.ViewModelManager);i.registerForDispose((()=>{this.viewModel&&(n.releaseViewModel(this.viewModel),this.viewModel=null),this._propertyBindings&&(this._propertyBindings.unbind(),this._propertyBindings=null)}))}init(){}execute(e,t){const s=this._diContainer.get(g.JourneyManager).activeJourney(),i=R(this._context());y.setContextValue(y.ContextType.Blade,i),b.trace({extension:this._extension.name,source:i&&i.id,action:"CommandExecuted",name:this._viewModelName,data:e,journeyId:s&&s.id}),y.resetContextValue(y.ContextType.Blade)}dispose(){this._ltm.dispose()}_context(){return this.commandItem.getCommandContext()}_getFormTarget(){return this._context().getFormTarget()}_target(){const e=this._context();return e?.target}}class H extends z{constructor(e,t,s){super(e,t,s),this._viewModel=t.content(),this._diContainer.get(u.DesktopManagerMode).value.subscribe(this._ltm,(e=>{this._getFormTarget().then((t=>{1===e&&t&&t.hideForm()}))}))}execute(e,t){super.execute(e,t);const s=this._viewModel;1===s.status()?Promise.all([this._diContainer.getAsync(m.DialogManager),this._getFormTarget()]).then((([e,t])=>{this._loadDialog(t,e,ko.unwrap(s.dialog))})):s.status(1),s.execute(t)}init(){const e=this._viewModel,t=this._ltm,s=(e,t,s)=>{0===s?e.hideForm():1===s&&this._loadDialog(e,t,ko.unwrap(this._viewModel.dialog))},i=(e,t,s)=>{1===this._viewModel.status()&&this._loadDialog(e,t,s)};this._diContainer.getAsync(m.DialogManager).then((o=>{e.status.subscribe(t,(e=>{this._context()&&this._getFormTarget().then((t=>{s(t,o,e)}))})),ko.isObservable(e.dialog)&&e.dialog.subscribe(t,(e=>{this._getFormTarget().then((t=>{i(t,o,e)}))}))}))}_loadDialog(e,t,s){if(e&&!(MsPortalFx.deepEquals(this._currentDialogOptions,s)&&t.hasOpenDialog||(t.hasOpenDialog||(this._previouslyFocusedElement=document.activeElement),this._currentDialogOptions=s,F(s)))){if(!this._target())return;const i=this._commandContainer.locator,o=i?.withCommand(this.commandItem.commandName),n=t.hasOpenDialog&&this._previouslyFocusedElement?this._previouslyFocusedElement.contains(this._target())?this._target():this._previouslyFocusedElement:this._target();this.commandItem.pressed(!0),t.showDialog(s,e,n,{locator:o}).then((e=>{this.commandItem.pressed(!1);const t=this._viewModel,s=t?.dialogClick;"function"==typeof s&&s.call(t,e)}))}}}class O extends z{constructor(e,t,s){super(e,t,s),this._viewModel=t.content(),this.canSkipBladeValidation=!0}execute(e){const t=this._viewModel,s=t.navigateTarget?t.navigateTarget():"_blank";super.execute(e),P.open(t.navigateUri(),s)}}class U extends z{constructor(e,t,s){super(e,t,s),this.canSkipBladeValidation=!0}_getLocator(){const e=this._commandContainer.locator,t=e?.withCommand(this.commandItem.commandName);return t}_showUriCbProgressDlg(e,t,s){this._showProgressDlg(e,t,this._uriCbProgressTitle,this._uriCbProgressText,s)}_showDownloadProgressDlg(e,t,s){this._showProgressDlg(e,t,this._progressTitle,this._progressText,s)}_showProgressDlg(e,t,s,i,o){const n=new w.ProgressBox(s,i);t.showDialog(n,e,this._target(),{locator:this._getLocator()})}_getResources(e){const t=e.uriCallbackConfirmationDialogOptions||{},s=e.downloadProgressDialogOptions||{};this._uriCbProgressTitle=t.uriCallbackProgressTitle||D.uriCallbackProgressTitle,this._uriCbProgressText=t.uriCallbackProgressText||D.uriCallbackProgressText,this._dnldTitle=t.downloadTitle||D.downloadTitle,this._dnldText=t.downloadText||D.downloadText,this._defaultBtnText=t.defaultButtonText||D.defaultButtonText,this._cancelBtnText=t.cancelButtonText||D.cancelButtonText,this._progressTitle=s.downloadProgressTitle||D.downloadProgressTitle,this._progressText=s.downloadProgressText||D.downloadProgressText}}function W(e,t){const s=t&&t.title,i=t&&t.description;e.getAsync(h.get("MsPortalImpl/UI/Hubs/UI.NotificationManager","NotificationManager")).then((e=>{e.addSingleNotification({title:s||A.uriCallbackCommandError,description:i||A.error,status:2})}))}function V(e,t,i){const o=s.sanitizeLinkUri(e,i);o?P.open(o,t):(_.error(A.invalidUri.format(e)),W(i.diContainer))}class q extends U{constructor(e,t,s){super(e,t,s),this._viewModel=t.content(),this._getResources(this._viewModel),this.canSkipBladeValidation=!0}execute(t){super.execute(t);const i=this._viewModel.navigateTarget?this._viewModel.navigateTarget():"_blank",o=this._viewModel,n=o.navigateUriCallback&&o.navigateUriCallback(),r=this.commandItem.fxEnabled,a=o.showUriCallbackConfirmationDialog&&o.showUriCallbackConfirmationDialog(),l=e=>{e.hideForm(),r(!0)};let c,d=!0;const p={localRequire:e,windowContext:this._extension.name,diContainer:this._diContainer};n&&a?(r(!1),Promise.all([this._diContainer.getAsync(m.DialogManager),this._getFormTarget()]).then((([e,s])=>(this._dlgMgr=e,this._showUriCbProgressDlg(s,e,t),Promise.resolve(o.navigateUriCallback()()).then((t=>{d=!1;const o=new m.MessageBox(this._dnldTitle,this._dnldText,2);o.defaultButtonText=this._defaultBtnText,o.cancelButtonText=this._cancelBtnText,e.showDialog(o,s,this._context().target,{locator:this._getLocator(),syncCallback:e=>{4===e&&V(t,i,p),l(s)}}),s.showForm(this._target())}),(e=>{W(this._diContainer,e)})).finally((()=>{d&&(_.error(A.callbackError.format("navigateUriCallback failed.")),c&&c.close(),this._dlgMgr&&this._dlgMgr.dismissOpenDialog(),l(s))}))))).catch((e=>{_.error(e)}))):n?(r(!1),c=P.open("about:blank",i),Promise.resolve(n()).then((e=>{d=!1,s.sanitizeUri(e,null,p)?c.location.href=e:(_.error(A.invalidUri.format(e)),W(this._diContainer),c.close())}),(e=>{W(this._diContainer,e)})).finally((()=>{d&&(_.error(A.callbackError.format("navigateUriCallback failed.")),c.close()),this._getFormTarget().then((e=>{l(e)}))}))):V(o.navigateUri(),i,p)}}class $ extends z{constructor(e,t,s){super(e,t,s);const i=this._ltm,o=this.commandItem,n=t.content(),r=o.widgetViewModel.dialogOptions;ko.reactor(i,(()=>{r.listItems(n.listItems())})),n.selectedItem.subscribe(i,(e=>{r.selectedItem(e)})),r.selectedItem(n.selectedItem()),o.hasPopup(!0),r.selectedItem.subscribe(i,(e=>{n.selectedItem(e)})),this.canSkipBladeValidation=!0}execute(e){super.execute(e)}}function j(e,t,s,i){F(e)||"function"!=typeof e||!i&&F(e())||function(e,t){_.warning("The '"+e+"' property of a command viewModel contains a value. This value will be ignored when passing to '"+t+"' dynamic command viewModel.")}(t,s)}class G extends U{constructor(e,t,s){super(e,t,s),this._viewModel=t.content(),this._getResources(this._viewModel),i.isSafari&&i.webKitVersion<i.safari_11_webKitVersion&&(this.commandItem.fxEnabled(!1),this.commandItem.tooltip(n.FileDownloadCommand.safariDownload)),this.canSkipBladeValidation=!0}execute(e){super.execute(e);let t=null;const s=this.commandItem.fxEnabled;s()&&f.Promises.cancelOnDispose(this._ltm,MsPortalFx.require("MsPortalImpl/Commands/FileDownloadUtil")).then((i=>{const o=this._viewModel,n=i.getHttpMethod(o),r=e=>{e.hideForm(),s(!0)};if(!n)return i.notifyError(o,B,D.typeError),void this._getFormTarget().then((e=>{r(e)}));s(!1),o.downloadStatus(null);const a=this._diContainer.getAsync(m.DialogManager),l=this._getFormTarget(),c=Promise.all([a,l]).then((([t,s])=>this._getUri(s,t,e)));return Promise.all([a,c,l]).then((([s,r,a])=>{const l=r&&r.startsWith("data:");if(!v.isUriAbsolute(r)&&!l)return void i.notifyError(o,B,D.absoluteUriError);o.showDownloadProgressDialog&&o.showDownloadProgressDialog()&&this._showDownloadProgressDlg(a,s,e);const c=R(this._context());if(t=b.startTrace({extension:this._extension.name,source:c&&c.id,action:"StartFileDownload",name:this._viewModelName,data:e}),!l)return I.ajaxExtended(i.getAjaxOptions(o,r,n)).then((e=>{if(this.viewModel){const n=e.content,r=n?.length?n.length:0;return i.onSuccess(o,s,n,e.textStatus,e.jqXHR).then((()=>{b.completeTrace(t,r)}))}}),(e=>(i.onError(o,s,e.textStatus,e.jqXHR.status,e.errorThrown),b.cancelTrace(t),Promise.reject(e.errorThrown))));i.dataUriHandler(o,s,r)})).catch((e=>{e&&_.error(e),b.cancelTrace(t)})).finally((()=>{l.then((e=>{r(e)}))}))})).catch((e=>{e&&_.error(e)}))}_getUri(e,t,s){const i=this._viewModel,o=i.targetUriCallback&&i.targetUriCallback(),n=i.showUriCallbackConfirmationDialog&&i.showUriCallbackConfirmationDialog();return f.Promises.cancelOnDispose(this._ltm,MsPortalFx.require("MsPortalImpl/Commands/FileDownloadUtil")).then((r=>{if(o)return n&&this._showUriCbProgressDlg(e,t,s),Promise.resolve(o()).then((s=>{if(!s)return Promise.reject(D.uriError);if(n){const i=new m.MessageBox(this._dnldTitle,this._dnldText,2);i.defaultButtonText=this._defaultBtnText,i.cancelButtonText=this._cancelBtnText;return t.showDialog(i,e,this._target(),{locator:this._getLocator()}).then((e=>4===e?s:Promise.reject()))}return r.dismissDialog(t,i),s})).catch((e=>{r.dismissDialog(t,i);let s=null;return e&&(s=i.errorMessage()||"{0} {1}".format(D.downloadTargetUriCallbackFailed,e),r.notifyError(i,B,s)),Promise.reject(s)}));{const e=i.targetUri&&i.targetUri();return e||(r.notifyError(i,B,D.uriError),Promise.reject(D.uriError))}}))}}class K extends z{constructor(e,t,s){super(e,t,s),this._container=s.container,this._viewModel=t.content(),this._selectionInList=s.selectionInList;const i=this._ltm;let o;this._viewModel.viewModel.subscribeAndRun(i,(e=>{o&&o.dispose(),o=i.createChildLifetime();let t=this._nestedCommand;if(t&&(t.dispose(),this._nestedCommand=void 0),e){const s=this.viewModel,i={container:this._container,extension:this._extension,viewModelName:this._viewModelName,commandItem:this.commandItem,propertyBindings:null,diContainer:this._diContainer,selectionInList:this._selectionInList};this.commandItem.commandDefinition.details=E,function(e,t){const s=e;T(["text","icon","enabled"],(e=>{j(s[e],e,t)})),j(s.onInputsSet,"onInputSet",t,!0)}(e,this._viewModelName);const n=MsPortalFx.clone(s);n.content=ko.observable(e);const r=e;r.bladeName&&n.container.selectable.selectedValue({detailBlade:r.bladeName,detailBladeInputs:r.bladeInputs}),t=this._nestedCommand=N(o,e,n,i),t.init(),this.canSkipBladeValidation=t.canSkipBladeValidation}}))}execute(e){super.execute(e),this._nestedCommand?this._nestedCommand.execute(e):_.error("The nested command is missed for the {0} dynamic command.".format(this._viewModelName))}dispose(){this._nestedCommand&&this._nestedCommand.dispose()}}class J extends z{getBladeOpener(){if(this._ltm){const e=this._ltm;return this._bladeOpenerPromise||(k=k||MsPortalFx.require("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener"),this._bladeOpenerPromise=k.then((t=>{const s=this._options,i=new t.BladeOpener(this._diContainer,this._getBladeOpenerConfig(s.container,s.extension));return i.registerInvocationProperty(this.commandItem.commandDefinition.details),e.registerForDispose(i),i}))),this._bladeOpenerPromise}return Promise.reject(new MsPortalFx.Errors.DisposedCanceledError)}constructor(e,t,s){super(e,t,s),this._addedOutputPropertyBindings=[],this._outputBindingDefinitions=[],this._viewModel=t,this._containerViewModel=t.container,this._options=s;const i=this.commandItem.commandDefinition;this._commandInstanceId=s.selectionInList?MsPortalFx.newGuid():void 0;const o=function(e){let t;return e.name?e.details||(t="OpenBladeCommand must provide a details blade definition."):t="OpenBladeCommand must provide a command name.",t&&_.error("{0} Command: '{1}'. CommandDefinition: '{2}'.".format(t,e.name,JSON.stringify(e))),!t}(i),n=i.details,r=this._validateDetailsDefinition(n);o&&r?(this._outputBindingDefinitions=C.mapInputBindingDefinitions(n.outputArguments||[],s.container,(e=>{e.source.scope=S.DetailsContainer})),this.getBladeOpener()):s.commandItem.setEnabled(!1),this.canSkipBladeValidation=!0}execute(e){super.execute(e),this.getBladeOpener().then((e=>{if(!e||this._ltm&&!this._ltm.isDisposed()){const e=this._containerViewModel,t=e?.selectable;t?t.isSelected(!0):_.error("OpenBladeCommand '{0}' from extension '{1}' was not initialized with a Selectable.".format(this.commandItem.commandDefinition.name,this._extension.name))}}))}_getBladeOpenerConfig(e,t){const s=this.commandItem.commandDefinition.details,i=!!s&&!!s.parameterCollector,o=this._diContainer;return{diContainer:o,masterModelId:"{0}-[{1}-{2}]".format(e.toString(),"OpenBladeCommand",this.commandItem.commandDefinition.name),masterModel:this._viewModel,referenceComposition:e,referenceExtension:t,isBladeOpenedByMaster:t=>t.masterCommandName===this.commandItem.commandDefinition.name&&t.masterPartId===e.id&&t.masterCommandId===this._commandInstanceId,configureBindings:t=>{T(t,(t=>{const s=t.source,i=s?.modelType;4===i&&(s.modelId=this.commandItem.commandDefinition.name,a.isPartComposition(e)&&(s.partLocator=e.locator,s.id=e.id))}))},configureBladeDescriptor:t=>{t.masterCommandName=this.commandItem.commandDefinition.name,t.masterCommandId=this._commandInstanceId,t.masterCommandExtension=this._extension,t.masterPartId=e.id;const s=t.bindings;if(Array.isArray(s))for(let e=s.length-1;e>=0;e--){const o=s[e],n=o.source,r=n?.modelType;if(4===r){t.model[o.targetProperty]=ko.toJS(d.getModelValue(this._viewModel,n.property).value);const r=this.commandItem.sourceBindableContainer;!i&&r?.isPartListItem&&s.splice(e,1)}}},onBladeOpened:e=>{this._setCmdActivated(!0),e.onDispose((()=>{this._disposeOutputBindings(),this._setCmdActivated(!1)})),e.await(7).then((()=>{this._createOutputBindings(e)}))},getCloseOtherDetailBladesHandler:(t,s)=>{if(s.openInContextPane){const t=o.get(g.JourneyManager);if(e.getCompositionType()===M.StartboardPart){const e=t.activeJourney();return!e||e.isStartedWithContextBlade()?null:()=>t.tryDeactivateJourney()}if(!o.get(p.RightContextPane).opened.value)return()=>!0}return null}}}_createOutputBindings(e){T(this._outputBindingDefinitions,(t=>{const s=this._propertyBindings;if(s){const i=s.mapProperty(t.source.property,t.targetProperty).bind(e.toString()+"LaunchCommandOutputBinding",e.getViewModel());i.compositionBindingDefinition=t,this._addedOutputPropertyBindings.push(i)}}))}_disposeOutputBindings(){this._propertyBindings&&T(this._addedOutputPropertyBindings,(e=>{this._propertyBindings.removeProperty(e)})),this._addedOutputPropertyBindings.length=0}_validateDetailsDefinition(e){const t=[],s=l.validateDetailsDefinition(e,t,(e=>{let t;const s=e.invocationInputArguments;return e.isMultiple?t="Command cannot open multiple blades. isMultiple value must be false.":s&&4!==s[0].valuesFrom[0].referenceType&&(t="Command invocation argument reference type can only be of type Command."),t}));return t.length&&_.error("{0} Command: '{1}'. Details: '{2}'.".format(t[0],this.commandItem.commandDefinition.name,JSON.stringify(e))),s}_setCmdActivated(e){const t=this._commandContainer.getViewModel(),s=t?.container,i=s?.selectable;i&&i.isCommandSelected(e),this.commandItem.pressed(e)}}class Q extends J{constructor(e,t,s){super(e,t,s);const i=this._ltm,o=this.commandItem,n=t.content(),r=o.widgetViewModel.dialogOptions;ko.reactor(i,(()=>{r.listItems(n.listItems())})),n.selectedItem.subscribe(i,(e=>{r.selectedItem(e)})),r.selectedItem(n.selectedItem()),o.hasPopup(!0),r.selectedItem.subscribe(i,(e=>{n.selectedItem(e)}))}execute(e){super.execute(e)}}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.Security",["require","exports","Fx/ResourceManagement","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Services/Services.Permissions"],(function(e,t,s,i,o,n){"use strict";t.checkPermission=u,t.checkPermissions=function e(t,s,i,o,n,r,a){if(t&&t.length){if(void 0===c[s])return Promise.reject(FxImpl.createError("checkPermission: unexpected requirement: "+s));{const l=s===c.All;return t.reduce(((t,s)=>t.then((c=>{if(p(l,c))return t;{let t;if(0===s.permissionType){t=u(s,i,o,n,r,a)}else{if(1!==s.permissionType)throw new Error("unexpected permission.permissionType: "+s.permissionType);{const l=s;t=e(l.permissions,l.requirement,i,o,n,r,a)}}return t.catch((e=>(d.warning.call(d,e,1,["Failed check permissions:","compositionInfo:"+a,"reason: "+e].join("\n")),Promise.resolve(!0))))}}))),Promise.resolve(l))}}return Promise.resolve(!0)};var r=FxImpl.TriggerableLifetimeManager,a=MsPortalFx.Base,l=a.Diagnostics,c=MsPortalFx.Extension.SetRequirement;const d=l.createLog(e),p=MsPortalFx.xor;function u(e,t,i,o,r,l){if(!e)return Promise.resolve(!1);let c;switch(e.assetId.sourceType){case 0:c=Promise.resolve(t[e.assetId.property]);break;case 1:c=m(e,t,i,o,r);break;case 2:c=m(e,t,e.assetType||i,e.extensionName||o,r)}return c.then((t=>{if(t=ko.unwrap(t),(c=s.ArmId.parse(t,!0))&&g[c.kind])return l=t,r.get(n.PermissionsManager).hasPermission(l,[e.action],a.Constants.Shell);throw a.Diagnostics.createIgnoreUnhandledRejectionError(`Asset ID not a resource ID, permissions not checked. Extension <${o}> : AssetType <${i}> : ID _REDACTED_`);var l,c}))}function m(e,t,s,n,a){const l="[getAssetIdFromPropertyProvider]:";return a.get(o.ManifestCache).getManifestAsync(n,"assetTypes").then((o=>{const c=MsPortalFx.find(o.assetTypes,(e=>e.name===s));if(!c)throw new Error(l+"Unknown extension Asset Type : "+s);const d=a.get(i.ViewModelManager);return d.getViewModel(n,c.propertyProviderServiceViewModelLocator||c.propertyProviderServiceViewModel,11).then((s=>{const i=new r;return i.registerForDispose((()=>{d.releaseViewModel(s)})),Q.fcall((()=>{const i=s.content(),o=i&&i.onInputsSet;if("function"==typeof o){const s=$.extend({providerKey:e.assetId.providerKey},t);return(o.call(i,s)||Promise.resolve()).then((()=>{const t=i.properties(),s=e.assetId.property,o=MsPortalFx.find(t,(e=>e.property===s));if(o)return o.value;throw new Error(l+"Can not find propertyDefinition for assetIdProperty: "+s)}))}throw new Error(l+"ViewModel.content.onInputsSet is not a function.")})).finally((()=>{i.dispose()}))}))}))}const g={4:!0,6:!0,8:!0,3:!0,1:!0}})),
define("MsPortalImpl/Widgets/Widgets.CommandBarBase",["require","exports","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/UI.DialogManager"],(function(e,t,s,i){"use strict";t.ItemViewModel=t.DialogButton=void 0;var o=MsPortalFx.Base.Diagnostics.Telemetry;class n extends s.CommandImpl{constructor(e,t,s,i){const o=i&&i.commandName;super(e,t.label);const n=this._ltm;this._executeLifetime=i&&i.executeLifetime||n,this._model=t,this._locator=s,this.icon=ko.computed(n,{read:()=>{const e=ko.unwrap(this._model.icon);return e&&MsPortalFx.extend2(e,{options:$.extend({palette:99},e.options)})},write:this._model.icon}),this.commandName=o||MsPortalFx.getUniqueId(),this.enabled=ko.computed(this._executeLifetime,(()=>{const e=t,s=!t.disabled(),i=!e.command||e.command.canExecute();return s&&i})),ko.computed(n,(()=>{this.unauthorized(!!ko.unwrap(t.unauthorizedMessage))})),ko.computed(n,(()=>{let e=ko.unwrap(t.unauthorizedMessage);if(!e){const s=ko.unwrap(t.disabled);e="string"==typeof s?s:null}e=e||ko.unwrap(t.tooltip),this.tooltip(e)})),this.isSeparator=ko.observable(12===t.type)}get model(){return this._model}get type(){return this._model&&this._model.type}execute(e){o.trace({source:this._locator&&this._locator.toFriendlyString(),action:"CommandExecuted",name:this.model.name||"Toolbar name not specified",extension:this._locator&&this._locator.getExtensionName()}),super.execute(e)}}t.ItemViewModel=n;t.DialogButton=class extends n{constructor(e,t,s,i,o){super(e,t,s,o),this.hasOpenDialog=ko.observable(!1),this._diContainer=i;const n=t.dialogOptions;this.hasPopup(!!n&&4===n.type)}get dialogOptions(){return this._model.dialogOptions}execute(e){MsPortalFx.Base.Promises.cancelOnDispose(this._executeLifetime,Promise.all([this._diContainer.getAsync(i.DialogManager),this._currentContext.getFormTarget()]).then((([t,s])=>{if(this.hasOpenDialog())t.dismissOpenDialog(),this.hasOpenDialog(!1);else{const e=this._currentContext,i=e&&e.target,o=this._model;this.hasOpenDialog(!0),MsPortalFx.Base.Promises.cancelOnDispose(this._executeLifetime,t.showDialog(this.dialogOptions,s,i,{locator:this._locator})).then((e=>{this.hasOpenDialog(!1),o.command&&o.command.execute(e)}),(()=>{this.hasOpenDialog(!1)}))}super.execute(e)})))}}})),
define("MsPortalImpl/UI/Commands/UI.Commands",["require","exports","Fx/DependencyInjection","FxInternal","FxInternal/Composition/ViewModelComposer","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Extension/DefinitionCache","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Security","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/Commands/UI.ExtensionCommands","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.CommandBarBase","MsPortalImpl/Extension/ExtensionManager"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x,b){"use strict";t.ExtensionMultiselectCommandMenuItemImpl=t.ExtensionCommandMenuItemImpl=t.ExtensionCommandMenuItemBase=t.CompositionInstanceCommandContext=t.CommandState=void 0,t.createOpenBladeCommand=function(e,t,s,i,o,n){return R(e,t,s,(e=>new C.OpenBladeCommand(e)),{name:n,details:{invocationInputArguments:[{valuesFrom:[{property:"container.selectable",referenceType:4}]}]}},i,o,n)},t.createOpenLinkCommand=function(e,t,s,i,o,n,r){return R(e,t,s,(()=>{const e=new C.UriCommand;return e.navigateUri=r.uri,e.navigateTarget=r.target,e}),{name:n},i,o,n)},t.getBladeContainerWidget=function(e){const t=f.Widget.getWidget(e,null);if(e.hasClass("fxs-blade"))return t},t.getBladeContentWidget=function(e){const t=f.Widget.getWidget(e,null);if(e.hasClass("fxs-bladecontent"))return t},t.getCommandGroupForDefinitionItem=function(e,t,s){const i=s.commandGroupReference,o=i?i.name:s.commandGroup;return e.getCommandGroup(t,o)},t.getCommandSourceTelemetryContext=function(e){return h.getCommandSourceTelemetryContext(e)};var y=MsPortalFx.Base,v=y.Diagnostics,w=y.Images,M=MsPortalFx.Extension.SetRequirement,C=MsPortalFx.ViewModels,S=C.Dialogs,I=C.Toolbars,P=p.CompositionBinder;const _=v.createLog(e),F=c.Commands,T=MsPortalFx.uncurryThis(Array.prototype.forEach);let k=t.CommandState=class{constructor(){this.commandsEnabled=ko.observable(!0)}};t.CommandState=k=__decorate([__metadata("fx:diagnostics",[e,"CommandState"]),s.Class()],k);var E=t.CompositionInstanceCommandContext=h.CompositionInstanceCommandContext;class D extends d.CommandImpl{constructor(e,t,s,i,o){super(e,s),this.diContainer=o;const n=ko.observable(!1);this.commandName=t,this._compositionContainer=i;const r=this._overrideEnabled=ko.observable();this.enabled=ko.computed(e,{read:()=>{let e=r();return void 0===e&&(e=n()),e},write:e=>{n(e)}}),this._init(o)}get container(){return this._compositionContainer}get sourceBindableContainer(){return null}_init(e){ko.reactor(this._ltm,(()=>{e.get(k).commandsEnabled()&&1!==this.diContainer.get(m.DesktopManagerMode).value()?this._overrideEnabled(void 0):this._overrideEnabled(!1)}))}}t.ExtensionCommandMenuItemBase=D;t.ExtensionMultiselectCommandMenuItemImpl=class extends D{constructor(e,t,s,i,o,n,r){const a=i.name;super(e,a,i.text,s,n);const l=this._ltm,c=s+"[Command: "+a||i.text+"]",d=(p=r)&&p.selectableItems().filter((e=>e.isSelected()))||[];var p;this._subcommands=d.map((e=>{const r={viewModel:e.data,viewModelName:c,isPartListItem:!0};return new A(l,t,s,i,o,n,r)})),ko.reactor(l,(()=>{const e=this._subcommands.reduce(((e,t)=>t.enabled()&&e),!0);this.enabled(e)}))}bind(e){T(this._subcommands,(t=>{t.bind(e)}))}activate(){T(this._subcommands,(e=>{e.activate()}))}execute(e){T(this._subcommands,(t=>{t.execute(e)}))}};class A extends D{constructor(e,t,s,i,o,n,r,l){super(e,i.name,i.text,s,n),this._viewModelManager=n.get(a.ViewModelManager),this._extension=t,this._commandDefinition=i,this._commandContainerDefinition=o,this._sourceBindableContainer=r,this._selectionInList=l}extensionName(){return this._extension&&this._extension.name}get commandDefinition(){return _.assert(!this._commandDefinition.reference,"External CommandDefinition not resolved."),this._commandDefinition}getInputBindingsFromDefinition(e){let t;const s=this._getCommandReference(e);return s&&Array.isArray(s.bindings)&&s.bindings.length>0?t=s.bindings:e&&(t=e.bindings),t||[]}get widgetViewModel(){return this._widgetViewModel}get sourceBindableContainer(){return this._sourceBindableContainer}activate(){this._loadViewModel()}execute(e){const t=this.widgetViewModel,s=t&&t.dialogOptions;s&&s.type&&5===t.type?this._getFormTarget().then((t=>{const i=this.container.locator,o=i&&i.withCommand(this.commandName);this.diContainer.getAsync(g.DialogManager).then((e=>e.showDialog(s,t,this._target(),{locator:o}))).then((t=>{this._execute(e)}))})):this._execute(e)}getCommandContext(){return this._currentContext}_getFormTarget(){return this._currentContext&&this._currentContext.getFormTarget()}_target(){return this._currentContext&&this._currentContext.target}_getCommandReference(e){const t=this._commandContainerDefinition&&this._commandContainerDefinition.commandGroupReference;let s=null;return t&&t.commands&&e.name&&(s=MsPortalFx.find(t.commands,(function(t){return t.name===e.name}))),s}_execute(e){const t=this._currentContext.compositionInstance;if(!this._extensionCommand)return void this._loadViewModel();const s=t&&t.widget;s&&!this._extensionCommand.canSkipBladeValidation?(this._overrideEnabledPropertyWith(!1),l.ensureFormFieldValidation(s.element).then((t=>{super.execute(e),this._extensionCommand.execute(e,t)})).finally((()=>{this._clearEnabledPropertyOverride()}))):(super.execute(e),this._extensionCommand.execute(e))}dispose(){const e=this._viewModelLoadedPromise,t=()=>{super.dispose()};e&&(e.then(t),this._viewModelLoadedPromise=null),t()}setEnabled(e){this._extensionEnabledProperty=e,this._overrideEnabledProperty||this.enabled(e)}getViewModel(e,t){const s=this._extensionCommand;return s&&s.viewModel}getViewModelAsync(e){return this._loadViewModel(),this._viewModelLoadedPromise}get canRebind(){const e=this._getContentViewModel();return 1!==(e&&ko.unwrap(e.status))}_getContentViewModel(){const e=this.getViewModel();return e&&e.content()}_overrideEnabledPropertyWith(e){this._overrideEnabledProperty=!0,this.enabled(e)}_clearEnabledPropertyOverride(){this._overrideEnabledProperty&&(this._overrideEnabledProperty=!1,this.enabled(this._extensionEnabledProperty))}_resolveCommandDefinition(){return(0,i.fcall)((()=>{const t=this._commandDefinition;if(t.reference){const s=t.reference.extension||this._extension.name,i=t.reference.commandType;return this.icon(w.Loading.EllipsisSquare()),this.text(F.loading),this.diContainer.get(r.DefinitionCache).getCommand(s,i).then((o=>{MsPortalFx.isNullOrUndefined(o)&&(0,n.logToExtension)(e,this._extension.name,2,"Could not resolve the command reference for extension {0} and command name {1}".format(s,i)),this._extension=this.diContainer.get(b.ExtensionManager).getExtension(s);const r=this.getInputBindingsFromDefinition(t);this._commandDefinition=MsPortalFx.extend2(o,{name:t.name}),r.length>0&&(this._commandDefinition.bindings=r),this.text(this._commandDefinition.text)}))}}))}_logError(t){FxImpl.Rpc.client.log(this._extension.name,{level:2,code:0,area:e.normalize("."),message:new MsPortalFx.Errors.Error({message:`${MsPortalFx.getLogFriendlyMessage(t)} \nCommand name: ${this._commandDefinition.name} \nView model name: ${this._commandDefinition.viewModel}`,innerErrors:t})})}_createExtensionCommandHandler(e){const t=this._ltm;if(t.isDisposed())return;const s=e.content,i=t.createChildLifetime(),o={container:this.container,extension:this._extension,viewModelName:this._commandDefinition.viewModel,commandItem:this,propertyBindings:null,diContainer:this.diContainer,selectionInList:this._selectionInList},n=new N(i,e,o);n.init(),o.propertyBindings=n.propertyBindings;const r=this._extensionCommand=h.createExtensionCommand(i,s(),e,o);r?(i.registerForDispose([r]),r.init()):this._logError(FxImpl.createError("Error loading command view model. Unknown view model type.")),e.container.unauthorizedMessage.subscribeAndRun(i,(t=>{this.unauthorized(!MsPortalFx.isNullOrUndefined(t)),this.tooltip(t||e.content().tooltip&&e.content().tooltip())}))}_loadViewModel(){if(!this._viewModelLoadedPromise){let e=this._ltm;if(!e)return;this._viewModelLoadedPromise=this._resolveCommandDefinition().then((()=>{if(e=this._ltm,!e)return;const t=this._extension,s=this._commandDefinition,i=4===s.commandKind;return s.commandKind&&!i||(this._widgetViewModel=B(this._ltm,s,this.diContainer,this.container,i)),this._viewModelManager.getViewModel(t.name,s.viewModelLocator||s.viewModel,7,{createSelectable:!0})})),this._viewModelLoadedPromise.then((t=>{e=this._ltm,e&&(t.content().lc2&&(this._widgetViewModel=B(e,this._commandDefinition,this.diContainer,this.container,!0)),this._createExtensionCommandHandler(t))})).catch((e=>{const t=MsPortalFx.getLogFriendlyMessage(e);this.icon(w.Blank()),this.text(F.failedToLoad),this._logError(FxImpl.createError("Error loading command view model.\nReason: {0}".format(t)))}))}}}function B(e,t,s,i,o){const n=new I.DialogButton;return n.dialogOptions=new S.ListPopup,n.dialogOptions.type=o?4:0,new x.DialogButton(e,n,i.locator.withCommand(t.name),s,{commandName:t.name})}t.ExtensionCommandMenuItemImpl=A;class N{constructor(e,t,s){this._onInputsSetPending=ko.observable(!1),this._hasPermissions=ko.observable(!0),this._extension=s.extension,this._viewModelName=s.viewModelName,this._composedViewModel=t,this._commandViewModel=t.content(),this._commandItem=s.commandItem,this._diContainer=s.diContainer;const i=this._ltm=e.createChildLifetime();this._initializeInputBindings(s.container,s.commandItem),i.registerForDispose((()=>{this._commandViewModel=null}))}init(){const e=this._commandViewModel,t=this._commandItem;ko.isObservable(e.icon)&&e.icon.subscribeAndRun(this._ltm,t.icon),ko.isObservable(e.text)&&e.text.subscribeAndRun(this._ltm,(e=>void 0!==e&&t.text(e))),ko.isObservable(e.ariaLabel)&&e.ariaLabel.subscribeAndRun(this._ltm,t.ariaLabel),ko.isObservable(e.tooltip)&&e.tooltip.subscribeAndRun(this._ltm,t.tooltip),ko.computed(this._ltm,[e.enabled,this._hasPermissions,this._onInputsSetPending],((e,s,i)=>t.setEnabled(e&&s&&!i)))}get propertyBindings(){return this._propertyBindings}dispose(){this._ltm.dispose()}_initializeInputBindings(e,t){const s=this._ltm;if(!s)return;const i=t.getInputBindingsFromDefinition(t.commandDefinition),o={bindableTarget:{viewModelName:e.toString()+"-["+this._viewModelName+"]",viewModel:this._composedViewModel},inputs:i,referenceComposition:e,referenceCompositionIsContainer:!0,customBindHandler:e=>{const s=t.sourceBindableContainer;if(s&&s.viewModel&&0!==e.source.modelType)return{sourceModelName:s.viewModelName,sourceModel:s.viewModel}},beforeViewModelPropertyUpdate:s=>{const i=t.commandDefinition;if(i&&i.permissions){this._hasPermissions(!1);let t=e&&e.locator&&e.locator.toString()+"-";return t=(t||"")+i.name,u.checkPermissions(i.permissions,M.All,s,i.assetType,this._extension.name,this._diContainer,t).then((e=>(this._updateForHasPermissions(e),e)))}return this._updateForHasPermissions(!0),Promise.resolve(!0)}};o.inputs&&Array.isArray(o.inputs)&&o.inputs.length>0&&(this._onInputsSetPending(!0),o.inputsSetCalled=(s,i)=>{this._onInputsSetPending(!0),this._currentOnInputsSetPromise=i,i.then((()=>{this._currentOnInputsSetPromise===i&&this._onInputsSetPending(!1)}),(i=>{_.error("Command '{0}' on composition '{1}' rejected its onInputsSet promise.\nView Model Name: {2}\nInputs Provided: {3}\nReason: {4}".format(t.commandName,e.toString(),this._viewModelName,ko.toJSON(s),i||"N/A"))}))});const n=P.bindViewModelInputs(this._diContainer,o),r=this._propertyBindings=n.propertyBindings;s.registerForDispose((()=>{r&&(r.unbind(),this._propertyBindings=null)}))}_updateForHasPermissions(e){const t=this._composedViewModel&&this._composedViewModel.container;t&&(e?t.unauthorizedMessage(void 0):t.unauthorized()),this._hasPermissions(e)}}function R(e,t,s,i,n,r,a,l){const c="__{0}ViewModel__".format(l),d=o.composeViewModel(i,!0),p=new A(e,a,s,n,r,t),u={container:s,extension:a,viewModelName:c,commandItem:p,propertyBindings:null,diContainer:t,selectionInList:!1},m=h.createExtensionCommand(e,d.content(),d,u);return p.bind(new E(null,null,s)),e.registerForDispose([d.container,p,m]),m}})),
define("MsPortalImpl/UI/Commands/UI.CommandManager",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Widgets/Widgets.Portal.init","MsPortalImpl/Base/Base.KeyboardHelper"],(function(e,t,s,i,o,n,r,a,l,c){"use strict";t.PortalCommandManager=t.AsyncPortalFormTarget=void 0,t.onContextMenu=m;var d=FxImpl.TriggerableLifetimeManager;const p=window;class u{static create(e){return e.getAsync(i.get("MsPortalImpl/UI/UI.PortalFormTarget","PortalFormTarget"))}}function m(e){if(c.isCtrlOrCommandOnly(e))return!0;const t=p.getSelection();if(t.rangeCount&&!t.getRangeAt(0).collapsed)return!0;const s=$(e.target);if(s.filter("input,textarea").length)return!0;if(s.add($(e.target).parents("a")).filter("a[href]:not([href='#']):not([href=''])").length)return!0;e.preventDefault(),e.stopPropagation();const i=$.Event("fxcontextmenurequest",{target:e.target,pageX:e.pageX,pageY:e.pageY,clientX:e.clientX,clientY:e.clientY});s.trigger(i)}t.AsyncPortalFormTarget=u,__decorate([__metadata("fx:diagnostics",[e,"AsyncPortalFormTarget"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container]),__metadata("design:returntype",Promise)],u,"create",null);let g=t.PortalCommandManager=class{constructor(e,t,s){this._desktopManagerMode=e,this._previouslyFocusedElement=t,this._diContainer=s,this._ltm=new d,this._ltm.registerForDispose($.querySelectorAll("body").setEvents(["fxcontextmenu",(e,t)=>{this._showContextMenu(e,t)}],["contextmenu",e=>{m(e)}]))}dispose(){this._ltm.dispose()}getFormTarget(){return this._diContainer.getAsync(u)}_showContextMenu(e,t){if(!this._contextMenu){const e=(0,l.getPortalViewModel)(this._diContainer);this._contextMenu=new a.Widget(e.getRootElement().find(".fxs-commands-contextMenu"),e.contextMenuViewModel,!0)}const s=t.contextMenu?t.contextMenu:this._contextMenu,i=s.options.menuItems;let r,c,d,p=e.clientX,u=e.clientY;if(t.commands&&0!==t.commands.length){if(t.srcElement){const e=t.srcElement;let s=e;for($(e).hasClass("fxs-tile")&&(s=$(e).find(".fxs-part")[0]);s&&"function"!=typeof s.focus;)s=$(s).closest("[tabindex]")[0];this._previouslyFocusedElement.value(s)}d=t.formTarget&&t.formTarget.length>0?()=>Promise.resolve(o.getBladeContentWidget(t.formTarget)):()=>this.getFormTarget(),s.hide(),i.splice(0,i().length);do{c=c?c.parentNode:e.target,r=$(c).data(n.CompositionInstanceDataName)}while(!r&&c.parentNode);if(n.isContextMenuContainer(r)&&r.beforeActivateCommandMenuItems(t),t.commands.forEach((t=>{this._shouldShowCommand(t)&&(t.activate(),t.bind(new o.CompositionInstanceCommandContext(e.target,d,r)),i.push(t))})),s.options.hasVisibleCommands()){if(!p&&!u){const t=e.target.getClientRects()[0];p=t&&t.left||p,u=t&&t.bottom||u}s.show(p,u,t&&t.forceLeft,t?.ariaExpanded,t?.ariaControls)}}}_shouldShowCommand(e){return 1!==this._desktopManagerMode.value()||!this._isExtensionCommand(e)}_isExtensionCommand(e){return!!e._extension}};t.PortalCommandManager=g=__decorate([__metadata("fx:diagnostics",[e,"PortalCommandManager"]),s.Class(),__metadata("design:paramtypes",[r.DesktopManagerMode,r.PreviouslyFocusedElement,s.Container])],g)})),
define("MsPortalImpl/UI/Commands/UI.ShellCommands",["require","exports","Fx/DependencyInjection","Fx/ResourceManagement","FxInternal","FxInternal/AsyncLoader","FxInternal/Composition/Part","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/Interactions/Interactions.FullScreenMode","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Commands/UI.CommandManager","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.TileActionBar","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Widgets/Widgets.Portal.init","MsPortalImpl/UI/Commands/Base.PortalFunctions"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x,b,y,v){"use strict";t.CommandNames=t.ClonePart=void 0,t.CreatePartSizeCommandCollection=function(e,t){A||(A=[{size:P.Mini,text:a.ShellCommands.partSizeMini},{size:P.Small,text:a.ShellCommands.partSizeSmall},{size:P.Normal,text:a.ShellCommands.partSizeNormal},{size:P.Wide,text:a.ShellCommands.partSizeWide},{size:P.Tall,text:a.ShellCommands.partSizeTall},{size:P.Large,text:a.ShellCommands.partSizeLarge},{size:P.HeroWide,text:a.ShellCommands.partSizeHeroWide},{size:P.HeroTall,text:a.ShellCommands.partSizeHeroTall},{size:P.Hero,text:a.ShellCommands.partSizeHero}],A.forEach((e=>{e.icon=S.Mini({customClass:"msportalfx-contextmenu-grid-"+I.PartSize[e.size].toLowerCase()})})));return A.map((s=>new D(e,t,s.size,s.text,s.icon)))},t.commandNamePrefix=t.UnpinFromStartboard=t.ShellCommand=t.ResetStartBoardCommand=t.ReloadPart=t.PinToStartboard=t.PartSizeCommand=t.OpenContextMenu=t.GoToAssetBlade=t.ExitOrganizeMode=t.EnterOrganizeMode=t.CustomizeTileData=void 0;var w=MsPortalFx.Base,M=w.Diagnostics.Telemetry,C=FxImpl.TelemetryContext,S=w.Images,I=MsPortalFx.Parts,P=I.PartSize,_=d.CompositionInstanceCommandContext;const F=t.commandNamePrefix="MsPortalImpl.UI.Commands.",T=t.CommandNames={BladeDisplayState:`${F}BladeDisplayState`,ClonePart:`${F}ClonePart`,CustomizeTileData:`${F}CustomizeTileData`,DeleteListItem:`${F}DeleteListItem`,EnterOrganizeMode:`${F}EnterOrganizeMode`,ExitOrganizeMode:`${F}ExitOrganizeMode`,GoToAssetBlade:`${F}GoToAssetBlade`,OpenContextMenu:`${F}OpenContextMenu`,PartSize:`${F}PartSize`,PinBlade:`${F}PinBlade`,EditBlade:`${F}EditBlade`,PinListItem:`${F}PinListItem`,PinToStartboard:`${F}PinToStartboard`,ReloadPart:`${F}ReloadPart`,ResetLayout:`${F}ResetLayout`,ResetStartBoard:`${F}ResetStartBoard`,UnnamedCommand:`${F}UnnamedCommand`,UnpinFromStartboard:`${F}UnpinFromStartboard`};function k(e){return h.Widget.getWidget(e.closest(".fxs-tile"),f.Widget)}class E extends l.CommandImpl{constructor(e,t,s,i){super(e,i.text,i.enabled),this._diContainer=t,this.commandName=s,this.icon(i.icon||S.Blank()),this.isShellCommand=!0}bind(e){e.getFormTarget||(e.getFormTarget=()=>this._diContainer.getAsync(p.AsyncPortalFormTarget)),super.bind(e)}execute(e){super.execute(e);const t=this._diContainer.get(g.JourneyManager).activeJourney(),s=d.getCommandSourceTelemetryContext(this._currentContext);C.setContextValue(C.ContextType.Blade,s),M.trace({source:s&&s.id,action:"CommandExecuted",name:this.commandName,data:{fromContextMenu:e,desktopMode:this._getDesktopMode()},journeyId:t&&t.id}),C.resetContextValue(C.ContextType.Blade)}createAction(e){const t=new x.TileActionViewModel;return t.command=this,t.bindCommand=()=>{const t=e.widget;t?this.bind(new _(t.element[0],null,e)):this.enabled(!1)},this._setActionClassName(t),t}_getComposition(){return this._currentContext.compositionInstance}_getDesktopMode(){return this._diContainer.get(b.DesktopManagerMode).value()}_setActionClassName(e){const t=this._getActionClassIdentifier();this._actionClassName="fxs-tile-actionbar-command-"+t,e.className=this._actionClassName}_getActionClassIdentifier(){throw new Error("Not implemented.")}}t.ShellCommand=E;t.UnpinFromStartboard=class extends E{constructor(e,t){super(e,t,T.UnpinFromStartboard,{text:a.ShellCommands.unpinFromStartboard,icon:S.Delete()})}execute(e){const t=k($(this._currentContext.target));t&&t.trigger("fxunpin",{tileId:t.options.id}),super.execute(e)}_getActionClassIdentifier(){return"unpinfromstartboard"}};t.CustomizeTileData=class extends E{constructor(e,t){const s=MsPortalFx.isFeatureEnabled(r.partHeaderEnabledFeatureName);super(e,t,T.CustomizeTileData,{text:s?a.ShellCommands.configureTileSettings:a.ShellCommands.customizeTileData,icon:S.Gear()}),this._partSettingsEnabled=s}execute(e){this._getComposition().openPartSettingsBlade()}bind(e){super.bind(e),this.enabled(1!==this._getDesktopMode()||this._partSettingsEnabled)}_getActionClassIdentifier(){return"customizetiledata"}};t.OpenContextMenu=class extends E{constructor(e,t,s){super(e,t,T.OpenContextMenu,{text:s,icon:S.Ellipsis()})}bind(e){super.bind(e);const t=this._partWidget=k($(e.target)),s=t.options.commands.filter((t=>(t.bind(e),t.visible()&&t.enabled()))),i=this._diContainer.get(c.FullScreenMode);this.enabled(s.length>0&&!i.isActive()),ko.computed(this._ltm,(()=>{const e=t.actionBarWidget&&t.actionBarWidget.contextMenuWidget.options.visible();t.element.find(`.${this._actionClassName}`).toggleClass("fxs-tile-actionbar-action-pressed",e)}))}execute(e){const t=this._partWidget,s=t.element,i=$.Event("fxcontextmenu"),o=s.offset();i.clientX=o.left+s.outerWidth(!1),i.clientY=o.top,s.trigger(i,{commands:t.options.commands,contextMenu:t.actionBarWidget.contextMenuWidget}),super.execute(e)}_getActionClassIdentifier(){return"opencontextmenu"}};t.PinToStartboard=class extends E{constructor(e,t,s){super(e,t,T.PinToStartboard,{text:a.ShellCommands.pinToStartboard,icon:S.Pin(),enabled:!1}),this.partComposition=s}bind(e){if(super.bind(e),!this.partComposition.allInputsSet())return void this.enabled(!1);const t=this.partComposition.widget;let s=!1;if(t){const e=m.isVariableSize(t.options.size()),i=ko.unwrap(t.options.supportedSizes);let o;t.element.parentsUntil(".fxs-blade",".fxs-blade-summary-container").length>0?s=!1:e?(o=MsPortalFx.find(i,(function(e){return m.isFixedSize(e)})),null!==o&&o>=0&&(s=!0)):s=!0}this.enabled(s)}execute(e){this._diContainer.get(v.PinTilePortalFunc).invoke(this.partComposition,"ShellCommands").finally((()=>{super.execute(e)}))}_getActionClassIdentifier(){return"pintostartboard"}};class D extends E{constructor(e,t,s,i,o){super(e,t,T.PartSize+I.PartSize[s],{text:i,icon:o}),this.sizeTarget=s}execute(e){const t=k($(this._currentContext.target));let s;t&&(s=m.AllSizes[this.sizeTarget],t.element.trigger("fxsizechange",[t.options.id,s.size.width,s.size.height]),(0,o.fcall)((()=>{t.setFocus()}))),super.execute(e)}bind(e){const t=k($(e.target)),s=t&&t.options;t&&this.sizeTarget!==s.size()&&!m.isVariableSize(s.size())&&1===this._getDesktopMode()?(this.enabled(s.supportedSizes().includes(this.sizeTarget)),super.bind(e)):this.enabled(!1)}}let A;t.PartSizeCommand=D;t.GoToAssetBlade=class extends E{constructor(e,t,s){super(e,t,T.GoToAssetBlade,{text:a.ShellCommands.goToAsset,icon:S.Go(),enabled:!1}),this.assetWrapper=s}bind(e){super.bind(e),this.assetWrapper.getAssetId().then((e=>{this._assetId=e,this._diContainer.get(b.DesktopManagerMode).value.subscribeAndRun(this._ltm,(t=>{const s=0!==i.ArmId.parse(e,!0).kind,o=1!==t;this.enabled(s&&o)}))})).catch($.noop)}execute(e){super.execute(e),n.get("MsPortalImpl/UI/UI.DeepLink","getResourceDeepLink").then((e=>{const t=e(this._diContainer,this._assetId);this._diContainer.get(v.RoutePortalFunc).invoke({uri:t,openedByContext:{openedBy:4}},"ShellCommands")}))}};t.ReloadPart=class extends E{constructor(e,t,s){super(e,t,T.ReloadPart,{text:a.ShellCommands.reloadPart,icon:S.Refresh({palette:99})}),this.partComposition=s}bind(e){super.bind(e)}execute(e){super.execute(e);const t=this.partComposition,s=M.startTrace({action:"Refresh",source:"UI.ShellCommands",actionModifier:"mark",context:{content:t.locator&&t.locator.name,instanceId:t.id}});return this._diContainer.get(v.ReloadPartPortalFunc).invoke(t,"ShellCommands").then((e=>{const i={source:"Shell",action:"ErrorInteraction",actionModifier:"Refresh",context:{content:t.locator&&t.locator.name,instanceId:t.id}};return e.await(3).then((()=>{i.data={successful:!0}}),(()=>{i.data={successful:!1}})).finally((()=>{M.trace(i),M.completeTrace(s)})),e}))}};t.ResetStartBoardCommand=class extends E{constructor(e,t){super(e,t,T.ResetStartBoard,{text:a.ShellCommands.resetLayout})}execute(e){this._diContainer.get(v.ResetDashboardPortalFunc).invoke({duringPortalStartup:!1,force:!1},"ShellCommands"),super.execute(e)}bind(e){super.bind(e),this.enabled(1===this._getDesktopMode())}};t.EnterOrganizeMode=class extends E{constructor(e,t,s){super(e,t,T.EnterOrganizeMode,{text:a.ShellCommands.enterOrganizeMode,icon:S.Edit()}),this._expandTileGallery=!!s,t.get(b.DesktopManagerMode).value.subscribeAndRun(this._ltm,(e=>{const t=1!==e;this.enabled(t)}))}execute(e){const t=this._getComposition();t&&t.widget?t.widget.element.trigger("fxenterorganizemode",{trigger:1,openTileGallery:this._expandTileGallery}):this._diContainer.get(b.DesktopManagerMode).value(1),super.execute(e)}};t.ExitOrganizeMode=class extends E{constructor(e,t){super(e,t,T.ExitOrganizeMode,{text:a.ShellCommands.exitOrganizeMode})}execute(e){(0,y.getPortalViewModel)(this._diContainer).topBar.exitOrganizeMode(),super.execute(e)}bind(e){super.bind(e),this.enabled(1===this._getDesktopMode())}};let B=t.ClonePart=class extends E{constructor(e,t,s){super(e,t,T.ClonePart,{text:a.ShellCommands.copy,icon:S.Copy()}),this._partComposition=s}execute(e){super.execute(e),n.get("MsPortalImpl/UI/Dashboard/Common/DashboardPinHelper","copyPartWithDashboardSelection").then((e=>e(this._diContainer,"Dashboard",this._partComposition)))}};t.ClonePart=B=__decorate([__metadata("fx:diagnostics",[e,"ClonePart"]),s.Class(),__metadata("design:paramtypes",[Object,s.Container,Function])],B)})),
define("WeaveDOM/SandboxRender/Serialize",["require","exports","WeaveDOM/Core/Sanitization","Weave/Core/InternalUtil","WeaveDOM/Core/InternalUtil","Weave/Core/Computation"],(function(e,t,s,i,o,n){"use strict";function r(e,t,s){switch(t=(t||"").trim(),e){case"aria-describedby":case"aria-controls":case"aria-labelledby":case"aria-owns":case"for":case"form":case"headers":case"id":case"list":return function(e,t){const s=new Array(e.length);for(let i=0;i<e.length;++i)s[i]=t+e[i];return s}(t.split(" ").filter(n._identity),s).join(" ");default:return t}}function a(e,t,s,i,o,n,r,a,c){let d=!1;for(const p of e)d=l(p,t,s,i,o,n,r,a,c)||d;return d}function l(e,t,n,l,p,u,m,g,h){switch(e.type){case"element":return function(e,t,o,n,l,c,d,p,u){const m=e.tagName;!function(e){if(!(0,s.validateTagNameInSandboxMode)(e))throw new Error(`TagName: ${e} is not allowed`)}(m);let g="",h="";const f=o.htmlFragments;f.push("<",m);for(const t of e.attributes){const e=t.name,o=t.value;(0,s.ensureAllowedAttribute)(m,e);const n=(0,s.sanitizeAttributeValue)(e,o,d);if(n.valid)if("id"===e){if(!o)throw new Error("Empty element node id is not accepted.");if(g)throw new Error(`Only one element id can be accepted, ${g}, ${o}`);g=n.value,h=(0,i.getUniqueElementId)(),f.push(' id="',h,'"')}else f.push(" ",e,'="',(0,i.encodeHtml)(r(e,n.value,l)),'"');else console.warn(`Invalid attribute value will be ignored: ${e}, ${o}`)}p&&p.element.postSerialize({addAttribute:(e,t)=>f.push(" ",e,'="',t,'"'),getElementNodeId:()=>(g||(g=h=(0,i.getUniqueElementId)(),f.push(' id="',h,'"')),g),node:e,options:t,ltm:n.innerLtmRoot,hooksState:u});if((0,s.isSelfCloseTag)(m))f.push("/>");else{let s=-1;h||(s=f.length,f.push("")),f.push(">");a(e.children,t,o,n,l,c,d,p,u)&&(h||(h=(0,i.getUniqueElementId)(),f[s]=` id="${h}"`),o.commentContainers.push(h)),f.push("</",m,">")}g&&o.elementNodes.push({ltm:n,nodeId:g,domId:h});return!1}(e,t,n,l,p,u,m,g,h);case"dynamic":return function(e,t,s,n,r,l,p,u,m){const{commentStartId:g,commentEndId:h}=(0,o.getUniqueCommentIdPair)();s.htmlFragments.push("\x3c!--",g,"--\x3e");const{selfLtm:f,contentLtm:x}=(0,i.createDynamicNodeLtms)(e.dynamicNodeType,n),b=x||f;if(a(e.children,t,s,b,r,l,p,u,m),s.htmlFragments.push("\x3c!--",h,"--\x3e"),"forEach"===e.dynamicNodeType&&!e.children.every(c))throw new Error("Only ForEachItem node is allowed as a children to ForEach node.");return s.dynamicNodes.push({nodeId:e.nodeId,nodeType:e.dynamicNodeType,commentStartId:g,commentEndId:h,initContentLtm:x,selfLtm:f,initItemsId:"forEach"===e.dynamicNodeType?e.children.map(d):void 0}),!0}(e,t,n,l,p,u,m,g,h);case"text":return function(e,t){e.text&&"string"==typeof e.text&&t.push((0,i.encodeHtml)(e.text));return!1}(e,n.htmlFragments);case"html":return function(e,t,s){return t.push(s(e.htmlData)),!1}(e,n.htmlFragments,u);default:(0,i.assertSwitchNever)(e)}}function c(e){return"dynamic"===e.type&&"forEachItem"===e.dynamicNodeType}function d(e){return e.nodeId}Object.defineProperty(t,"__esModule",{value:!0}),t.serializeRootNode=function(e,t,s,i,n,r,l,c){const d={commentContainers:[],dynamicNodes:[],elementNodes:[],htmlFragments:[]},p=c&&c();a(e.children,t,d,s,i,n,r,l,p);const u=(0,o.documentFragmentFromHtml)(d.htmlFragments.join("")),m=(0,o.collectCommentNodes)(d.commentContainers,u);return{containerDoc:u,commentLookup:m,dynamicNodes:d.dynamicNodes,elementNodes:d.elementNodes,hooksState:p}},t.mapAttributeIdPointers=r})),
define("WeaveDOM/SandboxRender/WeaveSandbox",["require","exports","WeaveDOM/Core/InternalUtil","WeaveDOM/SandboxRender/Serialize","Weave/Core/MemoryManager","WeaveDOM/DirectRender/ForEachNodeOperations","WeaveDOM/Core/Sanitization","Weave/Core/InternalUtil","WeaveDOM/Core/DomOperatorBase","Weave/Core/InternalUtil","Weave/Core/Computation"],(function(e,t,s,i,o,n,r,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SandboxModeRenderEngine=void 0,t.connect_internal=function(e,t){let s=null,i=!1;const o=(0,c.makeMap)(p.concat(t.customInstructionHandlers||[]),(e=>e.name),(e=>e.handler));return t.registerOnReceive(((n,r)=>{if(!i&&n)if("setRoot"===n.type){if(s)throw new Error("Cannot have more than one setRoot instruction.");s=new u({rootElement:e,config:t,rootNode:n.rootNode,setRootInstructionOptions:r,idMapPrefix:`_wv_sandbox_idmap_${f++}_`,cssChanges:n.css})}else{const e=o.get(n.type);if(!e)throw new Error(`Unknown Weave sandbox mode instruction: ${JSON.stringify(n).slice(0,200)}`);e(n,s,r)}})),t.registerOnDispose((()=>{s&&s.dispose(),i=!0})),()=>s&&s.getMemoryDebugInfo()};const p=[{name:"applyCss",handler:(e,t)=>t.applyCssChanges(e.css)},{name:"clear",handler:(e,t)=>t.clear(e.dynamicNodeId)},{name:"remove",handler:(e,t)=>t.remove(e.dynamicNodeId)},{name:"removeAttribute",handler:(e,t)=>t.removeAttribute(e.elementNodeId,e.attributeName)},{name:"toggleClass",handler:(e,t)=>t.toggleClass(e.elementNodeId,e.value.className,e.value.shouldAdd)},{name:"setAttribute",handler:(e,t)=>t.setAttribute(e.elementNodeId,e.attributeName,e.attributeValue)},{name:"setContent",handler:(e,t,s)=>t.setContent(e.dynamicNodeId,e.rootNode,s)},{name:"setItems",handler:(e,t,s)=>t.setItems(e.dynamicNodeId,e.items,e.css,s)},{name:"setStyle",handler:(e,t)=>t.setStyle(e.elementNodeId,e.styleName,e.styleValue)},{name:"toggleDisplay",handler:(e,t)=>t.toggleDisplay(e.dynamicNodeId,e.shouldShow)},{name:"setEventListener",handler:(e,t)=>t.addEventListener(e.elementNodeId,e.eventName,e.options)},{name:"focus",handler:(e,t)=>t.focus(e.locatorClass,e.elemIndex)},{name:"setLocatorClass",handler:(e,t)=>t.toggleClass(e.elementNodeId,t.getDomUniqueLocatorClass(e.locatorClass),!0)},{name:"initTwoWayInputBinding",handler:(e,t)=>{t.initTwoWayInputBinding(e.elementNodeId,e.inputBindingName)}},{name:"initValuePushInputBinding",handler:(e,t)=>{t.initValuePushInputBinding(e.elementNodeId,e.inputBindingName)}},{name:"initValueSubscribeInputBinding",handler:(e,t)=>{t.initValueSubscribeInputBinding(e.elementNodeId,e.inputBindingName)}},{name:"twoWayInputBindingCommit",handler:(e,t)=>{t.twoWayInputBindingCommit(e.elementNodeId,e.inputBindingName,e.value)}},{name:"pushInputValue",handler:(e,t)=>{t.pushInputValue(e.elementNodeId,e.inputBindingName,e.value)}}];class u{constructor(e){this._options=e,this._memoryManager=new o.MemoryManager,this._domAgent=new l.DirectDomAgent,this._cssMap=new Map,this._attributeSanitizer=this._options.config.attributeSanitizer,this._getHtmlString=this._options.config.htmlElementDataSerializer,this._idMapPrefix=this._options.idMapPrefix,this._rootElement=this._options.rootElement,this._createHookState=this._options.config.createHookState,this._sendNotification=this._options.config.notificationCallback,this._serializeHooks=this._options.config.serializeHooks,this._postRender=this._options.config.postRender,this._getElement=e=>this._memoryManager.getAndEnsureElementNode(e).element,this._customEventHandlerMap=(0,c.makeMap)(e.config.customEventHandlers||[],(e=>e.eventName),(e=>e.handler));const t=(0,i.serializeRootNode)(e.rootNode,e.setRootInstructionOptions,this._memoryManager.outerLtmRoot,this._idMapPrefix,this._getHtmlString,this._attributeSanitizer,this._serializeHooks,this._createHookState),n=t.containerDoc;g(t.elementNodes,t.dynamicNodes,this._memoryManager,t.commentLookup,n),(0,s.removeAllChildren)(e.rootElement),this.applyCssChanges(e.cssChanges),e.rootElement.appendChild(n),this._postRender&&this._postRender({hooksState:t.hooksState,getElement:this._getElement})}dispose(){this._memoryManager.dispose(),(0,s.removeAllChildren)(this._rootElement)}applyCssChanges(e){const t=e.newCssDefinition;for(const e of Object.keys(t))this._cssMap.set(e,t[e]);const s=[],i=[];for(const t of e.addedCss)s.push(this._cssMap.get(t));for(const t of e.removedCss)i.push(this._cssMap.get(t));(s.length||i.length)&&this._options.config.cssLoader(s,i)}setAttribute(e,t,s){this._domAgent.setAttribute(this._memoryManager,this._attributeSanitizer,e,t,(0,i.mapAttributeIdPointers)(t,s,this._idMapPrefix))}removeAttribute(e,t){this._domAgent.removeAttribute(this._memoryManager,e,t)}toggleClass(e,t,s){this._domAgent.toggleClass(this._memoryManager,e,t,s)}setStyle(e,t,s){this._domAgent.setStyle(this._memoryManager,e,t,s)}clear(e){const t=this._memoryManager.getAndEnsureDynamicNode(e);this._memoryManager.ensureContentDisposed(t,null),this._domAgent.clear(t)}remove(e){this._domAgent.remove(this._memoryManager.releaseDynamicNode(e,null))}toggleDisplay(e,t){this._domAgent.toggleDisplay(this._memoryManager,e,t)}addEventListener(e,t,i){const o=this._memoryManager.getAndEnsureElementNode(e);let n=o.eventNames;if(n||(n=o.eventNames=[]),!n.includes(t)){n.push(t);const r=this._customEventHandlerMap.get(t);r?r({element:o.element,elementNodeId:e,ltm:o.ltm.innerLtmRoot,options:i}):(0,s.attachEventListener)(o.element,o.ltm.innerLtmRoot,t,(s=>{this._sendNotification({type:"event",elementNodeId:e,eventName:t,eventData:(0,a.getEventData)(s,t)})}))}}setContent(e,t,o){const n=this._memoryManager.getAndEnsureDynamicNode(e);(0,a.ensureDynamicNodeOperation)(n.type,4),(0,s.ensureNoContent)(this._memoryManager,n,!1,null);const r=n.selfLtm,l=1&(0,c.getDynamicNodeOperations)(n.type)?n.contentLtm=r.createChildNode():r,d=(0,i.serializeRootNode)(t,o,l,this._idMapPrefix,this._getHtmlString,this._attributeSanitizer,this._serializeHooks,this._createHookState);this._domAgent.setDisplayState(n.commentStart,d.containerDoc),this._renderAfterComment(d,n.commentStart),this._postRender&&this._postRender({hooksState:d.hooksState,getElement:this._getElement})}setItems(e,t,s,o){this.applyCssChanges(s);const l=this._memoryManager.getAndEnsureDynamicNode(e);(0,a.ensureDynamicNodeOperation)(l.type,8);const c=l.itemNodesId,p=(0,r.arrayToSet)(c);for(const e of t)if("number"==typeof e){if(!p.delete(e))throw new Error(`The ForEachItem node ${e} doesn't exists, state tracking is lost.`)}else if("forEachItem"!==e.dynamicNodeType)throw new Error("Only ForEachItem is allowed as children of ForEach node.");p.forEach((e=>{this._memoryManager.releaseDynamicNode(e,null)}));const u={created:0,deleted:0,skipped:0,moved:0},g=(0,n.processForEachItems)((e=>this._memoryManager.getAndEnsureDynamicNode(e)),((e,t)=>{const s=(0,i.serializeRootNode)({children:e},o,l.selfLtm,this._idMapPrefix,this._getHtmlString,this._attributeSanitizer,this._serializeHooks,this._createHookState);return this._domAgent.setDisplayState(l.commentStart,s.containerDoc),this._renderAfterComment(s,t),this._postRender&&this._postRender({hooksState:s.hooksState,getElement:this._getElement}),e.map(h)}),l,t,m,d._identity,u);return u.deleted=c.length-(g.length-u.created),l.itemNodesId=g,g}focus(e,t){const s=this._rootElement.getElementsByClassName(this.getDomUniqueLocatorClass(e))[t];s&&document.activeElement!==s&&s.focus()}getElementMetadata(e){return this._memoryManager.getAndEnsureElementNode(e)}getMemoryDebugInfo(){return this._memoryManager.getDebugInfo()}getDomUniqueLocatorClass(e){return e.split(" ").filter(d._identity).map((e=>this._idMapPrefix+e)).join(" ")}initTwoWayInputBinding(e,t){const i=this._memoryManager.getAndEnsureElementNode(e),o=this._domAgent.prepareInitInputBinding(i,t),n={type:"twoWay",name:t,pendingCount:0};this._domAgent.inputBindingsMgr.createInputBinding(i,n);for(const r of o.eventsToListen)(0,s.attachEventListener)(i.element,i.ltm.innerLtmRoot,r,(s=>{this._sendNotification({type:"twoWayInputBinding",elementNodeId:e,inputBindingName:t,eventData:o.collectDataFromEvent(s)}),n.pendingCount++}))}initValuePushInputBinding(e,t){const i=this._memoryManager.getAndEnsureElementNode(e),o=this._domAgent.prepareInitInputBinding(i,t),n={type:"valuePush",name:t,lastReceivedValue:void 0};this._domAgent.inputBindingsMgr.createInputBinding(i,n);const r=i.element;for(const e of o.eventsToListen)(0,s.attachEventListener)(r,i.ltm.innerLtmRoot,e,(()=>{o.writeValueToElement(r,n.lastReceivedValue)}))}initValueSubscribeInputBinding(e,t){const i=this._memoryManager.getAndEnsureElementNode(e),o=this._domAgent.prepareInitInputBinding(i,t),n={type:"valueSubscribe",name:t};this._domAgent.inputBindingsMgr.createInputBinding(i,n);const r=i.element;for(const n of o.eventsToListen)(0,s.attachEventListener)(r,i.ltm.innerLtmRoot,n,(s=>{this._sendNotification({type:"valueSubscribeInputBinding",elementNodeId:e,inputBindingName:t,eventData:o.collectDataFromEvent(s)})}))}twoWayInputBindingCommit(e,t,s){const i=this._memoryManager.getAndEnsureElementNode(e),o=this._domAgent.inputBindingsMgr.resolveInputBinding(i,t,["twoWay"]),n=this._domAgent.ensureInputBindingMetadata(t);if(o.pendingCount<=0)throw new Error(`Received more twoWayInputBindingCommit message than it should. ${e}, "${t}", ${o.pendingCount}`);o.pendingCount--,0===o.pendingCount&&n.writeValueToElement(i.element,s)}pushInputValue(e,t,s){const i=this._memoryManager.getAndEnsureElementNode(e),o=this._domAgent.inputBindingsMgr.resolveInputBinding(i,t,["twoWay","valuePush"]),n=this._domAgent.ensureInputBindingMetadata(t);"twoWay"===o.type?0===o.pendingCount&&n.writeValueToElement(i.element,s):(o.lastReceivedValue=s,n.writeValueToElement(i.element,s))}_renderAfterComment(e,t){const i=t.nextSibling,o=e.containerDoc;g(e.elementNodes,e.dynamicNodes,this._memoryManager,e.commentLookup,o),(0,s.insertNodeBeforeNode)(i,o)}}function m(e){return"number"!=typeof e}function g(e,t,i,o,n){for(const t of e){const e=(0,s.getElementByIdInDocumentFragment)(n,t.domId);i.setElementNode({nodeId:t.nodeId,element:e,ltm:t.ltm})}for(const e of t)i.setDynamicNode({nodeId:e.nodeId,type:e.nodeType,commentStart:o.get(e.commentStartId),commentEnd:o.get(e.commentEndId),contentLtm:e.initContentLtm,selfLtm:e.selfLtm,itemNodesId:e.initItemsId})}function h(e){return e.nodeId}t.SandboxModeRenderEngine=u;let f=0})),
define("MsPortalImpl/Weave/SandboxRender",["require","exports","MsPortalImpl/Weave/InternalUtil","WeaveDOM/SandboxRender/WeaveSandbox","MsPortalImpl/Base/Base.KnockoutExtensions.Image","Viva.Controls/Util/Viva.Resize","MsPortalImpl/Weave/SandboxDomAgents/EntryPoint","MsPortalImpl/Base/Base.Timers","WeaveDOM/Core/InternalUtil","Weave/Core/InternalUtil"],(function(e,t,s,i,o,n,r,a,l,c){"use strict";function d(e,t,i){return{eventName:e,handler:({element:o,elementNodeId:n,ltm:r,options:a})=>{const d=a;(0,l.attachEventListener)(o,r,t,(o=>{(0,s.matchKeyCode)(d?.stopPropagation,o.keyCode)&&o.stopPropagation(),(0,s.matchKeyCode)(d?.preventDefault,o.keyCode)&&o.preventDefault(),i.postMessage({type:"event",elementNodeId:n,eventName:e,eventData:(0,c.getEventData)(o,t)})}))}}}t.connectWeaveShellPort=function(t,c,p,u){let m=!1;return(0,i.connect_internal)(c,{cssLoader:u,registerOnReceive:e=>{if(m)throw new Error("onReceive can only be registered once.");m=!0,t.onObject((t=>{e(t.body,t.obj)}))},registerOnDispose:e=>t.onDispose(e),notificationCallback:e=>t.postMessage(e),attributeSanitizer:{href:t=>(0,s.sanitizeHref)(t,{diContainer:p,windowContext:c,localRequire:e}),src:s.sanitizeSrc},htmlElementDataSerializer:(0,s.makeHtmlDataHandler)(c,p,!1),customEventHandlers:[{eventName:"fxResize",handler:({element:e,elementNodeId:s,ltm:i})=>{(0,a.requestAnimationFrame)((()=>{i.isDisposed()||(0,n.track)(i.createChildLifetime(),$(e).first(),((e,i)=>{(e>0||i>0)&&t.postMessage({type:"event",elementNodeId:s,eventName:"fxResize",eventData:{height:i,width:e}})}),{notifyInitialSize:!0,partialPixels:!0})}))}},{eventName:"fxCustomClick",handler:({element:e,elementNodeId:s,ltm:i,options:o})=>{const n=o;(0,l.attachEventListener)(e,i,"click",(e=>{!0===n?.stopPropagation&&e.stopPropagation(),!0===n?.preventDefault&&e.preventDefault(),t.postMessage({type:"event",elementNodeId:s,eventName:"fxCustomClick",eventData:null})}))}},d("fxCustomKeyDown","keydown",t),d("fxCustomKeyUp","keyup",t),d("fxCustomKeyPress","keypress",t)],customInstructionHandlers:[{name:"fxSetImage",handler:(e,t)=>(0,o.renderImage)(t.getElementMetadata(e.elementNodeId).element,e.value)},{name:"fxSetFocus",handler:(e,t)=>t.getElementMetadata(e.elementNodeId).element.focus()},{name:"fxRequestConfirm",handler:(e,s)=>{const i=window.confirm(e.value.content)?"ok":"cancel";t.postMessage({type:"fxAnswerConfirm",value:{reply:i,replyId:e.value.replyId}})}}],createHookState:()=>[],serializeHooks:{element:{postSerialize:({addAttribute:e,getElementNodeId:t,node:s,options:i,ltm:o,hooksState:n})=>{const r=s;r.proxiedDataIndexes&&r.proxiedDataIndexes.length>0&&(r.proxiedDataIndexes.some((e=>"pcControl"===i[e].type))&&e("data-bind","pcControl: __control_vm__"),n.push({ltm:o,nodeId:t(),proxiedDataList:r.proxiedDataIndexes.map((e=>i[e]))}))}}},postRender:({hooksState:e,getElement:t})=>{for(const i of e){const e=t(i.nodeId),o=i.ltm;let n=!1,a=!1,l=!1;for(const t of i.proxiedDataList)switch(t.type){case"pcControl":{if(n)throw new Error("Duplicate control vm associated to one element found.");n=!0;const s=t.data,i=new ko.bindingContext({__control_vm__:s.vm}).extend({$tabIndex:s.tabIndex,$disabled:s.disabled,$partName:s.partName,$extensionName:s.extensionName,$vm:s.vm,$dicontainer:p});ko.applyBindings(i,e),o.registerForDispose((()=>ko.cleanNode(e)));break}case"fxclick":{if(a)throw new Error("Duplicate fxclick associated to one element found.");a=!0;const i=t.data;(0,s.applyFxClickToElement)(e,o,i.data,{diContainer:p,disabled:i.disabled,tabIndex:i.tabIndex});break}case"domAgent":if(l)throw new Error("Duplicate attachWidget associated to one element found.");l=!0,(0,r.attachSandboxDomAgent)(e,o,p,t.data);break;default:throw new Error(`Unknown proxied data type: ${t.type}`)}}}})}})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.PartError.css",["module"],(function(e){"use strict";return{css:".fxs-part-error-content{display:flex;flex-flow:column nowrap;height:100%;box-sizing:border-box;max-width:715px;font-size:13px;margin:0 auto}.fxs-part-error-reason,.fxs-part-error-detailslink{text-align:center;flex:0 0 auto;margin-bottom:4px}.fxs-part-error-healthlinkcontainer{margin:-10px 15px 0}.fxs-part-error-showdetailscontainer{display:flex;flex-flow:row nowrap;align-items:center;justify-content:center}.fxs-part-error-detailslink{display:none}.fxs-part .fxs-part-content.fxs-errorpart~.fxs-part-nodatamessage{display:none!important}.fxs-part-error-iconcontainer{display:flex;flex-flow:column nowrap;align-items:center;justify-content:center;flex:0 1 auto}.fxs-part-error-icon{flex:0 0 auto;display:block;height:50px;width:50px;padding:10px}.fxs-part-error-commandlist{flex:0 0 auto}.fxs-part-error-commandlist .azc-toolbar-container{justify-content:center}.fxs-part-error-summary{border-width:1px;border-style:solid;overflow-x:hidden;overflow-y:auto;flex:0 1 auto;margin:10px 0}.fxs-part-error-summaryheadercontainer{margin:15px;display:flex;align-items:center}.fxs-part-error-summaryheader{margin:0}.fxs-part-error-summaryfooter{margin:15px}.fxs-part-error-summarycopybutton{margin-left:15px}.fxs-part-error-summarylist{list-style-type:none;padding:0;margin:15px;display:flex;flex-flow:row wrap;align-content:flex-start}.fxs-part-error-summarylistitem{margin:0 10px 10px 0;width:calc(50% - 10px);min-width:225px}.fxs-part-error-summarylistitem-key,.fxs-part-error-summarylistitem-value{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.fxs-part-error-details{margin:15px}.fxs-tilesize-mini .fxs-part-error .fxs-part-error-icon,.fxs-tilesize-small .fxs-part-error .fxs-part-error-icon{margin-top:-15px}.fxs-tilesize-mini .fxs-part-error .fxs-part-error-detailslink,.fxs-tilesize-small .fxs-part-error .fxs-part-error-detailslink{padding:0;margin-top:-12px}.fxs-part-error-hidereason .fxs-part-error-reason{display:none}.fxs-part-error-hidecommandlist .fxs-part-error-commandlist{display:none}.fxs-part-error-hidecommandlist .fxs-part-error-detailslink{display:inline-block}.fxs-part-error-hidesummary .fxs-part-error-summary{display:none}.fxs-blade-errorcontent .fxs-part-error-icon{height:125px;width:125px}.fxs-blade-errorcontent .fxs-part-error-reason{font-size:18px}",moduleId:e.id}})),
define("MsPortalImpl/Widgets/Widgets.PartError",["require","exports","MsPortalImpl/TsxStringMode/Tsx","Fx/ResourceManagement","MsPortalImpl/Resources/ImplScriptResources","Fx/Controls/CopyableLabel","Fx/Controls/Toolbar","MsPortalImpl/Widgets/Widgets.WidgetBase","Viva.Controls/Util/Viva.Resize","_generated/Less/MsPortalImpl/Widgets/Widgets.PartError.css","FxInternal/Css","Fx/Errors"],(function(e,t,s,i,o,n,r,a,l,c,d,p){"use strict";t.Widget=t.ViewModel=void 0;var u=s,m=MsPortalFx.Base,g=m.Diagnostics.Telemetry;const h=m.Diagnostics.createLog(e);(0,d.injectCss)(c);const f=window,x="fxs-errorpart",b=o.PartError,y=u.tsx("div",{class:"fxs-part-error-content","data-bind":{css:"responsiveClasses"}},u.tsx("div",{class:"fxs-part-error-iconcontainer"},u.tsx("div",{"data-bind":{image:"data.icon"},class:"fxs-part-error-icon"})),u.tsx("div",{"data-bind":{untrustedContent:"data.errorOptions.message"},class:"fxs-part-error-reason"}),u.tsx("div",{class:"fxs-part-error-showdetailscontainer"},u.tsx("a",{href:"#",role:"button","data-bind":{click:"$data.showdetails",clickBubble:"false",text:"$data.showdetailstext"},class:"fxs-part-error-detailslink"})),u.tsx("div",{"data-bind":{pcControl:"toolbar"},class:"fxs-part-error-commandlist"}),u.tsx("div",{class:"fxs-part-error-summary fxs-portal-bg-txt-br"},u.tsx("div",{class:"fxs-part-error-summaryheadercontainer"},u.tsx("h4",{class:"fxs-part-error-summaryheader msportalfx-font-semibold"},b.summary),u.tsx("div",{"data-bind":{pcControl:"copyBtn"},class:"fxs-part-error-summarycopybutton"})),u.tsx("ul",{"data-bind":{foreach:"data.summaryItems"},class:"fxs-part-error-summarylist"},u.tsx("li",{class:"fxs-part-error-summarylistitem"},u.tsx("label",{"data-bind":{text:"label"},class:"fxs-part-error-summarylistitem-key fxs-portal-subtext"}),u.tsx("div",{"data-bind":{text:"value"},class:"fxs-part-error-summarylistitem-value"}))),u.tsx("div",{"data-bind":{visible:"data.errorOptions.code >= 500"},class:"fxs-part-error-healthlinkcontainer"},u.tsx("a",{href:"#blade/Microsoft_Azure_Health/AzureHealthBrowseBlade/serviceIssues","data-bind":{text:"$data.azurehealth"}})),u.tsx(s.KoIf,{condition:"data.errorOptions.details"},u.tsx("div",{class:"fxs-part-error-details"},u.tsx("label",{class:"fxs-part-error-summarylistitem-key fxs-portal-subtext"},b.details),u.tsx("div",{"data-bind":{untrustedContent:"data.errorOptions.details"},class:"fxs-part-error-summarylistitem-details"})))));class v extends a.ViewModel{constructor(e,t,s){super(),this.commands=ko.observableArray([]),s=s||{};const i=MsPortalFx.extend({},e,!0);this.originalShellProps=t=t||{},i.message=i.message||b.title;const o="number"==typeof i.code?i.code:"number"==typeof t.code?t.code:Number.NaN;i.code=o;const n={title:b.title};switch(o){case 404:case 410:this.icon=m.Images.Polychromatic.ContentErrorNotFound(n);break;case 401:case 403:this.icon=m.Images.Polychromatic.ContentErrorUnauthorized(n);break;default:this.icon=m.Images.Polychromatic.ContentErrorGeneric(n)}const r=[{label:b.sessionId,value:t.sessionId||b.notAvailable},{label:b.resourceId,value:t.resourceId||b.notAvailable},{label:b.extName,value:t.extName||b.notAvailable},{label:b.contentName,value:t.contentName||b.notAvailable},{label:b.errorCode,value:isNaN(o)?"--":o+""}];i.summaryItems&&(i.summaryItems=i.summaryItems.filter(MsPortalFx.notNullOrUndefined).map((e=>({label:e.label||"",value:e.value||""}))),r.push(...i.summaryItems)),this.summaryItems=r,this.errorOptions=i,this.showDetailsCmd=s.showDetailsCmd||!1}cloneForDetailsPane(){const e=new v(this.errorOptions,this.originalShellProps);return e.commands.push(...this.commands.peek()||[]),e}}t.ViewModel=v;let w=0;class M extends a.Widget{constructor(e,t,s){super(e,t),this._diContainer=s,e.html(y).addClass(x);const o=ko.observable(""),a=i.ArmId.parse(t.originalShellProps.resourceId,!0),c=a.subscription??"",d=a.resourceGroup??"",u=a.resourceType??"";l.track(this.ltm,this.element.first(),((e,s)=>{const i=[];switch((e<145||s<145)&&i.push("fxs-part-error-hidereason"),(e<235||s<145)&&i.push("fxs-part-error-hidecommandlist"),(e<255||s<235)&&i.push("fxs-part-error-hidesummary"),t.errorOptions.code){case 404:case 410:i.push("fxs-part-notfoundmessage","fxs-part-notfound");break;case 401:case 403:i.push("fxs-part-noaccessmessage")}o(i.join(" "))}));const v=()=>(g.trace({source:"Shell",action:"ErrorInteraction",actionModifier:"DetailView",context:{content:t.originalShellProps.contentName}}),MsPortalFx.require("MsPortalImpl/UI/UI.Portal.Actions").then((e=>{e.showErrorContextPane(this._diContainer,this.ltm,t)})),!1);let M=[];if(t.showDetailsCmd&&M.push(r.ToolbarItems.createBasicButton(this.ltm,{label:b.errordetailsbtn,icon:m.Images.Gear(),onClick:v})),t.commands().length&&(M=t.commands().map((e=>r.ToolbarItems.createBasicButton(this.ltm,{label:e.text,icon:e.icon,onClick:()=>{e.execute(!1)}})))),MsPortalFx.isFeatureEnabled("parterrorshowprodbutton")&&M.push(r.ToolbarItems.createBasicButton(this.ltm,{label:b.openProductionUri,icon:m.Images.Hyperlink(),onClick:()=>{g.trace({source:"Shell",action:"ErrorInteraction",actionModifier:"LeavePreview",context:{content:t.originalShellProps.contentName}});const e=new m.UriBuilder(f.location.toString());e.path=e.path.replace("//rc.","//").replace("//ms.","//").replace("//preview.","//"),e.query.setParameter("feature.customportal","false"),f.open(e.toString())}})),401!==t.errorOptions.code&&403!==t.errorOptions.code&&(M.push(r.ToolbarItems.createBasicButton(this.ltm,{label:b.getsupportbtn,icon:m.Images.Help(),onClick:()=>{g.trace({source:"Shell",action:"ErrorInteraction",actionModifier:"NewSupportRequest",context:{content:t.originalShellProps.contentName}}),MsPortalFx.require("MsPortalImpl/UI/UI.Portal.Actions").then((e=>{e.openSubmitSupportCase(this._diContainer,{callerName:`${t.originalShellProps.extName} + ${t.originalShellProps.contentName||"##Content Unknown##"}`,assetId:t.originalShellProps.resourceId,issueType:"technical",issueContext:{shellProps:JSON.stringify(t.originalShellProps),error:JSON.stringify(t.errorOptions)}})}))}})),M.push(r.ToolbarItems.createBasicButton(this.ltm,{label:b.selfDiagnostics,icon:m.Images.Wrench(),onClick:()=>{g.trace({source:"Shell",action:"ErrorInteraction",actionModifier:"SelfDiagnostics",context:{content:t.originalShellProps.contentName}});const e=fx.environment.applicationPath+"/SelfHelp";window.open(e)}}))),401===t.errorOptions.code||403===t.errorOptions.code){(()=>{g.trace({source:"Shell",action:"ErrorInteraction",actionModifier:"NoAccess",context:{origin:t.originalShellProps.contentName,extensionName:t.originalShellProps.extName,message:t.errorOptions.message,details:t.errorOptions.details,summaryItems:t.errorOptions.summaryItems,resourceGroup:d,subscriptionId:c,resourceType:u}})})();(async()=>{const e=await MsPortalFx.require("react"),s=(await MsPortalFx.require("react-dom/client")).createRoot,i=await MsPortalFx.require("MsPortalImpl/Widgets/NoAccess/NoAccessRedesign.React"),o=w++,n=i.NoAccessRedesign,r=i.noAccessRedesignTelemetryCallbackMap,a=document.getElementsByClassName("fxs-blade-errorcontent")[0];if(!a)return;const l=s(a);l.render(e.createElement(n,{dicontainer:this._diContainer,parameters:{sessionId:MsPortalFx.sessionId,resourceId:t.originalShellProps.resourceId,errorCode:t.errorOptions.code.toString(),details:t.errorOptions.message.toString()},counter:o})),this.ltm.registerForDispose((()=>{if(l?.parentNode&&l.unmount)try{l.unmount()}catch(e){h.warning(new p.FxError({message:"Ignored error in react unmount",innerErrors:e,errorLevel:1}))}else r?.get(o)?.()}))})()}const C=r.create(this.ltm,{items:M,showLabels:!0}),S=n.create(this.ltm,{ariaLabel:b.copySummary,hideTextbox:!0,value:JSON.stringify({shellProps:t.originalShellProps,error:t.errorOptions},null,2)});this._bindDescendants({responsiveClasses:o,showdetails:v,showdetailstext:b.errordetailsbtn,azurehealth:b.azurehealthlink,toolbar:C,copyBtn:S})}dispose(){this._cleanElement(x),super.dispose()}}t.Widget=M})),
define("_generated/Less/MsPortalImpl/CssLibrary/AzureCompatibleOfficeLayoutGrid.css",["module"],(function(e){"use strict";return{css:'.ms-Grid{box-sizing:border-box;zoom:1;padding:0 8px}.ms-Grid::before,.ms-Grid::after{display:table;content:"";line-height:0}.ms-Grid::after{clear:both}.ms-Grid-row{margin:0 -8px;box-sizing:border-box;zoom:1}.ms-Grid-row::before,.ms-Grid-row::after{display:table;content:"";line-height:0}.ms-Grid-row::after{clear:both}.ms-Grid-col{position:relative;min-height:1px;padding-left:8px;padding-right:8px;box-sizing:border-box}.ms-Grid-col{float:left}.ms-Grid-col .ms-Grid{padding:0}.fxs-blade-layout-sm:not(.fxs-blade-layout-md) .ms-hiddenSm,.fxs-blade-layout-sm:not(.fxs-blade-layout-md) .ms-hiddenMdDown,.fxs-blade-layout-sm:not(.fxs-blade-layout-md) .ms-hiddenLgDown,.fxs-blade-layout-sm:not(.fxs-blade-layout-md) .ms-hiddenXlDown,.fxs-blade-layout-sm:not(.fxs-blade-layout-md) .ms-hiddenXxlDown{display:none!important}.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenMd,.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenMdUp,.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenMdDown,.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenLgDown,.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenXlDown,.fxs-blade-layout-md:not(.fxs-blade-layout-lg) .ms-hiddenXxlDown{display:none!important}.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenMdUp,.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenLg,.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenLgUp,.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenLgDown,.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenXlDown,.fxs-blade-layout-lg:not(.fxs-blade-layout-xl) .ms-hiddenXxlDown{display:none!important}.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenMdUp,.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenLgUp,.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenXl,.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenXlUp,.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenXlDown,.fxs-blade-layout-xl:not(.fxs-blade-layout-xxl) .ms-hiddenXxlDown{display:none!important}.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenMdUp,.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenLgUp,.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenXlUp,.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenXxl,.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenXxlUp,.fxs-blade-layout-xxl:not(.fxs-blade-layout-xxxl) .ms-hiddenXxlDown{display:none!important}.fxs-blade-layout-xxxl .ms-hiddenMdUp,.fxs-blade-layout-xxxl .ms-hiddenLgUp,.fxs-blade-layout-xxxl .ms-hiddenXlUp,.fxs-blade-layout-xxxl .ms-hiddenXxlUp,.fxs-blade-layout-xxxl .ms-hiddenXxxl{display:none!important}.ms-sm12{width:100%}.ms-sm11{width:91.66666667%}.ms-sm10{width:83.33333333%}.ms-sm9{width:75%}.ms-sm8{width:66.66666667%}.ms-sm7{width:58.33333333%}.ms-sm6{width:50%}.ms-sm5{width:41.66666667%}.ms-sm4{width:33.33333333%}.ms-sm3{width:25%}.ms-sm2{width:16.66666667%}.ms-sm1{width:8.33333333%}.fxs-blade-layout-md .ms-md12{width:100%}.fxs-blade-layout-md .ms-md11{width:91.66666667%}.fxs-blade-layout-md .ms-md10{width:83.33333333%}.fxs-blade-layout-md .ms-md9{width:75%}.fxs-blade-layout-md .ms-md8{width:66.66666667%}.fxs-blade-layout-md .ms-md7{width:58.33333333%}.fxs-blade-layout-md .ms-md6{width:50%}.fxs-blade-layout-md .ms-md5{width:41.66666667%}.fxs-blade-layout-md .ms-md4{width:33.33333333%}.fxs-blade-layout-md .ms-md3{width:25%}.fxs-blade-layout-md .ms-md2{width:16.66666667%}.fxs-blade-layout-md .ms-md1{width:8.33333333%}.fxs-blade-layout-lg .ms-lg12{width:100%}.fxs-blade-layout-lg .ms-lg11{width:91.66666667%}.fxs-blade-layout-lg .ms-lg10{width:83.33333333%}.fxs-blade-layout-lg .ms-lg9{width:75%}.fxs-blade-layout-lg .ms-lg8{width:66.66666667%}.fxs-blade-layout-lg .ms-lg7{width:58.33333333%}.fxs-blade-layout-lg .ms-lg6{width:50%}.fxs-blade-layout-lg .ms-lg5{width:41.66666667%}.fxs-blade-layout-lg .ms-lg4{width:33.33333333%}.fxs-blade-layout-lg .ms-lg3{width:25%}.fxs-blade-layout-lg .ms-lg2{width:16.66666667%}.fxs-blade-layout-lg .ms-lg1{width:8.33333333%}.fxs-blade-layout-xl .ms-xl12{width:100%}.fxs-blade-layout-xl .ms-xl11{width:91.66666667%}.fxs-blade-layout-xl .ms-xl10{width:83.33333333%}.fxs-blade-layout-xl .ms-xl9{width:75%}.fxs-blade-layout-xl .ms-xl8{width:66.66666667%}.fxs-blade-layout-xl .ms-xl7{width:58.33333333%}.fxs-blade-layout-xl .ms-xl6{width:50%}.fxs-blade-layout-xl .ms-xl5{width:41.66666667%}.fxs-blade-layout-xl .ms-xl4{width:33.33333333%}.fxs-blade-layout-xl .ms-xl3{width:25%}.fxs-blade-layout-xl .ms-xl2{width:16.66666667%}.fxs-blade-layout-xl .ms-xl1{width:8.33333333%}.fxs-blade-layout-xxl .ms-xxl12{width:100%}.fxs-blade-layout-xxl .ms-xxl11{width:91.66666667%}.fxs-blade-layout-xxl .ms-xxl10{width:83.33333333%}.fxs-blade-layout-xxl .ms-xxl9{width:75%}.fxs-blade-layout-xxl .ms-xxl8{width:66.66666667%}.fxs-blade-layout-xxl .ms-xxl7{width:58.33333333%}.fxs-blade-layout-xxl .ms-xxl6{width:50%}.fxs-blade-layout-xxl .ms-xxl5{width:41.66666667%}.fxs-blade-layout-xxl .ms-xxl4{width:33.33333333%}.fxs-blade-layout-xxl .ms-xxl3{width:25%}.fxs-blade-layout-xxl .ms-xxl2{width:16.66666667%}.fxs-blade-layout-xxl .ms-xxl1{width:8.33333333%}.fxs-blade-layout-xxxl .ms-xxxl12{width:100%}.fxs-blade-layout-xxxl .ms-xxxl11{width:91.66666667%}.fxs-blade-layout-xxxl .ms-xxxl10{width:83.33333333%}.fxs-blade-layout-xxxl .ms-xxxl9{width:75%}.fxs-blade-layout-xxxl .ms-xxxl8{width:66.66666667%}.fxs-blade-layout-xxxl .ms-xxxl7{width:58.33333333%}.fxs-blade-layout-xxxl .ms-xxxl6{width:50%}.fxs-blade-layout-xxxl .ms-xxxl5{width:41.66666667%}.fxs-blade-layout-xxxl .ms-xxxl4{width:33.33333333%}.fxs-blade-layout-xxxl .ms-xxxl3{width:25%}.fxs-blade-layout-xxxl .ms-xxxl2{width:16.66666667%}.fxs-blade-layout-xxxl .ms-xxxl1{width:8.33333333%}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/CssLibrary/AzureDeprecatedChartingColor.css",["module"],(function(e){"use strict";return{css:".msportalfx-bgcolor-a1{background-color:#fcd116;color:#000}.msportalfx-bgcolor-b1{background-color:#eb3c00;color:#fff}.msportalfx-bgcolor-c1{background-color:#ba141a;color:#fff}.msportalfx-bgcolor-d1{background-color:#b4009e;color:#fff}.msportalfx-bgcolor-e1{background-color:#442359;color:#fff}.msportalfx-bgcolor-f1{background-color:#002050;color:#fff}.msportalfx-bgcolor-g1{background-color:#0072c6;color:#fff}.msportalfx-bgcolor-h1{background-color:#008272;color:#fff}.msportalfx-bgcolor-i1{background-color:#007233;color:#fff}.msportalfx-bgcolor-j1{background-color:#7fba00;color:#fff}.msportalfx-bgcolor-k1{background-color:#a0a5a8;color:#fff}.msportalfx-bgcolor-a0{background-color:#fff100;color:#000}.msportalfx-bgcolor-b0{background-color:#ff8c00;color:#fff}.msportalfx-bgcolor-c0{background-color:#e81123;color:#fff}.msportalfx-bgcolor-d0{background-color:#ec008c;color:#fff}.msportalfx-bgcolor-e0{background-color:#68217a;color:#fff}.msportalfx-bgcolor-f0{background-color:#00188f;color:#fff}.msportalfx-bgcolor-g0{background-color:#00bcf2;color:#fff}.msportalfx-bgcolor-h0{background-color:#00b294;color:#fff}.msportalfx-bgcolor-i0{background-color:#009e49;color:#fff}.msportalfx-bgcolor-j0{background-color:#bad80a;color:#000}.msportalfx-bgcolor-k0{background-color:#bbc2ca;color:#000}.msportalfx-bgcolor-a2{background-color:#fffc9e;color:#000}.msportalfx-bgcolor-b2{background-color:#ffb900;color:#000}.msportalfx-bgcolor-c2{background-color:#dd5900;color:#fff}.msportalfx-bgcolor-d2{background-color:#f472d0;color:#fff}.msportalfx-bgcolor-e2{background-color:#9b4f96;color:#fff}.msportalfx-bgcolor-f2{background-color:#4668c5;color:#fff}.msportalfx-bgcolor-g2{background-color:#6dc2e9;color:#000}.msportalfx-bgcolor-h2{background-color:#00d8cc;color:#000}.msportalfx-bgcolor-i2{background-color:#55d455;color:#000}.msportalfx-bgcolor-j2{background-color:#e2e584;color:#000}.msportalfx-bgcolor-k2{background-color:#d6d7d8;color:#000}.msportalfx-bgcolor-a0s2{background-color:#807900;color:#fff}.msportalfx-bgcolor-b0s2{background-color:#804600;color:#fff}.msportalfx-bgcolor-c0s2{background-color:#740912;color:#fff}.msportalfx-bgcolor-d0s2{background-color:#760046;color:#fff}.msportalfx-bgcolor-e0s2{background-color:#34113d;color:#fff}.msportalfx-bgcolor-f0s2{background-color:#000c48;color:#fff}.msportalfx-bgcolor-g0s2{background-color:#005e79;color:#fff}.msportalfx-bgcolor-h0s2{background-color:#084c41;color:#fff}.msportalfx-bgcolor-i0s2{background-color:#063d20;color:#fff}.msportalfx-bgcolor-j0s2{background-color:#3d460a;color:#fff}.msportalfx-bgcolor-k0s2{background-color:#32383f;color:#fff}.msportalfx-bgcolor-a0s1{background-color:#bfb500;color:#000}.msportalfx-bgcolor-b0s1{background-color:#bf6900;color:#fff}.msportalfx-bgcolor-c0s1{background-color:#ae0d1a;color:#fff}.msportalfx-bgcolor-d0s1{background-color:#b10069;color:#fff}.msportalfx-bgcolor-e0s1{background-color:#4e195c;color:#fff}.msportalfx-bgcolor-f0s1{background-color:#00126b;color:#fff}.msportalfx-bgcolor-g0s1{background-color:#008db5;color:#fff}.msportalfx-bgcolor-h0s1{background-color:#00856f;color:#fff}.msportalfx-bgcolor-i0s1{background-color:#0f5b2f;color:#fff}.msportalfx-bgcolor-j0s1{background-color:#8ba208;color:#fff}.msportalfx-bgcolor-k0s1{background-color:#464f59;color:#fff}.msportalfx-bgcolor-a0t1{background-color:#fcf37e;color:#000}.msportalfx-bgcolor-b0t1{background-color:#ffba66;color:#000}.msportalfx-bgcolor-c0t1{background-color:#f1707b;color:#fff}.msportalfx-bgcolor-d0t1{background-color:#f466ba;color:#fff}.msportalfx-bgcolor-e0t1{background-color:#a47aaf;color:#fff}.msportalfx-bgcolor-f0t1{background-color:#6674bc;color:#fff}.msportalfx-bgcolor-g0t1{background-color:#66d7f7;color:#000}.msportalfx-bgcolor-h0t1{background-color:#66d1bf;color:#000}.msportalfx-bgcolor-i0t1{background-color:#66c592;color:#000}.msportalfx-bgcolor-j0t1{background-color:#d6e86c;color:#000}.msportalfx-bgcolor-k0t1{background-color:#8f9ca8;color:#fff}.msportalfx-bgcolor-a0t2{background-color:#fffccc;color:#000}.msportalfx-bgcolor-b0t2{background-color:#ffe8cc;color:#000}.msportalfx-bgcolor-c0t2{background-color:#facfd3;color:#000}.msportalfx-bgcolor-d0t2{background-color:#fbcce8;color:#000}.msportalfx-bgcolor-e0t2{background-color:#e1d3e4;color:#000}.msportalfx-bgcolor-f0t2{background-color:#ccd1e9;color:#000}.msportalfx-bgcolor-g0t2{background-color:#ccf2fc;color:#000}.msportalfx-bgcolor-h0t2{background-color:#ccf0ea;color:#000}.msportalfx-bgcolor-i0t2{background-color:#ccecdb;color:#000}.msportalfx-bgcolor-j0t2{background-color:#f0f7b2;color:#000}.msportalfx-bgcolor-k0t2{background-color:#63707e;color:#fff}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/CssLibrary/AzureDeprecatedSemanticText.css",["module"],(function(e){"use strict";return{css:'.msportalfx-text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-font-regular{font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400}.msportalfx-font-bold{font-weight:700}.msportalfx-font-semibold{font-weight:600}.msportalfx-font-light,.msportalfx-font-semilight{font-weight:200}.msportalfx-font-monospace{font-family:Consolas,"Courier New",monospace;font-size:13px;line-height:normal}.msportalfx-text-header{font-size:14px;line-height:18px}.msportalfx-text-header-small,.msportalfx-text-label{font-size:13px;line-height:normal;text-transform:uppercase}.msportalfx-text-small{font-size:13px;line-height:normal}.msportalfx-text-subheader{font-size:10px;line-height:10px;padding-bottom:1px}html[lang^="ja"] .msportalfx-text-subheader,html[lang^="ko"] .msportalfx-text-subheader,html[lang^="zh"] .msportalfx-text-subheader{font-size:11px;line-height:11px}.msportalfx-text-header-regular{font-size:14px;line-height:18px}.msportalfx-text-regular{font-size:13px;line-height:normal}.msportalfx-text-preview{font-weight:600;font-size:11px;line-height:11px;text-transform:uppercase;color:#fff}.msportalfx-text-createsectionheader{font-weight:200;font-size:20px;line-height:normal}.msportalfx-number-jumbo{font-weight:600;font-size:60px;line-height:60px;letter-spacing:-.02em}.msportalfx-number-large{font-weight:600;font-size:43px;line-height:43px;letter-spacing:-.02em}.msportalfx-number-medium{font-weight:600;font-size:30px;line-height:30px;letter-spacing:-.025em}.msportalfx-number-small{font-weight:600;font-size:17px;line-height:17px;letter-spacing:-.02em}.msportalfx-number-jumbo-adorn{font-weight:700;font-size:20px;line-height:20px;letter-spacing:-.02em}.msportalfx-number-large-adorn{font-weight:700;font-size:15px;line-height:15px;letter-spacing:-.02em}.msportalfx-number-medium-adorn{font-weight:700;font-size:15px;line-height:15px;letter-spacing:-.02em}.msportalfx-number-small-adorn{font-weight:700;font-size:10px;line-height:10px;letter-spacing:-.05em}.msportalfx-lineheight-reset{line-height:normal}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/CssLibrary/AzureSemanticText.css",["module"],(function(e){"use strict";return{css:'.az-text-small{font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400;font-size:10px;line-height:1.4}.az-text-note{font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400;font-size:12px;line-height:1.33333}.az-text-body{font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400;font-size:13px;line-height:1.38462}.az-text-label{font-weight:600;font-size:13px;line-height:1.38462}.az-text-header3{font-weight:600;font-size:14px;line-height:1.42857}.az-text-header2{font-weight:600;font-size:16px;line-height:1.375}.az-text-header1{font-weight:600;font-size:18px;line-height:1.33333}.az-text-greeting{font-weight:600;font-size:20px;line-height:1.4}@media print{.az-text-header1,.az-text-header2,.az-text-header3,.az-text-label{break-after:avoid}}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/CssLibrary/AzureUtil.css",["module"],(function(e){"use strict";return{css:".az-display-none{display:none!important}@media print{.az-noprint{display:none!important}}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/CssLibrary/CustomForm.css",["module"],(function(e){"use strict";return{css:'.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-formElementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-formElementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-formElementSubLabelContainer{display:inline-block;vertical-align:middle;width:68%}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement.msportalfx-form-fileUploadField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement.msportalfx-form-fileUploadField{height:80px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-form-labelcontainer{width:32%;display:inline-block}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular .msportalfx-form-extralabel{display:block;width:68%;margin-left:33%;margin-right:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:nth-child(odd),.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:nth-child(odd){margin-right:1%}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement{min-height:43px;width:48.75%!important;display:inline-block;vertical-align:top;margin-top:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:first-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:first-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:last-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:last-child{margin-top:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.azc-optionsGroupField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.azc-optionsGroupField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.azc-multiLineTextField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.azc-multiLineTextField{height:auto;margin-right:1px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.msportalfx-form-fileUploadField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.msportalfx-form-fileUploadField{height:100px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .azc-form-labelcontainer{display:block;margin-bottom:0;width:auto;min-height:20px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .azc-formElementSubLabelContainer{display:block;width:100%;margin-left:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-extralabel>.msportalfx-form-extralabel{display:inline-block;width:47.75%;margin:43px 1% -49.75%!important}.msportalfx-form.msportalfx-form-custom .msportalfx-form-extralabel{margin-top:0}.fxs-bladestyle-create .msportalfx-form{margin-top:14px}.fxs-bladestyle-create .msportalfx-form .msportalfx-form{margin-top:0}.msportalfx-form:not(.msportalfx-form-custom)>div>.msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom) .fxc-section>.msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>.msportalfx-form-formelement{padding-bottom:15px;width:100%;min-height:23px}.msportalfx-form:not(.msportalfx-form-custom)>div>.msportalfx-form-formelement .msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom) .fxc-section>.msportalfx-form-formelement .msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>.msportalfx-form-formelement .msportalfx-form-formelement{padding-bottom:0}.msportalfx-form.msportalfx-vertical-compact>div>.msportalfx-form-formelement,.msportalfx-form.msportalfx-vertical-compact .fxc-section>.msportalfx-form-formelement,.msportalfx-form.msportalfx-vertical-compact>.msportalfx-form-formelement{padding-bottom:7px}.msportalfx-form .msportalfx-form-labelcontainer,.msportalfx-form .azc-form-labelcontainer,.msportalfx-form .azc-checkBoxField-inlineLabelContainer{box-sizing:border-box;min-height:17px}.msportalfx-form .msportalfx-form-labelcontainer label,.msportalfx-form .azc-form-labelcontainer label,.msportalfx-form .azc-checkBoxField-inlineLabelContainer label{max-width:calc(100% - 25px)}.msportalfx-form .azc-checkBoxField-inlineLabelContainer{width:calc(100% - 25px + 2px)}.msportalfx-form .azc-checkBoxField-inlineLabelContainer label{font-size:13px;line-height:normal}.msportalfx-form .azc-validatableControl-invalid+.azc-checkBoxField-inlineLabelContainer{width:calc(100% - 25px + 2px - 6px)}.msportalfx-form .msportalfx-form-labelcontainer label,.msportalfx-form .azc-form-labelcontainer label{font-size:13px;line-height:normal}.msportalfx-form.msportalfx-form-row{padding:0 20px;width:calc(100% - 40px)}.msportalfx-form .azc-multiLineTextField .azc-multiLineTextBox{height:100%}.azc-text-sublabel{float:right;margin-bottom:-1px}.fxc-has-sublabel-html>.azc-formElementSubLabelContainer>.azc-text-sublabel{float:none}.azc-formElementSubLabelContainer::after{content:"";display:table;clear:both}.msportalfx-form:not(.fxc-left-label-fixed) .fxc-left-label .azc-text-sublabel-neighbor{padding-bottom:16px}.msportalfx-form:not(.fxc-left-label-fixed) .fxc-left-label .azc-text-sublabel-neighbor.azc-form-labelcontainer{padding-bottom:calc(16px + 3px)}.msportalfx-form:not(.fxc-left-label-fixed) .fxc-left-label .azc-text-sublabel-neighbor.azc-checkBoxField-inlineLabelContainer{padding-bottom:0}.azc-required-balloon{display:inline-block}.msportalfx-form-extralabel{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:right;margin-top:-15px;padding-bottom:3px}.msportalfx-customHtml .msportalfx-form-extralabel{margin-top:0}.msportalfx-customHtml>.azc-formElementSubLabelContainer{height:100%}.msportalfx-customHtml>.azc-formElementSubLabelContainer>.azc-formElementContainer{height:100%}.msportalfx-form-formelement .azc-dockedballoon.azc-dockedballoon-info{height:15px;width:15px}.msportalfx-nested-control:not(.fxc-left-label){padding-left:45px;position:relative;box-sizing:border-box}.msportalfx-nested-control:not(.fxc-left-label)::before{display:block;content:"";border-left:1px solid #a9a9a9;border-bottom:1px solid #a9a9a9;position:absolute;top:-9px;left:3px;height:calc(50% + 7px);width:32px}.msportalfx-nested-control.fxc-left-label>.azc-form-labelcontainer{padding-left:45px;position:relative;box-sizing:border-box}.msportalfx-nested-control.fxc-left-label>.azc-form-labelcontainer::before{display:block;content:"";border-left:1px solid #a9a9a9;border-bottom:1px solid #a9a9a9;position:absolute;top:-13px;left:3px;height:22px;width:32px}.msportalfx-form-regular div.msportalfx-nested-control::before,.msportalfx-form-regular .msportalfx-nested-control::before{display:block;content:"";border-left:1px solid #a9a9a9;border-bottom:1px solid #a9a9a9;position:absolute;top:-13px;left:3px;height:22px;width:32px}.msportalfx-nested-control:not(.fxc-left-label)::before{display:block;content:"";border-left:1px solid #a9a9a9;border-bottom:1px solid #a9a9a9;position:absolute;top:-9px;left:3px;height:40px;width:32px}.fxc-left-label-fixed.fxc-smart-labels .msportalfx-nested-control .azc-form-labelcontainer{max-width:205px!important}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/CssLibrary/CustomPart.css",["module"],(function(e){"use strict";return{css:'.msportalfx-layoutChildren-horizontal-inlineblock{white-space:nowrap;line-height:0;font-size:0}.msportalfx-layoutChildren-horizontal-inlineblock>.msportalfx-layoutChildren-child{display:inline-block;box-sizing:border-box;white-space:normal;font-size:13px;line-height:normal}.msportalfx-layoutChildren-horizontal-float>.msportalfx-layoutChildren-child{float:left;box-sizing:border-box}.msportalfx-layoutChildren-horizontal-float::after{content:"";clear:both;display:block;visibility:hidden;height:0;font-size:0;line-height:0}.msportalfx-bgcolor-themeMain{background-color:#00bcf2}.msportalfx-bgcolor-themeWarning{background-color:#db7500}.msportalfx-bgcolor-themeError{background-color:#e81123}.msportalfx-bgcolor-themeSuccess{background-color:#7fba00}.msportalfx-bgcolor-paletteDiffAdd{background-color:#c7f1c7}.msportalfx-bgcolor-paletteDiffDel{background-color:#fcd6f1}.msportalfx-bgcolor-white{background-color:#fff}.msportalfx-padding{padding:20px;box-sizing:border-box}.msportalfx-docking{display:flex;flex-direction:column;width:100%;height:100%}.msportalfx-docking-header{flex:0 0 auto}.msportalfx-docking-body{flex:1 1 auto;height:100%;min-height:0;overflow-x:hidden;overflow-y:auto}.msportalfx-docking-footer{flex:0 0 auto;border-top:1px solid}.msportalfx-vertical-center{display:flex;flex-flow:row nowrap;align-items:center}.msportalfx-removeTableBorders{border-spacing:0;border-collapse:collapse}.msportalfx-boxsizing-borderbox{box-sizing:border-box}.msportalfx-removeDefaultListStyle{list-style-type:none;padding:0;margin:0}.msportalfx-removeDefaultListStyle>li{margin:0;padding:0}.msportalfx-fill{height:100%;width:100%}.msportalfx-clearfix::after{content:"";clear:both;display:block;visibility:hidden;height:0;font-size:0;line-height:0}.fxs-tilesize-fittocontainer .msportalfx-overflowY,.azc-graph-node-container .msportalfx-overflowY{overflow-x:hidden;overflow-y:auto}.msportalfx-unselectable{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.msportalfx-removepartpadding{height:calc(100% + 15px + 15px);width:calc(100% + 15px + 15px);margin:-15px -15px -15px -15px}.msportalfx-removepartpaddingside{width:calc(100% + 15px + 15px);margin:0 -15px 0 -15px}.fxs-blade-locked .msportalfx-removepartpadding{height:calc(100% + 15px);width:100%;margin:0 0 15px}.fxs-blade-locked .msportalfx-removepartpaddingside{width:100%;margin:0}.fxs-blade-locked .fxs-tilesize-fittocontainer .msportalfx-removepartpadding{height:100%;width:100%;margin:0}.msportalfx-partdivider::after{content:"";display:block;width:calc(100% + 15px + 15px);margin:0 -15px 0 -15px;border-bottom-width:1px;border-bottom-style:solid}.msportalfx-code{font-family:Consolas,"Courier New",monospace;font-size:13px;line-height:normal;background-color:#f1f1f8;color:#32383f;border:1px solid #dcdfe2;border-left:5px solid #dcdfe2;padding:10px 10px 10px 15px;margin:5px 0;overflow-x:auto}.msportalfx-gettingstarted-part{color:#fff}.msportalfx-refresh-icon img,.msportalfx-refresh-icon svg{height:12px;width:12px;vertical-align:baseline}.msportalfx-tile-status-icon img,.msportalfx-tile-status-icon svg{height:16px;width:16px;vertical-align:middle}.msportalfx-gridcolumn-asseticon img,.msportalfx-gridcolumn-asseticon svg{margin-top:4px;height:21px;width:21px}.msportalfx-gridcolumn-assetsvg-icon .fx-grid-formatters-svgicon{width:21px!important;height:21px!important}.msportalfx-gridcolumn-assetsvg-icon img,.msportalfx-gridcolumn-assetsvg-icon svg{height:21px;width:21px;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-badge{margin-left:-21px;height:21px;width:21px;vertical-align:middle;display:inline-block}.msportalfx-gridcolumn-assetsvg-badge img,.msportalfx-gridcolumn-assetsvg-badge svg{height:10px;width:10px;margin-top:11px}.msportalfx-gridcolumn-assetsvg-text{margin-left:10px;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-textbox{vertical-align:middle;display:inline-block;margin-left:20px}.msportalfx-gridcolumn-assetsvg-strongtext{vertical-align:middle;margin-left:0}.msportalfx-gridcolumn-assetsvg-linkicon{margin-left:10px;display:inline-block;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon{display:inline-block}.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon img,.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon svg{opacity:.4;height:10px;width:10px;vertical-align:middle}.msportalfx-iconcontainer{flex:0 0 auto;box-sizing:border-box}.msportalfx-iconcontainer>img,.msportalfx-iconcontainer>svg{height:50px;width:50px}.fxs-tilesize-mini .msportalfx-iconcontainer>img,.fxs-tilesize-small .msportalfx-iconcontainer>img,.fxs-tilesize-mini .msportalfx-iconcontainer>svg,.fxs-tilesize-small .msportalfx-iconcontainer>svg{height:30px;width:30px}.msportalfx-gridcolumn-statusicon{text-align:center}.msportalfx-gridcolumn-statusicon img,.msportalfx-gridcolumn-statusicon svg{text-align:center;height:15px;width:15px}.msportalfx-gridcolumn-statusicon svg{margin-top:4px}.msportalfx-grid-borderless .azc-grid table tbody tr td{border-top-width:0;border-bottom-width:0;border-color:transparent}.msportalfx-grid-borderless .azc-grid table tbody tr.azc-grid-row:first-of-type td{border-top-width:0;border-bottom-width:0;border-color:transparent}.msportalfx-grid-borderless .azc-grid table tbody:last-child tr:last-child td{border-top-width:0;border-bottom-width:0;border-color:transparent}.msportalfx-grid-borderless .azc-br-muted:not(.fxc-gc-resizing-handleLine,.fxc-grid-resizing-line){border-top-width:0;border-bottom-width:0;border-color:transparent!important}.msportalfx-create-tab{max-width:700px}.msportalfx-create-tab .msportalfx-create-description{font-size:13px;line-height:normal}.msportalfx-create-tab .fxc-section{margin-bottom:15px}.msportalfx-create-section-label{font-weight:600;font-size:14px;line-height:normal}.msportalfx-create-footer .fxc-simplebutton{margin-right:12px}.msportalfx-create-footer a{margin-left:12px}.msportalfx-ext-link{padding-right:15px}.msportalfx-ext-link::after{content:" ";background-color:currentColor;-webkit-mask-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%2016%2015%22%3E%3Cpath%20d=%22M14.3%201H10V0h6v6h-1V1.7l-8%208-.7-.7z%22/%3E%3Cpath%20d=%22M11%208v5a.9.9%200%2001-1%201H2a.9.9%200%2001-1-1V6a.9.9%200%20011-1h6l1-1H2a2%202%200%2000-2%202v7a2%202%200%20002%202h8a2%202%200%20002-2V7z%22/%3E%3C/svg%3E");-webkit-mask-position:center;-webkit-mask-repeat:no-repeat;mask-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%2016%2015%22%3E%3Cpath%20d=%22M14.3%201H10V0h6v6h-1V1.7l-8%208-.7-.7z%22/%3E%3Cpath%20d=%22M11%208v5a.9.9%200%2001-1%201H2a.9.9%200%2001-1-1V6a.9.9%200%20011-1h6l1-1H2a2%202%200%2000-2%202v7a2%202%200%20002%202h8a2%202%200%20002-2V7z%22/%3E%3C/svg%3E");mask-position:center;mask-repeat:no-repeat;width:11px;height:11px;display:inline-block;margin-left:4px;margin-right:-15px;background-size:11px 11px}.fxs-mode-dark .msportalfx-ext-link::after{background-image:url("data:image/svg+xml;utf8,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%2016%2015%22%3E%3Cpath%20fill=%22%23ffffff%22%20d=%22M14.3%201H10V0h6v6h-1V1.7l-8%208-.7-.7z%22/%3E%3Cpath%20fill=%22%23ffffff%22%20d=%22M11%208v5a.9.9%200%2001-1%201H2a.9.9%200%2001-1-1V6a.9.9%200%20011-1h6l1-1H2a2%202%200%2000-2%202v7a2%202%200%20002%202h8a2%202%200%20002-2V7z%22/%3E%3C/svg%3E")}.msportalfx-inherit-color{color:inherit!important}.msportalfx-statuspart{position:relative;height:100%;width:100%}.msportalfx-statuspart>*{box-sizing:border-box}.msportalfx-statuspart .msportalfx-statuspart-statussection{height:calc(100% - 55px);padding-top:10px}.msportalfx-statuspart .msportalfx-statuspart-statussection>*{vertical-align:middle}.msportalfx-statuspart .msportalfx-statuspart-statussection>img{height:30px;width:30px}.msportalfx-statuspart .msportalfx-statuspart-statussection>span{font-weight:700;font-size:11px;text-transform:uppercase;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-statuspart .msportalfx-statuspart-messagesection{position:absolute;bottom:55px;margin-bottom:25px;height:40px;line-height:0;white-space:normal}.msportalfx-statuspart .msportalfx-statuspart-messagesection>span{font-size:13px;line-height:normal}.msportalfx-statuspart .msportalfx-statuspart-propertysection,.msportalfx-statuspart .msportalfx-statuspart-metricsection{position:absolute;bottom:0;width:100%;height:55px}.msportalfx-statuspart .msportalfx-statuspart-propertysection{padding-top:5px;font-size:13px;line-height:normal}.msportalfx-statuspart .msportalfx-statuspart-propertysection>span,.msportalfx-statuspart .msportalfx-statuspart-propertysection>div{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div{float:left;width:calc(100%/3 - 3px);box-sizing:border-box;border-right:1px solid #8f9ca8;padding-left:7px}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div:first-child{padding-left:0}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div:last-child{border-right:0}.msportalfx-statuspart .msportalfx-statuspart-metricsection .msportalfx-statuspart-metrictitle{white-space:normal;height:30px;font-size:13px;line-height:normal;text-transform:uppercase}.msportalfx-property-text-icon,.msportalfx-property-callback-icon{width:27px}.msportalfx-property-text-icon svg,.msportalfx-property-callback-icon svg{height:25px;width:25px}.msportalfx-property{padding:5px 0;white-space:nowrap;line-height:0;font-size:0}.msportalfx-property>*{display:inline-block;vertical-align:middle;box-sizing:border-box;white-space:normal;font-size:medium;line-height:normal}.msportalfx-property .msportalfx-property-name{font-size:13px;line-height:normal;width:32%;white-space:normal;overflow:hidden;text-overflow:ellipsis}.msportalfx-property .msportalfx-property-label-wrapper{font-size:13px;line-height:normal;width:32%;margin-top:5px}.msportalfx-property .msportalfx-property-label-wrapper .msportalfx-property-name{max-width:100%;width:auto;white-space:normal;overflow:hidden;text-overflow:ellipsis;display:inline-block}.msportalfx-property .msportalfx-property-value{font-size:14px;line-height:normal;width:64%;margin-left:3%;margin-top:4px}.msportalfx-property .msportalfx-property-value.fxs-part-properties-text .msportalfx-tooltip-overflow,.msportalfx-property .msportalfx-property-value.fxs-part-properties-text .msportalfx-property-text-icon{display:inline-block;vertical-align:middle}.msportalfx-property .msportalfx-property-value.fxs-part-properties-text .msportalfx-property-text-icon+.msportalfx-tooltip-overflow{max-width:calc(100% - 27px)}.msportalfx-property .msportalfx-property-value.fxs-part-properties-copyfield{margin-top:4px}.msportalfx-property .msportalfx-property-value.fxs-part-properties-copyfield input{padding-left:9px}.msportalfx-property.msportalfx-property-compact>*{vertical-align:top}.msportalfx-property.msportalfx-property-compact .msportalfx-property-name{margin-top:4px;width:95px}.msportalfx-property.msportalfx-property-compact .msportalfx-property-value{font-size:13px;line-height:normal;max-width:calc(100% - 3% - 95px)}.msportalfx-property-callback-icon{float:left}.msportalfx-preview-text{font-weight:600;font-size:10px;line-height:normal;text-transform:uppercase;margin-top:3px}.fxs-service-tag{fill:solid;border-radius:2px;padding:.3px 6px;margin-right:4px}.fxs-service-disabled-tag{fill:solid;border-radius:2px;padding:.3px 6px;margin-right:4px;border:1px #a19f9d;background-color:#f3f2f1;color:#a19f9d}.fxs-service-partner-tag{fill:solid;border-radius:2px;padding:.3px 6px;margin-right:4px;color:#db7500;border:1px solid #ebb988;background-color:#fff8f0}.fxs-service-preview-tag{fill:solid;border-radius:2px;padding:.3px 6px;margin-right:4px;color:#8a2da5;border:1px solid #d6adeb;background-color:#f9f3fc}',moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Parts/Parts.Part.css",["module"],(function(e){"use strict";return{css:'.fxs-part{width:100%;height:100%;position:relative;box-sizing:border-box;overflow:hidden;background-color:inherit;padding:15px 15px 15px 15px}.fxs-part-blockui-shield{position:absolute;top:0;left:0;bottom:0;right:0}.fxs-part-title{height:49px;position:relative;top:-4px;box-sizing:border-box}.fxs-part-titleText,.fxs-part-assetname{margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-part-titleText{font-weight:600;font-size:14px;line-height:17px;padding-bottom:1px}.fxs-part-assetname{font-size:10px;line-height:10px;padding-bottom:1px;margin-top:3px}.fxs-part-content{font-size:13px;line-height:normal;position:relative;width:100%;height:100%;box-sizing:border-box}.fxs-part-part-title-visible .fxs-part-content{height:calc(100% - 45px);top:-4px}.fxs-part[tabindex="0"]:focus-visible,.fxs-part-clickable:focus-visible{outline-offset:2px;outline-width:1px;outline-style:solid}.fxs-part[tabindex="0"]:hover,.fxs-part-clickable:hover{cursor:pointer}.fxs-part-unbound{z-index:1}.fxs-part{padding:15px 15px 15px 15px}.fxs-part.fxs-part-no-fx-content-padding{padding:0}.fxs-part.fxs-part-no-fx-content-padding.fxs-part-part-title-visible .fxs-part-title{padding:15px 15px 0 15px}.fxs-part.fxs-part-no-fx-content-padding.fxs-part-part-title-visible .fxs-part-content>.msportalfx-padding:first-child{padding:0 15px 15px 15px}.fxs-part.fxs-part-no-fx-content-padding .fxs-part-content>.msportalfx-padding{padding:15px 15px 15px 15px}.fxs-part.fxs-part-no-fx-content-padding.fxs-part-for-template-blade .fxs-part-content>.msportalfx-padding{padding:10px 20px 20px 20px}.fxs-part-nodata{filter:grayscale(100%);min-height:85px}.fxs-part-nodatamessage{position:absolute;left:0;top:0;height:100%!important;width:100%;text-align:left;padding:15px;box-sizing:border-box;z-index:1}.fxs-part-nodatamessage-text{position:absolute;top:50%;transform:translateY(-50%);margin-top:20px;padding:15px 10px;width:calc(100% - 30px);box-sizing:border-box;font-size:13px;line-height:normal;text-align:center;border-width:1px;border-style:solid}.fxs-tile.fxs-tilesize-mini .fxs-part{padding-left:3px;padding-right:3px}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-title{display:none!important}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-content{height:100%!important;top:0!important}.fxs-blade .fxs-blade-locked .fxs-part{padding:0 0 15px}.fxs-blade .fxs-blade-locked .fxs-part .fxs-part-title{height:29px;top:0}.fxs-blade .fxs-blade-locked .fxs-tilesize-fittocontainer .fxs-part{padding:0}.fxs-part-filter-button{border:0;padding:0;width:26px;height:26px;cursor:pointer;z-index:2}.fxs-part-filter-button,.fxs-part-filter-button>svg{position:absolute;top:0;left:0}.fxs-part-frame.fxs-tile-floated-frame{top:11px;height:calc(100% - 11px);left:0}.fxs-part-part-title-visible .fxs-part-frame.fxs-tile-floated-frame{top:49px;height:calc(100% - 49px)}',moduleId:e.id}})),
define("_generated/MsPortalImpl/Svg/Startup/DashboardPartFilter.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=1,t.data="<svg viewBox='0 0 26 26' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path fill='#8a8886' d='M26 0H0v26L26 0z'/><path d='M2 2v1.547l4 3.787V12h3V7.334l4-3.787V2zm1 1.253V3h9v.253L8 7v4H7V7z' class='msportalfx-svg-c01'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Startup/DashboardPartFilterConflict.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=1,t.data="<svg viewBox='0 0 26 26' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path fill='#8a8886' d='M26 0H0v26L26 0z'/><path d='M4 2v1.547l4 3.786V12h3V7.333l4-3.787V2z' class='msportalfx-svg-c33'/><path d='M7 8 3 4.035V2H2v2.421l4 3.965V12h1V8z' class='msportalfx-svg-c01'/><path d='M4 2v1.547l4 3.786V12h3V7.333l4-3.787V2zm1 1.253V3h9v.253L10 7v4H9V7z' class='msportalfx-svg-c01'/></g></svg>"})),
define("MsPortalImpl/Parts/Parts",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Base/Base.CssSanitizer","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.PartError","MsPortalImpl/Base/Base.Selectable2.ClickContext","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/Commands/UI.ExtensionCommands","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/Base/Base.KeyboardHelper","FxInternal/Composition/ViewModel","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Weave/SandboxRender","FxInternal/Composition/Part","Fx/Composition","FxInternal","_generated/MsPortalImpl/Svg/Startup/DashboardPartFilter.svg","_generated/MsPortalImpl/Svg/Startup/DashboardPartFilterConflict.svg","MsPortalImpl/UI/Commands/Base.PortalFunctions","FxInternal/Css","_generated/Less/MsPortalImpl/Parts/Parts.Part.css","_generated/Less/MsPortalImpl/CssLibrary/AzureCompatibleOfficeLayoutGrid.css","_generated/Less/MsPortalImpl/CssLibrary/AzureSemanticText.css","_generated/Less/MsPortalImpl/CssLibrary/AzureUtil.css","_generated/Less/MsPortalImpl/CssLibrary/AzureDeprecatedSemanticText.css","_generated/Less/MsPortalImpl/CssLibrary/AzureDeprecatedChartingColor.css","_generated/Less/MsPortalImpl/CssLibrary/CustomPart.css","_generated/Less/MsPortalImpl/CssLibrary/CustomForm.css"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x,b,y,v,w,M,C,S,I,P,_,F,T,k,E,D,A,B,N){"use strict";t.PartImpl=t.PartBase=t.InternalClickableLink=void 0,t.createAmdPartFactory=me,t.createPartFactory=ge,t.getFactory=le,t.getPartFactory=function(e,t,s){const i=s.partKind;let o;if(i===q.Custom||i===q._Internal_App){const n=s.htmlTemplateInline,r=s.htmlTemplate&&t.getExtensionLocator().withHtmlTemplate(s.htmlTemplate),a=n||r&&e.locate(r);o=ge(a&&a.content,{supportedSizes:s.supportedSizes,partClass:i===q._Internal_App?he:null})}else o=i===q.Frame?me("MsPortalImpl/Parts/Parts.Frame",ue,{supportedSizes:s.supportedSizes}):i===q._Internal_React?me("MsPortalImpl/Parts/Parts.ReactFrame",((e,t,i,o,n)=>{const{bladeOrPartName:r,extensionName:a,isMenuBlade:l}=s;return new e.Part(t,i,o,n,{viewName:r,extensionName:a,isMenuBlade:l})}),{supportedSizes:s.supportedSizes}):le(q[i]);const n=o.supportedSizes;n&&n.length||(o.supportedSizes=[ce(s)]);return o},t.getPartSizeOrDefault=ce,t.registerFactory=function(e,t){if(ee[e])throw new Error(`The part kind '${e}' has already been registered and cannot be registered again.`);ee[e]=t};var R=s;(0,_.injectCss)(F,T,k,E,D,A,B,N);var L=FxImpl.TriggerableLifetimeManager,z=MsPortalFx.Base,H=z.Diagnostics,O=z.Images,U=H.Telemetry,W=MsPortalFx.Parts,V=W.PartSize,q=W.PartKind,j=W.PartState;const G=window,K=r.Dashboard.PartFilters,J=FxImpl.features.isNativePerf;let X=0;const Z=H.createLog(e),Y=r.Parts.partSettingNotReceivedErrorDescription,ee={},te=R.tsx(s.Root,null,R.tsx(s.KoIf,{condition:"context.isFilterApplied() && !context.isUiBlocked()"},R.tsx("div",{role:"button",class:"fxs-part-filter-button",tabindex:"0","data-bind":{image:"context.filterIcon",click:"context.openPartSettingsBlade",event:{keydown:"context.onFilterButtonKeyDown"},attr:{"aria-label":"context.filterButtonAriaLabel"}}})),R.tsx("div",{class:"fxs-part-title"},R.tsx("h3",{class:"fxs-part-titleText msportalfx-tooltip-overflow","data-bind":{text:"container.partTitle"}}),R.tsx("div",{class:"fxs-part-assetname fxs-portal-subtext msportalfx-tooltip-overflow","data-bind":{visible:"container.assetName() && !context.inContainerOfSameAsset()",text:"container.assetName"}})),R.tsx("div",{class:"fxs-part-content fxs-validationContainer"}),R.tsx(s.KoIf,{condition:"context.isUiBlocked"},R.tsx("div",{class:"fxs-part-blockui-shield"}),R.tsx(s.KoTemplate,{options:"{ name: context.uiBlockedTemplate }"}))),se="emptyTemplate";c.registerKoTemplate(se," ");const ie="contentHasNoDataTemplate";c.registerKoTemplate(ie,R.tsx("div",{class:"fxs-part-nodatamessage"},R.tsx("div",{class:"fxs-part-nodatamessage-text msportalfx-tooltip-overflow fxs-bg-overlay-dark fxs-text-white","data-bind":{text:"container.noDataMessage"}})));class oe extends M.ClickableLink{}t.InternalClickableLink=oe;class ne{constructor(){this._selectable=ko.observable(),this.inContainerOfSameAsset=ko.observable(!0),this.partSettingFailed=ko.observable(!1),this.notFoundMessage=ko.observable(),this.handledErrorMessage=ko.observable(),this.lockedUiContext=ko.observable(!0)}}t.PartBase=ne;const re={1:"fxs-part-success",2:"fxs-part-warning",3:"fxs-part-error",4:"fxs-part-dirty",5:"fxs-part-info"};class ae extends ne{constructor(e,t,s,i){super(),this._diContainer=i,this.isFilterApplied=ko.observable(!1),this.filterIcon=ko.observable(),this.filterButtonAriaLabel=ko.observable(),this.partFilterState=ko.observable(0),this.openPartSettingsBlade=(e,t)=>$.noop,this.onFilterButtonKeyDown=(e,t)=>(13!==t.keyCode&&32!==t.keyCode||(this.openPartSettingsBlade(e,t),t.preventDefault()),!0),this.assetId=ko.observable(),this.ariaLabel=ko.observable(),this.onSizeChange=e=>{};const o=this._lifetime=new L;let c=t.container;this._onDashboard=1===s.partLocation;if(MsPortalFx.isFeatureEnabled(w.partHeaderEnabledFeatureName)&&this._onDashboard&&c.updatableHeader){c={},MsPortalFx.shallowCopyFromObject(c,t.container);const{updatedHeader:e}=c.updatableHeader,s=c.partTitle,i=c.assetName;c.partTitle=ko.computed(o,(()=>{const t=s(),i=e(),o=i?.title;return t&&o?o:t})),c.assetName=ko.computed(o,(()=>{const t=e(),o=t?.subtitle;return s()&&o?o:i()}))}if(!c)throw new Error("Cannot create a part without a container viewmodel.");const d=FxImpl.tryGetSelectableViewModelContract(c);let u;if(u=d&&d._msPortalFxSelectable2?l.getOrCreate(this._diContainer,d._msPortalFxSelectable2):void 0,u=u||c.selectable,!u){const s=t.content;s&&(ko.isObservable(s().onClick)?s().onClick.subscribeAndRun(this._lifetime,(t=>{"function"!=typeof t||this._selectable()||(u=p.getSelectableWithClickHandler(this._diContainer,s,$(e),t),this._selectable(u))})):"function"==typeof s().onClick&&(u=p.getSelectableWithClickHandler(this._diContainer,s,$(e),s().onClick)))}s.pinnedBladeDeeplink&&(u=u||{isClickable:()=>!0,isSelected:ko.observable(!1),value:ko.observable({}),onClick:MsPortalFx.noop},u.onClick=()=>{i.get(P.RoutePortalFunc).invoke({uri:s.pinnedBladeDeeplink,openedByContext:{openedBy:4}},this._onDashboard?"StartBoardPart":"Blade")}),this._selectable(u),this._viewModel=t,ko.cleanNode(e);const m=this._partContainer=$(e).attr("data-bind","attr: { 'role': context._computedRole, 'data-assetname': container.assetName },css: context._computedClasses,click: function (data, evt) { return context._onClick(data, evt); },event: {'keydown': function (data, evt) { return context._onKeyDown(data, evt); } }").html(te);this._accessibility(),s.noFxContentPadding&&m.addClass("fxs-part-no-fx-content-padding"),s.isVirtualPartForTemplateBlade&&m.addClass("fxs-part-for-template-blade"),this._partContent=m.find(".fxs-part-content")[0];const g=m.find(".fxs-part-title");this.validateElements=ko.observableArray([]),this._options=s;const h=e=>!!e.noDataMessage();this.isUiBlocked=ko.pureComputed((()=>this._viewModel.internal.allowUiBlocking()&&(c.operations.blockingUi()||h(c)))),this.uiBlockedTemplate=ko.pureComputed((()=>{const e=this._viewModel.container,t=!!this.notFoundMessage(),s=!!e.noDataMessage(),i=!!e.unauthorizedMessage();return t||i?se:s?ie:se}));const f=ko.pureComputed((()=>this._viewModel.internal.allowUiBlocking()&&h(c)));this._isPartClickable=ko.computed(o,(()=>!(c.operations.blockingUi()||c.partState&&c.partState()===j.Failed||this.notFoundMessage()||!MsPortalFx.isNullOrUndefined(c.unauthorizedMessage()))&&(!!c.clickableLink||c.isSelectable()&&!!this._selectable()))),c.partTitle.subscribe(o,(()=>{setTimeout((()=>{m.trigger("fxsizechanged")}),50)})),ko.computed(o,(()=>{this.lockedUiContext()?m.removeAttr("aria-label"):m.attr("aria-label",c.ariaLabel()||this.ariaLabel()||c.partTitle())}));const x=ko.computed(o,(()=>{const e=c.partTitle()&&c.partState()!==j.Failed;return a.toggle(g,e),e}));let b;this._computedClasses=ko.computed(o,(()=>{const e=[];x()&&e.push("fxs-part-part-title-visible"),this._isPartClickable()&&e.push("fxs-part-clickable"),c.noDataMessage()&&e.push("fxs-part-nodata");const t=this._selectable();t&&c.isSelectable()&&(t.isSelected()&&e.push("fxs-part-selected"),t.isCommandSelected&&t.isCommandSelected()&&e.push("fxs-part-selected-command")),this._viewModel.content()._msPortalFxUnboundPart&&e.push("fxs-part-unbound");const s=re[c.contentState()];return s&&e.push(s),e.join(" ")})),this._computedRole=ko.computed(o,(()=>{const e=[];if(m.find(".fxs-part-clickdesc, .fxs-part-tabback").remove(),this.lockedUiContext())return m.removeAttr("aria-describedby"),null;const t=MsPortalFx.getUniqueId();if(m.append(FxImpl.createElement("div",{class:"fxs-part-tabback",id:t,style:"display:none;"},MsPortalFx.encodeHtml(r.Parts.tabbackcmds))),e.push(t),this._isPartClickable()){const t=MsPortalFx.getUniqueId();m.append(FxImpl.createElement("div",{class:"fxs-part-clickdesc",id:t,style:"display:none;"},MsPortalFx.encodeHtml(r.Parts.clickableAriaDesc))),e.push(t)}return m.attr("aria-describedby",e.join(" ")),"group"})),ko.applyBindings({container:c,context:this},m[0]),f.subscribeAndRun(o,(e=>{if(e){if(!b){b=o.createChildLifetime();const e=this._partContainer;b.registerForDispose([e.setEvents(["focus",this._onFocus=e=>{this._toggleDisableTabbableElements(f())}],["focusin",this._onFocusIn=t=>{f()&&e[0].focus()}]),()=>{this._onFocus=this._onFocusIn=null}])}m.find(document.activeElement).length>0&&m[0].focus()}else b&&b.dispose(),this._toggleDisableTabbableElements(e)})),ko.reactor(o,(()=>{this.lockedUiContext()||!this._isPartClickable()&&!this._onDashboard?m.removeAttr("tabindex"):m.attr("tabindex",0)}));FxImpl.shellInterface(c).triggerValidation(((e,t)=>n.ensureFormFieldValidation(m,!0,t).then((t=>(e&&n.focusOnFirstInvalidField(this._partContainer),t))))),1===c.location&&this.partFilterState.subscribeAndRun(o,(e=>{const t=4===e||3===e,s=2===e||1===e;this.isFilterApplied(t||s);const i=t?I:S;this.filterButtonAriaLabel(t?K.Conflicted.ariaLabel:K.Applied.ariaLabel);let o="";switch(e){case 1:o=K.Applied.dashboardTimeRange;break;case 0:case 2:o=K.Applied.dashboardFilters;break;case 3:o=K.Conflicted.timeRange;break;case 4:o=K.Conflicted.multiple}this.filterIcon(O.CustomImageWithOptions(i,{title:o}))}))}setupContent(e){const t=Q.defer(),s=x.isV2(this._viewModel.content()),i=ko.observable(s);if(s){this._viewModel.content()._msPortalFx_contentRevealedPromise.then((()=>i(!1)),(()=>t.resolve()))}const o=[this.partSettingFailed,this._viewModel.content,i,this._viewModel.container.partState,this.handledErrorMessage];return o.push(this.notFoundMessage),o.push(this._viewModel.container.unauthorizedMessage),ko.explicitComputed(this._lifetime,o,(()=>{if(this.partSettingFailed())Z.error(Y),ko.ignoreDependencies((()=>{this._bindErrorTemplate({message:r.PartError.titleSettings}),t.resolve()}));else{const s=this._viewModel.container.partState(),o=s!==j.Failed,n=MsPortalFx.isNullOrUndefined(this.handledErrorMessage()),r=MsPortalFx.isNullOrUndefined(this.notFoundMessage()),a=MsPortalFx.isNullOrUndefined(this._viewModel.container.unauthorizedMessage()),l=o&&n&&r&&a;if(i()&&l)return;ko.ignoreDependencies((()=>{this._bindContentTemplate(s,this.template,e),c.waitForBindings(this._partContent).then((()=>{this._setupFormValidationReactor(),t.resolve()})).catch((e=>t.reject(e)))}))}})).extend({deferred:!0}),t.promise}_setupFormValidationReactor(){const e=this._viewModel.container;1!==e.location&&this._onContentReady(0,(()=>{ko.computed(this._lifetime,(()=>{const t=this.validateElements(),s=n.gatherFormFieldsFromElements(t,null,!0),i=s.map((e=>{const t=e.viewmodel,s=e.field.validatableViewModel;if(!(t&&t.disabled&&ko.unwrap(t.disabled)||t.visible&&!ko.unwrap(t.visible)))return s&&(s.alwaysHasValidatorEquivalent||s.validators().length)?s.validationState():2})),o=s.some((e=>ko.unwrap(e.viewmodel&&e.viewmodel.dirty)));ko.ignoreDependencies((()=>{e.form.dirty(o);const t=e.form.validationState;i.includes(1)?t(1):i.includes(0)?t(0):i.includes(3)?t(3):t(2)}))})).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}})}))}_findFocusTarget(e,t){const s=$(e).find(t);let i=s.filter(":focusable").first();if(i.length<1&&(i=s.findFirstTabbable(),i.length<1)){const e=s.find(":focusable"),t=e.not("div");if(i=t.length?t.first():e.first(),i.length<1)return null}return i}setFocus(e){const t=this._partContainer.closest(".fxs-blade"),s=t.length>0?t[0]:this._partContainer[0];return Q(c.waitForBindings(s)).then((()=>{let t=this._findFocusTarget(s,e);return t?(t.focus(),{success:!0}):(t=this._findFocusTarget(document.body,e),t?(t.focus(),{success:!0}):{success:!1,errorMsg:"No focusable element found for '{0}' anywhere on the page.".format(e)})}))}_onContentReady(e,t){(this.partComposition?Q(MsPortalFx.Base.Promises.cancelOnDispose(this._lifetime,Q(this.partComposition.await(e)).catch(MsPortalFx.noop))):Q()).then((()=>t(this._partContainer[0])))}_logClick(e){const t=this._diContainer.get(b.JourneyManager).activeJourney(),s=this.partComposition;U.trace({extension:this._options.locator.getExtensionLocator().name,source:this._onDashboard?"StartBoardPart":"Blade",action:"PartClick",name:this._options.locator.toFriendlyString(),data:s?{...e,partKind:s.partDefinition?.partKind}:e,journeyId:t&&t.id})}_onClick(e,t){return this._activatePart(e,t)}_onKeyDown(e,t){return t.target!==this._partContainer[0]||13!==t.keyCode||this._activatePart(e,t)}_activatePart(t,s){if(1===this._diContainer.get(m.DesktopManagerMode).value.peek()&&!this._viewModel.content()._msPortalFxUnboundPart)return!0;const i=this._viewModel.container,n=$(s.target);let r=!0;const a=G.getSelection(),l=a.rangeCount>0&&a.getRangeAt(0),c=i.clickableLink;if(!this._isPartClickable()||n.closest("a").length>0);else if(a.isCollapsed||!l||l.commonAncestorContainer.ownerSVGElement||"svg"===l.commonAncestorContainer.nodeName)if(c)if(c instanceof oe&&$.isFunction(c.onClick))c.onClick();else{let t=c.target();const i=(0,o.sanitizeLinkUri)(String(c.uri()||""),{diContainer:this._diContainer,windowContext:n,localRequire:e})||"",r=i.startsWith("#");let a=!1;"auto"===t&&(t=r?"_self":"_blank"),"_self"===t&&((0,f.isCtrlOrCommandOnly)(s)||s.shiftKey?t="_blank":r&&(this._diContainer.get(P.RoutePortalFunc).invoke({uri:i,openedByContext:{openedBy:4}},this._onDashboard?"StartBoardPart":"Blade"),a=!0)),a||window.open(i,t),this._logClick({effectiveTarget:t,target:c.target(),scrubbedUri:i.split("?")[0]})}else if(s.shiftKey||(0,f.isCtrlOrCommandOnly)(s)||2===s.which)n.trigger("fxopeninnewtab",{selectable:i.selectable});else{const e=this._selectable();e&&(e.isSelected()?n.trigger("fxensurebladevisible",{}):(e.onClick(),this._logClick())),r=!1}else;return r}_accessibility(){const e=this._partContainer.find(".fxs-part-title");for(let t=0;t<e.length;t++){const s=MsPortalFx.getUniqueId(),i=$(e[t]);i.find(".fxs-part-titleText").attr("aria-describedby",s),i.find(".fxs-part-assetname").attr("id",s)}}_bindContent(e,t,s){const o=this._getExtensionName(),n=this._options.locator.name,r=[i.getScopeName(o)];this.scopeClass;const a=new Set,l=$(this._partContent);s&&s.styleSheets&&pe.injectStyles(o,s.styleSheets,this._options.locator,a,r),this.scopeClass=r.join(" "),l.addClass(this.scopeClass),this.onSizeChange=e=>{a.forEach((t=>{const{mediaQuery:s,mediaClass:i}=t;"MINWIDTH"===s.type&&(e>=s.pixels?l.addClass(i):l.removeClass(i))}))};const c=this._diContainer.get(y.ViewModelManager).getWeaveShellPort(this._viewModel),d=X++;if(J&&G.performance.mark(`PartStart${d}`),c&&c.isChannelEnabled)(0,v.connectWeaveShellPort)(c,e,this._diContainer,(e=>{const t=[];for(const s of e)s.moduleId.startsWith("FxInternal/_generated/Less/")?(0,_.injectCss)(s):t.push({content:s.css,file:s.moduleId});pe.injectStyles(o,t,this._options.locator,a,r),this.scopeClass=r.join(" "),l.addClass(this.scopeClass),this.onSizeChange(this._viewModel.container.width.peek())}));else{$(e).html(t);const s=new ko.bindingContext(this._getContentForBinding(this._lifetime)).extend({$dicontainer:this._diContainer,$partName:n,$extensionName:o});ko.applyBindings(s,e),this._nodeToCleanup=e}J&&(G.performance.mark(`PartEnd${d}`),G.performance.measure(`PartRender(${c&&c.isChannelEnabled?"Weave":"KO"})`,`PartStart${d}`,`PartEnd${d}`))}dispose(){this._lifetime.dispose();const e=this._nodeToCleanup;e&&ko.cleanNode(e);const t=this._partContainer[0];t&&(ko.cleanNode(t),this._partContainer[0]=this._partContent=null),MsPortalFx.disposeViewModelProperties(this._viewModel)}_getContentForBinding(e){return this._viewModel.content}_getExtensionName(){return this._options.locator.getExtensionLocator().name}_bindContentTemplate(e,t,s){const i=this._viewModel.container;if(this.notFoundMessage())this._bindErrorTemplate(this.notFoundMessage(),404);else if(i.unauthorizedMessage())this._bindErrorTemplate(i.unauthorizedMessage(),401);else if(e===j.Ready)if(MsPortalFx.isNullOrUndefined(this.handledErrorMessage()))try{i.contentState(0),this._resetContentTemplateContainer(),this._bindContent(this._partContent,t,s)}catch(e){this._options.traceErrorTelemetry(e.message||"Failed to bind the knockout template",e),this._bindErrorTemplate({message:r.PartError.titleContent,details:MsPortalFx.getLogFriendlyMessage(e)})}else this._bindErrorTemplate(this.handledErrorMessage());else if(e===j.Failed){const e="string"==typeof i.failureMessage()?{message:i.failureMessage()}:i.failureMessage(),t="string"==typeof e.message?e.message:e.message&&e.message.htmlTemplate;this._options.traceErrorTelemetry(t,e.error),this._bindErrorTemplate(e)}}_bindErrorTemplate(e,t){let s;s="string"==typeof e?{message:e}:e,this._viewModel.container.contentState(3),this._resetContentTemplateContainer();const i=new d.ViewModel(s,{sessionId:MsPortalFx.sessionId,extName:this._getExtensionName(),contentName:this._options.locator.name,resourceId:this.assetId(),code:t},{showDetailsCmd:this._onDashboard}),o=this.partComposition;if(o){const e=new g.CompositionInstanceCommandContext($(this._partContent)[0],null,o),t=new h.ReloadPart(this._lifetime,this._diContainer,o);if(t.bind(e),i.commands.push(t),this._onDashboard){const t=new h.UnpinFromStartboard(this._lifetime,this._diContainer);t.bind(e),i.commands.push(t)}const s=new h.GoToAssetBlade(this._lifetime,this._diContainer,this.partComposition);s.bind(e),s.enabled()&&i.commands.push(s)}new d.Widget($(this._partContent),i,this._diContainer)}_resetContentTemplateContainer(){ko.cleanNode(this._partContent),$(this._partContent).html("")}_toggleDisableTabbableElements(e){let t,s,i,o;const n="tabindex",r="data-initialtabindex";if(e)for(t=this._partContainer.find(":tabbable"),o=0;o<t.length;++o)s=$(t[o]),i=s.attr(n),s.attr(n,"-1"),s.attr(r,i||"unset");else for(t=this._partContainer.find("["+r+"]"),o=0;o<t.length;++o)s=$(t[o]),i=s.attr(r),"unset"!==i?s.attr(n,i):s.removeAttr(n),s.removeAttr(r)}}function le(e){return ee[e]}function ce(e){const t=e&&e.initialSize;return void 0!==W.PartSize[t]?t:V.Normal}t.PartImpl=ae;class de{constructor(e){this._extensionName=e,this._metadata=new Map}injectStyles(e,t,s,o){const n=[],r=[];for(const a of e)if(a.content){const e=a.file,l=i.getScopeName(e);let c=this._metadata.get(e);if(!c){const s=[],o=[];this._metadata.set(e,c={file:e,mediaQueries:s,sanitizedCss:i.sanitizeStyleSheetText(a.content,`.${i.getScopeName(this._extensionName)}.${l}`,o,s)}),o.forEach((s=>{n.push(`\n${t} - ${e} - ${i.generateErrorMessage(s)}`)})),r.push(c)}o.push(l);for(const e of c.mediaQueries)s.add(e)}n.length&&FxImpl.Rpc.client.log(this._extensionName,{level:this._extensionName?2:1,code:1,area:"Parts",message:`Sanitization error found in following extension(${this._extensionName}) styleSheets:`+n});for(const e of r)(0,_.injectCss)({moduleId:this._extensionName+"_"+e.file,css:e.sanitizedCss})}}const pe=new class{constructor(){this._cache={}}injectStyles(e,t,s,i,o){(this._cache[e]||(this._cache[e]=new de(e))).injectStyles(t,s,i,o)}};function ue(e,t,s,i,o){return new e.Part(t,s,i,o)}function me(e,t,s){return{createPart:(s,i,o,n,r)=>Q(C.tryImmediateResolve(MsPortalFx.require(e),(e=>{const a=t(e,s,i,o,n);return a.partComposition=r,a}))),defaultSize:s.defaultSize,supportedSizes:s.supportedSizes,viewStateProperties:s.viewStateProperties,moduleId:e}}function ge(e,t={}){return{createPart:(s,i,o,n,r)=>{const a=new(t.partClass||ae)(s,i,o,n);return a.template=e,a.partComposition=r,Q(a)},defaultSize:t.defaultSize,supportedSizes:t.supportedSizes,viewStateProperties:t.viewStateProperties}}class he extends ae{constructor(e,t,s,i){super(e,t,s,i)}_bindContent(e,t,s){super._bindContent(e,t,s),c.waitForBindings(e).then((()=>{const e=fx.getTimestamp();MsPortalFx.require("MsPortalImpl/Parts/Parts.Frame.Common").then((t=>{t.logFrameAddedTelemetry({isPart:this._onDashboard,journeyManager:this._diContainer.get(b.JourneyManager),locator:this._options.locator,telemetryContextState:this._options.getTelemetryContextState&&this._options.getTelemetryContextState(),timestamp:e})}))}))}}})),
define("_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css",["module"],(function(e){"use strict";return{css:".fxs-part-buttonpart{display:flex;width:100%;height:100%;box-sizing:border-box;text-align:center;align-items:center;flex-direction:column}.fxs-part-buttonpart-iconcontainer{flex:0 0 auto;box-sizing:border-box;display:flex;align-items:center}.fxs-part-buttonpart-iconcontainer>img,.fxs-part-buttonpart-iconcontainer>svg{flex:0 0 auto;height:50px;width:50px}.fxs-part-buttonpart-textcontainer{width:100%;font-size:13px;line-height:normal}.fxs-part-buttonpart-assetname{margin:0;font-size:10px;line-height:10px;padding-bottom:1px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-part-buttonpart-desc{display:none;position:relative;margin-top:10px}.fxs-part-buttonpart-desc:empty{margin-top:0}.fxs-part-buttonpart-titlecontainer{display:flex;flex-flow:row nowrap;align-items:flex-start;justify-content:center}.fxs-part-buttonpart-title{position:relative;margin:0;font-size:14px;font-weight:600;display:block;display:-webkit-box;line-height:18px;max-height:36px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:2;-webkit-box-orient:vertical}.fxs-part-buttonpart-title.fxs-should-use-single-line{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>svg,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>svg{height:30px;width:30px}.fxs-tilesize-small .fxs-part-buttonpart,.fxs-tilesize-wide .fxs-part-buttonpart{text-align:left;flex-direction:row}.fxs-tilesize-small .fxs-part-buttonpart-titlecontainer,.fxs-tilesize-wide .fxs-part-buttonpart-titlecontainer{justify-content:flex-start}.fxs-tilesize-small .fxs-part-buttonpart-textcontainer,.fxs-tilesize-wide .fxs-part-buttonpart-textcontainer{flex:0 1 auto;display:flex;flex-direction:column;justify-content:center}.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer{padding-top:3px}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer{width:51px;padding-left:6px}.fxs-tilesize-normal .fxs-part-buttonpart-titlecontainer{margin:13px 0 5px}.fxs-tilesize-normal .fxs-part-buttonpart-iconcontainer{padding-top:28px}.fxs-tilesize-normal .fxs-part-part-title-visible .fxs-part-buttonpart-iconcontainer{padding-top:0}.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer{width:85px;padding-left:15px}.fxs-tilesize-wide .fxs-part-buttonpart-title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-tilesize-wide .fxs-part-buttonpart-assetname{padding-top:2px}.fxs-tilesize-wide .fxs-part-buttonpart-desc{display:block;display:-webkit-box;line-height:18px;max-height:90px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:5;-webkit-box-orient:vertical}.fxs-part-buttonpart-externallink{height:12px;width:12px;margin-left:3px;margin-top:2px}.fxs-part-buttonpart-externallink>img,.fxs-part-buttonpart-externallink>svg{height:12px;width:12px}",moduleId:e.id}})),
define("MsPortalImpl/Parts/Parts.ButtonPart",["require","exports","MsPortalImpl/Parts/Parts","FxInternal/Composition/ViewModel","FxInternal/Css","_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css"],(function(e,t,s,i,o,n){"use strict";t.template=t.ButtonPart=void 0,(0,o.injectCss)(n);var r=MsPortalFx.Parts.PartSize;const a=t.template="<div class='fxs-part-buttonpart'><div class='fxs-part-buttonpart-iconcontainer' data-bind='image: icon, attr: { title: _displayTitle }'></div><div class='fxs-part-buttonpart-textcontainer'><div class='fxs-part-buttonpart-titlecontainer'><h3 class='fxs-part-buttonpart-title msportalfx-tooltip-overflow' data-bind='text: _displayTitle, css: { \"fxs-should-use-single-line\": _assetNameVisible }, attr: { \"aria-describedby\": _assetName() && _id }'></h3>\x3c!-- ko if: _isExternalLink --\x3e<div class='fxs-part-buttonpart-externallink azc-fill-heavy' data-bind='image: _linkSvg, attr: { \"aria-label\": _linkUri }'></div>\x3c!-- /ko --\x3e</div><div data-bind='text: _assetName, visible: _assetNameVisible, attr: { id: _id }' class='fxs-part-buttonpart-assetname msportalfx-tooltip-overflow'></div><div data-bind='text: description' class='fxs-part-buttonpart-desc msportalfx-tooltip-overflow'></div></div></div>";class l extends s.PartImpl{constructor(){super(...arguments),this.template=a}_getContentForBinding(e){const t=this._viewModel,s=t.content,o=t.container,n=o.clickableLink,a=e=>"_self"===e.target()||e.uri?.()?.startsWith("#")&&"auto"===e.target(),l=ko.observable(!!n&&!a(n));ko.computed(e,(()=>{this.ariaLabel(s().title())}));const c=n&&n.target;c&&c.subscribe(e,(e=>{l(!a(n))}));const d=n&&n.uri;d&&d.subscribe(e,(e=>{l(!a(n))}));const p=i.isV2(s())?()=>this._options.size():()=>s().size&&s().size();return ko.computed(e,(()=>MsPortalFx.extend2(super._getContentForBinding(e)(),{_displayTitle:ko.computed(e,(()=>{const e=p(),t=s(),i=t.title();return(e===r.Mini||e===r.Small)&&t.shortTitle()||i})),_assetName:o.assetName,_isExternalLink:l,_linkUri:d,_linkSvg:MsPortalFx.Base.Images.Hyperlink(),_assetNameVisible:ko.computed(e,(()=>!this.inContainerOfSameAsset()&&o.assetName())),_id:MsPortalFx.getUniqueId()})))}}t.ButtonPart=l})),
define("_generated/Less/MsPortalImpl/Parts/Parts.Collection.css",["module"],(function(e){"use strict";return{css:'.fxs-part-collectionpart .azc-grid table thead tr th{height:28px;line-height:28px;border-top-width:1px;border-top-style:solid}.fxs-part-collectionpart .azc-grid table thead tr th>a{line-height:normal}.fxs-part-collectionpart .azc-grid table thead tr th:first-child a{padding-left:15px}.fxs-part-collectionpart .azc-grid table tbody tr td{height:27px}.fxs-part-collectionpart .azc-grid table td.azc-grid-cell:first-of-type{padding-left:15px}.fxs-part-collectionpart .azc-grid table td:last-of-type,.fxs-part-collectionpart .azc-grid table td:last-child{padding-right:15px}.fxs-part-collectionpart .azc-grid table .azc-grid-resizableColumn-handle{height:28px}.fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:none}.fxs-part-collectionpart.fxs-part-collectionpart-rollup-forceshow .fxs-part-collectionpart-rollup-container{display:block}.fxs-part-collectionpart-more-data{font-weight:600;font-size:12px;line-height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;position:absolute;right:0}.fxs-part-collectionpart-more-data:hover{text-decoration:underline}.fxs-part-collectionpart-rollup-container{margin:-6px 0 6px}.fxs-part-collectionpart-rollup-count{font-weight:600;font-size:30px;line-height:30px;letter-spacing:-.025em}.fxs-part-collectionpart-rollup-label{font-weight:700;font-size:15px;line-height:15px;letter-spacing:-.02em;margin-left:4px}.fxs-part-collectionpart-part-title{font-size:10px;line-height:10px;padding-bottom:1px;margin:5px 0 0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:none}.fxs-part-collectionpart-rollup-icon{width:21px;height:21px;margin-left:4px;display:inline-block}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:block;margin:0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label{display:none}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count{line-height:25px}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count{width:30px;height:30px;margin-left:0}.fxs-tilesize-mini .fxs-part-collectionpart{text-align:center;padding:5px 6px 0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-part-title{display:block}.fxs-tilesize-small .fxs-part-collectionpart{float:right;margin-top:-15px}html[lang^="ja"] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^="ko"] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^="zh"] .fxs-part-collectionpart .fxs-part-collectionpart-part-title{font-size:11px;line-height:11px}',moduleId:e.id}})),
define("MsPortalImpl/Parts/Parts.Collection",["require","exports","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Parts/Parts","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Css","_generated/Less/MsPortalImpl/Parts/Parts.Collection.css"],(function(e,t,s,i,o,n,r){"use strict";t.CollectionPart=void 0,(0,n.injectCss)(r);var a=MsPortalFx.Parts.PartSize;const l=o.Parts,c=`<div class="fxs-part-collectionpart" data-bind="css: {'fxs-part-collectionpart-rollup-forceshow': alwaysShowRollupCount()}"><div class="fxs-part-collectionpart-rollup-container"><span class="fxs-part-collectionpart-rollup-count" data-bind="text: rollupCount, visible: !noRollupCount()"></span><span class="fxs-part-collectionpart-rollup-label" data-bind="text: rollupCountLabel"></span><img class="fxs-part-collectionpart-rollup-icon" data-bind="attr: { src: rollupCountIconUri }, visible: rollupCountIconUri, css: {'fxs-part-collectionpart-no-rollup-count': noRollupCount }" alt=""/><div class="fxs-part-collectionpart-rollup-icon" data-bind="image: rollupCountIcon, visible: rollupCountIcon, css: {'fxs-part-collectionpart-no-rollup-count': noRollupCount }"></div><h4 class="fxs-part-collectionpart-part-title fxs-display-none" data-bind="text: _partTitle"></h4></div>\x3c!-- ko if: emptyGrid() && noRowsHtml() --\x3e<div class="fxs-part-collectionpart-norowshtml fxs-display-none" data-bind="pcControl: noRowsHtml"></div>\x3c!-- /ko --\x3e\x3c!-- ko if: !emptyGrid() || !noRowsHtml() --\x3e\x3c!-- ko if: !!gridMode() --\x3e<div data-bind="pcGrid: grid" class="msportalfx-removepartpaddingside"></div><a href="#" class="fxs-part-collectionpart-more-data fxs-portal-text-primary" tabindex="0" data-bind="visible: hasMoreData">${MsPortalFx.encodeHtml(l.more)}</a>\x3c!-- /ko --\x3e\x3c!-- /ko --\x3e</div>`;class d extends i.PartImpl{constructor(e,t,s,i){super(e,t,s,i),this.template=c;(this._container=$(e)).on("click keydown","a.fxs-part-collectionpart-more-data",(e=>{13!==e.which&&"click"!==e.type||e.preventDefault(),e.stopPropagation();const t=$.Event(e.type);t.keyCode=e.keyCode,$(e.delegateTarget).trigger(t)}))}_getContentForBinding(e){const t=this._viewModel,i=this._container.find(".fxs-part-collectionpart-part-title"),o=this._container.find(".fxs-part-collectionpart-norowshtml");return ko.computed(e,(()=>{const e=t.content().size();s.toggle(i,e!==a.Mini||!!t.container.partTitle()),s.toggle(o,e!==a.Mini&&e!==a.Small)})),ko.observable(MsPortalFx.extend2(t.content(),{_partTitle:t.container.partTitle}))}}t.CollectionPart=d})),
define("_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css",["module"],(function(e){"use strict";return{css:".msportalfx-pricingTier .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.msportalfx-pricingTier .msportalfx-pricingTier-normal-iconContainer,.msportalfx-pricingTier .msportalfx-pricingTier-wide-iconContainer{height:55px;border-bottom:1px solid #dcdfe2}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:10px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-specCode{float:left;margin-right:8px;max-width:100px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-promotedFeatures{line-height:12px;padding-top:4px}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon{width:30px;height:30px;margin-top:1.7em}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon.msportalfx-pricingTier-icon-small{margin-top:-.15em}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:10px}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:30px;height:30px;margin-right:15px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:18px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:20px;height:20px;margin-right:5px}.fxs-tilesize-small .msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:-12px}.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specTitle,.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specCode{text-align:center;float:initial}",moduleId:e.id}})),
define("_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css",["module"],(function(e){"use strict";return{css:'.msportalfx-specpicker{width:175px;height:320px;position:relative;border-color:inherit}.msportalfx-specpicker::after{right:10px;left:auto;transform:skew(8deg) rotate(3deg)}.msportalfx-specpicker .msportalfx-specpicker-table{table-layout:auto}.msportalfx-specpicker ul{list-style-type:none;padding:0}.msportalfx-specpicker .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.fxs-mode-dark .msportalfx-specpicker{box-shadow:0 1px 4px rgba(255,255,255,.3),0 0 40px rgba(255,255,255,.1) inset}.fxs-mode-dark .msportalfx-specpicker::before,.fxs-mode-dark .msportalfx-specpicker::after{box-shadow:0 0 20px rgba(255,255,255,.8)}.fxs-mode-light .msportalfx-specpicker{box-shadow:0 1px 4px rgba(0,0,0,.3),0 0 40px rgba(0,0,0,.1) inset}.fxs-mode-light .msportalfx-specpicker::before,.fxs-mode-light .msportalfx-specpicker::after{box-shadow:0 0 20px rgba(0,0,0,.8)}.msportalfx-specpicker-star{width:14px;height:14px;fill:#ffb900;stroke:#000;stroke-width:1px;float:right;margin-right:4px;margin-top:1px}.msportalfx-specpicker-header{color:#fff;font-size:14px;height:26px;line-height:26px}.msportalfx-specpicker-header .msportalfx-specpicker-header-specCode{font-weight:600;text-transform:uppercase;padding-left:11px}.msportalfx-specpicker-header .msportalfx-specpicker-header-title{padding-left:6px}.msportalfx-specpicker-header-text{fill:#ffb900;stroke:#000;stroke-width:1px;width:161px;position:absolute}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade1{background-color:#4668c5}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade2{background-color:rgba(70,104,197,.2)}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade3{background-color:rgba(70,104,197,.1)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade1{background-color:#8a2da5}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade2{background-color:rgba(138,45,165,.2)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade3{background-color:rgba(138,45,165,.1)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade1{background-color:#578000}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade2{background-color:rgba(87,128,0,.2)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade3{background-color:rgba(87,128,0,.1)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade1{background-color:#c40}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade2{background-color:rgba(204,68,0,.2)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade3{background-color:rgba(204,68,0,.1)}.msportalfx-specpicker-table{table-layout:auto;width:100%;border-collapse:collapse}.msportalfx-specpicker-table .msportalfx-specpicker-feature-name{font-weight:600;font-size:13px;line-height:1.385;margin-left:6px}.msportalfx-specpicker-table .msportalfx-specpicker-feature-value{font-weight:600;font-size:17px}.msportalfx-specpicker-row td{white-space:nowrap;padding:0}.msportalfx-specpicker-row td .msportalfx-specpicker-cell{height:30px;line-height:30px}.msportalfx-specpicker-row td.msportalfx-specpicker-right{overflow:hidden;text-overflow:ellipsis;max-width:1px;width:100%}.msportalfx-specpicker-row.msportalfx-specpicker-promotedFeatures td{padding-bottom:1px}.msportalfx-specpicker-row.msportalfx-specpicker-borderBottom td{border-bottom:1px solid #e9e9f3}.msportalfx-specpicker-row .msportalfx-specpicker-left{text-align:center;min-width:39px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-value{font-size:13px;line-height:1.385;padding-top:6px;margin-left:6px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-name{font-size:10px;line-height:normal;margin-top:-3px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-mutipleline .msportalfx-specpicker-feature-value{padding-top:1px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{min-width:29px;text-align:center}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell img{width:22px;height:22px;margin-top:8px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell div{width:20px;height:20px;padding-top:5px;padding-left:0;display:inline-block}.msportalfx-specpicker-footer-container{position:absolute;bottom:0;left:0;right:0;height:46px;text-align:right}.msportalfx-specpicker-footer{margin-right:10px;margin-bottom:8px;background-color:inherit}.msportalfx-specpicker-footer-value{margin-top:6px;text-transform:uppercase;line-height:22px!important;font-weight:600;font-size:22px;line-height:22px;letter-spacing:-.025em}.msportalfx-specpicker-footer-details{font-size:10px;line-height:14px;text-transform:uppercase}.msportalfx-specpicker-footer-statusMessage,.msportalfx-specpicker-footer-channelMessage{margin-left:5px;margin-right:5px;font-size:11px;text-align:left}.msportalfx-specpicker-footer-statusMessage{margin-top:25px}.msportalfx-specpicker-footer-channelMessage{margin-top:10px;position:absolute;background-color:inherit;white-space:normal;display:block;display:-webkit-box;line-height:16px;max-height:32px;overflow:hidden;text-overflow:ellipsis;-webkit-line-clamp:2;-webkit-box-orient:vertical}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker{background-color:rgba(189,189,189,.05)}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-header{background-color:#bdbdbd}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.2)}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-right .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.1)}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-footer-container{background-color:#dedede}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-feature-value,.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-feature-name,.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-footer-value{color:#bdbdbd}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-disable-blockui-shield{position:absolute;top:0;left:0;bottom:0;right:0}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-disable-message-anchor{position:absolute;text-align:center;left:15px;right:15px;top:40%}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container{display:inline-block;background-color:rgba(50,56,63,.8);margin-top:20px;padding:15px 10px;width:100%;box-sizing:border-box}.azc-listView-item[aria-disabled="true"] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container .msportalfx-specpicker-disable-message{display:inline;color:#fff}.ext-hubs-specPickerGrid-container{height:100%;overflow:hidden;display:flex;flex-direction:column}.ext-hubs-specPicker-container{width:100%;min-height:100%}.ext-hubs-specPicker-container .ext-hubs-specPicker-filtersContainer.ext-hubs-specPicker-filtersContainer{margin-top:0;padding-top:5px}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptionsContainer{height:25px;padding-top:5px;padding-right:15px}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions{font-size:14px;float:right}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .msportalfx-specpicker-recommendationsIcon{width:14px;height:14px;display:inline-block}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-selected{cursor:default;background-color:inherit}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-clickable{color:#0058ad;fill:#0058ad}.ext-hubs-specPicker-container .ext-hubs-specPicker-content{height:100%}.ext-hubs-specPicker-container .ext-hubs-specPicker-message{margin-top:0;border-left:6px solid #ffb900;padding:15px;white-space:pre-wrap}.ext-hubs-specPicker-container .ext-hubs-specPicker-listView{margin-left:19px}.ext-hubs-specPicker-container .fxc-hotspot{outline:0;padding:5px}.ext-hubs-specPicker-container .fxc-hotspot:focus-visible{outline-style:dotted;outline-width:1px}',moduleId:e.id}})),
define("MsPortalImpl/Parts/Parts.Intrinsics",["require","exports","MsPortalImpl/Parts/Parts","FxInternal/Css","_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css","_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css"],(function(e,t,s,i,o,n){"use strict";t.parts=void 0,(0,i.injectCss)(o,n);var r=MsPortalFx.Parts.PartKind,a=MsPortalFx.Parts.PartSize;const l=a.Mini,c=a.Small,d=a.Normal,p=a.Wide,u=a.Large,m=a.Tall,g=a.HeroWide,h=a.HeroTall,f=a.HeroWideFitHeight,x=a.FullWidthFitHeight,b=a.FitToContainer,y={defaultSize:x,supportedSizes:[x],viewStateProperties:["content.selection.selectedItems","content.selection.activatedItems"]},v=14,w=18,M=30;(t.parts=[{kind:r.Asset,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.Asset",((e,t,s,i,o)=>new e.AssetPart(t,s,i,o)),{defaultSize:c,supportedSizes:[l,c,d]})},{kind:r.Button,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.ButtonPart",((e,t,s,i,o)=>new e.ButtonPart(t,s,i,o)),{supportedSizes:[l,c,d,p]})},{kind:r.Collection,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.Collection",((e,t,s,i,o)=>new e.CollectionPart(t,s,i,o)),{supportedSizes:[l,c,d,p,m,u,g,h,f,b,x]})},{kind:r.CollectionSummary,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.CollectionSummary",((e,t,s,i,o)=>new e.Part(t,s,i,o)),{supportedSizes:[l,c,d,p]})},{kind:v,factory:s.createPartFactory("<div data-bind='{0}: $root'></div>".format("pcGrid"),{viewStateProperties:["content.selectableData.selectedItems","content.selectableData.activatedItems","content.selectableData.itemsWithChildEdits"]})},{kind:r.InfoList,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.InfoList",((e,t,s,i,o)=>new e.InfoListPart(t,s,i,o)),y)},{kind:r.Properties,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.Properties",((e,t,s,i,o)=>new e.PropertiesPart(t,s,i,o)),y)},{kind:r.QuickStart,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuickStart",((e,t,s,i,o)=>new e.QuickStartPart(t,s,i,o)),{defaultSize:c,supportedSizes:[l,c,d,p]})},{kind:M,factory:s.createAmdPartFactory("MsPortalImpl/Parts/Parts.ResourceSummary",((e,t,s,i,o)=>new e.ResourceSummaryPart(t,s,i,o)),y)},{kind:w,factory:s.createPartFactory("<div></div>")}]).forEach((e=>{s.registerFactory(r[e.kind],e.factory)}))})),
define("MsPortalImpl/Services/Personalization",["require","exports","FxInternal/Rpc"],(function(e,t,s){"use strict";t.getPersonalizationDataEndpoint=void 0;t.getPersonalizationDataEndpoint=new s.FuncEndPointDefinition("getPersonalizationData")})),
define("MsPortalImpl/UI/UI.DockedContextPane",["require","exports","Fx/Composition/Selectable","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/UI.BladeOpener","FxInternal/AsyncLoader","FxInternal/Rpc"],(function(e,t,s,i,o,n,r){"use strict";t.openDockedContextPaneEndpoint=t.openDockedContextPane=void 0,t.openDockedContextPaneWithBlade=l;const a=t.openDockedContextPaneEndpoint=new r.FuncEndPointDefinition("Fx.RpcEndpoints.openDockedContextPane");async function l(e,t){const n=i.Locator.forExtension(t.extensionName).withBlade(t.bladeName),r=t.params,a=new s.PdlBladeReference(n.name,n.getExtensionName(),{parameters:r});await e.get(o.BladeOpener).openBlade(a,{flags:1032,telemetryName:"DockedContextPane"})}t.openDockedContextPane=n.defineHandler(a,(e=>{l(e.diContainer,{extensionName:e.messageArg.extensionName,bladeName:e.messageArg.bladeName,params:e.messageArg.params})}))})),
define("MsPortalImpl/RpcEndPoints",["require","exports","FxInternal/AsyncLoader","FxHubs/HubsSettingsSchema","FxHubs/RpcEndPoints","FxInternal/DirectoryManagement","FxInternal/RpcEndPoints","MsPortalImpl/Services/Personalization","FxHubs/ProvisioningRpc","FxInternal/Redirect","FxInternal/ResourceManagement/Subscriptions","FxInternal/ResourceManagement/GlobalResourceFilters","FxInternal/Dashboard/DashboardEndpoints","ShellWorker/AuthorizationState","MsPortalImpl/UI/UI.DockedContextPane","FxInternal/RpcEndPointsCore","FxInternal/ReactView/DataCacheEndpoints"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f){"use strict";t.registerRpc=function(e){const t=MsPortalFx.getEnvironmentValue("copilot")?.extension;(0,s.registerRpc)(e,{"FxHubs/MarketplaceRpc":{marketplaceOverrideHandler:(0,s.makeRegistration)(o.Provisioning.marketplaceOverrideEndpoint)},"MsPortalImpl/Base/Base.Selectable2.Provisioning":{getProvisioningContextHandler:(0,s.makeRegistration)(l.provisioningContextEndpoint)},"MsPortalImpl/Extension/ExtensionRpc.Manifest":{getManifestHandler:(0,s.makeRegistration)(b.getManifestEndPoint),getManifestEnvironmentHandler:(0,s.makeRegistration)(b.CreateUiDef.getExtensionConfigurationEndPoint,["Microsoft_Azure_CreateUIDef","HubsExtension"])},"MsPortalImpl/Extension/ExtensionManagerOptions":{registerTestExtensions:(0,s.makeRegistration)(b.CreateUiDef.registerTestExtensionsEndPoint,"Microsoft_Azure_CreateUIDef"),unregisterTestExtensions:(0,s.makeRegistration)(b.CreateUiDef.unregisterTestExtensionsEndPoint,"Microsoft_Azure_CreateUIDef"),listTestExtensions:(0,s.makeRegistration)(b.CreateUiDef.listTestExtensionsEndPoint,"Microsoft_Azure_CreateUIDef"),getCatalogApiCacheContent:(0,s.makeRegistration)(b.getCatalogApiCacheContentEndPoint),getExtensionRegistration:(0,s.makeRegistration)(b.getExtensionRegistrationEndPoint),postBoot:(0,s.makeRegistration)(FxImpl.Extension.postBootEndPoint)},"MsPortalImpl/UI/Hubs/UI.ResourceMapManager":{mapAssetIdToResourceId:(0,s.makeRegistration)(b.mapAssetIdToResourceIdEndPoint),mapResourceIdToAssetId:(0,s.makeRegistration)(b.mapResourceIdToAssetIdEndPoint),mapResourceIdToDynamicSelectionAndIcon:(0,s.makeRegistration)(b.mapResourceIdToDynamicSelectionAndIconEndPoint),getResourceAssetInformation:(0,s.makeRegistration)(b.getResourceAssetInformationEndPoint),getResourceAssetInformationForHubs:(0,s.makeRegistration)(o.AssetTypes.getResourceAssetInformationEndPoint),getResource:(0,s.makeRegistration)(b.getResourceEndPoint)},"MsPortalImpl/UI/UI.JourneyManager":{getLastResourceIdInJourney:(0,s.makeRegistration)(b.getLastResourceIdInJourneyEndPoint,null)},"MsPortalImpl/UI/UI.ConfirmationDialog":{invokeAmeConfirmationDialogHandler:(0,s.makeRegistration)(b.invokeAmeConfirmationDialogEndPoint,null)},"MsPortalImpl/Services/Services.FavoritesSettings":{getUserDirectorySettingsHandler:(0,s.makeRegistration)(n.getUserDirectorySettingsEndPoint,"Microsoft_AAD_IAM"),saveUserDirectorySettingsHandler:(0,s.makeRegistration)(n.saveUserDirectorySettingsEndPoint,"Microsoft_AAD_IAM")},"MsPortalImpl/Services/Services.SessionManager":{getSessionHistoryHandler:(0,s.makeRegistration)(o.SessionManager.getSessionHistoryEndPoint)},"MsPortalImpl/Services/Services.Subscriptions":{getInSessionSelectedSubscriptionsObservableHandler:(0,s.makeProxyRegistration)(d.getInSessionSelectedSubscriptionsObservableEndPoint),getSubscriptionInfoHandler:(0,s.makeRegistration)(FxImpl.Azure.getSubscriptionInfoEndPoint),getInSessionDisplayedSubscriptionsHandler:(0,s.makeRegistration)(o.Subscriptions.getInSessionDisplayedSubscriptionsEndPoint),searchForSubscriptionsHandler:(0,s.makeRegistration)(FxImpl.Azure.searchForSubscriptionsEndPoint),setInSessionSelectedSubscriptionsHandler:(0,s.makeRegistration)(FxImpl.Azure.setInSessionSelectedSubscriptionsEndPoint,"HubsExtension")},"MsPortalImpl/Services/Services.GlobalResourceFilters":{getGlobalResourceFilterObservableHandler:(0,s.makeProxyRegistration)(p.getGlobalResourceFilterObservableEndPoint)},"MsPortalImpl/Services/Services.Tenants":{getHomeTenantsCountHandler:(0,s.makeRegistration)(o.Directories.getHomeTenantsCountEndPoint)},"MsPortalImpl/Services/Services.ProjectedDirectories":{getSubscriptionsForSelectedDirectoriesHandler:(0,s.makeRegistration)(o.Directories.getSubscriptionsForSelectedDirectoriesEndPoint),getDirectoriesMapHandler:(0,s.makeRegistration)(o.Directories.getDirectoriesMapEndPoint)},"MsPortalImpl/Services/Services.AssetManagement":{notifyAssetDeletedHandler:(0,s.makeRegistration)(o.Events.notifyAssetDeletedDefinition)},"MsPortalImpl/Services/Services.AzureStorage":{sasEndPointHandler:(0,s.makeRegistration)(FxImpl.InternalAzure.getSasUriForQueueEndPoint,"Microsoft_Azure_Scheduler")},"MsPortalImpl/Services/Services.MenusManager":{getBrowseMenuHandler:(0,s.makeRegistration)(o.Menus.getBrowseMenuEndpoint,["fx","HubsExtension"]),getMenuHandler:(0,s.makeRegistration)(o.Menus.getMenuEndpoint,["fx","HubsExtension"])},"MsPortalImpl/Services/Services.PortalServicesManager":{getPortalServiceHandler:(0,s.makeRegistration)(o.PortalServices.getPortalServiceEndpoint,["fx","HubsExtension"])},"MsPortalImpl/Services/Services.EditScopeManagement":{loadSerializedEditScope:(0,s.makeRegistration)(x.loadSerializedEditScopeEndPoint),saveSerializedEditScope:(0,s.makeRegistration)(x.saveSerializedEditScopeEndPoint),updateEditScopeIsSavingState:(0,s.makeRegistration)(x.updateEditScopeIsSavingStateEndPoint)},"MsPortalImpl/UI/UI.AuthStateManager":{getCurrentUserEndPointHandler:(0,s.makeRegistration)(o.Auth.getCurrentUserEndPoint,"HubsExtension")},"MsPortalImpl/Auth/RpcHandlers":{getAuthorizationTokenEndPoint:(0,s.makeRegistration)(b.getAuthorizationTokenEndPoint),getAuthorizationTokenForChallengeEndPoint:(0,s.makeRegistration)(b.getAuthorizationTokenForChallengeEndPoint),getAuthorizationTokenForCloudshellEndPoint:(0,s.makeRegistration)(b.getAuthorizationTokenForCloudshellEndPoint,"Microsoft_Azure_CloudNative"),getPopTokenEndPoint:(0,s.makeRegistration)(b.getPopTokenEndPoint),getSshCertTokenEndPoint:(0,s.makeRegistration)(b.getSshCertTokenEndPoint),getNewTokenHandler:(0,s.makeRegistration)(m.getAuthorizationTokenForShellWorkerEndPoint,"fxw")},"MsPortalImpl/Services/Services.GalleryEndpoints":{getLocalGalleryPackages:(0,s.makeRegistration)(b.getLocalGalleryPackagesEndpointsDefinition)},"MsPortalImpl/Services/Services.Permissions":{hasPermissionsToShell:(0,s.makeRegistration)(b.hasPermissionsToShell)},"MsPortalImpl/Services/Services.PersonalizationData":{getPersonalizationDataHandler:(0,s.makeRegistration)(a.getPersonalizationDataEndpoint,["HubsExtension",t,"Microsoft_Azure_Resources","InternalSamplesExtension"])},"MsPortalImpl/Services/Services.SharedSettings":{getSharedSettings:(0,s.makeRegistration)(b.getSharedSettingsEndPoint)},"MsPortalImpl/Extension/Extension.Definition.Locator":{getBladeDefinitionLocator:(0,s.makeRegistration)(o.Provisioning.getBladeDefinitionLocatorEndPoint,["HubsExtension","Microsoft_Azure_Resources"])},"MsPortalImpl/Extension/DefinitionCache":{doesBladeDefinitionExist:(0,s.makeRegistration)(o.Provisioning.doesBladeDefinitionExistEndPoint,"HubsExtension")},"MsPortalImpl/UI/UI.DesktopManagerImpl":{getDashboardDeepLinkHandler:(0,s.makeRegistration)(o.DashboardEndpoints.getDashboardDeepLink,["HubsExtension","Microsoft_Azure_Resources"]),getDashboardFiltersHandler:(0,s.makeRegistration)(o.PartFilterEndpoints.getFilters,"HubsExtension"),getFilterValuesHandler:(0,s.makeRegistration)(o.PartFilterEndpoints.getFilterValues,"HubsExtension"),getFilterValueDisplayTextHandler:(0,s.makeRegistration)(o.PartFilterEndpoints.getFilterValueDisplayText,"HubsExtension"),getFilterWarningHandler:(0,s.makeRegistration)(o.PartFilterEndpoints.getFilterWarning,"HubsExtension")},"MsPortalImpl/Services/Services.BrowseQueryManifest":{getBrowseManifestsHandler:(0,s.makeRegistration)(o.ArtBrowse.getBrowseManifestsEndpoint,"fxw")},"MsPortalImpl/Services/Services.BrowseCuration":{getResourceTypesCategorizationEndPoint:(0,s.makeRegistration)(o.Curation.getResourceTypesCategorizationEndPoint,["HubsExtension","Microsoft_Azure_Resources"])},"MsPortalImpl/Services/Services.AssetMenuManifest":{getAssetMenuPrereqsHandler:(0,s.makeRegistration)(o.AssetMenu.getAssetMenuPrereqsEndpoint,"HubsExtension"),getResourceMenuPrereqsHandler:(0,s.makeRegistration)(o.AssetMenu.getResourceMenuPrereqsEndpoint,"HubsExtension"),getDefaultUxManifest:(0,s.makeRegistration)(o.AssetMenu.getDefaultUxManifestEndPoint,["HubsExtension",t])},"MsPortalImpl/Notifications/IrisNotificationsTelemetry":{irisTelemetryHandler:(0,s.makeRegistration)(o.Impl.irisTelemetryEndpoint,"HubsExtension")},"MsPortalImpl/Notifications/IrisNotificationsClient":{getIrisContentHandler:(0,s.makeRegistration)(b.IrisNotifications.getIrisContentEndPoint,null),sendIrisSignalHandler:(0,s.makeRegistration)(b.IrisNotifications.sendIrisSignalEndPoint,null)},"MsPortalImpl/Services/Services.DeploymentManager":{pollDeploymentHandler:(0,s.makeRegistration)(o.ResourceManager.pollDeploymentEndPoint,null),getMarketplaceUserSettingsHandler:(0,s.makeRegistration)(o.Marketplace.getMarketplaceUserSettingsEndPoint,["Microsoft_Azure_Marketplace","HubsExtension"]),internalDeploymentHelperHandler:(0,s.makeRegistration)(o.ResourceManager.internalDeploymentHelper,["VMCP","Citrix_XenApp_Essentials","Citrix_XenDesktop_Essentials","CloudSimpleExtension","SendGrid_EmailService","SamplesExtension","InternalSamplesExtension"]),notifyDeploymentHandler:(0,s.makeRegistration)(o.ResourceManager.notifyDeploymentEndPoint,null),writeLastUsedUserSettingsHandler:(0,s.makeRegistration)(i.writeHubsLastUsedUserSettings,"HubsExtension")},"MsPortalImpl/Notifications/NotifyResourcesCreated":{notifyResourcesCreatedHandler:(0,s.makeRegistration)(o.NotifyResourceCreated.notifyResourcesCreatedEndpoint,["Microsoft_Azure_Billing","Microsoft_Health_Admin"])},"MsPortalImpl/Services/Services.GeneralSettings":{writeBrowsePreviewOptInFlagHandler:(0,s.makeRegistration)(i.writeBrowsePreviewOptInFlagEndpoint,"HubsExtension")},"MsPortalImpl/Services/Services.Settings":{deleteUserSettingsHandler:(0,s.makeRegistration)(i.deleteHubsUserSettings,"HubsExtension"),readUserSettingsHandler:(0,s.makeRegistration)(i.readHubsUserSettings,["HubsExtension","fx"]),writeUserSettingsHandler:(0,s.makeRegistration)(i.writeHubsUserSettings,["HubsExtension","fx"]),readBrowserStorageSettingsHandler:(0,s.makeRegistration)(o.BrowserStorageSettings.readBrowserStorageSettingsEndpoint,"HubsExtension"),writeBrowserStorageSettingsHandler:(0,s.makeRegistration)(o.BrowserStorageSettings.writeBrowserStorageSettingsEndpoint,"HubsExtension"),readExtUserSettingsHandler:(0,s.makeRegistration)(FxImpl.Azure.ResourceManager.readUserSettingsEndPoint)},"MsPortalImpl/Services/Services.ArmEvents":{createResourceDeletedEventHandler:(0,s.makeRegistration)(o.Events.createResourceDeletedEventDefinition),matchEventsHandler:(0,s.makeRegistration)(o.Events.matchEventsDefinition),removeArmEventSubscriptionHandler:(0,s.makeRegistration)(o.Events.removeArmEventSubscriptionDefinition),subscribeToArmEventHandler:(0,s.makeProxyRegistration)(o.Events.subscribeToArmEventDefinition,"HubsExtension",!1)},"MsPortalImpl/Services/Services.ArmLocations":{getLocationsAndResourceTypesForCreateHandler:(0,s.makeRegistration)(FxImpl.Azure.getLocationsAndResourceTypesForCreate,null),getLocationsHandler:(0,s.makeRegistration)(FxImpl.Azure.getLocationsEndPoint,["HubsExtension","InternalSamplesExtension"])},"MsPortalImpl/Services/PastDueSubsCheck":{raiseWarningForPastDueSubsHandler:(0,s.makeRegistration)(o.Subscriptions.pastDueSubsWarningEndpoint,"HubsExtension")},"MsPortalImpl/UI/Dashboard/DashboardManager":{createDashboardHandler:(0,s.makeRegistration)(u.PortalDashboard.createDashboard,"Microsoft_Azure_PortalDashboard"),deleteDashboardsHandler:(0,s.makeRegistration)(u.PortalDashboard.deleteDashboards,"Microsoft_Azure_PortalDashboard"),getArmDashboardJsonHandler:(0,s.makeRegistration)(u.PortalDashboard.getArmDashboardJson,"Microsoft_Azure_PortalDashboard"),getPrivateDashboardsHandler:(0,s.makeRegistration)(u.PortalDashboard.getPrivateDashboards,"Microsoft_Azure_PortalDashboard"),getRecentDashboardsHandler:(0,s.makeRegistration)(u.PortalDashboard.getRecentDashboards,"Microsoft_Azure_PortalDashboard")},"MsPortalImpl/UI/Hubs/UI.NotificationManager":{addClientNotificationHandler:(0,s.makeRegistration)(FxImpl.Hubs.Notifications.addClientNotificationEndpoint,null),addClientNotificationsHandler:(0,s.makeRegistration)(FxImpl.Hubs.Notifications.addClientNotificationsEndpoint,null),addFxNotificationHandler:(0,s.makeRegistration)(r.addFxNotificationEndpoint,null),showModalNotificationHandler:(0,s.makeRegistration)(FxImpl.Hubs.Notifications.showModalNotificationEndpoint,"HubsExtension"),updateNotificationHandler:(0,s.makeRegistration)(FxImpl.NotificationManager.updateNotificationEndPoint,null),addNotification2Handler:(0,s.makeRegistration)(FxImpl.NotificationManager.addNotification2EndPoint,null)},"MsPortalImpl/UI/UI.NavigationManager":{forceSignInHandler:(0,s.makeRegistration)(c.forceSignInEndPoint,null)},"MsPortalImpl/UI/UI.NavigationHelpers":{switchTenantHandler:(0,s.makeRegistration)(c.switchTenant,["HubsExtension"]),refreshPortalHandler:(0,s.makeRegistration)(c.refreshPortal,["HubsExtension"])},"MsPortalImpl/Services/Services.PersistentStorage":{writeSettingHandler:(0,s.makeRegistration)(h.writeSettingEndPoint),readSettingsHandler:(0,s.makeRegistration)(h.readSettingsEndPoint),removeSettingsHandler:(0,s.makeRegistration)(h.removeSettingsEndPoint),clearHandler:(0,s.makeRegistration)(h.clearEndPoint),getAllKeysHandler:(0,s.makeRegistration)(h.getAllKeysEndPoint)},"MsPortalImpl/Services/Services.ReactViewDataCache":{dataCacheAddHandler:(0,s.makeRegistration)(f.dataCacheAddEndPoint),dataCacheGetHandler:(0,s.makeRegistration)(f.dataCacheGetEndPoint),dataCacheClearHandler:(0,s.makeRegistration)(f.dataCacheClearEndPoint),dataCacheClearAllHandler:(0,s.makeRegistration)(f.dataCacheClearAllEndPoint)},"MsPortalImpl/Services/Services.CopilotInteractions":{copilotInteractionsHandler:(0,s.makeRegistration)(r.copilotInteractionsEndpoint),copilotNudgeHandler:(0,s.makeRegistration)(r.copilotNudgeEndpoint),addCopilotViewContextAdditionalDetailsHandler:(0,s.makeRegistration)(r.addCopilotViewContextAdditionalDetailsEndpoint)},"MsPortalImpl/Services/Services.AzureCopilotShellAPIs":{azureShellApisGetDirectLineTokenHandler:(0,s.makeRegistration)(r.azureShellApisGetDirectLineTokenEndpoint,["fx","Microsoft_Azure_Copilot"]),azureShellApisGetManifestCacheHandler:(0,s.makeRegistration)(r.azureShellApisGetManifestCacheEndpoint,["fx","Microsoft_Azure_Copilot"]),azureShellApisGetManifestCacheUriHandler:(0,s.makeRegistration)(r.azureShellApisGetManifestCacheUriEndpoint,["fx","Microsoft_Azure_Copilot"]),azureShellApisGetExtensionVersionHandler:(0,s.makeRegistration)(r.azureShellApisGetExtensionVersionEndpoint,["fx","Microsoft_Azure_Copilot"]),azureShellApisGetCurrentBladeInfoHandler:(0,s.makeRegistration)(r.azureShellApisGetCurrentBladeInfoEndpoint,["fx","Microsoft_Azure_Copilot"]),azureShellApisGetRecentBladeHandler:(0,s.makeRegistration)(r.azureShellApisGetRecentBladeEndpoint,["fx","Microsoft_Azure_Copilot"]),azureShellApisCollectFXContextsHandler:(0,s.makeRegistration)(r.azureShellApisCollectFXContextsEndpoint,["fx","Microsoft_Azure_Copilot"]),azureShellApisGetBladeDeepLinkHandler:(0,s.makeRegistration)(r.azureShellApisGetBladeDeepLinkEndpoint,["fx","Microsoft_Azure_Copilot"]),azureShellApisOpenBladeHandler:(0,s.makeRegistration)(r.azureShellApisOpenBladeEndpoint,["fx","Microsoft_Azure_Copilot"]),azureShellApisLogErrorToExtensionHandler:(0,s.makeRegistration)(r.azureShellApisLogErrorToExtensionEndpoint,["fx","Microsoft_Azure_Copilot"]),azureShellApisSetBladeDetailsHandler:(0,s.makeRegistration)(r.azureShellApisSetBladeDetailsEndpoint,["fx","Microsoft_Azure_Copilot"]),azureShellApisMenuButtonFocusHandler:(0,s.makeRegistration)(r.azureShellApisMenuButtonFocusEndpoint,["fx","Microsoft_Azure_Copilot"]),azureShellApisCloseCopilotPickerBladeHandler:(0,s.makeRegistration)(r.azureShellApisCloseCopilotPickerBladeEndpoint,["fx","Microsoft_Azure_Copilot"]),azureShellApisGetShellHandlerDefinitionsHandler:(0,s.makeRegistration)(r.azureShellApisGetShellHandlerDefinitionsEndpoint,["fx","Microsoft_Azure_Copilot"]),azureShellApisExecuteShellHandlerHandler:(0,s.makeRegistration)(r.azureShellApisExecuteShellHandlerEndpoint,["fx","Microsoft_Azure_Copilot"]),azureShellApisExecuteBladeHandlerHandler:(0,s.makeRegistration)(r.azureShellApisExecuteBladeHandlerEndpoint,["fx","Microsoft_Azure_Copilot"]),azureShellApisGetBladeViewModelsHandler:(0,s.makeProxyRegistration)(r.azureShellApisGetBladeViewModelsHandlerEndpoint),azureShellApisGetBrowserTabIdHandler:(0,s.makeRegistration)(r.azureShellApisGetBrowserTabIdEndpoint,["fx","Microsoft_Azure_Copilot"]),azureShellApisToggleCopilotSizeHandler:(0,s.makeRegistration)(r.azureShellApisToggleCopilotSizeEndpoint,["fx","Microsoft_Azure_Copilot"])},"MsPortalImpl/Services/Services.EntraCopilotShellAPIs":{entraShellApisGetDirectLineTokenHandler:(0,s.makeRegistration)(r.entraShellApisGetDirectLineTokenEndpoint,["fx","Microsoft_Entra_Copilot"]),entraShellApisGetManifestCacheHandler:(0,s.makeRegistration)(r.entraShellApisGetManifestCacheEndpoint,["fx","Microsoft_Entra_Copilot"]),entraShellApisGetManifestCacheUriHandler:(0,s.makeRegistration)(r.entraShellApisGetManifestCacheUriEndpoint,["fx","Microsoft_Entra_Copilot"]),entraShellApisGetExtensionVersionHandler:(0,s.makeRegistration)(r.entraShellApisGetExtensionVersionEndpoint,["fx","Microsoft_Entra_Copilot"]),entraShellApisGetCurrentBladeInfoHandler:(0,s.makeRegistration)(r.entraShellApisGetCurrentBladeInfoEndpoint,["fx","Microsoft_Entra_Copilot"]),entraShellApisGetRecentBladeHandler:(0,s.makeRegistration)(r.entraShellApisGetRecentBladeEndpoint,["fx","Microsoft_Entra_Copilot"]),entraShellApisCollectFXContextsHandler:(0,s.makeRegistration)(r.entraShellApisCollectFXContextsEndpoint,["fx","Microsoft_Entra_Copilot"]),entraShellApisGetBladeDeepLinkHandler:(0,s.makeRegistration)(r.entraShellApisGetBladeDeepLinkEndpoint,["fx","Microsoft_Entra_Copilot"]),entraShellApisOpenBladeHandler:(0,s.makeRegistration)(r.entraShellApisOpenBladeEndpoint,["fx","Microsoft_Entra_Copilot"]),entraShellApisLogErrorToExtensionHandler:(0,s.makeRegistration)(r.entraShellApisLogErrorToExtensionEndpoint,["fx","Microsoft_Entra_Copilot"]),entraShellApisSetBladeDetailsHandler:(0,s.makeRegistration)(r.entraShellApisSetBladeDetailsEndpoint,["fx","Microsoft_Entra_Copilot"]),entraShellApisMenuButtonFocusHandler:(0,s.makeRegistration)(r.entraShellApisMenuButtonFocusEndpoint,["fx","Microsoft_Entra_Copilot"]),entraShellApisClosePickerBladeHandler:(0,s.makeRegistration)(r.entraShellApisClosePickerBladeEndpoint,["fx","Microsoft_Entra_Copilot"]),entraShellApisGetShellHandlerDefinitionsHandler:(0,s.makeRegistration)(r.entraShellApisGetShellHandlerDefinitionsEndpoint,["fx","Microsoft_Entra_Copilot"]),entraShellApisExecuteShellHandlerHandler:(0,s.makeRegistration)(r.entraShellApisExecuteShellHandlerEndpoint,["fx","Microsoft_Entra_Copilot"]),entraShellApisExecuteBladeHandlerHandler:(0,s.makeRegistration)(r.entraShellApisExecuteBladeHandlerEndpoint,["fx","Microsoft_Entra_Copilot"]),entraShellApisGetBladeViewModelsHandler:(0,s.makeProxyRegistration)(r.entraShellApisGetBladeViewModelsHandlerEndpoint,"Microsoft_Entra_Copilot")},"MsPortalImpl/Services/Services.CopilotManager":{copilotRunSampleTestHandler:(0,s.makeRegistration)(r.copilotRunSampleTestEndpoint,["HubsExtension","Microsoft_Azure_Copilot"])},"MsPortalImpl/Services/Services.CopilotMetadata":{getCopilotMetadata:(0,s.makeRegistration)(r.copilotMetadataEndpoint,["fx","Microsoft_Azure_Copilot"])},"MsPortalImpl/Services/Services.CopilotReactViewChannelFactory":{getActiveReactViewsForCopilotManagerHandler:(0,s.makeRegistration)(r.getActiveReactViewsForCopilotManagerEndpoint,["fx","Microsoft_Azure_Copilot"]),getReactViewPortForCopilotManagerHandler:(0,s.makeRegistration)(r.getReactViewPortForCopilotManagerEndpoint,["fx","Microsoft_Azure_Copilot"])},"MsPortalImpl/Services/Services.EntraCopilotReactViewChannelFactory":{getActiveReactViewsForEntraManagerHandler:(0,s.makeRegistration)(r.getActiveReactViewsForEntraManagerEndpoint,["fx","Microsoft_Entra_Copilot"]),getReactViewPortForEntraManagerHandler:(0,s.makeRegistration)(r.getReactViewPortForEntraManagerEndpoint,["fx","Microsoft_Entra_Copilot"])},"MsPortalImpl/Services/Services.Copilot":{isCopilotEnabledHandler:(0,s.makeRegistration)(h.isCopilotEnabledEndpoint),getCopilotConfigurationHandler:(0,s.makeRegistration)(h.getCopilotConfigurationEndpoint)},"MsPortalImpl/Services/Services.FeedbackPolicies":{fetchFeedbackPolicySettingsHandler:(0,s.makeRegistration)(r.fetchFeedbackPolicySettingsEndpoint)},"MsPortalImpl/UI/UI.DockedContextPane":{openDockedContextPane:(0,s.makeRegistration)(g.openDockedContextPaneEndpoint,["InternalSamplesExtension","Microsoft_Azure_ContainerService","Microsoft_Azure_SolutionCenter","Microsoft_Azure_Support","Microsoft_Intune_Workflows","Microsoft_Intune_DeviceSettings","Microsoft_Intune_Devices","Microsoft_EMM_ModernWorkplace"])},"MsPortalImpl/ReactViews/AssetTypeViewModel":{getReactAssetTypeViewModel:(0,s.makeProxyRegistration)(o.AssetMenu.getReactAssetTypeViewModelEndpoint)},"MsPortalImpl/Extension/DxDefinitionCache":{getDxContentHandler:(0,s.makeRegistration)(b.CreateUiDef.getDxContentEndPoint,[MsPortalFx.Base.Constants.Shell,"Microsoft_Azure_CreateUIDef","Microsoft_Azure_PortalDashboard"])}})};var x=FxImpl.Data,b=FxImpl.Extension})),
define("MsPortalImpl/Services/Services.AssetMenuManifest",["require","exports","Fx/DependencyInjection","FxHubs/RpcEndPoints","FxInternal/AsyncLoader","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Extension/ExtensionManagerOptions","Fx/Errors"],(function(e,t,s,i,o,n,r,a,l){"use strict";t.getResourceMenuPrereqsHandler=t.getDefaultUxManifest=t.getAssetMenuPrereqsHandler=t.AssetMenuManifestProvider=void 0;const c=MsPortalFx.Base.Diagnostics.createLog(e);let d=t.AssetMenuManifestProvider=class{constructor(e,t,s,i){this._manifestCache=e,this._assetTypeService=t,this._diContainer=s,this._extensionManagerOptions=i}getResourceMenuManifests(e){return this._assetTypeService.assetTypesComplete.then((()=>{const t=Object.create(null),s=e.map((e=>{const s=this._assetTypeService.getAssetTypeByResourceType(e);return s?this.getMenuManifest(s).then((s=>{t[e]=s})):(t[e]=null,Promise.resolve(null))}));return Promise.all(s).then((e=>t))}))}getResourceMenuManifest(e){return this._assetTypeService.assetTypesComplete.then((()=>{const t=this._assetTypeService.getAssetTypeByResourceType(e);if(!t){const t=new l.FxError({message:`Asset type not found for resource type: ${e}`});return c.error(t),null}return this.getMenuManifest(t).then((e=>e))}))}getAssetMenuManifest(e,t){return this._assetTypeService.assetTypesComplete.then((()=>{const s=this._assetTypeService.getAssetType(e,t);if(!s){const s=new l.FxError({message:`Asset type not found for extension: ${e} with name: ${t}`});return c.error(s),null}return this.getMenuManifest(s).then((e=>({assetTypeManifest:s.assetTypeManifest,...e})))}))}getMenuManifest(e){const t=e?.assetTypeManifest;if(t){const s=t.variant,i=(t.name||"").toLowerCase();return this._manifestCache.getManifestAsync(e.extension,"assetTypesMenu").then((e=>{if(s){const t=i+"/variant:"+s,o=(e.assetTypesMenu||[]).filter((e=>e.name.toLowerCase()===t));if(o.length)return{assetMenuManifest:o[0],menuFromVariant:!0}}const t=i,o=(e.assetTypesMenu||[]).filter((e=>e.name.toLowerCase()===t));if(o.length)return{assetMenuManifest:o[0],menuFromVariant:!1}}))}return Promise.resolve(null)}getDefaultUxManifest(e){let t;try{t=this._extensionManagerOptions.getNormalizedMetadata("Microsoft_Azure_GeneratedExtension",!0)}catch{return Promise.resolve("")}return(0,o.get)("MsPortalImpl/Extension/DxDefinitionCache","getDefaultUXManifest").then((s=>s(this._diContainer,t,e))).then((e=>e))}};t.AssetMenuManifestProvider=d=__decorate([__metadata("fx:diagnostics",[e,"AssetMenuManifestProvider"]),s.Class(),__metadata("design:paramtypes",[n.ManifestCache,r.AssetTypeService,s.Container,a.ExtensionManagerOptions])],d);t.getResourceMenuPrereqsHandler=(0,o.defineHandler)(i.AssetMenu.getResourceMenuPrereqsEndpoint,(e=>e.diContainer.get(d).getResourceMenuManifest(e.messageArg))),t.getAssetMenuPrereqsHandler=(0,o.defineHandler)(i.AssetMenu.getAssetMenuPrereqsEndpoint,(e=>e.diContainer.get(d).getAssetMenuManifest(e.messageArg.extensionName,e.messageArg.assetName))),t.getDefaultUxManifest=(0,o.defineHandler)(i.AssetMenu.getDefaultUxManifestEndPoint,(e=>e.diContainer.get(d).getDefaultUxManifest(e.messageArg.manifestName)))})),
define("MsPortalImpl/Services/Services.AssetTypes.Rpc",["require","exports","FxHubs/RpcEndPointsCore","FxInternal/Assets/AssetTypes","FxInternal/ResourceManagement/BrowseBladeCore","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.AssetMenuManifest"],(function(e,t,s,i,o,n,r){"use strict";t.setupAssetTypeServiceRpc=function(e){const t=e.get(FxImpl.Rpc.Client),l=e.get(n.AssetTypeService);e.get(r.AssetMenuManifestProvider);!function(e,t){i.getAllAssetTypesEndPoint.register(e,null,(i=>{if(i?.includeBrowseManifest||i?.includeVariants){return(i?.includeVariants?(0,n.assetTypesWithVariantsMemo)(t):(0,n.assetTypesMemo)(t)).then((t=>{const o=[];t?.forEach((e=>e.resourceType&&o.push(e.lowerCaseResourceType)));return(i?.includeBrowseManifest?s.Browse.getBrowseManifestsForResourceTypesEndpoint.invoke(e,"fxw",o):Promise.resolve({})).then((e=>t.map((t=>{const s={...t};return s.resourceType&&i.includeBrowseManifest&&e&&(s.browseManifest=e[t.lowerCaseResourceType]),s}))))}))}return(0,n.assetTypesMemo)(t).then((e=>e?.slice()))})),a.getAssetTypeInformationEndPoint.register(e,null,(e=>t.getAssetTypeInformation(e.extensionName,e.assetType))),a.getResourceTypeAssetTypeInformationEndPoint.register(e,null,(e=>t.getResourceTypeAssetTypeInformation(e))),a.mapAssetIdToDynamicSelectionAndIconEndPoint.register(e,null,((e,s)=>t.mapAssetIdToDynamicSelectionAndIcon(e.assetId,"mapAssetIdToDynamicSelectionAndIcon"))),o.getBrowseBladeReferenceEndPoint.register(e,null,((e,s)=>t.getBrowseBladeReference(e)))}(t,l)};var a=FxImpl.Extension})),
define("MsPortalImpl/Services/Services.BrowserTelemetry",["require","exports"],(function(e,t){"use strict";t.getBrowserInfo=function(){const e=i.navigator||{},t=o.availHeight,s=o.availWidth,c=n=o.height,d=r=o.width,f=a=i.innerHeight,x=l=i.innerWidth;return{AppName:e.appName,AppVersion:e.appVersion,UserAgent:e.userAgent,Language:e.language,SystemLanguage:e.systemLanguage,UserLanguage:e.userLanguage,Location:i.location.href,Platform:e.platform,CpuClass:e.cpuClass,Orientation:p,PrefersMsHighContrast:h,PrefersColorScheme:u,PrefersContrast:m,PrefersReducedMotion:g,ScreenAvailableHeight:t,ScreenAvailableWidth:s,ScreenAvailableResolution:s+"x"+t,ScreenHeight:c,ScreenWidth:d,ScreenResolution:d+"x"+c,WindowHeight:f,WindowWidth:x,WindowResolution:x+"x"+f,ScreenColorDepth:o.colorDepth}};var s=MsPortalFx.Base;const i=window,o=i.screen||{};let n,r,a,l;function c(){const e=o.height,t=o.width,c=i.innerHeight,d=i.innerWidth;if(n!==e||r!==t||a!==c||l!==d){const i={PreviousWindowHeight:a,PreviousWindowWidth:l,PreviousWindowResolution:l+"x"+a};n=e,r=t,a=c,l=d,function(e,t){const i=Date.now();s.Diagnostics.Telemetry.trace({timestamp:i,source:"BrowserTelemetry",action:t,data:e})}(MsPortalFx.extend(i,{ScreenHeight:e,ScreenWidth:t,ScreenResolution:t+"x"+e,WindowHeight:c,WindowWidth:d,WindowResolution:d+"x"+c}),"WindowSizeChanged")}}let d=0;$(i).on("resize",((e,t)=>{clearTimeout(d),d=setTimeout(c,5e3)}));const p=i.matchMedia("(orientation: landscape)").matches?"landscape":i.matchMedia("(orientation: portrait)").matches?"portrait":"undetermined",u=i.matchMedia("(prefers-color-scheme: light)").matches?"light":i.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"nopreference",m=i.matchMedia("(prefers-contrast: more)").matches?"more":i.matchMedia("(prefers-contrast: less)").matches?"less":i.matchMedia("(prefers-contrast: custom)").matches?"custom":"nopreference",g=i.matchMedia("(prefers-reduced-motion: reduce)").matches?"reduce":"nopreference",h=i.matchMedia("(forced-colors: active) and (prefers-color-scheme: light)").matches?"light":i.matchMedia("(forced-colors: active) and (prefers-color-scheme: dark)").matches?"dark":i.matchMedia("(forced-colors: active)").matches?"activeWithNoDarkOrLightPreferenceDetected":"off"})),
define("MsPortalImpl/Services/Services.FeedbackPolicies",["require","exports","FxInternal/AsyncLoader","Fx/Ajax","FxInternal/RpcEndPoints"],(function(e,t,s,i,o){"use strict";t.TENANT_ADMIN_ROLE_ID=t.PROVIDER_SCOPE=void 0,t.fetchFeedbackPolicySettings=l,t.fetchFeedbackPolicySettingsHandler=void 0,t.setupPolicyDependencies=function(e){a||(a=e)};var n=MsPortalFx.Base.Diagnostics.Telemetry;t.PROVIDER_SCOPE="/providers/Microsoft.PortalServices",t.TENANT_ADMIN_ROLE_ID="/providers/Microsoft.Authorization/roleDefinitions/18d7d88d-d35e-4fb5-a5c3-7773c20a72d9";const r=MsPortalFx.getLogFriendlyMessage;let a=null;async function l(){return await async function(){const e=n.startTrace({source:"FeedbackPolicies",action:"FetchAdminFeedbackControls"}),t=FxImpl.features.isEnabled("disablefeedbackcontactbycloud");try{const s=a?.notificationSurveyEnabledKey?.()??!0;s||n.trace({source:"FeedbackPolicies",action:"PopupSurveysDisabledByUser"});const o=await(0,i.batch)({type:"GET",uri:"/providers/Microsoft.PortalServices/settings/default?api-version=2024-09-01-preview",setTelemetryHeader:"FetchAdminFeedbackControls"}).then((e=>e.content));let r=o?.properties?.feedbackControlPolicy;r=r||{policyAllowFeedback:"NotConfigured",policyAllowSurvey:"NotConfigured",policyAllowScreenshot:"NotConfigured",policyAllowContact:"NotConfigured",policyAllowContent:"NotConfigured",connectedExperiences:"Disabled",policyContentSamplesDefault:"Disabled",policyEmailCollectionDefault:"Disabled",policyScreenshotDefault:"Disabled"};const l={policyAllowFeedback:"Disabled"!==r.policyAllowFeedback,policyAllowSurvey:"Disabled"!==r.policyAllowSurvey&&s,policyAllowScreenshot:"Disabled"!==r.policyAllowScreenshot,policyAllowContact:"Disabled"!==r.policyAllowContact&&!t,policyAllowContent:"Disabled"!==r.policyAllowContent,connectedExperiences:!1,policyContentSamplesDefault:!1,policyEmailCollectionDefault:!1,policyScreenshotDefault:!1};return n.endTrace(e,"FetchingPoliciesSucceeded",{controlsReceived:{...r},controlsFormatted:{...l}}),l}catch(s){if("object"==typeof s&&404===s?.httpStatusCode)return n.endTrace(e,"FetchingPoliciesNoRecord"),{policyAllowFeedback:!0,policyAllowSurvey:!0,policyAllowScreenshot:!0,policyAllowContact:!t,policyAllowContent:!0,connectedExperiences:!1,policyContentSamplesDefault:!1,policyEmailCollectionDefault:!1,policyScreenshotDefault:!1};throw n.cancelTrace(e,{error:r(s)}),s}}()}t.fetchFeedbackPolicySettingsHandler=(0,s.defineHandler)(o.fetchFeedbackPolicySettingsEndpoint,(()=>l()))})),
define("MsPortalImpl/Services/Services.FileUploadEndpointRegistration",["require","exports","Fx"],(function(e,t,s){"use strict";t.registerFileUploadEndpoints=function(){r||(r=!0,o.uploadActionEndPoint.register(i.client,null,(e=>n().then((t=>t.invokeUploadAction(e.uploadKey,e.action,e.context))))),o.getUploadInfosEndPoint.registerObjectFactory(i.client,{allowedOrigin:null,allowRemoteChanges:!0,handler:e=>n().then((t=>t.getUploadInfos(e.uploadKeys,e.category,e.resumable)))}))};var i=FxImpl.Rpc,o=FxImpl.FileUpload;const n=(0,s.memoizePromise)((()=>MsPortalFx.require("MsPortalImpl/Services/Services.FileUploadManager").then((e=>e.fileUploadManagerInstance()))));let r=!1})),
define("MsPortalImpl/Services/Services.FileUploadInitialization",["require","exports","Fx"],(function(e,t,s){"use strict";t.hasFileUploads=void 0,t.init=function(e){o||(o=!0,t.uploadSettingsManager=r=e,e.querySettings({store:10}).then((t=>{!MsPortalFx.isEmpty(t)&&i().then((t=>t.init(e)))})))},t.setHasFileUploads=function(e){t.hasFileUploads=n=e},t.setSettingsManager=function(e){t.uploadSettingsManager=r=e},t.uploadSettingsManager=void 0;const i=(0,s.memoizePromise)((()=>MsPortalFx.require("MsPortalImpl/Services/Services.FileUploadSettings").then((e=>e.fileUploadResumableTrackerInstance()))));let o=!1,n=t.hasFileUploads=void 0;let r=t.uploadSettingsManager=void 0})),
define("MsPortalImpl/Services/Services.GitHub",["require","exports"],(function(e,t){"use strict";t.fetchGitHubAccountInfo=async function(e){if(i)return i;const t=s.start({source:"Services.GitHub",action:"FetchGitHubAccountInfo"});try{i=await fetch(`https://api.github.com/user/${e}`).then((e=>e.json())),s.completeTrace(t)}catch(e){s.cancelTrace(t,{error:e})}return i};var s=MsPortalFx.Base.Diagnostics.Telemetry;let i})),
define("MsPortalImpl/Services/Services.HatsSettings",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.SettingsProcessor"],(function(e,t,s,i,o){"use strict";t.HatsSettingsManager=t.HatsSettings=void 0;class n extends o.SettingsProcessor{static create(e){return o.create(n,e,new r,18,!0)}}t.HatsSettingsManager=n,__decorate([__metadata("fx:diagnostics",[e,"HatsSettingsManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.SettingsManager]),__metadata("design:returntype",Promise)],n,"create",null);class r{constructor(){this.hatsExtensions=ko.observable("")}static create(e){return e.value}addExtensionCounts(e){if(!e.length)return;const t=JSON.parse(this.hatsExtensions()||"{}");e.forEach((e=>{const s=(t[e.extension]??0)+e.count;t[e.extension]=s})),this.hatsExtensions(JSON.stringify(t))}getHatsExtensionsList(){const e=JSON.parse(this.hatsExtensions()||"{}"),t=function(e){return Object.keys(e).map((t=>e[t]??0)).reduce(((e,t)=>e+t),0)}(e);return Object.keys(e).map((s=>{const i=e[s];return{bladeLoadCount:i,extension:s,extensionWeight:(o=t,n=i,Number((n/o).toFixed(5))),totalBladeLoadCount:t};var o,n}))}}t.HatsSettings=r,__decorate([__metadata("fx:diagnostics",[e,"HatsSettings"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[n]),__metadata("design:returntype",r)],r,"create",null)})),
define("MsPortalImpl/Services/Services.MfaSettings",["require","exports","MsPortalImpl/Notifications/NotificationsClientStrings","FxInternal/Experimentation","MsPortalImpl/UI/Hubs/UI.NotificationManager"],(function(e,t,s,i,o){"use strict";t.handleArmMfaGeneralNotificationLogic=async function(e,t,s){const n=e.get(i.ExperimentationManager),l=(await n.shellAssignments.whenAvailable()).getBooleanValue("armmfageneralnotification"),c=MsPortalFx.isFeatureEnabled("ci"),d=MsPortalFx.isFeatureEnabled("testarmmfageneralnotification"),p=t.armMfaGeneralNotificationShown();let u=!1,m="";l?c?m="Not_Shown_Feature_Ci_Enabled":s?p?m="Not_Shown_Toast_Already_Seen":u=!0:m="Not_Shown_User_Not_Admin":m="Not_Shown_Experiment_Disabled";if(a("handleArmMfaGeneralNotificationLogic",u||d?"Shown":m),u||d){const s="<div><p>"+r.descriptionP1+"</p><p>"+r.descriptionP2.format("<a class='msportalfx-ext-link' target='_blank' href='https://aka.ms/mfaforazure' style='margin-left: 5px; line-height: 10px;'>"+r.linkText+"</a>")+"</p></div>",i=e.get(o.NotificationManager);setTimeout((()=>{const e=i.addSingleNotification({title:r.title,description:{htmlTemplate:s},status:0,toastDuration:2,actions:[{label:r.btnLabel,action:"#view/Microsoft_Azure_Resources/ArmMfaSettings.ReactView"}]});e?.id?t.armMfaGeneralNotificationShown(!0):a("Arm_Mfa_Publish_Failed")}),5e3)}};var n=MsPortalFx.Base.Diagnostics.Telemetry;const r=s.MfaEnforcement;function a(e,t,s){n.trace({source:"Services.MfaSettings",action:e,actionModifier:t,data:s})}})),
define("MsPortalImpl/Services/Services.PersonalizationDataSettings",["require","exports","Fx/DependencyInjection","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.SettingsProcessor"],(function(e,t,s,i,o){"use strict";t.PersonalizationDataSettingsManager=t.PersonalizationDataSetting=void 0;class n extends o.SettingsProcessor{static create(e){return o.create(n,e,new r,26,!1)}}t.PersonalizationDataSettingsManager=n,__decorate([__metadata("fx:diagnostics",[e,"PersonalizationDataSettingsManager"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[i.SettingsManager]),__metadata("design:returntype",Promise)],n,"create",null);class r{constructor(){this.userIntents=ko.observable([]),this.userIntentMigrated=ko.observable(!1),this.subscriptionTypes=ko.observable([]),this.lastSubscriptionRefreshTime=ko.observable(0)}static create(e){return e.value}}t.PersonalizationDataSetting=r,__decorate([__metadata("fx:diagnostics",[e,"PersonalizationDataSetting"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[n]),__metadata("design:returntype",r)],r,"create",null)})),
define("MsPortalImpl/Services/Services.PersonalizationData",["require","exports","MsPortalImpl/Resources/ImplScriptResources","Fx/Ajax","Fx","MsPortalImpl/UI/UI.AuthStateManager","FxInternal/AsyncLoader","MsPortalImpl/Services/Services.PersonalizationDataSettings","Fx/Experimentation","FxHubs/ArtHelpers/ArtApis","MsPortalImpl/Services/Personalization","MsPortalImpl/Services/Services.Subscriptions"],(function(e,t,s,i,o,n,r,a,l,c,d,p){"use strict";t.checkPersonalizedSurveyEligibility=function(e){const t=MsPortalFx.isFeatureEnabled("personalizedsurvey"),s=e.get(n.AuthStateManager).getCurrentUser(),i=!s.objectId,o=s.tenantId!==FxImpl.internalEnv.fxAadInfrastructureTenantId,r=t&&!i&&o;return m.trace({source:"PersonalizedSurvey.Data",action:"checkPersonalizedSurveyEligibility",data:{featureFlagEnabled:t,isPassthroughUser:i,notInfrastructureTenant:o,isEligible:r}}),r},t.deleteSurvey=async function(){const e=m.start({source:"PersonalizedSurvey.Data",action:"deleteSurvey"});try{await i.ajax({uri:w.delete,type:"DELETE",setAuthorizationHeader:{resourceName:"survey"}}),m.completeTrace(e)}catch(t){m.cancelTrace(e,{error:t})}},t.fetchSurvey=M,t.getPersonalizationDataHandler=void 0,t.getUserIntents=function(){if(o.isDevelopmentMode)return v;return v.sort(((e,t)=>"Other"===e.id?1:"Other"===t.id?-1:Math.random()-.5))},t.loadSubscriptionTypes=async function(e){if(!e.get(l.Experimentation).shellAssignments.getBooleanValue("loadquotaid"))return;const t=(await e.get(p.SubscriptionsUserContext).getAllSubscriptionsCount())?.value;if(!t)return;const s=await e.getAsync(a.PersonalizationDataSetting);if(Date.now()-s.lastSubscriptionRefreshTime()<864e5)return;const i=m.start({source:"PersonalizedSurvey.Data",action:"loadSubscriptionTypes"});try{const e=await(0,c.getDataFromArt)({query:y,options:{resultFormat:"objectArray"}},"loadSubscriptionTypes",null,null,!1,{skipErrorLogging:!0}),o=e?.data||[];s.subscriptionTypes(o),s.lastSubscriptionRefreshTime(Date.now()),m.completeTrace(i,{subscriptionTypes:o,allSubscriptionsCount:t})}catch(e){m.cancelTrace(i,{error:e,allSubscriptionsCount:t})}},t.migrateUserIntentData=async function(e){if(!e.get(l.Experimentation).shellAssignments.getBooleanValue("userintentmigration"))return;if((await e.getAsync(a.PersonalizationDataSetting)).userIntentMigrated())return;await M(e,"migrateUserIntentData")},t.submitSurvey=async function(e,t){const s={Questions:t};try{const s=await e.getAsync(a.PersonalizationDataSetting);s.userIntents(Object.keys(t.find((e=>"UserIntent"===e.Question))?.Answers||{}).map((e=>({id:e})))),s.userIntentMigrated(!0)}catch(e){g.error("Failed to store the submitted intent to user settings.",e)}const o={surveyEntries:t},n=m.start({source:"PersonalizedSurvey.Data",action:"submitSurvey"});try{await i.ajax({uri:w.post,type:"POST",setAuthorizationHeader:{resourceName:"survey"},data:JSON.stringify(s)}),m.completeTrace(n,{...o})}catch(e){m.cancelTrace(n,{...o,error:e})}},t.tourSteps=t.surveyApis=void 0;var u=MsPortalFx.Base.Diagnostics,m=MsPortalFx.Base.Diagnostics.Telemetry;const g=u.createLog(e),h=FxImpl.internalEnv,f=s.PersonalizedSurvey,x=f.Option,b=f.StartTour,y="resourcecontainers\r\n| where type == 'microsoft.resources/subscriptions'\r\n| extend quotaId = tostring(parse_json(properties.subscriptionPolicies.quotaId))\r\n| extend type = case(quotaId =~ 'EnterpriseAgreement_2014-09-01', 'Enterprise', quotaId =~ 'FreeTrial_2014-09-01', 'FreeTrial', quotaId =~ 'PayAsYouGo_2014-09-01', 'PAYG', quotaId =~ 'LegacyMonetaryCommitment_2014-09-01', 'MonthlyPlan', quotaId =~ 'MSDN_2014-09-01', 'MSDN', 'Others')\r\n| summarize count() by type\r\n| project-rename count = count_";const v=[{id:"ManageIdentityAndAccess",title:x.manageIdentityTitle,description:x.manageIdentityDescription},{id:"CloudNativeApplication",title:x.nativeApplicationTitle,description:x.nativeApplicationDescription},{id:"PlatformServices",title:x.platformServiceTitle,description:x.platformServiceDescription},{id:"InfrastructureManagement",title:x.createInfraTitle,description:x.createInfraDescription},{id:"LinuxSolutions",title:x.linuxTitle,description:x.linuxDescription},{id:"Migration",title:x.migrateTitle,description:x.migrateDescription},{id:"HybridCloud",title:x.hybridEnvTitle,description:x.hybridEnvDescription},{id:"Security",title:x.securityTitle,description:x.securityDescription},{id:"AIML",title:x.aimlTitle,description:x.aimlDescription},{id:"IoT",title:x.iotTitle,description:x.iotDescription},{id:"CloudSkills",title:x.cloudSkillTitle,description:x.cloudSkillDescription},{id:"GovernResources",title:x.governResourcesTitle,description:x.governResourcesDescription},{id:"Other",title:x.other}],w=(t.tourSteps=[b.createAResource,b.dashboard,b.accountInfo,b.directoryAndSubscription,b.searchResource],t.surveyApis={get:h.fxPersonalizedSurveyEndpoint+"api/Survey_Get",post:h.fxPersonalizedSurveyEndpoint+"api/Survey_Post",delete:h.fxPersonalizedSurveyEndpoint+"api/Survey_Delete"});async function M(e,t){if((await MsPortalFx.Base.Security.getUserInfo()).directoryId===FxImpl.internalEnv.fxAadInfrastructureTenantId)return[];const s=m.start({source:"PersonalizedSurvey.Data",action:t||"fetchSurvey"});try{const t=await MsPortalFx.Base.Security.getAuthorizationToken({isBackground:!0,resourceName:"survey"}),o=await i.ajax({uri:w.get,type:"GET",headers:{Authorization:t.header}});m.completeTrace(s);const n=o?.Questions||[];try{const t=await e.getAsync(a.PersonalizationDataSetting);t.userIntentMigrated()||(t.userIntents(Object.keys(n.find((e=>"UserIntent"===e.Question))?.Answers||{}).map((e=>({id:e})))),t.userIntentMigrated(!0))}catch(e){g.error("Failed to store the fetched intent to user settings.",e)}return n}catch(e){return m.cancelTrace(s,{error:e}),[]}}t.getPersonalizationDataHandler=(0,r.defineHandler)(d.getPersonalizationDataEndpoint,(e=>async function(e,t){const s=await e.getAsync(a.PersonalizationDataSetting);return{...t?.userIntents?{userIntents:s.userIntents()}:{},...t?.subscriptionTypes?{subscriptionTypes:s.subscriptionTypes()}:{}}}(e.diContainer,e.messageArg)))})),
define("MsPortalImpl/Services/Services.ProjectedDirectories",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/UI.AuthStateManager","Fx/ResourceManagement","Fx/Ajax","FxHubs/ArmHelpers/ArmApisStartup","MsPortalImpl/Services/Services.Tenants","FxHubs/RpcEndPoints","FxHubs/HubsSettingsSchema","MsPortalImpl/Services/Services.Settings","FxInternal/AsyncLoader","Fx"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u){"use strict";t.resetState=t.getSubscriptionsForSelectedDirectoriesHandler=t.getDirectoriesMapHandler=t.ServicesProjectedDirectories=void 0;var m=MsPortalFx.Base.Diagnostics.Telemetry;const g=c.Keys.directoriesSelected,h="Services.ProjectedDirectories",f=(0,u.memoizePromise)((async e=>{const t=(await e.getTenants()).tenants||[],s=FxImpl.lowerCaseStringMap(),i=[];t.forEach((e=>{const{id:t,displayName:o,tenantCategory:n}=e;s.set(t,e),!o&&n.toLowerCase().includes("projectedby")&&i.push(t)}));const o=i.length;if(o){const e=m.start({source:h,action:"_getDirectoriesMapMemo"}),t=[],a=(0,r.listTenantsApi)();for(let e=0;e<o;e=Math.min(o,e+10)){const s=i.slice(e,e+10),o=(async()=>{const e=await(0,n.batch)({uri:`${a}&$filter=tenantId in ('${s.join("','")}')`,setTelemetryHeader:h+".getDirectoryNames"});if(![200,202,201,204].includes(e.httpStatusCode))throw FxImpl.Azure.buildSimplifiedError(e.content);return e.content})();t.push(o)}try{const o=await Promise.allSettled(t);let n=!1,r=0;return o.forEach((e=>{e&&"fulfilled"===e.status&&e.value?(e.value.value||[]).forEach((({tenantId:e,displayName:t})=>{t&&(r++,s.get(e).displayName=t)})):n=!0})),m.completeTrace(e,{directoriesToResolve:i.length,directoriesResolved:r,hasErrors:n}),s}catch(t){throw m.cancelTrace(e,{directoriesToResolve:i.length}),t}}return s}));let x=t.ServicesProjectedDirectories=class{constructor(e,t,s){this._tenantsService=e,this._settingsManager=t;const i=this._selectedDirectoriesInSession=ko.observable([]),o=s.getCurrentUser().tenantId;!o&&m.trace({source:h,action:"constructor",name:"CurrentUserDirectoryIdIsUndefined"});const n=(o||"").toLowerCase(),r=this._defaultSelectedDirectories=[n];this._initPromise=(async()=>{const e=await t.querySetting(6,g),s=e?.toLowerCase()?.split(";"),o=s?.length?s:r;m.trace({source:h,action:"InitializeProjectedDirectories",data:{first100SelectedDirectoryIds:o.slice(0,100)}}),i(o)})(),this._hasProjectedDirectoriesPromise=(async()=>{const[t]=await Promise.all([e.getTenants(),this._initPromise]),s={};let o=!1;t.tenants.forEach((e=>{const t=e.id.toLowerCase(),i=t!==n,r=e.tenantCategory.toLowerCase().includes("projectedby");o=o||i&&r,i&&!r||(s[t]=!0)}));const r=i(),a=r.filter((e=>s[e]));return a.length!==r.length&&this.setSelectedDirectoriesInSession(a),o})(),f(e)}async hasProjectedDirectories(){return await this._initPromise,this._hasProjectedDirectoriesPromise}async setSelectedDirectoriesInSession(e){await this._initPromise;const t=e?.length?e.map((e=>(!e&&m.trace({source:h,action:"setSelectedDirectoriesInSession",name:"DirectoryIdIsUndefined"}),(e||"").toLowerCase()))):this._defaultSelectedDirectories;return this._selectedDirectoriesInSession(t),this._settingsManager.setSetting(6,g,t.join(";"))}async getSelectedDirectoriesInSession(){return await this._initPromise,this._selectedDirectoriesInSession}async getSubscriptionsForSelectedDirectories(e){await this._initPromise,e=e||[];const t=this._selectedDirectoriesInSession();return e.filter((({tenantId:e,subscriptionId:s})=>e?t.includes(e.toLowerCase()):(m.trace({source:h,action:"getSubscriptionsForSelectedDirectories",name:"SubHasNoTenant",data:s}),!1)))}async getDirectoriesMap(){const[e]=await Promise.all([f(this._tenantsService),this._initPromise]);return e}async getDirectoryByResourceId(e){const t=o.ArmId.parse(e,!0);if(!t.subscription)return Promise.resolve(null);const[s,i]=await Promise.all([MsPortalFx.Azure.getSubscriptionInfo(t.subscription),f(this._tenantsService),this._initPromise]),n=s?.tenantId;return n?i.get(n.toLowerCase())||{id:n,displayName:"",domainName:"",tenantCategory:""}:null}};t.ServicesProjectedDirectories=x=__decorate([__metadata("fx:diagnostics",[e,"ServicesProjectedDirectories"]),s.Class(),__metadata("design:paramtypes",[a.TenantsService,d.SettingsManager,i.AuthStateManager])],x);t.getSubscriptionsForSelectedDirectoriesHandler=(0,p.defineHandler)(l.Directories.getSubscriptionsForSelectedDirectoriesEndPoint,(e=>e.diContainer.get(x).getSubscriptionsForSelectedDirectories(e.messageArg))),t.getDirectoriesMapHandler=(0,p.defineHandler)(l.Directories.getDirectoriesMapEndPoint,(async e=>{const t=await e.diContainer.get(x).getDirectoriesMap(),s={};return t.forEach(((e,t)=>{s[t]=e})),s}))})),
define("MsPortalImpl/Services/Services.Settings.Schema",["require","exports"],(function(e,t){"use strict";t.startBoardSettingsKey=t.desktopSettingsKey=t.avatarKey=void 0;t.avatarKey="avatar_base64encoded",t.desktopSettingsKey="sprint2",t.startBoardSettingsKey="Startboard"})),
define("MsPortalImpl/Services/Services.SharedSettings",["require","exports","FxInternal/AsyncLoader"],(function(e,t,s){"use strict";t.getSharedSettings=void 0;const i=window.fx.environment.links;t.getSharedSettings=s.defineHandler(FxImpl.Extension.getSharedSettingsEndPoint,(e=>({links:{accountPortal:i.accountPortal,classicPortal:i.classicPortal,createSupportRequest:i.createSupportRequest,helpAndSupport:i.helpAndSupport,manageSupportRequests:i.manageSupportRequests,submitAnIdea:i.submitAnIdea,privacyAndTerms:i.privacyAndTerms,privacyStatement:i.privacyStatement,promotionalCommunicationsManager:i.promotionalCommunicationsManager,learnRelatedResources:i.learnRelatedResources,resourceGroupOverview:i.resourceGroupOverview,roadmap:i.roadmap,filteringGranularity:i.filteringGranularity}})))})),
define("MsPortalImpl/Services/Services.ShellProvisioner",["require","exports","Fx/Composition/Selectable","Fx/DependencyInjection","MsPortalImpl/UI/UI.BladeOpener","MsPortalImpl/UI/UI.JourneyManager"],(function(e,t,s,i,o,n){"use strict";t.ShellProvisionerImpl=void 0,t.create=function(e){return e.get(c)},t.promiseCleanupDelay=void 0;var r=FxImpl.ViewModels.ParameterCollectionV3,a=MsPortalFx.Base.Diagnostics;t.promiseCleanupDelay=3e4;const l=a.createLog(e);let c=t.ShellProvisionerImpl=class{constructor(e,t,s){this._diContainer=e,this._journeyManager=t,this.provisioningPromisesLookup={},this._registerRpcCallbacks(s)}processProvisioningRequest(e){let t=!0;const i="Provisioning request is ";if(!e)throw new Error(`${i}undefined.`);if(!e.provisioningRefKey)throw new Error(`${i}missing the provisioningReferenceKey.`);if(!e.provisioningPromise)throw new Error(`${i}missing the provisioningPromise.`);e.provisioningPromise.catch((e=>{const t=(e||{}).error||e;this._logWarning("Provisioning promise rejected. "+(t.message||JSON.stringify(t)))}));const n=e.provisioningConfig;n&&n.dontDiscardJourney&&(t=!1);const r=n&&n.launchPostCreate&&n.postProvisioningBladeInputs;return r&&r.then((e=>{const t=new s.PdlBladeReference("DeploymentDetailsBlade","HubsExtension",{parameters:{id:e.deploymentId,packageId:e.galleryItemId,packageIconUri:e.galleryItemIconUri,assetTypeId:e.assetTypeId,primaryResourceId:e.primaryResourceId,provisioningHash:e.provisioningHash,createBlade:e.createBlade}}),i=e.createBlade?.telemetryId||"";this._diContainer.get(o.BladeOpener).openBlade(t,{flags:8,telemetryName:"ShellProvisioner"+(i?`_${i}`:"")})})),t&&!r&&e.provisioningPromise.then((()=>{const e=this._journeyManager.activeJourney();e&&this._journeyManager.forceDiscardJourney(e.id)})),e.provisioningPromise}_registerRpcCallbacks(e){r.initiateProvisioningRequestEndPoint.registerObjectFactory(e,{allowedOrigin:null,allowRemoteChanges:!0,handler:(t,s)=>{const i=s.srcWindowId,o="Can't initiate the provisioning request. ";return t.provisionerId?t.provisioningRefKey?(r.getProvisioningRequestEndPoint.acquireObject(e,i,t).then((e=>{this.processProvisioningRequest(e.value).finally((()=>{e.dispose()}))}),(e=>{throw new Error(e)})),Promise.resolve(t)):Promise.reject(o+"provisioningRefKey unspecified."):Promise.reject(o+"provisionerId unspecified.")}}),r.getProvisioningOperationEndPoint.registerObjectFactory(e,{allowedOrigin:null,allowRemoteChanges:!0,handler:e=>{if(!e)return Promise.reject("Can't return provisioning operation. provisioningRefKey unspecified.");const t=this.provisioningPromisesLookup[e],s=t&&t.promise;return s&&(this.provisioningPromisesLookup[e].wasAcquired=!0),Promise.resolve({provisioningPromise:s,data:t&&t.data})}})}_logWarning(e){l.warning(e)}};t.ShellProvisionerImpl=c=__decorate([__metadata("fx:diagnostics",[e,"ShellProvisionerImpl"]),i.Class(),__metadata("design:paramtypes",[i.Container,n.JourneyManager,FxImpl.Rpc.Client])],c)})),
define("MsPortalImpl/Services/Services.TelemetrySharing",["require","exports","Fx/DependencyInjection","MsPortalImpl/Extension/ExtensionManager"],(function(e,t,s,i){"use strict";t.SharingTelemetryProcessor=void 0;var o=MsPortalFx.Base.Constants,n=FxImpl.Rpc;let r=t.SharingTelemetryProcessor=class{constructor(e,t){this._extensionManager=e,this._extensions={},t.registerRpcEndPoint(o.TelemetrySharing.RegisterExtension,{allowedOrigin:null,handler:()=>{this._extensions[n.getMessageContext().srcWindowId]=!0}})}registerExtensionUnloadCallback(){this._extensionManager.onUnload((e=>{const t=e;return this._extensions[t]&&delete this._extensions[t],!0}))}trace(e){const t=e.extension,s=e.data&&e.data.srcExtension,i=o.TelemetrySharing.TraceTelemetry;"Ajax"!==e.action&&(this._extensions[t]&&n.client.invokeRpc(i,t,e),t!==s&&this._extensions[s]&&n.client.invokeRpc(i,s,e))}flush(){return Promise.resolve()}};t.SharingTelemetryProcessor=r=__decorate([__metadata("fx:diagnostics",[e,"SharingTelemetryProcessor"]),s.Class(),__metadata("design:paramtypes",[i.ExtensionManager,n.Client])],r)})),
define("MsPortalImpl/Services/Services.Util",["require","exports"],(function(e,t){"use strict";t.redactSensitiveData=function(e){const t=(e=e||"").toLowerCase();if(["password","pwd","azure_storage_access_key","sharedkey"].some((e=>t.includes(e))))return"_REDACTED_SENSITIVE_DATA_";return MsPortalFx.sanitizeMessage(e)},t.registerEndpoints=function(e,t){const a="./Services.UtilHandlers";r(s.pinParts,a,"pinPartsRpcHandler",e,t),r(s.getClientIp,a,"getClientIpHandler",e,t),r(s.getClientIpv6,a,"getClientIpv6Handler",e),r(s.getHmacSha256,a,"hmacShaRpcHandler",e),r(o,a,"x509CertificateRpcHandler",e),r(n,a,"getPublishingProfileRpcHandler",e,null,[`${i.ClassicResources}`,"fx"])};var s=FxImpl.Constants.RpcMethods,i=MsPortalFx.Base.Constants.ExtensionNames;const o="MsPortalFx.Internal.Constants.RpcMethods.X509Certificate.getX509Certificates",n="MsPortalFx.Internal.Constants.RpcMethods.PublishingProfile.getPublishingProfile";function r(t,s,i,o,n,r){return o.registerRpcEndPoint(t,{allowedOrigin:r,handler:(t,o)=>MsPortalFx.require(e.normalize(s)).then((e=>(0,e[i])(t,o,o.ltm,n)))})}})),
define("MsPortalImpl/Parts/Parts.Error",["require","MsPortalImpl/Parts/Parts","MsPortalImpl/Widgets/Widgets.PartError","MsPortalImpl/UI/Commands/UI.ExtensionCommands","MsPortalImpl/UI/Commands/UI.ShellCommands"],(function(e,t,s,i,o){"use strict";var n=MsPortalFx.Parts,r=n.PartKind;class a extends t.PartImpl{constructor(e,t,s,i){super(e,t,s,i),t.container.contentState(3),t.internal.allowUiBlocking(!1)}_bindContent(e,t){const n=this._viewModel.content.peek(),r=new s.ViewModel(n,{sessionId:MsPortalFx.sessionId,extName:this._getExtensionName(),resourceId:this.assetId(),contentName:this._options.locator.name},{showDetailsCmd:this._onDashboard}),a=this.partComposition,l=new i.CompositionInstanceCommandContext(e,null,a),c=a&&new o.ReloadPart(this._lifetime,this._diContainer,a);if(c&&(c.bind(l),r.commands.push(c)),this._onDashboard){const e=a&&new o.UnpinFromStartboard(this._lifetime,this._diContainer);e&&(e.bind(l),r.commands.push(e))}const d=a&&new o.GoToAssetBlade(this._lifetime,this._diContainer,this.partComposition);d&&(d.bind(l),d.enabled()&&r.commands.push(d)),this._lifetime.registerForDispose(new s.Widget($(e),r,this._diContainer))}}t.registerFactory(r[n.PartKind._Internal_Error],t.createPartFactory("",{partClass:a}))})),
define("_generated/Less/MsPortalImpl/Parts/Parts.Frame.css",["module"],(function(e){"use strict";return{css:".fxs-part.fxs-part-framepart{padding:0;overflow:hidden!important}.fxs-part.fxs-part-framepart.fxs-part-part-title-visible .fxs-part-title{padding:15px 15px 0 15px}.fxs-part-frame{width:100%;height:100%;border:0;overflow:auto;min-height:calc(100vh - 40px)}@media(min-height:500px){.fxs-part-frame{min-height:initial}}",moduleId:e.id}})),
define("MsPortalImpl/Parts/Parts.Frame.Common",["require","exports","FxInternal/Css","_generated/Less/MsPortalImpl/Parts/Parts.Frame.css"],(function(e,t,s,i){"use strict";t.createFrame=function(e){const{contentElement:t,onFatalError:s,trustedOrigin:i,messageSignature:o,onMessage:a,lifetime:l,uri:c,frameReadyDeferred:d,isReadyMessage:p}=e,u=c.toString(),m=FxImpl.createElement("div",{trustedInnerHTML:"<iframe />"}).firstElementChild;let g;m.classList.add("fxs-part-frame"),m.setAttribute("sandbox","allow-same-origin allow-scripts allow-popups allow-modals allow-forms allow-downloads"),m.setAttribute("allow","microphone *; display-capture *; encrypted-media *;clipboard-read;clipboard-write;"),m.setAttribute("role","presentation"),m.setAttribute("src",u),m.setAttribute("allowfullscreen","true"),t.appendChild(m);const h=l.createChildLifetime(),f=e=>{if(h.isDisposed())return;if(!(e.source===(g||m.contentWindow)))return;const t=e.data;"###BOOT###"===t.signature&&s(new Error("Boot message received from iframe, disposing to prevent XSS.")),e.origin===i&&t&&t.signature===o&&(p(t)&&(clearTimeout(x),x=null,d.resolve(),g||(g=m.contentWindow)),a(t))};n.addEventListener("message",f,!1);let x=setTimeout((()=>{FxImpl.Diagnostics.getStatusCode(u,((e,t,s)=>{const i={postIFrameLoadFailurePingResponse:{uri:u,statusCode:e,statusText:s,responseText:t}};d.reject(i)})),x=null}),r);return h.registerForDispose({dispose:()=>{x&&clearTimeout(x)}}),h.registerForDispose((()=>{n.removeEventListener("message",f,!1),m.remove()})),{postMessage:(e,t)=>{g.postMessage(e,i,t)},contentWindow:g}},t.formMarkName=l,t.logFrameAddedTelemetry=function(e){a({...e,action:"IFrameAddedToDom"})},t.logFrameTelemetry=a,t.removeContentPadding=function(e){$(e).closest(".fxs-part").addClass("fxs-part-framepart")},(0,s.injectCss)(i);var o=MsPortalFx.Base.Diagnostics.Telemetry;const n=window,r=3e4;function a(e){const{isPart:t,journeyManager:s,locator:i,action:n}=e,r=s.activeJourney();FxImpl.TelemetryContext.usingState((()=>{o.trace({extension:i.getExtensionName(),source:t?"StartBoardPart":"Blade",action:n,name:l(e),journeyId:r&&r.id})}),e.telemetryContextState)}function l({isPart:e,locator:t}){let s=t?t.toFriendlyString().toLowerCase():"";return e||(s=s.replace(/\/lens\/.*$/g,"")),s}})),
define("MsPortalImpl/Parts/Parts.ReactFrameProvider",["require","exports","Fx/DependencyInjection","MsPortalImpl/ReactViews/ReactFrame.FramePool","MsPortalImpl/UI/Compositions/UI.Composition","Fx/Experimentation","MsPortalImpl/Services/Services.Copilot"],(function(e,t,s,i,o,n,r){"use strict";t.createFrameProvider=function(e,t,s){if(s)return new x(t,e.container.flags);if(32&e.container.flags)return new g(t.viewName);if(1&e.container.flags)return new m;if(16&e.container.flags)return new h;if(t.isMenuBlade)return new f;return new u};const a=window,l="fxs-display-none",c="fxs-bladesize-",d="data-react-id";class p{setContentElement(e){this._contentElement=e,e.classList.add("fxs-part-reactframe")}getOptions(e){return this._lifetime=e,this._getFrameOptions(e)}bindToFrame(e,t){const s=this._contentElement;return s.setAttribute(d,t.id),this._configureFrameElement(t.element),this._sectionElement=s.closest(this._cssClasses.section),this._bindToFrame(e,t)}_configureFrameElement({classList:e}){this._cssClasses.frame&&e.add(this._cssClasses.frame),e.add("fxs-floated-frame"),e.remove("fxs-extension-frame")}_createObserver(e,t,s){const i=this._sectionElement,o=this._mutationObserver=new MutationObserver((()=>{s?.(),t.style.display="none"===getComputedStyle(i).display?"none":""}));e.registerForDispose((()=>{o.disconnect()})),i&&o.observe(i,{attributes:!0,attributeFilter:["style","class"]})}_observeParentElement(){this._sectionElement?.parentElement&&this._mutationObserver.observe(this._sectionElement.parentElement,{childList:!0})}_getFrameActions(e,t){const s=()=>{e.element.classList.add(l),e.element.classList.forEach((t=>t.startsWith(c)&&e.element.classList.remove(t))),e.inUse=!1};return this._lifetime.registerForDispose({dispose:s}),{showIFrame:()=>{e.element.classList.remove(l),t?.()},hideIFrame:s}}}class u extends p{constructor(){super(...arguments),this._cssClasses={frame:"fxs-blade-floated-frame",section:".fxs-blade"}}getFrame(e,t,s,o){return e.get(i.ReactFramePool).getFrame(0,null,s,o,!0)}_getFrameOptions(){const e=this._contentElement.closest(".fxs-blade-content-container")?.querySelector(".fxs-bladesize-menu");return{reactFrameType:0,isMenuBladeContent:this._isMenuBladeContent=!!e}}_bindToFrame(e,t){const s=t.element;this._isMenuBladeContent&&s.classList.add("fxs-blade-floated-menuframe");const i=this._contentElement,o=document.getElementsByClassName("fxs-journey-layout")[0],n=i.closest(".fxs-blade-content-wrapper"),r=()=>{const e=s.parentElement&&s.parentElement.getBoundingClientRect(),t=e?.left||0,r=e?.top||0,a=i.getBoundingClientRect(),l=n.getBoundingClientRect();s.setAttribute("style",`left: ${o.scrollLeft+a.left-t}px; top: ${o.scrollTop+a.top-r}px; height: ${l.height}px; width: ${l.width}px;`)};return i.onresize=r,r(),a.addEventListener("resize",r),a.addEventListener("visibilitychange",(()=>"visible"===a.document.visibilityState&&a.requestAnimationFrame(r))),e.registerForDispose((()=>{a.removeEventListener("resize",r)})),this._createObserver(e,s,r),this._observeParentElement(),this._getFrameActions(t,r)}}class m extends p{constructor(){super(...arguments),this._cssClasses={frame:"fxs-blade-floated-frame",section:".fxs-blade"}}getFrame(e,t,s,o){return e.get(i.ReactFramePool).getFrame(1,document.querySelector(".fxs-portal-contextpane-right"),s,o,!0)}_getFrameOptions(e){return{reactFrameType:1,contextPaneOptions:{setContextPaneWidth:t=>b(e,this._contentElement,t)}}}_bindToFrame(e,t){return function(e){e.element.removeAttribute("style");const t=e.container.querySelector(`[class*='${c}']`);t.setAttribute(d,e.id);const s=()=>t.classList.forEach((t=>t.startsWith(c)&&e.element.classList.add(t)));s(),new MutationObserver(((e,t)=>{s(),t.disconnect()})).observe(t,{attributes:!0,attributeFilter:["class"]})}(t),this._createObserver(e,t.element),this._observeParentElement(),this._getFrameActions(t)}}class g extends m{constructor(e){super(),this._viewName=e||""}getFrame(e,t,s,o){return e.get(i.ReactFramePool).getFrame(1,document.querySelector(".fxs-portal-contextpane-docked"),s,o,!1)}_getFrameOptions(e){return{reactFrameType:1,contextPaneOptions:{setContextPaneWidth:t=>{if(!e.isDisposed()){const e=this._contentElement.closest(".fxs-blade"),s=$.data(e,o.CompositionInstanceDataName);s.bladeDefinition.contextPaneWidth=t,s.containerWidget.setContextPaneWidth(t)}}},dockedContextPane:!0}}_configureFrameElement({classList:e}){super._configureFrameElement({classList:e});if(s.container.get(n.Experimentation).shellAssignments.getBooleanValue("headerLessCopilotDockedPane")){const t="fxs-copilot-pane",i=s.container.get(r.CopilotService).getConfig().chatView?.toLowerCase();this._viewName?.toLowerCase().includes(i)?e.add(t):e.remove(t)}}}class h extends p{constructor(){super(...arguments),this._cssClasses={frame:"fxs-blade-floated-frame",section:".fxs-blade"}}getFrame(e){return e.get(i.ReactFramePool).getSidebarFrame()}_getFrameOptions(e){return{reactFrameType:3,inSideBar:!0}}_bindToFrame(e,t){return this._createObserver(e,t.element),this._getFrameActions(t)}}class f extends p{constructor(){super(...arguments),this._cssClasses={frame:null,section:".never-never-never"}}getFrame(e,t,s,o){return e.get(i.ReactFramePool).getFrame(4,null,s,o,!0)}_getFrameOptions(){return{reactFrameType:4}}_bindToFrame(e,t){return t.element.classList.add(l),{showIFrame:()=>{},hideIFrame:()=>{}}}}class x{constructor(e,t){this._isDockedContextPane=Boolean(32&t),this._reactFrameType=this._isDockedContextPane||1&t?1:16&t?3:e.isMenuBlade?4:0}getFrame(e,t,s,i){}setContentElement(e){this._contentElement=e}getOptions(e){return{reactFrameType:this._reactFrameType,isMenuBladeContent:0===this._reactFrameType&&Boolean(this._contentElement.closest(".fxs-blade-content-container")?.querySelector(".fxs-bladesize-menu")),contextPaneOptions:1===this._reactFrameType?{setContextPaneWidth:t=>b(e,this._contentElement,t)}:void 0,dockedContextPane:this._isDockedContextPane,inSideBar:3===this._reactFrameType}}bindToFrame(e,t){throw new Error("InShellProvider does not support iframe binding")}}function b(e,t,s){if(!e.isDisposed()){const e=t.closest(".fxs-blade"),i=$.data(e,o.CompositionInstanceDataName);i.bladeDefinition.contextPaneWidth=s,i.containerWidget.setContextPaneWidth(s)}}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.BladeTelemetry",["require","exports","Fx/DependencyInjection","Fx","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/UI/Compositions/UI.Composition","FxInternal/AsyncLoader"],(function(e,t,s,i,o,n,r,a,l){"use strict";var c;t.bladeFullReadyTimeout=t.MAX_NUMBER_OF_FIELDS_TO_CATEGORIZE=t.MAX_NUMBER_OF_ARRAY_ITEMS_TO_CATEGORIZE=t.MAX_CATEGORIZATION_DEPTH=t.MAX_ARRAY_DEPTH_TO_CATEGORIZE=t.BladeTelemetry=void 0;var d=MsPortalFx.Base.Diagnostics.Telemetry,p=d.ActionModifier,u=FxImpl.TelemetryContext,m=MsPortalFx.Base.Diagnostics.Metric;const g=new MsPortalFx.Base.Diagnostics.Log("MsPortalImpl/UI/Compositions/BladeTelemetry"),h=t.bladeFullReadyTimeout=6e4,f=t.MAX_CATEGORIZATION_DEPTH=5,x=t.MAX_ARRAY_DEPTH_TO_CATEGORIZE=5,b=t.MAX_NUMBER_OF_ARRAY_ITEMS_TO_CATEGORIZE=5,y=t.MAX_NUMBER_OF_FIELDS_TO_CATEGORIZE=50,v=window,w=v.fx.getTimestamp,{cancelOnDispose:M}=MsPortalFx.Base.Promises,C=[void 0,"StartboardPart","SideBar","DeepLink","Desktop","Home","GlobalSearch","AllServices","Notification","AvatarMenu","KeyBoardShortcut","FeedbackPane","TopBar","DebugPane"],S={0:"Small",1:"Medium",2:"Large",3:"XLarge",51:"Menu"},I={0:"Default",1:"TemplateBlade",2:"FrameBlade",3:"MenuBlade",4:"AppBlade",5:"ReactView"};let P=t.BladeTelemetry=c=class{constructor(e){this._diContainer=e,this._markers={},this._perfData={},this._additional={}}initializeBladeTelemetry(e,t,s){const i=this._perfData={includesExtensionLoadTime:!t.bladeDefinition},n=t.masterContainer,r=n&&n.locator,l=r&&r.toFriendlyString(),d=n&&n.instanceId,p=l,u=t.openedByInfo,m=u.openedByContext;if(this._blade=t,n&&n.getCompositionType()===a.CompositionType.Blade){const e=n;e.bladeDefinition&&e.bladeDefinition.menuBlade&&(this._menuBlade=e,this._menuBladeTelemetry=e.diContainer.get(c))}u.openedBy&&(i.openedBy=C[u.openedBy],i.isFavorite=2===u.openedBy&&m.openedBy&&1===m.openedBy,i.openedByPartName=u.openedByPartName),d&&(i.openedByBlade=d),p&&(i.openedByBladeName=p),s&&(i.preloadPartSettings=!0);const g=t.extension,h=t.locator,f=this._additional={extension:g&&g.name||h&&h.getExtensionName(),locator:h&&h.toFriendlyString(),assetType:e};f.extension&&(i.extVersion=this._diContainer.get(o.ManifestCache).getVersion(f.extension));const x=e=>{this._markers[e]=w(),this._markers["Menu"+e]=null},b=t.widget,y=b&&b.timer;return y&&(i.delayTime=y()),performance.mark("BladeFullReady: "+f.locator.toLowerCase()),x("BladeFullReady"),x("BladeSettled"),this.readyStartTime=w(),this.readyStartTimeCommon=Date.now(),this._perfData}traceBladeComplete(e,t,s){const i=this._blade;this._initializeTelemetryDetails(i,e);const n=i.extension;this._perfData.extVersion=n&&this._diContainer.get(o.ManifestCache).getVersion(n.name);const a=this._perfData;a.clickToFullReadyTime=Date.now()-i.openInitiatedTimestamp,!a.rejectedPromises&&t<h&&(clearTimeout(t),r.temporaryExtensionCount.incrementCount(i.extension.name),s&&(this._perfData.deepLinkContext=i.masterContainer.getDeepLinkContext()),this._bladeFullReadyTelemetry(p.Complete,i,a)),this._refreshTelemetryInsightsOverlay(i)}traceBladeLoadErrored(e,t){const s=!this._markers.BladeFullReady,i=0===t.status;let n;n=s?i?"BladeNetworkErrored":"BladeErrored":i?"BladeLoadNetworkErrored":"BladeLoadErrored";const r=this._blade,a=r?.extension;this._perfData.extVersion=a&&this._diContainer.get(o.ManifestCache).getVersion(a.name),this._markers[n]=this._markers.BladeFullReady||w(),s||this._traceWithState("BladeFullReady",p.Cancel,r)(),t={...this._perfData,...t},this._traceWithState(n,e,r,t)()}beginTraceBladeDisposed(){this._blade&&(MsPortalFx.forEachKey(this._markers,((e,t)=>{t&&this._traceWithState(e,p.Cancel,this._blade)()})),this._closedTime=this._markers.BladeClosed=w())}endTraceBladeDisposed(){this._blade&&this._traceWithState("BladeClosed",p.Complete,this._blade,{TotalTimeBladeOpen:this._closedTime-this.readyStartTime})()}getTelemetryData(){return this._perfData}_categorizeArray(e,t=1){if(t>x)return"array_TooDeepToFurtherProcess";const s=new Set;for(let i=0;i<b&&i<e.length;i++){let o=MsPortalFx.getTypeOf(e[i]);"string"===o?o=this._categorizeStrings(e[i]):"object"===o?o=this._categorizeObjectWithErrorBoundary(e[i]):"array"===o&&(t++,o=this._categorizeArray(e[i],t++)),s.add(`"${o}"`)}return 0===s.size?"[]":"["+Array.from(s).join(",")+"]"}_categorizeObject(e,t=0){if(t>f)return'"object_TooDeepToFurtherProcess"';let s=1;const i=[];for(const[o,n]of Object.entries(e)){let e=!1,r=!1,a=MsPortalFx.getTypeOf(n);if(s>y){a="object_TooManyFieldsToFurtherProcess",i.push(`"${o}":"${a}"`);break}"string"===a?a=this._categorizeStrings(n):"object"===a?(r=!0,a=this._categorizeObject(n,t+1)):"array"===a&&(e=!0,a=this._categorizeArray(n,t+1)),s++,e||r?i.push(`"${o}":${a}`):i.push(`"${o}":"${a}"`)}return`{${i.join(",")}}`}_categorizeStrings(e){if(/[?&](?:sv|sp|se|st|sig)=[^&]+/.test(e))return"URLSASToken";if(/(?:https|http|ftp|ftps):\/\//i.test(e))return"URL";const t=/\{?[0-9A-F]{8}-?(?:[0-9A-F]{4}-?){3}[0-9A-F]{12}\}?/i;if(new RegExp(/\/subscriptions\//i.source+t.source,"i").test(e))return"ResourceID";if(t.test(e))return"GUID";if(/<\/?[a-z][\s\S]*>/i.test(e)){return/mailto:/i.test(e)?"URLMailTo":"HTML"}if(/[\w.%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/i.test(e))return"Email";return/javascript:/i.test(e)?"URLJavaScript":"string"}_categorizeObjectWithErrorBoundary(e){try{return this._categorizeObject(e)}catch(e){return g.error("Error categorizing object",e),"object"}}_initializeTelemetryDetails(e,t){const s=t.filter((e=>"rejected"===e.status)),i=this._perfData;i.inputParameters={};for(const[t,s]of Object.entries(e.getInputsOnlyViewModel())){const e=ko.unwrap(s);let o=MsPortalFx.getTypeOf(e);"string"===o?o=this._categorizeStrings(e):"object"===o?o=this._categorizeObjectWithErrorBoundary(e):"array"===o&&(o=this._categorizeArray(e)),i.inputParameters[t]=o}const o=e.bladeDefinition;i.lockedBlade=!!o.locked,i.useDetailContent=e.useDetailContent,i.bladeType=I[(0,a.getBladeType)(o)],i.bladeWidth=2===i.initialDisplayState?"Fullscreen":S[o.width]||"Fullscreen",i.reflowReady=!!o.reflowReady,i.inContextPane=!!(1&e.flags),i.isWeave=!!o.isWeave,i.resource=e.openedByInfo.openedByContext?.deepLink?.substring(0,2e3),0===s.length?i.earlyOnInputsSetBlade=e.earlyOnInputsSet:i.rejectedPromises=s.length,i.telemetryName=e.telemetryName||""}_refreshTelemetryInsightsOverlay(e){!i.isFeatureEnabled("telemetryinsights")||1&e.flags||this._diContainer.getAsync(l.get("MsPortalImpl/Services/Services.TelemetryInsights","TelemetryInsights")).then((e=>{e.overlayVisible&&(e.clear(),e.toggleOverlay(this._blade,!1,this._blade.containerWidget.element)),e.forceInitialLoad&&e.toggleOverlay(this._blade,!0,this._blade.containerWidget.element)}))}_traceTelemetry(e,t,s,i,o,n){const r=this._additional;u.usingState((()=>{const a=o.locator&&o.locator.toFriendlyString();d.trace({extension:r.extension,source:"Shell",action:e,actionModifier:t,context:n,data:i,name:a,assetType:r.assetType,journeyId:o.journeyId,serviceTreeId:o.extension&&o.extension.serviceTreeId,duration:s}),m.record({name:e,extension:r.extension,value:s,dimensions:{bladeName:a,actionModifier:t}})}),n)}_traceWithState(e,t,s,i){const o=this._markers;if(!o[e])return MsPortalFx.noop;delete o[e];const n="BladeFullReady"===e&&i?.reactViewInitializeEnd?Math.max(i.reactViewInitializeEnd-this.readyStartTimeCommon,0):w()-this.readyStartTime;let r;if(this._menuBlade&&s.useDetailContent){const o="Menu"+e,a=this._menuBladeTelemetry,l=a._markers||{};if(o in l){delete l[o];const e=w()-a.readyStartTime,c=this._menuBlade.getCreationState();r=r=>{this._menuBlade.await(4).finally((()=>{u.usingState((()=>{const a=this._menuBlade.locator,l=s.locator,c=this._menuBlade.menu,p=c&&c.getResourceType()||this._menuBlade.assetType,u=c&&c.getTelemetryInfo()||{};d.trace({name:a.toFriendlyString(),extension:a.getExtensionName(),source:"Shell",action:o,actionModifier:t,data:$.extend({detailName:l.toFriendlyString(),detailExtension:s.extension&&s.extension.name,detailDuration:n,type:p,resourceId:s.assetId()||s.parent&&s.parent.getCurrentResourceId()},i||{},r&&r(this._menuBlade)||{},u),duration:e,journeyId:s.journeyId}),m.record({name:o,extension:a.getExtensionName(),value:e,dimensions:{bladeName:a.toFriendlyString(),actionModifier:t}})}),c)}))}}}const a=s.getCreationState();return(o,l,c)=>(this._traceTelemetry(e,t,c||n,MsPortalFx.extend2(i,o),s,a),r&&r(l),c||n)}_bladeFullReadyTelemetry(e,t,s){const o=e=>e.locator.toFriendlyString().toLowerCase(),r=e=>"BladeFullReady: "+e,a=this._traceWithState("BladeFullReady",e,t,s),l=o(t),c=r(l),d=c+"-end";performance.mark(d),performance.measure(c,c,d);const u=t.widget.element[0];M(t,Q((0,n.waitForBindings)(u)).timeout(1e4).then(MsPortalFx.noop,MsPortalFx.noop)).finally((()=>{const e=w(),s=c+"-render",n=e=>{const t=e?o(e):l;performance.measure(`${e?"Menu":""}BladeFullRender: ${t}`,e?r(t):c,s)};performance.mark(s),n();const d=e-this.readyStartTime;t.fullReadyTime(a({bladeRenderTime:d},(t=>{n(t);const s=new Event("fxmenubladerendered",{bubbles:!0});return u?.dispatchEvent(s),{menuBladeRenderTime:e-this._menuBladeTelemetry.readyStartTime}}))),v.requestAnimationFrame((()=>{const e=document.createEvent("Event");e.initEvent("fxbladefullrender",!0,!0),u&&u.dispatchEvent(e)}));const m=async e=>{await i.delay(0),this._traceWithState("BladeSettled",p.Complete,this._blade,this._perfData)({bladeRenderTime:d,bladeReadyTime:t.fullReadyTime(),...e&&{pendingExtensionOperationsCount:e.pendingOperationsCount,extensionWaitForSettledTime:e.waitDuration,...e.interruptedByChild&&{interruptedByChild:!0}}}),performance.measure(`BladeSettled: ${l}`,c)},g=t.extension?.waitForIdle&&M(t,t.extension.waitForIdle(t.locator.name,t.instanceId));g?g.then(m):m()}))}};t.BladeTelemetry=P=c=__decorate([__metadata("fx:diagnostics",[e,"1"]),s.Value("composition"),__metadata("design:paramtypes",[s.Container])],P)})),
define("MsPortalImpl/ReactViews/ReactFrameBinder",["require","exports","Fx/DependencyInjection","Fx/Errors","MsPortalImpl/AzFramework/AzHost","MsPortalImpl/ReactViews/ReactFrame.FramePool","MsPortalImpl/ReactViews/ReactFrame.Utils","MsPortalImpl/Base/Themes","MsPortalImpl/Services/Services.ExtensionTokensManager","MsPortalImpl/Services/Services.ExtensionStorageManager","MsPortalImpl/ReactViews/ReactQueryStore","MsPortalImpl/Extension/ExtensionManagerOptions","FxInternal/Utils/LinkSanitizer","FxInternal/Lifetime","MsPortalImpl/Base/Base.Router","MsPortalImpl/UI/Compositions/UI.Composition.BladeTelemetry","MsPortalImpl/Base/Base.ImplUtils","FxInternal","FxInternal/AsyncLoader","MsPortalImpl/ReactViews/ShellReactQueries"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x,b,y){"use strict";t.ReactFrameBinderFactory=void 0,t.extractBladeSequenceNumber=function(e){const t="string"==typeof e?e:e&&FxImpl.TelemetryContext.usingState((()=>MsPortalFx.Base.Diagnostics.Telemetry.Context.getBladeContext()?.instanceId),e),s=t?.split("_").slice(-2)[0];return s&&parseInt(s)},t.loadModel=_,t.loadModelForView=F;var v=FxImpl.Extension,w=MsPortalFx.Base.Diagnostics.Telemetry,M=FxImpl.TelemetryContext;let C=t.ReactFrameBinderFactory=class{constructor(e){this._diContainer=e}createBinder(e){const t={...e,diContainer:this._diContainer};return e.inShell?new P(t):new I(t)}};t.ReactFrameBinderFactory=C=__decorate([__metadata("fx:diagnostics",[e,"ReactFrameBinderFactory"]),s.Class(),__metadata("design:paramtypes",[s.Container])],C);class S{constructor(e){this._frameReadyDeferred=Promise.withResolvers();const{telemetryContextState:t,moduleName:s,extensionName:i,frameVal:o,diContainer:n,bladeSequenceNumber:a}=e;this._bladeSequenceNumber=a,this._moduleName=s,this._extensionName=i,this._frameVal=o,this._linkSanitizer=n.get(u.LinkSanitizer);const l=n.get(c.ExtensionStorageManager).getStorageForExtension(i),d=n.get(p.PostBootCache).get(i);this._contentOptions=Promise.all([l,d]).then((([e,t])=>({viewModuleId:(0,r.getModuleIdAndUrl)(s,t.requireConfig).id,environment:t.extensionEnvironment,features:t.features,extensionStorage:e,mergedConfig:t.requireConfig}))),this._telemetryContextState=t,this._diContainer=n}awaitReady(){return this._frameReadyDeferred.promise}bindBlade(e){this._bind(e)}bindAmbient(e){this._bind({...e,frameOptions:{reactFrameType:5}})}}class I extends S{constructor(e){super(e),this._hostDeferred=Promise.withResolvers()}toggleDevTools(){return this._hostDeferred.promise.then((e=>e.toggleDevTools()))}togglePerfTools(){return this._hostDeferred.promise.then((e=>e.togglePerfTools()))}executeCopilotHandler(e,t,s){return this._hostDeferred.promise.then((i=>i.executeCopilotHandler(e,t,s)))}toggleTelemetryInsights(e){this._hostDeferred.promise.then((t=>t.toggleTelemetryInsights(e)))}showTours(e){this._hostDeferred.promise.then((t=>t.showTours(e)))}_bind({lifetime:t,frameOptions:s,parametersPromise:r,menuRenderer:c,azHostOptions:p,initializedDeferred:u,bindToFrame:b,onLoadReactView:v,entryPointName:C,entryPointArgs:S}){u=u||Promise.withResolvers();const I=Date.now();Promise.all([this._contentOptions,this._frameVal?.frame]).then((()=>this._frameReadyDeferred.resolve()),(e=>this._frameReadyDeferred.reject(e)));const{viewModel:P,container:_,contentRevealedDeferred:T}=p||{},k=new m.TriggerableLifetimeManager,E=this._diContainer.get(a.ThemeManager),D=this._diContainer.get(d.ReactQueryStoreManager).getViewStore(this._extensionName,this._bladeSequenceNumber,t);let A;const B=u.promise.then((()=>{MsPortalFx.Base.Diagnostics.Telemetry.completeTrace(A)}));u.promise.catch((()=>{MsPortalFx.Base.Diagnostics.Telemetry.cancelTrace(A)}));const N=Promise.withResolvers(),R=Promise.withResolvers(),L=this._frameVal.frame.then((async e=>{M.usingState((()=>{w.trace({source:"Parts.ReactFrame",action:"FramePartSuccess",data:{frameId:e.id}})}),this._telemetryContextState),k.registerForDispose((()=>this._frameVal.dispose()));const i=()=>{if(t.isDisposed())return this._frameVal.completed(!0),k.dispose(),!0};if(i())return null;const{isMenuBladeContent:o,contextPaneOptions:r,inSideBar:a,dockedContextPane:l}=s,c=b?.(k,e)||{showIFrame:()=>{},hideIFrame:()=>{}},d=await N.promise;if(i())return null;const p=this._diContainer.get(n.ReactFramePool),u=p.loadReactView({extensionName:H,frame:e,isMenuBladeContent:o,inContextPane:!!r,inDockedContextPane:l,inSideBar:a,viewName:this._moduleName,diContainer:this._diContainer,parameters:d,bladeSequenceNumber:this._bladeSequenceNumber,entryPointName:C,entryPointArgs:S,viewLoadStartTime:I});v?.(u,e);const m=await u.viewLoadingCompleted;if(A=m.traceKey,i())return null;R.resolve(m.viewMetadata||{}),m.viewMetadata&&this._updateFrameFromViewMetadata(m.viewMetadata,s);const{viewModuleId:g,environment:h,features:f,extensionStorage:x,mergedConfig:y}=await this._contentOptions;if(i())return null;if(!g)return _.fail(`Could not find view module for: ${this._moduleName}.`),P.hookOnInputsSet(Promise.resolve()),void T.resolve();const E=e.model||F(this._diContainer.get(FxImpl.Rpc.Client),y,H,this._moduleName,d);k.registerForDispose((()=>{E.unloadModel()}));const B=p.getReactViewExperiments();e.port.postMessage({signature:"Az",kind:3,data:{isMenuBladeContent:o,environment:!e.featured&&{...h,requireConfig:void 0},features:!e.featured&&f,serializedStorage:e.featured?void 0:x.serialize(),queryStoreEntries:B.skipEarlyStorageData?D.getEntries():void 0,name:this._moduleName,type:"init"}},[E.port]),e.featured=!0;return{postMessage:(t,s)=>{e.port.postMessage({signature:"Az",kind:t,data:s})},setOnMessage:t=>e.setMessageListener(t,this._bladeSequenceNumber+""),reactViewOptions:{hide:c.hideIFrame,show:c.showIFrame,dispose:()=>{k.dispose()},onUnloaded:()=>{e.clearMessageListener()}},frameWindow:e.element.contentWindow,frameId:e.id,getFirstHiddenOrOfflineTime:()=>e.getFirstHiddenOrOfflineTime()}})).catch((e=>{u.reject(new i.FxError({message:"ReactView frame failed to load.",innerErrors:e,data:{extensionName:this._extensionName,reactView:this._moduleName}}))}));B.finally((()=>{this._frameVal.completed()}));const z=this._diContainer,H=this._extensionName,O=z.get(l.ExtensionTokensManager).createAuthTokenCache(H).getToken;(r??Promise.resolve()).then((i=>{const n=i&&i.parameters||{},{reactFrameType:r,contextPaneOptions:a}=s,d=5!==r&&async function(e,t,s,i,o){return e?Promise.resolve(e):i.then((e=>{const i=FxImpl.TelemetryContext.usingState((()=>MsPortalFx.Base.Diagnostics.Telemetry.Context.getBladeContext()?.instanceId),o);return y.provisioningContextQuery.bind(s,t,s,i,e.doesProvisioning).get()}))}(n._provisioningContext,z,D,R.promise,this._telemetryContextState);delete n._provisioningContext,N.resolve(n),MsPortalFx.Base.Promises.cancelOnDispose(t,L).then((async i=>{const{extensionStorage:p}=await MsPortalFx.Base.Promises.cancelOnDispose(t,this._contentOptions),m={frameId:i&&i.frameId,lifetime:t,parameters:JSON.stringify(n),telemetryContextState:this._telemetryContextState,initializedDeferred:u,viewModel:P,container:_,extensionName:H,getToken:O,diContainer:z,frameWindow:i&&i.frameWindow,contentRevealedDeferred:T,features:z.get(FxImpl.Features).value,theme:E,provisioningContext:d,queryStore:D,reactFrameType:r,defaultTokenPromise:z.get(l.ExtensionTokensManager).createAuthTokenCache(H).getToken(),extensionStorage:p,getSafeLink:(e,t)=>this._linkSanitizer.getSafeLink(e,t),inContextPane:!!a,inDockedContextPane:s.dockedContextPane,hasParentMenu:s.isMenuBladeContent,setContextPaneWidth:a?.setContextPaneWidth,router:z.get(g.Router),bladeTelemetryData:5!==r&&z.get(h.BladeTelemetry).getTelemetryData(),menuRenderer:c,onBladeApiCalled:5===r?t=>{const s=`TypeScript API ${t?`'${t}' `:""}enabled only for ReactViews was called from non-ReactView module '${this._moduleName}' from extension '${H}'.`;throw(0,f.logToExtension)(e,H,2,s,{contextData:{stack:(0,x.getCurrentCallStack)(),moduleName:this._moduleName,...t&&{apiName:t}}}),new Error(s)}:null,onFCP:this._frameVal.onFCP},b=(0,o.create)(m);i&&b.initialize(i),this._hostDeferred.resolve(b)}))}))}_updateFrameFromViewMetadata(e,t){if(e.contextPaneWidth&&t.contextPaneOptions){const s=this._convertContextPaneWithFromMetadata(e.contextPaneWidth);void 0!==s&&t.contextPaneOptions.setContextPaneWidth(s)}}_convertContextPaneWithFromMetadata(e){switch(e){case"small":return 0;case"medium":return 1;case"large":return 2;case"xlarge":return 3}}}class P extends S{constructor(e){super(e)}toggleDevTools(){throw new Error("toggleDevTools is not supported for shell react views.")}togglePerfTools(){throw new Error("togglePerfTools is not supported for shell react views.")}executeCopilotHandler(e,t,s){throw new Error("executeCopilotHandler is not supported for shell react views.")}toggleTelemetryInsights(e){throw new Error("toggleTelemetryInsights is not supported for shell react views.")}showTours(e){throw new Error("showTours is not supported for shell react views.")}_bind(e){const t=Date.now(),{azHostOptions:s,contentElement:i,frameOptions:o,initializedDeferred:n,parametersPromise:r,lifetime:a}=e;b.get("MsPortalImpl/ReactViews/ReactShellRenderer","loadReactViewIntoShell").then((e=>{e({azHostOptions:s,viewLoadStartTime:t,bladeSequenceNumber:this._bladeSequenceNumber,contentElement:i,contentOptions:this._contentOptions,diContainer:this._diContainer,extensionName:this._extensionName,frameOptions:o,initializedDeferred:n,lifetime:a,moduleName:this._moduleName,parametersPromise:r,telemetryContextState:this._telemetryContextState})}))}}function _(e,t,s,i){const o=new MessageChannel,n=e.acquireWindow(t,-1,o.port1),r=n.value;return v.getReactModelEndPoint.invoke(e,t,{modelName:s,portId:r,parameters:i}),{unloadModel:i=>{v.disposeReactModelEndPoint.invoke(e,t,{modelName:s,portId:r,unrequire:i}),n.dispose()},port:o.port2}}function F(e,t,s,i,o){const n=`${i.substring(0,i.length-10)}.ReactModel`;return _(e,s,(0,r.getModuleIdAndUrl)(n,t).id,o)}})),
define("MsPortalImpl/Parts/Parts.ReactFrame",["require","exports","MsPortalImpl/Parts/Parts","MsPortalImpl/Parts/Parts.Frame.Common","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/Parts/Parts.ReactFrameProvider","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/ReactViews/ReactFrameBinder","MsPortalImpl/ReactViews/ReactFrame.Utils"],(function(e,t,s,i,o,n,r,a,l){"use strict";t.Part=void 0;class c extends s.PartImpl{constructor(e,t,s,r,c){super(e,t,s,r),this.loadingNetworkThrottlingTelemetry=ko.observable(!1),this.togglingPerfTools=ko.observable(!1),this._contentRevealed=Promise.withResolvers(),this._initializationComplete=Promise.withResolvers();const{extensionName:d,viewName:p}=c,u=(0,l.shouldRenderInShell)(d,p,r),m=this._options.getTelemetryContextState(),g=(0,a.extractBladeSequenceNumber)(m);this._frameProvider=(0,n.createFrameProvider)(t,c,u);const h=this._frameVal=this._frameProvider.getFrame(r,e,d,g);this._frameBinder=new a.ReactFrameBinderFactory(r).createBinder({telemetryContextState:m,extensionName:d,moduleName:p,frameVal:h,inShell:u,bladeSequenceNumber:g}),h?.frame.then((()=>{(0,i.logFrameAddedTelemetry)({isPart:this._onDashboard,journeyManager:this._diContainer.get(o.JourneyManager),locator:this._options.locator,telemetryContextState:this._options.getTelemetryContextState&&this._options.getTelemetryContextState()})}))}awaitReady(){return this._frameBinder.awaitReady()}awaitContentRevealed(){return this._contentRevealed.promise}reactViewContentLoaded(){return this._frameVal?.reactViewContentLoaded??Promise.resolve()}awaitInitializationComplete(){return this._initializationComplete.promise}async toggleDevTools(){if(this._frameVal){const{initializeReactDevTools:e,toggleReactDevTools:t}=await MsPortalFx.require("MsPortalImpl/Parts/ReactDevTools/ReactDevTools");await e();const{element:s}=await this._frameVal.frame;t(s),await this._frameBinder.toggleDevTools()}}async togglePerfTools(){try{this.togglingPerfTools(!0),await this._frameBinder.togglePerfTools()}finally{this.togglingPerfTools(!1)}}async executeCopilotHandler(e,t,s){return this._frameBinder.executeCopilotHandler(e,t,s)}toggleTelemetryInsights(e){this._frameBinder.toggleTelemetryInsights(e)}showTours(e,t,s){this._frameBinder.showTours({tours:e,storeData:t,activatedToursCount:s})}async getFrameClientOptimizations(){if(this._frameVal){const{frameClientOptimizations:e}=await this._frameVal.frame;return e}return MsPortalFx.getFeatureValue("clientOptimizations")}_bindContent(e){MsPortalFx.disposeDisposable(this._childLifetime);const t=this._childLifetime=this._lifetime.createChildLifetime(),s=Promise.withResolvers(),i=s.promise.then((({timestamp:e})=>{this._viewModel.internal.reactViewInitializeEnd(e)})).finally((()=>{this._initializationComplete.resolve()})),o=this._viewModel.content().hookOnInputsSet(i);this._frameProvider.setContentElement(e);const n=i=>{this._frameBinder.bindBlade({azHostOptions:{container:this._viewModel.container,contentRevealedDeferred:this._contentRevealed,viewModel:this._viewModel.content()},bindToFrame:this._frameProvider.bindToFrame.bind(this._frameProvider),contentElement:e,frameOptions:a,initializedDeferred:s,onLoadReactView:(e,t)=>{e.viewLoadingStarted.then((()=>{void 0!==t.networkThrottlingTelemetryPromise&&(this._diContainer.get(r.ShowDebugTools).invoke(!0),this.loadingNetworkThrottlingTelemetry(!0),t.networkThrottlingTelemetryPromise.then((()=>{e.viewLoadingCompleted.then((()=>this.togglePerfTools()))})).finally((()=>{this.loadingNetworkThrottlingTelemetry(!1)})))}))},parametersPromise:o,menuRenderer:i,lifetime:t})},a=this._frameProvider.getOptions(t);4===a.reactFrameType?MsPortalFx.require("MsPortalImpl/ReactViews/MenuView").then((({createRendererAndBind:t})=>{const{renderer:i,initializedPromise:o}=t(this._viewModel.container,this._viewModel.content(),(t=>super._bindContent(e,t,null)));o.then((()=>s.resolve({timestamp:Date.now()}))),n(i)})):n()}}t.Part=c})),
define("MsPortalImpl/UI/Compositions/UI.Composition.Base",["require","exports","Fx","FxInternal","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Settings.Schema"],(function(e,t,s,i,o,n,r,a){"use strict";t.Instance=void 0,t.compositionRequire=function(e,t,s,o){return i.tryImmediateResolve(MsPortalFx.require(t,o),(t=>{if(!e||!e.isDisposed())try{return s(t)}catch(e){return Promise.reject(e)}}))},t.createContainerModel=function(e){return FxImpl.isSerializedObject(e)?FxImpl.fromSerializableObject(e):{}},t.createIdentifier=m;var l=FxImpl.TriggerableLifetimeManager,c=MsPortalFx.Base.Diagnostics,d=n.CompositionType;const p=c.createLog(e),u=n.getIdMatchFunc;function m(e,t,i){i=i||(0,s.getUniqueId)();let o=d[e];return o+=t?"-"+t.name:"",o+="-"+i,o}t.Instance=class extends l{constructor(e,t,s,i,o,n,a){super(),this._childObjects=ko.observableArray(),this._disposeCallbacks=$.Callbacks("memory once"),this._composedDeferred=Promise.withResolvers(),this.isComposed=!1,this.diContainer=t,this._sharedSettings=t.get(r.SettingsManager),this.locator=s,this.id=n||m(this.getCompositionType(),s,a&&a.toString()),this.widgetState=ko.observable(o||{}),this._addChildrenInternal(i);const l=this._composedDeferred.resolve;this._composedDeferred.resolve=e=>{l.apply(this._composedDeferred,[e]),this.isComposed=!0},this._toStringPrefix=`{ Name: ${e||"<NOT SPECIFIED>"}, Type: `}get children(){return this._childObjects()}subscribeChildren(e){return this._childObjects.subscribe(this,e)}get templateKey(){return""+(this.locator||this.id)}getPerfData(){return{}}getCompositionType(){throw new Error("The getCompositionType method is not implemented.")}getCreationState(){return this._creationState}toString(){let e=this._toStringPrefix;const t=this._toStringPostfix||(this._toStringPostfix=`, Id: ${this.id} }`);return e+=this.locator||"<null>",e+=t,e}compose(e,...t){if(this._composeInvoked)throw new MsPortalFx.Errors.Error(`Composition '${this.id}' is already composed.`);this._composeInvoked=!0,this._compose(e,this._composedDeferred,...t)}_compose(e,t,...s){throw new Error("Not implemented.")}resetLayout(){const e=this.children;e&&e.forEach((e=>{e.resetLayout()}))}dispose(e){this.isDisposed()||(super.dispose(),this._disposeCallbacks.fire(),e||this._deleteSetting(),this.children.slice(0).forEach((t=>{t.dispose(e)})))}_deleteSetting(){if(void 0!==this._store)this._sharedSettings.deleteSettings({store:this._store,keys:[this.id]});else if(this.parent){const e=this.parent.children,t=MsPortalFx.find(e,u(this.id));t&&MsPortalFx.remove(e,t),this.parent.save()}}save(e){if(void 0!==this._store){const t=this._sharedSettings;if(t){const s=this.toJSON();t.setSetting(this._store,this.id,JSON.parse(JSON.stringify(s))),1===e&&t.flushSettings()}}else this.parent&&this.parent.save(e)}await(e){switch(e){case 0:return Promise.resolve(!1);case 3:return Promise.resolve(null);case 7:return this._composedDeferred.promise}throw new MsPortalFx.Errors.Error("Await reason not supported")}onDispose(e){this._disposeCallbacks.add(e)}offDispose(e){this._disposeCallbacks.remove(e)}addChild(e,t,s=!0){e&&this.addChildren([e],t,s)}addChildren(e,t,s=!0){this._addChildrenInternal(e,t),s&&this.save()}_addChildrenInternal(e,t=this.children.length){if(e&&e.length>0){const s=this._childObjects();e.forEach((e=>{s.splice(t,0,e),e.parent=this,t++,this.addChildWidget(e.widget)})),this._childObjects(s)}}removeChildren(e){for(let t=this.children.length-1;t>=0;t--)this.removeChildAt(t,e,!1);this.save()}removeChildAt(e,t,s=!0){if(e>=0){const i=this._childObjects.splice(e,1)[0];this.removeChildWidget(i.id,t),t||i.dispose(),s&&this.save()}}replaceChild(e,t){const s=this._childObjects;if(e&&t&&s){const i=s.indexOf(e);i>=0&&(s.splice(i,1,t),t.parent=this,this.save())}}removeChild(e,t,s=!0){if(e&&this._childObjects){const i=this._childObjects.indexOf(e);this.removeChildAt(i,t,s)}}addChildWidget(e){this.widget&&e&&this.widget.addChild(e)}removeChildWidget(e,t){this.widget&&this.widget.removeChild(e,t)}getChildById(e){return this._childObjects?MsPortalFx.find(this._childObjects(),u(e)):null}toJSON(e){const t={},s=this.children,i=e?s.filter(e):s;return this.id!==a.startBoardSettingsKey&&i.forEach((e=>{t[e.id]=e.toJSON()})),{id:this.id,locator:this.locator,widgetState:this.widgetState(),errorMessage:this.unrecoverableErrorMessage,children:i.map((e=>e.id)),childSettings:t}}loadFromJson(e){this.unrecoverableErrorMessage=e.errorMessage}getBindableContainer(){return this._bindableContainer||(this._bindableContainer=function(e,t){let s,i=e;for(;i;)(i.hasOwnProperty(t)||"function"==typeof i[t])&&(s=i),i=i.parent;s||p.error(`Could not locate container with property or function '${t}' for composition '${e}'.`);return s}(this,"getViewModel")),this._bindableContainer}getDiagnosticsData(){return $.extend(this.toJSON(),{id:this.id,locator:this.locator&&this.locator.toString(),errorMessage:this.unrecoverableErrorMessage,children:(this.children||[]).map((e=>e.getDiagnosticsData()))})}definitionExists(e){const t=this.diContainer.get(o.DefinitionFinder),s=this.locator;return t.tryLocate(s,{})?0:t.tryLocate(s.getExtensionLocator(),{})&&e?1:2}discardWidgetStateOfUnusedChildren(){if(this.widget){const e=this.widget.discardStateOfUnusedChildren();e&&e.stateDiscarded&&p.warning("Unused widget state was discarded for composition '{0}'. \n{1} \nCurrent Children: {2}\nCurrent Widget State: {3}".format(this,e.message,JSON.stringify((this.children||[]).map((e=>""+e))),JSON.stringify(this.widgetState())))}}_markAsComposed(){this._composedDeferred.resolve()}}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer",["require","exports","FxInternal/Composition/ViewModel","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Extension/ShellPart","MsPortalImpl/Extension/DefinitionCache","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/UI/Compositions/UI.Composition"],(function(e,t,s,i,o,n,r,a,l){"use strict";t.composeCommands=function(e,t){const s=t.diContainer,i=r.getCommandGroupForDefinitionItem(s.get(n.DefinitionCache),t.extension.name,t.partDefinition),o=[],a={viewModelName:t+"-[ContainerModel]",viewModel:t.containerModel};return i.then((i=>{i&&(i.commands.forEach((e=>{(function(e,t){const s=t.parent&&t.getPartsContainer();if(!s)return!0;if(e.details&&1&s.flags)return p.error(`Part '${t}' cannot have the open blade command '${e.name||e.text}', because it is inside the context blade.`),!1;return!0})(e,t)&&o.push(new r.ExtensionCommandMenuItemImpl(t,t.extension,t,e,t.partDefinition,s,a))})),e.unshift(...o))}))},t.composePartCommands=async function(t,n,r){const a=r.getViewModel();if(s.isV2(a.content())||(0,o.isShellPart)(r.locator))try{const e=await(a.content().supplyCommands?.(n));if(e?.length){FxImpl.shellInterface(a.container).partCommands(e);const s=await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.CommandBar"),i=r.diContainer,o=e.map((e=>s.createItem(n,e,r.locator,i,{executeLifetime:r})));t.unshift(...o)}}catch(t){const s=`supplyCommands failed.\r\n ${MsPortalFx.getLogFriendlyMessage(t)}`;(0,i.logToExtension)(e,r.extension.name,2,s)}},t.composeShellCommands=function(e,t,s,i,o){if(function(e,t,s){e.filter((e=>t.getCompositionType()===d.StartboardPart&&s?e instanceof a.ShellCommand&&!(e instanceof a.CustomizeTileData):e instanceof a.ShellCommand)).forEach((t=>{MsPortalFx.remove(e,t),t.dispose()}))}(s,t,i),i){const i=function(e,t,s){const i=[];if(t.getCompositionType()===d.StartboardPart)i.push(new a.GoToAssetBlade(e,s,t)),i.push(new a.EnterOrganizeMode(e,s)),i.push(...a.CreatePartSizeCommandCollection(e,s)),i.push(new a.ReloadPart(e,s,t)),i.push(new a.ClonePart(e,s,t)),i.push(new a.UnpinFromStartboard(e,s),new a.ExitOrganizeMode(e,s));else{const o=t.instanceDefinition,n=o&&o.reference;n&&"HubsExtension"===n.extension&&"MonitorChartPart"===n.partTypeName||i.push(new a.PinToStartboard(e,s,t))}return i}(e,t,o);s.push(...i)}},t.createSelection=function(e,t){let s;s=e._msPortalFxCreateSelectionAsync?e._msPortalFxCreateSelectionAsync(t):e.createSelection(t);return Promise.resolve(s)};var c=MsPortalFx.Base.Diagnostics,d=l.CompositionType;const p=c.createLog(e)})),
define("MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Services/Services.Settings"],(function(e,t,s,i,o,n,r){"use strict";t.PartSettingsManager=void 0,t.buildIdentitySettingKey=g,t.partIdentityStatePrefix=void 0;var a=MsPortalFx.Base.Diagnostics,l=i.CompositionType,c=o.PropertyBindings;const d=a.createLog(e),p=Object.keys(MsPortalFx.trace.partsettings||{}),u=p.length>0,m=t.partIdentityStatePrefix="[PartIdentityState]-";function g(e,t,s){let o=`${m}${e.toString()}`;if(s&&(o+="-"+s),t){const e=t.hasOwnProperty(i.PartContainerModelIdProperty)&&[i.PartContainerModelIdProperty];o+="-"+MsPortalFx.toSortedString(ko.toJS(t),e)}return o}function h(e){let t;try{t=JSON.parse(JSON.stringify(e))}catch(s){t=e}return t}let f=t.PartSettingsManager=class{constructor(e){this._sharedSettings=e,this._trace=!1}configure(e){this._options=e,this._settingsStore=e.part.getCompositionType()===l.StartboardPart?11:2}configureInstanceProperties(e){this._options.instanceProperties=e}initialize(){this.dispose(),this._registerPartIdentityStateChangeHandler(),this._registerPartSharedKeyChangeHandler(),this._registerPartInstanceChangedHandler(),u&&(this._trace=p.some((e=>this._options.partViewModelId.toLowerCase().includes(e))))}saveIdentityPartSettings(e,t){const s=this._options,{part:i}=s;let o=this.getKeyForIdentitySettings(e);if(i.getCompositionType()===l.StartboardPart&&(o=g(i.locator,e)),o){if(this._identityState){const e=FxImpl.toSerializableObject(this._identityState.targetModel);this._traceOperationWithSettings("Save identity part settings.",e,o),this._sharedSettings.setSetting(t?11:this._settingsStore,o,e)}this._options.part.notifySettingChanged()}}clearIdentityPartSettings(){const e=this._options;if(e){const{part:t}=e,{containerModel:s}=t;let i=[this.getKeyForIdentitySettings(s)];t.getCompositionType()===l.StartboardPart&&i.push(g(t.locator,s)),i=i.filter((e=>!!e)),i.length>0&&this._sharedSettings.deleteSettings({store:this._settingsStore,keys:i})}}getPartSettingsAsync(){if(this._options.part.getCompositionType()===l.StartboardPart)return this.getStartboardPartIdentitySettings();const e=this.getIdentityPartSettingsAsync(),t=this.getSharedPartSettingsAsync();return Promise.all([e,t]).then((([e,t])=>$.extend(!0,{},e,t)))}registerInstanceStateProperty(e,t,s=!0){const{part:i}=this._options,o=this._getOrCreateInstanceStatePropertyBindings(),n=o.targetModel,r=i.getSettingsModel();this._registerViewModelPropertyChangeHandler(t,r,n,o,(()=>{i.save()}),e),s&&i.save()}savePart(){const e=this._options;e&&e.part.save()}dispose(){const e=this._partInstanceState;e&&(e.unbind(),this._partInstanceState=null);const t=this._identityState;t&&(t.unbind(),this._identityState=null);const s=this._sharedKey;s&&(s.unbind(),this._sharedKey=null)}getKeyForIdentitySettings(e){let t=null;const s=this._options,{part:i,partStateDefinition:o,identityInputs:n}=s,r=i.getInputPropertyBindings(),a=o&&o.inputIdentityProperties;if(i.allInputsSet()&&a&&a.length>0){let s="";n&&n.length>0&&(s=MsPortalFx.toSortedString(ko.toJS(r.targetModel),n)),t=g(i.locator,e,s)}return t}_registerPartIdentityStateChangeHandler(){const e=this._options,{part:t,partStateDefinition:s}=e,i=s&&s.inputIdentityProperties;i&&i.length>0&&(this._identityState=new c(t.toString()+"-[PartIdentitySettings]",{}),this._registerViewModelChangeHandler(i,this._identityState,(e=>{e.some((e=>{const t=h(e.propertyValue),s=h(e.propertyOldValue);return!MsPortalFx.deepEquals(t,s)}))&&this.saveIdentityPartSettings(t.containerModel)})))}_registerPartSharedKeyChangeHandler(){const e=this._options,{part:t,partStateDefinition:s}=e,i=s&&s.sharedProperties;if(i&&i.length>0){const e=i.map((e=>e.property)),s={};this._sharedKey=new c(t.toString()+"-[PartSharedSettings]",s),this._registerViewModelChangeHandler(e,this._sharedKey,(()=>{const e={};i.forEach((t=>{const i=o.getModelValue(s,t.property).value;e[t.key]=FxImpl.toSerializableObject(i)}));const t={store:5,settings:e};this._traceOperationWithSettings("Save shared part settings.",e),this._sharedSettings.setSettings(t)}))}}_registerPartInstanceChangedHandler(){const e=this._options,t=e.instanceProperties;if(t&&t.length>0){const s=this._getOrCreateInstanceStatePropertyBindings();this._registerViewModelChangeHandler(t,s,(t=>{e.part.save(),(e=>e.some((e=>"content.pollingOptions"===e.propertyName)))(t)&&e.part.notifySettingChanged()}))}}_registerViewModelChangeHandler(e,t,s){const i=t.targetModel,o=this._options.part.getSettingsModel();e.forEach((e=>{this._registerViewModelPropertyChangeHandler(e,o,i,t,s)}))}_registerViewModelPropertyChangeHandler(t,s,i,r,a,l){o.getModelValue(i,t).exists||o.setModelValue(i,t,ko.toJS(o.getModelValue(s,t).value));const c=r.addProperty(t).bind(this._options.partViewModelId,s,!1,a,(t=>{(0,n.logToExtension)(e,this._options.part.locator.getExtensionName(),2,"[PartState] Failed to bind changes from viewmodel to part state. Error: "+t)}));l&&l.registerForDispose((()=>{r.removeProperty(c)}))}getIdentityPartSettingsAsync(){const e=this._options,{partStateDefinition:t}=e,{containerModel:s}=e.part,i=t&&t.inputIdentityProperties;if(!(i&&i.length>0))return Promise.resolve(null);const o=this.getKeyForIdentitySettings(s),n={store:this._settingsStore,keys:[o]};return this._getPartSettingsAsync("Get identity part settings.",n,void 0).then((e=>{if(o===this.getKeyForIdentitySettings(s)){const t=this._identityState;return t&&$.extend(!0,t.targetModel,e),e}}))}getStartboardPartIdentitySettings(){const e=this._options,{part:t,partStateDefinition:s}=e,i=s&&s.inputIdentityProperties;if(!(i&&i.length>0))return Promise.resolve(null);let o=2&t.flags?[g(t.previousLocator,t.containerModel)]:[];return o=o.concat([this.getKeyForIdentitySettings(t.containerModel),g(t.locator,t.containerModel)]),this._getPartSettingsAsync("Get identity part settings.",{store:this._settingsStore,keys:o},void 0)}getSharedPartSettingsAsync(){const e=this._options,{partStateDefinition:t}=e,s=t&&t.sharedProperties;if(!(s&&s.length>0))return Promise.resolve(null);const i=[],o={};s.forEach((e=>{i.push(e.key),o[e.key]=e.property}));const n={store:5,keys:i};return this._getPartSettingsAsync("Get shared part settings.",n,o)}_traceOperationWithSettings(e,t,s){if(this._trace){if(s){const e={};e[s]=t,t=e}d.verbose("[PartSettingsManager] {0} Part: {1}.\nSettings: {2}".format(e,this._options.part.toString(),ko.toJSON(t,null,2)))}}_traceOperationWithKeys(e,t){this._trace&&d.verbose("[PartSettingsManager] {0} Part: {1}.\nKeys: {2}".format(e,this._options.part.toString(),ko.toJSON(t,null,2)))}_getPartSettingsAsync(e,t,s){this._traceOperationWithKeys("BEGIN - "+e,t.keys);const i=[this._sharedSettings.querySettings(t)];return Promise.all(i).then((i=>{const n={},r=i[0]||{};return t.keys.forEach((e=>{const t=r[e],i=FxImpl.isSerializedObject(t)?FxImpl.fromSerializableObject(t):t;s?void 0!==r[e]&&s[e]&&o.setModelValue(n,s[e],i):$.extend(!0,n,i)})),this._traceOperationWithSettings("END - "+e,n),n}))}_getOrCreateInstanceStatePropertyBindings(){if(!this._partInstanceState){const e=this._options.part;this._partInstanceState=new c(e.toString()+"-[PartInstanceState]",e.partState)}return this._partInstanceState}};t.PartSettingsManager=f=__decorate([__metadata("fx:diagnostics",[e,"PartSettingsManager"]),s.Class("composition"),__metadata("design:paramtypes",[r.SettingsManager])],f)})),
define("MsPortalImpl/UI/Compositions/UI.Composition.Part",["require","exports","MsPortalImpl/Parts/Parts.Error","MsPortalImpl/Parts/Parts.ReactFrame","Fx","Fx/DependencyInjection","FxInternal/Composition/ViewModel","FxInternal/AsyncLoader","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.Events","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Interactions/Interactions.PrintHandler","MsPortalImpl/Interactions/Interactions.FullScreenMode","MsPortalImpl/Parts/Parts","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/UI/UI.NavigationManager","FxInternal","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.Graph","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.Security","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/Base/Base.ElementWidgetMap","MsPortalImpl/Extension/ShellPart","FxInternal/Composition/Part","FxInternal/Composition/ViewModelComposer"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x,b,y,v,w,M,C,S,I,P,_,F,T,k,E,D,A,B,N,R,L,z,H,O,U,W,V,q,j){"use strict";t.Instance=t.EmptyViewModel=void 0,t.create=Ze,t.createCompositionFromJSON=We,t.createOverridesOrContainerModelSourceReference=function(e){return{property:e,modelType:lt,scope:le.CurrentContainer,cardinality:H.ReferenceCardinality.OneToOne}},t.fxpartsettingchanged=t.fxpartinputchanged=void 0,t.getSerializableContainerModel=Xe,t.inferredReferenceType=void 0,t.prepareContainerModel=Qe,t.setBladeOpenerModule=function(e){Ne[Be]=e},t.setDynamicPartBinderModule=function(e){Ne[Ae]=e};var G=MsPortalFx.Errors.Error,K=x.Locator,J=FxImpl.TelemetryContext,X=J.ContextType,Z=FxImpl.shellInterface,Y=MsPortalFx.Base.Diagnostics,ee=Y.Telemetry.ActionModifier,te=Y.Telemetry,se=MsPortalFx.Extension.SetRequirement,ie=MsPortalFx.Parts,oe=ie.PartKind,ne=ie.PartSize,re=k.CompositionType,ae=A.CompositionBinder,le=H.ReferenceScope,ce=H.PropertyBindings,de=E.compositionRequire;const{cancelOnDispose:pe}=MsPortalFx.Base.Promises,{CanceledError:ue,DisposedCanceledError:me,Error:ge}=MsPortalFx.Errors,he=window,fe=d.Asset,xe=MsPortalFx.isNullOrUndefined,be=Y.createLog(e),ye="fxs-part",ve=(e,t,s)=>{be.error(e+" "+"Part: '{0}'. Details: '{1}'.".format(t,JSON.stringify(s)))},we=D.PartContainerSelectable_ViewModelPath,Me=[we+".isSelected",we+".isCommandSelected"],Ce=te,Se="Shell",Ie=k.EditScopeIdPropertyName,Pe=ae.setupPropertyBindings,_e=K.forExtension,Fe=H.getModelValue,Te=ae.mapInputBindingDefinitions,ke=ae.createAllInputsSetWatcherConfigExtended,Ee=H.mapSourceModelToTargetModel,De={isActivated:!0,isSelected:!0,itemsWithChildEdits:!0,selectedValue:!0,activatedItems:!0,selectedItems:!0},Ae="./UI.Composition.DynamicPartBinder",Be="./UI.Composition.BladeOpener",Ne={},Re=30;function Le(e){return e&&e.toFriendlyString()}let ze=0;const He=t.fxpartsettingchanged="fxpartsettingchanged",Oe=t.EmptyViewModel=(0,q.composePartViewModel)(MsPortalFx.noop);t.fxpartinputchanged="fxpartinputchanged";var Ue;function We(e,t,s,i){try{return s()}catch(s){const o="Error deserializing composition.";let n,r;try{n=JSON.stringify(t)}catch(e){n="<Invalid> {0}".format(e.toString())}try{r=K.fromJSON(e,t.locator)}catch(e){r=K.forExtension(o+"-"+e)}const a="{0}\nJSON: {1}\nException Message: {2}\nException StackTrace: {3}".format(o,n,s.message||"<N/A>",s.stack||s.toString());return be.error(a),i(r,a)}}!function(e){e[e.OldInputsNotHandled=1]="OldInputsNotHandled",e[e.UnrecoverableError=2]="UnrecoverableError",e[e.CustomPartWithMissingTemplate=3]="CustomPartWithMissingTemplate",e[e.PartDefinitionNotFound=4]="PartDefinitionNotFound",e[e.IncorrectPartType=5]="IncorrectPartType",e[e.ErrorLocatingPartDefinition=6]="ErrorLocatingPartDefinition",e[e.ErrorAcquiringViewModel=7]="ErrorAcquiringViewModel",e[e.ViewModelMissing=8]="ViewModelMissing",e[e.ErrorLoadingControl=9]="ErrorLoadingControl",e[e.ErrorCreatingWidget=10]="ErrorCreatingWidget",e[e.TransitionedToErrorState=11]="TransitionedToErrorState"}(Ue||(Ue={}));class Ve extends E.Instance{constructor(e,t,s,i,o,n,r,a){super(n||"Part",e,t,[],s,i,a),this._pinnedBladeDeeplink=r,this.bindings=[],this.editScopeId=ko.observable(),this.invocationThrottleDuration=25,this.allInputsSet=ko.observable(!1),this.calledOnInputsSet=ko.observable(!1),this.failedOnInputsSet=ko.observable(!1),this.assetId=ko.observable(),this.triggeringLockedBladeSpinner=ko.observable(!1),this.contentRevealed=!1,this.fullReadyTime=ko.observable(),this._earlyVmDeferred=Promise.withResolvers(),this._viewStateProperties=[],this._partDefinitionDeferred=Promise.withResolvers(),this._registrationDeferred=Promise.withResolvers(),this._disabled=!1,this._restoredFromJson=!1,this._perfData={instanceExtensionLoad:0,referenceExtensionLoad:0,adapterViewModelLoad:0,partViewModelLoad:0,extenderViewModelLoad:0,checkPermissions:0,prepareViewModel:0,finalizePartCompose:0,allInputBindingsBoundPreprocess:0,allInputBindingsBound:0,srcExtension:"",contentRevealedCalled:!1,onInputsSetPromiseState:"",onInputsSetPromiseType:"",resourceId:void 0},this._showShellCommands=!0,this._allInputPropertyBindingsBound=Promise.withResolvers(),this._frameInitialized=Promise.withResolvers(),this._frameRevealed=Promise.withResolvers(),this._frameBlockingUi=ko.observable(!1),this._contentInitializing=ko.observable(!0),this._getPartViewModelCalledDeferred=Promise.withResolvers(),e.get(R.CompositionGraph).addPart(this),e.set(c.CompositionProvenance,new c.CompositionProvenance(t,this.id)),this._viewModelManager=e.get(u.ViewModelManager),this._finder=e.get(x.DefinitionFinder),this._setupPromises();const l=a||ze++;let d=0;(this._updateRebindSequenceNumber=()=>{this.instanceId=`Part_${MsPortalFx.sessionId}_${l}_${d++}`})(),this._vm=o||Oe,this.partState={},this.containerModel=null,this.overridesModel=Qe({},!1),this._registrationDeferred.promise.catch((e=>{this._allInputPropertyBindingsBound.reject(e)})),this._partSettingsManager=this.diContainer.get(L.PartSettingsManager)}getPartsContainer(){return this._partContainer||(this._partsContainer=this.diContainer.get(N.Finder).findPartsContainer(this)),this._partsContainer}shouldAlertOnClose(e){const t=this._getContainer();if(!t)return!1;const s=ko.utils.peekObservable(t.suppressAlert),i=ko.utils.peekObservable(t.configureAlert);return!s&&(i?i.showAlert:!!this.widget&&l.gatherFormFields(this.widget.element,e?.validateHidden).some((t=>{const s=t.viewmodel;return(s._msPortalFxViewModelValueChangesAreClean||s._msPortalFxOldControl&&!e?.legacyMode)&&s.dirty&&s.dirty()})))}getAlertMessage(){const e=this._getContainer(),t=ko.utils.peekObservable(e.configureAlert);return t&&t.showAlert?t.message:""}suppressAlert(){const e=this._getContainer();return!e||ko.utils.peekObservable(e.suppressAlert)}notifySettingChanged(){const e=this.widget;e&&e.element.trigger(He,{part:this,isUserInteraction:this.hasUserInteractedRecently()})}getViewModel(e,t){let s=Oe;const i=this.adapter;if(0===(e=e||0))s=this._vm;else if(4===e){const i=this._contextMenuViewModels;if(i)s=i.getViewModel(e,t);else{const e=this._getCommands(),i=k.findCommand(e,t,""+this);s=i&&i.getViewModel()||Oe}}else if(7===e)s=i&&i.viewModel;else if(9===e){const e=i&&i.inputPropertyBindings;s=e&&e.targetModel}else be.error(`Invalid model type '${e}' for part '${this.locator.toString()}'.`);return s}getViewModelAsync(e,t){return this._registrationDeferred.promise.then((()=>{if(4===e){const s=this._contextMenuViewModels;if(s)return s.getViewModelAsync(e,t);{const e=this._getCommands(),s=k.findCommand(e,t,""+this);return s&&s.getViewModelAsync()}}return this.getViewModel(e)}))}setViewModel(e){this._vm=e||Oe}setBladeOpener(e){this.registerForDispose(this._bladeOpener=e)}getBladeOpener(){return this._bladeOpener}get isDisabled(){return this._disabled}get canClone(){const e=this.isComposed,t=this.getInputPropertyBindings().allBound,s=this.partDefinition.partKind===Re;return e&&t&&!s}get eligibleForBinding(){return!this.containerModel}get templateKey(){let e=this.locator.toString();const t=this.containerModel;return t&&(e+="-"+MsPortalFx.toSortedString(ko.toJS(t))),e}get journeyPath(){return this.getPartsContainer().journeyPath.concat(this.templateKey)}get dirtyAndNotSaving(){return 1===this.diContainer.get(C.EditScopeManager).getStateObservable(this.editScopeId())()}get instanceDefinition(){return this._partInstanceDefinition}getCompositionType(){return re.Part}getPartSettingsManager(){return this._partSettingsManager}getPerfData(){return this._perfData}getSettingsModel(){let e,t=this._settingsModel;if(!t&&(e=this.getViewModel())){const s=r.isV2(e.content()),i=this.partDefinition,o=i&&i.partState,n=MsPortalFx.unique((o?(o.inputIdentityProperties||[]).concat((o.sharedProperties||[]).map((e=>e.property))):[]).concat(!s&&this._viewStateProperties||[]));this._settingsModel=t=MsPortalFx.clone(e),t.content=ko.observable({}),n.forEach((i=>{if(i.startsWith("content.")){const o=s?ko.observable():Fe(e,i).value;H.setModelValue(t,i,o)}}))}return t}hasUserInteractedRecently(){return!1}dispose(e){super.dispose(e),this._releaseResources(e),this._readyMarker&&J.usingState((()=>{qe(this)||Ce.trace({extension:pt(this),source:Se,action:"PartReady",actionModifier:ee.Cancel,name:Le(this.locator),data:this._perfData,journeyId:this._getTelemetryJourneyId()})}),this._creationState)}_setExtension(e){this.extension=e,this._partContainer&&this._partContainer.attr("data-extensionname",this.extension?this.extension.name:null)}resourceLTM(){return this._ltm||(this._ltm=this.widget.ltm.createChildLifetime())}_releaseResources(e){this._ltm&&this._ltm.dispose(),this._clearLoadingReactor();const t=this._inputBindings;t&&(t.unbind(),this._inputBindings=null);const s=this._part;s&&(s.dispose(),this._part=null);const i=this._vm;this.extension&&i&&i!==Oe&&this._viewModelManager.releaseViewModel(i,!0),this._releaseAdapter();const o=this._extenderVM,n=this._extenderVMExtn;o&&n&&this._viewModelManager.releaseViewModel(o),e||this._disposeEditScope(),this._journey=null,this._vm=Oe}_clearLoadingReactor(){const e=this._loadingReactorLifetime;e&&e.dispose()}_releaseAdapter(){const e=this.adapter;if(!e)return;e.inputPropertyBindings.unbind();const t=e.viewModel;t&&this._viewModelManager.releaseViewModel(t),this.adapter=null}_getContainer(){return Z(this.isDisposed()||!this._vm?{}:this._vm.container)}getInputPropertyBindings(){if(!this._inputBindings){const e={};this._inputBindings=new ce(tt(this),e,!1)}return this._inputBindings}getAssetId(){const e=this.assetInstanceDefinition;if(!(e&&e.assetIdInputProperty))return Promise.reject(0);const t=e=>{const t=it(this);t&&t.exists?e.resolve(ko.unwrap(t.value)):e.reject()},s=Q.defer(),i=this.adapter,o=i?i.allInputsSet:this.allInputsSet;return o()?t(s):o.subscribe(this,(e=>{e&&!s.promise.isFulfilled()&&t(s)})),s.promise}toJSON(){const e=super.toJSON();e.assetInstanceDefinition=this.assetInstanceDefinition,e.partState=FxImpl.toSerializableObject(this.partState||{}),e.initialSize=this.initialSize,e.bindingsInitialized=this._bindingsInitialized,e.savedContainerState=function(e){let t;if(e.isComposed){const s=e.getViewModel();if(s){const e=s.container;if(e){const s=e.partTitle&&e.partTitle(),i=e.assetName&&e.assetName();(s||i)&&(t={partTitle:s,assetName:i})}}}return t}(this),e.containerModel=Xe(this.containerModel,this.modelContainsSensitiveData),e.overridesModel=Xe(this.overridesModel,!1),e.originalPartLocator=this.previousLocator,e.flags=this.flags;const t=this.adapter,s=this.bindings;return e.adapterBindings=t&&t.bindings,e.bindings=t?s.filter((e=>e.source.scope===le.DetailsContainer)):s,e}cloneAs(e,t){let s;const i=this.widget?this.widget.options:null,o=[this.await(7),this.getInputPropertyBindings().awaitAllBound],n=this.adapter;return n&&o.push(n.inputPropertyBindings.awaitAllBound),Promise.all(o).then((()=>{const o=this.getNonDetailsContainerPropertyBindings(),n={};o.forEach((e=>{const t=Fe(e.targetModel,e.targetProperty).value;H.setModelValue(n,e.sourceProperty,ko.toJS(t))}));const r=ko.toJS(this.overridesModel);s=e(n,r),s.widgetState($.extend(!0,{},this.widgetState())),i&&i.size&&(s.initialSize=i.size(),s.initialSize===ne.Custom&&(s.initialWidth=i.gridWidth(),s.initialHeight=i.gridHeight()));const a=this._partSettingsManager;return a&&a.saveIdentityPartSettings(s.containerModel,t),s}))}clone(){return this.cloneAs(((e,t)=>Ze(this.diContainer,this.locator,null,e,t)))}static fromJSON(e,t){const s=e.get(m.ExtensionManagerOptions);return We(s,t,(()=>{const i=e.createChildContainer("composition"),o=new Ve(i,K.fromJSON(s,t.locator),t.widgetState,t.id);return o.registerForDispose((()=>i.disposeAsync())),o.loadPropertiesFromJson(s,t),o}),((s,i)=>{const o=e.createChildContainer("composition"),n=new Ve(o,s,null,t.id);return n.registerForDispose((()=>o.disposeAsync())),n.unrecoverableErrorMessage=i,n}))}getAssetInstanceMetadataAsync(){return this._registrationDeferred.promise.then((()=>{if(!this.isDisabled&&!this.isDisposed())return this.getAssetId().then((e=>({id:e,type:this.assetType}))).catch($.noop)}))}get assetType(){const e=this.assetInstanceDefinition;return e&&e.assetType}addWidgetToUI(e){const t=this.widget;e.skipDOMAttach||e.parentElement.addChild(t),t.addChild(this._partContainer)}recompose(e){this._compose(e,Promise.withResolvers(),!0)}_compose(e,t,s=!1,i){let o;const n=pt(this),r=Le(this.locator),a=(e,t,s,i)=>function(e,t,s,i,o,n){const r=fx.getTimestamp()-t,a=()=>(o&&(i=MsPortalFx.extend2(i,o.getTelemetryInfo())),te.trace({name:s.name,extension:s.extension,source:s.source,action:e,actionModifier:ee.Complete,data:i,duration:r,journeyId:s.journeyId}));return n?J.usingState(a,n):a()}(e,t,s,i,this._menu,this._creationState),l={extension:n,source:Se,name:r,journeyId:this._getTelemetryJourneyId()};this.calledOnInputsSet.subscribe(this,(e=>{e&&(this._onInputsSetResolvedMarker=fx.getTimestamp())})),this._allOnInputsSet.then((()=>{const e=this._readyMarker;if(e){qe(this)||a("PartReady",e,l,this._perfData),this._readyMarker=null}const t=this._onInputsSetResolvedMarker;t&&(this.fullReadyTime(fx.getTimestamp()-t),this._onInputsSetResolvedMarker=null)})),this.await(0).then((e=>{this._revealedMarker&&(this._perfData.contentRevealedCalled=e,this._revealedMarker=null)})),this._registrationDeferred.promise.then((()=>{t.resolve()}),(()=>{t.reject(),this._getPartViewModelCalledDeferred.reject()})),this._clearLoadingReactor(),this._ltm&&this._ltm.dispose();let c=this.widget;if(c&&s){this._partContainer=c.element.find("."+ye),o=c.options;const e=o.commands.splice(0,o.commands.length),t=!!MsPortalFx.find(e,(e=>e instanceof P.CustomizeTileData));e.forEach(MsPortalFx.disposeDisposable),t&&o.commands.push(new P.CustomizeTileData(this,this.diContainer)),o.actionBarViewModel.update(),this._ltm=c.ltm.createChildLifetime()}else this._partContainer=$(FxImpl.createElement("div",{class:ye})),i?(o=i.options,c=this.widget=i):(o=this.createTileViewModel(e.options.locked()),c=this.widget=S.createTileWidget($(FxImpl.createElement("div")),o,this.diContainer,!1,(()=>this._getActions()))),this.widgetState(c.saveViewSettings()),this._ltm=c.ltm.createChildLifetime(),this.addWidgetToUI({parentElement:e,doNotSaveSettings:!0,skipDOMAttach:!!i});const d=c.element,p=this._ltm;if(e.options.locked()||o.isInBlockingLoadingState(!0),d.data(k.CompositionInstanceDataName,this),p.registerForDispose(d.setEvents(["fxregistermenu",(e,t)=>{this._menu=t}])),this._loadedMarker=fx.getTimestamp(),this._readyMarker=fx.getTimestamp(),this._revealedMarker=fx.getTimestamp(),this.unrecoverableErrorMessage&&this.unrecoverableErrorMessage.length>0)this._partDefinitionDeferred.reject(this.unrecoverableErrorMessage),this._createErrorPart(Ue.UnrecoverableError,this.unrecoverableErrorMessage);else{this._locateDefinitionAndStartCompose(p,o),this._perfData.srcExtension=function(e,t){const s=e.locator,i=e.extension,o=s&&s.getExtensionName(),n=i&&i.name;if(o!==t)return o;if(n!==t)return n;return}(this,n),this._perfData.resourceId=this.assetId();const t=this.createChildLifetime();e.options.locked.subscribeAndRun(t,(e=>{(0,B.composeShellCommands)(t,this,o.commands,this._showShellCommands=!e,this.diContainer)}))}}createTileViewModel(e){const t=new S.ViewModel(this.id,this.widgetState());return t.inLockedContext=e,void 0===t.size()&&t.size(this.initialSize),this.initialSize===ne.Custom&&(t.gridWidth(Math.max(1,this.initialWidth)),t.gridHeight(Math.max(1,this.initialHeight))),t}async generateBindings(e){const[t,s]=await Promise.all([(async()=>{const e=await this._finder.locateAsync(this.locator);return this._processLocatedDefinitionAsync(e)})(),rt()]);if(!e.isDisposed()&&t)return this._generateAndSaveBindings(t)}async _locateDefinitionAndStartCompose(e,t){const s=(0,o.startTimer)();let i;const n=rt();try{const r=await this._finder.locateAsync(this.locator);this._perfData.instanceExtensionLoad=s(),i=(0,o.startTimer)();const a=await this._processLocatedDefinitionAsync(r);if(await n,e.isDisposed())return;this._perfData.referenceExtensionLoad=i(),a?(await this._generateAndSaveBindings(a),this.partDefinition=a,this._partDefinitionDeferred.resolve(a),!function(e,t){const s=e.partDefinition;return s&&s.partKind===oe.Custom&&s.htmlTemplate&&!t.tryLocate(e.locator.getExtensionLocator().withHtmlTemplate(s.htmlTemplate),{})}(this,this._finder)?await this._composeCommandsAndPart(t,this._partContainer):await this._createErrorPart(Ue.CustomPartWithMissingTemplate,d.UiCompositionPart.missingTemplateMessage)):await this._createErrorPart(Ue.PartDefinitionNotFound,`Unable to find the definition for the part. Locator: ${this.locator}.`),e.isDisposed()||this._contentInitializing.fxAwaitAndRun(e,(e=>!e)).then((()=>{this._part&&this._vm.container.width.subscribeAndRun(e,this._part.onSizeChange)}))}catch(t){this._partDefinitionDeferred.reject(t),e.isDisposed()||await this._createErrorPart(Ue.ErrorLocatingPartDefinition,t)}}getInstanceBindings(){const e=this._partInstanceDefinition;if(e)return e.inline?e.inline.bindings:e.reference.bindings}async _generateAndSaveBindings(e){if(this._isRestoredPartLackingBinding(e))if(this.eligibleForBinding)this._bindingsInitialized=!1,this.bindings=[];else if(!e.canUseOldInputVersions)return be.warning(`[Definition Change] Bindings for part '${this}' have been changed in the definition in an incompatible way.`),void await this._createErrorPart(Ue.OldInputsNotHandled,`Bindings for part have been changed in the definition in an incompatible way. Locator: ${this.locator}.`);const t=this.adapter;if(this._restoredFromJson&&!1!==this._bindingsInitialized){const s=t?t.bindings:this.bindings,i=t?t.inputDefinitions:e.inputDefinitions,o=at().inferInitialBindingsForInputDefinitions(this,i).filter((e=>s.every((t=>t.targetProperty!==e.targetProperty))));return[].push.apply(s,o),s}{t?t.bindings=this._constructAdaptedBindings():this._setBindings(e),this.assetInstanceDefinition={assetType:e.assetType,assetIdInputProperty:e.assetIdInputProperty},t&&((t.assetType||t.adaptedPart.assetType)&&(this.assetInstanceDefinition.assetType=t.assetType||t.adaptedPart.assetType),t.assetIdInputProperty&&(this.assetInstanceDefinition.assetIdInputProperty=t.assetIdInputProperty));const s=this._partInstanceDefinition,i=s&&s.reference;return i&&i.assetType&&(this.assetInstanceDefinition.assetType=i.assetType),this._bindingsInitialized=!0,this.save(),t?t.bindings:this.bindings}}_setBindings(e){const t=function(e,t){const s={};e&&t&&(t.forEach((e=>{e.isIdentityInput&&e.property&&(s[e.property]=!0)})),e.forEach((e=>{e.isIdentityInput=!!s[e.property]})));if(e&&t){const s=e.slice(0);return t.forEach((t=>{const i=t.valuesFrom;i&&i.length&&5===i[0].referenceType&&(e.some((e=>e.property===t.property))||s.push(t))})),s}return e||t||[]}(this.getInstanceBindings(),e.bindings);if(function(e,t){const s=[],i=ae.validateInputBindings(e,t,s);s.length&&be.error(`${s[0]} Part:'${e}'.`);return i}(this,t)&&(this.bindings=this.bindings.concat(Te(t,this))),this.bindings.length<=0&&6===this.locator.type){const t=at();this.bindings=this.bindings.concat(t.inferInitialBindingsForInputDefinitions(this,e.inputDefinitions))}}_constructAdaptedBindings(){const e=this.adapter;if(e.bindings.length<=0&&6===this.locator.type){return at().inferInitialBindingsForInputDefinitions(this,e.inputDefinitions)}return Te(e.adaptedPart.bindings,this)}_isRestoredPartLackingBinding(e){if(this._restoredFromJson){const t=this.adapter,s=t?this._constructAdaptedBindings():Te(e.bindings||[],this),i=t?t.bindings:this.bindings,o=e=>!e.optional&&MsPortalFx.findIndex(i,(t=>t.targetProperty===e.targetProperty))<0;return!!s.some(o)}return!1}_getActions(){const e=this.diContainer,t=[];return this.getCompositionType()===re.StartboardPart&&t.push(new P.UnpinFromStartboard(this,e).createAction(this)),t.push(new P.OpenContextMenu(this,e,d.ContextMenu.ariaLabel).createAction(this)),t}resetLayout(){const e=this.initialSize,t=z.AllSizes[e>=0?e:z.getDefaultSize().name].size,s=this.widget;s.element.trigger("fxsizechange",[s.options.id,t.width,t.height])}clearIdentitySettings(){const e=this._partSettingsManager;e&&e.clearIdentityPartSettings()}async _processLocatedDefinitionAsync(e){const t=this._finder;let s,i=e;switch(this.locator.type){case 5:case 7:this._partInstanceDefinition=e;break;case 6:s=e,s&&s.reference&&(this._partInstanceDefinition={reference:{partTypeName:s.name,bindings:s.bindings,assetType:s.assetType,initialSize:s.initialSize}})}const o=this._partInstanceDefinition;if(o){if(o.reference){const e=o.reference.extension||this.locator.getExtensionName(),s=_e(e),i=s.withPartType(o.reference.partTypeName),n=await t.locateAsync(s);this._setExtension(n);const r=await t.locateAsync(i);return r?.reference?this._processAdapterAsync(r,e):r}i=o.inline}return this.initialSize===ne.Custom&&(this.initialWidth=i.initialWidth,this.initialHeight=i.initialHeight),this._setExtension(t.locate(this.locator.getExtensionLocator())),i}async _processAdapterAsync(e,t){const s=_e(e.reference.extension||t),i=s.withPartType(e.reference.partTypeName),o=this._finder,n=await o.locateAsync(s),r=`${this} (AdapterPart. Extension: ${this.extension.name}, ViewModel: ${e.viewModel})`;this.adapter={extension:this.extension,viewModel:null,viewModelLocator:e.viewModelLocator,viewModelName:e.viewModel,viewModelId:r,bindings:this._adapterBindings||[],inputDefinitions:e.inputDefinitions,adaptedPart:this._partInstanceDefinition.reference,allInputsSet:ko.observable(!1),calledOnInputsSet:ko.observable(!1),failedOnInputsSet:ko.observable(!1),inputPropertyBindings:new ce(r,{},!1),assetType:e.assetType,assetIdInputProperty:e.assetIdInputProperty},this._partInstanceDefinition={name:this._partInstanceDefinition.name,reference:e.reference};const a=this.adapter.adaptedPart.assetType;a&&(this._partInstanceDefinition.reference.assetType=a),this._setExtension(n);const l=await o.locateAsync(i);if(l?.reference){const s="Error processing the part defintion for part '{0}'. Adapted part definition '{0}:{1}' cannot reference another adapted part definition '{2}:{3}'.".format(this,this.adapter.extension.name,e.reference.partTypeName,l.reference.extension||t,l.reference.partTypeName);throw be.error(s),FxImpl.createError(s)}return this._setBindings(l),"HubsExtension"===this.extension.name&&"MonitorChartPart"===l.name&&this.bindings.forEach((e=>{e.optional=!0})),l}getTitle(){return this.getViewModel()?.container?.partTitle?.()||""}getPartAriaLabel(){return this.getViewModel()?.container?.ariaLabel?.()||""}disableForAssetDeleted(e,t){this._disabled=!0;const s=this._vm;s&&s.container&&this._vm.container.notFoundMessage({message:fe.deletedTitle});const i=this.widget;if(i&&i.options){const e=i.options.commands;e.splice(0,e.length,new P.UnpinFromStartboard(this,this.diContainer)).forEach(MsPortalFx.disposeDisposable)}this.save(),be.warning("Part '{0}' disabled because asset was deleted. {1}".format(this,t))}async _composeCommandsAndPart(e,t){await(0,B.composeCommands)(e.commands,this),this._composePart(t,e),this._attachEventHandlers(t)}_attachEventHandlers(e){this.resourceLTM().registerForDispose(this.widget.element.setEvents([I.Widget.viewSettingsChanged,(e,t)=>{this.widgetState(t),this.save(),e.stopPropagation()}],["fxsizechanged",(t,s)=>{const i=this.widget.options,o=!!ie.PartSize[s];s=o?s:i.size(),et(this._vm,e,i,s,o,this.partDefinition),this.widgetState(this.widget.saveViewSettings())}],["rightclick",(e,t)=>{this._handleRightClick(e,t)}],["fxensurebladevisible",(e,t)=>{t.masterPartId=this.id}],[p.fxpinmultipleparts,(e,t)=>{e.stopPropagation();const s=this.locator.getExtensionLocator();this.diContainer.get(U.PinTilesPortalFunc).invoke({partReferences:t.partReferences,originExtension:s.name,notify:!0},Se)}]))}_getPartContext(){const e=$e(this)||{},t=this.getPartsContainer(),s=!MsPortalFx.isEmpty(e),i=t&&t.getCompositionType()===re.Startboard;return{id:Le(this.locator),instanceId:this.instanceId,bladeId:Le(e.locator),bladeInstanceId:e.instanceId,onBlade:s,onStartBoard:i,bladeCustomized:!1}}_getPartViewModelAsync(t,s,i,l,d,p,u){const m=this.parent&&this.getPartsContainer(),g=function(t,s){const i=s&&(s.diContainer||n.container)?.get(N.Finder).findParentMenuBlade(s);return i&&{hasMenuItem:e=>Ke(t,i).then((t=>t?.hasMenuItem(e)??!1)),switchItem:(e,s)=>Ke(t,i).then((t=>{t?.switchItem(e,s)})),internalGetAndSelectItem:s=>pe(t,MsPortalFx.require("../../../MsPortalImpl.Controls/Controls/Lists/Menu",e)).then((e=>{const t=i.widget.element.find(".fxc-menu"),o=t.length?(W.getAllMatch(t[0],e.Widget)||[])[0]:i.getMenuWidget();return o?o.internalGetAndSelectItem(s):Promise.resolve(null)}))}}(this,$e(this)),h=D.needContainerSelectable(this.partDefinition.details),f=(0,o.startTimer)();J.provideContext((()=>{this._creationState=J.getState()}),X.Part,this._getPartContext());const x=p&&(e=>{e&&!e.chrome&&e.content()&&p(e)}),w=T.tryImmediateResolve(qe(this)?T.tryImmediateResolve($e(this).tryGetVirtualPartViewModel(),(e=>(e&&x&&x(e),e))):Q(null),(e=>{if(this._getPartViewModelCalledDeferred.resolve(void 0),e)return e;const o=Je(this),n=m&&m.bladeDefinition,r=(0,j.getViewModelType)(t,qe(this)&&n);let a;a=m&&1&m.flags?1:0,a|=je(this)?2:0,a|=g?4:0,a|=m&&256&m.flags?16:0,a|=m&&512&m.flags?32:0;const l=!dt(this.partDefinition)&&function(e,t){if(z.isFixedSize(e.size()))return Ye(e);{let e=0,s=0;return 2===t.partLocation&&(e=he.innerHeight-113,s=he.innerWidth-(t.inMenuBlade?265:0)-1),{height:e,width:s}}}(u,{partLocation:o,inMenuBlade:!!g});return J.usingState((()=>this._viewModelManager.getPartViewModel(4&n?.attributes?n.dxView.runtimeExtension:this.extension.name,t,r,{createSelectable:h,partSize:s,contentSize:l,partLocation:o,collapsed:i,onInputsSetParameters:d,onViewModelAcquired:x,locator:this.locator,flags:a,menuId:m&&m.defaultMenuItemId,bladeName:n?.name})),this._creationState)}));return w.then(this._earlyVmDeferred.resolve,this._earlyVmDeferred.reject),w.then((t=>{let s,i;if(t&&t.chrome?(i=MsPortalFx.cloneAndRebindFunctions(t),i.content=ko.observable(r.markAsV2(t.chrome)),s=t.content.fxAwaitAndRun(this).then((e=>(p&&p(t),t))),this._setupLoadingReactor(u,t.container.operations)):s=Promise.resolve(i=t),qe(this)){const e=$e(this);e.setViewModelForTemplateOrMenuBlade(i),e.setInputsSetPromise(this._allOnInputsSet)}const n=t&&Z(t.container);let l;return n&&(n.requestOpenBlade((async(e,t)=>(await this.diContainer.getAsync(a.get("MsPortalImpl/UI/UI.BladeOpenerImpl","BladeOpener"))).requestOpenBlade(e,void 0,t))),n.closeBlade(function(e){const t=e.diContainer.get(_.JourneyManager),s=t.tryCloseBlade.bind(t),i=e.getPartsContainer();return(t,o)=>{switch(t){case 1:case 2:{const o=e.diContainer.get(N.Finder).findBlades(i).filter((s=>{const i=!!(1&s.flags);return Ge(e,s)&&1===t?!i:i}));return 0!==o.length&&!o.some((e=>!s(e)))}default:{let e=i;const t=i.masterContainer,n=t&&t.bladeDefinition;return n&&n.menuBlade&&(e=t),e.returnValue=o,s(e,2)}}}}(this)),n.menu(g),n.openDialog(((e,s)=>a.get("MsPortalImpl/UI/Compositions/UI.Composition.Part.Dialog","openDialog").then((i=>i(this,t,e,s,this._contentInitializing,$e(this),je(this)))))),n.setFocus((e=>this._contentInitializing.fxAwaitAndRun(this,(e=>!1===e)).then((()=>this._part.setFocus(e))))),n.print((()=>{const e=$e(this).containerWidget;this.diContainer.get(y.PrintHandler).printBlade(e.element[0],{name:e.getContentWidget().options.getTelemetryName(),source:"ExtensionCall",menuBladeCtx:e.options.isMenuBlade.peek()?e.options.getTelemetryName():null})})),n.executeInCloudShell((async(t,...s)=>{if(!(0,o.isFeatureEnabled)("azureconsole"))return(0,c.logToExtension)(e,pt(this),1,"Azure Console feature is not enabled in this environment."),!1;const i=$e(this).getTelemetryContextState();try{return(await this.diContainer.getAsync(a.get("MsPortalImpl/UI/UI.AzureConsole","AzureConsole"))).executeInCloudShell({options:t,commands:s},i)}catch(e){return be.error(FxImpl.createError("Failed to execute in CloudShell",{innerErrors:e})),!1}})),n.toggleFullScreen((()=>{this.diContainer.get(v.FullScreenMode).toggle()})),n.openHelpPane((async e=>{(await this.diContainer.getAsync(a.get("MsPortalImpl/UI/UI.HelpPane","HelpPane"))).open(e,this.getCreationState())}))),t&&t.container&&t.container._msPortalFxAnnounce((e=>{l||(l=new b.PortalReader(this._ltm,{idPrefix:this.locator.name})),l.read(e)})),s})).then((e=>{const t=this._finder,s=t.locate(this.locator),i=(0,o.startTimer)(),n=e&&e.content();return d&&ae.notifyOnInputsSetCalled(l,d,e&&e.onInputsSetPromise&&Promise.resolve(e.onInputsSetPromise)),s&&s.reference&&(s.reference.extenderViewModelLocator||s.reference.extenderViewModel)?(this._extenderVMExtn=t.locate(this.locator.getExtensionLocator(),this.extension.name),this._viewModelManager.getViewModel(this._extenderVMExtn.name,s.reference.extenderViewModelLocator||s.reference.extenderViewModel,9).then((t=>{const i=s.reference.extenderViewModelLocator?s.reference.extenderViewModelLocator.name:s.reference.extenderViewModel;return t&&t.content()?n&&ko.isObservable(n.extenderViewModel)?(this._extenderVM=t,n.extenderViewModel(t.content())):be.error(`Part '${this}' defines extender view model '${i}' but the referenced part is not marked as extensible.`):be.error(`Extender view model '${i}' for part '${this}' must be an object.`),e})).finally((()=>{this._perfData.extenderViewModelLoad=i()}))):e})).finally((()=>{this._perfData.partViewModelLoad=f()}))}_getAdapterViewModelAsync(){if(!this.adapter)return Promise.resolve(null);st(this);const e=ke(this._getAdapterAllInputsSetWatcherConfig()),t=ae.loadOnInputsSetParameters(e),s=this.adapter;return t.then((t=>{this._earlyAdapterOnInputsSet=!!t,this._perfData.earlyOnInputsSetAdapter=this._earlyAdapterOnInputsSet;const i=(0,o.startTimer)();return this._viewModelManager.getViewModel(s.extension.name,s.viewModelLocator||s.viewModelName,10,{onInputsSetParameters:t}).then((i=>(s.viewModel=i,t&&ae.notifyOnInputsSetCalled(e,t,i&&i.onInputsSetPromise),e))).finally((()=>{this._perfData.adapterViewModelLoad=i()}))}))}_bindAssetNameFromAdapter(){const e=this.adapter;if(!e)return;const t=Fe(e.viewModel,"content.assetName");let s;t.exists&&(ko.isObservable(t.value)?(s=t.value,ko.computed(this,(()=>{const e=s(),t=this._vm;!xe(e)&&t&&t.container&&H.setModelValue(t,"container.assetName",e)}))):be.error("Failed to bind the asset name from the adapter view model for Part '{0}', because the asset name needs to be an observable.".format(e.viewModelId)))}_composePart(e,t){if(this.isDisposed())return;const s=this.locator,i=this.partDefinition,n=i.partKind,a=w.getPartFactory(this._finder,s,i);let l,c,p;if(a){1!==i.resizeMode?t.supportedSizes(a.supportedSizes):t.supportedSizes([]),this._inputBindings=null,this.getInputPropertyBindings();const n=this._getAdapterViewModelAsync(),p=this._finder.locate(s),u=p&&p.reference&&p.reference.extenderViewModel,m=this.bindings||[],g=m.some((e=>e.source&&e.source.scope===le.DetailsContainer)),h=this.adapter&&m.some((e=>e.source&&7===e.source.modelType));if(u||g)c=Promise.resolve(null);else{const e=()=>this.isDisposed()?Promise.resolve(null):(this._registerInputPropertyBindings(),l=ke(this._getAllInputsSetWatcherConfig()),ae.loadOnInputsSetParameters(l));c=h?n.then(e):e()}let f;c=function(e){const t=nt(Be);return T.tryImmediateResolve(t,(()=>e))}(c),this._vmPromise=T.tryImmediateResolve(c,(e=>{if(this.isDisposed())return this._releaseResources(),Promise.reject(new me);this._earlyOnInputsSet=!!e,this._perfData.earlyOnInputsSetPart=this._earlyOnInputsSet;const s=this.partDefinition,i=s.partKind===Re?this._getSummaryPartViewModelState():null;f=t?t.size():this.initialSize;const o=this._getPartViewModelAsync(s.viewModelLocator||s.viewModel,f,i,l,e,l&&(e=>this._setupInvocationProperties(a.viewStateProperties,e)),t).then((e=>(0,B.composePartCommands)(t.commands,this.resourceLTM(),this).then((()=>e))));return Promise.all([o,n])})).then((([s,n])=>{const c=(0,o.startTimer)();if(this.setViewModel(s),this.isDisposed())return this._releaseResources(),Promise.reject(new me);if(s){if(!this.isDisabled){this._bindAssetNameFromAdapter(),this.resourceLTM().registerForDispose(this.widget.element.setEvents(["fxportalcontrolloadfailed",(e,t)=>{this._createErrorPart(Ue.ErrorLoadingControl,t)}]));const o=t?t.size():this.initialSize,d=o!==f,p=!1;et(this._vm,e,t,o,d,this.partDefinition),r.isV2(s.content())||this._setupLoadingReactor(t,s.container.operations),t.userResizable(this.getCompositionType()===re.StartboardPart&&2===i.resizeMode),t.actionBarViewModel.partTitle(this.getTitle()||"Untitled"),t.actionBarViewModel.ariaLabel(this.getPartAriaLabel()),d?this.extension.processMessages().finally((()=>{this.isDisposed()||this._setupPartWidget(e,a,l,n,p,c)})):this._setupPartWidget(e,a,l,n,p,c)}}else this._createErrorPart(Ue.ViewModelMissing,d.UiCompositionPart.viewModelRequired)})).catch((e=>{if(this.isDisposed()||MsPortalFx.Errors.isInstanceOfErrorType(e,MsPortalFx.Errors.CanceledError))return Promise.reject(new me);this._createErrorPart(Ue.ErrorAcquiringViewModel,e)}))}else n!==oe.Provisioning&&(p="Incorrect part type '{0}'.".format(n),this._createErrorPart(Ue.IncorrectPartType,p))}_setupPartWidget(e,t,s,i,n,r){const a=this.widget,l=this.getViewModel();this._perfData.prepareViewModel=r();const c=(0,o.startTimer)();h.setSelectableContext(this,l,e),T.tryImmediateResolve(this._createPartWidget(t,l,n),(()=>{if(this.isDisposed())return Promise.reject(new me);et(l,e,a.options,a.options.size(),!1,this.partDefinition),this.register(t.viewStateProperties,s,i),function(e){const t=e.adapter,s=t?t.allInputsSet:e.allInputsSet;ko.computed(e,(()=>{if(s()){const t=it(e);t&&t.exists&&e.assetId(ko.unwrap(t.value))}}))}(this),this._ensureAssetAffinity(),this._perfData.finalizePartCompose=c();if(1===this.partDefinition.resizeMode){const e=this.extension&&this.extension.name;if("AppInsightsExtension"!==e&&"SamplesExtension"!==e)return;Z(this._vm.container).resize.subscribe(this,(e=>{if(!e||!e.width||!e.height)return;const t=z.getGridPixelSize(e.width,e.height);this.widget.element.trigger("fxsizechange",[a.options.id,t.width,t.height])}))}}),(e=>{this._createErrorPart(Ue.ErrorCreatingWidget,e)}))}register(t,s,i){const n=this.parent&&this.getPartsContainer();this._removeOutputArgumentValuesFromContainerModel(),(this.bindings||[]).forEach((e=>{const t=e.source.modelType;this._hasRebindableInputs||e.source.scope!==le.CurrentContainer||1!==t&&7!==t&&9!==t||(this._hasRebindableInputs=!0)})),this._listenForPartMutation(),this.adapter&&!i&&st(this),s||(this._registerInputPropertyBindings(),this._setupInvocationProperties(t,this._vm)),this._partSettingsManager.configureInstanceProperties(this._viewStateProperties),this._partSettingsManager.initialize(),dt(this.partDefinition)||de(this,"./UI.Composition.SelectableRegistration",(e=>{e.listenForRegistrationChanges(this,this._vm,this)}),e),de(this,"./UI.Composition.Selectable2Registrar",(e=>{e.registerSelectables(this,this._vm,this,!dt(this.partDefinition)||this.partDefinition.isMenuBlade)}),e);const r=this.getInputPropertyBindings();this._setupBladeRebindingHandlers(n);const a=(0,o.startTimer)();this.save(),s||(s=ke(this._getAllInputsSetWatcherConfig())),s.bindableTarget.viewModel=this._vm,this._setContainerInputsChanging=(e,t)=>{if(!e)return t?ae.turnOnInputsSetSuppressionOff(s,t):ae.turnOnInputsSetSuppressionOff(s);ae.turnOnInputsSetSuppressionOn(s)},ae.setupAllInputsSetWatcherFromExtendedConfig(s),this.adapter&&(i||(i=ke(this._getAdapterAllInputsSetWatcherConfig())),i.bindableTarget.viewModel=this.adapter.viewModel,ae.setupAllInputsSetWatcherFromExtendedConfig(i)),rt().then((e=>{e.listenForConfigurationChanges(this,i,s)}));const l=()=>{this._finishCompose(n,r,a)};qe(this)||(0,V.isShellPart)(this.locator)?l():this.extension.processMessages().finally(l)}_finishCompose(e,t,s){if(!this.isDisabled&&!this.isDisposed()){e&&e.notifyPartComposed(this),this._registrationDeferred.resolve();const i=[t.awaitAllBound];this.adapter&&i.push(this.adapter.inputPropertyBindings.awaitAllBound);const o=s(),n=this._allInputPropertyBindingsBound;Promise.all(i).then((()=>{const e=this._perfData;n.resolve(void 0),e.allInputBindingsBoundPreprocess=o,e.allInputBindingsBound=s(),this._loadedMarker&&(this.adapter&&$.extend(e,{innerPart:{extension:this.extension.name,name:this.partDefinition.name}}),this.compositionTime=fx.getTimestamp()-this._loadedMarker,this._loadedMarker=null)})).catch((()=>{n.reject()})),this.save()}}_registerInputPropertyBindings(){const e=[],t=[],s=[];this._journey=this.diContainer.get(_.JourneyManager).activeJourney(),(this.bindings||[]).forEach((i=>{i.source.scope===le.DetailsContainer?s.push(i):t.push(i),i.isIdentityInput&&e.push(i.targetProperty)})),this._partSettingsManager.configure(this._getPartSettingsManagerConfig(e,this._viewStateProperties));const i=this.getInputPropertyBindings();Pe(this.diContainer,this,i,s),Pe(this.diContainer,this,i,t,(e=>this.adapter?this.adapter?this.bindAdaptedInput(e):void 0:this.bindAgainstOverridesOrContainerModel(e))),this._setEditScope(),this._setupJourneyEditScopeReactor()}bindAdaptedInput(e){const t=e.source;switch(t&&t.modelType){case 7:return{sourceModel:this.adapter.viewModel,sourceModelName:this+"-[Adapter]"};case 9:return{sourceModel:this.adapter.inputPropertyBindings.targetModel,sourceModelName:this+"-[AdapterInputs]"}}}getNonDetailsContainerPropertyBindings(e=!0){const t=this.adapter;return(e&&t?t.inputPropertyBindings:this.getInputPropertyBindings()).properties.filter((e=>{const t=e.compositionBindingDefinition;return(t&&t.source&&t.source.scope)!==le.DetailsContainer}))}bindAgainstOverridesOrContainerModel(e){if(e.source.id!==this.id){if(H.isDynamicBindingWithNonLocalSource(e))return null;const t=e.source.property,s=this.overridesModel;if(Fe(s,t).exists)return{overridesConstantBindings:!0,sourceModelName:this+"-[OverridesModel]",sourceModel:s};const i=this.containerModel;if(i&&Fe(i,t).exists)return{sourceModelName:this+"-[ContainerModel]",sourceModel:i};if(H.isOverridesOrContainerModelSourceReference(e.source)){const e={};return H.setModelValue(e,t,void 0),{sourceModelName:this+"-[Inferred]",sourceModel:e}}}}_setupInvocationProperties(e,t){const s=this.partDefinition;if(this._vm=t,!this._vm||this.isDisposed()||this.isDisabled)return;this._setViewStateProperties(s.viewStateProperties,e);const i=Ne[Be],o=this.diContainer.createChildContainer("composition");o.set(D.OpenerConfiguration,this._getBladeOpenerConfig()),this.setBladeOpener(o.get(i.BladeOpener)),this.registerForDispose((()=>o.disposeAsync())),function(e,t,s){let i=!!t;t&&(t.assetType&&!t.assetIdInputProperty?(be.error(`'assetIdProperty' is required if 'assetType' is defined on part definition. Locator:'${e.locator}'.`),i=!1):!s&&t.editScopeType&&e.bindings&&e.bindings.some((e=>e.targetProperty===Ie))&&(i=!1,be.error(`Declaring an 'editScopeType' and an input binding with '${Ie}' as a target property is not supported. A part cannot be the owner of an edit scope and also receive an edit scope id from an external source. Part: '${e}'. Bindings: ${JSON.stringify(e.bindings)}.`)));return i}(this,this.partDefinition,this._restoredFromJson)&&s.details&&s.details.length&&(s.details.forEach((e=>{(function(e,t){const s=[];let i=!0;t&&t.invocationInputArguments&&t.invocationInputArguments.length&&(i=D.validateDetailsDefinition(t,s));s.length&&ve(s[0],e.toString(),t);return i})(this,e)&&this._registerInvocationProperty(e)})),this.resourceLTM().registerForDispose(this.widget.element.setEvents(["fxopeninnewtab",(e,t)=>{const s=t.selectable,i=D.getAssociatedDetailDefinition(s||t.selectableSet,this.getViewModel(),this.partDefinition);if(i){const e=s?s.selectedValue():(0,B.createSelection)(t.selectableSet,t.item),o=Q(e).then((e=>{const t=this._bladeOpener.createBladeModelForSelectedItem(i,e),s=t&&t.locator;return s?(0,g.getBladeDeepLink)(s.getExtensionName(),s.name,t.model,{baseUri:he.location.href}):null}));this.diContainer.get(F.WindowManager).openWindow(o)}}])))}getSelectableAsync(e){return this.getViewModelAsync().then((t=>{const s="string"==typeof e?e:D.getSelectablePath(e),i=Fe(t,s);if(i.exists)return ko.unwrap(i.value)}))}_getBladeOpenerConfig(){return{diContainer:this.diContainer,masterModelId:tt(this),masterModel:this.getViewModel(),referenceComposition:this,referenceExtension:this.extension,invocationThrottleDuration:this.invocationThrottleDuration,isBladeOpenedByMaster:e=>Ge(this,e),onBladeOpened:MsPortalFx.noop,addOutputBindings:(e,t)=>{!function(e,t,s){const i=e.getInputPropertyBindings();(s||[]).forEach((s=>{MsPortalFx.find(i.properties,(e=>{const i=e.compositionBindingDefinition;return e.sourceProperty===s.source.property&&i&&i.source&&i.source.id===t.id}))||(Pe(e.diContainer,e,i,[s]),s.source.id=t.id,e.bindings.push(s),e.save())}))}(this,e,t)},removeOutputBindings:e=>{!function(e,t){const s=e.getInputPropertyBindings(),i=e.bindings||[],o=i.filter((e=>e.source.scope!==le.DetailsContainer));o.length!==i.length&&(s.properties.filter((e=>{const s=e.compositionBindingDefinition;return s&&s.source&&s.source.id===t.id})).forEach((e=>{s.removeProperty(e)})),e.bindings=o,e.save())}(this,e)},configureBladeDescriptor:e=>{e.masterPartId=this.id,e.bindings&&e.bindings.forEach((t=>{t.source&&t.source.id===this.id&&(e.model[t.targetProperty]=ko.toJS(Fe(this._vm,t.source.property).value))}))}}}loadState(e){this.partDefinition&&e&&this._vm&&this._vm!==Oe&&this._viewStateProperties.forEach((t=>{const s=Fe(e,t);s.exists&&!t.startsWith("internal.")&&H.setModelValue(this._vm,t,s.value)}))}_setupLoadingReactor(e,t){if(this.partDefinition.partKind!==oe.Provisioning){this._frameBlockingUi(ct(this.partDefinition)),this._loadingReactorLifetime=this.createChildLifetime(),ko.reactor(this._loadingReactorLifetime,(()=>{const s=t.inProgress();e.hasOngoingOperation(s&&!e.locked()),this.triggeringLockedBladeSpinner(s&&e.locked())}));const s=ko.computed(this._loadingReactorLifetime,(()=>t.blockingUi()||this._frameBlockingUi()||this._contentInitializing()));if(qe(this)){const e=$e(this);2!==k.getBladeType(e.bladeDefinition)&&(ko.reactor(this._loadingReactorLifetime,(()=>{e.shieldType&&e.shieldType(t.shieldType())})),e.uiBlockers.push(s))}s.subscribe(this._loadingReactorLifetime,(s=>{const i=1===t.shieldType()||e.locked();if(e.isInBlockingLoadingState(s&&!i),!s){const t=e.hasOngoingOperation.value;this._contentRevealed.resolve(t)}})),s()||(this._contentRevealed.resolve(t.inProgress()),e.isInBlockingLoadingState(!1))}}_removeOutputArgumentValuesFromContainerModel(){const e=this.partDefinition,t=this.containerModel;t&&e&&e.details&&e.details.forEach((e=>{const s=e.outputArguments;s&&s.forEach((e=>{const s=e.valuesFrom;s&&s.forEach((e=>{const s=e.property;Fe(t,s).exists&&H.setModelValue(t,s,void 0)}))}))}))}_getPartSettingsManagerConfig(e,t){return{part:this,instanceProperties:t,partViewModelId:tt(this),partStateDefinition:this.partDefinition&&this.partDefinition.partState,identityInputs:e}}_listenForPartMutation(){const e=this.partDefinition;let t;const s=this._vm.container;if(!s.mutate||qe(this))return;const i=this.createChildLifetime();s.mutate.subscribe(i,(s=>{const o=this.locator.getExtensionLocator();if(s.partName)t=s.extensionName?_e(s.extensionName).withPartType(s.partName):o.withPartType(s.partName);else{const s=e.assetTypeDefinition;if(!s)return void be.error("Mutate function on part {0} was called with an object but the mutating part doesn't have an asset type definition.".format(this.locator.toString()));t=_e(o.name).withPartType(s.partName)}const n={newPartContainerModel:s.containerModel,invoker:"mutation"};this.diContainer.get(U.ReplacePartPortalFunc).invoke({part:this,newLocator:t,options:n},Se).catch((e=>{const s=`Unable to replace provisioning part '${this.locator.toString()}' with the part for the created asset defined by the locator '${t.toString()}'\r\n${e}.`;be.error(s)})).finally((()=>{this._disposeEditScope(),i.dispose()}))}))}_updateForHasPermissions(e){return this._vmPromise.then((()=>{const t=this._vm;if(t===Oe||this.isDisposed())be.warning("Part '{0}' has not retrieved view model when checking permissions.".format(this.locator.toString()));else{const s=t.container,i=this.widget;e?!MsPortalFx.isNullOrUndefined(s.unauthorizedMessage.peek())&&s.unauthorizedMessage(null):(i&&i.options.isInBlockingLoadingState(!1),s.unauthorized(),t.updatePartForUnauthorized())}}))}_getAllInputsSetWatcherConfig(){const t=this.widget,s={bindableTarget:{viewModelName:tt(this)},propertyBindings:this.getInputPropertyBindings(),allInputsSet:this.allInputsSet,calledOnInputsSet:this.calledOnInputsSet,failedOnInputsSet:this.failedOnInputsSet,referenceComposition:this,notifyWhenInputsChangeWithSameValues:!0,inputsSetCalled:(e,s)=>{let i;s.then((e=>{i=e})).finally((()=>{this._onInputsSet.resolve(i),this._contentRevealed.resolve(!1),this._lastRebindOnInputsSetProperties&&($.isEmptyObject(this._lastRebindOnInputsSetProperties)||k.deepSubset(e,this._lastRebindOnInputsSetProperties))&&t&&t.options.isInBlockingLoadingState(!1)}))},beforeViewModelPropertyUpdate:t=>{if(this.partDefinition.permissions){const s=(0,o.startTimer)(),i=this.locator.toString();return O.checkPermissions(this.partDefinition.permissions,se.All,t,this.partDefinition.assetType,this.extension.name,this.diContainer,i).then((t=>(this._updateForHasPermissions(t).catch((t=>{this.isDisposed()||MsPortalFx.Errors.isInstanceOfErrorType(t,MsPortalFx.Errors.CanceledError)||(0,c.logToExtension)(e,this.widget.element,2,`Part permission check failed. Error: ${MsPortalFx.getLogFriendlyMessage(t)}`)})),t))).finally((()=>{this._perfData.checkPermissions=s()}))}return Promise.resolve(!0)},getInputsMetadata:1===Je(this)&&(()=>T.tryImmediateResolve(rt(),(e=>{const t=e.getConfigurableInputsMetadata(this);return Object.keys(t).forEach((e=>{const s=t[e];(s&&s.bindingSources||[]).forEach((e=>{delete e.sourceReference}))})),t}))),getDashboardFilters:()=>{const e=this.parent&&this.getPartsContainer();return e&&e.getFilters?e.getFilters():{}},getPartFilters:()=>this.filters||{}};return this.partDefinition&&this.partDefinition.partState&&this._partSettingsManager&&(s.getStateAsync=()=>this._partSettingsManager.getPartSettingsAsync().then((e=>(this._part&&this._part.partSettingFailed(!1),e)),(e=>(this._part&&this._part.partSettingFailed(!0),Promise.reject(FxImpl.createError(`Failed to retrieve part settings for part '${this}'.`,{innerErrors:e})))))),s}_getAdapterAllInputsSetWatcherConfig(){const e=this.adapter;return{bindableTarget:{viewModelName:e.viewModelId},propertyBindings:e.inputPropertyBindings,allInputsSet:e.allInputsSet,calledOnInputsSet:e.calledOnInputsSet,failedOnInputsSet:e.failedOnInputsSet,referenceComposition:this,notifyWhenInputsChangeWithSameValues:!0}}notifyDetailBladeClosed(e){const t=()=>{const t=e.masterCommandName,s=this._vm.container,i=s&&s.selectable;i&&!xe(t)&&i.isCommandSelected(!1)};this.isComposed?t():this.await(7).then(t)}beforeActivateCommandMenuItems(e){e.isControlContextMenu||this._contextMenuViewModels&&(this._contextMenuViewModels.dispose(),this._contextMenuViewModels=null)}_handleRightClick(t,s){const i=s&&s.listData&&s.listData.selectableSet;if(!this.isDisabled&&!this.isDisposed()){const o=i;s.supplyCommands||o&&o._msPortalFxSupplyCommands?de(this,"./UI.Composition.ContextMenuV2",(e=>{const i={partComposition:this,diContainer:this.diContainer};e.OpenContextMenuPipeline.createPipeline(this.diContainer,this,i,this).startTask({dataItem:s.viewModel,extension:this.extension,contextMenuArgs:s,evt:t})}),e):this._determineExtensionAndTriggerContextMenu(t,s)}}_determineExtensionAndTriggerContextMenu(t,s){const i=this.diContainer,o=this.extension,n=e=>{const t=this._finder.locateAsync(_e(e.commandGroupOwner));return t.catch((()=>{be.error("Could not find extension '{0}' for commandGroup {1} from part in extension {2}.".format(e.commandGroupOwner,e.commandGroup,o.name))})),t},r=(e,o)=>{e.fireContextMenuEvent(this,i,this,o,t,s,this._showShellCommands,this._bladeOpener).then((e=>{this._contextMenuViewModels=e}))};de(this,"./UI.Composition.ContextMenuContainer.DemandLoad",(e=>{s.commandGroupOwner&&s.commandGroupOwner!==o.name?n(s).then((t=>{r(e,t)})):r(e,o)}),e)}isSelected(){const e=ko.unwrap(this._vm.container).selectable,t=ko.unwrap(e);return t&&ko.unwrap(t.isSelected)}await(e){switch(e){case 0:return this._allContentRevealed;case 1:return this._partDefinitionDeferred.promise;case 2:return this._earlyVmDeferred.promise;case 3:return this._allOnInputsSet;case 5:return this._getPartViewModelCalledDeferred.promise;case 6:return this.await(1).then((()=>{const e=$e(this);return 5===(e?.bladeDefinition?k.getBladeType(e.bladeDefinition):0)?this.await(0):this.await(7)}));case 7:return this._registrationDeferred.promise}return super.await(e)}_createErrorPart(t,s){if(this.isDisposed())return Promise.reject(new me);const i=MsPortalFx.getLogFriendlyMessage(s);this._traceErrorTelemetry(t,"string"==typeof s?s:s&&s.message,s);const o=qe(this)&&$e(this),n=`Error composing ${o?"blade":"part"} '${o||this}'. Details: ${i}`;let r;r=new G("string"==typeof s?{message:n}:{message:n,innerErrors:s}),t===Ue.ErrorAcquiringViewModel||t===Ue.ViewModelMissing?(0,c.logToExtension)(e,pt(this),2,n):be.error(n,t,r);const a=w.getPartFactory(this._finder,this.locator,{partKind:oe._Internal_Error}),l=(0,q.composePartViewModel)((()=>({message:d.PartError.titleContent,summaryItems:[{label:d.PartError.errorReason,value:Ue[t]}],details:i}))),p=this._savedContainerState,u=l.container;return p&&(u.partTitle(p.partTitle),u.assetName(p.assetName)),this._registrationDeferred.reject(s),o&&o.widget.options.loaded(!0),this._createPartWidget(a,l,!0)}_createPartWidget(t,s,i){if(this.isDisposed())return Promise.reject(new me);const o=$e(this),n=o&&o.bladeDefinition,r={size:this.widget.options.size,locator:this.locator,getDebugId:()=>tt(this),traceErrorTelemetry:(e,t)=>{this._traceErrorTelemetry(Ue.TransitionedToErrorState,e,t)},noFxContentPadding:this.partDefinition&&(this.partDefinition.noFxContentPadding||this.partDefinition.isV2),isVirtualPartForTemplateBlade:n&&1===k.getBladeType(o.bladeDefinition),getTelemetryContextState:n&&k.bladeImplementedWithVirtualPart(n)?()=>o.getTelemetryContextState():()=>this._creationState,partLocation:Je(this),pinnedBladeDeeplink:this.partDefinition&&this.partDefinition.ignorePinnedDeepLink?void 0:this._pinnedBladeDeeplink};if(i&&this.widget.options.isInBlockingLoadingState(!1),n){const e=e=>{o.menuDeepLink.subscribeAndRun(this._ltm,e.menuDeepLink)};let t;if(n.menuBlade){let i;if(n.menuBlade.isV2){const e=s.content().viewModel;i=e&&e._msPortalFxMenu}else if(n.menuBlade.isMenuView)s.content().menuBladeViewModel.fxAwaitAndRun(this._ltm).then((t=>{const s=t._msPortalFxMenu._msPortalFxData;e(s)}));else{i=s.content().menu}t=i&&i._msPortalFxData}else if(n.tabMenuBlade?.isV2){const e=s.content().viewModel,i=e&&e._msPortalFxTabMenu;t=i&&i._msPortalFxData}t&&e(t)}return T.tryImmediateResolve(t.createPart(this._partContainer[0],s,r,this.diContainer,this),(t=>{if(this.isDisposed())return Promise.reject(new me);this._part=t;const i=(e=!1)=>{this._frameRevealed.resolve(e),this._frameBlockingUi(!1),!e&&this._frameInitialized.resolve(void 0)};if(ct(this.partDefinition)&&t.awaitReady){const s=t;s.awaitReady().catch((t=>{const s=o.bladeDefinition?k.getBladeType(o.bladeDefinition):0;2===s||5===s?o.logFrameBladeLoadError(t):J.usingState((()=>{Ce.trace({extension:pt(this),source:Se,action:"IFramePartReadyTimeout",name:Le(this.locator),data:{details:t},journeyId:this._getTelemetryJourneyId()})}),this._creationState),(0,c.logToExtension)(e,this.widget.element,2,`A 'ready' message is expected but not received by '${this}'. IFrame should post the 'ready' message to indicate that the IFrame HTML page has loaded and an 'onMessage' handler has been installed to receive subsequent messages. Details: ${MsPortalFx.getLogFriendlyMessage(t)}`)})),s.awaitContentRevealed().then((()=>{i(!0)})),s.awaitInitializationComplete().then((()=>{i()}))}else i();qe(this)||(ko.reactor(this,(()=>{const e=s.container.notFoundMessage();this._part.notFoundMessage(e)})),ko.reactor(this,(()=>{const e=s.container._msPortalFxHandledError();this._part.handledErrorMessage(e)}))),t.setupContent({extensionWindowId:this.extension&&this.extension.name,styleSheets:this.partDefinition?.styleSheets}).finally((()=>{this._contentInitializing(!1)})),ko.computed(this,(()=>{const e=this.parent,t=e&&e.widget,s=t&&t.options.locked();this.widget&&this.widget.options.locked(s),this._part&&this._part.lockedUiContext(s)}))}))}loadPropertiesFromJson(e,t,s=!1,i){const o=ae.bindingsFromJSON,n=t.partState;this.assetInstanceDefinition=t.assetInstanceDefinition,this.bindings=i?Te(i,this):o(e,t.bindings)||[],this.initialSize=t.initialSize,this._bindingsInitialized=t.bindingsInitialized,this._restoredFromJson=!0,this.loadFromJson(t),this._savedContainerState=t.savedContainerState,this.containerModel=E.createContainerModel(t.containerModel),this.overridesModel=E.createContainerModel(t.overridesModel)||{},this.partState=FxImpl.isSerializedObject(n)?FxImpl.fromSerializableObject(n):n,s&&ot(this.partState),t.originalPartLocator&&(this.previousLocator=K.fromJSON(e,t.originalPartLocator)),this.flags=t.flags||0,this._adapterBindings=o(e,t.adapterBindings)}calculateInitialSize(){let e,t,s,i,o={};const n=this._finder,r=this.locator,a=r.type;if(5===a||7===a){if(n.tryLocate(r,o)){const a=o.value;if(a){const l=a.inline,c=a.reference;if(t=l?l.initialSize:c.initialSize,s=l?l.initialWidth:c.initialWidth,i=l?l.initialHeight:c.initialHeight,l)e=l;else{const t=_e(c.extension||r.getExtensionName()).withPartType(c.partTypeName);o={},n.tryLocate(t,o)&&(e=o.value)}}}}else 6===a?(o={},n.tryLocate(r,o)&&(e=o.value)):be.error("Unable to create Part composition. Invalid locator type: '{0}'".format(a));this._bindingsInitialized=!1;const l=w.getPartSizeOrDefault(e);let c=l;if(ie.PartSize[t])c=t;else if(e&&ie.PartSize[e.initialSize])c=e.initialSize;else if(e){const t=w.getPartFactory(this._finder,this.locator,e);c=t&&void 0!==t.defaultSize?t.defaultSize:l}this.initialSize=c,this.initialSize===ne.Custom&&(this.initialWidth=s||e&&e.initialWidth,this.initialHeight=i||e&&e.initialHeight)}getDiagnosticsData(){return $.extend(super.getDiagnosticsData(),{bindings:ae.mapBindingsToFriendlyObjects(this.bindings)})}_getSummaryPartViewModelState(){const e={collapsed:!1};return this.widget.trigger("fxsummarycollapsed",e),e.collapsed}_getEditScopeIdFromSettings(){const e=this._journey,t=e&&e.ambientSettings.getItem(this.journeyPath),s=t&&t.value,i=s&&s.editScope;return i&&i.editScopeId}_setupJourneyEditScopeReactor(){const e=this.partDefinition,t=this._journey;e&&e.editScopeType&&t&&t.observeEditScopeChanges(this,{editScopeId:this.editScopeId,ownerType:this.locator.type,ownerLocatable:this})}_setEditScope(){const e=this.partDefinition;if(!e||!e.editScopeType)return;const t=this._getEditScopeIdFromSettings(),s=this.editScopeId;t?s(t):(s((0,o.getUniqueId)()),this.diContainer.get(C.EditScopeManager).onEditScopeCreated(s()));const i=this.getInputPropertyBindings();if(!i.properties.some((e=>e.targetProperty===Ie))){const e={};e[Ie]=s,i.mapProperty(Ie,Ie).bind(this+"-[EditScopeId]",e,!0)}}_getCommands(){if(!this.isComposed||!this.widget)throw new ge(`Part '${this}' needs to be composed before retrieving its commands.`);return this.widget.options.commands}_setupPromises(){this._onInputsSet=Promise.withResolvers(),this._contentRevealed=Promise.withResolvers(),this._allOnInputsSet=Promise.all([this._onInputsSet.promise,this._frameInitialized.promise]),this._allContentRevealed=Promise.all([this._contentRevealed.promise,this._frameRevealed.promise]).then((([e])=>e)),this._allContentRevealed.then((e=>this.contentRevealed=e))}_setupBladeRebindingHandlers(e){if(e&&e.onRebind){const t=e=>{this._setContainerInputsChanging(!0),this._updateRebindSequenceNumber(),J.provideContext((()=>{this._creationState=J.getState()}),X.Part,this._getPartContext());const t=this.editScopeId()&&this.diContainer.get(C.EditScopeManager).getStateObservable(this.editScopeId()),s=this.widget;if(this._onInputsSet.reject(new ue(`Part binding canceled due to rebinding for part '${this}'`)),this._contentRevealed.reject(new ue(`Part reveal canceled due to rebinding for part '${this}'`)),this._setupPromises(),this._hasRebindableInputs){const t=(this.parent.parent||this.parent).widget;!s||t&&t.options.locked()||s.options.isInBlockingLoadingState(!0),this._lastRebindOnInputsSetProperties=Ee(e,this.bindings,1,""+this),this._setupAdaptedInputsReboundReactor()}if(t&&0===t()&&this.diContainer.get(C.EditScopeManager).onEditScopeDisposed(this.editScopeId()),this.editScopeId(void 0),this._ensureAdapterAtomicityForBindings(),this.bindings.forEach((e=>{if(e.source.scope===le.DetailsContainer){Fe(this._vm,e.targetProperty).exists&&H.setModelValue(this._vm,e.targetProperty,void 0)}})),this._vm.container.unauthorizedMessage.peek()&&this._vm.container.unauthorizedMessage(null),qe(this)){$e(this).setInputsSetPromise(this._onInputsSet.promise)}else this._vm.container.notFoundMessage.peek()&&this._vm.container.notFoundMessage(null)},s=e=>{this.isComposed&&this._setEditScope()},i=()=>{this._setContainerInputsChanging(!1)};e.onRebind(t,s,i),this.registerForDispose((()=>{e.offRebind(t,s,i)}))}}_ensureAssetAffinity(){const e=this.parent&&this.getPartsContainer(),t=this.assetType,s=e&&e.assetType,i=this._part.inContainerOfSameAsset;if(!(e&&s&&t&&s===t&&ko.isObservable(e.assetId)))return i(!1);ko.computed(this,(()=>{const t=e.assetId(),s=this.assetId(),o=t&&s&&M.compareAssetId(t,s);i(o),this._part.assetId(s)}))}_ensureAdapterAtomicityForBindings(){const e=this.adapter;if(!e)return;const t=[];this.bindings.forEach((e=>{const s=e.source;7===s.modelType&&t.push(s.property)})),t.forEach((t=>{H.setModelValue(e.viewModel,t,void 0)}))}_setupAdaptedInputsReboundReactor(){const e=this.adapter;e&&!e.allOutputsReboundComputed&&(e.allOutputsReboundComputed=ko.computed(this,(()=>{if(this.bindings.filter((e=>{const t=e.source.modelType;return 7===t||9===t})).every((e=>{const t=this.bindAdaptedInput(e).sourceModel,s=Fe(t,e.source.property).value;return void 0!==ko.unwrap(s)}))){const t=""+this,s=Ee(e.viewModel,this.bindings,7,t),i=Ee(e.inputPropertyBindings.targetModel,this.bindings,9,t);this._lastRebindOnInputsSetProperties=$.extend(s,i)}})))}_disposeEditScope(){const e=this.editScopeId();if(e){this.diContainer.get(C.EditScopeManager).onEditScopeDisposed(e);const t=this._journey;t&&t.ambientSettings.removeItem(this.journeyPath)}}_setViewStateProperties(e,t){const s=e||[];let i=t||[];i=i.filter((e=>{const t=e.split(".");return!(t.length>1)||(t.pop(),"object"==typeof Fe(this._vm,t.join(".")).value)})),this._viewStateProperties=MsPortalFx.union(s,i);const o=this._vm,n=o&&o.container;n&&n.selectable&&(this._viewStateProperties=MsPortalFx.union(this._viewStateProperties,Me))}_registerInvocationProperty(e){const t=this._bladeOpener;let s;D.detailsIsPartContainer(e)&&(s=ko.pureComputed((()=>!this._vm.container.isSelectable()))),t.registerInvocationProperty(e,s)}_traceErrorTelemetry(e,t,s){const i={details:t,resourceId:this.assetId(),stack:s?.stack?.slice(0,6e3),status:s&&s.status,...s&&s.data||{}};qe(this)?T.tryImmediateResolve(this.diContainer.getAsync(a.get("MsPortalImpl/UI/Compositions/UI.Composition.BladeTelemetry","BladeTelemetry")),(t=>{t.traceBladeLoadErrored(Ue[e],i)})):J.usingState((()=>{Ce.trace({extension:pt(this),source:Se,action:"PartErrored",actionModifier:Ue[e],name:Le(this.locator),data:i,journeyId:this._getTelemetryJourneyId()})}),this._creationState)}_getTelemetryJourneyId(){const e=this._journey;return e&&e.id}recordUserInteraction(){}_tracePartTelemetry(e,t){const s=pt(this),i=Le(this.locator);Ce.trace({source:Se,action:e,extension:s,name:i,journeyId:this._getTelemetryJourneyId(),data:t})}}function qe(e){return e.partDefinition&&e.partDefinition.shareVmWithParentBlade}function $e(e){const t=e.getPartsContainer();return t&&t.getCompositionType()===k.CompositionType.Blade&&t}function je(e){const t=$e(e);return!!(t&&t.bladeDefinition&&t.bladeDefinition.locked)}function Ge(e,t){return t.masterPartId===e.id&&xe(t.masterCommandName)}function Ke(t,s){return pe(t,Promise.all([MsPortalFx.require("../../../MsPortalImpl.Controls/Controls/Lists/Menu",e),MsPortalFx.require("../../../MsPortalImpl.Controls/Controls/Lists/TabMenu",e)])).then((([e,t])=>{const i=s.widget.element.find(".fxc-menu"),o=s.widget.element.find(".fxc-tabmenu");return i.length&&(W.getAllMatch(i[0],e.Widget)||[])[0]||o.length&&(W.getAllMatch(o[0],t.Widget)||[])[0]||s.getMenuWidget()}))}function Je(e){const t=e.parent&&e.getPartsContainer(),s=t?t.getCompositionType():re.Unknown;return t?s===re.Startboard?1:2:0}function Qe(e,t=!0){let s;return e&&(t&&!e.hasOwnProperty(k.PartContainerModelIdProperty)&&((e=ko.toJS(e))[k.PartContainerModelIdProperty]=(0,o.getUniqueId)()),s=ae.createObservableModel(e)),s}function Xe(e,t){let s;return e&&t?(s={},(0,o.forEachKey)(e,(e=>{s[e]=null}))):s=e,FxImpl.toSerializableObject(s)}function Ze(e,t,s,i,o,n){const r=e.createChildContainer("composition"),a=new Ve(r,t,null,s,null,null,null,n);return a.registerForDispose((()=>r.disposeAsync())),a.calculateInitialSize(),a.containerModel=Qe(i),a.overridesModel=Qe(o||{},!1),a}function Ye(e){const t=z.getGridPixelSize(e.gridWidth(),e.gridHeight());let s=t.height,i=t.width;return e.locked()||(s-=30,i-=30),{height:s,width:i}}function et(e,t,s,i,o,n){if(!dt(n)){if(o){const t="content.size",s=Fe(e,t);s.exists&&ko.isObservable(s.value)&&H.setModelValue(e,t,i)}f.requestAnimationFrame((()=>{const o=function(e,t){return z.isFixedSize(t.size())?Ye(t):{height:e.height(),width:e.width()}}(t,s),n=e.container;n.width(o.width),n.height(o.height);const r=n.size();!xe(r)&&r.partSize===i&&MsPortalFx.deepEquals(r.dimensions,o)||n.size({partSize:i,dimensions:o})}))}}function tt(e){const t=e.partDefinition,s=e.adapter,i=t&&t.viewModel?t.viewModel:"N/A";return`${e} (${s?`AdapterPart. Extension: ${s.extension.name}, ViewModel: ${s.viewModelName}, Wrapped ViewModel: ${i}`:`ViewModel: ${i}`})`}function st(e){const t=e.adapter,s=t.inputPropertyBindings.targetModel;Pe(e.diContainer,e,t.inputPropertyBindings,t.bindings,(t=>(s[t.targetProperty]=ko.observable(),e.bindAgainstOverridesOrContainerModel(t))))}function it(e){const t=e.adapter,s=t?t.inputPropertyBindings:e.getInputPropertyBindings(),i=MsPortalFx.find(s.properties,(t=>t.targetProperty===e.assetInstanceDefinition.assetIdInputProperty));return i?Fe(i.sourceModel,i.sourceProperty):null}function ot(e){"object"==typeof e&&(0,o.forEachKey)(e,((t,s)=>{De[t]?delete e[t]:"object"==typeof s&&ot(s)}))}function nt(t){return de(void 0,t,(e=>Ne[t]=e),e)}function rt(){return nt(Ae)}function at(){return Ne[Ae]}t.Instance=Ve;const lt=t.inferredReferenceType=-999;function ct(e){return e&&(e.partKind===oe.Frame||e.partKind===oe._Internal_React)}function dt(e){return e&&e.partKind===oe._Internal_React}function pt(e){const t=e.getPartsContainer();if(t){if(t.getCompositionType()===re.Blade)return t.locator.getExtensionName()}const s=e.locator;return s&&s.getExtensionName()}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder",["require","exports","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding"],(function(e,t,s,i,o,n){"use strict";t.getConfigurableInputsMetadata=m,t.inferInitialBindingsForInputDefinitions=function(e,t){const s=e.diContainer.get(i.Finder),o=e.parent&&s.findPartsContainer(e);t=t||[];const r=e.overridesModel,a=[];return t.forEach((e=>{const t=e.name;let s;s=(0,n.getModelValue)(r,t).exists?null:(e=>{if(o&&o.getCompatibleSourceReferences){const t=o.getCompatibleSourceReferences(e);return t&&t[0]}})(e),a.push(g(e,s))})),a},t.listenForConfigurationChanges=function(e,t,i){e.getViewModel().internal.updateConfigFn((function(r,a){let l;t&&s.CompositionBinder.turnOnInputsSetSuppressionOn(t),s.CompositionBinder.turnOnInputsSetSuppressionOn(i);try{const{inputs:t,settings:i,inputsMetadata:a}=r,h=e.getSettingsModel(),f=e.partDefinition&&e.partDefinition.partState,x=f?(f.inputIdentityProperties||[]).concat((f.sharedProperties||[]).map((e=>e.property))):[],b=Object.keys(i);let y;x.forEach((e=>{const t=ko.unwrap((0,n.getModelValue)(h,e).value),s=e.startsWith("content.")?e.slice(8):e,o=ko.toJS((0,n.getModelValue)(i,s).value);d(o,t)||((0,n.setModelValue)(h,e,o),l=!0),MsPortalFx.remove(b,s)}));const v=m(e);Object.keys(v).forEach((i=>{const o=v[i],r=a[i],l=t[i];(function(e,t,i,o,r){const a=o&&MsPortalFx.find(i.bindingSources,(e=>e.name===o));if(o&&!a)return void p.error("Source with name '{0}' for configurable Part input named '{1}' does not exist at the Dashboard/Blade-level.".format(o,t));const l=e.getInputPropertyBindings(),m=MsPortalFx.find(l.properties,(e=>e.targetProperty===t));let h,f,x;if(a){const e=i.activeBindingSourceName;a.name!==e&&(h=!0)}else{const e=ko.unwrap((0,n.getModelValue)(m.targetModel,m.targetProperty).value);d(ko.toJS(r),e)||(f=!0)}if(!h&&!f)return!1;if(e.adapter){const s=MsPortalFx.find(e.bindings,(e=>e.targetProperty===t)),i=s&&s.source,o=i&&i.modelType===u&&i.property;if(!o)return p.error("For Adapted Part '{0}', input named '{1}' to the inner Part is not configurable.  Presently, only those inner Part inputs using the 'AdapterInput' binding are configurable.".format(e.toString(),t)),!1;x=o}else x=t;const b=e.adapter?e.adapter.inputPropertyBindings:e.getInputPropertyBindings(),y=MsPortalFx.find(b.properties,(e=>e.targetProperty===x)),v=y.compositionBindingDefinition,w=e.overridesModel;let M;if(h){const t=e.adapter?e.adapter.inputDefinitions:e.partDefinition.inputDefinitions;M=g(MsPortalFx.find(t,(e=>e.name===x)),a.sourceReference)}if(f&&((0,n.setModelValue)(w,y.sourceProperty,ko.toJS(r)),M=g(v)),M){b.removeProperty(y);const t=e.adapter?e.adapter.bindings:e.bindings;c(t,v),s.CompositionBinder.setupPropertyBindings(e.diContainer,e,b,[M],(t=>e.bindAgainstOverridesOrContainerModel(t))),t.push(M),e.adapter&&(l.removeProperty(m),s.CompositionBinder.setupPropertyBindings(e.diContainer,e,l,m&&[m.compositionBindingDefinition],(t=>e.bindAdaptedInput(t))))}return!0})(e,i,o,r.activeBindingSourceName,l)&&(y=!0)})),y&&(e.widgetState.valueHasMutated(),function(e,t){const s=e.widget;s&&s.element.trigger(o.fxpartinputchanged,{part:e,isUserInteraction:t})}(e,e.hasUserInteractedRecently()),e.save())}finally{const e=(l?2:1)|(a?0:4);return Promise.all([t&&s.CompositionBinder.turnOnInputsSetSuppressionOff(t,e,!0)||Promise.resolve(),s.CompositionBinder.turnOnInputsSetSuppressionOff(i,e,!0)])}}))};var r=MsPortalFx.Base.Constants.BladeParameterNames,a=MsPortalFx.Base.Diagnostics,l=MsPortalFx.ViewModels.Internal,c=MsPortalFx.remove,d=MsPortalFx.deepEquals;const p=a.createLog(e),u=9;function m(e){if(e.adapter){const t=h(e),s={};return f(e,!1).forEach((e=>{let i;const o=e.compositionBindingDefinition,n=o&&o.source;if(n&&n.modelType===u){const e=n.property;i=t[e]}i||(i={bindingSources:[],activeBindingSourceName:null}),s[e.targetProperty]=i})),s}return h(e)}function g(e,t){const s=e,i=e,n=i.targetProperty||s.name,r=!!e.optional;if(!t){const e=i.source&&i.source.property||s.name;t=(0,o.createOverridesOrContainerModelSourceReference)(e)}return{targetProperty:n,optional:r,source:t,isDynamicBinding:!0}}function h(e){const t=e.diContainer.get(i.Finder),s=e.parent&&t.findPartsContainer(e),o=e.adapter?e.adapter.inputDefinitions:e.partDefinition.inputDefinitions,r=e.overridesModel,a={};return f(e).forEach((e=>{const t=e.targetProperty,i=(e=>{let t;if(o&&s&&s.getCompatibleSourceReferences){const i=MsPortalFx.find(o,(t=>t.name===e));i&&(t=s.getCompatibleSourceReferences(i))}return(t||[]).map((e=>({sourceReference:e,name:e.property,acceptsValueUpdates:!1})))})(t),l=e.compositionBindingDefinition,c=l&&l.source,d=!(e=>{if(!e||(0,n.isDynamicBindingWithNonLocalSource)(e))return!1;{const t=e.source&&e.source.property;return r&&t&&(0,n.getModelValue)(r,t).exists}})(l)&&c&&MsPortalFx.find(i,(e=>{const t=e.sourceReference;return t.modelType===c.modelType&&t.property===c.property}));a[t]={bindingSources:i,activeBindingSourceName:d&&d.name}})),a}function f(e,t=!0){return e.getNonDetailsContainerPropertyBindings(t).filter((e=>{const t=e.targetProperty;return!l.isBladeCallerInput(t)&&t!==r.EditScopeId}))}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration",["require","exports","MsPortalImpl/ViewModels/ViewModels.BladeCaller"],(function(e,t,s){"use strict";t.listenForRegistrationChanges=function(e,t,n){const r=t.internal,a=ko.observableArray([]);a.map(e,((e,t)=>{ko.ignoreDependencies((()=>{!function(e,t,n,r){const a=r.getBladeOpener(),l={invocationInputArguments:[{valuesFrom:[{referenceType:0,property:i+"."+t}]}]},c=ko.unwrap(n.registeredSelectableOptions);if(c){const e=c[t];e&&(e.parameterCollector&&s.addCallerBindings(`${o}.${t}.parameterCollector.bladeCaller`,l,0),l.openInContextPane=e.openInContextPane,l.persistentContextPane=e.persistentContextPane)}a.registerInvocationProperty(l,null,e)}(e,t,r,n)}))})),ko.computed(e,r.registeredSelectables,((e={})=>{a.splice.apply(a,[0,a.peek().length].concat(Object.keys(e)))})).extend({deferred:!0})};const i="internal.registeredSelectables",o="internal.registeredSelectableOptions"})),
define("MsPortalImpl/Services/Services.AssetManagement",["require","exports","Fx/ResourceManagement","FxHubs/RpcEndPoints","Fx/DependencyInjection","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.ArmEvents","FxInternal/AsyncLoader"],(function(e,t,s,i,o,n,r,a){"use strict";t.notifyAssetDeletedHandler=t.AssetManager=void 0;const l=MsPortalFx.Base.Diagnostics.createLog(e);let c=class{constructor(e){this.assetTypeService=e,this._assetDeletedCallbacks=$.Callbacks(),this.handleAssetDeletedLocal=(e,t,i,o)=>{o.reason=o.reason||`Received asset deletion notification from the extension '${t}'`;const a=o.assetId,c=o.assetType;if("*Impl_Resource*"===c){s.ArmId.parse(a,!0).resourceType&&this.assetTypeService.mapResourceIdToAssetId(a).then((t=>{this.handleAssetDeleted(t.extensionName,t.assetType,t.assetId,o.reason),e.get(r.ArmEvents).createResourceDeletedEvent([t])})).catch((e=>{0!==(e&&e.message||"").indexOf(n.failedToFindAssetTypePrefix)&&l.warning(e)}))}else this.handleAssetDeleted(i,c,a,o.reason),e.get(r.ArmEvents).createResourceDeletedEvent([{extensionName:i,assetType:c,assetId:a}])}}onAssetDeleted(e){this._assetDeletedCallbacks.add(e)}markAssetDeleted(e,t,s,i){this.handleAssetDeleted(e,t,s,i)}handleAssetDeleted(e,t,s,i){this._assetDeletedCallbacks.fire(e,t,s,i)}};c=__decorate([__metadata("fx:diagnostics",[e,"AssetManagerImpl"]),o.Class(),__metadata("design:paramtypes",[n.AssetTypeService])],c);class d{static create(e){return e}}t.AssetManager=d,__decorate([__metadata("fx:diagnostics",[e,"AssetManager"]),o.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[c]),__metadata("design:returntype",d)],d,"create",null);t.notifyAssetDeletedHandler=(0,a.defineHandler)(i.Events.notifyAssetDeletedDefinition,(e=>{const t=e.messageContext.srcWindowId,s=e.diContainer.get(d);MsPortalFx.makeArray(e.messageArg).forEach((i=>{s.handleAssetDeletedLocal(e.diContainer,t,t,i)}))}))})),
define("MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter",["require","exports"],(function(e,t){"use strict";t.CompositionAwaiter=void 0;class s{constructor(e,t){this.deferred=Q.defer(),this.targetId=e,this.isSource=t}}t.CompositionAwaiter=class{constructor(e){this._awaitableCompositions=[],this.resolvedCompositions=[],this._trackResolvedCompositions=e}await(e,t){const i=new s(e&&e.toString(),t),o=MsPortalFx.findIndex(this.resolvedCompositions,(e=>t(e)));return o>=0?i.deferred.resolve(this.resolvedCompositions[o]):(this._awaitableCompositions.push(i),e&&e.onDispose((()=>{if(i.deferred.promise.isPending()){i.deferred.reject(new MsPortalFx.Errors.DisposedCanceledError);const e=this._awaitableCompositions.indexOf(i);e>=0&&this._awaitableCompositions.splice(e,1)}}))),i.deferred.promise}resolve(e){let t,s;for(this._trackResolvedCompositions&&(this.resolvedCompositions.push(e),e.onDispose((()=>{const t=this.resolvedCompositions.indexOf(e);t>=0&&this.resolvedCompositions.splice(t,1)}))),t=this._awaitableCompositions.length-1;t>=0;t--)s=this._awaitableCompositions[t],s.isSource(e)&&(s.deferred.resolve(e),this._awaitableCompositions.splice(t,1))}get waitingCompositions(){return this._awaitableCompositions.map((e=>e.targetId))}}})),
define("MsPortalImpl/UI/Dashboard/FiltersSerialization",["require","exports","Fx/Composition/DashboardFilters","FxInternal/Composition/DashboardFilters"],(function(e,t,s,i){"use strict";t.deserializeFilters=function(e){const t=e&&Object.keys(e);if(!t||0===t.length)return;return t.reduce(((t,s)=>{const i=n(s),o=i.fromJSON(e[s].model);return t[s]=i.toExtensionModel(MsPortalFx.extend2(o,{selectAllState:void 0})),t}),{})},t.getFilterProcessor=n,t.isEqualityFilterModel=d,t.isSubstringFilterModel=p,t.serializeFilters=function(e){const t=e&&Object.keys(e);if(!t||0===t.length)return;return t.reduce(((t,s)=>{const i=n(s);return t[s]={model:i.toJSON(i.fromExtensionModel(e[s]))},t}),{})};const o={0:"equals",1:"notEquals",2:"contains",3:"notContains",4:"startsWith",5:"notStartsWith",6:"endsWith",7:"notEndsWith"};function n(e){return g["number"==typeof e?e:(0,i.getFilterKindFromId)(e)]}const r=(()=>{const e=[];return e[0]="auto",e[1]="1m",e[2]="5m",e[3]="15m",e[4]="30m",e[5]="1h",e[6]="6h",e[7]="12h",e[8]="1d",e[9]="7d",e[10]="1mo",e})(),a=(()=>{const e=[];return e[0]="m",e[1]="h",e[2]="d",e[3]="w",e})();function l(e){const t=o[e.operator];if(p(e))return{operator:t,substring:e.substring};const s=e.values;let i=e.selectAllState;switch(MsPortalFx.isNumeric(i)||(i=0),i){case 1:return{operator:t,selectAllState:"intermediate",excludedValues:s};case 0:return{operator:t,values:s};case 2:return{operator:t,selectAllState:"all",values:s}}}function c(e){const t=+MsPortalFx.find(Object.keys(o),(t=>o[+t]===e.operator));if(0!==t&&1!==t)return{operator:t,substring:e.substring,selectAllState:0};const s=e.values||e.excludedValues;let i;switch(e.selectAllState){case"all":i=2;break;case"intermediate":i=1;break;default:i=0}return{operator:t,values:s,selectAllState:i}}function d(e){const{operator:t}=e;return"number"==typeof t&&(0===t||1===t)}function p(e){return!d(e)}function u(e){if(e&&p(e)){const{operator:t,substring:s}=e;return{operator:t,substring:s}}return null}function m(e){if(e&&s.EqualityFilter.isSubstringFilterModel(e)){const{operator:t,substring:s}=e;return{operator:t,substring:s,selectAllState:0}}return null}const g={0:{fromExtensionModel:e=>e,toExtensionModel:e=>e,toJSON:function(e){const t={format:e.format?"local":"utc",granularity:r[e.granularity]};return e.relative?t.relative=`${e.relative.duration}${a[e.relative.timeUnit]}`:t.absolute=e.absolute,t},fromJSON:function(e){const t={format:"local"===e.format?1:0,granularity:function(e){const t=MsPortalFx.findIndex(r,(t=>t===e));return-1!==t?t:0}(e.granularity)},s=e.relative;if(s)t.relative=function(e){if((e=e&&e.trim())&&e.length>1){const t=e.slice(-1),s=MsPortalFx.findIndex(a,(e=>e===t));if(-1!==s){const t=parseInt(e.slice(0,e.length-1));if(MsPortalFx.isNumeric(t))return{duration:t,timeUnit:s}}}}(s);else{const s=e.absolute;s&&(t.absolute={fromDate:new Date(s.fromDate),toDate:new Date(s.toDate)})}return t}},1:{fromExtensionModel:e=>m(e)||{...e,selectAllState:0},toExtensionModel:e=>u(e)||{operator:e.operator,values:e.values},toJSON:l,fromJSON:c},2:{fromExtensionModel:e=>m(e)||{operator:e.operator,values:e.subscriptionIds,selectAllState:0},toExtensionModel:e=>u(e)||{operator:e.operator,subscriptionIds:e.values},toJSON:l,fromJSON:c},3:{fromExtensionModel:e=>m(e)||{operator:e.operator,values:e.locations,selectAllState:0},toExtensionModel:e=>u(e)||{operator:e.operator,locations:e.values},toJSON:l,fromJSON:c},5:{fromExtensionModel:e=>m(e)||{operator:e.operator,values:e.resourceGroupIds,selectAllState:0},toExtensionModel:e=>u(e)||{operator:e.operator,resourceGroupIds:e.values},toJSON:l,fromJSON:c},4:{fromExtensionModel:e=>m(e)||{operator:e.operator,values:e.resourceTypes,selectAllState:0},toExtensionModel:e=>u(e)||{operator:e.operator,resourceTypes:e.values},toJSON:l,fromJSON:c}}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart",["require","exports","Fx/Composition/DashboardFilters","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/UI/Dashboard/FiltersSerialization","MsPortalImpl/Services/Services.EditScopeManagement","Fx/Composition/Selectable","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/Widgets/Widgets.Portal.init","FxInternal/Composition/Part"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x){"use strict";t.Instance=void 0,t.create=P,t.fxpartfilterschanged=void 0;var b=MsPortalFx.Base.Diagnostics,y=MsPortalFx.Parts.PartKind,v=l.CompositionBinder;const w=window.fx.getTimestamp,M=t.fxpartfilterschanged="fxpartfilterschanged",C=b.createLog(e);class S extends d.Instance{constructor(e,t,s,i){super(e,t,s,i&&i.id,null,"StartboardPart",i&&i.pinnedBladeDeeplink),this.partFilterState=ko.observable(0),this._lastUserInteraction=-2e3,this.containerModel={},this._store=4,this._deepLink=i&&i.pinnedBladeDeeplink,i&&i.duringPortalStartup&&(this._dontLoadFilterUpdatingModule=!0),i&&i.savedContainerState&&(this._savedContainerState=i.savedContainerState),i&&i.partHeader&&(this._partHeader=i.partHeader),this.await(7).then((()=>{this._updatePartFilterState(!this._dontLoadFilterUpdatingModule),this._dontLoadFilterUpdatingModule=!1})),this.await(2).then((e=>{I(e)&&e.content.subscribeAndRun(this,(t=>{const s=I(e).updateFilters;s&&s((e=>this.updateFilters(e)))}))})),this._updatableHeaderPromise=this.await(3).then((()=>{if(MsPortalFx.isFeatureEnabled(x.partHeaderEnabledFeatureName)){const{container:e}=this.getViewModel();if(e){const t=e.updatableHeader,s=!!t.options();if(s||e.partTitle())return this._updatableHeader=t,this.getPerfData().updatableHeaderEnabledBy=s?"API":"title",this.getPerfData().updatableHeaderUsed=!!this._partHeader,!s&&t.options({disableSubtitleUpdate:!e.assetName()}),this._partHeader&&this._updateHeader(this._partHeader),t}}}))}clone(){return this.cloneAs(((e,t)=>{const s={overridesModel:t,filters:this.filters,pinnedBladeDeeplink:this._deepLink,savedContainerState:this._savedContainerState},i=P(this.diContainer,this.locator,e,s);return i.defaultMenuItemId=this.defaultMenuItemId,i}))}static fromJSON(e,t,s,n){const r=e.get(i.ExtensionManagerOptions);return d.createCompositionFromJSON(r,t,(()=>{const i=e.createChildContainer("composition"),a=new S(i,o.Locator.fromJSON(r,t.locator),t.widgetState,{id:t.id,duringPortalStartup:n,pinnedBladeDeeplink:t.deepLink});return a.registerForDispose((()=>i.disposeAsync())),a.loadPropertiesFromJson(r,t,!0,s),a._storedEditScopeId=t.editScopeId,a.defaultMenuItemId=t.defaultMenuItemId,a.containerModel=a.containerModel||{},a.filters=u.deserializeFilters(t.filters),a._partHeader=t.partHeader,a}),((s,i)=>{const o=e.createChildContainer("composition"),n=new S(o,s,null,{id:t.id});return n.registerForDispose((()=>o.disposeAsync())),n.unrecoverableErrorMessage=i,n}))}getCompositionType(){return n.CompositionType.StartboardPart}register(e,t,s){super.register(e,t,s);const i=this._part,o=this.editScopeId();o&&this.partDefinition.partKind===y.Provisioning&&this.diContainer.get(m.EditScopeManager).getStateObservable(o).subscribe(this,(e=>{(1===e||2===e)&&this.addWidgetToUI({parentElement:this.getPartsContainer().widget})})),i.openPartSettingsBlade=(e,t)=>{t&&t.stopPropagation(),this.openPartSettingsBlade()},this.partFilterState.subscribe(this,(e=>{i.partFilterState(e)}))}toJSON(){const e=super.toJSON();return e.editScopeId=this.editScopeId(),e.defaultMenuItemId=this.defaultMenuItemId,e.deepLink=this._deepLink,e.filters=u.serializeFilters(this.filters),this._partHeader&&(this._partHeader.title||this._partHeader.subtitle)&&(e.partHeader=this._partHeader),e}validateBindings(e){if(this.bindings&&this.bindings.length>0){const t=this.bindings.filter((e=>e.source.id!==this.id)).map((e=>e.source.property));return v.modelHasProperties(""+this,t,e)}return!0}addWidgetToUI(e){const t=this.widget;Promise.all([this.getDashboardFiltering(),this._updatableHeaderPromise]).then((([e])=>{this._supportsFiltering=e.supportsFiltering,(this._supportsFiltering||this._updatableHeader)&&t.options.commands.push(new p.CustomizeTileData(this,this.diContainer)),c.composeShellCommands(this,this,t.options.commands,!0,this.diContainer)})),super.addWidgetToUI(e),e.doNotSaveSettings||this.save();const s=t.element,i=this._ltm;s&&i&&this.await(1).then((e=>{if(!(this._isFramePart=e&&e.partKind===y.Frame)){const e=function(e,t,s){return e.addEventListener(t,s,!0),{dispose:function(){e&&(e.removeEventListener(t,s,!0),e=null)}}},t=()=>{const e=(0,f.getPortalViewModel)(this.diContainer),t=(e,t)=>{t.masterPartId===this.id&&this.recordUserInteraction()};return e.customEvents.addHandler(i,"fxbladeclosed",t),{dispose:()=>{e.customEvents.removeHandler("fxbladeclosed",t)}}};i.registerForDispose(t()),i.registerForDispose([...["click","mousedown","keydown"].map((t=>e(s[0],t,(()=>this.recordUserInteraction()))))])}}))}hasUserInteractedRecently(){if(this._isFramePart||this._lastUserInteraction+2e3>w())return!0;const e=this.diContainer.get(h.JourneyManager).activeJourney(),t=e&&e.children&&e.children[0];return(t&&t.masterPartId)===this.id}save(e){}_forceSave(e){super.save(e)}_getEditScopeIdFromSettings(){return this._storedEditScopeId}_setupJourneyEditScopeReactor(){}getDashboardFiltering(){return this.await(1).then((e=>({supportsFiltering:e.supportsFiltering,staticFilters:e.filters||[],partApi:this.await(2).then((e=>I(e)))})))}overridesFilter(e){return Object.keys(this.filters||{}).includes(e)}notifyFiltersChanged(e){return this.await(7).then((()=>{this._setContainerInputsChanging(!0);const t=2|(e?4:0),s=this._setContainerInputsChanging(!1,t),i=this._updatePartFilterState(!this._dontLoadFilterUpdatingModule);return Promise.all([s,i])}))}_disposeEditScope(){const e=this.editScopeId();e&&this.diContainer.get(m.EditScopeManager).onEditScopeDisposed(e)}_getBladeOpenerConfig(){const e=super._getBladeOpenerConfig(),t=()=>{const e=this.diContainer.get(r.Finder).findBlades(this.getPartsContainer());return e&&e.length>0&&e[0]},s=this.diContainer.get(h.JourneyManager),i=e.configureBladeDescriptor;return e.configureBladeDescriptor=e=>{i(e),e.masterInvocationProperty?.startsWith("container.")&&(e.defaultMenuItemId=this.defaultMenuItemId)},e.onBladesOpening=()=>{this.isDisposed()&&C.error(`Cannot open new blades for part '${this}', it has already been disposed and removed from the starboard. If this part was created from a Hub action, make sure it doesn't change the target blade after it has been opened.`)},e.getCloseOwnedDetailBladesHandler=e=>{let i;const o=e&&e.source&&e.source.property,n=t();return n&&n.masterPartId===this.id&&n.masterInvocationProperty===o&&!n.masterCommandName&&(i=()=>{const e=s.activeJourney();return e?s.tryDiscardJourney(e.id):s.tryDeactivateJourney()}),i},e.getCloseOtherDetailBladesHandler=e=>{let i;const o=e&&e.source&&e.source.property,n=t();return!n||n.masterPartId===this.id&&n.masterInvocationProperty===o||(i=()=>{const e=s.activeJourney();if(e)return e.isStartedWithContextBlade()?s.tryDiscardJourney(e.id):s.tryDeactivateJourney()}),i},e}_updatePartFilterState(e){const t=this.parent&&this.getPartsContainer();return t&&t.getDashboardFiltersForPart(this.id,e).then((e=>{const t=this.filters||{};e=e||{};let i=0;const o=Object.keys(t),n=Object.keys(e);if(o.length>0||n.length>0)if(0===o.length)i=1===n.length&&n.includes(s.TimeRangeFilter.filterId)?1:2;else{const o=[];for(const s in t)e[s]&&!this._deepEquals(t[s],e[s])&&o.push(s);i=0===o.length?n.length>1||!n.includes(s.TimeRangeFilter.filterId)?2:1:o.includes(s.TimeRangeFilter.filterId)&&1===o.length?3:4}this.partFilterState(i)}))}updateFilters(e){const t=this.parent&&this.getPartsContainer();if(!t)return Promise.reject(new Error("Only Parts located on Dashboards can call 'updateFilters'"));let s,i;Array.isArray(e)?s=e.reduce(((e,t)=>(e[t.filterId]=t.filterModel,e)),{}):e.dashboard||e.part?(s=e.dashboard,i=e.part):s=e;let o=!1;return i&&(o=this._updatePartFilters(i)),s?t.updateFilters(this,s):(o&&this.notifyFiltersChanged(!0),Promise.resolve())}_updatePartFilters(e){const t=MsPortalFx.clone(this.filters||{},!0,!0),s=Object.keys(e);for(let i=0;i<s.length;i++){const o=s[i],n=e[o];n?t[o]=n:delete t[o]}return!MsPortalFx.deepEquals(this.filters,t)&&(this.filters=t,this.widget.element.trigger(M,{part:this,isUserInteraction:this.hasUserInteractedRecently()}),!0)}_getTelemetryJourneyId(){}recordUserInteraction(){this._lastUserInteraction=w()}openPartSettingsBlade(){const e=!!this._updatableHeader,t=e?this._getPartHeader():void 0;this.getViewModel().container.openContextPane(new g.PdlBladeReference("PartSettingsBlade","HubsExtension",{onClosed:(s,i)=>{if(i){if(this._supportsFiltering){const e={};Object.keys(i.filters).forEach((t=>{e[t]=i.filters[t]&&u.getFilterProcessor(t).toExtensionModel(i.filters[t])})),this._updatePartFilters(e),this.notifyFiltersChanged(!1)}if(e&&i.partHeader){const e=i.partHeader;e.title===t.title&&e.subtitle===t.subtitle||(this._tracePartTelemetry("PartUpdatableHeaderChanged"),this._updateHeader(e,!0),this.widget.element.trigger("fxpartsettingchanged",{part:this,isUserInteraction:!0}))}}},parameters:{partId:this.id,partHeader:t}}))}_getPartHeader(){const{title:e,subtitle:t}=this._partHeader||{},s={title:e},i=this._updatableHeader?.options;return(!i||!i()?.disableSubtitleUpdate)&&(s.subtitle=t||""),s}_updateHeader({title:e,subtitle:t},s){const i=this._getPartHeader();i.title=e;const o=this._updatableHeader.options;!o()?.disableSubtitleUpdate&&(i.subtitle=t),this._partHeader=i,this._updatableHeader.updatedHeader(i),s&&this.widget.element.trigger(d.fxpartsettingchanged,{part:this,isUserInteraction:!0})}getConfigureOnAddToDashboardSelectorAsync(){return this.getViewModelAsync().then((e=>{const t=a.getModelValue(e,"content.configureOnAddToDashboardSelector");if(t.exists)return ko.unwrap(t.value)}))}_deepEquals(e,t){if(e=ko.unwrap(e),t=ko.unwrap(t),e===t)return!0;if(!e||!t)return!1;const s=MsPortalFx.getTypeOf(e);if(s!==MsPortalFx.getTypeOf(t))return!1;switch(s){case"array":{const s=e;return e.length===t.length&&s.every((e=>{let s=!1,i=0;for(;i<t.length;){if(this._deepEquals(t[i],e)){s=!0;break}i++}return s}))}case"date":return e.getTime()===t.getTime();case"object":{const s=Object.keys(e);return s.length===MsPortalFx.keysLength(t)&&s.every((s=>this._deepEquals(e[s],t[s])))}default:return!1}}}function I(e){return e.chrome&&e.chrome._msPortalFxV2ShellApi()}function P(e,t,s,i){i=i||{};const o=e.createChildContainer("composition"),n=new S(o,t,null,i);return n.registerForDispose((()=>o.disposeAsync())),n.calculateInitialSize(),n.modelContainsSensitiveData=i.modelContainsSensitiveData,n.containerModel=d.prepareContainerModel(s||{}),n.filters=i.filters,n.overridesModel=d.prepareContainerModel(i.overridesModel||{}),n.validateBindings(s)||(C.error("Unable to create instance of startboard part '{0}', check log for errors.".format(t.toString())),n.locator.name="##INVALID##"),i.doNotSaveSettings||n.save(),n}t.Instance=S})),
define("MsPortalImpl/UI/UI.DashboardFiltersManager",["require","exports","Fx/Composition/DashboardFilters","Fx/ResourceManagement","FxInternal/Composition/DashboardFilters","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Languages","MsPortalImpl/UI/Dashboard/FiltersSerialization","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Services/Services.Subscriptions"],(function(e,t,s,i,o,n,r,a,l,c){"use strict";t.SubscriptionFilterRuntime=t.ResourceTypeFilterRuntime=t.ResourceGroupFilterRuntime=t.LocationFilterRuntime=t.EqualityFilterRuntimeBase=t.EqualityFilterRuntime=t.DashboardFiltersManager=void 0,t.getCultureSpecificLanguage=x,t.getStaticFilterId=b,t.intrinsicFilterDescriptors=void 0,t.isCompleteFilterModel=f,t.normalizeResourceGroupId=I,t.parseResourceGroupId=P;var d=MsPortalFx.Base,p=d.Diagnostics,u=d.Diagnostics.Telemetry;const m=p.createLog(e);function g(e){return e.get(c.SubscriptionsUserContext).inSessionSelectedSubscriptions}const h=t.intrinsicFilterDescriptors=[{kind:0,filterId:s.TimeRangeFilter.filterId,displayText:n.Filtering.Intrinsics.timeRange},{kind:2,filterId:s.SubscriptionFilter.filterId,displayText:n.Filtering.Intrinsics.subscription},{kind:3,filterId:s.LocationFilter.filterId,displayText:n.Filtering.Intrinsics.location},{kind:5,filterId:s.ResourceGroupFilter.filterId,displayText:n.Filtering.Intrinsics.resourceGroup},{kind:4,filterId:s.ResourceTypeFilter.filterId,displayText:n.Filtering.Intrinsics.resourceType}].reduce(((e,t)=>(e[t.kind]=t,e)),[]);function f(e,t){if(!t)return!1;let s=!1;switch(e){case 0:{const e=t;s=e.absolute&&!!e.absolute.fromDate&&!!e.absolute.toDate||e.relative&&MsPortalFx.isNumeric(e.relative.duration)&&MsPortalFx.isNumeric(e.relative.timeUnit),e.absolute&&(s=e.absolute.toDate&&e.absolute.fromDate<e.absolute.toDate);break}case 1:case 2:case 3:case 5:case 4:{const e=t;s=MsPortalFx.isNumeric(e.operator);break}}return s}function x(e){const t=e&&e.selectedDisplayLanguage||"",s=e&&e.selectableDisplayLanguages||[],i=MsPortalFx.find(s,(e=>!MsPortalFx.localeCompareIgnoreCase(e.locale,t)));return i&&i.specificCulture||"en-us"}function b(e){const{filterKind:t}=e;return h[t]?h[t].filterId:e.filterId}t.DashboardFiltersManager=class{constructor(e,t){this._diContainer=e,this._filtersLocale=ko.observable(),this._appliedFilters=ko.observableArray(),this._currentSessionLocale=x((0,r.getCurrentLocaleContext)()),this._equalityFilterRuntimes=[],this._parent=t,this._filtersLifetime=t.createChildLifetime();const s=this._diContainer,i=this._subscriptions={getSelectedSubscriptions:()=>s.get(c.SubscriptionsUserContext).getInSessionSelectedSubscriptions().then((e=>e())),selectedSubsUpdateTriggered:g(s)};this._equalityFilterRuntimes[1]=new v,this._equalityFilterRuntimes[2]=new w(i),this._equalityFilterRuntimes[3]=new M,this._equalityFilterRuntimes[5]=new C(i),this._equalityFilterRuntimes[4]=new S;const o=ko.observableArray([]),n=o.mapInto(t,((e,t)=>{const s=ko.observable();return d.Promises.cancelOnDispose(this._filtersLifetime,t.getDashboardFiltering&&t.getDashboardFiltering()).then((e=>{e.partApi.then((t=>{s({supportsFiltering:e.supportsFiltering,supportsAddFilter:e.staticFilters.some((e=>0!==e.filterKind))||t&&!!t.getDynamicFilterDefinitions})}))})),s}));t.subscribeChildren((e=>{o(e.map((e=>e)))})),this.filtersWidgetViewModel={showDashboardFilteringUi:MsPortalFx.isFeatureEnabled("dashboardautorefresh")?ko.observable(!0):ko.pureComputed((()=>!!this._appliedFilters().length||n().some((e=>e()&&e().supportsFiltering)))),showAddFilterUi:ko.pureComputed((()=>n().some((e=>e()&&e().supportsAddFilter)))),appliedFilters:this._appliedFilters,createDashboardFilterViewmodel:()=>this._createDashboardFilterViewModel({}),getFilterUpdatingApi:()=>this._getFilterUpdatingApi().then((e=>e.filtersWidgetViewModel))},o.subscribeArrayBulkChanges(this._parent,((e,t)=>{t&&t.length&&t.forEach((e=>{this._appliedFilters.peek().forEach((t=>MsPortalFx.remove(t.filteredPartIds,e.id)))}))}));const a=ko.pureComputed(o).extend({throttle:100}),l=ko.pureComputed(this._appliedFilters).extend({throttle:100});ko.reactor(this._parent,[a,l],((e,t)=>(this._isFilterUpdatingModuleLoadingOrLoaded()?this._getFilterUpdatingApi().then((e=>e.getAllFilterDescriptors(!0).then((e=>e.map((e=>e.filterId)))))):(()=>{const t=[];return Promise.allSettled(e.map((e=>this._getPartStaticFilters(e).then((e=>{MsPortalFx.pushUnique(t,e)}))))).then((()=>t))})()).then((e=>{this._ensureTimeRangeFilter(e),t.forEach((t=>{const s=e.includes(t.id())||t.filteredPartIds&&t.filteredPartIds.length>0;t.isApplicable(s)}))}))))}updateFilters(e,t){return this._getFilterUpdatingApi().then((s=>s.updateFilters(e,t)))}getFilters(){return this._appliedFilters.peek().filter((e=>{const t=e.model();return 2!==t.selectAllState||t.values&&0===t.values.length})).reduce(((e,t)=>{const s=t.id(),i=t.model(),o=t.kind();return"string"==typeof s&&f(o,i)&&(e[s]=this.toExtensionModel(o,i)),e}),{})}loadDashboard(e){this.resetFilters(),this._filtersLocale(e&&e.filterLocale||this._currentSessionLocale);const t=e&&e.filters||{},s=Object.keys(t),i=s.map((e=>{const s=((e,t)=>({kind:(0,o.getFilterKindFromId)(e),model:(0,a.getFilterProcessor)(e).fromJSON(t.model),displayCache:t.displayCache,filteredPartIds:t.filteredPartIds}))(e,t[e]),i=s.kind;if(!f(i,s.model))return;const n=this._createDashboardFilterViewModel({id:e,model:s.model,kind:i,filterIdDisplayText:s.displayCache.name,filterValueDisplayText:s.displayCache.value,filteredPartIds:s.filteredPartIds});return this._activateFilter(n),n})).filter((e=>!!e));this._appliedFilters.push(...i),u.trace({source:"DashboardFilters",action:"DashboardFiltersLoaded",data:{filterIds:s.toString()}})}setFilters(e){this._filtersLifetime||(this._filtersLifetime=this._parent.createChildLifetime());const t=Object.keys(e).map((t=>{const s=e[t];return this._createDashboardFilterViewModel({id:t,model:this.fromExtensionModel(s.filterKind,s.filterModel),kind:s.filterKind})}));this._appliedFilters(t)}toJSON(){return this._appliedFilters().length?this._getFilterUpdatingApi().then((e=>e.toJSON())):Promise.resolve({})}getDashboardFiltersForPart(e,t){if(t||this._isFilterUpdatingModuleLoadingOrLoaded())return this._getFilterUpdatingApi().then((t=>t.getDashboardFiltersForPart(e)));{const t=MsPortalFx.find(this._parent.children,(t=>t.id===e));if(!t){const t=new Error("Error retrieving dashboard filters for part '{0}'. Part could not be found.".format(e));return m.error(t),Promise.resolve({})}return this._getPartStaticFilters(t).then((t=>this._appliedFilters.peek().filter((s=>s.filteredPartIds.includes(e)||t.includes(s.id()))).reduce(((e,t)=>(e[t.id()]=this.toExtensionModel(t.kind(),t.model()),e)),{})))}}getFilterValues(e,t,s){return this._getFilterUpdatingApi().then((i=>i.getFilterValues(e,t,s)))}getFilterIdTextAndOperators(e,t){return this._getFilterUpdatingApi().then((s=>s.getFilterIdTextAndOperators(e,t)))}getFilterValueDisplayText(e,t,s){return this._getFilterUpdatingApi().then((i=>i.getFilterValueDisplayText(e,t,s)))}getFiltersSupportedByPart(e){return this._getFilterUpdatingApi().then((t=>t.getFiltersSupportedByPart(e)))}getFilterWarning(e,t){return this._equalityFilterRuntimes[(0,o.getFilterKindFromId)(e)].getFilterWarning(t)}_createDashboardFilterViewModel(e){const t=this._filtersLifetime.createChildLifetime();return{id:ko.observable(e.id),kind:ko.observable(e.kind),kindLifetime:t,model:ko.observable(e.model),isApplicable:ko.observable(!0),filterIdDisplayText:e.filterIdDisplayText,filterValueDisplayText:e.filterValueDisplayText,warningMessage:ko.observable(""),filteredPartIds:e.filteredPartIds||[]}}_ensureTimeRangeFilter(e){const t=this._appliedFilters.peek(),i=MsPortalFx.find(t,(e=>e&&0===e.kind())),o=e.includes(s.TimeRangeFilter.filterId);!i&&o&&d.Promises.cancelOnDispose(this._filtersLifetime,this._getFilterUpdatingApi()).then((e=>e.addTimeRangeFilter()))}resetFilters(){this._filtersLifetime&&this._filtersLifetime.dispose(),this._filtersLifetime=this._parent.createChildLifetime(),this._appliedFilters([])}dispose(){this._filtersLifetime&&this._filtersLifetime.dispose()}toExtensionModel(e,t){return(0,a.getFilterProcessor)(e).toExtensionModel(MsPortalFx.extend2(t,{selectAllState:void 0}))}fromExtensionModel(e,t){return(0,a.getFilterProcessor)(e).fromExtensionModel(t)}_activateFilter(e){const{kind:t,kindLifetime:s}=e,i=t();0!==i&&this._equalityFilterRuntimes[i].activateFilter(s,e)}_normalizeEqualityFilterValue(e,t){return this._equalityFilterRuntimes[e].normalizeFilterValue(t)}_getFilterUpdatingApi(){return this._filterUpdatingModulePromise||(this._filterUpdatingModulePromise=d.Promises.cancelOnDispose(this._parent,MsPortalFx.require("MsPortalImpl/UI/UI.DashboardFiltersManager.Updating").then((e=>(this._parent.widget&&this._parent.widget.element.attr("data-filterupdatingloaded",!0),new e.DashboardFiltersUpdatingImpl(this._diContainer,this._parent,{appliedFilters:this._appliedFilters,getDashboardLifetime:()=>this._filtersLifetime,activateFilter:e=>this._activateFilter(e),createDashboardFilterViewModel:e=>this._createDashboardFilterViewModel(e),ensureTimeRangeFilter:e=>this._ensureTimeRangeFilter(e),normalizeEqualityFilterValue:(e,t)=>this._normalizeEqualityFilterValue(e,t),subscriptions:this._subscriptions})))))),this._filterUpdatingModulePromise}_isFilterUpdatingModuleLoadingOrLoaded(){return!!this._filterUpdatingModulePromise}_getPartStaticFilters(e){return d.Promises.cancelOnDispose(this._filtersLifetime,e.getDashboardFiltering()).then((e=>e.staticFilters.map(b)))}};class y{activateFilter(e,t){}getFilterWarning(e){return Promise.resolve("")}}t.EqualityFilterRuntimeBase=y;class v extends y{normalizeFilterValue(e){return e}}t.EqualityFilterRuntime=v;class w extends y{constructor(e){super(),this._subscriptions=e}activateFilter(e,t){ko.reactor(e,[t.model,this._subscriptions.selectedSubsUpdateTriggered],(()=>this.getFilterWarning(t.model()).then((e=>{t.warningMessage(e)}))))}normalizeFilterValue(e){return e.toLowerCase()}getFilterWarning(e){return 0!==e.selectAllState||(0,a.isSubstringFilterModel)(e)?Promise.resolve(""):this._subscriptions.getSelectedSubscriptions().then((t=>!e.values.some((e=>!t.some((t=>t.subscriptionId.toLowerCase()===e.toLowerCase()))))?"":n.Filtering.Subscription.subscriptionFilterUsingExcludedSubscriptions))}}t.SubscriptionFilterRuntime=w;class M extends y{constructor(){super()}normalizeFilterValue(e){return e}}t.LocationFilterRuntime=M;class C extends y{constructor(e){super(),this._subscriptions=e}activateFilter(e,t){ko.reactor(e,[t.model,this._subscriptions.selectedSubsUpdateTriggered],(()=>{this.getFilterWarning(t.model()).then((e=>{t.warningMessage(e)}))}))}getFilterWarning(e){return 0!==e.selectAllState||(0,a.isSubstringFilterModel)(e)?Promise.resolve(""):this._subscriptions.getSelectedSubscriptions().then((t=>!e.values.some((e=>{const s=P(e),{subscription:i}=s;return!t.some((e=>e.subscriptionId.toLowerCase()===i.toLowerCase()))}))?"":n.Filtering.ResourceGroup.resourceGroupFilterUsingExcludedSubscriptions))}normalizeFilterValue(e,t){return I(e,t)||e}}t.ResourceGroupFilterRuntime=C;class S extends y{constructor(){super()}normalizeFilterValue(e){const{resourceType:t,resourceKind:s}=e,i={resourceType:t.toLowerCase()};return s&&(i.resourceKind=s.toLowerCase()),i}}function I(e,t){const s=P(e,t);return s&&i.ArmId.stringify(s,4)}function P(t,s,o){const n=i.ArmId.parse(t,!0);if(4===n.kind)return n;if(!o){const i=new Error(`Invalid resource group id '${JSON.stringify(t)}'`);s?(0,l.logToExtension)(e,s.widget.element,2,i):m.error(i)}}t.ResourceTypeFilterRuntime=S})),
define("MsPortalImpl/Weave/LazyControls",["require","exports","MsPortalImpl/Weave/Util"],(function(e,t,s){"use strict";t.LazyTextBox=t.LazySection=t.LazyPillCollection=t.LazyNotice=t.LazyInfoBox=t.LazyCustomHtml=t.LazyCheckBox=void 0;t.LazySection=(0,s.createControlLazyComponentForKO)((()=>MsPortalFx.require("MsPortalImpl.Controls/Fields/Section"))),t.LazyTextBox=(0,s.createControlLazyComponent)((()=>MsPortalFx.require("MsPortalImpl.Controls/Fields/TextField"))),t.LazyCheckBox=(0,s.createControlLazyComponent)((()=>MsPortalFx.require("MsPortalImpl.Controls/Fields/CheckBoxField"))),t.LazyPillCollection=(0,s.createControlLazyComponent)((()=>MsPortalFx.require("MsPortalImpl/Controls/Controls.PillCollection"))),t.LazyCustomHtml=(0,s.createControlLazyComponentForKO)((()=>MsPortalFx.require("MsPortalImpl.Controls/Fields/CustomHtmlField"))),t.LazyInfoBox=(0,s.createControlLazyComponentForKO)((()=>MsPortalFx.require("MsPortalImpl/Controls/Controls.InfoBox"))),t.LazyNotice=(0,s.createControlLazyComponentForKO)((()=>MsPortalFx.require("MsPortalImpl/Controls/Controls.Notice")))})),
define("_generated/MsPortalImpl/Svg/Library/Copy.svg",["require","exports"],(function(e,t){"use strict";t.type=t.data=void 0;t.type=338,t.data="<svg viewBox='0 0 14 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M14 6.3V16H4v-3H0V0h6.7l3 3h1zM4 3h4.3l-2-2H1v11h3zm9 4h-3V4H5v11h8zm-2-1h1.3L11 4.7z'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Startup/CaretDown.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=286,t.data="<svg viewBox='0 0 14.7 8.1' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m.7 0 6.7 6.6L14 0l.7.7-7.3 7.4L0 .7.7 0z'/></g></svg>"})),
define("_generated/MsPortalImpl/Svg/Startup/Share.svg",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.data=t.type=void 0,t.type=324,t.data="<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='m14.9 10.4.4.4.4.5a1.4 1.4 0 0 1 .2.6 1.3 1.3 0 0 1 .1.6 3.6 3.6 0 0 1-.2 1 3.5 3.5 0 0 1-.5.8l-.8.5-1 .2a2 2 0 0 1-1.3-.4 5.4 5.4 0 0 1-2 1A5.4 5.4 0 0 1 8 16a5.7 5.7 0 0 1-2.2-.4 5.4 5.4 0 0 1-2-1 2 2 0 0 1-1.3.4l-1-.2-.8-.5a3.5 3.5 0 0 1-.5-.8 3.6 3.6 0 0 1-.2-1 1.3 1.3 0 0 1 .1-.6 1.4 1.4 0 0 1 .2-.6l.4-.5c.1-.2.3-.3.4-.4a1.7 1.7 0 0 0-.1-.7V9a7.6 7.6 0 0 1 .3-2.1A6.6 6.6 0 0 1 2.2 5l1.5-1.5a5.2 5.2 0 0 1 1.8-1 3 3 0 0 1 .2-1 2.2 2.2 0 0 1 .5-.8L7 .2 8 0l1 .2.8.5a2.2 2.2 0 0 1 .5.8 3 3 0 0 1 .2 1 5.2 5.2 0 0 1 1.8 1L13.8 5a6.6 6.6 0 0 1 .9 1.9A7.6 7.6 0 0 1 15 9v.7a1.7 1.7 0 0 0-.1.7zM1 12.5a1.3 1.3 0 0 0 .1.6l.3.5.5.3h1.2l.5-.3.3-.5a1.3 1.3 0 0 0 .1-.6 1.3 1.3 0 0 0-.1-.6l-.3-.5-.5-.3H1.9l-.5.3-.3.5a1.3 1.3 0 0 0-.1.6zM8 15a5.7 5.7 0 0 0 1.8-.3 4.8 4.8 0 0 0 1.6-.8l-.3-.7a1.5 1.5 0 0 1-.1-.7 3.6 3.6 0 0 1 .2-1 3.5 3.5 0 0 1 .5-.8l.8-.5 1-.2h.4a3.4 3.4 0 0 0 .1-1 5.7 5.7 0 0 0-.3-1.8 4.1 4.1 0 0 0-.7-1.5 4.9 4.9 0 0 0-1.2-1.3 3.8 3.8 0 0 0-1.5-.9l-.4.6c-.1.2-.3.3-.5.5l-.7.3H7.3l-.7-.3-.5-.5-.4-.6a3.8 3.8 0 0 0-1.5.9A4.9 4.9 0 0 0 3 5.7a5.1 5.1 0 0 0-.7 1.5A5.7 5.7 0 0 0 2 9a3.4 3.4 0 0 0 .1 1h1.1l.9.5a2.7 2.7 0 0 1 .7.8 4.3 4.3 0 0 1 .2 1.2 1.5 1.5 0 0 1-.1.7l-.3.7a4.8 4.8 0 0 0 1.6.8A5.7 5.7 0 0 0 8 15zM8 1h-.6l-.5.3-.3.5a1.3 1.3 0 0 0-.1.6 1.3 1.3 0 0 0 .1.6l.3.5.5.3h1.2l.5-.3.3-.5a1.3 1.3 0 0 0 .1-.6 1.3 1.3 0 0 0-.1-.6l-.3-.5-.5-.3zm5.5 13h.6l.5-.3.3-.5a1.3 1.3 0 0 0 .1-.6 1.3 1.3 0 0 0-.1-.6l-.3-.5-.5-.3h-1.2l-.5.3-.3.5a1.3 1.3 0 0 0-.1.6 1.3 1.3 0 0 0 .1.6l.3.5.5.3z'/></g></svg>"})),
define("MsPortalImpl/Widgets/Widgets.StartBoard.Component",["require","exports","Weave/DirectMode","Weave","WeaveDOM/DirectRender/DataAttribute","Fx/Composition/Selectable","FxInternal/Weave","FxInternal/Weave/Components/Button","FxInternal/AsyncLoader","FxInternal/Weave/Util","_generated/MsPortalImpl/Svg/Startup/CaretDown.svg","_generated/MsPortalImpl/Svg/Library/Copy.svg","_generated/MsPortalImpl/Svg/Startup/Share.svg","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Interactions/Interactions.FullScreenMode","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/Weave/LazyControls","MsPortalImpl/Widgets/Widgets.DropMenu.Component","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Widgets/Widgets.Portal"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x,b,y,v,w){"use strict";t.StartBoardInner=function(e){const{vm:t,commandContextBinder:C}=e,T=(0,r.toComputation)(ko.observable(MsPortalFx.isFeatureEnabled("transformdashboard"))),k=t.headerMode.compose((e=>{const t=["fxs-startboard-header"];return 1===e?t.push("fxs-startboard-header-normal"):2===e&&t.push("fxs-startboard-header-migration"),t.join(" ")}));let E;return{focusOnDropMenu:()=>{E&&E.setFocus()},tsxNode:s(i.GetContext,{fn:e=>{const D=e.diContainer,A=D.get(w.ViewModel),B=A.displayMode.compose((e=>"Dashboard"===e)),N=t.title,R=t.isShared,L=`${h.Dashboard.sharedDashboard} | ${h.Dashboard.readOnlydDashboard}`,z=(0,i.composeComputation)([R,t.userPermissions],((e,{canModify:t})=>e?t?h.Dashboard.sharedDashboard:L:h.Dashboard.privateDashboard)),H=D.get(g.FullScreenMode),O=D.get(f.DesktopManagerMode).value,U=(0,r.toComputation)(O).compose((e=>1===e));return s(i.Fragment,null,s(i.Once,{"data-odebug":"17",condition:B,trueFn:()=>{return s(i.Fragment,null,s("div",{className:"fxs-startboard-loadanimation"},s("div",{className:"fxs-splashscreen-loader-container fxs-loading5dots-container"},s("div",null),s("div",null),s("div",null),s("div",null),s("div",null))),s("div",{className:k},s("div",{className:"fxs-startboard-title-next"},s("div",{className:"fxs-startboard-title-content"},s(i.If,{condition:R,concealmentBehavior:"remove",trueFn:()=>s("div",{className:"fxs-startboard-button-icon az-noprint",image:u})}),s("div",{className:"fxs-startboard-title",title:N},N)),s("div",{className:["fxs-startboard-subtitle",{"fxs-startboard-subtitle-shared":R}]},z)),s("div",{className:"fxs-startboard-header-item fxs-startboard-dropdown",afterMount:(e,s)=>{E=new v.Widget($(e),t.dashboardDropMenuViewModel,!0,!0),s.registerForDispose((()=>{E.dispose(),E=null}))}},s(y.DropMenuInner,{button:s("div",{className:"fxs-startboard-dropdown-button fxs-portal-hover"},s("div",{className:"fxs-startboard-title-container"},s(i.If,{condition:R,concealmentBehavior:"remove",trueFn:()=>s("div",{className:"fxs-startboard-button-icon az-noprint",image:u})}),s("div",{className:"fxs-startboard-title",title:N},N),s("div",{className:"fxs-startboard-button-icon az-noprint",image:M.CustomImageWithOptions(d,{palette:99})})),s("div",{className:["fxs-startboard-subtitle",{"fxs-startboard-subtitle-shared":R}]},z)),content:s("div",{className:"fx-dropmenu-dropdown"},s("ul",{className:"fxs-dropmenu-list-system",role:"menu","aria-label":h.Dashboard.recentMenuLabel},s(i.If,{condition:t.dashboardList,concealmentBehavior:"remove",trueFn:()=>s(i.Fragment,null,s(i.If,{condition:t.dashboardList.compose(c.isEmptyArray),concealmentBehavior:"remove",trueFn:()=>s("li",{className:"fxs-startboard-dropdown-item",role:"menuitem",tabindex:"-1"},s("div",{className:"fxs-dropmenu-list-content"},h.Dashboard.emptynext))}),s(i.ForEach,{collection:t.dashboardList,fn:({item:t})=>{const i=!t.id.includes("private");return s("li",{className:["fxs-startboard-dropdown-item","fxs-startboard-dropdown-dashboard","fxs-portal-hover","msportalfx-tooltip-overflow"],role:"menuitem",tabindex:"-1","aria-label":t.title+(i?" "+h.Dashboard.sharedStatusLabel:""),data:t,onClick:e,onKeyDown:e},s("div",{className:"fxs-dropmenu-list-content fxs-startboard-item-container"},s("div",{className:"fxs-startboard-item-icon fxs-portal-svg",image:i?u:null}),s("div",{className:"fxs-startboard-item-title"},t.title)))}})),falseFn:()=>s("li",{className:"fxs-startboard-dropdown-item",role:"menuitem",tabindex:"-1"},s("div",{className:"fxs-tile-progress-transparent fxs-loading5dots-container"},s("div",null),s("div",null),s("div",null),s("div",null),s("div",null)))}),s(i.PromiseFragment,{"data-odebug":"p12",promise:_(t,C)}))),vm:t.dashboardDropMenuViewModel})),s("input",{type:"text",className:"fxs-startboard-header-item fxs-startboard-title-edit fxs-hide-in-normal",maxlength:200,value:N,"aria-label":h.Dashboard.titleLabel,onValueChange:({value:e})=>t.title(e),onBlur:({event:e})=>{$(e.target).trigger(S)}}),s(i.Once,{"data-odebug":"18",condition:(0,r.toComputation)(H.isActive),trueFn:()=>s(i.PromiseFragment,{"data-odebug":"p13",promise:P(t,C,!0)})}),s("div",{className:"fxs-startboard-header-item fxs-startboard-migration",role:"menubar"},s("button",{type:"button",role:"menuitem",className:"fxs-startboard-button fxs-startboard-button-migrate fxs-portal-hover",title:h.Dashboard.migrate,tabindex:"0",onClick:({event:e})=>{$(e.currentTarget).trigger(I)}},s("div",{className:"fxs-startboard-button-icon","aria-hidden":"true",image:M.CustomImageWithOptions(p,{palette:99})}),s("div",{className:"fxs-startboard-button-text"},h.Dashboard.migrate))),s(i.Once,{"data-odebug":"19",condition:A.topBar.newDashboardSaveEnabled,trueFn:()=>function(e,t){const o=h.Dashboard.Actions,n=(0,i.composeComputation)([t,e.dashboardChanged],((e,t)=>e||t)),r=(0,i.composeComputation)([t,e.userPermissions,e.dashboardChanged],((e,{canModify:t},s)=>s||e&&!t)),l=(0,i.composeComputation)([t,e.dashboardChanged],((e,t)=>e&&t)),c=e.userPermissions.compose((({canModify:e})=>e?o.save:o.saveCopy));return s("div",{className:"fxs-startboard-actions"},s(a.Button,{className:"fxs-startboard-actions-save",text:c,style:0,visible:r,loading:e.dashboardSaveInProgress,onClick:()=>{const t=e.userPermissions.value.canModify,s=t?1:2;F(t?"DashboardPublish":"DashboardSaveACopy"),e.finishDashboardEdit(s,"StartBoard")}}),s(a.Button,{className:"fxs-startboard-actions-preview",text:o.preview,style:1,visible:l,onClick:()=>{F("CustomizeModeExited",{dashboardChanged:!!e.dashboardChanged.value}),e.exitOrganizeMode()}}),s(a.Button,{className:"fxs-startboard-actions-cancel",text:o.cancel,style:1,visible:n,onClick:()=>{F("DashboardDiscard"),e.finishDashboardEdit(3)}}))}(t,U)})),s(i.PromiseFragment,{"data-odebug":"p14",promise:P(t,C)}),s("div",{className:"fxs-startboard-filter",afterMount:(e,s)=>{if(t.filtersWidgetViewModel){const i=s.createChildLifetime();t.filtersWidgetViewModel.showDashboardFilteringUi.subscribeAndRun(i,(o=>{o&&(i.dispose(),l.get("MsPortalImpl/Widgets/Widgets.DashboardFilters","Widget").then((i=>{s.registerForDispose(new i($(e.parentElement),t.filtersWidgetViewModel,D))})))}))}}}),s("div",{className:"fxs-startboard-customize-header fxs-hide-in-normal"},s(i.If,{condition:U,trueFn:()=>s(i.PromiseFragment,{"data-odebug":"p15",promise:P(t,C,!1,!0)})}),s("div",{className:"fxs-startboard-customize-description"},h.Dashboard.editDescription)),s(i.If,{condition:(0,i.composeComputation)([t.userPermissions,U],(({canModify:e},t)=>t&&!e)),trueFn:()=>s(i.LifetimeManagerScoped,{fn:e=>s(b.LazyInfoBox,{className:"fxs-startboard-warning",vm:t=>t.createVm(e,{style:4,text:h.Dashboard.readOnlyWarningMsg,ariaLabel:h.Dashboard.readOnlyWarningMsg})})})}),s(i.If,{condition:t.dashboardErrorMessage.compose(c.isNonEmptyString),trueFn:()=>s(i.LifetimeManagerScoped,{fn:e=>s(b.LazyInfoBox,{className:"fxs-startboard-error",vm:s=>s.createVm(e,{style:5,text:(0,r.toObservable)(e,t.dashboardErrorMessage),ariaLabel:(0,r.toObservable)(e,t.dashboardErrorMessage)})})})}),s(i.If,{condition:T,concealmentBehavior:"remove",trueFn:()=>{const e=()=>{MsPortalFx.require("MsPortalImpl/UI/UI.BladeOpenerImpl").then((e=>{const s=e.BladeOpener;return t.diContainer.get(x.GetCurrentDashboardPropertiesPortalFunc).invoke(null,"ShellCommands").then((e=>{const i=new n.PdlBladeReference("Dashboards.ReactView","Microsoft_Azure_PortalDashboard",{parameters:{id:e.originalId||e.id,isV1:!0}});return t.diContainer.get(s).openBlade(i,{flags:8,telemetryName:"UI.DashboardCommands:TransformDashboard"})}))}))};return s(i.LifetimeManagerScoped,{fn:t=>s(b.LazyInfoBox,{className:"fxs-startboard-info",vm:s=>s.createVm(t,{style:1,canClose:!0,text:{htmlTemplate:"<span data-bind='text: message'></span> <a data-bind='text: tryText, fxclick: onClick'></a>",viewModel:{message:h.Dashboard.transformDashboard,tryText:h.Dashboard.tryV2,onClick:e}},ariaLabel:h.Dashboard.transformDashboard})})})}}));function e(e){const s=e.event;if("keydown"===s.type&&(13!==s.keyCode&&32!==s.keyCode||0!==(0,m.getModifierKeys)(s)))return;const i=(0,o.getElementData)(s.currentTarget);s.preventDefault(),s.stopPropagation(),t.switchDashboard&&t.switchDashboard(i).then((()=>{if(E){const e=E.element,t=Math.min(Math.max(e.outerWidth()+50,400),560);e.find(".fxs-dropmenu-content").css({minWidth:t})}})),t.dashboardDropMenuViewModel.close()}}}),s("div",{className:"fxs-startboard-layout fxs-flowlayout"},s(i.Once,{"data-odebug":"20",condition:(0,r.toComputation)(A.inOrganizeMode),trueFn:()=>{const e=t.flowLayoutOptions.resolutionGuidesOffset,o=e.y+"px",n=e.x+"px";return s(i.Fragment,null,[{x:3840,y:2160},{x:1920,y:1080},{x:1440,y:900},{x:1366,y:768},{x:1024,y:768}].map((e=>s("div",{className:`fxs-flowlayout-resolutionguide fxs-flowlayout-resolutionguide-${e.x}x${e.y} fxs-hide-in-normal`,style:{top:o,left:n}}))))}}),s("div",{className:"fxs-flowlayout-childcontainer",style:{height:t.flowLayoutOptions.childContainerHeight,width:t.flowLayoutOptions.childContainerWidth}})),s("div",{className:"fxs-startboard-message-container"},s("div",{className:"fxs-startboard-message-title"},h.Dashboard.NotFound.title),s("div",{className:"fxs-startboard-message-body"},t.notFoundMessage)))}})}};var M=MsPortalFx.Base.Images,C=MsPortalFx.Base.Diagnostics.Telemetry;const S="fxstartboardtitlechanged",I="fxmigratestartboard";async function P(e,t,o,n){const[r,a]=await Promise.all([MsPortalFx.require("MsPortalImpl/UI/Dashboard/UI.DashboardCommands"),MsPortalFx.require("MsPortalImpl/Widgets/Widgets.CommandBar")]);return s(i.GetContext,{fn:l=>s(i.LifetimeManagerScoped,{fn:i=>{const c=l.diContainer,d=a.CommandBar;if(o){const o=r.initializeFullScreenCommandBar(i,c,e,t);return s(d,{className:["fxs-startboard-commandBar-fullScreen az-noprint",{"az-display-none":e.headerMode.compose((e=>2===e))}],vm:o})}if(n){const t=r.initializeOrganizeModeCommandBar(i,e);return s(d,{className:"fxs-startboard-commandBar-organize az-noprint",vm:t})}const p=r.initializeCommandBar(i,c,e,t);return s(d,{className:["fxs-startboard-commandBar az-noprint",{"az-display-none":e.headerMode.compose((e=>2===e))}],vm:p})}})})}async function _(e,t){const o=await MsPortalFx.require("MsPortalImpl/UI/Dashboard/UI.DashboardCommands");return s(i.GetContext,{fn:i=>{const n=i.diContainer.get(o.OpenBrowseDashboardsPane);return s("li",{className:["fxs-startboard-dropdown-item","fxs-startboard-dropdown-browseall","fxs-portal-hover"],role:"menuitem"},s("div",{className:"fxs-startboard-dropdown-subscriptions"},e.subscriptionsInfo),s("a",{tabindex:"-1",href:"#",className:"fxs-startboard-button-browse fxs-portal-text-primary",afterMount:e=>{t(n,e)},onClick:({event:e})=>{e.preventDefault(),n.execute(!1)}},h.Dashboard.browseAll))}})}function F(e,t){C.trace({source:"StartBoard",action:e,data:t})}})),
define("MsPortalImpl/UI/Compositions/UI.Composition.StartBoard",["require","exports","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter","MsPortalImpl/UI/Compositions/UI.Composition.Finder","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart","MsPortalImpl/UI/UI.DashboardFiltersManager","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/Widgets/Widgets.Portal","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Parts/Parts","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Weave/DirectRender","MsPortalImpl/Widgets/Widgets.StartBoard.Component"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x,b,y,v,w,M,C,S,I){"use strict";t.fxstartboardsettingchanged=t.Instance=void 0,t.getPinPartOptions=N,t.isStartboardPartKey=function(e){return e!==o.desktopSettingsKey&&e!==o.startBoardSettingsKey&&!e.startsWith(d.partIdentityStatePrefix)},t.resolvePartReference=R;var P=MsPortalFx.Base.Diagnostics,_=P.Telemetry,F=p.ReferenceScope,T=MsPortalFx.Parts,k=T.PartSize;const E=P.createLog(e),D=t.fxstartboardsettingchanged="fxstartboardsettingchanged";const A=o.startBoardSettingsKey;class B extends a.Instance{constructor(e){super(A,e,null,[],null,A),this._diContainer=e,this._partAwaiter=new l.CompositionAwaiter(!0),this._containerAwaiter=new l.CompositionAwaiter,this.masterContainer=null,this.notFound=ko.observable(!1),this.containerType=0,this.eligibleForBinding=!1,this._browser=e.get(w.Browser),this._store=4,this.registerForDispose(this.dashboardFiltersManager=new m.DashboardFiltersManager(e,this))}static create(e){return new B(e)}getCompositionType(){return r.CompositionType.Startboard}setGetDashboard(e){if(this._getDashboard)throw new Error("GetDashboard can only be set once by DashboardManager");this._getDashboard=e}removeGetDashboard(){this._getDashboard=null}getDashboard(){const e=this._getDashboard;return e?e():null}onDetailContainersChanged(){}getDeepLink(){return Promise.resolve("")}toJSON(){const e=super.toJSON(),t=this._getDashboard?this._getDashboard():null;if(t){e.dashboardId=t.id,e.dashboardTitle=t.title;const s=t.model;e.dashboardModel=s?{model:ko.toJS(s.model),metadata:MsPortalFx.clone(s.metadata,!0)}:void 0}return delete e.children,e}getInputPropertyBindings(){throw new Error("Unreachable code")}getViewModel(e){let t;if(8===(e=MsPortalFx.isNullOrUndefined(e)?8:e)){const e=this._getDashboard&&this._getDashboard().model;if(!e)throw new Error("There is no current Dashboard.");t=e.model}return t||{}}getViewModelAsync(e){return Promise.resolve(this.getViewModel(e))}getCompatibleSourceReferences(e){const t=this._getDashboard&&this._getDashboard().model,s=t&&t.metadata;if(s){const t=e.type;if(t){return Object.keys(s).filter((e=>s[e]===t)).map((e=>({property:e,modelType:8,scope:F.CurrentContainer,cardinality:p.ReferenceCardinality.OneToOne})))}}return null}getFilters(){return this.dashboardFiltersManager&&this.dashboardFiltersManager.getFilters()}updateFilters(e,t){return this.dashboardFiltersManager&&this.dashboardFiltersManager.updateFilters(e,t)||Promise.resolve()}getDashboardFiltersForPart(e,t){return this.dashboardFiltersManager&&this.dashboardFiltersManager.getDashboardFiltersForPart(e,t)||Promise.resolve({})}getFilterIdsForPart(e){return this.dashboardFiltersManager&&this.dashboardFiltersManager.getFiltersSupportedByPart(e)}setFilters(e){return this.dashboardFiltersManager&&this.dashboardFiltersManager.setFilters(e)}getPartInstance(e){return MsPortalFx.find(this.children,(t=>t.id===e))}_compose(e,t){const s=this.diContainer,o=this.createChildLifetime(),n=e.options,a=n.getStartBoardArea(),l=new x.ViewModel(this.id,this.widgetState(),this.dashboardFiltersManager&&this.dashboardFiltersManager.filtersWidgetViewModel,function(e,t){const s=[],o=new h.EnterOrganizeMode(e,t,!0);return o.text(i.Dashboard.edit),s.push(new h.ResetStartBoardCommand(e,t),o,new h.ExitOrganizeMode(e,t)),s}(o,s),n.startboardLoading,n.startboardNotFound,this.diContainer),c=this._getDashboard?this._getDashboard().title:null;c&&l.title(c);const{focusOnDropMenu:d,tsxNode:p}=(0,I.StartBoardInner)({vm:l,commandContextBinder:(e,t)=>{e.bind(new g.CompositionInstanceCommandContext(t,null,this))}});(0,S.applyToElement)({element:a[0],ltm:this,weaveNode:p,weaveContext:{diContainer:s},opName:"Startboard"}),this.widget=new x.Widget(a,l,d),a.data(r.CompositionInstanceDataName,this),this.widget.ltm.registerForDispose([o,a.setEvents([b.Widget.viewSettingsChanged,(e,t)=>{e.stopPropagation(),this.widgetState(t),a.trigger(D)}],["fxunpin",(e,t)=>{const s=MsPortalFx.find(this.children,(0,r.getIdMatchFunc)(t.tileId));if(s){const e=this.widget;E.warning("Part '{0}' is about to be removed due to user unpin operation.".format(s)),this.removeTile(s),setTimeout((()=>{const t=this.diContainer.get(f.ViewModel),s=t.topBar.newDashboardSaveEnabled.value?e.element.find(".fxs-startboard-actions-save .fxs-button"):t.topBar.getWidget().element.find(".fxs-topbar-dashboard-save .fxs-button");s?s.focus():e.setFocus()}),50)}}])]),t.resolve()}removeTile(e,t){if(e){let s;const o=this._diContainer.get(y.JourneyManager),r=o.activeJourney();r&&r.originTile===e&&(s=r.id);const a=e.editScopeId()&&this._diContainer.get(n.EditScopeManager).getStateObservable(e.editScopeId()),l=!a||0===a()||2===a(),c=!s||o.canDiscardJourney(s),d=t&&t.force||l&&c;(d||this._browser.confirm(i.Desktop.confirmEditScopeDiscard))&&(s&&o.forceDiscardJourney(s),e.clearIdentitySettings(),this.removeChild(e,!1,t&&t.skipSave),d||E.warning("Part '{0}' is removed from the start board.".format(e)))}}resetLayout(e){return this.diContainer.get(v.ResetDashboardPortalFunc).invoke({duringPortalStartup:!1,force:e},"Dashboard")}clearStartboard(e){this.dashboardFiltersManager&&this.dashboardFiltersManager.resetFilters(),this.children.slice().forEach((e=>this.removeTile(e,{force:!0,skipSave:!0}))),!e&&this.save()}dispose(){super.dispose(!0)}get journeyPath(){return[]}getComposedParts(){return this._partAwaiter.resolvedCompositions}awaitComposedPart(e,t){return this._partAwaiter.await(e,t)}notifyPartComposed(e){this._partAwaiter.resolve(e)}awaitContainer(e,t){return this._containerAwaiter.await(e,t)}notifyContainer(e){this._containerAwaiter.resolve(e)}onInvocationStarted(){}getDiagnosticsData(){const e=this.diContainer.get(c.Finder).findBlades(this);return $.extend(super.getDiagnosticsData(),{detailBlades:e.map((e=>e+""))})}createStartBoardPart(e,t,i){if(!e)return void E.error("options should be specified for adding a part to the startboard.");if(!e.locator)return void E.error("options.originPartLocator should be specified for adding a part to the startboard.");let o={locator:e.locator,newBindings:void 0};e.ignoreRedirects||(o=z(this._diContainer.get(s.DefinitionFinder),e.locator,e.telemetryAction));const n=e.model,r=u.create(this._diContainer,o.locator,n,{modelContainsSensitiveData:e.modelContainsSensitiveData,filters:e.filters,pinnedBladeDeeplink:e.deepLink,duringPortalStartup:t});o.newBindings&&(r.getInstanceBindings=()=>o.newBindings);const a=e.defaultMenuItemId;return a&&(r.defaultMenuItemId=a),T.PartSize[e.initialSize]&&(r.initialSize=e.initialSize,e.initialSize===T.PartSize.Custom&&(r.initialHeight=e.initialHeight,r.initialWidth=e.initialWidth)),r}pinPartReferences(e,t){const i=e.map((e=>R(this._diContainer.get(s.DefinitionFinder),e,t,"PinPartReferences").then((e=>this.createStartBoardPart(e)))));return Promise.allSettled(i).then((e=>e.map((e=>"fulfilled"===e.status?e.value:void 0))))}pinBladeToStartboard(e){const t=e.locator.getExtensionLocator(),i=this.diContainer.get(s.DefinitionFinder);return N(e,i,t.name).then((t=>{const{locator:s,newBindings:o}=z(i,t.locator,t.telemetryAction);return i.locateAsync(s).then((()=>{const i=u.create(this._diContainer,s,t.model,{filters:t.filters,pinnedBladeDeeplink:e.deepLink});o&&(i.getInstanceBindings=()=>o);const{initialSize:n,initialHeight:r,initialWidth:a}=t;return T.PartSize[n]&&(i.initialSize=n,n===k.Custom&&(i.initialHeight=r,i.initialWidth=a)),i.defaultMenuItemId=t.defaultMenuItemId,i}))}))}clonePartToStartboard(e){return e.cloneAs(((t,s)=>u.create(this.diContainer,e.locator,t,{overridesModel:s,filters:e.filters})),!0).then((t=>{const i=L(this.diContainer.get(s.DefinitionFinder),e.locator,e.partDefinition);if(C.isVariableSize(t.initialSize)&&i&&i.length>0){const e=MsPortalFx.find(i,(function(e){return C.isFixedSize(e)}));if(!(null!==e&&e>=0))throw FxImpl.createError("Requested tile size for pinning not supported");t.initialSize=e,t.widgetState().NormalState.size=e}return t})).catch((t=>{const s=FxImpl.createError("Pin Part to Startboard Failed: The target part could not pinned. Part: {0}".format(e.toString()),{innerErrors:t});throw E.error(s),s}))}}function N(e,t,i){let o;if(e.onPin)o=e.onPin().then((e=>R(t,e,i,"Blade.onPin")));else{const n=e.locator;o=t.locateAsync(n).then((t=>{const o=t.pinnedPartExtension||i;return{locator:s.Locator.forExtension(o).withPartType(t.pinnedPart),model:(t.inputs||[]).concat(t.optionalInputs||[]).reduce(((t,s)=>(t[s]=p.getModelValue(e.model,s).value,t)),{}),telemetryAction:"PinPdlBlade"}}))}return o}function R(e,t,i,o){const{partName:n,parameters:r}=t,a=t.options,{extensionName:l,filters:c}=a;let{initialSize:d,initialHeight:p,initialWidth:u}=a;const m=l||i;let g,h=s.Locator.forExtension(m).withPartType(n);"UnboundPart"===n?g=Promise.resolve():(h=z(e,h,o).locator,g=e.locateAsync(h).then((t=>{if(T.PartSize[d]){const s=T.PartSize[t.initialSize]?t.initialSize:k.Normal,o=L(e,h,t)||[];s===d||o.includes(d)||(E.error("Extension {0} attempted to pin using an unsupported size of part with locator '{1}'. Requested size was '{2}'. Pinned with size '{3}'.".format(i,h.toString(),T.PartSize[d],T.PartSize[s])),d=s,d===k.Custom?(p=p||t.initialHeight,u=u||t.initialWidth):p=u=void 0)}})));const f=r;return g.then((()=>({model:f,locator:h,initialSize:d,initialHeight:p,initialWidth:u,filters:c,ignoreRedirects:!0,telemetryAction:o,deepLink:a.deepLink})))}function L(e,t,s){if("number"==typeof s.partKind){return M.getPartFactory(e,t,s).supportedSizes}}function z(e,t,i){let o;if(6===t.type){const n=t.getExtensionLocator(),r=s.Locator.forPartTypeRedirect(n.name,t.name),a={};if(e.tryLocate(r,a)){const e=t,r=a.value;t=(r.toExtension?s.Locator.forExtension(r.toExtension):n).withPartType(r.toPart),o=r.bindings,_.trace({source:"StartBoard",action:"Redirect",name:e.toFriendlyString(),data:{reason:i,to:t.toFriendlyString()}})}}return{locator:t,newBindings:o}}t.Instance=B})),
define("MsPortalImpl/UI/UI.StartboardManager",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Graph","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/UI/Compositions/UI.Composition.StartBoard","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/UI/UI.DesktopManagerView","MsPortalImpl/UI/Compositions/UI.Composition.Part","FxInternal/AsyncLoader","FxInternal","MsPortalImpl/Widgets/Widgets.Portal.init"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f){"use strict";t.StartboardManager=void 0;const x=MsPortalFx.Base.Diagnostics.createLog(e),b=n.CompositionBinder.createObservableModel,y=i.Dashboard.Notification,v=i.Dashboard.NotFound;let w=t.StartboardManager=class{constructor(e,t,s){this._diContainer=e,this._view=t,this._lifetime=new FxImpl.TriggerableLifetimeManager,this._portal=(0,f.getPortalViewModel)(e),this._lifetime.registerForDispose(this.startboard=d.Instance.create(this._diContainer)),s.setStartBoard(this.startboard),h.tryImmediateResolve(this._portal.onWidgetCreate(),(()=>{this._view.composeStartBoard(this.startboard)}))}dispose(){this._lifetime&&this._lifetime.dispose()}setWidgetLoading(e){this.startboard.widget.options.loading(e)}collectDashboardSettings(e){const t={},s=e.toJSON(),i=e.children.filter((e=>!e.isDisposed())),o=e.widget.getDomOrderedChildren();i.length!==o.length&&x.error(`There should be the same number of composed parts to save (${i.length}) as the number of positioned elements in the layout (${o.length}). The settings will be incorrect.`);const n=[];return o.forEach((e=>{const t=MsPortalFx.remove(i,(t=>t.id===e));1===t.length?n.push(this.getPartSettings(t[0])):x.error(`There should be a composed part with ID '${e}' yet none was found. The saved content will be incorrect. The settings will be incorrect.`)})),i.length>0&&i.forEach((e=>{x.error(`Part '${e.id}' should have a position defined in the layout, yet none was found. The settings will be incorrect.`),n.push(this.getPartSettings(e))})),Promise.allSettled(n).then((i=>(i.forEach((e=>{$.extend(t,"fulfilled"===e.status?e.value:void 0)})),e.dashboardFiltersManager&&e.dashboardFiltersManager.toJSON().catch((e=>(x.error("Failed to get part filters information."),s.dashboardModel.model)))))).then((e=>(e&&(s.dashboardModel.model.filterLocale=e.filterLocale,s.dashboardModel.model.filters=e.filters),t[c.startBoardSettingsKey]=s,JSON.parse(JSON.stringify(t)))))}getPartSettings(e,t){return(t||void 0===t?e.await(7):Promise.resolve()).catch(MsPortalFx.noop).then((()=>{if(e.isDisposed())return{};const t={},{partJson:s,containerModel:i}=this.partCompositionToJSON(e);return t[s.id]=s,this.getPartIdentitySettings(e,i).then((e=>$.extend(t,e)))})).catch((t=>(x.error(t,8,`part: '${e.id}'.`),{})))}getPartIdentitySettings(e,t){const s=e.partDefinition;if(!s||!s.partState)return Promise.resolve({});const i=(0,a.buildIdentitySettingKey)(e.locator,t);return e.getPartSettingsManager().getStartboardPartIdentitySettings().then((e=>{if(!e)return{};const t={};return t[i]=e,t})).catch((t=>(x.error(t,9,`Failed to get part '${e.id}' identify settings for key '${i}'.`),{})))}enterOrganizeMode(e){this.startboard.widget.element.trigger("fxenterorganizemode",{openTileGallery:e})}pinMultipleParts(e,t,s,o){if(e.length<1)return Promise.resolve(void 0);let n;return n=o&&this.startboard.notFound()?Promise.reject("Can pin on not found dashboard"):this.startboard.pinPartReferences(e,t).then((e=>{if(void 0===s||s){const e=i.Shell.pinnedToStartBoard;this.popNotification(e,e,0)}return e})),n.catch((t=>{throw x.debug("Pin multiple parts failed: The parts could not be pinned. Part references: {0}".format(e.toString())),this.popNotification(y.errorTitle,v.failToPinPart,2),t}))}pinBladeToStartboard(e,t,s){let o;return o=s&&this.startboard.notFound()?Promise.reject("Can pin on not found dashboard"):this.startboard.pinBladeToStartboard(e).then((s=>{if(!t){const t=e.bladeTitle,s=t?i.Shell.pinnedToStartBoardWithTitle.format(t):i.Shell.pinnedToStartBoard;this.popNotification(s,s,0)}return s})),o.catch((e=>{throw this.popNotification(y.errorTitle,v.failToPinBlade,2),e}))}pinPartToStartboard(e){let t;return t=this.startboard.notFound()?Promise.reject("Can pin on not found dashboard"):this.startboard.clonePartToStartboard(e).then((t=>(this.popNotification(e.getTitle()||y.defaultPinnedPartTitle,i.Shell.pinnedToStartBoard,0),t))),t.catch((t=>{throw x.error("Pin Part to Startboard Failed: The target part could not pinned. Part: {0}".format(e.toString())),this.popNotification(y.errorTitle,v.failToPinPart,2),t}))}popNotification(e,t,s,i){this._diContainer.getAsync(g.get("MsPortalImpl/UI/Hubs/UI.NotificationManager","NotificationManager")).then((o=>{o.addSingleNotification({title:e,description:t,status:s,linkTo:i||"#dashboard"})}))}updateUriAndPageTitle(e,t=!1){e&&e.id&&(0,p.updateDashboardUri)(this._diContainer,e.id,t),this.startboard.widget.options.title(e.title)}partCompositionToJSON(e){const t=e.toJSON();let s=e.containerModel;if(!s||!s[o.PartContainerModelIdProperty]){const e=ko.toJS((0,l.createContainerModel)(t.containerModel))||{};e[o.PartContainerModelIdProperty]=MsPortalFx.getUniqueId(),s=b(e),t.containerModel=(0,m.getSerializableContainerModel)(s,!1)}return{partJson:t,containerModel:s}}};t.StartboardManager=w=__decorate([__metadata("fx:diagnostics",[e,"StartboardManager"]),s.Class(),__metadata("design:paramtypes",[s.Container,u.DesktopManagerView,r.CompositionGraph])],w)})),
define("MsPortalImpl/UI/UI.DesktopManagerImpl",["require","exports","Fx/DependencyInjection","FxInternal/AsyncLoader","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Services/Services.AssetManagement","MsPortalImpl/Services/Services.Settings","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/Base/Base.DeepLink","FxHubs/RpcEndPoints","Fx/Composition/DashboardFilters","FxInternal/Composition/DashboardFilters","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/UI/UI.StartboardManager"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g){"use strict";t.getFilterWarningHandler=t.getFilterValuesHandler=t.getFilterValueDisplayTextHandler=t.getDashboardFiltersHandler=t.getDashboardDeepLinkHandler=t.DesktopManagerImpl=void 0;var h=i;const f=MsPortalFx.require;function x(){return f("MsPortalImpl/UI/UI.Desktop.Actions")}let b=t.DesktopManagerImpl=class{constructor(e){this._diContainer=e,this._lifetime=new FxImpl.TriggerableLifetimeManager,this._manifestCache=e.get(o.ManifestCache),this._mode=e.get(a.DesktopManagerMode).value,this._settingsManager=e.get(r.SettingsManager),this._journeyManager=this._diContainer.get(l.JourneyManager),this.startBoard=e.get(g.StartboardManager).startboard,this._setupOrganizeModeComponents()}initialize(){return this._journeyManager.configure(this.startBoard),this._diContainer.get(n.AssetManager).onAssetDeleted(((e,t,s,i)=>{x().then((o=>o.handleAssetDeleted(this,this._journeyManager,e,t,s,i)))})),this.getSettingCollections().forEach((e=>{this._diContainer.get(r.SettingsManager).setSettings(e)})),Promise.resolve()}_getExtensionEmailAddress(e){const t=this._manifestCache.getManifest(e,"assetTypes");return t&&t.feedbackEmail}getCurrentBladeInfo(){const e=this._getBreadCrumb(),t=this._getExtensionEmailAddress("HubsExtension"),s=e[e.length-1],i=s&&s.extensionName||"";return{extensionName:i,feedbackTo:i&&this._getExtensionEmailAddress(i)||t,feedbackCC:t,breadcrumb:e.map((e=>e.title)).join(" > "),bladeLocators:e.map((e=>e.name)),bladeName:s&&s.name||""}}_getBreadCrumb(){const e=this._journeyManager.activeJourney();if(!e)return[];const t=e.children;return t&&t.length?t.map((e=>({title:e.isDefaultTitle()?e.id:e.title(),extensionName:e.locator.getExtensionName(),name:e.locator.toFriendlyString()}))):[]}getSettingCollections(){const e={},t=[];return e[m.desktopSettingsKey]=JSON.parse(JSON.stringify(this)),t.push({store:4,settings:e}),t}dispose(){this._lifetime.dispose()}toJSON(){return{startBoardId:this.startBoard?this.startBoard.id:null}}getDiagnosticsData(){const e=this.startBoard;return{startboard:e&&e.getDiagnosticsData()}}getAssetDiagnosticsData(){const e=this._journeyManager.activeJourney();return e?x().then((t=>t.dumpCompositionAssets(e))):Promise.resolve("No journey")}_setupOrganizeModeComponents(){const e=this._lifetime.createChildLifetime();this._mode.subscribe(e,(t=>{1===t&&(e.dispose(),h.get("MsPortalImpl/UI/UI.DragDropCompositionManager","create").then((e=>e(this._diContainer))))}))}};t.DesktopManagerImpl=b=__decorate([__metadata("fx:diagnostics",[e,"DesktopManagerImpl"]),s.Class(),__metadata("design:paramtypes",[s.Container])],b);t.getDashboardDeepLinkHandler=(0,i.defineHandler)(d.DashboardEndpoints.getDashboardDeepLink,(e=>(0,c.rpcGetDashboardDeepLink)(e.diContainer,e.messageArg))),t.getDashboardFiltersHandler=(0,i.defineHandler)(d.PartFilterEndpoints.getFilters,(e=>{const t=e.diContainer.get(b),s=e.messageArg,i=t.startBoard,o=i.dashboardFiltersManager,n=i.getFilterIdsForPart(s).then((e=>{const t=[];return e.forEach((e=>{t.push(i.dashboardFiltersManager.getFilterIdTextAndOperators(s,e).then((t=>({id:e,displayString:t.displayString,operators:t.operators}))))})),Promise.all(t)})),r=i.getDashboardFiltersForPart(s,!0);return Promise.all([n,r]).then((e=>{const t={},n=e[1],r=[];Object.keys(n).forEach((i=>{const a=o.fromExtensionModel((0,u.getFilterKindFromId)(i),n[i]);if(i!==p.TimeRangeFilter.filterId){const l=o.getFilterValueDisplayText(i,n[i],s).then((e=>({displayString:e,value:a.values})));r.push(l.then((s=>{const o=MsPortalFx.find(e[0],(e=>e.id===i)).displayString;t[i]={filterIdDisplayText:o,operator:a.operator,valueString:s.displayString,values:s.value,substring:a.substring}})))}}));const a=MsPortalFx.forEachKey(MsPortalFx.clone(i.getPartInstance(s).filters,!0)||{},((e,t,i)=>{const n=o.getFilterValueDisplayText(e,t,s).then((s=>{i[e]=MsPortalFx.extend(o.fromExtensionModel((0,u.getFilterKindFromId)(e),t),{valueString:s})}));r.push(n)}),{});return Promise.all(r).then((()=>({dashboardFilterDisplays:t,dashboardTimeRangeFilter:n[p.TimeRangeFilter.filterId],partFilters:a||{},allPossibleFilters:e[0]})))}))})),t.getFilterValuesHandler=(0,i.defineHandler)(d.PartFilterEndpoints.getFilterValues,(e=>{const t=e.diContainer.get(b),s=e.messageArg;return t.startBoard.dashboardFiltersManager.getFilterValues(s.filterId,s.filterText,s.partId)})),t.getFilterValueDisplayTextHandler=(0,i.defineHandler)(d.PartFilterEndpoints.getFilterValueDisplayText,(e=>{const t=e.diContainer.get(b),s=e.messageArg,i=t.startBoard.dashboardFiltersManager.toExtensionModel((0,u.getFilterKindFromId)(s.filterId),s);return t.startBoard.dashboardFiltersManager.getFilterValueDisplayText(s.filterId,i,s.partId)})),t.getFilterWarningHandler=(0,i.defineHandler)(d.PartFilterEndpoints.getFilterWarning,(e=>{const t=e.diContainer.get(b),s=e.messageArg;return t.startBoard.dashboardFiltersManager.getFilterWarning(s.filterId,MsPortalFx.extend2(s.filterModel,{selectAllState:void 0}))}))})),
define("MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop",["require","exports","MsPortalImpl/Base/Base.Events","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.FlowLayout"],(function(e,t,s,i,o,n,r){"use strict";t.FlowLayoutDragDrop=void 0;const a=window,l=$(a.document.body),c=n.Widget.getWidget,d="ui-draggable",p="draggable",u=d+" fxs-drag-disableTouchAction",m=".fxs-tile:not(.fxs-tilesize-herowidefitheight):not(.fxs-tilesize-fullwidthfitheight):not(.fxs-tilesize-fittocontainer)",g=".fxs-flowlayout",h={dismissFn:C,logName:"flowlayoutdragdrop"};let f,x,b,y,v;const w={left:0,top:0};function M(e){if(!f)return;l.off(g);const t=f.elementObject,s="true"===t.attr("dragdrop.revert"),o={left:e.pageX,top:e.pageY};i.unregister(h),s&&t.attr("dragdrop.revert","false"),S(),s&&x&&(S(),x.refreshLayout()),t.css("opacity",1),y=s?b:I(o),x.moveChild(f.elementObject,Math.max(y.col,0),Math.max(y.row,0),!0),P()}function C(){f.elementObject.attr("dragdrop.revert","true").trigger("mouseup")}function S(){v&&(clearTimeout(v),v=null)}function I(e){const t=x.element,s=t.offset(),i=e.left+w.left,n=e.top+w.top,r=i-s.left+t.scrollLeft(),a=n-s.top+t.scrollTop();return{col:Math.floor((r+.33*o.GridSpacingWidth)/o.GridSpacingWidth),row:Math.floor((a+.33*o.GridSpacingHeight)/o.GridSpacingHeight)}}function P(){x=null,b=null,y=null,f=null}function _(){const e=$.querySelectorAll(g),t=[];return e.each((function(e,s){const i=c($(s),r.Widget),o=i.options;o.allowReorder&&!o.locked()&&t.push(i.element.find(".fxs-flowlayout-childcontainer"))})),t}function F(e){C(),M(e)}class T{constructor(){if(T._singleton)throw new Error("FlowLayoutDragDrop operates as a singleton.");T._singleton=this}dispose(){this.disableDragDropTargets(),P(),T._singleton=null}static get Instance(){return T._singleton||(T._singleton=new T),T._singleton}enableDragDropOnSingleTarget(e){if("true"===e.attr(p))return;e.attr(p,"true");e.filter(m).addClass(u).on("dragstart",(e=>{if(f&&F(e),s.isFullscreen()||e.target!==e.currentTarget)return void e.preventDefault();let t={left:e.pageX,top:e.pageY};l.on("dragover"+g,(e=>{e.preventDefault();const s={left:e.pageX,top:e.pageY};s.left===t.left&&s.top===t.top||function(e,t){if(x){const e=I(t);e.col===y.col&&e.row===y.row||(y=e)}S(),v=setTimeout((()=>{v=null,x&&x.moveChild(f.elementObject,Math.max(y.col,0),Math.max(y.row,0),!1)}),50)}(0,t=s)})),l.on("drop"+g,(e=>{e.preventDefault(),M(e)})),l.on("dragend"+g,(e=>{M(e)})),l.on("dragleave"+g,(e=>{0<e.clientX&&e.clientX<a.innerWidth&&0<e.clientY&&e.clientY<a.innerHeight||F(e)}));const o=e.originalEvent.dataTransfer;o.setData("text","fxs-draganddrop"),o.effectAllowed="move",function(e){const t=e.target,s=$(t);if(!f||f.htmlTarget===t){if(f={htmlTarget:t,elementObject:s,width:s.outerWidth(!1),height:s.outerHeight(!1)},w.top=-e.offsetY,w.left=-e.offsetX,x=c(s.closest(g),r.Widget),!x)return e.preventDefault(),void F(e);s.css("opacity",.75),b=y=I({left:e.pageX,top:e.pageY}),i.register(h)}}(e)}))}enableDragDropTargets(){_().forEach((e=>{e.on("mouseenter",m,(e=>{const t=$(e.currentTarget);"true"!==t.attr(p)&&this.enableDragDropOnSingleTarget(t)}))}))}disableDragDropTargets(){_().forEach((e=>e.off("mouseenter",m))),$.querySelectorAll(`.${d}`).removeClass(u).off("dragstart").removeAttr(p)}}t.FlowLayoutDragDrop=T})),
define("_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css",["module"],(function(e){"use strict";return{css:".fxs-desktop-organize .fxs-tile .fxs-tile-content{z-index:0}.fxs-desktop-organize .fxs-tile .fxs-tile-overlay{display:block;touch-action:none}.fxs-desktop-organize .fxs-tile:hover .fxs-tile-overlay{background-color:transparent}.fxs-desktop-organize .fxs-tile.fxs-tilesize-custom .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-mini .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-small .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-tall .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-wide .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-normal .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-large .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herotall .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herowide .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-hero .fxs-tile-overlay{cursor:move}.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-help .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-context .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-contextaction .fxs-tile div.fxs-tile-overlay{background-color:transparent}.fxs-desktop-organize .fxs-sidebar{display:none!important}.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-migration,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-dropdown,.fxs-desktop-organize .fxs-startboard-filter,.fxs-desktop-organize .fxs-startboard-commandBar{display:none}.fxs-desktop-organize .fxs-hide-in-customize{visibility:hidden}.fxs-desktop-organize .fxs-startboard-layout>.fxs-flowlayout-childcontainer{min-height:2155px;min-width:3865px}.fxs-desktop-organize .msportalfx-clickable-in-customize,.fxs-desktop-organize .fxc-hotspot-customclick{z-index:1}.fxs-desktop-organize .fxs-startboard-customize-header .fxs-startboard-button{padding:15px 5px}.fxs-desktop-organize .fxs-contextpane .fxs-tile .fxs-tile-overlay{display:none}.fxs-desktop-normal .fxs-hide-in-normal{display:none}@media(max-width:700px){.fxs-startboard-customize-header{min-height:initial}.fxs-startboard-customize-description{display:none}}",moduleId:e.id}})),
define("MsPortalImpl/UI/UI.DesktopModeManager",["require","exports","MsPortalImpl/Base/Base.Events","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop","MsPortalImpl/Services/Services.Settings","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.DesktopManagerImpl","MsPortalImpl/UI/UI.JourneyManager","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Resources/Resources.Images","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f){"use strict";t.DesktopModeManagerImpl=void 0,t.createDesktopModeManager=function(e,t,i){const o=e.get(l.DesktopManagerImpl),n=e.get(a.DesktopManagerMode).value,r=new M(t,e,i),c=e=>{const t=$(e.target).closest(y);return p.Widget.getWidget(t,u.Widget)},d=t.getStartBoardArea();return t.topBar.exitOrganizeMode=()=>{e.get(a.DesktopManagerMode).value(0);const t=o.startBoard.widget.element.find(".fxs-startboard-button-edit>.azc-toolbarButton-container");t.length&&t.focus()},d.on("fxenterorganizemode",((e,t)=>{e.stopPropagation();const s=c(e);t=$.extend({},t),MsPortalFx.isNullOrUndefined(t.trigger)&&(t.trigger=s?0:1),s&&(s.options.selected(!0),r.updateTileSelection(s)),r.startPartManagement(t).then((()=>{s&&s.showTileManagementContextMenu()}))})),d.on("fxopentilegallery",(e=>{1===n()&&(e.stopPropagation(),r.startPartManagement({openTileGallery:!0}))})),d.on("click",b,(e=>{const t=c(e),s=t&&t.options;s&&!s.locked()&&(s.selected(!s.selected()),r.updateTileSelection(t))})),d.on("click",v,(e=>{if(1!==n())return;const t=c(e),s=t&&t.options;!s||s.locked()||s.selected()||(s.selected(!0),r.updateTileSelection(t))})),d.on("dragstart",w,(e=>{if(s.isFullscreen())return void e.preventDefault();1!==n()&&n(1);const t=c(e),i=t&&t.options;i&&!i.selected()&&(i.selected(!0),r.updateTileSelection(t))})),d.on("fxpartcreated",((e,t)=>{e.stopPropagation();const s=t.widget;s.options.selected(!0),r.updateTileSelection(s)})),r},(0,h.injectCss)(f,{moduleId:"flowlayoutGridShadowUri",css:`.fxs-desktop-organize .fxs-flowlayout-childcontainer {background: url(${m.getFlowLayout().gridShadow});}`});const x=p.Widget.widgetRemoveEvent,b=`.${u.overlayClassName}`,y=`.${u.widgetClassName}`,v=`.${u.actionBarContainerClassName}`,w=".ui-draggable";class M{constructor(e,t,s){this._diContainer=t,this._dismissHandle={dismissFn:()=>{this._mode(0)},logName:"desktopmodemanager"},this._mode=t.get(a.DesktopManagerMode).value,this._portal=e,this._lifetime=s,this._userSettingsManager=t.get(n.SettingsManager),this._contextPane=t.get(r.RightContextPane),this._partMgmtStarted=!1,this._selectedTile=null,this._handleModeChange(s)}get selectedTile(){return this._selectedTile}updateTileSelection(e){this._deselectCurrentTile(),e.options.selected()&&(this._selectedTile=e),this._selectedTile&&this._selectedTile.element.on(x,this._tileRemoveHandler=e=>{e.target===this._selectedTile.element[0]&&this._deselectCurrentTile()})}startPartManagement(e){if(this._partMgmtStarted)return Promise.resolve();if(this._mode(1),e.openTileGallery){const e=this._contextPane;return this._partMgmtStarted=!0,e.tryOpen(this).then((()=>{const e=this._partGalleryVm;return MsPortalFx.require("MsPortalImpl/UI/UI.PartGalleryManager").then((t=>{this._partGalleryManager||(this._partGalleryManager=t.create(this._lifetime.createChildLifetime(),this._diContainer,e))}))}))}return Promise.resolve()}onAddingContent(e){return MsPortalFx.require("MsPortalImpl/Widgets/Widgets.PartGallery").then((t=>{this._partGalleryVm||(this._partGalleryVm=new t.ViewModel(this._lifetime,this._diContainer));const s=this._partGalleryVm;if(!this._partGalleryWidget){const i=$(FxImpl.createElement("div",{class:"fxs-partgallery-container"}));return e.getWidget().getBladeHost(i,{title:g.PartGallery.title,bladeWidth:0}).then((o=>{e.getWidget().addChild(o);(this._partGalleryWidget=t.create(i,s)).ltm.registerForDispose(o)}))}}))}onRemovingContent(e){this._partMgmtStarted=!1,this._partGalleryWidget.dispose(),this._partGalleryWidget=null,e.getWidget().clear()}_enterOrganizeMode(){return this._portal.inOrganizeMode(!0),i.register(this._dismissHandle),o.FlowLayoutDragDrop.Instance.enableDragDropTargets(),this._partMgmtStarted?Promise.resolve():this.startPartManagement({})}_exitOrganizeMode(){const e=this._portal;o.FlowLayoutDragDrop.Instance.disableDragDropTargets(),e.inOrganizeMode(!1);this._contextPane.close(!0),this._deselectCurrentTile(),this._userSettingsManager.flushSettings(),i.unregister(this._dismissHandle)}_handleModeChange(e){this._mode.subscribe(e,(e=>{switch(e){case 1:{this._diContainer.getAsync(d.DialogManager).then((e=>{e.dismissOpenDialog()}));const e=this._diContainer.get(c.JourneyManager),t=e.activeJourney();t&&e.forceDiscardJourney(t.id),this._enterOrganizeMode(),s.isFullscreen()&&s.exitFullscreen();break}default:this._exitOrganizeMode()}}))}_deselectCurrentTile(){this._selectedTile&&(this._selectedTile.element.off(x,this._tileRemoveHandler),this._tileRemoveHandler=null,this._selectedTile.options.selected(!1),this._selectedTile=null)}}t.DesktopModeManagerImpl=M})),
define("MsPortalImpl/UI/Compositions/UI.Composition.Services",["require","exports","Fx/DependencyInjection","MsPortalImpl/Base/Base.Router","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/UI/Commands/UI.CommandManager","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManagerImpl","MsPortalImpl/UI/UI.DesktopModeManager","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Portal","FxInternal"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u){"use strict";t.WhatsNewModal=t.FeedbackPaneInfo=t.ContactabilityModal=void 0,t.initialize=function(e,t,s){return t.get(n.PortalCommandManager),t.get(i.Router),(0,c.createNotificationManager)(t),u.tryImmediateResolve(s.onWidgetCreate(),(()=>{l.createDesktopModeManager(t,s,e)})),t};const m=MsPortalFx.require;class g{constructor(e){this.callBack=e}static create(e,t){return new g((s=>{m("MsPortalImpl/Widgets/Dialogs/Widgets.UpdateContact").then((i=>{new i.Widget($(FxImpl.createElement("div")),new i.ViewModel,s,t.getRootElement(),e)}))}))}}t.ContactabilityModal=g,__decorate([__metadata("fx:diagnostics",[e,"ContactabilityModal"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container,p.ViewModel]),__metadata("design:returntype",g)],g,"create",null);class h{constructor(e){this.callBack=e}static create(e,t){return new h((s=>{MsPortalFx.isFeatureEnabled("whatsnew")&&e.whatsNewEnabledKey()&&m("MsPortalImpl/Widgets/Widgets.WhatsNew").then((e=>{const i=s.items.map((e=>{const t=e.published?new Date(e.published).toLocaleString():"";return e.description+="\r\n"+t,e}));new e.Widget($(FxImpl.createElement("div")),new d.ViewModel,i,t.getRootElement())}))}))}}t.WhatsNewModal=h,__decorate([__metadata("fx:diagnostics",[e,"WhatsNewModal"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.GeneralSettings,p.ViewModel]),__metadata("design:returntype",h)],h,"create",null);class f{static create(e,t,s){return MsPortalFx.require("MsPortalImpl/Widgets/Widgets.FeedbackPane").then((i=>({amdModule:i,widget:new i.FeedbackPane(e,t,(()=>s.getCurrentBladeInfo()))})))}}t.FeedbackPaneInfo=f,__decorate([__metadata("fx:diagnostics",[e,"FeedbackPaneInfo"]),s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.Container,r.DockedContextPane,a.DesktopManagerImpl]),__metadata("design:returntype",void 0)],f,"create",null)})),
define("MsPortalImpl/UI/Hubs/UI.NotificationsPane",["require","exports"],(function(e,t){"use strict";t.ViewModel=void 0;t.ViewModel=class{constructor(e){this.diContainer=e,this.lastPaneOpenedTime=ko.observable(Date.now()),this.isPaneOpen=ko.observable(!1)}}})),
define("MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration",["require","exports","MsPortalImpl/Extension/ViewModelManager"],(function(e,t,s){"use strict";t.registerViewModels=function(e){const t=i+"All.Part";(0,s.registerWithDi)("BrowseAllBlade$ServicesListPartViewModel","ServicesListPartViewModel",t)};const i="MsPortalImpl/UI/Hubs/ViewModels/UI.Browse"})),
define("MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration",["require","exports","MsPortalImpl/Extension/ViewModelManager","FxInternal/Composition/Part"],(function(e,t,s,i){"use strict";t.registerViewModels=function(e){const t=s.registerWithState,r=o+`${n}DiagnosticsPart`;t("HelpAndSupportBlade$DiagnosticsPartViewModel",r,(t=>(0,i.composePartViewModel)((s=>new t.DiagnosticsPartViewModel(s,e)),{logArea:r})))};const o="./MsPortalImpl/UI/Hubs/ViewModels/",n="UI.Settings."})),
define("MsPortalImpl/UI/UI.AdvisorNotificationHelper",["require","exports","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/Base/Languages","MsPortalImpl/Resources/PortalNotificationsTelemetry"],(function(e,t,s,i,o,n){"use strict";t.percentageOfUsersShownAdvisorNotification=t.DEV=void 0,t.shouldShowAdvisorNotification=b,t.showAdvisorNotification=function(e){if(!b())return Promise.resolve(!1);const t=Date.now()-p,i=MsPortalFx.Base.Resources.getVersionlessContentUri("Content/static/MsPortalImpl/AdvisorNotifications/AdvisorDashboard_"+o.getCultureSpecificLanguage().split("-").join("")+".svg");return e.querySetting(13,"AdvisorNotification").then((o=>{if(x||(o||0)<t&&Math.random()<u){FxImpl.Hubs.Notifications.InternalClientNotification.internalPublish({notificationId:"AdvisorModal",timestamp:new Date,modalNotificationData:{image:{imageUrl:MsPortalFx.encodeAttribute(i)}},title:d.title,description:`<h1>${MsPortalFx.encodeHtml(d.description)}&nbsp;<a aria-label='${s.AdvisorNotification.helpTextAriaLabel}' class='msportalfx-ext-link' href='${MsPortalFx.encodeAttribute(c.fx.environment.links.learnAdvisor)}' target="_blank">${MsPortalFx.encodeHtml(s.AdvisorNotification.helpText)}</a></h1>`,status:MsPortalFx.Hubs.Notifications.NotificationStatus.Information,descriptionAsHtml:!0,toastDuration:4,inlineForm:{buttons:[{label:d.buttonText,id:"LaunchAdvisorBladeButton",deepLink:{uri:"#blade/Microsoft_Azure_Expert/AdvisorMenuBlade"}}]}});const n=Date.now();return e.setSetting(13,"AdvisorNotification",n),MsPortalFx.Base.Diagnostics.Telemetry.trace({source:r.ToastTray,action:a.AdvisorNotificationShown,actionModifier:l.NotificationShown,data:{advisorNotificationOccurence:p,percentageOfUsersShownAdvisorNotification:u,testAdvisorFlag:x,timeElapsedInMs:t,advisorLastShown:o,advisorShownTime:n}}),!0}return!1}))};var r=n.Source,a=n.Action,l=n.ActionModifier;const c=window,d=s.AdvisorNotification,p=24*(parseInt(MsPortalFx.getFeatureValue("advisornotificationdays"))||30)*3600*1e3;let u=t.percentageOfUsersShownAdvisorNotification=parseFloat(MsPortalFx.getFeatureValue("advisornotificationpercent"))/100,m=(0,i.hideSmallModals)(),g=MsPortalFx.isFeatureEnabled("hideadvisormodals"),h=MsPortalFx.isFeatureEnabled("ci"),f=FxImpl.features.isNativePerf,x=MsPortalFx.isFeatureEnabled("testadvisor");function b(){return x||!m&&!g&&u>0&&!h&&!f}})),
define("MsPortalImpl/UI/UI.CopilotToastHelper",["require","exports","MsPortalImpl/Resources/PortalNotificationsTelemetry","MsPortalImpl/Services/Services.AssetTypes","Fx/Ajax","Fx/Errors","FxInternal/Experimentation"],(function(e,t,s,i,o,n,r){"use strict";t.shouldShowCopilotToast=async function(e,t,s){if(MsPortalFx.isFeatureEnabled("testcopilottoast"))return!0;if(!MsPortalFx.isFeatureEnabled("copilottoastnotification"))return!1;if(!s)return!1;const a=await e.get(r.ExperimentationManager).shellAssignments.whenAvailable(),l=a.getBooleanValue("copilotmanageability"),c=a.getBooleanValue("copilotmanageabilityganotification");if(!l)return g("Copilot Manageability experiment is not enabled"),!1;if(!c)return g("Copilot Notification experiment is not enabled"),!1;if(!await async function(e){const t=e.get(i.AssetTypeService);let s;try{await(t?.assetTypesComplete),s=!!t.getAssetType("Microsoft_Azure_Copilot","CopilotSettingsAsset")}catch(e){m.error("Failed to check Copilot asset type existence",0,e),s=!1}return s}(e))return g("Copilot asset type does not exist"),!1;if(await t.querySetting(7,"CopilotToastReceived"))return g("User has already received the toast"),!1;if(!await function(){const e=d.startTrace({source:p.ToastTray,action:"isCopilotRbacEnabled"}),t=MsPortalFx.getEnvironmentValue("links"),s=t?.copilotWebEndpoint;if(!s){const t=new n.FxError("CopilotWeb endpoint not configured");return m.error("CopilotWeb endpoint not found in configuration",0,t),d.cancelTrace(e,{error:"CopilotWeb endpoint not configured"}),Promise.resolve(!1)}const i={uri:`${s}/api/access?api-version=2024-09-01`,type:"GET",setAuthorizationHeader:{resourceName:"azureorchestrator"}},r=(0,o.ajax)(i).then((t=>{if(!t){const s=new n.FxError("Received an empty response from RBAC access endpoint");return m.error("Empty response from RBAC access endpoint",0,s),d.cancelTrace(e,{RbacAccessResponse:t}),!1}const s="Access granted: Access control is disabled."!==t.message;return d.completeTrace(e,{RbacAccessResponse:t,isRbacEnabled:s,error:null}),s})).catch((t=>{const s=new n.FxError({message:"Error checking RBAC status from Copilot access endpoint",innerErrors:[t]});return m.warning("Failed to check RBAC status - this may be due to network restrictions or domain allowlisting",0,s),d.cancelTrace(e,{RbacAccessResponse:null,error:t?.message||"Network error"}),!1}));return r}())return g("Copilot RBAC is not enabled on the tenant"),!1;return!0},t.showCopilotToast=async function(e,t,s){l({source:p.ToastTray,action:u.CopilotToastLaunched});try{const i=await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.CopilotToast");return l({source:p.ToastTray,action:u.CopilotToastLoaded}),i.showToast(e,t,s),l({source:p.ToastTray,action:u.CopilotToastShown}),!0}catch(e){return m.error("Failed to show Copilot toast",0,e),l({source:p.ToastTray,action:u.CopilotToastNotLaunched,data:{reason:"Failed to load or show toast"}}),!1}};var a=MsPortalFx.Base,l=a.Diagnostics.Telemetry.trace,c=a.Diagnostics;const d=a.Diagnostics.Telemetry,p=s.Source,u=s.Action,m=c.createLog(e);function g(e){l({source:p.ToastTray,action:u.CopilotToastNotLaunched,data:{reason:e}})}})),
define("MsPortalImpl/UI/UI.DirectoryHelper",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.FavoritesSettings","MsPortalImpl/Services/Services.Tenants","MsPortalImpl/UI/UI.AuthStateManager"],(function(e,t,s,i,o,n,r){"use strict";t.SaveDirectorySettingsHandler=void 0;var a=MsPortalFx.Hubs.Notifications;let l=t.SaveDirectorySettingsHandler=class{constructor(e,t){this._diContainer=e,this._authStateManager=t}async saveDirectorySettings(){const e=await this._diContainer.getAsync(o.UserDirectorySettings),t=e.userDefaultDirectory,s=t()||{},r=(("string"==typeof s?s:s.id)||"").toLowerCase();let l="";const[c,d]=await Promise.all([this._authStateManager.getUserInfo(),this._diContainer.get(n.TenantsService).getHomeTenants()]);l=(c.directoryId||"").toLowerCase();const p=MsPortalFx.find(d,(e=>e.id.toLowerCase()===r)),u=e.signInToLastVisitedDirectory;let m;!1===u()?p||(l&&a.ClientNotification.publish({title:i.defaultDirectoryNotFoundTitle,description:i.defaultDirectoryNotFoundDescription.format(c.domainName),status:a.NotificationStatus.Warning,uri:"#menu/directory"}),u(!0)):u(!0),m=u()?{id:c.directoryId,displayName:c.directoryName,domainName:c.domainName}:{id:p.id,displayName:p.displayName,domainName:p.domainName};const g=MsPortalImpl.sessionStorage.getItem("usedTenantHint");if(g&&(MsPortalImpl.sessionStorage.removeItem("usedTenantHint"),MsPortalFx.Base.Diagnostics.Telemetry.trace({source:"UI.DirectoryHelper",action:"TenantHintUsage",actionModifier:"complete",data:{tenantHint:g,loggedInTenantId:c.directoryId,loggedInTenant:c.domainName}})),m.id){t(m),MsPortalImpl.localStorage.setItem("SavedDefaultDirectory",m.id);const e=!this._authStateManager.bootstrapState.user.isOrgId;MsPortalFx.isFeatureEnabled("usetenanthint")&&e?MsPortalImpl.localStorage.setItem("tenantHint",m.domainName):MsPortalImpl.localStorage.removeItem("tenantHint")}}};t.SaveDirectorySettingsHandler=l=__decorate([__metadata("fx:diagnostics",[e,"SaveDirectorySettingsHandler"]),s.Class(),__metadata("design:paramtypes",[s.Container,r.AuthStateManager])],l)})),
define("MsPortalImpl/UI/UI.NpsHelper",["require","exports","MsPortalImpl/Resources/PortalNotificationsTelemetry","MsPortalImpl/Services/Services.FeedbackPolicies","FxInternal/Experimentation"],(function(e,t,s,i,o){"use strict";t.setTestValues=t.npsShownInSession=void 0,t.shouldShowPortalNps=function(e,t){if(e())return b(!1);if(function(e){if(p)return b(!0),!0;if(!u||m)return b(!1),!0;const t=e(),s=Date.now()-h;if(!(t<s))return b(!1),!0}(t))return w(f),f;const s=Math.random();return w(s<2*g),b(s<g)},t.showNps=v,t.showPortalNps=async function(e,t,s,i,o){if(f)return f=!1,v(e,t,s,d?.productFamilyName??null,null,{surveyLastCompleted:i()},(()=>{i(Date.now())}),o)};var n=MsPortalFx.Base.Diagnostics.Telemetry.trace,r=s.Source,a=s.Action,l=s.ActionModifier;const c=window,d=c?.fx?.environment?.surveys?.nps??Object.create(null);let p=MsPortalFx.isFeatureEnabled("testnps"),u=MsPortalFx.isFeatureEnabled("nps");const m=MsPortalFx.isFeatureEnabled("ci");let g=(parseFloat(MsPortalFx.getFeatureValue("npspercent"))||1)/100;const h=24*(parseInt(MsPortalFx.getFeatureValue("npsintervaldays"))||90)*3600*1e3;let f=!1;function x(e,t,s){return e?s:t}function b(e){return f=e,f}let y=t.npsShownInSession=!1;async function v(e,s,c,d,g,h,f,b){const v=!m&&u&&!y;let w=!1,M="";if(e.userOptedOutOfNpsSurvey()&&(w=!0,M="User opted out of NPS permanently"),!1===e?.notificationSurveyEnabledKey?.()&&(w=!0,M="User opted out of popup surveys in settings"),M&&v&&n({source:r.ToastTray,action:a.NPSUserOptedOut,data:MsPortalFx.extend({optOutReason:M},h)}),p||v&&!w){const u=await b.get(o.ExperimentationManager).shellAssignments.whenAvailable(),m=u.getBooleanValue("allowdontshownpssurveyagain");let v=!0,w=!1;try{const e=await(0,i.fetchFeedbackPolicySettings)();!e||e.policyAllowSurvey&&e.policyAllowContact||n({source:r.ToastTray,action:a.NPSAdminPolicies,actionModifier:l.PoliciesFetched,data:MsPortalFx.extend({policyAllowSurvey:e.policyAllowSurvey,policyAllowContact:e.policyAllowContact},h)}),e&&(v=e.policyAllowSurvey,w=!e.policyAllowContact)}catch(e){n({source:r.ToastTray,action:a.NPSAdminPolicies,actionModifier:l.PoliciesFetchFailed,data:MsPortalFx.extend({error:MsPortalFx.getLogFriendlyMessage(e)},h)})}const M=u?.getNumberValue("newnpsexp")??0;p||v?await MsPortalFx.require("MsPortalImpl/Widgets/Widgets.Nps").then((i=>{n({source:r.ToastTray,action:x(M,a.NPSShown,a.FrameworkSurveys_SATLoaded),actionModifier:l.NotificationShown,data:MsPortalFx.extend({productId:g,shouldHideContact:w},h)}),i.showSurvey(e,s,c,d,g,f,b,w,M<0||M>1?0:M,m),t.npsShownInSession=y=!0})):n({source:r.ToastTray,action:a.NPSAdminPolicies,actionModifier:x(M,l.NPSNotShown,l.FrameworkSurveys_SATNotLoaded),data:MsPortalFx.extend({data:MsPortalFx.extend({productId:g,shouldHideContact:w},h)},h)})}}function w(e){n({source:r.ToastTray,action:"NPSWithDoubleTheChance",data:{basePercentage:g,eligible:e}})}})),
define("MsPortalImpl/UI/UI.SessionHandlerDeferred",["require","exports"],(function(e,t){"use strict";t.validateSessionLifetime=function(e,t,d,p){if(!c)return Promise.resolve(!1);const u=Date.now();if(u-l<3e5)return Promise.resolve(!0);l=u;const m=i.startTrace({source:"Shell",action:p});let g=FxImpl.createElement("iframe");g.classList.add("fxs-extension-frame"),g.setAttribute("tab-index","-1"),g.setAttribute("aria-hidden","true"),g.src=s.Resources.getAppRelativeUri(`/signin/validateSession/@${t}/?sid=${e.aadSessionId||""}`);const h=n.body;h.appendChild(g);const f=Q.defer();let x=e=>{if(e.origin.toLowerCase()===r){const t=e.data||{};t.signature===a&&(c=!1!==t.valid,b(c,c?"SessionValid":"SessionExpired"),c||d.onStatus({code:7},"fx"))}};const b=(e,t)=>{f.promise.isPending()&&(f.resolve(e),i.endTrace(m,t)),g&&(h.removeChild(g),g=null),x&&(o.removeEventListener("message",x,!1),x=null)};return MsPortalFx.delay(3e5).then((()=>{b(!0,"ErrorValidatingSession")})),o.addEventListener("message",x,!1),f.promise};var s=MsPortalFx.Base,i=s.Diagnostics.Telemetry;const o=window,n=o.document,r=FxImpl.trustedParentOrigin.toLowerCase(),a="ValidateSession";let l=0,c=!0})),
define("MsPortalImpl/UI/UI.SessionHandler",["require","exports","MsPortalImpl/UI/UI.SessionHandlerDeferred","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/Resources/SessionHandlerResources","Fx"],(function(e,t,s,i,o,n){"use strict";t.initialize=function(e,t,i,o,r,a,l,m){const g=i.bootstrapState.idleTimeoutSeconds/60;g?d=u(e,g,o,r,a):o.subscribeAndRun(t,(t=>{t&&!d?d=u(e,0,o,r,a):t||g||!d||(r.removeCallbacks(d),d=null)}));if((0,n.isFeatureEnabled)("sessionvalidity")){const e=()=>(0,n.delay)(c).then((()=>{p().then((t=>{t&&s.validateSessionLifetime(i.bootstrapState,l,m,"SessionValidityPoll").then((t=>{t&&e()}))}))}));e()}},t.setTestValues=void 0;const r="SessionHandlerTimedSignout",a=window,l=MsPortalFx.Base.Diagnostics.createLog(e),c=parseInt((0,n.getFeatureValue)("sessionpollinterval"))||36e5;let d;const p=(0,n.memoizePromise)((()=>{if(MsPortalFx.isFeatureEnabled("disableaadgraphendpoint"))return Promise.resolve(!0);const e=a.fx.environment.links.graphPoliciesEndpoint;return e?MsPortalFx.Base.Net2.ajax({uri:e,setAuthorizationHeader:{resourceName:"graph"}}).then((e=>(e.value||[]).some((e=>"tokenlifetimepolicy"===(e.type||"").toLowerCase()&&(e.definition||[]).some((e=>(e||"").toLowerCase().includes("maxagesession"))))))).catch((e=>{const t=(e.jqXHR||{}).status;return 401===t||403===t||(0===t?(p.clear(),!1):(p.clear(),l.verbose("Error calling graph for policy details",0,e),!0))})):Promise.resolve(!0)}));function u(e,t,s,a,l){let c,d=!1;return a.addCallbacks({onBusy:()=>{c=void 0},onIdle:p=>{const u=ko.unwrap(s),m=t&&u?Math.min(t,u):Math.max(t,u);m&&p>=m?(MsPortalFx.Base.Diagnostics.Telemetry.trace({source:r,action:"TimedSignout",data:{signedOutTime:Date.now(),idleTime:p,userSetting:u,tokenTimeout:t}}),c&&MsPortalFx.Base.Diagnostics.Telemetry.endTrace(c,"InactiveUserSignout",{signedOutTime:Date.now(),idleTime:p,userSetting:u,tokenTimeout:t}),l()):(0,n.isFeatureEnabled)("logouttimerpopup")&&m&&p+1===m&&!d&&e.getAsync(i.DialogManager).then((e=>{c=MsPortalFx.Base.Diagnostics.Telemetry.startTrace({source:r,action:"SessionInactivtyTimeoutPrompt",data:{idleTime:p,userSetting:u,tokenTimeout:t}}),d=!0;const{DialogResult:s}=MsPortalFx.ViewModels.Dialogs;e.showModalDialog({description:o.TimeoutDialog.description,title:o.TimeoutDialog.title,buttons:2,cancelButtonText:o.TimeoutDialog.cancelButton,defaultButtonText:o.TimeoutDialog.acceptButton}).then((e=>{switch(d=!1,e){case 1:MsPortalFx.Base.Diagnostics.Telemetry.cancelTrace(c,{signedOutTime:Date.now(),idleTime:p,userSetting:u,tokenTimeout:t}),l();break;case 4:MsPortalFx.Base.Diagnostics.Telemetry.completeTrace(c,{idleTime:p,userSetting:u,tokenTimeout:t}),a.signalBusy()}}))}))}})}})),
define("_generated/Less/MsPortalImpl/UI/UI.Portal.Actions.css",["module"],(function(e){"use strict";return{css:".fxt-copy{display:flex;margin-top:5px}.fxt-copy-control{padding-left:10px}",moduleId:e.id}})),
define("MsPortalImpl/UI/UI.StatusHandler",["require","exports","Fx/DependencyInjection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Services/Services.SecurityTokens","Fx/Composition","FxInternal/Css","_generated/Less/MsPortalImpl/UI/UI.Portal.Actions.css","Fx"],(function(e,t,s,i,o,n,r,a,l,c,d,p){"use strict";t.errorUri=t.StatusHandler=void 0,(0,c.injectCss)(d);var u=MsPortalFx.Base,m=u.Constants,g=u.Diagnostics,h=g.Telemetry,f=MsPortalFx.Hubs.Notifications,x=f.NotificationStatus;const b=window,y=b.document,v=g.createLog(e),w=m.Shell,M=i.Shell,C=M.Notifications,S=M.Dialogs,I=C.SessionEnding,P=C.TokenFailure,_=C.VersionChanged,F={sessionId:MsPortalFx.sessionId},T=(t.errorUri=b.fx.internalEnv.portalApplicationUri+"/Error",[12e5,6e5]),k=b.fx.environment.links.aadErrorCodes;function E(e,t,s,i,o){h.trace({source:"Shell",action:"StatusHandlerShowNotification",name:w,data:{title:e,description:t,correlationId:s}}),f.ClientNotification.publish({title:e,description:t,status:i||x.Information,descriptionAsHtml:o,correlationIds:[s]})}let D=t.StatusHandler=class{constructor(e,t,s,i,o){this._diContainer=e,this._dialogManager=t,this._rootElements=s,this._windowManager=i,this.isShellInitialized=Q.defer(),this._pageBlockingPrompt=!1,this._isDialogVisible=!1,this.isOfflineDialogVisible=!1,this._unknownNetworkErrorCount=0,this._unknownNetworkErrorCanceled=!1,o.sessionEndedHandler=(e,t,s)=>this.onLastTokenRefresh(e,t,s),o.tokenFailedHandler=(e,t,s,i)=>{this.onStatus({code:2,message:s,data:{resourceName:t}},e,null,i)},o.tokenMfaErrorHandler=(e,t,s,i)=>{this.onStatus({code:8,message:s,data:{resourceName:t}},e,null,i)},o.tokenClaimsErrorHandler=(e,t,s,i,o)=>{const n=Object.create(null);k&&(n.learnMoreText=S.learnMore,n.onClickLearnMore=new l.ClickableLink(k,"_blank",null,MsPortalFx.noop,"AadErrorCodes")),this.onStatus({code:9,data:{missingClaims:s,resourceName:t},message:i},e,n,o)},o.unauthorizedTokenHandler=e=>{console.warn("ServerErrorCode:SessionEnded"),this.onStatus({code:7},e)},window.onoffline=e=>{this.onOfflineEvent(e)},window.ononline=e=>{this.onOnlineEvent(e)}}onOfflineEvent(e){this._isDialogVisible||this.isOfflineDialogVisible||(this._showDialog({extensionName:w,telemetryAction:"OfflineEvent",messageTitle:S.connectionErrorMessageTitle,messageDescription:S.offlineEventMessageDescription,defaultButtonText:S.newVersionDefaultButtonText,cancelButtonText:S.connectionErrorCancelButtonText,delayMilliSeconds:0,buttons:2,actions:0,additionalDetails:{type:e.type}}),this.isOfflineDialogVisible=!0)}onOnlineEvent(e){this.isOfflineDialogVisible&&(this._dismissDialog(),this.isOfflineDialogVisible=!1,h.trace({source:"Shell",action:"OnlineEvent",name:w}))}onLastTokenRefresh(e,t,s){const i=Date.now();h.trace({source:"Shell",action:"OnLastTokenRefresh",name:w,data:{tokenExpiresAt:t,correlationId:s}}),t<=i&&this.onStatus({code:2},e,null,s),h.trace({source:"Shell",action:"SessionEndWarning",name:w,data:{tokenExpiresAt:t}}),T.forEach((e=>{setTimeout((()=>{const t=Math.floor(e/6e4),s=t>10?I.messageFmt.format(t):I.message;E(I.title,s,"lastTokenRefresh")}),t-e-i)}))}async onStatus(e,t,s,i){if(!e||this._pageBlockingPrompt)return;const o=t===w||"HubsExtension"===t,r=e.data??{},a=r.uri??"",l=e.message??"";switch(e.code){case 0:return;case 1:return o?void await this._showDialog({extensionName:t,telemetryAction:"ShellVersionChanged",messageTitle:S.newVersionMessageTitle,messageDescription:S.newVersionMessageDescription,defaultButtonText:S.newVersionDefaultButtonText,delayMilliSeconds:3e4,buttons:2,actions:5,additionalDetails:r}):(h.trace({source:"Shell",action:"ExtensionVersionChanged",data:{correlationId:i,extensionName:t}}),v.warning(`Extension reporting incompatible server version. ${t}:${r.version}`,null,{correlationId:i}),void E(_.title,_.messageFmt.format(t),`VersionChanged-${t}`));case 2:{const e=r.resourceName;if(e){let s=P.description.format(t);e&&(s+="\n"+P.resourceName.format(e)),l&&(s+="\n"+P.errorDetails.format(l)),E(P.title,s,`AuthTokenError-${t}`,x.Information)}else this._windowManager.redirect({uri:(0,n.getErrorPageUri)("UE_SessionExpired",l),redirectAction:3,reason:`authorizationExpired_Arm_${t}`});return}case 7:return void await this._showDialog({extensionName:w,telemetryAction:"SessionExpired",messageTitle:S.sessionExpired,messageDescription:S.sessionExpiredMessage,defaultButtonText:S.refresh,buttons:1,actions:2,additionalDetails:r});case 4:{if(v.verbose(`Received a status code zero from extension ${t} for URL '${a}'.`,null,{correlationId:i}),!o)return;if(this._unknownNetworkErrorCount>3||this._isDialogVisible||this._unknownNetworkErrorCanceled)return;this._unknownNetworkErrorCount++;const e=await this._showDialog({extensionName:w,telemetryAction:"UnknownNetworkError",messageTitle:S.connectionErrorMessageTitle,messageDescription:S.connectionErrorMessageDescription,defaultButtonText:S.newVersionDefaultButtonText,cancelButtonText:S.connectionErrorCancelButtonText,buttons:2,actions:0,additionalDetails:r});return void(this._unknownNetworkErrorCanceled=1===e)}case 6:{let e=S.tooManyRequestsDescription;const s=r.retryAfter;return s&&(e=`${e} ${S.tooManyRequestsRetry.format(s)}`),void E(S.tooManyRequestsTitle,e,`TooManyRequests-${t}`,x.Warning,!0)}case 8:return void await this._showDialog({extensionName:t,telemetryAction:"MfaError",messageTitle:S.mfaError,messageDescription:e.message,defaultButtonText:S.signOutText,buttons:2,actions:2,additionalDetails:r});case 9:{const i=(r.missingClaims||"").toLowerCase().includes("capolids"),o=i?S.claimsErrorTitle:S.claimsErrorGenericTitle,n=(i?S.claimsErrorDescription:S.claimsErrorGenericDescription).format(`${t},${r.resourceName||"default"}`,k?'<a class="msportalfx-ext-link" href="" data-bind="text: learnMoreText, fxclick: onClickLearnMore"></a>':"");return void await this._showDialog({extensionName:t,telemetryAction:i?"ClaimsErrorCA":"ClaimsErrorGeneric",messageTitle:o,messageDescription:n,defaultButtonText:S.claimsErrorButtonText,cancelButtonText:S.connectionErrorCancelButtonText,buttons:2,actions:0,missingClaims:r.missingClaims,additionalDetails:MsPortalFx.extend2(r,{errorMessage:e.message}),templateViewModel:s})}default:{const s=`Received unknown extension event '${e.code}' for extension '${t}'.`;return v.error(s,null,{correlationId:i}),Promise.reject(s)}}}async _showDialog(t){if(p.isFeatureEnabled("nostatusmodal"))return 2;let s;const i=r.hasFlag(t.actions,2);let o;this._pageBlockingPrompt=r.hasFlag(t.actions,1),t.telemetryAction&&h.trace({source:"Shell",action:t.telemetryAction,name:t.extensionName,data:t.additionalDetails}),i&&(o=3);const n=(e,s)=>{this._windowManager.redirect({skipFlushBuffers:i,delayPromise:e&&t.delayMilliSeconds?p.delay(t.delayMilliSeconds):null,redirectAction:o,reason:s})};if(r.hasFlag(t.actions,4)&&this.isShellInitialized.promise.isPending())return s=Promise.withResolvers().promise,n(!1,"shouldSkipPrompt"),s;const a=Promise.withResolvers();this._isDialogVisible=!0;const l=await this._dialogManager.showModalDialog({title:t.messageTitle,description:t.messageDescription+'<div class="fxt-copy"><a href="#" data-bind="text: copyText, click: copyClick"></a></div>',templateViewModel:MsPortalFx.extend2(t.templateViewModel,{copyText:S.copyText,copyClick:()=>{const e=JSON.stringify(MsPortalFx.extend2(F,t.additionalDetails),null,2),s=FxImpl.createElement("pre");s.textContent=e,y.body.appendChild(s);const i=b.getSelection();i.removeAllRanges();const o=y.createRange();o.selectNodeContents(s),i.addRange(o),b.document.execCommand("copy"),s.remove()}}),defaultButtonText:t.defaultButtonText,cancelButtonText:t.cancelButtonText,buttons:t.buttons,uiShield:{hidePromise:a.promise}});if(!t.missingClaims||4!==l)return this._pageBlockingPrompt?(this._rootElements.showSplash(!0),a.resolve(),n(!0,"isPageBlockingPrompt")):4===l?n(!1,"isNotPageBlockingPrompt_Ok"):a.resolve(),this._isDialogVisible=!1,s;{const s=await MsPortalFx.require(e.normalize("./UI.NavigationManager.ForceSignIn"));try{await s.forceSignIn(this._diContainer,{bladeDeepLink:window.location.hash,signInParameters:JSON.parse(t.missingClaims),reason:"MissingClaims"},w)}catch(e){h.trace({source:"UIStatusHandler",action:"ErrorForcingMfaSignIn",data:{error:MsPortalFx.sanitizeMessage(JSON.stringify(e))}})}}}_dismissDialog(){this._dialogManager.hasOpenDialog&&this._dialogManager.dismissOpenDialog(0),this._isDialogVisible=!1}};t.StatusHandler=D=__decorate([__metadata("fx:diagnostics",[e,"StatusHandler"]),s.Class(),__metadata("design:paramtypes",[s.Container,o.DialogManager,n.RootElements,n.WindowManager,a.SecurityTokensManager])],D)})),
define("MsPortalImpl/UI/UI.Initialize",["require","exports","FxInternal/Events","MsPortalImpl/Base/Base.KnockoutExtensions","MsPortalImpl/Base/Base.KnockoutExtensions.FxClick","MsPortalImpl/Base/Base.KnockoutExtensions.Image","MsPortalImpl/Controls/ControlBindings","MsPortalImpl/Base/Base.KnockoutExtensions.Copy","MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding","MsPortalImpl/Base/JQueryExtensions","MsPortalImpl/Parts/Parts.Intrinsics","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Parts/Parts.ButtonPart","MsPortalImpl/Parts/Parts.Collection","MsPortalImpl/Services/Services.ExtensionTokensManager","MsPortalImpl/Services/Services.SharedSettings","MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder","MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration","Fx","Fx/Diagnostics","Fx/DependencyInjection","Fx/Feedback","Fx/Telemetry","Fx/UriBuilder","MsPortalImpl/Services/Services.BrowserTelemetry","Fx/Composition/Selectable","FxInternal/Experimentation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/UI/UI.DialogManager","FxInternal/AsyncLoader","MsPortalImpl/RpcEndPoints","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.Router","MsPortalImpl/Base/ClaimsIdentity","MsPortalImpl/Base/Languages","MsPortalImpl/Base/Themes","MsPortalImpl/Controls/ControlBindings.Async","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Interactions/Interactions.PrintHandler","MsPortalImpl/Services/Services.AssetTypes.Rpc","MsPortalImpl/Services/Services.BrowseCuration","MsPortalImpl/Services/Services.HatsSettings","MsPortalImpl/Services/Services.FavoritesSettings","MsPortalImpl/Services/Services.FeedbackPolicies","MsPortalImpl/Services/Services.HomeViewSettings","MsPortalImpl/Services/Services.FileUploadEndpointRegistration","MsPortalImpl/Services/Services.FileUploadInitialization","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Services/Services.PortalIdleState","MsPortalImpl/Services/Services.PortalPollingManager","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/Services/Services.SessionManager","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Recents","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Services/Services.ShellProvisioner","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Services/Services.Subscriptions","MsPortalImpl/Services/Services.TelemetrySharing","MsPortalImpl/Services/Services.Tenants","MsPortalImpl/Services/Services.Util","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Widgets/Widgets.Portal","MsPortalImpl/Widgets/Widgets.ToastViewModel","MsPortalImpl/UI/UI.BladeOpener","MsPortalImpl/UI/Compositions/UI.Composition.Services","MsPortalImpl/UI/UI.DirectoryHelper","MsPortalImpl/UI/Hubs/UI.FavoritesManager","MsPortalImpl/UI/Hubs/UI.NotificationHelper","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/Notifications/NotificationsArea","MsPortalImpl/UI/Hubs/UI.NotificationsPane","MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration","MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration","MsPortalImpl/UI/UI.AdvisorNotificationHelper","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.CopilotToastHelper","MsPortalImpl/UI/UI.DesktopManagerImpl","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/UI.NpsHelper","MsPortalImpl/UI/UI.SessionHandler","MsPortalImpl/UI/UI.StatusHandler","MsPortalImpl/Services/Services.ProjectedDirectories","MsPortalImpl/UI/Commands/Base.PortalFunctions","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Notifications/PortalNotifications","MsPortalImpl/Widgets/Widgets.Portal.init","MsPortalImpl/Services/Services.BrowserSettings","MsPortalImpl/UI/UI.PassthroughUser","MsPortalImpl/Services/Services.GitHub","FxInternal/Notifications","Fx/Experimentation","MsPortalImpl/Services/Services.PersonalizationData","FxInternal","MsPortalImpl/Utilities/UrlUtilities","MsPortalImpl/Services/Services.MfaSettings"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m,g,h,f,x,b,y,v,w,M,C,S,I,P,_,F,T,k,E,D,A,B,N,R,L,z,H,O,U,W,V,q,j,G,K,J,Q,X,Z,Y,ee,te,se,ie,oe,ne,re,ae,le,ce,de,pe,ue,me,ge,he,fe,xe,be,ye,ve,we,Me,Ce,Se,Ie,Pe,_e,Fe,Te,ke,Ee,De,Ae,Be,Ne,Re,Le,ze,He,Oe,Ue,We,Ve,qe,$e,je,Ge,Ke,Je){"use strict";t.Portal=t.DEV=void 0,t.registerAsyncHandlers=Zt,t.routeIfHash=Lt,t.subscribeNotifications=jt;var Qe=FxImpl.Extension,Xe=FxImpl.TriggerableLifetimeManager,Ze=MsPortalFx.Base,Ye=Ze.Constants.Shell,et=Ze.Diagnostics,tt=et.Telemetry,st=FxImpl.NetDiagnostics,it=Ze.Resources,ot=FxImpl.Rpc,nt=Ze.Net2,rt=et.Metric;const at=window,lt=at.performance,ct=at.fx,dt=ct.getTimestamp;let pt=tt.flush,ut=rt.flush;const mt=ot.client,gt="Shell",ht=ct.environment,ft=ht.links,xt=ht?.customNotificationsProvider,bt="TopBar",yt=MsPortalFx.ensureSuffix,vt=MsPortalFx.getLogFriendlyMessage,wt=MsPortalFx.noop,Mt=yt(it.getAppRelativeUri("/"),"/"),Ct=at.location,St=(0,M.createLog)(e),It=Mt+"SignOut",Pt=e=>Mt+e.slice(1),_t="loadedPageVersion",Ft=de.ComponentName.Telemetry,Tt="FirstVisitedTimestamp",kt="gallery_createLauncher_lastUsed_subscriptionId",Et=Object.create(null),Dt="portalInit_lastSessionId",At={Overview:1,DirectoriesAndSubscriptions:2,Filters:3,AppearanceAndStartup:4,LanguageAndRegion:5,MyInformation:6,SignoutAndNotifications:7,MoreAzureResources:9};let Bt,Nt,Rt="";function Lt(e,t,s){t&&t.startsWith("#")&&e.route(t,s)}function zt(e,t,s){I.trace({source:e,action:t,data:s})}function Ht(e,t,s,i,o){zt(gt,"PortalInitializeNpsModal"),Ae.showPortalNps(e,t,s,i,o).catch((e=>{zt(gt,"PortalInitializeNpsModalFailure",{error:vt(e)})}))}function Ot(e){e=e||{};const t=new P(It);t.query.setParameters(e);const s="feature.msaljs",i=new P(at.location.href).query.getParameter(s);return i&&t.query.setParameter(s,i),t.toString()}function Ut(e){const t=Ue.temporaryExtensionCount.getExtensionCountsAsList();e.addExtensionCounts(t),Ue.temporaryExtensionCount.flush()}nt.setAjaxLogFunc((function(){St.warning.apply(St,arguments)}));let Wt=function(e,t,s,i){Date.now()>t&&Vt(e,s,i)};let Vt=function(e,t,s){clearInterval(s()),e.addCallbacks({onIdle:e=>{if(5<e){MsPortalImpl.sessionStorage.setItem("wasForceReloaded","true"),tt.trace({source:gt,action:"ForceRefresh",actionModifier:"Idle",data:{idleTimeInMins:e,reloadAfterMilliseconds:t}});const s=[pt(),ut()];Promise.all(s).then((()=>{Ct.reload(!0)}))}}})};async function qt(e,t,s,i,o){try{const n=await t.querySetting(12,Tt),r=Date.now(),a=!n||n+3e5>=r;if(i.isEnabled("disablemodalsonfirstvisit")&&a)return void zt(gt,"SkipStartupModalSequence");const l=e.get(xe.ViewModel);await async function(e,t,s,i,o){const n=await s.queryStore(28),r="true"===n?.ManualMfaLoginSucceeded||!0===n?.ManualMfaLoginSucceeded,a=await MsPortalFx.require("MsPortalImpl/UI/UI.MfaNotificationHelper");a?.handleMfaNotificationLogic(e,i,t,o,r).then((t=>{t||(0,Je.handleArmMfaGeneralNotificationLogic)(e,i,o?.isTenantAdmin).catch((e=>{zt(gt,"handleArmMfaGeneralNotificationLogicFailure",{error:vt(e)})}))})).catch((e=>{zt(gt,"handleMfaNotificationLogicFailure",{error:vt(e)})}))}(e,l,t,s,o);const c=e.get(re.PortalStartupMarkers),d=e.get(He.PortalNotifications),p=e.get(J.HatsSettings);if(async function(e,t){const s=t.userInfo.isTenantParityDependent??!1,i=t.portalNotifications.shouldShowContactability(),o=Ae.shouldShowPortalNps(t.generalSettings.userOptedOutOfNpsSurvey,t.generalSettings.npsTimeMs),n=t.portalNotifications.shouldShowIrisAdvisor(),r=await ke.shouldShowCopilotToast(e,t.userSettingsManager,t.userInfo.isTenantAdmin),a=t.generalSettings.notificationToastEnabledKey();Ue.temporaryExtensionCount.addIntervalId(setInterval((()=>Ut(t.hatsSettings)),6e5));let l="";s?l="SkippedModalsWhenParityDependent":(0,w.isFeatureEnabled)("hidemodalswhendeeplinked")&&t.deeplinkLoadedPortal?l="SkippedModalsWhenDeeplinked":a||(l="SkippedModalsWhenUserDisabled");if(l){if(zt(gt,l,{deeplink:t.deeplinkLoadedPortal,isTenantParityDependent:s,shouldShowWelcomeSequence:t.eligibleForWelcomeSequence,shouldShowContactability:i,shouldShowNps:o,shouldShowAdvisorNotification:Fe.shouldShowAdvisorNotification(),shouldShowIrisAdvisor:n,shouldShowCopilotToast:r,shouldShowModalsAndToasts:a}),o&&a)return Ht(t.generalSettings,t.userSettingsManager,t.toastVM,t.generalSettings.npsTimeMs,e);if(r){if(await ke.showCopilotToast(e,t.userSettingsManager,t.toastVM))return}return}if(t.eligibleForWelcomeSequence){const e=performance.now();await t.welcomeSequenceCallback();const s=performance.now();return void zt(gt,"PortalInitializeWelcomeModal",{welcomeSequenceLoadDuration:s-e})}if(i)return zt(gt,"PortalInitializeUpdateContactModal"),void await t.portalNotifications.showContactabilityModal(e);if(n)return zt(gt,"PortalInitializeIrisAdvisor"),void await t.portalNotifications.showIrisAdvisor(e);if(!(0,w.isFeatureEnabled)("showirisadvisor")&&await Fe.showAdvisorNotification(t.userSettingsManager))return void zt(gt,"PortalInitializeAdvisorModal");if(o)return void Ht(t.generalSettings,t.userSettingsManager,t.toastVM,t.generalSettings.npsTimeMs,e);if(r){if(await ke.showCopilotToast(e,t.userSettingsManager,t.toastVM))return}return function(e,t){if((0,w.isFeatureEnabled)("canmodifyextensions")||(0,w.isFeatureEnabled)("testdevsat"))return(0,w.require)("MsPortalImpl/UI/UI.DevSATSurvey").then((s=>{s.showDevSAT(e,t)}))}(t.toastVM,t.generalSettings.devSatTimeMs)}(e,{deeplinkLoadedPortal:!c.defaultRoute&&Rt,welcomeSequenceCallback:()=>(0,je.checkPersonalizedSurveyEligibility)(e)?e.get(Le.ShowPersonalizedSurvey).invoke():e.get(Le.ShowWelcomeSequence).invoke({skipWelcomePrompt:!1,shouldDisplaySettingBubble:!1}),eligibleForWelcomeSequence:await is(e),portalNotifications:d,generalSettings:s,toastVM:l,userSettingsManager:t,hatsSettings:p,userInfo:o}).catch((e=>{zt(gt,"StartupModalsFailure",{error:vt(e)})})),i.isEnabled("nodirectory")){e.get(R.Router).route("#settings/directory",{openedBy:7})}}catch(e){zt(gt,"QuerySettingsFailure",{error:vt(e)})}}function $t(e){return(0,w.isFeatureEnabled)("mspfilter")?e.getAsync(Re.ServicesProjectedDirectories):Promise.resolve(void 0)}function jt(e,t,s,i,o){e.notifications.subscribeArrayChanges(t,(e=>{Me.showToastAndUpdateCount(s,e,s.get(FxImpl.Features).isEnabled("enablecustomnotificationsprovider")&&Et.customNotificationsProviderViewModel?.isPaneOpen?Et.customNotificationsProviderViewModel:i,o)}),(e=>{Me.updateNotificationCount(e,i)}))}const Gt={initializeCustomTopBarButtons:function(e,t){const s="fxs-topbar-active";e.topBar.customTopBarButtonClick=(i,o,n)=>{zt(bt,"CustomTopBarButtonClicked",{bladeTarget:i,extensionName:o});const r=e.getWidget().element.find(`.${n}`),a=r.hasClass(s);if(r.toggleClass(s,!a),a)t.get(Te.RightContextPane).close();else{const r=new F.PdlBladeReference(i,o,{onClosed:()=>{zt(bt,"CustomTopBarButtonClosed",{bladeTarget:i,extensionName:o});e.getWidget().element.find(`.${n}`).removeClass(s)}});t.get(be.BladeOpener).openBlade(r,{flags:1,telemetryName:`CustomTopBarButtonOpened_${i}`}).then((()=>zt(bt,"CustomTopBarButtonOpened",{bladeTarget:i,extensionName:o}))).catch((e=>{zt(bt,"CustomTopBarButtonOpenFailed",{error:e,bladeTarget:i,extensionName:o})}))}}},initializeFeedbackPane:function(e,t){e.feedbackButtonClick=()=>{t.getAsync(ye.FeedbackPaneInfo).then((e=>{const t=e.widget;zt(bt,"FeedbackSmileyClicked",{isPaneOpen:t.isVisible()}),t.toggle()}))}},initializeNotificationsPane:function(e,t,s,i,o){const n=new Ie.ViewModel(t),r=xt?.blade,a=t.get(FxImpl.Features).isEnabled("enablecustomnotificationsprovider"),l=(0,w.memoizePromise)((()=>{if(!a||!r)return(0,w.require)("MsPortalImpl/Widgets/Widgets.NotificationsPane").then((e=>new e.Widget(o,n)))}));jt(i,o,t,n,s),e.topBar.notificationButtonClick=()=>{if(a&&r){const e=new F.PdlBladeReference(r,xt?.extensionName);t.get(be.BladeOpener).openBlade(e,{flags:1,telemetryName:`OpenCustomNotificationsPane_${r}`}).then((e=>{e&&(s.removeAllToasts(),Et.customNotificationsProviderViewModel?.isPaneOpen(!0))})).catch((e=>{zt(bt,"OpenCustomNotificationsPaneFailed",{error:e})}))}else l().then((e=>{e.toggleNotificationsContextPane().then((e=>{e?(s.removeAllToasts(),Me.updateUnreadCountOnButton(0)):n.isPaneOpen(!1)}))}))};const c={events:"fxtoastclick",handler:(e,t)=>{i.handleNotificationClick(t.data.value,!0)}};s.eventHandlers.push(c)},initializeSearch:function(e,t,s){e.initOptions((()=>(0,w.require)("MsPortalImpl/Widgets/Widgets.SharedOptionsInit").then((i=>{i.initSearchWidgetOptions(s,e,t)}))))},initializeSettings:function(e,t,s){const i=e.topBar;let o=1;const n=t.get($e.Experimentation).shellAssignments.getBooleanValue("newsettingsmenu"),r=!s.isEnabled("hidesettingsoverview"),a=!s.isEnabled("hidedirectorypanebutton");r||(o=a?2:4),i.settingsButtonClick=()=>{const s=e.settingsFlyoutState.value;let i=!0;if(0===s&&(i=t.get(Te.RightContextPane).close()),i)if(zt(bt,s?"SettingsFlyoutClose":"SettingsFlyoutOpen"),0!==s)e.settingsFlyoutState(0);else{let s=o,i=!1;if(n){const n=MsPortalImpl.sessionStorage.getItem("Settings_LastVisitedTab");if(n&&At[n]&&(s=At[n],i=!0),!i&&!r&&a)return void t.get(me.TenantsService).getHomeTenantsCount().then((t=>{let s;s=1===t?3:2,e.settingsFlyoutState(s)})).catch((()=>{e.settingsFlyoutState(o)}))}e.settingsFlyoutState(s)}}},initializeTopBar:function(e,t,s,i,o){const n=t.get(xe.ViewModel),r=e.topBar;this.initializeSettings(e,t,o),this.initializeFeedbackPane(r,t),Ge.tryImmediateResolve(e.onWidgetCreate(),(()=>{!o.isEnabled("asyncSearch")&&this.initializeSearch(r.searchViewModel,t,s)})),this.initializeNotificationsPane(e,t,n,i,s),this.initializeCustomTopBarButtons(e,t)},markFromNavigation:function(e){lt.mark(e);try{lt.measure(e,"Navigation",e)}catch(t){const s=[t];try{s.push(...lt.getEntriesByName("Navigation")||[]),s.push(...lt.getEntriesByName(e)||[])}catch(e){s.push(e)}St.error("Error calling Performance.measure",0,...s)}}};function Kt(e){return e.getAsync(re.SettingsManager).then((e=>re.queryStores(e,[4]))).then((e=>{const t=e?.get(4),s=t&&t[le.startBoardSettingsKey];return s&&s.dashboardId||""}))}function Jt(e){e.get(re.PortalStartupMarkers).preloadDashboardStart=dt(),Gt.markFromNavigation("preloadDashboardBundle"),(0,w.require)("MsPortalImpl/UI/Dashboard/DashboardManager"),Ge.tryImmediateResolve(function(e){const t=(0,ze.getCurrentUri)().getHashParts();return"dashboard"===t.category.toLowerCase()&&t.rest?Promise.resolve(t.rest):Kt(e)}(e),(t=>{t=(t||"").toLowerCase();const s=e.get(re.PortalStartupMarkers);t?.startsWith("private")?(Gt.markFromNavigation("preloadDashboardPrivateRepoBundle"),(0,w.require)("MsPortalImpl/UI/Dashboard/PrivateDashboardRepository"),s.preloadDashboardRepoStart=dt(),s.preloadDashboardRepoType="private"):t?.startsWith("arm")&&(Gt.markFromNavigation("preloadDashboardArmRepoBundle"),(0,w.require)("MsPortalImpl/UI/Dashboard/ArmDashboardRepository"),s.preloadDashboardRepoStart=dt(),s.preloadDashboardRepoType="arm")}))}function Qt(e,t,s){e.get(t).setRegistration(s)}function Xt(e,t,s){Qt(e,t,((t,i)=>function(e){const t=e.get(re.PortalStartupMarkers);return t.hasOwnProperty("requireDashboardStart")||(t.requireDashboardStart=dt()),e.getAsync(A.get("MsPortalImpl/UI/Dashboard/DashboardManager","DashboardManagerImpl"))}(e).then((e=>s(e,t,i)))))}function Zt(e){Xt(e,Le.StartNewDashboardPortalFunc,((e,t,s)=>e.startNewDashboard(s))),Xt(e,Le.ExportDashboardPortalFunc,(e=>e.getArmDashboardJson())),Xt(e,Le.ImportDashboardPortalFunc,((e,t)=>e.importDashboard(t.dashboard,t.title))),Xt(e,Le.ReadDashboardPortalFunc,((e,t)=>e.readDashboardsForType(t.repositoryType,t.subscriptions,t.useArg,t.includeRecents))),Xt(e,Le.SwitchDashboardPortalFunc,((e,t,s)=>e.switchDashboard(t,s))),Xt(e,Le.ResetDashboardPortalFunc,((e,t)=>e.resetLayout(t.duringPortalStartup,t.force))),Xt(e,Le.CloneDashboardPortalFunc,(e=>e.cloneCurrentDashboard())),Xt(e,Le.UpdateDashboardPortalFunc,((e,t)=>e.updateDashboard(t.dashboard))),Xt(e,Le.ClonePartPortalFunc,((e,t,s)=>e.clonePartToDashboardJson(t.partComposition,s,t.dashboard,t.isCopyExperience))),Xt(e,Le.AssignTagsToDashboardPortalFunc,((e,t,s)=>e.assignTagsToDashboard(s))),Xt(e,Le.ShareCurrentDashboardPortalFunc,((e,t)=>e.shareCurrentDashboard(t.title,t.armExtras))),Xt(e,Le.ShareDashboardToSessionPortalFunc,((e,t)=>{e.shareCurrentDashboardToSession(t)})),Xt(e,Le.UnshareDashboardToSessionPortalFunc,(e=>e.unshareCurrentDashboard())),Xt(e,Le.GetUserPermissionsForDashboardPortalFunc,((e,t)=>e.getPermissions(t))),Xt(e,Le.IsCurrentDashboarSharedPortalFunc,(e=>e.isCurrentDashboardShared())),Xt(e,Le.GetCurrentDashboardPropertiesPortalFunc,(e=>e.getCurrentDashboardProperties())),Xt(e,Le.PinTilesPortalFunc,((e,t,s)=>e.pinMultipleParts(t.partReferences,t.originExtension,t.notify,s,t.dashboard?t.dashboard:null,t.dashboardCreationOption?t.dashboardCreationOption:null))),Xt(e,Le.PinTileWithOptionsPortalFunc,((e,t,s)=>e.addPartToStartBoard(t.options,t.duringPortalStartup,t.shouldSave,s))),Xt(e,Le.PinBladePortalFunc,((e,t,s)=>e.pinBladeToDashboard(t,s))),Xt(e,Le.PinTilePortalFunc,((e,t,s)=>e.pinPartToStartboard(t,s))),Xt(e,Le.DeleteDashboardWithConfimationPortalFunc,((e,t)=>e.deleteDashboardWithConfirmation(t.currentContext,t.reasonDeleted))),Xt(e,Le.RefreshDashboardPortalFunc,((e,t,s)=>e.refreshDashboard(s))),Qt(e,Le.RoutePortalFunc,(t=>e.getAsync(A.get("MsPortalImpl/Base/Base.Router","Router")).then((e=>e.route(t.uri,t.openedByContext))))),Qt(e,Le.ReplacePartPortalFunc,(t=>A.get("MsPortalImpl/UI/UI.ReplacePart","replacePart").then((s=>s(e,t.part,t.newLocator,t.options))))),Qt(e,Le.ReloadPartPortalFunc,(t=>A.get("MsPortalImpl/UI/UI.ReloadPart","reloadPart").then((s=>s(e,t))))),Qt(e,Le.CreateJourneyForBladeFunc,(t=>A.get("MsPortalImpl/UI/UI.CreateJourney","createJourney").then((s=>s(e,t,!1))))),Qt(e,Le.CreateJourneyForAssetFunc,(t=>A.get("MsPortalImpl/UI/UI.CreateJourney","createJourney").then((s=>s(e,t,!0))))),Qt(e,Le.ToggleCloudShell,(()=>e.getAsync(A.get("MsPortalImpl/UI/UI.AzureConsole","AzureConsole")).then((e=>{e.toggle()}))))}function Yt(){return MsPortalFx.convertArrayToMap(["EntryPoint","SignInIndex"],(e=>`PageTelemetry_${e}`),((e,t,s)=>{const i=MsPortalImpl.sessionStorage.getItem(s);if(i)return MsPortalImpl.sessionStorage.removeItem(s),JSON.parse(i)}))}function es(e,t){const s=(t=t||{}).duration||dt(),i=t.data||{};return tt.trace({timestamp:t.endTime,source:gt,action:e,actionModifier:tt.ActionModifier.Complete,duration:s,data:i}),rt.record({name:e,value:s,dimensions:{actionModifier:tt.ActionModifier.Complete}}),Gt.markFromNavigation(e),s}let ts=function(){Ct.href=Ct.origin};let ss=t.Portal=class{constructor(e){this._diContainer=e,this._lifetime=new Xe}async initialize(t){const s=this._lifetime,i=this._diContainer,o=i.get(De.RootElements),n=i.get(FxImpl.Features),r=i.get(de.StorageService),a=new P(Ct.href),l=dt();Gt.markFromNavigation("enterUIInitialize"),tt.Internal.initialize({extensionName:gt,userQuery:MsPortalEarly.userQuery}),rt.Internal.initialize({extensionName:gt,userQuery:MsPortalEarly.userQuery}),MsPortalEarly.initializedTelemetry(tt.trace);const c=setInterval((()=>{pt(),ut()}),14e3);O.initialize();const d=i.get(T.ExperimentationManager),p=await d.shellAssignments.whenAvailable();if(!(0,Ke.isTestEnvironment)()){if(p.getBooleanValue("showUnsafeURLCustomizationWarning")){const e=10;await async function(e,t){if(e.size>0){ko.bindingHandlers.pcSimpleButton=g.getAsyncBindingHandler("MsPortalImpl.Controls/Controls/SimpleButton",null);const s=t.get(D.DialogManager),i=new D.MessageBox(k.Shell.Dialogs.unsafePortalTitle,null,4),o=Array.from(e,(([e,t])=>`${e}: ${t}`));i.description=`${k.Shell.Dialogs.unsafePortalDescription.format(["",...o].join("<br/>"))}`,i.defaultButtonText=k.Shell.Dialogs.unsafePortalReload,i.cancelButtonText=k.Shell.Dialogs.unsafePortalContinue,zt(gt,"PortalUnsafeParamsDialogShown",{PotentiallyUnsafeURLParams:Array.from(e.keys())}),Gt.markFromNavigation("enterUnsafePortalDialog"),6===await s.showModalDialog(i)&&ts(),Gt.markFromNavigation("exitUnsafePortalDialog")}}((0,Ke.getUnsafeParams)(e),this._diContainer)}}t.resolve(!0),Zt(i),tt.trace({source:gt,action:"TrackPreviousSessionId",data:MsPortalImpl.sessionStorage.getItem(Dt)}),MsPortalImpl.sessionStorage.setItem(Dt,MsPortalFx.sessionId);const u=function(e){return e.getAsync(re.SettingsManager).then((t=>Promise.all([t.querySetting(12,Tt),e.getAsync(te.GeneralSettings),e.get(FxImpl.Features)]).then((([t,s,i])=>{const o=!t;return i.isEnabled("landalltohome")&&o&&s.landingPage(1),(0,te.isLandingPageDashboard)(e)}))))}(i);!function(e,t){const s=(0,ze.getCurrentUri)().getHashParts().category.toLowerCase();switch(s){case"blade":case"create":case"asset":case"resource":["MsPortalImpl/UI/UI.CreateJourney","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener"].forEach((e=>{(0,w.require)(e),zt(gt,"PortalInitializeDeeplinkPreload",{routeType:s,moduleId:e})})),Rt=s;break;case"dashboard":Jt(e);break;case"":(0,w.isFeatureEnabled)("azureHome")?t.then((t=>{t&&Jt(e)})):Jt(e)}}(i,u),await Promise.all([i.getAsync(E.AuthStateManager),i.getAsync(U.ExtensionManager),i.getAsync(oe.SecurityTokensManager),i.getAsync(re.SettingsManager),i.getAsync(ae.MruTokensSettingsManager),$t(i)]).then((([t,d,m,g])=>{const h=ht.pageVersion,f=function(e,t){const s=e.getValue(Ft,_t,0);return t!==s&&e.setValue(Ft,_t,t,0),s}(r,h),x=i.get(re.PortalStartupMarkers);x.defaultRoute=!1,x.splashScreen=MsPortalEarly.splashScreenLoadTime,x.initializeStart=dt(),x.enterUIInitialize=l,x.loadedSameVersion=h===f,x.previousVersion=f||"",x.performanceTelemetry=FxImpl.NetDiagnostics.getPerformanceTelemetry(),x.requireConfigPerf=MsPortalImpl.requireConfigPerf,x.extensionCount=d.getExtensions().length,Gt.markFromNavigation("initializeStart"),function(){const e=MsPortalImpl.sessionStorage.getItem("SavedLogs")||"{}";try{const t=JSON.parse(e);t?.length&&t.forEach((e=>tt.trace({timestamp:e.timestamp,source:e.source,action:e.action,actionModifier:e.actionModifier,duration:e.duration,data:e.data}))),pt()}catch{}MsPortalImpl.sessionStorage.removeItem("SavedLogs")}();const b=t.bootstrapState,y=b.loginReplyUrlPath,v=t.getCurrentUser();FxImpl.Base.Diagnostics.setObjectIdToScrub(v.objectId);const M=new URLSearchParams(window.location.search),C=M.get("exp.msaljsloginexp");if(!b)return zt(gt,"SignInRedirect","AuthBootstrapState not found. Redirecting the user to sign-in."),void N.redirectWithCdn(i,{uri:Pt(y),parameters:C&&E.getMsalJsLoginQueryParameters(C),hash:Ct.hash});n.isEnabled("enableanimations",!0)||$.enableAnimations(!1);const I="/auth/login/"===y,P=p.getBooleanValue("msaljsloginexp");MsPortalImpl.sessionStorage.setItem("sessionreplyurl",y),["disabletenantedpagerefreshoptimization","flightedcustomdomainclientidexp","mfaloginexp","msaljsloginexp","nativebrokerexp","prefetchtokenexpv2"].forEach((e=>{const t=p.getStringValue(e);oe.persistOrClearFeatureValueInLocalStorage({experimentValue:t,localStorageEntryKey:e,data:{currentPortalLoginWithMsalJs:I,nextPortalLoginWithMsalJs:P}})}));const F=v.isMfa;zt("UI.Initialize","mfaLoginState",{currentPortalLoginWithMsalJs:I,isMfa:F});const T=i.get(se.PortalIdleStateService);B.registerRpc(i);const D=/^.*[/|.]entra\..*$/i.test(FxImpl.trustedParentOrigin??""),O=new q.PortalReader(s,{idPrefix:"portal"});O.read(D?k.Shell.Reader.entraLoading:k.Shell.Reader.portalLoading);const ae=i.get(Ne.StatusHandler),be=Promise.all([i.getAsync(te.GeneralSettings),i.getAsync(He.PortalNotifications),i.getAsync(J.HatsSettings),i.getAsync(Q.UserDirectorySettings),i.getAsync(Z.HomeViewSettings),i.getAsync(we.FavoritesManager),i.getAsync(H.ThemeManager),i.getAsync(U.ExtensionManagerOptions)]).then((([l])=>{x.initializeGeneralSettings=dt(),(0,X.setupPolicyDependencies)(l),Gt.markFromNavigation("initializeGeneralSettings");const h=z.initialize(s,i,n.shellFeatures.fromQuery.l,void 0!==a.query.getParameter("l"));h.requireRedirect&&this._redirect({uri:null,skipFlushBuffers:!0,reason:"Locale",logData:h}),MsPortalFx.isObject(ht)&&console.log("Version: "+ht.version+"\nSession: "+MsPortalFx.sessionId),W.initialize(),s.registerForDispose((()=>{W.dispose()}));const f=(0,Oe.getPortalViewModel)(i);x.portalWidgetStart=dt(),i.get(fe.Widget),x.portalWidgetEnd=dt(),ye.initialize(s,i,f),x.uiCompositionInitEnd=dt();const I=i.get(pe.SubscriptionsUserContext).getGlobalSelectedSubscriptions().then((e=>e())),P=I.then((e=>{Fe(e),zt(gt,"getGlobalSelectedSubscriptions",{first100SubscriptionIds:e.slice(0,100).map((e=>e.subscriptionId)),globalSelectedSubscriptionCount:e.length})}));(0,w.require)("MsPortalImpl/Services/Services.Recents").then((e=>e.loadRecentsFromLazyData(i)));const F=i.get(Ce.NotificationManager);n.isEnabled("enablecustomnotificationsprovider")&&xt?.provider&&(0,w.require)("MsPortalImpl/UI/UI.CustomNotificationsHelper").then((e=>{e.activateCustomNotificationProvider(i,F,Me.updateUnreadCountOnButton,Et)})).catch((e=>{zt(gt,"GetCustomNotificationsHelperFailed",{error:e})})),i.get(Se.DataContext),d.lastExtensionError.subscribeAndRun(s,(e=>{e&&F.addSingleNotification({title:k.Shell.extensionError,description:{htmlTemplate:k.Shell.loadingError.format(e.name,`${fx.environment.trustedParentOrigin}/SelfHelp`)},status:2})})),Qe.extensionStatusEndPoint.register(mt,null,((e,t)=>{e&&Ie(e,t.srcWindowId)}));const T=f.topBar;T.exitDevMode=()=>{o.showSplash(!0),MsPortalImpl.Extension.unregisterAll().then((()=>{this._redirect({uri:Mt})}))},Qt(i,Le.DownloadDiagnosticsJson,(()=>(0,w.require)("MsPortalImpl/Base/Base.ClientRawFileDownload",e).then((e=>{e.downloadFile({provideText:()=>B().then((e=>JSON.stringify(e,null,2)))},"PortalDiagnostics.json","charset=utf-8;application/json")}))));const E=(0,w.memoizePromise)((()=>(0,w.require)("MsPortalImpl/Base/Base.DebugInfo").then((e=>e.initialize(s,i)))));Qt(i,Le.ShowDebugTools,(e=>E().then((t=>t.toggleStickys(Bt,e))))),(0,w.isFeatureEnabled)("telemetryinsights")&&Qt(i,Le.ShowTelemetryInsights,(async()=>{const{TelemetryInsights:t}=await(0,w.require)("../Services/Services.TelemetryInsights",e);i.get(t).toggleOverlay(s)})),i.get(V.KeyboardShortcutHandler),Qt(i,Le.ShowPersonalizedSurvey,(async()=>{const e=(await(0,w.require)("MsPortalImpl/Widgets/Widgets.PersonalizedSurvey")).Widget.create(i,f);return s.registerForDispose(e),e})),Qt(i,Le.ShowWelcomeSequence,(e=>A.get("MsPortalImpl/Widgets/Widgets.WelcomeSequence","Widget").then((t=>{const o=t.create(f,g,e,i);return s.registerForDispose(o),o}))));const D=()=>i.get(me.TenantsService).getTenants(),B=()=>Promise.all([(0,w.require)("MsPortalImpl/Base/Base.DiagnosticsPopup"),P,D()]).then((([e,t,s])=>e.getDiagnosticsData(i,ko.observableArray(s.tenants),m)));T.reportBug=()=>{(0,w.require)("./UI.Portal.Actions",e).then((e=>{e.reportBug(i,a)}))},(0,w.isFeatureEnabled)("subscreditcheck")&&(0,w.isFeatureEnabled)("upgradefromtrialbutton")&&(0,w.require)("MsPortalImpl/Services/SubsCreditCheck").then((e=>{e.subscriptionsRequiringUpgrade.subscribeAndRun(s,(e=>{1===e.length?(tt.trace({action:"FreeTrialUpgradeShown",source:"TopBar",data:{subscriptionId:e[0].subscriptionId,creditsRemaining:e[0].remaining}}),T.canUpgradeSubscription(!0),T.upgradeableSubscription({subscriptionId:e[0].subscriptionId,remaining:e[0].remaining})):T.canUpgradeSubscription(!1)}))}));const O=i.get(R.Router),U=MsPortalFx.getIdGenerator("SideBarOpeningBlade");f.sideBar.launchBlade=(e,t)=>{const s=O.route(e,{openedBy:t?1:void 0}),i=f.getJourneyWidget();if(i){const e=U();i.loadingHint(e,!0),s.finally((()=>{i.loadingHint(e,!1),i.trigger("fxbladerepos")}))}},K.initializeRpc(),ge.registerEndpoints(ot.client,i),Gt.markFromNavigation("beforeInitDesktopMgr"),x.beforeInitDesktopMgr=dt();const q=e=>{let t;t=v.gitHubUserId?Promise.resolve(`${"https://avatars.githubusercontent.com/u/{0}".format(v.gitHubUserId)}`):n.isEnabled("serveravatar")?g.queryStore(0).then((e=>(r.clearAllComponentItems(de.ComponentName.Avatar,0),(e||{})[le.avatarKey]||v.defaultAvatarUri))):L.getAvatarImage(v.emailAddress,v.avatarUri,v.defaultAvatarUri,r,e),t.then((e=>{oe.avatarImage(e)})).catch((e=>{zt(bt,"AvatarImageFetchFailed",{error:vt(e)})}))},J=async function(e,t,s,i,o,n,r,a,l){try{await e.get(Ee.DesktopManagerImpl).initialize();const c=e.get(fe.ViewModel);await c.onWidgetCreate(),Gt.markFromNavigation("desktopMgrInitialized");const d=e.get(re.PortalStartupMarkers);d.desktopMgrInitialized=dt();const p=e.get(re.SettingsManager);let u=await p.querySetting(12,Tt);u||(u=Date.now(),p.setSetting(12,Tt,u)),zt(gt,"FirstVisited",{[Tt]:u});const m=await p.querySetting(6,kt);zt(gt,"LastUsedSubscriptions",m);const g=await t;d.defaultLandingView=g?"Dashboard":"Home",d.defaultSideBarLayout=(0,te.isSideBarDocked)(e)?"Docked":"Flyout",d.desktopAndExtensionManagerInitialize=dt(),Gt.markFromNavigation("desktopAndExtensionManagerInitialize");const h=s.isEnabled("nodirectory"),f=e.get(R.Router);await f.initialRoute((()=>(d.defaultRoute=!0,f.goToLandingPage({interactionSource:"UIInitialize",replaceHistory:!0,skipFocus:h,invokedByInitRoute:!0}))),{skipFocus:h}),Gt.markFromNavigation("setupInitialRoute"),d.setupInitialRoute=dt();c.topBar.getWidget().initReactiveLayout(i),o.showSplash(!1),d.locationHash=n.fragment.split("?")[0].substring(0,2e3),d.hiddenTime=MsPortalEarly.stopPageLoadTimeout(),d.earlyLoad=MsPortalEarly.earlyLoadPerfData,d.windowSize=window.innerWidth;const x=lt.getEntriesByType("navigation")[0];x&&(d.fetchStart=x.fetchStart,d.requestStart=x.requestStart,d.responseStart=x.responseStart,d.responseEnd=x.responseEnd,d.domComplete=x.domComplete);const b={data:$.extend(d,Yt())};MsPortalEarly.blockedHosts.length>0&&St.warning(`Fallbacks are being used for extension hosting service. The current blocked hosts are ${JSON.stringify(MsPortalEarly.blockedHosts)}`),clearInterval(r),Bt=es("TotalTimeToPortalReady",b),pt(),ut();const y=e.get(se.PortalIdleStateService),v=y.addCallbacks({onIdle:e=>{const t=at.navigator;t&&!1!==t.onLine&&e%15==0&&a(!0),y.removeCallbacks(v)}});!function(e){const t=Number((0,w.getFeatureValue)("reloadafterdays"));if(MsPortalImpl.sessionStorage.getItem("wasForceReloaded")&&(MsPortalImpl.sessionStorage.removeItem("wasForceReloaded"),(0,qe.publishNotification)({title:k.Shell.Dialogs.reloadPortalMessageTitle,description:k.Shell.Dialogs.reloadPortalMessageDescription.format(t),status:0,toastDuration:1})),t>0){const s=864e5*t,i=Date.now()+s,o=setInterval((()=>{Wt(e,i,s,(()=>o))}),36e5)}}(y);e.get(Q.UserDirectorySettings).addRecentDirectory(l.tenantId)}catch(t){Nt=Nt||"/LoadFailed?stack="+encodeURIComponent(t&&t.stack).slice(0,1e3)+"&message="+encodeURIComponent(t&&t.message).slice(0,1e3),e.get(De.WindowManager).redirect({uri:Ne.errorUri+Nt})}}(i,u,n,p,o,a,c,q,v);i.get(ve.SaveDirectorySettingsHandler).saveDirectorySettings(),this._displayOptionalPopups(J,b,v,p,l,n),G.setupAssetTypeServiceRpc(i),ce.create(i),n.isEnabled("portalpolling")&&i.get(ie.PollingManager).startPolling(),i.get($e.Experimentation).shellAssignments.whenAvailable().then((e=>{e.getBooleanValue("sessionmanager")&&t.getUserInfo().then((e=>{i.get(ne.SessionManager).initialize(e.directoryName)}))}));let Z=null;et.ErrorReporter.initialize((()=>{Z=Z||i.get(Ee.DesktopManagerImpl),St.debug(Z.getDiagnosticsData())}),!1,(()=>(Z=Z||i.get(Ee.DesktopManagerImpl),Z.getCurrentBladeInfo())));const Y=i.get(xe.ViewModel);Gt.initializeTopBar(f,i,s,F,n);const ee=i.get(FxImpl.Rpc.Client);S.Internal.showNpsEndpoint.register(ee,null,((e,t)=>{Ae.showNps(l,g,Y,e.productDisplayName,`${t.srcWindowId||""}_${e.productId}`,null,(()=>{}),i)})),S.Internal.canShowNpsEndpoint.register(ee,null,(()=>!Ae.npsShownInSession));const oe=T.avatarMenuVM;v.gitHubUserId&&(0,Ve.fetchGitHubAccountInfo)(v.gitHubUserId).then((e=>oe.gitHubUserInfo(e))),oe.userIdentity(v),oe.hideTenant(n.isEnabled("hideavatartenant"));const ue=n.isEnabled("tenants2020");t.getUserInfo().then((e=>{let t;if(oe.userInfo(e),ue&&(oe.tenantDisplayName(e.uniqueDirectoryName),oe.listOfTenants.setAll([{id:e.directoryId,domainName:e.domainName,displayName:e.directoryName,tenantCategory:""}])),n.isEnabled("saveDeploymentNotification")){try{t=JSON.parse(MsPortalImpl.sessionStorage.getItem("_msPortalFx-Session-Deployments-{0}".format((e.objectId||e.email)+e.directoryId)))||{}}catch{return}Object.keys(t).length&&(0,w.require)("MsPortalImpl/Services/Services.DeploymentSession").then((e=>{i.get(e.DeploymentSession).restoreDeployments(i)}))}})),ue||D().then((e=>{const t=e.tenants;Te(t),oe.listOfTenants.setAll(t)})),oe.showDiagnostics=()=>i.get(Le.DownloadDiagnosticsJson).invoke(),oe.showDebugTools=()=>i.get(Le.ShowDebugTools).invoke(),oe.signedOut=()=>{this._logoutHandler({securityTokensManager:m,telemetryEvent:{source:bt,action:"AvatarMenuSignOut"},redirectAction:15})},oe.openAccountPortal=()=>{const e=ft.accountPortal;zt(bt,"AvatarMenuOpenBilling"),Lt(O,e.startsWith("#")?e:e+"subscriptions",{openedBy:7})},oe.switchDirectory=()=>{const e=i.get(R.Router);zt(bt,"SettingsFlyoutOpen",{launchedBy:"AvatarMenu"}),e.route("#settings/directory",{openedBy:7})},oe.openGitHubProfile=v.gitHubUserId?()=>{zt(bt,"AvatarMenuOpenGitHubProfile",{launchedBy:"AvatarMenu"}),(0,Ve.fetchGitHubAccountInfo)(v.gitHubUserId).then((e=>window.open(e.html_url,"_blank")))}:wt,q(),oe.submitAnIdea=()=>{zt(bt,"AvatarMenuOpenFeedback"),at.open(ft.submitAnIdea,"_blank")},oe.showSessionManager=()=>{zt(bt,"AvatarMenuOpenSessionManager"),i.get(Le.CreateJourneyForBladeFunc).invoke({extension:"HubsExtension",detailBlade:"SessionManager.ReactView",detailBladeInputs:{resourceId:""},defaultMenuItemId:void 0})};const be=()=>{const e=ft.accessDetails;return!(!e||!e.startsWith("#"))&&(zt(bt,"AvatarMenuOpenAccessDetails"),Lt(O,e,{openedBy:7}),!0)};oe.showMyAccessBlade=()=>{(0,w.isFeatureEnabled)("vlcentralcustommecontrollinks")?be():be()||(zt(bt,"AvatarMenuOpenAccessDetailsDefault"),i.get(Le.CreateJourneyForBladeFunc).invoke({extension:"HubsExtension",detailBlade:"MyAccess.ReactView",detailBladeInputs:{resourceId:""},defaultMenuItemId:void 0}))},I.then((e=>{const t=(We.selectedFormatCulture||"").toLowerCase().split("-").slice(-1)[0];oe.contactInfoEnabled(e.length&&n.isEnabled("contactinfo")&&!["at","ru","de","gr"].includes(t))})),oe.showContactInfoBlade=()=>{zt(bt,"AvatarMenuOpenContactInfo"),f.settingsFlyoutState(6)},oe.switchAccount=e=>{let t=e?{loginHint:e}:{selectAccount:"true"};C&&(t={...t,"exp.msaljsloginexp":"true",msaljsscript:"true"}),N.redirectWithCdn(i,{uri:Pt(y),parameters:t,hash:N.getHashQueryStringSegment(Ct.href),redirectAction:2})},!n.isEnabled("ci")&&(w.isDevelopmentMode||MsPortalEarly.query.clientoptimizations&&"true"!==MsPortalEarly.query.clientoptimizations||n.isEnabled("canmodifyextensions"))&&E().then((e=>e.startErrorDetection(s)));const we="data-click-telemetry";let ke;f.customEvents.addHandler(s,"mousedown",(e=>{ke=e.target})),f.customEvents.addHandler(s,"mouseup",(e=>{const t=ke;if(ke=null,e.target===t){const e=f.getRootElement()[0],s=$(t).closest(`[${we}]`,e);if(s.length){const t=s.attr(we)+"",i=s.closest(".fxs-tile",e).data(he.CompositionInstanceDataName),o=i?.locator,n=o?.toFriendlyString()||gt;tt.trace({source:n,action:"CustomClick",name:t})}}})),Pe.registerViewModels(i),_e.registerViewModels({diContainer:i,securityTokensManager:m,tenants:Te}),ae.isShellInitialized.resolve();i.get(j.PrintHandler).init(this._lifetime);const Be=i.get(H.ThemeManager),Re=Be.currentTheme(),He=Re.name,Ue=Be.highContrastMode(),We=z.getCurrentLocaleContext(),je=We.selectedDisplayLanguage,Ge=We.selectedFormatCulture||je,Ke=_.getBrowserInfo(),Je=f.sideBar.isCollapsed.value?"collapsed":"expanded",Xe=r.clearValue(de.ComponentName.Redirect,"Referrers",1),Ze="1"===M.get("pwa");return Promise.all([i.get(me.TenantsService).getHomeTenantsCount(),i.get(pe.SubscriptionsUserContext).getAllSubscriptionsCount(),i.get(pe.SubscriptionsUserContext).getGlobalDisplayedSubscriptions()]).then((([e,t])=>{const s=(0,ze.getCurrentUri)().getHashParts().category,i="dashboard"===s?`${s}/${(0,ze.getDashboardTypeFromUri)()}`:s;tt.trace({source:"UIInitialize",action:"PortalInitialized",data:{selectedDisplayLanguage:je,formatCulture:Ge,sidebarState:Je,defaultLandingView:x.defaultLandingView,defaultSideBarLayout:x.defaultSideBarLayout,currentThemeName:He,isAutoTheme:Re===Be.getThemes()[0],highContrastMode:Ue,tenantsCount:e,subscriptionsCount:t.value,freeTrial:T.canUpgradeSubscription.value,deepLinkType:i,referrers:Xe,browserInfo:Ke,userAgentData:at.navigator.userAgentData??{},isStandalonePwa:Ze,defaultMenuCollapseSetting:(0,te.stringifyDefaultMenuCollapseState)(l.defaultMenuCollapseState())}})})),J})),Ie=(e,t)=>{ae.onStatus(e,t)},Fe=ko.observable(),Te=ko.observableArray();return st.registerTelemetrySubmissionHandler(),FxImpl.ProvisioningTelemetry.registerTelemetrySubmissionHandler(),nt.status.subscribe(s,(e=>{Ie(e,Ye)})),i.getAsync(ue.SharingTelemetryProcessor).then(tt.addProcessor),function(e){if(!e||!lt?.getEntriesByType||!lt.timing)return;const t=dt(),s=function(e,t,s){es(e,{duration:t,endTime:Math.round(s+lt.timing.navigationStart)})},i=lt.getEntriesByType("resource").filter((e=>{const t=e.initiatorType;return"link"===t||"script"===t}));let o=i.reduce(((e,t)=>Math.min(t.startTime,e)),1/0),n=i.reduce(((e,t)=>Math.max(t.responseEnd,e)),0);const r=n-o,a=n;o=Math.max(o,e),n=Math.min(n,t);const l=n-o,c=t-l-e;s("TotalTimeToSplashScreen",e,e),s("TotalStartupResourceDownload",r,a),s("StartupResourceDownload",l,n),s("StartupScriptExecution",c,t)}(MsPortalEarly.splashScreenLoadTime),be.then((()=>{O.read(D?k.Shell.Reader.entraReady:k.Shell.Reader.portalReady),Be.initialize(i,this._lifetime,t,i.get(te.GeneralSettings).idleTimeoutMins,T,(()=>this._logoutHandler({securityTokensManager:m,telemetryEvent:{source:"UIInitialize",action:"IdleTimeoutSignOut"},buildSignOutUriParams:{sid:b.aadSessionId,tid:v.tenantId}})),v.tenantDomain,ae);const e=setTimeout((()=>{(0,je.migrateUserIntentData)(this._diContainer)}),6e4),s=setTimeout((()=>{(0,je.loadSubscriptionTypes)(this._diContainer)}),15e4);this._lifetime.registerForDispose((()=>{clearTimeout(e),clearTimeout(s)}))})),Y.registerFileUploadEndpoints(),ee.setSettingsManager(g),ht.oneDsInstrumentationKey&&n.getValue("enable1ds")&&setTimeout((async()=>{(await(0,w.require)("MsPortalImpl/Services/Services.1ds")).initialize()}),5e3),be}))}dispose(){Ue.temporaryExtensionCount.flushIntervalIds(),this._diContainer.isDisposed||Ut(this._diContainer.get(J.HatsSettings)),pt(),this._lifetime.dispose(),FxImpl.resetGlobalState()}async _displayOptionalPopups(e,t,s,i,o,n){await e;if(await(0,We.checkPassthroughUserWithNoSubs)(this._diContainer)){const e=this._diContainer.get(oe.SecurityTokensManager);await(0,We.launchPassthroughModalDialog)(this._diContainer,(()=>this._logoutHandler({securityTokensManager:e,telemetryEvent:{source:"UIInitialize",action:"PassthroughUserSignOut"},buildSignOutUriParams:{sid:t.aadSessionId,tid:s.tenantId}})))}const r=this._diContainer.get(re.SettingsManager);qt(this._diContainer,r,o,n,s),ee.init(r);const a=k.Portal,l=this._diContainer.get(E.AuthStateManager);if(n.isEnabled("internalonly")&&!n.isEnabled("canmodifyextensions")&&!l.isInternal){const e=FxImpl.trustedParentOrigin,t=e.replace(/^([^/]+\/\/).+\.([^.]+\.[^.]+\.[^.]+)$/,"$1$2");if(e!==t){this._diContainer.get(Ce.NotificationManager).addSingleNotification({status:0,title:a.preview,description:a.unsupportedEnvironment.format(e),linkTo:t})}}Promise&&String.prototype.startsWith&&Array.prototype.includes&&Number.isInteger&&Object.getOwnPropertyDescriptors&&String.prototype.padStart&&Promise.prototype.finally&&Array.prototype.flat&&String.prototype.trimStart&&Object.fromEntries&&globalThis&&Promise.allSettled&&String.prototype.matchAll&&Promise.any&&String.prototype.replaceAll&&Array.prototype.at&&Object.hasOwn||this._diContainer.getAsync(D.DialogManager).then((e=>e.showModalDialog({title:a.unsupportedBrowser,description:a.unsupportedBrowserDesc.format(ft.unsupportedBrowser),buttons:1,showErrorIcon:!0})))}_redirect(e){this._diContainer.get(De.WindowManager).redirect(e)}async _logoutHandler(e){const{securityTokensManager:t,telemetryEvent:s,redirectAction:i,buildSignOutUriParams:o}=e,n=await t.portalAuthHandlerPromise,r=!!n,a={...s.data};s.data={telemetryEventData:a,isPortalAuthHandlerInitialized:r},tt.trace(s),r&&await n.localLogout(),this._redirect({uri:Ot(o),redirectAction:i})}};async function is(e){const t=e.get(FxImpl.Features);if(t.isEnabled("forcewelcomesequence"))return!0;const s=e.get($e.Experimentation).shellAssignments.getBooleanValue("disableoobe"),i=e.get(re.SettingsManager),o=await i.querySettings({store:7,keys:["WelcomeSequence"]});return!s&&t.isEnabled("guidedtour")&&(!o||!o.WelcomeSequence)&&!t.isEnabled("ci")}t.Portal=ss=__decorate([__metadata("fx:diagnostics",[e,"Portal"]),C.Class(),__metadata("design:paramtypes",[C.Container])],ss)})),
define("_generated/Less/MsPortalImpl/Base/Base.Images.css",["module"],(function(e){"use strict";return{css:".msportalfx-svg-c01{fill:#fff}.msportalfx-svg-c02{fill:#e5e5e5}.msportalfx-svg-c03{fill:#a0a1a2}.msportalfx-svg-c04{fill:#7a7a7a}.msportalfx-svg-c05{fill:#3e3e3e}.msportalfx-svg-c06{fill:#1e1e1e}.msportalfx-svg-c07{fill:#0f0f0f}.msportalfx-svg-c08{fill:#ba141a}.msportalfx-svg-c09{fill:#dd5900}.msportalfx-svg-c10{fill:#ff8c00}.msportalfx-svg-c11{fill:#fcd116}.msportalfx-svg-c12{fill:#fee087}.msportalfx-svg-c13{fill:#b8d432}.msportalfx-svg-c14,.msportalfx-svg-c32{fill:#57a300}.msportalfx-svg-c15{fill:#59b4d9}.msportalfx-svg-c16{fill:#3999c6}.msportalfx-svg-c17{fill:#804998}.msportalfx-svg-c18{fill:#ec008c}.msportalfx-svg-c19{fill:#0072c6}.msportalfx-svg-c20{fill:#68217a}.msportalfx-svg-c21{fill:#00188f}.msportalfx-svg-c22{fill:#e81123}.fxs-mode-light .msportalfx-svg-c22{fill:#a4262c}.msportalfx-svg-c23{fill:#cae3f3}.msportalfx-svg-c24{fill:#59aed3}.msportalfx-svg-c25{fill:#4c3b12}.msportalfx-svg-c26{fill:#be9555}.msportalfx-svg-c27{fill:#4f4d52}.msportalfx-svg-c28{fill:#ef6f59}.msportalfx-svg-c29{fill:#f7cb64}.msportalfx-svg-c30{fill:#fdd8db}.msportalfx-svg-c31{fill:#f6ffec}.msportalfx-svg-c33{fill:#8a2da5}.msportalfx-svg-c34{fill:#e00b1c}.msportalfx-svg-c35{fill:#015cda}.msportalfx-svg-c36{fill:#5db300}.msportalfx-svg-c97{fill:#ffb900}.msportalfx-svg-c98{fill:#00a4ef}.msportalfx-svg-c99{fill:#f25022}.msportalfx-inverted-theme .msportalfx-svg-c05,.fxs-theme-dark .msportalfx-svg-c05{fill:#777}.msportalfx-inverted-theme .msportalfx-svg-c07,.fxs-theme-dark .msportalfx-svg-c07{fill:#f2f2f2}.msportalfx-svg-palette-white{fill:#fff}.msportalfx-svg-palette-blue{fill:#015cda}.msportalfx-svg-palette-black{fill:#1e1e1e}.msportalfx-svg-palette-green{fill:#57a300}.msportalfx-svg-palette-gray{fill:#a0a1a2}.msportalfx-svg-palette-inherit{fill:inherit}.msportalfx-svg-badge{position:absolute;left:0;bottom:0;min-height:10px;min-width:10px}.fxc-menu-icon>.msportalfx-svg-badge{left:-2px;bottom:-2px;min-height:8px;min-width:8px}.msportalfx-svg-disabled{filter:grayscale(100%)}.msportalfx-svg-loading-square{animation:ProgressFlagAnimation 1.45s infinite ease-in-out;transform-origin:50%}.msportalfx-svg-loading-square:nth-child(1){animation-delay:0s}.msportalfx-svg-loading-square:nth-child(2){animation-delay:.2s}.msportalfx-svg-loading-square:nth-child(3){animation-delay:.4s}@keyframes ProgressFlagAnimation{0%{transform:scale(1);opacity:.3}36.1%{transform:scale(1.06);opacity:1}50%{transform:scale(1.06);opacity:1}86.1%{transform:scale(1);opacity:.3}}.msportalfx-svg-flip-horizontal>svg,svg.msportalfx-svg-flip-horizontal{transform:scaleX(-1)}.msportalfx-svg-fabric-rotate360{animation:ImageRotation 1.3s cubic-bezier(.53,.21,.29,.67) infinite}@keyframes ImageRotation{0%{transform:rotate(-45deg)}100%{transform:rotate(315deg)}}.fxs-svg-number .msportalfx-font-bold{font-size:10px;fill:#0065ad}.fxs-svg-number .fxs-svg-circle{stroke-width:0%;fill:#0078d4}.fxs-svg-number .fxs-svg-text{fill:#fff;font-size:10px}.fxs-svg-number.msportalfx-svg-disabled{filter:grayscale(0%)}.fxs-svg-number.msportalfx-svg-disabled .fxs-svg-circle{fill:#fff;stroke-width:1px;stroke:#949494}.fxs-svg-number.msportalfx-svg-disabled .fxs-svg-text{fill:#949494}.fxs-theme-dark .fxs-svg-number .fxs-svg-text{fill:#0f0f0f}.fxs-theme-dark .fxs-svg-number .fxs-svg-circle{stroke-width:0%;fill:#0078d4}.fxs-theme-dark .fxs-svg-number.msportalfx-svg-disabled .fxs-svg-circle{fill:#0f0f0f;stroke-width:1px;stroke:#949494}.fxs-theme-dark .fxs-svg-number.msportalfx-svg-disabled .fxs-svg-text{fill:#949494}",moduleId:e.id}})),
define("MsPortalImpl/Init",["require","Fx/DependencyInjection","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/UI/UI.Initialize","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Base/Base.DeepLink","MsPortalImpl/Base/Base.HistoryManager","FxInternal/Environment","FxInternal/Css","_generated/Less/MsPortalImpl/Base/Base.Images.css","MsPortalImpl/InitShellWorker","FxInternal/Experimentation","Fx/Telemetry"],(function(e,t,s,i,o,n,r,a,l,c,d,p,u,m){"use strict";(0,c.injectCss)(d);var g=MsPortalFx.Base,h=g.Diagnostics,f=g.UriBuilder,x=n.ComponentName;const b=fx.environment,y=h.createLog(e),v=t.container.get(n.StorageService),w=new f(r.originalHref);w.query=new g.QueryStringBuilder(MsPortalEarly.userQuery),w.query.removeParameter("homeview"),(0,a.replaceState)({data:{},url:w.toString()}),v.clearValue(x.Redirect,"IdpRedirectCount",1);let M=0;const C=v.getValue(x.Redirect,"Referrers",1)||"";setInterval((function(e){const o={fx:b.version};(e?Promise.resolve():Promise.all([t.container.getAsync(s.ExtensionManager),t.container.getAsync(i.ManifestCache)]).then((([e,t])=>{e.initializedExtensions.forEach((e=>{o[e.name]=t.getVersion(e.name)}))}))).then((()=>{y.custom("Session",1,++M,C,o)}))}),36e5);const S=Promise.withResolvers();t.container.set(l.Environment,{extensionName:b.extensionName,sdkEnv:{},shellTrustedLinkedDomains:FxImpl.internalEnv.shellTrustedLinkedDomains,trustedLinkedDomains:void 0,linkedDomainMap:FxImpl.internalEnv.linkedDomainMap}).set(u.ExperimentationManager,new u.ExperimentationManager({frameContext:1,shellVariants:MsPortalEarly.preload.then((e=>e?.variants?.hubsextension)),features:FxImpl.features,trace:m.trace})).get(o.Portal).initialize(S),S.promise.then((()=>{(0,p.init)(t.container)})),FxImpl.features.getValue("extensionsidebar")&&MsPortalFx.require("MsPortalImpl/UI/UI.BladeOpenerImpl")}));