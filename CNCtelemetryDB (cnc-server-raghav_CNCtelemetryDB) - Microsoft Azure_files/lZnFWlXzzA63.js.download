define("FxHubs/ArtHelpers/ResourceHoverCardHelpers",["require","exports","FxHubs/ArtHelpers/ArtRequestGenerator","FxHubs/ArtHelpers/ArtApis","FxHubs/ArtHelpers/ArgBrowseHelpers","FxHubs/Resources/FxHubsClientStrings","FxInternal/Resources/ReactComponents","FxHubs/ArtHelpers/ArgBrowseHelpers","FxHubs/ArtHelpers/KustoQueryGenerator","Fx/ResourceManagement","FxHubs/ArtHelpers/KustoQueryHelpers"],(function(e,a,r,n,t,s,i,l,u,o,d){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.defaultProperties=void 0,a.getValueFromArgResponse=function(e,a){var r,n;if(!(null===(n=null===(r=e.data)||void 0===r?void 0:r.rows)||void 0===n?void 0:n.length))return null;var t=MsPortalFx.findIndex(e.data.columns,(function(e){return e.name===a}));if(t<0)return null;return e.data.rows[0][t]},a.getResourceFromArg=function(e,a,s,i,o,c,v,y,b,N){return __awaiter(this,void 0,void 0,(function(){var f,g,M,F,x,H,P,h;return __generator(this,(function(A){switch(A.label){case 0:return m[o]?[4,m[o]]:[3,2];case 1:case 3:return[2,A.sent()];case 2:for(f=0,g=e;f<g.length;f++)M=g[f],a.push(M.name),5!==M.format&&7!==M.format||a.push("".concat(M.name,"DisplayName")),M.bladeParameterColumn&&a.push((0,l.getColumnName)(M.bladeParameterColumn));return F=new u.KustoQueryGenerator(null,MsPortalFx.unique(a),null,s),x=s?(0,d.smartQuerySplit)(s):[],H=!1,x.length&&x[0]&&(P=x[0].trim().split(" "),H=!t.knownArgTopLevelOperatorsLowerCased.includes(P[0].toLowerCase())),H?F.setSuffixPredicates(["where id =~ '".concat(o,"'"),"limit 1"]):(1===i.kind?F.setSources(4):4===i.kind?F.setSources(2):F.setSources(1),F.setPrefixPredicates(["where id =~ '".concat(o,"'")]),F.setSuffixPredicates(["limit 1"])),h=i.subscription?p.getSubscriptionInfo(i.subscription):Promise.resolve(null),m[o]=h.then((function(a){for(var t=MsPortalFx.forEachKey(c,(function(e,a,r){var n,t,s;if(a){var i=void 0,l=void 0;a.defaultKind&&(null===(n=a.defaultKind.displayName)||void 0===n?void 0:n.singular)&&(i=null===(t=a.defaultKind.displayName)||void 0===t?void 0:t.singular),a.kindMap&&(l=MsPortalFx.forEachKey(a.kindMap,(function(e,a,r){var n;(null===(n=a.displayName)||void 0===n?void 0:n.singular)&&(r[e]=a.displayName.singular)}),{})),r[e]={displayName:i||(null===(s=a.displayName)||void 0===s?void 0:s.singular)||e,subValueDisplayNames:l}}}),{}),s=(0,u.buildDisplayNameMapProvider)({columnName:"type",subValueColumnName:"kind",mappedColumnName:"typeDisplayName",displayNameMapFunc:function(){return t}}),i=MsPortalFx.extendStringMapIntoMap(Object.create(null),v,(function(e){return{displayName:e.displayName}})),l=(0,u.buildDisplayNameMapProvider)({columnName:"location",mappedColumnName:"locationDisplayName",displayNameMapFunc:function(){return i}}),o=(0,u.buildDisplayNameMapProvider)({columnName:"subscriptionId",mappedColumnName:"subscriptionDisplayName",displayNameMapFunc:function(){var e;return a?((e={})[null==a?void 0:a.subscriptionId]={displayName:null==a?void 0:a.displayName},e):{}}}),d=[],p=0,m=e;p<m.length;p++){var f=m[p];switch(f.format){case 5:d.push((0,u.buildDisplayNameMapProvider)({columnName:f.name,mappedColumnName:"".concat(f.name,"DisplayName"),displayNameMapFunc:function(){return i}}));break;case 7:d.push((0,u.buildDisplayNameMapProvider)({columnName:f.name,mappedColumnName:"".concat(f.name,"DisplayName"),displayNameMapFunc:function(){return MsPortalFx.extendStringMapIntoMap(Object.create(null),y,(function(e){return{displayName:e.displayName}}))}}))}}F.setMappingProviders(__spreadArray([s,l,o],d,!0)),F.updateQuery();var g=r.getRequest(b.createChildLifetime(),{subscriptionsObservable:ko.observable(a?[null==a?void 0:a.subscriptionId]:[]),pageObservable:null,pageSizeObservable:ko.observable(1),queryObservable:F.query,skipTokenObservable:null});return n.getDataFromArt(g.request(),N||"art-resource-hover-card",null,null,!1,{skipRetryHandling:!0})})).then((function(e){return delete m[o],e})),[4,m[o]]}}))}))};var p=MsPortalFx.Azure,m=Object.create(null);a.defaultProperties=[{columnId:"typeDisplayName",name:s.ResourceHoverCard.type},{columnId:"kind",name:i.ResourceHoverCard.kind},{columnId:"locationDisplayName",name:s.ResourceHoverCard.location},{columnId:"location",name:"locationId",isMetadata:!0}]}));