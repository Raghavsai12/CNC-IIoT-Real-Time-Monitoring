define("MsPortalImpl/Services/Services.ReactViewDataCache",["require","exports","FxInternal/AsyncLoaderCore","FxInternal/ReactView/DataCacheEndpoints","MsPortalImpl/ReactViews/ReactQueryStore"],(function(e,t,a,r,n){"use strict";t.dataCacheGetHandler=t.dataCacheClearHandler=t.dataCacheClearAllHandler=t.dataCacheAddHandler=void 0;t.dataCacheAddHandler=(0,a.defineHandler)(r.dataCacheAddEndPoint,(e=>{e.diContainer.getAsync(n.ReactQueryStoreManager).then((t=>t.getExtensionStore(e.messageContext.srcWindowId))).then((t=>{const a=JSON.parse(e.messageArg.stringifiedCacheEntry);"rejected"===a.kind&&a.serializableError?t.setValue(e.messageArg.cacheId,{state:"rejected",error:a.serializableError},"number"==typeof a.expires?{expires:()=>a.expires}:{},a.timestamp):"resolved"===a.kind&&t.setValue(e.messageArg.cacheId,{state:"resolved",data:a.data},"number"==typeof a.expires?{expires:()=>a.expires}:{},a.timestamp)}))})),t.dataCacheGetHandler=(0,a.defineHandler)(r.dataCacheGetEndPoint,(e=>e.diContainer.getAsync(n.ReactQueryStoreManager).then((t=>t.getExtensionStore(e.messageContext.srcWindowId))).then((t=>{const a=t.getEntry(e.messageArg.cacheId);if(!a||"unset"===a.state)return;const r={expires:a.expires,timestamp:a.started,kind:"resolved"===a.state?"resolved":"rejected",data:"resolved"===a.state?a.data:void 0,serializableError:"rejected"===a.state?a.error:void 0};return JSON.stringify(r)})))),t.dataCacheClearHandler=(0,a.defineHandler)(r.dataCacheClearEndPoint,(e=>e.diContainer.getAsync(n.ReactQueryStoreManager).then((t=>t.getExtensionStore(e.messageContext.srcWindowId))).then((t=>t.clearEntry(e.messageArg.cacheId))))),t.dataCacheClearAllHandler=(0,a.defineHandler)(r.dataCacheClearAllEndPoint,(e=>{e.diContainer.getAsync(n.ReactQueryStoreManager).then((t=>t.getExtensionStore(e.messageContext.srcWindowId))).then((e=>{for(const t of Object.keys(e.getEntries()))t.startsWith(":query:")||e.clearEntry(t)}))}))}));