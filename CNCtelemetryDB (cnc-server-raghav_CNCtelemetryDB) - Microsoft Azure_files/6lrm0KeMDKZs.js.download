define("_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.FocusableExtension.css",["module"],(function(e){"use strict";return{css:'.azc-treeView-focusable.azc-treeView-mousedown{outline:0}.azc-treeView-focusable ul li[aria-disabled="true"]>.azc-treeView-node{opacity:.5}',moduleId:e.id}})),
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.LoadByContinuationToken.css",["module"],(function(e){"use strict";return{css:".azc-treeView-loadByContinuationToken .azc-treeView-loadMore-icon svg{width:10px;height:10px;margin-right:10px}",moduleId:e.id}})),
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.OnDemandLoadableExtension.css",["module"],(function(e){"use strict";return{css:".azc-treeView-onDemandLoadable .azc-treeView-icon-loading{position:absolute;width:10px;height:10px;border:2px solid #758393;border-right-color:transparent;border-radius:50%;animation:azc-treeView-loading 1s linear infinite}.azc-treeView-onDemandLoadable .azc-treeView-icon-expanded{animation:none}@keyframes azc-treeView-loading{0%{transform:rotate(0deg)}50%{transform:rotate(180deg)}100%{transform:rotate(360deg)}}",moduleId:e.id}})),
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.RightClickable.css",["module"],(function(e){"use strict";return{css:".azc-treeView-rightClickable .azc-treeView-node-contextButton{flex:0 0 auto;width:16px;height:16px;padding-left:3px;padding-right:3px;cursor:pointer}",moduleId:e.id}})),
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.Selectable.css",["module"],(function(e){"use strict";return{css:".azc-treeView-multiselectBox{flex:0 0 auto;height:11px;width:11px;border-width:1px;border-style:solid}.ext-treeView-svg{display:block}",moduleId:e.id}})),
define("_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.css",["module"],(function(e){"use strict";return{css:".azc-treeView{overflow-x:auto}.azc-treeView .azc-treeView-node-content{min-width:140px;white-space:normal;overflow:hidden}.azc-treeView ul{margin:0;padding:0}.azc-treeView .azc-treeView-node-group{margin-left:0;list-style-type:none}.azc-treeView .azc-treeView-node-group li.azc-treeView-item:focus-visible{outline:0}.azc-treeView .azc-treeView-node-group li.azc-treeView-item:focus-visible .fxs-treeitem-focused{outline-offset:-1px;outline-width:1px;outline-style:solid}.azc-treeView .azc-treeView-node-group .fxs-treeitem-focused{background-clip:padding-box}.azc-treeView .azc-treeView-node-group div.azc-treeView-node{position:relative;cursor:default;border-width:1px;border-style:solid;border-color:transparent;display:flex;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;align-items:center}.azc-treeView .azc-treeView-node-group div.azc-treeView-node .azc-treeView-icon{flex:0 0 auto;width:16px;height:16px;display:inline-block;top:3px}.azc-treeView .azc-treeView-node-group div.azc-treeView-node .azc-treeView-icon .azc-treeView-icon-collapsed{margin-left:2px;width:12px;height:12px}.azc-treeView .azc-treeView-node-group div.azc-treeView-node .azc-treeView-icon .azc-treeView-icon-expanded{margin-left:4px;margin-top:2px;width:12px;height:12px;transform:rotate(90deg)}.azc-treeView .azc-treeView-node-group div.azc-treeView-node .azc-treeView-node-icon{flex:0 0 auto;width:16px;height:16px}.azc-treeView .azc-treeView-node-group div.azc-treeView-node .azc-treeView-node-content{flex:1 1 auto;position:relative;padding:3px}.azc-treeView .azc-treeView-node-group div.azc-treeView-node.azc-treeView-node-has-icon .azc-treeView-node-content{padding-left:3px}.azc-treeView.azc-treeView-always-expanded .azc-treeView-node-group .azc-treeView-node .azc-treeView-node-icon{margin-left:1px}.azc-treeView.azc-treeView-always-expanded .azc-treeView-node-group .azc-treeView-node .azc-treeView-node-content{margin:3px}.azc-treeView.azc-treeView-always-expanded .azc-treeView-node-group .azc-treeView-node.azc-treeView-node-has-icon .azc-treeView-node-content{margin-left:19px}.azc-treeView.azc-control-disabled{opacity:.5;cursor:default;pointer-events:none}.azc-treeView>.azc-treeView-node-group{padding:1px}.fxs-mode-light .azc-treeView .azc-treeView-node-group li.azc-treeView-item:focus-visible .fxs-treeitem-focused{outline-color:#000}.fxs-mode-dark .azc-treeView .azc-treeView-node-group li.azc-treeView-item:focus-visible .fxs-treeitem-focused{outline-color:#fff}",moduleId:e.id}})),
define("Viva.Controls/Controls/Lists/Tree1/Viva.Tree",["require","exports","MsPortalImpl/Base/Base.KnockoutExtensions.Image","Viva.Controls/Controls/Base/Viva.ExtensibleControl","MsPortalImpl/Resources/ImplScriptResources","Viva.Controls/Util/Viva.TemplateEngine","Viva.Controls/Util/Viva.Util","_generated/MsPortalImpl/Svg/Startup/Refresh.svg","MsPortalImpl/Base/Base.SvgHelper","FxInternal/Css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.FocusableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.LoadByContinuationToken.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.OnDemandLoadableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.RightClickable.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.Selectable.css"],(function(e,t,a,i,s,o,n,r,l,d,c,m,u,p,g,h){"use strict";t.Widget=t.ViewModel=t.Extension=void 0,(0,d.injectCss)(c,m,u,p,g,h);const x="azc-treeView",b=MsPortalFx.Base.Images.Chevron(),w=`\x3c!-- ko if: data.items().length > 0 && ($vm.alwaysExpanded() || !data.metadata || (data.metadata.expanded() !== undefined)) --\x3e<ul role='tree' class='azc-treeView-node-group' data-bind='visible: $vm.alwaysExpanded() || !data.metadata || data.metadata.expanded(), attr: { "tabindex": $ctl._treeTabindex($context), "aria-multiselectable": $vm.multiselectable(), "aria-label":$vm.ariaLabel() }'>\x3c!-- ko template: { name: 'nodes', foreach: data.items } --\x3e\x3c!-- /ko --\x3e<li role="treeitem" class="azc-treeView-loadMoreRoot-btn" data-bind='attr: {"aria-disabled": $disabled(), "tabindex": $tabIndex()}, visible: $vm.canLoadMoreRootItems'><a tabindex="-1" role="button" data-bind='style: { "paddingLeft": $ctl._paddingValue($context) }, attr: { "aria-disabled": $disabled() }' href='#'><span class='azc-treeView-loadMore-icon'>${l.getSvgReferenceOrFallBackToData(r).outerHTML}</span>${MsPortalFx.encodeHtml(s.Grid.loadMore)}</a> </li></ul>\x3c!-- /ko --\x3e`,V=`\x3c!-- ko if: data.items().length > 0 && ($vm.alwaysExpanded() || !data.metadata || (data.metadata.expanded() !== undefined)) --\x3e<ul role='group' class='azc-treeView-node-group' data-bind='visible: $vm.alwaysExpanded() || !data.metadata || data.metadata.expanded(), attr: { "tabindex": $ctl._treeTabindex($context) }'>\x3c!-- ko template: { name: 'nodes', foreach: data.items } --\x3e\x3c!-- /ko --\x3e\x3c!-- ko if: data.nextLink && data.nextLink() !== null && data.nextLink() !== undefined --\x3e<li role="treeitem" class="azc-treeView-loadMore-btn" data-bind='attr: {"aria-disabled": $disabled(), "tabindex": $tabIndex()}'><a tabindex="-1" role="button" data-bind='style: { "paddingLeft": $ctl._paddingValue($context) }, attr: { "aria-disabled": $disabled() }' href='#'><span class='azc-treeView-loadMore-icon'>${l.getSvgReferenceOrFallBackToData(r).outerHTML}</span>${MsPortalFx.encodeHtml(s.Grid.loadMore)}</a> </li>\x3c!-- /ko --\x3e</ul>\x3c!-- /ko --\x3e`;class f extends i.Extension{}t.Extension=f;class v extends i.ViewModel{constructor(){super(...arguments),this.items=ko.observableArray(),this.events=MsPortalFx.noop,this.padding=ko.observable(16),this.pathSeparator="/",this.alwaysExpanded=ko.observable(!1),this.htmlTemplates=[],this.multiselectable=ko.observable(!1),this.canLoadMoreRootItems=ko.observable(!1),this.ariaLabel=ko.observable("")}}t.ViewModel=v;class z extends i.Widget{constructor(e,t,a){(a=a||{}).viewModelType=a.viewModelType||v,super(e,t,a),this.templateEngine=new o.HtmlTemplateEngine,this.treeTabIdx=ko.observable(-1),this._collapsedImage=b,this.options.extensionTrigger("beforeCreate"),this._setTemplates(),this.element.addClass(x).addClass("azc-fabric").html("\x3c!-- ko template: 'treeRoot' --\x3e\x3c!-- /ko --\x3e"),this._initializeComputeds(),this._bindDescendants(),this._attachEvents(),this.options.extensionTrigger("afterCreate")}dispose(){this._checkExistsOrRegisterDestroyId(super.dispose)||(this.options.extensionTrigger("beforeDestroy"),this._detachEvents(),this._cleanElement(x,"azc-fabric","azc-treeView-always-expanded"),super.dispose(),this.options.extensionTrigger("afterDestroy"))}get options(){return this._options}getElementFromItem(e){return this.element.find(".azc-treeView-node").filter(((t,a)=>ko.dataFor(a)===e))}toggleNodeExpansion(e,t,a){if(!this.$disabled()&&e&&!e.metadata.disabled()&&!this.options.alwaysExpanded()){const i="itemExpand",s="boolean"==typeof a?a:!e.metadata.expanded(),o={expanding:s,item:e,cancel:!1};e.metadata.expanded()!==s&&(this.trigger(i,n.cloneEvent(t,i),o),this.options.events(i,o),t.isDefaultPrevented()||e.metadata.expanded(s))}}_expandNode(e,t,a){e.length&&this.toggleNodeExpansion(ko.dataFor(e[0]),t,a)}_buildPath(e){const t=this.element.find(".azc-treeView-node").filter((function(t,a){return e===ko.dataFor(a)}));return t?t.parentsUntil(".azc-treeView","li").map((function(e,t){return ko.dataFor(t).text()})).get().reverse().join(this.options.pathSeparator):""}_initializeComputeds(){ko.computed(this.ltm,(()=>{this.element.toggleClass("azc-treeView-always-expanded",this.options.alwaysExpanded())}))}_treeTabindex(e){return e.$data.level?void 0:this.treeTabIdx().toString()}_paddingValue(e){let t=0,a=e;for(;a&&a.$ctl===this;)a.$data.level&&t++,a=a.$parentContext;return t*this.options.padding()+"px"}_ensureItemInitialized(e){return e.items=e.items||ko.observableArray(),e.metadata=e.metadata||{},e.metadata.expanded=e.metadata.expanded||ko.observable(),e.metadata.disabled=e.metadata.disabled||ko.observable(!1),e.metadata.expandable=ko.computed(this.ltm,(()=>0!==e.items().length)),this.options.extensionTrigger("defaultItemMetadataProperties",e),e}_attachEvents(){this.options.extensionTrigger("beforeAttachEvents"),this.ltm.registerForDispose(this.element.setEvents(["click.azcTreeView",".azc-treeView-icon",e=>{this._expandNode($(e.target),e)}])),this.options.extensionTrigger("afterAttachEvents")}_detachEvents(){this.options.extensionTrigger("beforeDetachEvents"),this.options.extensionTrigger("afterDetachEvents")}_itemAriaLabel(e){const t=e.ariaLabel;return(ko.unwrap(t)||"").trim()||(e.text()||"").trim()||void 0}_itemFormat(e){const t=e.templateKey?e.templateKey():null;if(t){const e=MsPortalFx.find(this.options.htmlTemplates,(e=>0===MsPortalFx.localeCompareIgnoreCase(t,e.key)));if(e&&e.html)return e.html}return MsPortalFx.encodeHtml(e.text()||"")}_setTemplates(){const e=this.templateEngine;this.options.extensionTrigger("beforeSetTemplates",e),e.setTemplate({treeRoot:w,treeItem:V,nodes:"\x3c!-- ko template: { name: 'nodesCore', data: $ctl._ensureItemInitialized($data) } --\x3e\x3c!-- /ko --\x3e",nodesCore:"<li role='treeitem' class='azc-treeView-item' data-bind='keyedCss: { treeNodeCore: $data.cssClass}, attr: { \"aria-disabled\": metadata.disabled() || $disabled(), \"aria-label\": $ctl._itemAriaLabel($data), \"aria-expanded\": metadata.expandable() ? (metadata.expanded() ? \"true\" : \"false\") : undefined,  \"title\": $ctl._itemAriaLabel($data) }'><div class='azc-treeView-node azc-node' data-bind='css: { \"azc-treeView-node-has-icon\": $data.icon && icon(), \"azc-row-disabled\": metadata.disabled() || $disabled() }, style: { \"paddingLeft\": $ctl._paddingValue($parentContext) }'>\x3c!-- ko template: 'treeIcon' --\x3e\x3c!-- /ko --\x3e\x3c!-- ko template: 'nodeIcon' --\x3e\x3c!-- /ko --\x3e\x3c!-- ko template: 'nodeContent' --\x3e\x3c!-- /ko --\x3e</div>\x3c!-- ko template: { name: 'treeItem', data: { data: $data, level: true } } --\x3e\x3c!-- /ko --\x3e</li>",treeIcon:"<div class='azc-treeView-icon'><div data-bind='css: { \"azc-treeView-icon-expanded\": metadata.expanded(), \"azc-treeView-icon-collapsed\": !metadata.expanded() }, visible: items().length > 0 && !$vm.alwaysExpanded(), image: $ctl._collapsedImage '></div></div>",nodeIcon:"\x3c!-- ko if: $data.icon && icon() --\x3e\x3c!-- ko if: typeof(icon()) === \"string\" --\x3e<img class='azc-treeView-node-icon' data-bind='attr: { src: icon }' alt='' />\x3c!-- /ko --\x3e\x3c!-- ko if: typeof(icon()) !== \"string\" --\x3e<div class='azc-treeView-node-icon' data-bind='image: icon'></div>\x3c!-- /ko --\x3e\x3c!-- /ko --\x3e",nodeContent:"<div class='azc-treeView-node-content' data-bind='trustedHtml: $ctl._itemFormat($data)'></div>"}),this.options.extensionTrigger("afterSetTemplates",e)}}t.Widget=z})),
define("Viva.Controls/Controls/Lists/Tree1/Viva.Tree.Focusable",["require","exports","MsPortalImpl/Base/JQueryHelper","Viva.Controls/Util/Viva.Util","Viva.Controls/Controls/Lists/Tree1/Viva.Tree","MsPortalImpl/Base/Base.KeyboardHelper"],(function(e,t,a,i,s,o){"use strict";t.FocusableExtension=void 0;const n=window,r="[data-treeView-focusable=true]:not([aria-disabled=true])",l="li[role=treeitem]";function d(e){return a.filterVisible(e,l+r)}class c extends s.Extension{constructor(e){super(),this._options=e||{}}get options(){return this._options}afterCreate(){this._widget.$tabIndex.subscribeAndRun(this._widget.ltm,(e=>{this._widget.treeTabIdx(e)}))}afterSetTemplates(e){const t=e.getHtmlTemplate("nodesCore"),a=e.getHtmlTemplate("treeItem");e.getHtmlTemplate("treeRoot").addAttribute(".azc-treeView-loadMoreRoot-btn","data-treeView-focusable",["true"]),a.addAttribute(".azc-treeView-loadMore-btn","data-treeView-focusable",["true"]),t.addAttribute("li[role=treeitem]","data-treeView-focusable",["true"]),t.addAttribute(null,"data-bind",['attr: { "data-treeView-focusable": true, tabindex: !metadata.disabled() && metadata.focused() ? $tabIndex() : null }']),t.addAttribute(">div","data-bind",['css: {"fxs-treeitem-focused": metadata.focused() }'])}defaultItemMetadataProperties(e){e.metadata.focused=e.metadata.focused||ko.observable(!1)}getOrder(){return 10}afterAttachEvents(){const e=this,t=this._widget;this._widget.ltm.registerForDispose(this._widget.element.setEvents(["click.azcTreeView",function(t){const a=$(t.target).closest(l);a.is(r)&&a.length>0&&e._focusNode(a,ko.dataFor(a[0]),t)}],["keydown.azcTreeView",function(a){const i=$(a.target).closest(l);let s;const n=i.is(".azc-treeView-loadMore-btn")||i.is(".azc-treeView-loadMoreRoot-btn"),r=!n&&i.is("[data-treeView-focusable=true]"),d=r&&ko.dataFor(i[0]).metadata.expanded();if(0===o.getModifierKeys(a))switch(a.which){case 38:s=e._findPreviousFocusable(i),a.preventDefault();break;case 40:s=e._findNextFocusable(i),a.preventDefault();break;case 37:if(d)t._expandNode(i,a,!1);else{const e=i.parent().closest(l);e[0]&&(s=e)}a.preventDefault(),a.stopPropagation();break;case 39:if(d){const e=i.find(l).first();e[0]&&(s=e)}else r&&t._expandNode(i,a,!0);a.preventDefault(),a.stopPropagation();break;case 32:n&&(s=e._findPreviousFocusable(i),a.preventDefault());break;case 13:n?(s=e._findPreviousFocusable(i),a.preventDefault()):d?(t._expandNode(i,a,!1),a.preventDefault()):d||(t._expandNode(i,a,!0),a.preventDefault());break;case 36:s=e._findFirstFocusable();break;case 35:s=e._findLastFocusable()}s&&s.length>0&&e._focusNode(s,ko.dataFor(s.get(0)),a)}],["itemExpand.azcTreeView",function(a,i){const s=t.getElementFromItem(i.item).closest(l);s&&s.length>0&&e._focusNode(s,ko.dataFor(s[0]),a)}],["mousedown.azcTreeView",function(e){t.element.addClass("azc-treeView-mousedown"),$.querySelectorAll("body").one("mouseup",(function(){t&&t.element&&t.element.removeClass("azc-treeView-mousedown")}))}]))}beforeDestroy(){const e=this._widget.element;this._lastTabbableItemMetadata=null,e.removeAttr("tabindex").removeClass("azc-treeView-mousedown")}getName(){return c.Name}_findPreviousFocusable(e){const t=e[0],a=d(this._widget.element[0]);let i;if(t)for(i=a.length-1;i>=0;i--)if(t===a[i]&&i>0)return $(a[i-1]);return $(a[a.length-1])}_findNextFocusable(e){const t=e[0],a=d(this._widget.element[0]);let i;if(t)for(i=0;i<a.length;i++)if(t===a[i]&&i<a.length-1)return $(a[i+1]);return $(a[0])}_findFirstFocusable(){const e=d(this._widget.element[0]);return $(e[0])}_findLastFocusable(){const e=d(this._widget.element[0]);return $(e[e.length-1])}_focusElement(e){const t=e.get(0);t.focus(),t.focus()}_focusNode(e,t,a){const s=$(e).closest(l);if(t&&s[0]!==n.document.activeElement)if(this._lastTabbableItemMetadata&&this._lastTabbableItemMetadata.focused(!1),s.is(".azc-treeView-loadMore-btn"))this._lastTabbableItemMetadata=null,this._focusElement(s);else if(s.is(".azc-treeView-loadMoreRoot-btn"))this._lastTabbableItemMetadata=null,this._focusElement(s);else{const e=t.metadata;this._lastTabbableItemMetadata=e,e.focused(!0),this._focusElement(s);const o={focused:t};this._widget.trigger("itemFocus",i.cloneEvent(a,"itemFocus"),o),this._widget.options.events("focus",o)}}}t.FocusableExtension=c,c.Name="azc-treeView-focusable"})),
define("Viva.Controls/Controls/Lists/Tree1/Viva.Tree.LoadByContinuationToken",["require","exports","Viva.Controls/Controls/Lists/Tree1/Viva.Tree","Viva.Controls/Util/Viva.Util"],(function(e,t,a,i){"use strict";t.LoadByContinuationTokenExtension=void 0;class s extends a.Extension{afterAttachEvents(){const e=this._widget,t=function(t){const a=ko.dataFor(t.target).data,s={item:a,path:e._buildPath(a)};e.trigger("loadMoreItems",i.cloneEvent(t,"loadMoreItems"),s),e.options.events("loadMoreItems",s),t.preventDefault()},a=function(t){e.trigger("loadMoreRootItems",i.cloneEvent(t)),e.options.events("loadMoreRootItems"),t.preventDefault()};this._widget.ltm.registerForDispose(this._widget.element.setEvents(["click.azcTreeView",".azc-treeView-loadMore-btn",t],["keydown.azcTreeView",".azc-treeView-loadMore-btn",function(e){switch(e.which){case 32:case 13:t(e)}}],["click.azcTreeView",".azc-treeView-loadMoreRoot-btn",a],["keydown.azcTreeView",".azc-treeView-loadMoreRoot-btn",function(e){switch(e.which){case 32:case 13:a(e)}}]))}getName(){return s.Name}}t.LoadByContinuationTokenExtension=s,s.Name="azc-treeView-loadByContinuationToken"})),
define("Viva.Controls/Controls/Lists/Tree1/Viva.Tree.OnDemandLoadable",["require","exports","Viva.Controls/Controls/Lists/Tree1/Viva.Tree","Viva.Controls/Util/Viva.Util"],(function(e,t,a,i){"use strict";t.OnDemandLoadableExtension=void 0;const s="azc-treeView-onDemandLoadable",o=`<div class='azc-treeView-icon'><div data-bind='css: { "azc-treeView-icon-expanded": $ctl.getPlugin("${s}")._isExpanded($data), "azc-treeView-icon-collapsed": $ctl.getPlugin("${s}")._isCollapsed($data), "azc-treeView-icon-loading": $ctl.getPlugin("${s}")._isLoading($data) }, visible: $data.metadata.expandable(), image: $ctl.getPlugin("${s}")._isLoading($data) ? null : $ctl._collapsedImage '></div></div>`;class n extends a.Extension{afterSetTemplates(e){e.setTemplate("treeIcon",o)}defaultItemMetadataProperties(e){const t=e.metadata.loadable||ko.observable();e.metadata.loadable=t,e.metadata.expandable=ko.computed(this.ltm,(()=>e.items().length>0||void 0!==t()))}afterAttachEvents(){const e=this;let t;const a=this._widget;this._widget.ltm.registerForDispose(this._widget.element.setEvents(["itemExpand.azcTreeView",function(s,o){const n=o.item.metadata;n.expanded()||(o.expanding?n.loadable()&&(n.loadable(!1),e._observeChildrenRemoval(o.item),t={item:o.item,path:a._buildPath(o.item)},a.trigger("itemLoading",i.cloneEvent(s,"itemLoading"),t),a.options.events("loading",t)):s.preventDefault())}]))}getOrder(){return 30}getName(){return n.Name}_observeChildrenRemoval(e){e.items.subscribeArrayDeletes(this._widget.ltm,(t=>{0===e.items().length&&(e.metadata.expanded(!1),e.metadata.loadable(void 0))}))}_isExpanded(e){return e.items().length>0&&e.metadata.expanded()&&!e.metadata.disabled()}_isCollapsed(e){return!e.metadata.expanded()||e.metadata.disabled()||e.metadata.loadable()}_isLoading(e){return 0===e.items().length&&!e.metadata.loadable()}}t.OnDemandLoadableExtension=n,n.Name=s})),
define("Viva.Controls/Controls/Lists/Tree1/Viva.Tree.RightClickable",["require","exports","Viva.Controls/Util/Viva.Util","Viva.Controls/Controls/Lists/Tree1/Viva.Tree","MsPortalImpl/Base/Base.KeyboardHelper"],(function(e,t,a,i,s){"use strict";t.RightClickableExtension=void 0;class o extends i.Extension{constructor(e){super(),this._hasDynamicCommands=e}afterSetTemplates(e){e.setTemplate("nodeContent",e.getTemplate("nodeContent")+"<div class='azc-treeView-node-contextButton' data-bind='image: MsPortalFx.Base.Images.Ellipsis(), visible: $ctl.getPlugin(\"azc-treeView-rightClickable\")._contextCommandsEnabled($data)'></div>")}afterAttachEvents(){const e=this._widget,t=function(t){const i=$(t.target).closest("li[role=treeitem]");if(s.isCtrlOrCommandOnly(t)||i.is(".azc-treeView-loadMore-btn")||i.is(".azc-treeView-loadMoreRoot-btn")||i.is("[aria-disabled=true]"))return;e.trigger("selectTreeItem",a.cloneEvent(t,"selectTreeItem"),i);const o=ko.dataFor(i[0]);if(o.noContextMenu&&o.noContextMenu())return;const n={item:o,path:e._buildPath(o),clientX:t.clientX||i.offset().left+i.width()/2,clientY:t.clientY||i.offset().top+i.height()/2};e.trigger("itemRightClick",a.cloneEvent(t,"itemRightClick"),n),e.options.events("itemRightClick",n)};e.ltm.registerForDispose(e.element.setEvents(["fxcontextmenurequest.azcTreeView",t],["keydown.azcTreeView",e=>{121===e.which&&4===s.getModifierKeys(e)&&t(e)}],["click.azcTreeView",".azc-treeView-node-contextButton",t]))}getName(){return o.Name}_contextCommandsEnabled(e){return(e.commandGroup||this._hasDynamicCommands)&&!(e.noContextMenu&&e.noContextMenu())}}t.RightClickableExtension=o,o.Name="azc-treeView-rightClickable"})),
define("Viva.Controls/Controls/Lists/Tree1/Viva.Tree.Selectable",["require","exports","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.Focusable","Viva.Controls/Util/Viva.Util","Viva.Controls/Controls/Lists/Tree1/Viva.Tree"],(function(e,t,a,i,s){"use strict";t.SelectableExtension=void 0;const o=window,n="[data-treeView-selectable=true]:not([aria-disabled=true])";class r extends s.Extension{constructor(e){super(),this._selectionMode=e||0,1===this._selectionMode&&(this._selectionCheckSvg=MsPortalFx.Base.Images.Check({palette:99,customClass:"ext-treeView-svg"}))}getSelected(){return this._findSelectedItem(this._widget.options.items())}select(e){1!==this._selectionMode&&this.unselect(),e.metadata.selected(!0)}unselect(e){const t=e||this.getSelected();t&&t.metadata.selected(!1)}afterSetTemplates(e){e.setTemplate("nodeIcon","\x3c!-- ko if: $ctl.getPlugin(\"azc-treeView-selectable\")._selectionMode === 1 --\x3e<div class='azc-treeView-multiselectBox fxs-portal-border'><div style='height: 11px; width: 11px;' data-bind='image: $ctl.getPlugin(\"azc-treeView-selectable\")._selectionCheckSvg, visible: metadata.selected()'></div></div>\x3c!-- /ko --\x3e"+e.getTemplate("nodeIcon"));const t=e.getHtmlTemplate("nodesCore");t.addAttribute(">div","data-bind",['keyedCss: { treeNodeSelected: { "fxs-portal-activated": metadata.selected() }}','keyedCss:{ treeNodeHover: {"fxs-portal-hover": metadata.selectable()}}','keyedCss: { treenodefocusedcolor: {"fxs-portal-selected":  metadata.selectable() && metadata.selected() }}']),t.addAttribute(null,"data-bind",['attr: { "data-treeView-selectable": metadata.selectable(), "aria-selected": !metadata.disabled() && metadata.selected() ? "true" : "false" }','keyedCss:{ treeNodeFocus: {"fxs-portal-focus": metadata.selectable()}}'])}defaultItemMetadataProperties(e){e.metadata.selected=e.metadata.selected||ko.observable(!1),e.metadata.selectable=e.metadata.selectable||ko.observable(!0)}afterAttachEvents(){const e=this,t=this._widget;this._widget.ltm.registerForDispose(this._widget.element.setEvents(["selectTreeItem.azcTreeView",function(t,a){e._changeSelection(a,t)}],["click.azcTreeView",function(e){const a=$(e.target).closest("li[role=treeitem]");if(a.is(n)){const s=a.find(".azc-treeView-icon");(0===s.length||s[0]!==e.target&&!$.contains(s[0],e.target))&&(t.trigger("selectTreeItem",i.cloneEvent(e,"selectTreeItem"),a),t.trigger("clickTreeItem",i.cloneEvent(e,"selectTreeItem"),ko.dataFor(a[0])))}}],["keydown.azcTreeView",function(e){const a=$(e.target),s=a.closest("li[role=treeitem]");switch(e.which){case 32:s.is(n)&&e.target===o.document.activeElement&&(t.trigger("selectTreeItem",i.cloneEvent(e,"selectTreeItem"),s),e.preventDefault());break;case 13:s.is(n)&&e.target===o.document.activeElement&&"LI"===a[0].tagName&&"treeitem"===a.attr("role")?(t.trigger("clickTreeItem",i.cloneEvent(e,"selectTreeItem"),ko.dataFor(s[0])),e.preventDefault()):(a.click(),e.stopPropagation())}}]))}getOrder(){return 20}getDependencies(){return[new a.FocusableExtension]}getName(){return r.Name}_findSelectedItem(e){let t,a,i,s;if(s=MsPortalFx.find(e,(function(e){return e.metadata&&e.metadata.selected&&e.metadata.selected()})),!s)for(t=0,a=e.length;t<a&&(i=e[t],i.items&&i.items().length>0&&(s=this._findSelectedItem(i.items())),!s);t++);return s}_changeSelection(e,t){const a=ko.dataFor(e);let s,o,n;if((!a.metadata.selectable||a.metadata.selectable())&&a){if(1!==this._selectionMode)o=this.getSelected(),a!==o&&this.select(a),s=a;else{a.metadata.selected()?(this.unselect(a),o=a):(this.select(a),s=a)}n={selected:s,unselected:o},this._widget.trigger("itemSelect",i.cloneEvent(t,"itemSelect"),n),this._widget.options.events("select",n)}}}t.SelectableExtension=r,r.Name="azc-treeView-selectable"})),
define("MsPortalImpl.Controls/Controls/Lists/Tree1/TreeView",["require","exports","MsPortalImpl.Controls/Controls/Base/Loadable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.Selectable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.OnDemandLoadable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.RightClickable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.Focusable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.LoadByContinuationToken","MsPortalImpl/Base/Base.Selectable2.ClickContext","FxInternal/Controls/TreeView"],(function(e,t,a,i,s,o,n,r,l,d,c){"use strict";t.Widget=void 0;var m=FxImpl.shellInterface;const u="fxc-treeView";class p extends a.Widget{constructor(e,t,a){super(e,t,$.extend({fillBehavior:3},a)),this.element.addClass(u),this._initializeWidgets()}get options(){return this._options}dispose(){this._checkExistsOrRegisterDestroyId(super.dispose)||(super.dispose(),this.element.removeClass(u))}_initializeWidgets(){let e=!1,t=!1,a=!1;const c=new i.ViewModel(this.vmBasicOption),u=this.options,p=u.htmlTemplates,g=u.onDemandLoadableData,h=u.selectableData;if(c.padding=u.padding,c.pathSeparator=u.pathSeparator,c.alwaysExpanded=u.alwaysExpanded,c.items=u.items,c.disabled=u.disabled,c.htmlTemplates=[],c.canLoadMoreRootItems=u.canLoadMoreRootItems,c.multiselectable(!(!u.extensionsOptions||!u.extensionsOptions.selectable)&&1===u.extensionsOptions.selectable.selectionMode),c.ariaLabel=MsPortalFx.initObservable(u.ariaLabel,""),p&&p.forEach((e=>{c.htmlTemplates.push({key:e.key,html:this.sanitizeTemplate(e.html)})})),g&&g.loadingPath&&g.loadingPath.extend({notify:"always"}),c.events=(e,t)=>{if("select"===e)if(1===u.extensionsOptions.selectable.selectionMode){const e=h.selectedPaths();t.unselected&&MsPortalFx.remove(e,this._getPathByItem(t.unselected)),t.selected&&e.push(this._getPathByItem(t.selected)),h.selectedPaths(e)}else h.selectedPath(this._getPathByItem(t.selected));else"loading"===e&&g.loadingPath(this._getPathByItem(t.item))},(1&u.extensions)>0&&u.extensionsOptions.selectable){const e=new s.SelectableExtension(u.extensionsOptions.selectable.selectionMode);c.extensions.push(e),h.selectedItem.subscribe(this.ltm,(t=>{t||(e.unselect(),h.selectedPath(""))})),u.extensionsOptions.selectable.initialPath&&this._ensureInitialPathSelected(u.items,u.extensionsOptions.selectable.initialPath),t=!0}if((2&u.extensions)>0&&c.extensions.push(new o.OnDemandLoadableExtension),(4&u.extensions)>0){const a=!!m(this.options).SupplyCommands;c.extensions.push(new n.RightClickableExtension(a)),t||c.extensions.push(new r.FocusableExtension),e=!0}(8&u.extensions)>0&&(c.extensions.push(new l.LoadByContinuationTokenExtension),a=!0,this._tokenStorage={});const x=new i.Widget(this.element,c);if(u.toggleNodeCallback(((e,t)=>{x.toggleNodeExpansion(e,$.Event("TreeViewModelExpandNode"),t)})),this._widgets.push(x),a&&this.ltm.registerForDispose(this.element.setEvents(["loadMoreItems",(e,t)=>{if(!t.item.metadata||t.item.metadata.disabled&&t.item.metadata.disabled())return!1;u.loadMoreNode(t.item,this._tokenStorage[t.path]).then((e=>{this._tokenStorage[t.path]=e.continuationToken,u.syncToken(t.path,e.continuationToken)}))}],["loadMoreRootItems",e=>{u.loadMoreRootItems()}])),e&&this.ltm.registerForDispose(this.element.setEvents(["itemRightClick",(e,t)=>{if(t.item.metadata.disabled())return!1;const a=this._widgets[0];a.getPlugin(r.FocusableExtension.Name)._focusNode(a.getElementFromItem(t.item),t.item,e);const i=$.Event("rightclick",{target:e.target,clientX:t.clientX,clientY:t.clientY}),s=m(this.options).SupplyCommands;return this.element.trigger(i,{entityType:0,commandGroup:ko.unwrap(t.item.commandGroup),commandGroupOwner:ko.unwrap(t.item.commandGroupOwner),supplyCommands:s,viewModel:s?t.item:{item:t.item,path:t.path}}),!1}])),m(this.options).OnItemClicked){const e=d.getListSelectableWithClickHandler(this._diContainer,this.options,this.element,m(this.options).OnItemClicked);ko.reactor(this.ltm,(()=>{const t=e.activationState().previous;t&&ko.ignoreDependencies((()=>{t.metadata.selected(!1)}))})),this.ltm.registerForDispose(this.element.setEvents(["clickTreeItem",(t,a)=>{e&&e.onClick({item:a,metadata:a.metadata})}]))}}_getPathByItem(e){return this._widgets[0]._buildPath(e)}getTokenByPath(e){return this._tokenStorage[e]}_ensureInitialPathSelected(e,t){let a,i,s,o,n=e;const r=[];let l=null;if(t)for(o=t.split(this.options.pathSeparator),a=0,i=o.length;a<i&&(s=o[a].toLowerCase(),l=n().filter(((e,t)=>s===e.text().toLowerCase()))[0],l);a++)n=l.items||ko.observableArray(),r.push(l);if(l){for(a=0;a<i-1;a++)r[a].metadata.expanded(!0);l.metadata.selected(!0)}}}t.Widget=p}));