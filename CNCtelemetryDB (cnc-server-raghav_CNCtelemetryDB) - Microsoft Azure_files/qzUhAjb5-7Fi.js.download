define("FxInternal/Controls/Grid2/Grid2.CoreGrid.Toolbar",["require","exports","FxInternal/Controls/Grid2/Grid2.CoreGrid.Base","FxInternal/Controls/Grid2/Grid2.CoreGrid.Util","Fx/Controls/Toolbar"],(function(e,r,t,o,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Plugin=void 0,r.createToolbarButton=function(e,r,t,i,a,s){var u=o.extend(a,s),l=MsPortalFx.initObservable(s&&s.disabled,!1),d=o.extend(u,{disabled:ko.pureComputed({read:function(){return l()||!t(r())},write:function(e){l(e)}}),onClick:function(){i(r())}});return n.ToolbarItems.createBasicButton(e,d)};var i=function(e){function r(r,t,o,n,i){var a=e.call(this,r,t,o,n)||this,s=n.toolbar;return s&&o.on({extendGrid:function(e,r,t,o){r.toolbar={visible:MsPortalFx.initObservable(s.visible,!0),viewModel:null}},initGrid:function(){var e=(s.createToolbar||i.createToolbar)(a._lifetime,t);t.toolbar.viewModel=e}}),a}return __extends(r,e),r}(t.Plugin);r.Plugin=i})),
define("FxInternal/Controls/Grid2/Grid2.EditableGrid.Addition",["require","exports","FxInternal/Controls/Grid2/Grid2.CoreGrid.Base","FxInternal/Controls/Grid2/Grid2.CoreGrid.Util","Fx"],(function(e,r,t,o,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Plugin=void 0;var i=function(e){function r(r,t,i,a){var s=e.call(this,r,t,i,a)||this,u=a.addition;if(u){var l=ko.observable(),d=u.canAddRow||MsPortalFx.wrap(!0),c=u.onAddRow,f=function(){var e,r=!!(e=l())&&e.dirty()&&d(t);if(r){var n=l();i.transferAdditionalRows();var a=o.internal(n);a._canStopEditing(!0),a.placeholder(!1),a.excluded(!1),a.tabbable(!1),l(null),t.dirty(!0),n.cells().forEach((function(e){return e.dirty(!0)})),c&&c(n,t)}return r},m=function(){return d(t)},p=function(){var e=m(),n=l();if(e&&!n){var a=r.createChildLifetime(),s=u.createItem(),d=i._createRow(a,i._createInternalNode({item:s,id:null})),c=o.internal(d);c.placeholder(!0),c.excluded(!0),c.tabbable(!0),l(d),i.additionalRows([d]),c._canStopEditing(!1),t.editing.editRow(d)}else if(!e&&n){l(null),i.additionalRows([]),(a=o.internal(n)._lifetime).dispose()}};i.on({extendGrid:function(e,r,t,o){r.addition={canAddRow:ko.pureComputed(m)}},initGrid:function(e,r,t,o){var i=e.createChildLifetime();ko.reactor(i,(function(){var e=l();e&&e.dirty()&&n.nextTick((function(){i.isDisposed()||(f(),p())}))})),ko.reactor(i,(function(){m(),n.nextTick((function(){i.isDisposed()||p()}))}))},extendRow:function(e,r,t,o){t.placeholder=ko.observable(!1)}})}return s}return __extends(r,e),r}(t.Plugin);r.Plugin=i})),
define("FxInternal/Controls/Grid2/Grid2.EditableGrid.Deletion",["require","exports","FxInternal/Controls/Grid2/Grid2.CoreGrid.Base","FxInternal/Controls/Grid2/Grid2.CoreGrid.Selection","FxInternal/Controls/Grid2/Grid2.CoreGrid.Toolbar","FxInternal/Controls/Grid2/Grid2.CoreGrid.Util"],(function(e,r,t,o,n,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Plugin=void 0;var a=MsPortalFx.Resources.Strings.EditableGrid,s=MsPortalFx.Base.Images.Delete(),u=function(e){function r(r,t,u,l){var d=e.call(this,r,t,u,l)||this,c=l.deletion;if(c){var f=c.canDeleteRows||MsPortalFx.wrap(!0),m=c.onDeleteRows,p=c.formatDeleteRowsMessage||function(e,r){return(e.length>1?a.deleteRowsMessagePlural:a.deleteRowsMessageSingular).format(r)},v=t.items,C=[],h=function(e,r){var o=!!(null==e?void 0:e.length);return o&&r&&(o=f(e,t)),o},g=function(e,r){var o,n=h(e,r);if(n&&((n=(e=e.slice()).every((function(e){e.focused()&&t.focus.moveDown();var r=v.indexOf(e.item);return v.splice(r,1),void 0===o&&(o=r+1),!0})))&&(C.splice.apply(C,__spreadArray([0,C.length],e,!1)),t.dirty(!0),m&&m(e,t),p))){var i=p(e,o,t);i&&u.announcement(i)}return n},y=function(e,r,t){var i=o.wrapContextRows(r);return n.createToolbarButton(e,i,(function(e){return h(e,!0)}),(function(e){return g(e,!0)}),{telemetryName:"DeleteRows",label:a.deleteCommandText,icon:s},t)};u.on({extendGrid:function(e,r,t,o){r.deletion={},i.defLocalProps(r.deletion,{canDeleteRows:function(e){return h(e,!0)},deleteRows:function(e){return g(e,!1)},createDeleteRowsCommand:y}),i.defProps(t,{deleteRows:function(e){return g(e,!0)}})}})}return d}return __extends(r,e),r}(t.Plugin);r.Plugin=u})),
define("FxInternal/Controls/Grid2/Grid2.EditableGrid.Editing",["require","exports","FxInternal/Controls/Grid2/Grid2.CoreGrid.Base","FxInternal/Controls/Grid2/Grid2.CoreGrid.Util"],(function(e,r,t,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Plugin=void 0;var n=MsPortalFx.wrap(!0),i=function(e){function r(r,i,a,s){var u=e.call(this,r,i,a,s)||this,l=s.editing||{},d=l.canEditRow||n,c=l.canStopEditingRow||MsPortalFx.wrap(Promise.resolve(!0)),f=function(e){return!!e&&!e.disabled()&&d(e,i)},m=function(e){var r=f(e);if(r&&!e.editing()){var t=o.internal(e),n=t._editingLifetime=t._lifetime.createChildLifetime();e.cells.mapInto(n,(function(r,t){var n=o.internal(t.column)._definition.createCellEditor,i=o.internal(t),a=i._editorLifetime;if(n&&!a){var s=n(a=i._editorLifetime=i._lifetime.createChildLifetime(),e.item,e);o.reactor(a,s,(function(e){t.editor(e())}))}})),e.editing(!0)}return r},p=function(e){var r=!!e;if(r&&(r=o.internal(e)._canStopEditing()&&!e.focused()&&!e.disabled()&&e.editing()&&0===e.validationErrors().length))return c(e,i).then((function(r){return r&&e.dirty()?e.triggerValidation().then((function(){return 0===e.validationErrors().length})):r}));return Promise.resolve(r)},v=function(e){return p(e).then((function(r){if(r){var t=o.internal(e);t._editingLifetime&&t._editingLifetime.dispose(),e.editing(!1)}return r}))},C=ko.observable().extend({rateLimit:{method:"notifyWhenChangesStop",timeout:200}});return o.subscribe(r,C,(function(e){m(e)})),a.on({extendGrid:function(e,r,t,o){r.editing={canEditRow:f,editRow:m,canStopEditingRow:p,stopEditingRow:v},t.ariaReadOnly=!1},extendRow:function(e,r,t,o){r.editing=ko.observable(!1);var n=ko.observable(!0);t._canStopEditing=ko.pureComputed({read:function(){return n()&&!r.validationErrors().length},write:function(e){n(e)}}),t._editingLifetime=null,r.dirty=ko.pureComputed((function(){return r.cells().some((function(e){return e.dirty()}))}))},extendColumn:function(e,r,t,o){t.ariaReadOnly=!o.createCellEditor},extendCell:function(e,r,t,o){Object.defineProperty(r,"editorLifetime",{enumerable:!1,writable:!0,configurable:!1,value:void 0}),r.editor=ko.observable(),r.dirty=ko.observable(!1),t._editorLifetime=null},initCell:function(e,r,t,o){ko.reactor(e,(function(){var e=r.editor(),t=e&&e.dirty;t&&ko.unwrap(t)&&(r.dirty(!0),i.dirty(!0))}))},rowOrRowGroupChanged:function(e,r){r&&t.isRow(r)&&r.editing()&&i.editing.stopEditingRow(r),e&&!t.isRow(e)||C(e)},clearDirty:function(){i.rows().forEach((function(e){e.dirty()&&e.cells().forEach((function(e){if(e.dirty()){var r=e.editor(),t=r&&r.dirty;ko.isObservable(t)&&t(!1),e.dirty(!1)}}))}))}}),u}return __extends(r,e),r}(t.Plugin);r.Plugin=i})),
define("FxInternal/Controls/Grid2/Grid2.EditableGrid.Insertion",["require","exports","FxInternal/Controls/Grid2/Grid2.CoreGrid.Base","FxInternal/Controls/Grid2/Grid2.CoreGrid.Selection","FxInternal/Controls/Grid2/Grid2.CoreGrid.Toolbar","FxInternal/Controls/Grid2/Grid2.CoreGrid.Util"],(function(e,r,t,o,n,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Plugin=void 0;var a=MsPortalFx.Resources.Strings.EditableGrid,s=MsPortalFx.Base.Images.Insert(),u=function(e){function r(r,t,u,l){var d=e.call(this,r,t,u,l)||this,c=l.insertion;if(c){var f=c.createItem,m=t.rows,p=t.items,v=MsPortalFx.wrap(!0),C=c.canInsertRow||v,h=c.onInsertRow,g=c.formatInsertRowMessage||function(e,r){return a.insertRowMessageSingular.format(r)},y=function(e,r){var o=e&&m().includes(e);return o&&r&&(o=C(e,t)),o},w=function(e,r){var o=y(e,r);if(o){var n=f(),i=m().indexOf(e);p.splice(i,0,n);var a=m()[i];if(o=t.focus.moveToRow(a),t.dirty(!0),a.cells().forEach((function(e){return e.dirty(!0)})),h&&h(a,t),g){var s=g(a,i+1,t);s&&u.announcement(s)}}return o},x=function(e,r,t){var i=o.wrapContextRows(r);return n.createToolbarButton(e,i,(function(e){return 1===e.length&&y(e[0],!0)}),(function(e){var r=e&&e[0];return w(r,!0)}),{telemetryName:"InsertRow",label:a.insertCommandText,icon:s},t)};u.on({extendGrid:function(e,r,t,o){r.insertion={},i.defLocalProps(r.insertion,{canInsertRow:function(e){return y(e,!0)},insertRow:function(e){return w(e,!1)},createInsertRowCommand:x}),i.defProps(t,{insertRow:function(e){return w(e,!0)}})}})}return d}return __extends(r,e),r}(t.Plugin);r.Plugin=u})),
define("FxInternal/Controls/Grid2/Grid2.EditableGrid.Reordering",["require","exports","FxInternal/Controls/Grid2/Grid2.CoreGrid.Base","FxInternal/Controls/Grid2/Grid2.CoreGrid.Selection","FxInternal/Controls/Grid2/Grid2.CoreGrid.Toolbar","FxInternal/Controls/Grid2/Grid2.CoreGrid.Util"],(function(e,r,t,o,n,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Plugin=void 0;var a=MsPortalFx.Resources.Strings.EditableGrid,s=MsPortalFx.Base.Images.ArrowUp(),u=MsPortalFx.Base.Images.ArrowDown(),l=MsPortalFx.Base.Images.Upload(),d=MsPortalFx.Base.Images.Download(),c=MsPortalFx.wrap(!0),f=function(e){function r(r,t,f,m){var p=e.call(this,r,t,f,m)||this,v=m.reordering;if(v){var C=t.rows,h=t.items,g=MsPortalFx.initObservable(v.visible,!0),y=v.canMoveRowsToRow||c,w=v.canMoveRowsUp||c,x=v.canMoveRowsDown||c,R=v.canMoveRowsTop||c,b=v.canMoveRowsBottom||c,P=v.onMoveRowsToRow,G=v.onMoveRowsUp,M=v.onMoveRowsDown,I=v.onMoveRowsTop,F=v.onMoveRowsBottom,T=v.formatMoveRowsToRowMessage||function(e,r){return(e.length>1?a.moveToMessagePlural:a.moveToMessageSingular).format(r)},_=v.formatMoveRowsUpMessage||function(e,r){return(e.length>1?a.moveUpMessagePlural:a.moveUpMessageSingular).format(r)},D=v.formatMoveRowsDownMessage||function(e,r){return(e.length>1?a.moveDownMessagePlural:a.moveDownMessageSingular).format(r)},E=v.formatMoveRowsTopMessage||function(e){return e.length>1?a.moveTopMessagePlural:a.moveTopMessageSingular},k=v.formatMoveRowsBottomMessage||function(e){return e.length>1?a.moveBottomMessagePlural:a.moveBottomMessageSingular},A=function(e,r,o){var n=!(!(null==e?void 0:e.length)||!r);return n&&o&&(n=y(e,r,t)),n},B=function(e,r){e=e.slice();for(var o,n,i=C(),a=e.length+1,s=[],u=[],l=0,d=0;d<i.length&&a;d++){var c=i[d],f=MsPortalFx.remove(e,c)[0];f?(s.push(f),void 0===o&&(l++,o=d),a--):c===r?(n=u.length,u.push(c),void 0===o&&(o=d),a--):void 0!==o&&u.push(c)}var m=0===a;if(m){u.splice.apply(u,[n+l,0].concat(s));var p=[o,u.length];p=p.concat(u.map((function(e){return e.item}))),h.splice.apply(h,p),t.dirty(!0)}return{execute:m,start:o}},S=function(e,r,o){var n,i=A(e,r,o);if(i){var a;if(i=(n=B(e,r)).execute,a=n.start,i&&(P&&P(e,r,t),T)){var s=T(e,a+1,r,t);s&&f.announcement(s)}}return i},O=function(e,r){var o=C(),n=!!(null==e?void 0:e.length)&&o.length>e.length;if(n){var i=o[0];n=!e.includes(i)}return n&&r&&(n=w(e,t)),n},q=function(e,r){var o=O(e,r);if(o){for(var n=C(),i=void 0,a=[],s=void 0,u=(e=e.slice()).length+1,l=0;l<n.length&&u;l++){var d=n[l];if(MsPortalFx.remove(e,d)[0]){if(0===l)return!1;void 0===s&&(i=n[s=l-1]),u--,a.push(d),l===n.length-1&&(u--,a.push(i))}else void 0!==s&&(a.push(i),i=d,1===u&&u--)}if(o=0===u){var c=[s,a.length];if(h.splice.apply(h,c.concat(a.map((function(e){return e.item})))),t.dirty(!0),G&&G(e,t),_){var m=_(e,s+1,t);m&&f.announcement(m)}}}return o},L=function(e,r){var o=C(),n=!!(null==e?void 0:e.length)&&o.length>e.length;if(n){var i=o[o.length-1];n=!e.includes(i)}return n&&r&&(n=x(e,t)),n},U=function(e,r){var o=L(e,r);if(o){for(var n=C(),i=[],a=void 0,s=(e=e.slice()).length+1,u=0,l=0;l<n.length&&s;l++){var d=n[l];MsPortalFx.remove(e,d)[0]?(void 0===a&&(a=l),i.push(d),s--):void 0!==a&&(i.splice(u,0,d),u=i.length,1===s&&s--)}if(o=0===s){var c=[a,i.length];if(h.splice.apply(h,c.concat(i.map((function(e){return e.item})))),t.dirty(!0),M&&M(e,t),D){var m=D(e,a+1,t);m&&f.announcement(m)}}}return o},N=function(e,r){var o=C(),n=!!(null==e?void 0:e.length)&&o.length>e.length;return n&&r&&(n=R(e,t)),n},j=function(e,r){var o=N(e,r);if(o){var n=C();if((o=B(e,n[0]).execute)&&(I&&I(e,t),E)){var i=E(e,t);i&&f.announcement(i)}}return o},V=function(e,r){var o=C(),n=!!(null==e?void 0:e.length)&&o.length>e.length;return n&&r&&(n=b(e,t)),n},H=function(e,r){var o=V(e,r);if(o){var n=C();if((o=B(e,n[n.length-1]).execute)&&(F&&F(e,t),k)){var i=k(e,t);i&&f.announcement(i)}}return o},W=function(e,r,t){var i=o.wrapContextRows(r);return n.createToolbarButton(e,i,(function(e){return O(e,!0)}),(function(e){return q(e,!0)}),{telemetryName:"MoveUp",label:a.moveUpCommandText,icon:s},t)},K=function(e,r,t){var i=o.wrapContextRows(r);return n.createToolbarButton(e,i,(function(e){return L(e,!0)}),(function(e){return U(e,!0)}),{telemetryName:"MoveDown",label:a.moveDownCommandText,icon:u},t)},z=function(e,r,t){var i=o.wrapContextRows(r);return n.createToolbarButton(e,i,(function(e){return N(e,!0)}),(function(e){return j(e,!0)}),{telemetryName:"MoveTop",label:a.moveTopCommandText,icon:l},t)},J=function(e,r,t){var i=o.wrapContextRows(r);return n.createToolbarButton(e,i,(function(e){return V(e,!0)}),(function(e){return H(e,!0)}),{telemetryName:"MoveBottom",label:a.moveBottomCommandText,icon:d},t)};f.on({extendGrid:function(e,r,t,o){r.reordering={},i.defProps(r.reordering,{visible:g}),i.defLocalProps(r.reordering,{canMoveRowsToRow:function(e,r){return A(e,r,!0)},moveRowsToRow:function(e,r){return S(e,r,!1)},canMoveRowsUp:function(e){return O(e,!0)},moveRowsUp:function(e){return q(e,!1)},canMoveRowsDown:function(e){return L(e,!0)},moveRowsDown:function(e){return U(e,!1)},canMoveRowsTop:function(e){return N(e,!0)},moveRowsTop:function(e){return j(e,!1)},canMoveRowsBottom:function(e){return V(e,!0)},moveRowsBottom:function(e){return H(e,!1)},createMoveRowsUpCommand:W,createMoveRowsDownCommand:K,createMoveRowsTopCommand:z,createMoveRowsBottomCommand:J}),i.defProps(t,{moveRowsToRow:function(e,r){return S(e,r,!0)},moveRowsUp:function(e){return q(e,!0)},moveRowsDown:function(e){return U(e,!0)},moveRowsTop:function(e){return j(e,!0)},moveRowsBottom:function(e){return H(e,!0)}})}})}return p}return __extends(r,e),r}(t.Plugin);r.Plugin=f})),
define("FxInternal/Controls/Grid2/Grid2.EditableGrid.Validation",["require","exports","FxInternal/Controls/Grid2/Grid2.CoreGrid.Base","FxInternal/Controls/Grid2/Grid2.CoreGrid.Util","FxInternal/Utils/ValidationHelper"],(function(e,r,t,o,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Plugin=void 0;var i=MsPortalFx.Base.Promises.cancelOnDispose,a=MsPortalFx.identity,s=function(e){function r(r,t,s,u){var l=e.call(this,r,t,s,u)||this,d=function(){(0,n.tryOnTriggerValidation)(t)},c=u.validation||{},f=ko.observable(!0),m=function(){d();var e=[];if(c.validate){var o=c.validate(t);e.push(Promise.resolve(o))}if(c.validateAsync){var n=i(r,(function(){return c.validateAsync(t)}));e.push(n)}return t.rows().forEach((function(t){if(ko.unwrap(t.editing)&&ko.unwrap(t.dirty)){var o=i(r,(function(){return t.triggerValidation()}));e.push(o)}})),Promise.all(e).then((function(e){var r=e.every(a);return f(r),r}))};return s.on({extendGrid:function(e,r,t,o){r.validation={triggerValidation:m,valid:f},r.valid=f,r.triggerValidation=m,t.canCreateValidationFooter=!!c.createRowValidationFooter},initGrid:function(e,r,t,o){ko.reactor(e,(function(){var e=r.rows().every((function(e){return!e.validationErrors().length}));f(e)}))},extendRow:function(e,r,t,o){r.triggerValidation=function(){d();var e=[];return e.push.apply(e,r.cells().map((function(e){return e.triggerValidation()}))),Promise.all(e).then((function(e){return e.every(a)}))},r.validationErrors=ko.pureComputed((function(){var e=[];return r.cells().forEach((function(r){var t=r.customValidationErrors();t&&t.length&&e.push.apply(e,t),(t=r.editorValidationErrors())&&t.length&&e.push.apply(e,t)})),e})),t.validationFooter=ko.observable()},initRow:function(e,r,t,n){if(s.canCreateValidationFooter){var i=e.createChildLifetime();o.subscribe(i,r.validationErrors,(function(o){o&&o.length&&(i.dispose(),t.validationFooter(c.createRowValidationFooter(e,r)))}))}},extendCell:function(e,r,t,o){r.triggerValidation=function(){d();var e=ko.unwrap(r.editor);return e&&e.triggerValidation?(e.ensureValidation&&e.ensureValidation(1),e.triggerValidation()):Promise.resolve(!0)},r.customValidationErrors=ko.observableArray(),r.editorValidationErrors=ko.observable([])},initCell:function(e,r,t,o){ko.reactor(e,(function(){var e=ko.unwrap(r.editor),t=e&&e.validationResults,o=[];if(t){var n=ko.unwrap(t);n&&n.forEach((function(e){var r=e.message;r&&!e.valid&&o.push(r)}))}r.editorValidationErrors(o)}))}}),l}return __extends(r,e),r}(t.Plugin);r.Plugin=s})),
define("FxInternal/Data/BaseProjection",["require","exports"],(function(e,r){"use strict";var t=ko.utils,o=MsPortalFx.initValue,n=MsPortalFx.initObservableArray;return function(){function e(e){var r=this;this._lifetime=e.lifetime.createChildLifetime(),this._source=e.source,this._autoRefresh=o(e.autoRefresh,!0),this.destination=n(e.destination),this._internalEdit=!1,this.destination.subscribe(this._lifetime,(function(){if(!r._internalEdit)throw new Error("Modification of projection array not allowed while the projection is active.")})),this._autoRefresh&&FxImpl.subscribeArrayEdits(this._lifetime,this._source,(function(e){r._update(e)}))}return e.prototype._replace=function(e){var r=this.destination.peek(),o=t.compareArrays(r,e,{sparse:!0});this._apply(o)},e.prototype._apply=function(e){var r=t.createArraySplices(e);try{this._internalEdit=!0,r.length?t.applyArraySplices(this.destination,r):this.destination.notifySubscribers([],"arrayChange")}finally{this._internalEdit=!1}},e}()})),
define("FxInternal/Data/JoinProjection",["require","exports","FxInternal/Data/BaseProjection"],(function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=function(e){function r(r){var t=e.call(this,r)||this;return t._joinSource=r.joinSource,t._transferring=!1,t._autoRefresh&&FxImpl.subscribeArrayEdits(t._lifetime,t._joinSource,(function(e){t._updateJoin(e)})),t.refresh(),t}return __extends(r,e),r.prototype.refresh=function(){var e=this._source().concat(this._joinSource());this._replace(e)},r.prototype._update=function(e){this._transferring||this._apply(e)},r.prototype._updateJoin=function(e){if(!this._transferring){var r=this._source().length,t=e.map((function(e){return MsPortalFx.extend2(e,{index:e.index+r})}));this._apply(t)}},r.prototype.transfer=function(e){try{this._transferring=!0,e()}finally{this._transferring=!1}},r}(t);r.default=o})),
define("FxInternal/Controls/Grid2/Grid2.EditableGrid",["require","exports","FxInternal/Controls/Grid2/Grid2.CoreGrid.Base","FxInternal/Controls/Grid2/Grid2.CoreGrid.Util","FxInternal/Controls/Grid2/Grid2.CoreGrid.Activation","FxInternal/Controls/Grid2/Grid2.CoreGrid.Formatters","FxInternal/Controls/Grid2/Grid2.CoreGrid.ContextMenu","FxInternal/Controls/Grid2/Grid2.CoreGrid.Focus","FxInternal/Controls/Grid2/Grid2.CoreGrid.Hover","FxInternal/Controls/Grid2/Grid2.CoreGrid.Resizing","FxInternal/Controls/Grid2/Grid2.CoreGrid.Scrolling","FxInternal/Controls/Grid2/Grid2.CoreGrid.Selection","FxInternal/Controls/Grid2/Grid2.CoreGrid.Toolbar","FxInternal/Controls/Grid2/Grid2.EditableGrid.Addition","FxInternal/Controls/Grid2/Grid2.EditableGrid.Deletion","FxInternal/Controls/Grid2/Grid2.EditableGrid.Editing","FxInternal/Controls/Grid2/Grid2.EditableGrid.Insertion","FxInternal/Controls/Grid2/Grid2.EditableGrid.Reordering","FxInternal/Controls/Grid2/Grid2.EditableGrid.Validation","FxInternal/Data/JoinProjection","Fx/Controls/Toolbar"],(function(e,r,t,o,n,i,a,s,u,l,d,c,f,m,p,v,C,h,g,y,w){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ViewModel=void 0;var x=function(e){function r(r,t){var i=e.call(this,r,t)||this;i.controlType=125;var y=ko.observableArray();i._appendRow=null;var x=i,R=i._msPortalFxInternal,b=i.header,P=t.header||{};R.addEventTriggers("clearDirty");var G=ko.observable(!1);i.dirty=ko.computed(r,{read:function(){return G()},write:function(e){G(e),e||R.trigger.clearDirty()}});var M=MsPortalFx.initObservableArray(t.items);return o.defLocalProps(x,{items:M,rows:y}),R._allRows=ko.observableArray(),R.visibleRows=R._allRows,R.totalRowCount=ko.observable(0),R._allRowsLoaded=ko.observable(!0),o.defLocalProps(R,{additionalRows:ko.observableArray(),transferAdditionalRows:function(){i._join.transfer((function(){var e=R.additionalRows();R.additionalRows([]),e.forEach((function(e){i._appendRow=e,M.push(e.item)}))})),i._appendRow=null}}),i._plugins=[new s.Plugin(r,x,R,t),new u.Plugin(r,x,R,t),new c.Plugin(r,x,R,t,{enabledByDefault:!0}),new n.Plugin(r,x,R,t),new l.Plugin(r,x,R,t),new d.Plugin(r,x,R,t),new a.Plugin(r,x,R,t,{maxButtonCommands:t.deletion?2:void 0,supplyButtonCommands:function(e,r,t){var o=[],n=t.contextMenu.maxButtonCommands;return t.deletion&&o.length<n&&o.push(t.deletion.createDeleteRowsCommand(e,r)),o},supplyMenuCommands:function(e,r,t){var o=[];return t.deletion&&o.push(t.deletion.createDeleteRowsCommand(e,r)),t.reordering&&(o.push(t.reordering.createMoveRowsUpCommand(e,r)),o.push(t.reordering.createMoveRowsDownCommand(e,r)),o.push(t.reordering.createMoveRowsTopCommand(e,r)),o.push(t.reordering.createMoveRowsBottomCommand(e,r))),t.insertion&&o.push(t.insertion.createInsertRowCommand(e,r)),o},supplyMenuBulkCommands:function(e,r,t){var o=[];return t.deletion&&o.push(t.deletion.createDeleteRowsCommand(e,r)),t.reordering&&(o.push(t.reordering.createMoveRowsUpCommand(e,r)),o.push(t.reordering.createMoveRowsDownCommand(e,r)),o.push(t.reordering.createMoveRowsTopCommand(e,r)),o.push(t.reordering.createMoveRowsBottomCommand(e,r))),t.insertion&&o.push(t.insertion.createInsertRowCommand(e,r)),o}}),new f.Plugin(r,x,R,t,{createToolbar:function(e,r){var t=r.reordering,o=r.insertion,n=r.deletion,i=r.selection;return w.create(e,{showLabels:!0,items:[t&&t.createMoveRowsUpCommand(e,i),t&&t.createMoveRowsDownCommand(e,i),t&&t.createMoveRowsTopCommand(e,i),t&&t.createMoveRowsBottomCommand(e,i),o&&o.createInsertRowCommand(e,i),n&&n.createDeleteRowsCommand(e,i)].filter((function(e){return!!e}))})}}),new v.Plugin(r,x,R,t),new g.Plugin(r,x,R,t),new m.Plugin(r,x,R,t),new p.Plugin(r,x,R,t),new C.Plugin(r,x,R,t),new h.Plugin(r,x,R,t)],i._extendGrid(r,x,R,t),i._extendHeader(r,b,P),i._initGrid(r,x,R,t),i._initHeader(r,b,P),i}return __extends(r,e),r.prototype._initGrid=function(r,t,n,i){var a=this;e.prototype._initGrid.call(this,r,t,n,i),o.subscribeAndRun(r,this.items,(function(e){n.totalRowCount(e.length)}));var s=this.items.mapInto(r,(function(e,r){var t=a._appendRow;if(t){var i=o.internal(t);return e.registerForDispose(i._lifetime),t}var s=n._createInternalNode({item:r,id:null});return n._createRow(e,s)}),t.rows);t.rows.mapInto(r,(function(e,r){return o.internal(r)._node}),this._nodes),this.noData(!1),this._join=new y.default({lifetime:r,source:s,joinSource:n.additionalRows,destination:n._allRows})},r.prototype._createFormatter=function(e,r){return i.create(e,r)},r}(t.ViewModel);r.ViewModel=x})),
define("Fx/Controls/EditableGrid",["require","exports","FxInternal/Controls/Grid2/Grid2.EditableGrid"],(function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(e,r){return ko.ignoreDependencies((function(){return new t.ViewModel(e,r)}))}})),
define("FxHubs/Helpers/AssetHelpers",["require","exports","FxHubs/ArmHelpers/ArmIds"],(function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.checkItemKind=function(e,r,o,n){if(t.ResourceArmIdKindMap[r.kind]){var i=n.assetTypeInformation;if(i&&i.kindMap){var a=i.kindMap[o&&o.toLowerCase()||i.defaultKind];a&&(s=a,u=e,l=i.extensionName,u.setUseResourceMenu&&void 0!==s.useResourceMenu&&u.setUseResourceMenu(s.useResourceMenu),u.setIsPreview&&void 0!==s.isPreview&&u.setIsPreview(s.isPreview),u.setIcon&&s.icon&&u.setIcon(s.icon),u.setKindBladeAndPart&&s.bladeName&&u.setKindBladeAndPart(s.bladeName,s.bladeExtensionName||l,s.partName,s.partExtensionName||l),u.setAssetTypeDisplayName&&s.singularDisplayName&&u.setAssetTypeDisplayName(s.singularDisplayName),u.setLowerAssetTypeDisplayName&&s.lowerSingularDisplayName&&u.setLowerAssetTypeDisplayName(s.lowerSingularDisplayName))}}var s,u,l}})),
define("FxHubs/ResourceCommands/ArmBulkCommand",["require","exports","FxHubs/Resources/FxHubsClientStrings","FxHubs/ArmHelpers/ArmApisStartup","FxInternal/Notifications","Fx/Ajax","Fx/ResourceManagement","Fx"],(function(e,r,t,o,n,i,a,s){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.DEV=r.supportsForceDeletionMap=r.notifyCommandProgressWrapper=r.createAndPublishBulkNotificationWrapper=void 0,r.execute=function(e,t,o,n,l,f){var p,v=(0,r.createAndPublishBulkNotificationWrapper)(e.label,t,o.length),C=[],w={prevRetryRequestCount:o.length,maxRetryCount:3,retryCount:0,telemetryRetryCounter:1,retryAfter:g,retryableArmCodesPerResourceType:{},nonRetryableArmCodesPerResourceType:{}},x={commandId:e.id,resourceType:t,selectedResourceCount:o.length,executionContextId:MsPortalFx.getUniqueId(),successCount:0,failureCount:0,initialRequestRetryCount:0,pollRetryCount:0,initialRequestCorrelationIds:[],pollRequestCorrelationIds:[]},R=e.armCommandDefinitions||e.armCommandDefinitionOptions.definitions,b=MsPortalFx.isFeatureEnabled("armbulkdelete"),G=MsPortalFx.isFeatureEnabled("paramsupportinarmbulkdelete");if(I(t)){o.some((function(e){return P[e.resourceType]}))&&(w.maxRetryCount=20,w.retryAfter=y),n&&(MsPortalFx.forEachKey(r.supportsForceDeletionMap,(function(e){var r=R[e],t=new u.UriBuilder(r.uri);t.query.setParameter("forcedeletion","true"),l&&t.query.setParameter("api-version",l);var o={httpMethodType:r.httpMethodType,uri:t.toString(),asyncOperation:r.asyncOperation};R[e]=o})),x.isForceDelete=!0)}b&&(p=!0,MsPortalFx.forEachKey(R,(function(e){var r,t=R[e];if("delete"!==(null===(r=t.httpMethodType)||void 0===r?void 0:r.toLowerCase()))p=!1;else{var o=new u.UriBuilder(t.uri);Object.keys(o.query.getParameters()).length>1&&!G&&(p=!1)}})),n&&!G&&(p=!1));l&&MsPortalFx.forEachKey(R,(function(r){var o,n=R[r],i=l[null===(o=e.id)||void 0===o?void 0:o.toLowerCase()];if(i){var a=new u.UriBuilder(n.uri),s=a.getOriginalQuery();a.query.clear(),a.query=new u.QueryStringBuilder(s),i&&a.query.setParameter("api-version",i);var c={httpMethodType:n.httpMethodType,uri:a.toString(),asyncOperation:n.asyncOperation};R[r]=c,d.trace({source:"ArmBulkCommand",action:"CustomApiVersionUsed",data:{resourceType:t,commandId:e.id}})}}));if(h=d.startTrace({source:"ArmBulkCommand",action:"Execute",name:x.executionContextId}),p)return x.isArmBulkDelete=!0,function(e,t,o,n,l,f){var p,v=t.map((function(e){return e.resourceId}));if(f){var C=[];v.forEach((function(t){var o,n,i=null===(n=null===(o=a.ArmId.parse(t))||void 0===o?void 0:o.resourceType)||void 0===n?void 0:n.toLowerCase(),s=e.armCommandDefinitions?e.armCommandDefinitions:e.armCommandDefinitionOptions.definitions,d=s[i]||s["*"],c=new u.UriBuilder(d.uri).query.getParameters();l&&r.supportsForceDeletionMap[i]&&(c.forcedeletion="true"),C.push({id:t,additionalParameters:c})})),p={Entities:C,Type:"Default"}}else p={EntityIds:v,Type:"Default"};var y=f?"2022-09-01":"2022-06-01";return(0,i.batch)({uri:"/bulkdelete?api-version=".concat(y),type:"POST",content:p,setTelemetryHeader:"armbulkdelete"}).then((function(e){var t=e.headers.Location,u=_(g,e);if(t)return function(e,t,o,n){var u={},l=function(){return(0,i.batch)({uri:e,type:"GET",setTelemetryHeader:"armbulkdelete-polling"}).then((function(e){var i,f=!1;switch(e.httpStatusCode){case 204:case 200:var p=e.content;if(null===(i=p.responses)||void 0===i||i.forEach((function(e){var r,t,i=e.id;switch(e.status){case"Succeeded":u[i]||(o.succeeded++,n.successCount++,MsPortalFx.UI.AssetManager.notifyResourceDeleted(i),f=!0,u[i]=!0);break;case"Failed":if(!u[i]){o.failed++,n.failureCount++;var s=m.notificationError;e.errorResponse&&(s=(null===(r=e.errorResponse)||void 0===r?void 0:r.error)&&FxImpl.Azure.parseArmErrorToMessage(null===(t=e.errorResponse)||void 0===t?void 0:t.error)||s);var l=a.ArmId.parse(i);o.errorDetails.push({name:l.resourceName,resourceId:i,message:s}),f=!0,u[i]=!0}break;case"Canceled":o.canceled++}})),"Accepted"===p.status)return f&&(0,r.notifyCommandProgressWrapper)(o),s.delay(t).then((function(){return n.pollRetryCount++,l()}));o&&(d.endTrace(h,"Complete",n),"Succeeded"===p.status?(0,r.notifyCommandProgressWrapper)(o,4):(0,r.notifyCommandProgressWrapper)(o,2));break;default:(0,r.notifyCommandProgressWrapper)(o,2),c.warning("ARM Bulk delete response returned http error code {0}".format(e.httpStatusCode))}})).catch((function(e){if(o)return d.endTrace(h,"Failed",{error:e}),(0,r.notifyCommandProgressWrapper)(o,2,e.message),Promise.reject(e)}))};return l()}(t,u,o,n);c.error("Unable to poll for ARM bulk delete status since location header is missing.");var l=m.notificationDescStatus.format(o.succeeded,o.failed,o.canceled);l=m.notificationStatusDetails.format(l,m.notificationError),(0,r.notifyCommandProgressWrapper)(o,2,l),d.cancelTrace(h)}),(function(e){var t,n;403===(n=null==(t=e)?void 0:t.httpStatusCode,MsPortalFx.isNumeric(n)?n:void 0)&&S(e)===FxImpl.ameCancelledErrorCode?(0,r.notifyCommandProgressWrapper)(o,1,m.ameCancelledDescription):(0,r.notifyCommandProgressWrapper)(o,2,e.message),d.cancelTrace(h,e)}))}(e,o,v,x,n,G);return B(e,t,o,v,C,w,x,f).then((function(o){if(C.length)return s.delay(o).then((function(){return A(e,C,t,v,480,x,1)}));d.completeTrace(h,x),(0,r.notifyCommandProgressWrapper)(v,4)})).catch((function(e){var t=m.notificationDescStatus.format(v.succeeded,v.failed,v.canceled);throw t=m.notificationStatusDetails.format(t,m.notificationError),(0,r.notifyCommandProgressWrapper)(v,2,t),d.cancelTrace(h,x),e}))};var u=MsPortalFx.Base,l=u.Diagnostics,d=l.Telemetry,c=l.createLog(e),f=u.Promises.PromiseStates.rejected,m=t.BulkCommand,p="{resourceid}",v="<div>{0}</div>",C="<div style='padding-top: 10px'>{0}</div>".format(m.errorDetails);r.createAndPublishBulkNotificationWrapper=function(e,r,t){var o=e.toLowerCase();return{notification:(0,n.publishPendingNotification)({title:m.notificationTitle.format(m.executing,o,t),description:{htmlTemplate:v.format(m.notificationDescStatus.format(0,0,0))},percentComplete:0}),commandName:o,total:t,succeeded:0,failed:0,canceled:0,errorDetails:[]}},r.notifyCommandProgressWrapper=function(e,r,t){var o=isNaN(r)?m.executing:m.executed,n=m.notificationTitle.format(o,e.commandName,e.total),i=t||m.notificationDescStatus.format(e.succeeded,e.failed,e.canceled),a=v.format(i),s=e.errorDetails;s.length&&(a+=C,s.forEach((function(e){a+="<div class='ext-hubs-bulkcommand-notification-errordetails' style='padding-top: 6px'><a href='#resource{0}' style='text-decoration: underline'>{1}</a><span>: {2}</span></div>".format(MsPortalFx.ensurePrefix(e.resourceId,"/"),e.name,e.message)})));var u={htmlTemplate:a},l=void 0!==r?0:3,d=r;4===r&&(e.total===e.failed?d=2:(e.failed>0||e.total===e.canceled)&&(d=1));var c=e.notification;void 0!==r?c.complete({title:n,description:u,status:d,toastDuration:l}):c.update({title:n,description:u,toastDuration:l})};var h,g=15e3,y=3e4,w={};w[500]=w[502]=w[503]=w[504]=!0;var x={};x[429]=x[409]=!0;var R={scopelocked:!0},b={429:!0},P={"microsoft.compute/virtualmachines":!0,"microsoft.classiccompute/virtualmachines":!0};r.supportsForceDeletionMap={"microsoft.compute/virtualmachines":!0,"microsoft.compute/virtualmachinescalesets":!0};var G={Succeeded:"succeeded",InProgress:"inprogress",Failed:"failed",Canceled:"canceled"};function M(e){return MsPortalFx.convertArrayToMap(e.map((function(e){return e.toLowerCase()})),MsPortalFx.identity,(function(){return!0}))}function I(e){return"microsoft.resources/resources"===e.toLowerCase()}function F(e,r){var t=r.httpMethodType&&"delete"===r.httpMethodType.toLowerCase();return e.armCommandDefinitionOptions?e.armCommandDefinitionOptions.isDelete||t:e.isBulkDeleteOperation||t}function T(e,r,t,o,n,i){var a=m.defaultErrorMessage.format(e.label,r.httpStatusCode),s=r.content&&r.content.error;s&&(a=FxImpl.Azure.parseArmErrorToMessage(s)||a);var u=!0;403===r.httpStatusCode&&S(r)===FxImpl.ameCancelledErrorCode?(u=!1,n.canceled++,a=m.ameCancelledDescription):n.failed++,n.errorDetails.push({name:o.name,resourceId:o.resourceId,message:a}),u&&c.warning("BulkCommand {0} execution returned http error code {1} for Resource Id = {2}, Resource Type = {3}, Is All Resources Blade = {4}, RetryCount = {5}, Error = {6}".format(e.label,r.httpStatusCode,o.resourceId,o.resourceType,I(t),i,a))}function _(e,r){var t=r.headers&&1e3*+r.headers["Retry-After"]||0;return Math.max(e,t)}function D(e,r){var t,o,n=r.headers.Location;return(null===(t=null==e?void 0:e.asyncOperation)||void 0===t?void 0:t.pollingHeaderOverride)&&(o=r.headers[e.asyncOperation.pollingHeaderOverride]),o||n}function E(e){return Promise.reject({message:m.commandConfigurationError.format(e),status:400})}function k(e){var r=new Set;return e.forEach((function(e){return e.headers&&r.add(e.headers["x-ms-correlation-request-id"])})),Array.from(r)}function A(e,t,o,n,a,u,l){var p=t.map((function(e){return e.uri})),v=d.startTrace({source:"ArmBulkCommand",action:"Poll",name:u.executionContextId}),C={subContextId:l,requestCount:p.length,requestCorrelationIds:[],failure:0,success:0,pollCount:0,retryInfo:{}};return function(e,r,t){var o=[],n=t?"{0}.{1}.poll".format(r,t):"{0}.BulkCmd.poll".format(r);return e.forEach((function(e){o.push((0,i.batch)({options:1,uri:e,type:"GET",setTelemetryHeader:n}))})),Promise.allSettled(o).then((function(e){return e.map((function(e){return e.status===f?e.reason:e.value}))}))}(p,o,e.id).then((function(i){var f,p=[],h=g,y=!1,x=k(i);if((f=u.pollRequestCorrelationIds).push.apply(f,x),C.requestCorrelationIds=x,i.forEach((function(r,o){var i,a,s,l,d=t[o],f=e.armCommandDefinitions?e.armCommandDefinitions:e.armCommandDefinitionOptions.definitions,v=f[d.resourceType]||f["*"],g=!1;switch(h=_(h,r),r.httpStatusCode){case 204:case 200:var x=r.content;if(x&&x.status)switch(x.status.toLowerCase()){case G.Succeeded:n.succeeded++,y=!0,g=!0,u.successCount++,C.success++;break;case G.Failed:n.failed++,u.failureCount++,C.failure++,y=!0;var R=m.notificationError;x.error&&(R=FxImpl.Azure.parseArmErrorToMessage(x.error)||R),n.errorDetails.push({name:d.name,resourceId:d.resourceId,message:R});break;case G.Canceled:n.canceled++,y=!0;break;case G.InProgress:p.push(t[o]);break;default:c.warning("BulkCommand {0} poll response content returned unexpected status value = {1}. Resource Id = {2}, Resource Type = {3}".format(e.label,x.status,d.resourceId,d.resourceType))}else n.succeeded++,u.successCount++,C.success++,g=!0,y=!0;g&&F(e,v)&&MsPortalFx.UI.AssetManager.notifyResourceDeleted(d.resourceId);break;case 202:var P=D(v,r);P&&(t[o].uri=P),p.push(t[o]),C.pollCount++;break;case 404:if(F(e,v)){n.succeeded++,u.successCount++,C.success++,y=!0,MsPortalFx.UI.AssetManager.notifyResourceDeleted(d.resourceId);break}default:if(l=r.httpStatusCode,w[l]||b[l]){p.push(t[o]);var M=(null===(a=null===(i=r.content)||void 0===i?void 0:i.error)||void 0===a?void 0:a.code)||(null===(s=r.content)||void 0===s?void 0:s.code),I=C.retryInfo[M]||0;C.retryInfo[M]=++I;break}n.failed++,u.failureCount++,C.failure++,y=!0;R=m.defaultErrorMessage.format(e.label,r.httpStatusCode);if(r.content){var T=r.content.error||r.content;R=FxImpl.Azure.parseArmErrorToMessage(T)||R}n.errorDetails.push({name:d.name,resourceId:d.resourceId,message:R}),c.warning("BulkCommand {0} poll response returned http error code {1} for Resource Id = {2}, Resource Type = {3}".format(e.label,r.httpStatusCode,d.resourceId,d.resourceType))}})),d.completeTrace(v,C),p.length&&--a)return y&&(0,r.notifyCommandProgressWrapper)(n),s.delay(h).then((function(){return u.pollRetryCount++,A(e,p,o,n,a,u,++l)}));if(p.length&&!a){var R=m.notificationDescStatus.format(n.succeeded,n.failed,n.canceled);R=m.notificationStatusDetails.format(R,m.notificationTimedout.format(480*g/6e4)),(0,r.notifyCommandProgressWrapper)(n,1,R)}else(0,r.notifyCommandProgressWrapper)(n,4);return Promise.resolve([])}))}function B(e,r,t,n,a,u,l,m){var v=d.startTrace({source:"ArmBulkCommand",action:"RequestDetails",name:l.executionContextId}),C={subContextId:u.telemetryRetryCounter++,requestCorrelationIds:[],requestCount:t.length,failure:0,success:0,pollCount:0,retryInfo:{}};return function(e,r,t,n){var a=[],s=e.id?"{0}.{1}.execute".format(t,e.id):"{0}.BulkCmd.execute".format(t);return r.forEach((function(r){var u,l=p,d=e.armCommandDefinitions?e.armCommandDefinitions:e.armCommandDefinitionOptions.definitions,f=d[r.resourceType]||d["*"];if(r.kind){var m=n&&n[r.resourceType],v=m&&m[r.kind];v&&(f=v)}f?(u=f.httpMethodType||"POST",f.uri?(l=f.uri.replace(p,r.resourceId),a.push((0,i.batch)({options:2,uri:l,type:u,setTelemetryHeader:s}))):I(t)?a.push(o.resourceApi(r.resourceId).then((function(e){return(0,i.batch)({options:2,uri:e,type:u,setTelemetryHeader:s})}))):(c.error("BulkCommand's ArmCommandDefinition is missing the required uri property for Resource Id = {0}, Resource Type = {1}".format(r.resourceId,r.resourceType)),a.push(E(r.resourceId)))):(c.error("BulkCommand's ArmCommandDefinition is missing for Resource Id = {0}, Resource Type = {1}".format(r.resourceId,r.resourceType)),a.push(E(r.resourceId)))})),Promise.allSettled(a).then((function(e){return e.map((function(e){return e.status===f?e.reason:e.value}))}))}(e,t,r,m).then((function(o){var i,f=g,p=u.retryAfter,h=[],y=[],b=k(o);if((i=l.initialRequestCorrelationIds).push.apply(i,b),C.requestCorrelationIds=b,o.forEach((function(o,i){var s,d,m,v,g,b=t[i],P=e.armCommandDefinitions?e.armCommandDefinitions:e.armCommandDefinitionOptions.definitions,G=P[b.resourceType]||P["*"];switch(o.httpStatusCode){case 204:case 200:n.succeeded++,l.successCount++,C.success++,F(e,G)&&MsPortalFx.UI.AssetManager.notifyResourceDeleted(b.resourceId);break;case 202:var I=D(G,o);I?(a.push({uri:I,name:b.name,resourceId:b.resourceId,resourceType:b.resourceType,kind:b.kind}),C.pollCount++):c.error("BulkCommand operation returned accepted http status code but poll uri was not found, Resource Id = {0}, Resource Type = {1}".format(b.resourceId,b.resourceType)),f=_(f,o);break;default:if((null===(s=null==G?void 0:G.retryableArmCodes)||void 0===s?void 0:s.length)&&!u.retryableArmCodesPerResourceType[r]&&(u.retryableArmCodesPerResourceType[r]=M(G.retryableArmCodes)),(null===(d=null==G?void 0:G.nonRetryableArmCodes)||void 0===d?void 0:d.length)&&!u.nonRetryableArmCodesPerResourceType[r]&&(u.nonRetryableArmCodesPerResourceType[r]=M(G.nonRetryableArmCodes)),function(e,r,t){var o,n,i,a=(null===(n=null===(o=null==t?void 0:t.content)||void 0===o?void 0:o.error)||void 0===n?void 0:n.code)||(null===(i=null==t?void 0:t.content)||void 0===i?void 0:i.code),s=null==a?void 0:a.toLowerCase(),u=r.nonRetryableArmCodesPerResourceType[e],l=r.retryableArmCodesPerResourceType[e];return!(a&&(u?u[s]:R[s]))&&(w[t.httpStatusCode]||x[t.httpStatusCode]||function(e,r,t){var o,n;if(400===r.httpStatusCode){var i=(null===(n=null===(o=null==r?void 0:r.content)||void 0===o?void 0:o.error)||void 0===n?void 0:n.code)||(null==r?void 0:r.content.code),a=null==i?void 0:i.toLowerCase();if(i&&t&&t[a]||e<2)return!0}return!1}(r.retryCount,t,l))}(r,u,o)){p=_(p,o),h.push(b),y.push(o);var E=(null===(v=null===(m=null==o?void 0:o.content)||void 0===m?void 0:m.error)||void 0===v?void 0:v.code)||(null===(g=o.content)||void 0===g?void 0:g.code),k=C.retryInfo[E]||0;C.retryInfo[E]=++k;break}l.failureCount++,C.failure++,T(e,o,r,b,n,u.retryCount)}})),d.completeTrace(v,C),h.length){if(u.prevRetryRequestCount>h.length||u.retryCount++<u.maxRetryCount)return u.prevRetryRequestCount=h.length,s.delay(p).then((function(){return l.initialRequestRetryCount++,B(e,r,h,n,a,u,l,m)}));h.forEach((function(t,i){l.failureCount++,T(e,o[i],r,t,n,u.retryCount)}))}return Promise.resolve(f)}))}function S(e){var r,t,o,n,i;return(null===(t=null===(r=null==e?void 0:e.content)||void 0===r?void 0:r.error)||void 0===t?void 0:t.code)||(null===(i=null===(n=null===(o=null==e?void 0:e.content)||void 0===o?void 0:o.details)||void 0===n?void 0:n[0])||void 0===i?void 0:i.code)||void 0}}));