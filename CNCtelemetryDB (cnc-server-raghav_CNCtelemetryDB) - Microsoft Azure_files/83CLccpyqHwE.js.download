define("_generated/MsPortalImpl/Svg/Library/Controls/PillRemove.svg",["require","exports"],(function(t,e){"use strict";e.type=e.data=void 0;e.type=1,e.data="<svg viewBox='0 0 12.7 12.7' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M12.8.8 12 0 6.4 5.7.8 0 0 .8l5.7 5.6L0 12l.8.8 5.6-5.7 5.6 5.7.8-.8-5.7-5.6z'/></g></svg>"})),
define("MsPortalImpl/Controls/Controls.Pill.Component",["require","exports","Weave/DirectMode","Weave","MsPortalImpl/Weave/Components","_generated/MsPortalImpl/Svg/Library/Loading/EllipsisSquare.svg","_generated/MsPortalImpl/Svg/Library/Controls/PillRemove.svg","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl.Controls/Controls/DockedBalloon","FxInternal/Weave/Util","MsPortalImpl/Weave/Util","FxInternal/Weave"],(function(t,e,l,i,o,s,n,r,a,c,d,f){"use strict";e.PillInner=function(e){const{vm:m,state:g}=e,u=g.showDisplayText,b=g.pillHover,v=g.removeIconHover,k=(0,f.toComputation)(m.readOnly),C=(0,f.toComputation)(m.ariaLabel),y=MsPortalFx.getUniqueId();return l(i.GetContext,{fn:e=>{const{disabled:w,tabIndex:I}=(0,d.aggregateContext)(e,m,g);return l(i.SetContext,{disabled:w,tabIndex:I},l("div",{className:[p,{"fxc-pill-readOnly":k,"fxc-pill-edit-mode":(0,f.toComputation)(m.editMode),"fxc-pill-disabled":w,"fxc-pill-inline-edit":u.compose((t=>!t)),"fxc-pill-dialog":g.editorType.compose((t=>"Dialog"===t)),"fxc-pill-hover":(0,i.composeComputation)([b,v],((t,e)=>t&&!e))}]},l(i.If,{condition:(0,f.toComputation)(m.icon),concealmentBehavior:"remove",trueFn:()=>l("div",{className:"fxc-pill-icon",image:(0,f.toComputation)(m.icon).compose((t=>MsPortalFx.Base.Images.CustomImageWithOptions(t,{customClass:"fxt-pill-custom-icon"})))})}),l("span",{className:[h,{"fxc-pill-content-with-icon":(0,f.toComputation)(m.icon),"fxc-pill-content-no-remove-button":(0,f.toComputation)(m.showRemoveButton).compose((t=>!t)),"fxc-pill-read-mode":u}],role:"button","aria-label":(0,i.composeComputation)([C,(0,f.toComputation)(m.displayText.key),(0,f.toComputation)(m.displayText.operator),(0,f.toComputation)(m.displayText.value)],((t,e,l,i)=>{const o="{0}, {1} {2} {3}".format(r.Controls.Pill.filter,e||"",l||"",i||"");return t||o.trim()})),"aria-describedby":y,"aria-disabled":w,tabindex:(0,f.toComputation)(g.tabIndex)},l("span",{className:"fxc-pill-inner-content"},l("div",{className:"fxc-pill-read-container",style:{height:u.compose((t=>t?"auto":"0")),opacity:u.compose((t=>t?"1":"0"))}},l("span",{className:"fxc-pill-content-key"},(0,f.toComputation)(m.displayText.key)),l("span",{className:["fxc-pill-content-operator",{"fxs-display-none":m.displayText.operator?(0,f.toComputation)(m.displayText.operator).compose(c.negation):null}]},(0,f.toComputation)(m.displayText.operator)),l("b",{className:"fxc-pill-content-value"},(0,f.toComputation)(m.displayText.value))),l(i.If,{condition:(0,i.composeComputation)([u,g.editorContent],((t,e)=>!t&&!e)),trueFn:()=>l("div",{className:"fxc-pill-content-loading",image:s})}),l(i.If,{condition:u,concealmentBehavior:"remove",falseFn:()=>l("div",{className:x},l(o.HtmlOrKo,{content:g.editorContent,require:t}))}))),(0,f.toComputation)(g.tooltip).compose((t=>t?l(a.DockedBalloon,{className:"fxc-pill-tooltip",vm:t}):null)),l(i.If,{condition:(0,f.toComputation)(m.showRemoveButton),trueFn:()=>l("div",{role:"button",className:["fxc-pill-close fxt-pill-close-icon",{"fxc-pill-close-hover":(0,i.composeComputation)([b,v],((t,e)=>t||e))}],"aria-label":r.Controls.Pill.deleteItem,title:r.Controls.Pill.deleteItem,tabindex:(0,f.toComputation)(g.tabIndex),image:MsPortalFx.Base.Images.CustomImageWithOptions(n,{palette:99})})}),k.compose((t=>l("label",{className:"fxs-hide-accessible-label",id:y},t?r.Controls.Pill.readOnlyModeLabel:r.Controls.Pill.editModeLabel)))))}})},e.widgetEditorClass=e.widgetContentClass=e.widgetClass=void 0;const p=e.widgetClass="fxc-pill",h=e.widgetContentClass="fxc-pill-content",x=e.widgetEditorClass="fxc-pill-editor"})),
define("_generated/Less/MsPortalImpl/Controls/Controls.Pill.css",["module"],(function(t){"use strict";return{css:'.fxc-pill{align-items:center;display:inline-flex;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;height:24px;font-size:13px;line-height:1.385;border-radius:16px;vertical-align:middle;position:relative;cursor:pointer;max-width:100%;box-sizing:border-box}.fxc-pill .fxc-pill-tooltip.azc-control{position:absolute}.fxc-pill-inline-edit{height:auto!important;margin-top:-3px}.fxc-pill-inline-edit .fxc-pill-content{height:auto!important}.fxc-pill-theme-filter .fxc-pill-collection-item,.fxc-pill-theme-filter .fxc-pill-content{border-radius:16px}.fxc-pill-theme-tag .fxc-pill-collection-item{margin:5px 4px}.fxc-pill-theme-tag .fxc-pill-collection-item .fxc-pill{border-radius:2px;background-color:#e6f2fb;font-size:13px;height:24px}.fxc-pill-theme-tag .fxc-pill-collection-item .fxc-pill:hover{background-color:#cce4f6}.fxc-pill-theme-tag .fxc-pill-collection-item .fxc-pill-read-container{color:#000}.fxc-pill-theme-tag .fxc-pill-collection-item .fxc-pill-content{padding:0 24px 0 0;margin-left:0;background-color:#e6f2fb}.fxc-pill-theme-tag .fxc-pill-collection-item .fxc-pill-content.fxc-pill-content-no-remove-button{padding-right:0}.fxc-pill-theme-tag .fxc-pill-collection-item .fxc-pill-inner-content{margin:3px 8px 4px}.fxc-pill-theme-tag .fxc-pill-collection-item .fxc-pill-content-value{font-weight:normal}.fxc-pill-theme-tag .fxc-pill-collection-item .fxc-pill-collection-exceed{vertical-align:top}.fxc-pill-theme-tag .fxc-pill-collection-add-button-container{margin:0 2px}.fxc-pill-theme-tag .fxc-pill-collection-add{margin:4px 0}.fxc-pill-theme-tag .fxc-pill-collection-add-button{border:0;padding:0}.fxc-pill-theme-tag .fxc-pill-collection-add-button:focus{outline:#015cda 1px solid!important}.fxc-pill-theme-tag .fxc-pill-collection-add-icon{width:12px;height:12px;padding:0 6px;display:flex}.fxc-pill-theme-tag .fxt-pill-custom-icon,.fxc-pill-theme-tag .fxt-pill-close-icon{fill:#000}.fxs-mode-dark .fxc-pill-theme-tag .fxc-pill-collection-item .fxc-pill{background-color:rgba(85,179,255,.4)}.fxs-mode-dark .fxc-pill-theme-tag .fxc-pill-collection-item .fxc-pill-content{background-color:rgba(85,179,255,.05)}.fxs-mode-dark .fxc-pill-theme-tag .fxc-pill-collection-item .fxc-pill-content:active,.fxs-mode-dark .fxc-pill-theme-tag .fxc-pill-collection-item .fxc-pill-content:focus{background-color:rgba(85,179,255,.05)}.fxs-mode-dark .fxc-pill-theme-tag .fxc-pill-collection-item .fxc-pill-read-container{color:#f3f2f1}.fxc-pill-disabled{pointer-events:none;cursor:default}.fxc-pill-tooltip{pointer-events:none;top:0;left:calc(50% - 10px)}.fxc-pill-tooltip .azc-dockedballoon-anchor{visibility:hidden}.fxc-pill-icon{flex:0 0 auto;justify-content:center;border-radius:50%;padding:4px 3px 4px 5px;width:14px;height:14px;block-size:14px;margin:0;position:absolute}.fxc-pill-content{display:inline-flex;align-items:center;justify-content:center;vertical-align:middle;margin-left:0;padding:0 24px 0 10px;min-width:0;height:24px;border:1px solid transparent;box-sizing:border-box}.fxc-pill-content.fxc-pill-content-no-remove-button{padding-right:14px}.fxc-pill-content.fxc-pill-content-with-icon{padding-left:27px}.fxc-pill-editor{overflow:hidden;margin-top:-3px}.fxc-pill-content-loading{width:16px;height:16px;display:block;margin:0 auto}.fxc-pill-inner-content{max-width:400px;margin:6px 5px;height:19px;width:100%}.fxc-pill-read-container{max-width:400px;height:17px}.fxc-pill-edit-mode .fxc-pill-content{width:auto}.fxc-pill-content-key{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex:1 1 auto;display:inline-block;vertical-align:top;min-width:0}.fxc-pill-content-operator{flex:0 0 auto;box-sizing:border-box;padding:0 4px;text-align:center;display:inline-block;vertical-align:top}.fxc-pill-content-value{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex:1 1 auto;display:inline-block;vertical-align:top}.fxc-pill-close{display:flex;flex:0 0 auto;justify-content:center;border-radius:50%;text-align:center;width:24px;height:22px;position:absolute;right:1px}.fxc-pill-close:focus{outline-offset:0}.fxt-pill-close-icon>svg{height:12px;width:12px;display:block;margin:auto;position:absolute;left:6px;top:50%;transform:translate(0,-50%)}.fxc-pill-collection{display:inline-block;width:100%}.fxc-pill-collection-item{display:inline-block;margin:5px;vertical-align:top;max-width:100%;height:24px}.fxc-pill-collection-exceed{padding:0 4px}.fxc-pill-collection-add{display:inline-block;vertical-align:middle;max-width:100%}.fxc-pill-collection-add-button-container{display:inline-block;margin:5px;width:100%}.fxc-pill-collection-add-button-container .fxc-pill{border:1px solid}.fxc-pill-collection-add-button-container .fxc-pill-content{border:0}.fxc-pill-collection-add-icon{padding:4px 0 4px 2px;width:18px;height:17px;position:relative}.fxc-pill-collection-add-button{padding:0 8px 1px}.fxc-pill-collection-add-button:focus{border-color:#015cda}.fxc-pill-collection-add-button .fxc-pill-collection-add-label{height:auto;line-height:23px}.fxc-pill-collection-add-label{font-size:13px;line-height:1.385;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:inline-block;margin-left:5px;margin-right:10px;padding:0}.fxc-pill-collection-disabled{pointer-events:none}.fxc-pill-collection-moreOrLess{display:inline-block;margin:5px;vertical-align:top;height:17px;float:right;cursor:pointer}.fxc-pill-collection-moreOrLess .fxc-pill-collection-moreOrLessIcon{height:12px;width:12px;display:inline-block}.fxc-pill-collection-moreOrLess .fxc-pill-collection-moreOrLessText{font-family:az_ea_font,"Segoe UI",az_font,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;font-weight:400;font-size:13px;line-height:1.385;padding-left:5px}.fxs-mode-light .fxc-pill{border-color:#e6f2fb;background-color:#e6f2fb}.fxs-mode-light .fxc-pill.fxc-pill-collection-add-button:hover,.fxs-mode-light .fxc-pill.fxc-pill-hover{border-color:#cce4f6;background-color:#cce4f6}.fxs-mode-light .fxc-pill .fxc-pill-content:focus{outline:0;border:1px solid;border-color:#015cda;background-color:#b3d7f2}.fxs-mode-light .fxc-pill .fxc-pill-content:focus+.fxc-pill-close{border-color:#015cda;background-color:#b3d7f2}.fxs-mode-light .fxc-pill .fxc-pill-close:focus{outline-color:#015cda}.fxs-mode-light .fxc-pill-dialog.fxc-pill-edit-mode{border-color:#b3d7f2;background-color:#b3d7f2}.fxs-mode-light .fxc-pill-dialog.fxc-pill-edit-mode .fxc-pill-content{border-color:#b3d7f2;background-color:#b3d7f2}.fxs-mode-light .fxc-pill-dialog.fxc-pill-edit-mode .fxc-pill-close{border-color:#b3d7f2;background-color:#b3d7f2}.fxs-mode-light .fxc-pill-read-container{display:flex;color:#161616}.fxs-mode-light .fxc-pill-editor{color:#161616}.fxs-mode-light .fxc-pill-disabled{border-color:rgba(127,127,127,.7);background-color:rgba(127,127,127,.3);color:rgba(127,127,127,.7);opacity:.5}.fxs-mode-light .fxc-pill-disabled .fxc-pill-read-container{color:rgba(127,127,127,.7)}.fxs-mode-light .fxc-pill-close.fxc-pill-close-hover{background-color:#cce4f6}.fxs-mode-light .fxc-pill-close.fxc-pill-close-hover.fxt-pill-close-icon{fill:#605e5c}.fxs-mode-light .fxt-pill-close-icon{fill:#605e5c}.fxs-mode-light .fxc-pill-collection-add-button:focus{border-color:#015cda;outline-color:#015cda}.fxs-mode-light .fxt-pill-custom-icon,.fxs-mode-light .fxt-pill-collection-add-icon{fill:#015cda}.fxs-mode-light .fxc-pill-collection-add-label{color:#161616}.fxs-mode-light .fxc-pill-collection-moreOrLessIcon,.fxs-mode-light .fxc-pill-collection-moreOrLessText{fill:#161616;color:#161616}.fxs-mode-light .fxc-pill-collection-moreOrLessIcon,.fxs-mode-light .fxc-pill-collection-moreOrLessText{fill:#0078d4;color:#0078d4}.fxs-highcontrast-light .fxc-pill{border-color:#000;background-color:#fff}.fxs-highcontrast-light .fxc-pill.fxc-pill-collection-add-button:hover,.fxs-highcontrast-light .fxc-pill.fxc-pill-hover{border-color:#fff;background-color:#800080}.fxs-highcontrast-light .fxc-pill .fxc-pill-content:focus{outline:0;border:1px solid;border-color:#015cda;background-color:#800080}.fxs-highcontrast-light .fxc-pill .fxc-pill-content:focus+.fxc-pill-close{border-color:#015cda;background-color:#800080}.fxs-highcontrast-light .fxc-pill .fxc-pill-close:focus{outline-color:#015cda}.fxs-highcontrast-light .fxc-pill-dialog.fxc-pill-edit-mode{border-color:#fff;background-color:#800080}.fxs-highcontrast-light .fxc-pill-dialog.fxc-pill-edit-mode .fxc-pill-content{border-color:#fff;background-color:#800080}.fxs-highcontrast-light .fxc-pill-dialog.fxc-pill-edit-mode .fxc-pill-close{border-color:#fff;background-color:#800080}.fxs-highcontrast-light .fxc-pill-read-container{display:flex;color:#161616}.fxs-highcontrast-light .fxc-pill-editor{color:#161616}.fxs-highcontrast-light .fxc-pill-disabled{border-color:rgba(127,127,127,.7);background-color:rgba(127,127,127,.3);color:rgba(127,127,127,.7);opacity:.5}.fxs-highcontrast-light .fxc-pill-disabled .fxc-pill-read-container{color:rgba(127,127,127,.7)}.fxs-highcontrast-light .fxc-pill-close.fxc-pill-close-hover{background-color:#800080}.fxs-highcontrast-light .fxc-pill-close.fxc-pill-close-hover.fxt-pill-close-icon{fill:#fff}.fxs-highcontrast-light .fxt-pill-close-icon{fill:#605e5c}.fxs-highcontrast-light .fxc-pill-collection-add-button:focus{border-color:#015cda;outline-color:#015cda}.fxs-highcontrast-light .fxt-pill-custom-icon,.fxs-highcontrast-light .fxt-pill-collection-add-icon{fill:#000}.fxs-highcontrast-light .fxc-pill-collection-add-label{color:#161616}.fxs-highcontrast-light .fxc-pill-collection-moreOrLessIcon,.fxs-highcontrast-light .fxc-pill-collection-moreOrLessText{fill:#161616;color:#161616}.fxs-highcontrast-light .fxc-pill-dialog.fxc-pill-edit-mode .fxt-pill-custom-icon,.fxs-highcontrast-light .fxc-pill-hover .fxt-pill-custom-icon,.fxs-highcontrast-light .fxc-pill:active .fxt-pill-custom-icon,.fxs-highcontrast-light .fxc-pill:focus .fxt-pill-custom-icon,.fxs-highcontrast-light .fxc-pill-dialog.fxc-pill-edit-mode .fxt-pill-close-icon,.fxs-highcontrast-light .fxc-pill-hover .fxt-pill-close-icon,.fxs-highcontrast-light .fxc-pill:active .fxt-pill-close-icon,.fxs-highcontrast-light .fxc-pill:focus .fxt-pill-close-icon{fill:#fff}.fxs-highcontrast-light .fxc-pill-dialog.fxc-pill-edit-mode .fxc-pill-read-container,.fxs-highcontrast-light .fxc-pill-hover .fxc-pill-read-container,.fxs-highcontrast-light .fxc-pill:active .fxc-pill-read-container,.fxs-highcontrast-light .fxc-pill:focus .fxc-pill-read-container{color:#f3f2f1}.fxs-highcontrast-light .fxc-pill-close.fxc-pill-close-hover{background-color:#800080}.fxs-highcontrast-light .fxc-pill-close.fxc-pill-close-hover.fxt-pill-close-icon{fill:#fff}.fxs-highcontrast-light .fxc-pill-theme-tag .fxc-pill-collection-item .fxc-pill-content{border-color:transparent!important}.fxs-highcontrast-light .fxc-pill-editor{-webkit-text-fill-color:#161616!important}.fxs-highcontrast-light .fxc-pill-content:focus{border-color:#015cda!important}.fxs-mode-dark .fxc-pill{border-color:rgba(127,127,127,.7);background-color:#323130}.fxs-mode-dark .fxc-pill.fxc-pill-collection-add-button:hover,.fxs-mode-dark .fxc-pill.fxc-pill-hover{border-color:#7f7f7f;background-color:#484644}.fxs-mode-dark .fxc-pill .fxc-pill-content:focus{outline:0;border:1px solid;border-color:#4894fe;background-color:#72716e}.fxs-mode-dark .fxc-pill .fxc-pill-content:focus+.fxc-pill-close{border-color:#4894fe;background-color:#72716e}.fxs-mode-dark .fxc-pill .fxc-pill-close:focus{outline-color:#4894fe}.fxs-mode-dark .fxc-pill-dialog.fxc-pill-edit-mode{border-color:rgba(127,127,127,.7);background-color:#72716e}.fxs-mode-dark .fxc-pill-dialog.fxc-pill-edit-mode .fxc-pill-content{border-color:rgba(127,127,127,.7);background-color:#72716e}.fxs-mode-dark .fxc-pill-dialog.fxc-pill-edit-mode .fxc-pill-close{border-color:rgba(127,127,127,.7);background-color:#72716e}.fxs-mode-dark .fxc-pill-read-container{display:flex;color:#f3f2f1}.fxs-mode-dark .fxc-pill-editor{color:#f3f2f1}.fxs-mode-dark .fxc-pill-disabled{border-color:rgba(127,127,127,.7);background-color:rgba(127,127,127,.3);color:rgba(127,127,127,.7);opacity:.5}.fxs-mode-dark .fxc-pill-disabled .fxc-pill-read-container{color:rgba(127,127,127,.7)}.fxs-mode-dark .fxc-pill-close.fxc-pill-close-hover{background-color:#484644}.fxs-mode-dark .fxc-pill-close.fxc-pill-close-hover.fxt-pill-close-icon{fill:#faf9f8}.fxs-mode-dark .fxt-pill-close-icon{fill:#f3f2f1}.fxs-mode-dark .fxc-pill-collection-add-button:focus{border-color:#4894fe;outline-color:#4894fe}.fxs-mode-dark .fxt-pill-custom-icon,.fxs-mode-dark .fxt-pill-collection-add-icon{fill:#f3f2f1}.fxs-mode-dark .fxc-pill-collection-add-label{color:#f3f2f1}.fxs-mode-dark .fxc-pill-collection-moreOrLessIcon,.fxs-mode-dark .fxc-pill-collection-moreOrLessText{fill:#f3f2f1;color:#f3f2f1}.fxs-highcontrast-dark .fxc-pill{border-color:#fff;background-color:#000}.fxs-highcontrast-dark .fxc-pill.fxc-pill-collection-add-button:hover,.fxs-highcontrast-dark .fxc-pill.fxc-pill-hover{border-color:#f3f2f1;background-color:#0ff}.fxs-highcontrast-dark .fxc-pill .fxc-pill-content:focus{outline:0;border:1px solid;border-color:#4894fe;background-color:#0ff}.fxs-highcontrast-dark .fxc-pill .fxc-pill-content:focus+.fxc-pill-close{border-color:#4894fe;background-color:#0ff}.fxs-highcontrast-dark .fxc-pill .fxc-pill-close:focus{outline-color:#4894fe}.fxs-highcontrast-dark .fxc-pill-dialog.fxc-pill-edit-mode{border-color:#f3f2f1;background-color:#0ff}.fxs-highcontrast-dark .fxc-pill-dialog.fxc-pill-edit-mode .fxc-pill-content{border-color:#f3f2f1;background-color:#0ff}.fxs-highcontrast-dark .fxc-pill-dialog.fxc-pill-edit-mode .fxc-pill-close{border-color:#f3f2f1;background-color:#0ff}.fxs-highcontrast-dark .fxc-pill-read-container{display:flex;color:#f3f2f1}.fxs-highcontrast-dark .fxc-pill-editor{color:#f3f2f1}.fxs-highcontrast-dark .fxc-pill-disabled{border-color:#0f0;background-color:rgba(127,127,127,.3);color:#0f0;opacity:1}.fxs-highcontrast-dark .fxc-pill-disabled .fxc-pill-read-container{color:#0f0}.fxs-highcontrast-dark .fxc-pill-close.fxc-pill-close-hover{background-color:#0ff}.fxs-highcontrast-dark .fxc-pill-close.fxc-pill-close-hover.fxt-pill-close-icon{fill:#484644}.fxs-highcontrast-dark .fxt-pill-close-icon{fill:#f3f2f1}.fxs-highcontrast-dark .fxc-pill-collection-add-button:focus{border-color:#4894fe;outline-color:#4894fe}.fxs-highcontrast-dark .fxt-pill-custom-icon,.fxs-highcontrast-dark .fxt-pill-collection-add-icon{fill:#f3f2f1}.fxs-highcontrast-dark .fxc-pill-collection-add-label{color:#f3f2f1}.fxs-highcontrast-dark .fxc-pill-collection-moreOrLessIcon,.fxs-highcontrast-dark .fxc-pill-collection-moreOrLessText{fill:#f3f2f1;color:#f3f2f1}.fxs-highcontrast-dark .fxc-pill-dialog.fxc-pill-edit-mode .fxt-pill-custom-icon,.fxs-highcontrast-dark .fxc-pill-hover .fxt-pill-custom-icon,.fxs-highcontrast-dark .fxc-pill:active .fxt-pill-custom-icon,.fxs-highcontrast-dark .fxc-pill:focus .fxt-pill-custom-icon,.fxs-highcontrast-dark .fxc-pill-dialog.fxc-pill-edit-mode .fxt-pill-close-icon,.fxs-highcontrast-dark .fxc-pill-hover .fxt-pill-close-icon,.fxs-highcontrast-dark .fxc-pill:active .fxt-pill-close-icon,.fxs-highcontrast-dark .fxc-pill:focus .fxt-pill-close-icon{fill:#484644}.fxs-highcontrast-dark .fxc-pill-dialog.fxc-pill-edit-mode .fxc-pill-read-container,.fxs-highcontrast-dark .fxc-pill-hover .fxc-pill-read-container,.fxs-highcontrast-dark .fxc-pill:active .fxc-pill-read-container,.fxs-highcontrast-dark .fxc-pill:focus .fxc-pill-read-container{color:#161616}.fxs-highcontrast-dark .fxc-pill-close.fxc-pill-close-hover{background-color:#0ff}.fxs-highcontrast-dark .fxc-pill-close.fxc-pill-close-hover.fxt-pill-close-icon{fill:#484644}.fxs-highcontrast-dark .fxc-pill-theme-tag .fxc-pill-collection-item .fxc-pill-content{border-color:transparent!important}.fxs-highcontrast-dark .fxc-pill-editor{-webkit-text-fill-color:#f3f2f1!important}.fxs-highcontrast-dark .fxc-pill-content:focus{border-color:#4894fe!important}',moduleId:t.id}})),
define("MsPortalImpl/Controls/Controls.Pill",["require","exports","MsPortalImpl/UI/Commands/UI.CommandManager","MsPortalImpl.Controls/Controls/Base/OptionsBase","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/UI.LinkHandler","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Base/Base.ImplUtils","Fx/Controls/InfoBalloon","MsPortalImpl/Controls/Controls.Pill.Component","MsPortalImpl.Controls/Controls/Base/Base","Weave","MsPortalImpl/Weave/Util","FxInternal/Composition/ContainerViewModel","FxInternal/Css","_generated/Less/MsPortalImpl/Controls/Controls.Pill.css","FxInternal/Weave/Util","FxInternal/Weave","MsPortalImpl/Base/Base.BrowserDetection","Fx"],(function(t,e,l,i,o,s,n,r,a,c,d,f,p,h,x,m,g,u,b,v,k,C,y,w){"use strict";e.WidgetUIState=e.Widget=e.Pill=e.InnerTsxComponent=void 0;var I=c.getFxClickSelectable;(0,b.injectCss)(v);MsPortalFx.Base.Diagnostics;const P=".fxc-pill",_=".fxc-pill-close",M="pillcontrol",E=".azc-dockedballoon-anchor";let W=0;e.InnerTsxComponent=h.PillInner;class L extends x.WidgetUIState{constructor(t){super(),this.showDisplayText=(0,m.makeWritableComputation)(!0),this.editorType=(0,m.makeWritableComputation)(null),this.editorContent=(0,m.makeWritableComputation)(null),this.removeIconHover=(0,m.makeWritableComputation)(!1),this.pillHover=(0,m.makeWritableComputation)(!1);const e=t.vm;let l;this.tooltip=ko.computed(this._ltm,[e.infoBalloonContent],(t=>(l||MsPortalFx.isNullOrUndefined(t)||(l=p.create(this._ltm,{content:e.infoBalloonContent})),l)))}}e.WidgetUIState=L;class F extends i.Widget{constructor(t,e,l,i){super(t,e,l,i),this._dirty=ko.observable(!1),this._clickHandlerInternal=(t,e,l)=>!0,this._telemetryName="";const s=this.ltm,n=this.vm;this._editor=n._msPortalFxEditor,this._addEditor(s,this.vm),n.suppressDirtyBehavior||(0,o.markFormFieldElement)(this.element[0],this.vm,this,{triggerValidation:()=>Promise.resolve(!0),valid:ko.observable(!0),dirty:this._dirty,ltm:s}),(0,m.subscribeAndRun)(s,[(0,C.toComputation)(n.editMode),(0,C.toComputation)(n.readOnly),this.state.editorType],((t,e,l)=>{"Inline"===l&&(e||!t?this.state.showDisplayText(!0):this.state.showDisplayText(!1))})),this._assignEvents(),this._assignEditorEvents()}_inlineEditorDOMExists(){return $.contains(window.document.documentElement,this.element.find(`.${h.widgetEditorClass}`)[0])}_addEditor(e,l){const i=this.state.editorType,o=this.state.editorContent,s=this._editor,n=M+W++;let r;this._onClickSelectable=I(this._diContainer,this.ltm,this.element,M,n),this.vm.editor.subscribeAndRun(e,(l=>{if(l){if(s(l),"Custom"===l.type){i("Custom"),r&&r.dispose(),r=e.createChildLifetime();let o=l.onClick;this._telemetryName=o&&o.telemetryName||"",o&&ko.ignoreDependencies((()=>{if("function"==typeof o){const e=o;o=l=>{l.stopPropagation(),w.isPromiseLike(e)&&f.logToExtension(t,this.element,2,FxImpl.createError("Pill Control binding argument is not a callback function. The click handler is "+e)),this._onClickSelectable.invokeClick(this.vm,e,l)}}const e=(0,a.getUriAndHandler)(r,this._diContainer,o,!0);e.errorMessage.subscribeAndRun(r,(e=>{e&&f.logToExtension(t,this.element,1,FxImpl.createError(`Pill Control failure: ${MsPortalFx.getLogFriendlyMessage(e)}`))})),e.uri.subscribeAndRun(r,(t=>{t=!t&&o.bladeReference?"#":t,this.disabled(!t)})),this._clickHandlerInternal=(t,l,i)=>((ko.unwrap(e.uriPromise)||Promise.resolve()).then((()=>e.handler(t,l,i))),!0)}))}else"Dialog"===l.type?i("Dialog"):i("Inline");if("Inline"===l.type||"Dialog"===l.type){const t=l.content;if((n=t)&&n.controlType)o({htmlTemplate:"<div data-bind='pcControl: $data'></div>",viewModel:t});else{if(!function(t){return!(!t||!t.htmlTemplate)}(t))throw"Unknown editor content in Pill";o(t)}}this._editModeLifetime=e.createChildLifetime(),this._addEditModeSubscription(this._editModeLifetime)}var n}))}_addEditModeSubscription(t){this.vm.editMode.subscribeAndRun(t,(e=>{const i=this._editor&&this._editor();if(this.state.editorType&&this.state.editorType.value&&i){if(e){let e;this.state.tooltip()&&this.state.tooltip().balloonVisible(!1),(0,k.hasValueAsync)(t,this.state.showDisplayText,(t=>!t)).then(m.waitForChangePropagation).then((()=>(e=this.element.find(`.${h.widgetEditorClass}`),e[0]&&this._inlineEditorDOMExists()&&(0,s.waitForBindings)(e[0])))).then((()=>{e.findFirstTabbable().focus();const l={dismissFn:MsPortalFx.noop,logName:"pill"};d.register(l),t.registerForDispose((()=>{d.unregister(l)}))}))}switch(i.type){case"Inline":if(!e&&i.onEditModeExited){i.onEditModeExited().finally((()=>{this._exitEditModeCleanUp(),t.dispose()}))}break;case"Dialog":{const o=i;e&&o.onEditModeExited&&MsPortalFx.Base.Promises.cancelOnDispose(this.ltm,(()=>Promise.all([this._diContainer.getAsync(r.DialogManager),this._diContainer.getAsync(l.AsyncPortalFormTarget)]).then((([t,e])=>this._dialogEditorHandler(t,i,e))))).then((t=>o.onEditModeExited(t))).finally((()=>{t.dispose(),this._exitEditModeCleanUp()}));break}case"Custom":{const l=this.vm.editMode();this.vm.editMode(!1),l&&this.element.children().filter(P).find(".fxc-pill-content").focus(),e&&i.onClick&&this._clickHandlerInternal($.Event("click"),this._onClickSelectable,this._telemetryName),t.dispose();break}}}}))}_dialogEditorHandler(t,e,l){return t.showShellDialog({telemetryName:e.telemetryName||"pill control dialog",type:u.Dlg2,title:ko.unwrap(e.title),hideTitle:ko.unwrap(e.hideTitle),content:{htmlTemplate:this.state.editorContent.value.htmlTemplate,viewModel:this.state.editorContent.value.viewModel},buttons:e.buttons},l,this.element.find(`.${h.widgetContentClass}`)[0],{locator:null,modal:!1,trustedTemplate:!1,sideload:!0,scopeClass:(0,s.getCssScope)(this.element)}).then((t=>{const e=this.vm.editMode();return this.vm.exitEditMode().then((()=>{e&&this.element.children().filter(P).find(".fxc-pill-content").focus()})),t}),(t=>(this.vm.exitEditMode(),t||1)))}_assignEditorEvents(){const t=this.element.find(`.${h.widgetEditorClass}`);this.ltm.registerForDispose([t.setEvents(["focusin",e=>{if(this.$disabled())return!1;this._keyboardNavigation&&(this._keyboardNavigation.dispose(),this._keyboardNavigation=null),this._keyboardNavigation=new n.KeyboardNavigation(this.ltm,{element:t,tabTriggers:2})}],["keydown",t=>{if(this.$disabled())return!1;if(27===t.which)this._keyboardNavigation&&(this._keyboardNavigation.dispose(),this._keyboardNavigation=null),this.state.tooltip()&&this.state.tooltip().balloonVisible(!1);else if(112===t.which&&this.state.tooltip())return this.state.tooltip().balloonVisible(!this.state.tooltip().balloonVisible()),!1;t.stopPropagation()}])])}_assignEvents(){const t=this.ltm;this.$disabled.subscribeAndRun(this.ltm,(t=>{t?this.tabindex(null):this.tabindex(0)}));const e=this.vm.value.subscribe(t,(()=>{this._dirty(!0),e.dispose()})),l=this.element.children().filter(P);this.ltm.registerForDispose([this.element.setEvents(["dispose",P,()=>{this.dispose()}],["click",P,t=>(this.vm.readOnly()||this.vm.enterEditMode(),!1)],["mouseenter",P,t=>{this.vm.editMode()||this.state.tooltip()&&this.state.tooltip().balloonVisible(!0),this.state.pillHover(!0)}],["mouseleave",P,t=>{this.vm.editMode()||this.state.tooltip()&&this.state.tooltip().balloonVisible(!1),this.state.pillHover(!1)}],["mouseenter",_,t=>{this.state.removeIconHover(!0)}],["mouseleave",_,t=>{this.state.removeIconHover(!1)}],["keypress",P,t=>!this.$disabled()&&(13===t.which||32===t.which&&!this.vm.editMode()?(this.vm.readOnly()||this.vm.enterEditMode(),!1):void 0)],["keydown",P,t=>{if(this.$disabled())return!1;if(112===t.which&&this.state.tooltip())return this.state.tooltip().balloonVisible(!this.state.tooltip().balloonVisible()),!1;if(9===t.which&&this.state.tooltip()&&this.state.tooltip().balloonVisible()){const t=this.element.find(E).attr("aria-describedby");if(t){const e=$(document.body).find(`#${t}`).find("a[href], select, button, input, textarea, [tabindex]:not([tabindex='-1'])");if(e&&e.length>0){const t=$.Event("keydown");return t.which=9,t.keyCode=9,this.element.find(E).trigger(t),!1}}}}],["keyup",P,t=>{if(this.$disabled())return!1;if(27===t.which){this.state.tooltip()&&this.state.tooltip().balloonVisible(!1);const t=this.vm.editMode();this.vm.exitEditMode().then((()=>{t&&l.find(".fxc-pill-content").focus()}))}t.stopPropagation()}],["focusout",P,t=>{if(this.$disabled())return!1;const e=$.contains(this.element[0],t.relatedTarget),i=!t.relatedTarget&&t.target!==l[0]&&0===$(t.target).closest(P).length,o=$(t.target);let s;if(s=!!o.attr("aria-multiselectable")?o.hasClass("fxc-dropdown-popup")&&!o.hasClass("fxc-dropdown-hidden"):o.hasClass("fxc-dropdown-popup"),e){if(o.hasClass("fxc-dropdown-open")){const e=$(t.relatedTarget);o.hasClass("fxc-dropdown-popup")||e.hasClass("fxc-dropdown-option")?y.isFirefox?setTimeout((()=>o?.focus())):o?.focus():y.isFirefox?setTimeout((()=>e?.focus())):e?.focus()}}else{if(i||s){let t=o;if(s){const t=ko.dataFor(o[0]);t&&t.data&&t.data.isPopUpOpen(!1)}for(;!t.parent().hasClass(h.widgetEditorClass);)t=t.parent();t=t.findFirstTabbable(),0===t.length&&(t=l),t.focus()}if("Inline"===this.state.editorType.value){const t=this.vm.editMode();this.vm.exitEditMode().then((()=>{t&&l.find(".fxc-pill-content").focus()}))}}}]),this.element.setEvents(["click",_,t=>{if(this.$disabled())return!1;this._removePill(),t.stopPropagation()}],["keypress",_,t=>!this.$disabled()&&(13===t.which||32===t.which?(this._removePill(),!1):void 0)]),this.element.find(E).setEvents(["focus",t=>(this.$disabled()||l.find(".fxc-pill-content").focus(),!1)])])}_exitEditModeCleanUp(){this.state.editorContent({htmlTemplate:"",viewModel:{}}),this._keyboardNavigation&&(this._keyboardNavigation.dispose(),this._keyboardNavigation=null)}_removePill(){const t=this.element.parent();t.hasClass("fxc-pill-collection")&&t.trigger("onRemoved",this.element),this.vm.onRemoved&&this.vm.onRemoved(this.vm.value()),this.dispose()}dispose(){this._checkExistsOrRegisterDestroyId(super.dispose)||(this._cleanElement(h.widgetClass),super.dispose())}}e.Widget=F;e.Pill=(0,g.createControlComponent)({widgetCtor:F,widgetUIStateCtor:L,innerComponent:h.PillInner})})),
define("_generated/MsPortalImpl/Svg/Library/Controls/AddFilter.svg",["require","exports"],(function(t,e){"use strict";e.type=e.data=void 0;e.type=1,e.data="<svg viewBox='0 0 18 17' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M5 4V0H4v4H0v1h4v4h1V5h4V4z'/><path d='M7 7v1.5l4 3.8V17h3v-4.7l4-3.8V7H7zm6 5v4h-1v-4L8 8.3V8h9v.3L13 12z'/></g></svg>"})),
define("MsPortalImpl/Controls/Controls.PillCollection.Component",["require","exports","Weave/DirectMode","FxInternal/Weave","Weave","FxInternal/Weave/Util","MsPortalImpl/Weave/Util","MsPortalImpl/Controls/Controls.Pill","_generated/MsPortalImpl/Svg/Library/Controls/AddFilter.svg","MsPortalImpl/Weave/Components"],(function(t,e,l,i,o,s,n,r,a,c){"use strict";e.PillCollectionInner=void 0;e.PillCollectionInner=e=>{const{vm:d,state:f}=e,p=1===d.theme;return l(o.GetContext,{fn:e=>{const{disabled:h,tabIndex:x}=(0,n.aggregateContext)(e,d,f),m=(0,i.toComputation)(f.tabIndex),g=f.addButtonAriaLabel,u=MsPortalFx.Base.Images.CustomImageWithOptions(a,{palette:99}),b=f.addButtonLabelVisible.compose(s.negation);return l("div",{className:["fxc-pill-collection",p?"fxc-pill-theme-filter":"fxc-pill-theme-tag",{"fxc-pill-collection-disabled":h}],role:"list",tabindex:"-1","aria-label":(0,i.toComputation)(d.ariaLabel)},l(o.SetContext,{disabled:h,tabIndex:x},l(o.ForEach,{collection:f.visibleItems,fn:({item:t,index:e})=>l(r.Pill,{className:"fxc-pill-collection-item",role:"listitem","data-index":e,vm:t})})),l("div",{className:["fxc-pill-collection-add",{"fxs-display-none":(0,i.toComputation)(d.addition.canAddPill).compose(s.negation)}],role:"listitem"},l("div",{className:"fxc-pill-collection-add-button-container"},l("div",{className:"fxc-pill fxc-pill-collection-add-button",role:"button",tabindex:m,"aria-label":g,title:g},l("span",{className:"fxc-pill-icon fxc-pill-collection-add-icon fxt-pill-collection-add-icon",image:(0,i.toComputation)(d.addition.icon).compose((t=>t||u))}),l(o.If,{condition:f.addButtonLabelWithString,concealmentBehavior:"remove",trueFn:()=>l("span",{className:["fxc-pill-content fxc-pill-collection-add-label",{"fxs-display-none":b}]},f.addButtonLabel)}),l(o.If,{condition:f.addButtonLabelWithHtmlTemplate,concealmentBehavior:"remove",trueFn:()=>l("span",{className:["fxc-pill-content fxc-pill-collection-add-label",{"fxs-display-none":b}]},l(c.HtmlOrKo,{content:(0,i.toComputation)(d.addition.label),require:t}))})))),l("div",{className:["fxc-pill-collection-moreOrLess",{"fxs-display-none":f.showMoreOrLess.compose(s.negation)}],onClick:({event:t})=>{f.moreOrLessExpanded(!f.moreOrLessExpanded.value),t.stopPropagation()},onKeyPress:({event:t})=>{13!==t.which&&32!==t.which||(f.moreOrLessExpanded(!f.moreOrLessExpanded.value),t.stopPropagation())}},l("div",{className:"fxc-pill-collection-moreOrLess-content",role:"button",tabindex:m,"aria-expanded":f.moreOrLessExpanded},l("span",{className:"fxc-pill-collection-moreOrLessIcon",image:f.moreOrLessIcon}),l("span",{className:"fxc-pill-collection-moreOrLessText"},f.moreOrLessText))))}})}})),
define("MsPortalImpl/Controls/Controls.PillCollection",["require","exports","MsPortalImpl/Controls/Controls.Pill","MsPortalImpl.Controls/Controls/Base/ViewModelBase","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl/Resources/ImplScriptResources","Viva.Controls/Util/Viva.Resize","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Base/Base.Events","MsPortalImpl/Controls/Controls.PillCollection.Component","Weave/Core/Computation","Weave","FxInternal/Weave"],(function(t,e,l,i,o,s,n,r,a,c,d,f,p){"use strict";e.WidgetUIState=e.Widget=e.InnerTsxComponent=void 0;const h="fxc-pill-collection",x="fxc-gc-columncell",m=s.Controls.Pill.editTags,g=s.Controls.Pill.addFilter,u={filter:10,tag:8},b=ko.utils.domData,v=MsPortalFx.isNullOrUndefined;e.InnerTsxComponent=c.PillCollectionInner;class k extends o.WidgetUIState{constructor(t){super(),this.visibleItems=(0,f.makeWritableComputation)([]),this.exceedItems=(0,f.makeWritableComputation)([]),this.showMoreOrLess=(0,f.makeWritableComputation)(!0),this.moreOrLessExpanded=(0,f.makeWritableComputation)(!1),this.moreOrLessIcon=this.moreOrLessExpanded.compose((t=>t?MsPortalFx.Base.Images.CaretUp():MsPortalFx.Base.Images.CaretDown())),this.moreOrLessText=(0,f.composeComputation)([this.moreOrLessExpanded,this.exceedItems],((t,e)=>t?s.Controls.Pill.less:s.Controls.Pill.more.format(e.length)));const e=t.vm,l=(0,p.toComputation)(e.addition.label),i=1===e.theme?g:m;this.noAddButtonLabel=l.compose((t=>v(t)||"string"==typeof t&&!t.length)),this.addButtonLabelWithString=(0,f.composeComputation)([l,this.noAddButtonLabel],((t,e)=>!e&&!t.htmlTemplate)),this.addButtonLabel=(0,f.composeComputation)([l,this.noAddButtonLabel],((t,l)=>e.addition.labelProvided?l?"":"string"==typeof t?t:t.htmlTemplate:g)),this.addButtonAriaLabel=(0,f.composeComputation)([(0,p.toComputation)(e.addition.ariaLabel),this.addButtonLabelWithString,this.addButtonLabel],((t,e,l)=>(t||(t=e?l:i),t))),this.addButtonLabelVisible=(0,f.composeComputation)([(0,p.toComputation)(e.addition.alwaysShowLabel),this.noAddButtonLabel,(0,p.toComputation)(e.items)],((t,e,l)=>!e&&(t||!l.length))),this.addButtonLabelWithHtmlTemplate=(0,f.composeComputation)([l,this.noAddButtonLabel],((t,e)=>!e&&!!t.htmlTemplate))}}e.WidgetUIState=k;class C extends i.Widget{constructor(t,e,l,i){super(t,e,l,i),this._moreOrLessWidth=0,this._fxElementCache=ko.observableArray([]),this._theme=1===this.vm.theme?"filter":"tag";const o=t.closest(".fxc-gc");if(this._inGrid=!!o.length,this._inGrid){const e=t.closest(".fxc-gc-cell").attr("class").split(" "),l=e[MsPortalFx.findIndex(e,(t=>t.includes(x)))].slice(17);this._cacheElement=o.find(`.fxc-gc-columnheaderrow:eq(0) .fxc-gc-columnheader${l}`)[0]}else this._cacheElement=t[0];const s=()=>{this.element.trigger("calculateSize")};(0,f.subscribeAndRun)(this.ltm,[this.state.moreOrLessExpanded],s),this._assignEvents(),this._inGrid?this._containerWidth=parseInt(ko.dataFor(this._cacheElement).width()):this._containerWidth=this._getElementWidth(this.element[0]);const a=ko.unwrap(this.vm.addition.icon),c="add"+(a?a.type.toString():"")+(0,f.evaluate)(this.ltm,this.state.addButtonLabel);this._addButtonWidth=b.get(this._cacheElement,c),this._addButtonWidth||(this._addButtonWidth=this._getElementWidth(this.element.find(".fxc-pill-collection-add")[0]),b.set(this._cacheElement,c,this._addButtonWidth));const d="moreOrLessCounter123";this._moreOrLessWidth=b.get(this._cacheElement,d),this._moreOrLessWidth||(this._moreOrLessWidth=this.element.find(".fxc-pill-collection-moreOrLess").outerWidth(!0)+10,b.set(this._cacheElement,d,this._moreOrLessWidth)),this.state.showMoreOrLess(!1),this.vm.items.subscribeAndRun(this.ltm,s),(0,r.throttleByAnimationFrame)((()=>{n.track(this.ltm,this.element.first(),((t,e)=>{0!==e&&(this._containerWidth!==t||e>40)&&(this._containerWidth=t,s())}))}))()}_getElementWidth(t){return t.getBoundingClientRect().width}_addPill(){const t=this.element.find(".fxc-pill-collection-add-button")[0],e=(0,a.getOrCreateFxElement)(t,this._fxElementCache);this.vm.addition.addPill(e).then((t=>{if(t){const t=()=>{this.element.find(".fxc-pill-collection-item.fxc-base").last().children().filter(".fxc-pill").find(".fxc-pill-content").focus()};(0,d.invokeAfterChangePropagation)(t)}}))}_assignEvents(){this.$disabled.subscribeAndRun(this.ltm,(t=>{this.tabindex(t?null:0)}));const t=this.element.find(".fxc-pill-collection-add");this.ltm.registerForDispose([t.setEvents(["focusin",t=>{const e=t.relatedTarget&&$(t.relatedTarget);e&&e.hasClass(".fxc-pill-content")&&$.contains(this.element[0],t.relatedTarget)&&!e.hasClass("fxc-pill-collection-add")&&!e.hasClass("fxc-pill-close")&&this._addPill()}],["click",t=>{this._addPill(),t.stopPropagation()}],["keypress",t=>{if(13===t.which||32===t.which)return this._addPill(),!1}]),this.element.setEvents(["onRemoved",(t,e)=>{const l=$(e),i=this.vm,o=this.element.find(".fxc-pill-collection-item");let s;for(let t=0;t<o.length;t++)if(l.data("index")===o.eq(t).data("index")){s=t;break}const n=i.items()[s];this.vm.deletion.removePill(n).then((t=>{if(t){const t=i.items();if(t.length){const e=()=>{const e=s<t.length?s+1:s-1;(e===this.state.visibleItems.value.length?this.element.find(".fxc-pill-collection-item").eq(e-1).children().filter(".fxc-pill"):o.eq(e).children().filter(".fxc-pill")).find(".fxc-pill-content").focus()};(0,d.invokeAfterChangePropagation)(e)}else i.addition.canAddPill()?this.element.find(".fxc-pill-collection-add-button").focus():this.element.focus()}}))}],["calculateSize",(t,e)=>{const l=this.vm.items(),i=[],o=[];let s=this._addButtonWidth,n=s,r=!0;const a=l.map((t=>this._getWidth(t))).map(((t,e)=>({item:l[e],width:t})));a.forEach(((t,e)=>{const l=t.width+u[this._theme],c=i.length<this.vm.maxVisibleItems||this.state.moreOrLessExpanded.value;n+=l;const d=!this.vm.multipleRows&&r&&s+l<=this._containerWidth&&c,f=(this.state.moreOrLessExpanded.value||this.vm.multipleRows)&&c;if(d||f)s+=l,i.push(t.item);else{if(r&&(r=!1,s+=this._moreOrLessWidth,e>0)){const t=a[e-1].width+u[this._theme];if(s>this._containerWidth&&this._containerWidth>=this._moreOrLessWidth+this._addButtonWidth){const e=i[i.length-1];e&&(s-=t,i.pop(),o.push(e))}}o.push(t.item)}})),this.state.visibleItems(i),this.state.exceedItems(o),i.length>this.vm.maxVisibleItems||this.state.exceedItems.value.length||n>this._containerWidth&&!this.vm.multipleRows?this.state.showMoreOrLess(!0):(this.state.showMoreOrLess(!1),this.state.moreOrLessExpanded(!1))}])])}_getWidth(t){const e=t.displayText,l=e.value();let i=e.key();e.operator&&(i+=e.operator()),i+=l||"";const o=b.get(this._cacheElement,i);if(o)return o;{const e=this._measureWidth(t,i);return b.set(this._cacheElement,i,e),e}}_measureWidth(t,e){const l=$(FxImpl.createElement("div",{class:"fxc-pill-collection-item",role:"listitem","data-bind":"pcControl: $data",style:"visibility: hidden; position: absolute; display: inline-block;"}));this.element.find(`.${h}`).append(l);const i={...t,infoBalloonContent:ko.observable(),tooltip:ko.observable(),suppressDirtyBehavior:!0},o=new ko.bindingContext(i).extend({$dicontainer:this._diContainer});ko.applyBindings(o,l[0]);const s=this._getElementWidth(l[0]),n=()=>{l.children().filter(".fxc-pill").trigger("dispose"),l.remove()};return t.editMode()?setTimeout(n):n(),s}dispose(){this._checkExistsOrRegisterDestroyId(super.dispose)||(this.element.removeClass(h),super.dispose())}}e.Widget=C})),
define("_generated/Less/MsPortalImpl/Widgets/Widgets.DashboardFilters.css",["module"],(function(t){"use strict";return{css:"@keyframes tileoverlaylight{0%{background-color:transparent}100%{background-color:rgba(67,67,67,.6)}}@keyframes tileoverlaydark{0%{background-color:transparent}100%{background-color:rgba(17,17,17,.6)}}.fxs-dashboard-filtering-mode{background-color:rgba(0,0,0,.35);transition:background-color .25s}.fxs-dashboard-filtering-mode .fxs-startboard-header,.fxs-dashboard-filtering-mode .fxs-startboard-commandBar{opacity:.3}.fxs-dashboard-filtering-mode .fxs-tile.fxs-filtered-out-tile .fxs-tile-overlay{display:block;animation-fill-mode:forwards}.fxs-dashboard-filtering-mode .fxs-startboard-filter{z-index:198}.fxs-startboard-filter{padding:0 25px 0 40px}.fxs-startboard-filter .fxc-pill-collection-item:first-child{margin-left:0}.fxs-mode-light .fxs-filtered-out-tile .fxs-tile-overlay{animation:tileoverlaylight .25s}.fxs-mode-dark .fxs-filtered-out-tile .fxs-tile-overlay{animation:tileoverlaydark .25s}.fxs-startboard-filter .fxc-pill-inline-edit{margin-top:-1px}.ext-startboard-filter-relative .azc-optionPicker ul{display:grid;-ms-grid-columns:1fr 1fr;grid-template-columns:1fr 1fr}.ext-startboard-filter-relative .azc-optionPicker li{display:inline-flex!important;margin-bottom:5px!important}.ext-startboard-filter-relative .azc-optionPicker li:nth-child(n){-ms-grid-column:1}.ext-startboard-filter-relative .azc-optionPicker li:nth-child(2n){-ms-grid-column:2}.ext-startboard-filter-relative .azc-optionPicker li:nth-child(1),.ext-startboard-filter-relative .azc-optionPicker li:nth-child(2){-ms-grid-row:1}.ext-startboard-filter-relative .azc-optionPicker li:nth-child(3),.ext-startboard-filter-relative .azc-optionPicker li:nth-child(4){-ms-grid-row:2}.ext-startboard-filter-relative .azc-optionPicker li:nth-child(5),.ext-startboard-filter-relative .azc-optionPicker li:nth-child(6){-ms-grid-row:3}.ext-startboard-filter-relative .azc-optionPicker li:nth-child(7),.ext-startboard-filter-relative .azc-optionPicker li:nth-child(8){-ms-grid-row:4}.ext-startboard-filter-relative .azc-optionPicker li:nth-child(9),.ext-startboard-filter-relative .azc-optionPicker li:nth-child(10){-ms-grid-row:5}.ext-startboard-filter-editor{display:flex;flex-direction:row;flex:0 0 auto}.ext-startboard-filter-id{display:block;margin-right:5px}.ext-startboard-filter-value{display:block;margin-left:5px;min-width:120px}.ext-startboard-filter-operation{display:block}.fxs-startboard-filters-pills{display:flex;flex-wrap:wrap;align-items:center;width:100%}.fxs-startboard-filters-pills .fxc-pill-content-key{flex:0 0 auto}.fxs-startboard-filters-pills .fxc-pill-content-value{max-width:120px}.fxs-startboard-filters-pills .fxs-startboard-refreshlabel{flex:0 0 auto;margin-left:auto}.ext-startboard-filter-wrap{max-width:280px;max-height:45vh;overflow:auto;font-size:13px;line-height:1.385}.ext-startboard-filter-wrap .ext-startboard-filter-timePicker{margin:15px 0}.ext-startboard-filter-start,.ext-startboard-filter-end{width:230px}.ext-startboard-filter-start,.ext-startboard-filter-end,.ext-startboard-filter-zone{margin-top:8px}",moduleId:t.id}})),
define("MsPortalImpl/Widgets/Widgets.DashboardFilters",["require","exports","MsPortalImpl/Controls/Controls.Pill","MsPortalImpl/Controls/Controls.PillCollection","Fx/Controls/InfoBox","Fx/Controls/Pill","Fx/Controls/PillCollection","Fx/Controls/RadioButtons","Fx/Controls/TextBlock","Fx","FxInternal/Composition/DashboardFilters","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/UI/Dashboard/DashboardFilterTransformHelper","MsPortalImpl/UI/Dashboard/AutoRefresh","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/Widgets.DashboardFilters.css"],(function(t,e,l,i,o,s,n,r,a,c,d,f,p,h,x,m,g){"use strict";e.Widget=void 0;var u=MsPortalFx.Base.Diagnostics.Telemetry;(0,m.injectCss)(g);const b=f.DashboardFilters,v=f.Dashboard.AutoRefresh;function k(t,e){u.trace({source:"DashboardFilters",action:t,data:e})}class C extends p.Widget{constructor(t,e,l){super(t.find(".fxs-startboard-filter"),e),this._diContainer=l,this._filterPillCollection=ko.observableArray([]),this._getEditingUi=(0,c.memoizePromise)((()=>Promise.all([MsPortalFx.require("MsPortalImpl/Widgets/Widgets.DashboardFilters.Editing"),this._filtersWidgetViewModel.getFilterUpdatingApi()]).then((([t,e])=>new t.EditingImpl(this._filtersWidgetViewModel.appliedFilters,e))))),this._filtersWidgetViewModel=e,this.element.html('<div class="fxs-startboard-filters-pills fxs-hide-in-customize">\n    <div data-bind="pcControl: pillList"></div>\n    <div class="fxs-startboard-refreshlabel az-noprint" data-bind="pcControl: lastUpdated"></div>\n</div>');const i=function(t,e){const l=t.get(x.AutoRefresh),i=ko.computed(e,(()=>{const t=new Date(l.lastUpdate());return v.lastUpdated.format(t.toRelativeString())})),o=setInterval((()=>{l.lastUpdate.valueHasMutated()}),6e4);return e.registerForDispose((()=>clearInterval(o))),a.create(e,{text:i,visible:(0,c.isFeatureEnabled)("dashboardautorefresh")})}(this._diContainer,this.ltm),o=new ko.bindingContext({pillList:this._setupPillCollection(),lastUpdated:i}).extend({$dicontainer:this._diContainer});ko.applyBindings(o,this.element.find(".fxs-startboard-filters-pills")[0])}_updatePillsCollection(){const t=this._filtersWidgetViewModel.appliedFilters().map((t=>this._createPill(t)));(0,c.isFeatureEnabled)("dashboardautorefresh")&&t.unshift(function(t,e){const l=t.get(x.AutoRefresh),i=l.interval,n=[{text:v.off,value:0},{text:v.fiveMin,value:5},{text:v.tenMin,value:10},{text:v.fifteenMin,value:15},{text:v.thirtyMin,value:30},{text:v.oneHour,value:60},{text:v.twoHours,value:120},{text:v.fourHours,value:240},{text:v.day,value:1440}],a=[];for(const t of n)a[t.value]=t.text.toString();return s.create(e.ltm,{ariaLabel:v.label,getKeyText:()=>v.label,getValueText:t=>a[t],getOperatorText:()=>":",value:i,showRemoveButton:!1,createEditor:()=>{const t="<div data-bind='pcControl: info'></div><div data-bind='pcControl: options'></div>",s=o.create(e.ltm,{style:1,text:v.description,visible:l.isShared}),a=r.create(e.ltm,{label:v.optionsLabel,items:n,singleItemPerLine:!0,value:ko.observable(i())}),c={info:s,options:a};return{title:v.label,onEditModeExited:()=>Promise.resolve(a.value()),buttons:[{button:4,displayText:b.apply},{button:1,displayText:b.cancel}],content:{htmlTemplate:t,viewModel:c},telemetryName:"AutoRefreshInterval"}}})}(this._diContainer,this)),this._filterPillCollection(t)}_setupPillCollection(){return ko.reactor(this.ltm,this._filtersWidgetViewModel.appliedFilters,(t=>{this._updatePillsCollection()})),n.create(this.ltm,{items:this._filterPillCollection,addition:{canAddPill:ko.computed(this.ltm,(()=>this._filtersWidgetViewModel.showAddFilterUi())),label:b.addFilter,addPill:()=>(k("DashboardFiltersAdd",{}),this._createPill(this._filtersWidgetViewModel.createDashboardFilterViewmodel(),!0,!0))}})}_createPill(t,e=!1,l=!1){const i=this.ltm.createChildLifetime(),o=0===t.kind(),n=s.create(i,{ariaLabel:t.filterIdDisplayText,value:ko.computed(this.ltm,{read:()=>(ko.unwrap(t.model),ko.unwrap(t.id),ko.unwrap(t.kind),t),write:t=>{}}),getKeyText:()=>t.filterIdDisplayText,getOperatorText:()=>{if(l)return"";if(o)return":";const e=(0,h.getDenormalizedOperatorForWidget)(t.model());return d.operatorStrings[e]},getValueText:()=>t.filterValueDisplayText,onRemoved:()=>{i.dispose();const e=t.id();this._filtersWidgetViewModel.getFilterUpdatingApi().then((l=>{l.exitEditMode(),k("DashboardFiltersRemoved",e);const i=t.model();l.removeFilter(e,i&&i.operator)}))},editMode:ko.observable(e),showRemoveButton:!o,createEditor:e=>o?this._getEditingUi().then((l=>l.createDialogEditor(e,t))):this._getEditingUi().then((i=>i.createEditor(e,t,(()=>this._updatePillsCollection()),l)))});return ko.reactor(this.ltm,[t.id,t.model,t.isApplicable,t.warningMessage],((e,i,s,r)=>{if(l)return"";let a;if(n.readOnly(!s),n.showRemoveButton(!o||!s),s){const e=(0,h.getDenormalizedOperatorForWidget)(t.model()),l=o?":":d.operatorStrings[e];a=r||`${t.filterIdDisplayText} ${l} ${t.filterValueDisplayText}`}else a=f.Filtering.invalid;n.infoBalloonContent(a),n.icon(r?MsPortalFx.Base.Images.StatusBadge.Warning():null)})),n}}e.Widget=C}));