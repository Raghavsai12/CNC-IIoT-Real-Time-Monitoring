define("MsPortalImpl/Controls/Controls.Essentials.Component",["require","exports","Weave/DirectMode","Weave","MsPortalImpl/Resources/ImplScriptResources","_generated/MsPortalImpl/Svg/Library/Loading/EllipsisSquare.svg","MsPortalImpl/Base/Base.KnockoutExtensions.Copy","FxInternal/Weave/Util","MsPortalImpl/Weave/Util","FxInternal/Weave","MsPortalImpl/Weave/LazyControls","MsPortalImpl/Weave/Components"],(function(e,t,s,i,a,n,o,l,r,c,d,u){"use strict";t.widgetViewAllButtonClass=t.widgetLabelContainerRightClass=t.widgetLabelContainerLeftClass=t.widgetLabelContainerClass=t.widgetLabelClass=t.widgetItemValueWrapperClass=t.widgetItemValueIconClass=t.widgetItemValueContainerHasIconClass=t.widgetItemValueContainerClass=t.widgetItemValueClass=t.widgetItemLoadingClass=t.widgetItemLabelSplitterClass=t.widgetItemItemValueContainerRightClass=t.widgetItemItemValueContainerLeftClass=t.widgetItemItemValueContainerClass=t.widgetItemEmptyClass=t.widgetItemClass=t.widgetInvisibleClass=t.widgetExpandButtonClass=t.widgetEditTagClass=t.widgetColumnContainerClass=t.widgetColumnClass=t.widgetCollapseButtonClass=t.widgetAccordionHeaderClass=t.widgetAccordionButtonClass=t.portalTextClass=t.fxPrimaryTextClass=t.EssentialsInner=void 0;const p=t.widgetAccordionButtonClass="fxc-essentials-accordion-toggle",h=t.widgetAccordionHeaderClass="fxc-essentials-accordion-title",m=t.widgetExpandButtonClass="fxc-essentials-expand-button",f=(t.widgetCollapseButtonClass="fxc-essentials-collapse-button",t.widgetColumnClass="fxc-essentials-column"),g=t.widgetColumnContainerClass="fxc-essentials-column-container",x=t.widgetItemClass="fxc-essentials-item",b=t.widgetItemLoadingClass="fxc-essentials-item-loading",v=t.widgetItemEmptyClass="fxc-essentials-item-empty",C=t.widgetLabelContainerClass="fxc-essentials-label-container",I=t.widgetLabelContainerLeftClass="fxc-essentials-label-container-left",w=t.widgetLabelContainerRightClass="fxc-essentials-label-container-right",y=t.widgetItemItemValueContainerClass="fxc-essentials-item-value-container",k=t.widgetItemItemValueContainerLeftClass="fxc-essentials-item-value-container-left",_=t.widgetItemItemValueContainerRightClass="fxc-essentials-item-value-container-right",D=t.widgetLabelClass="fxc-essentials-label",E=t.widgetItemValueWrapperClass="fxc-essentials-value-wrapper",L=t.widgetItemValueContainerClass="fxc-essentials-value-container",P=t.widgetItemValueContainerHasIconClass="fxc-essentials-value-container-has-icon",T=t.widgetItemValueClass="fxc-essentials-value",M=t.widgetItemValueIconClass="fxc-essentials-value-icon",F=t.widgetViewAllButtonClass="fxc-essentials-viewall-button",B=t.widgetItemLabelSplitterClass="fxc-essentials-item-label-splitter",N=t.portalTextClass="fxs-portal-text",R=t.fxPrimaryTextClass="msportalfx-text-primary",S=t.widgetEditTagClass="fxc-essentials-edittag",A=t.widgetInvisibleClass="fxs-display-none",O=a.Controls.Essentials;let V=0;const W=()=>"_essentials_"+V++;function $(e,t,a,n,o){const r=W(),d=W(),u=t.lines;return s(i.If,{condition:(0,c.toComputation)(t.visible,l.trueComputation),concealmentBehavior:"remove",trueFn:()=>s("div",{className:x,"aria-labelledby":r,"data-side":e},s("div",{className:[C,"left"===e?I:w]},s("label",{className:[D,"fxs-portal-subtext"],id:r,title:t.label},t.label),t.movableLabelExists?s("span",{role:"presentation",className:"fxc-essentials-move"},"(",s("button",{role:"link",className:[R,"fxc-essentials-move-button",{"fxc-disabled":a.disabled}],fxclick:t.movableOnClick,id:d,"aria-labelledby":[r,d].join(" "),"aria-disabled":a.disabled,tabindex:a.tabIndex},t.movableLabel),")"):null),s("div",{className:[B,{[A]:o}]},":"),s("div",{className:E},u?u.map((s=>z(n,s,a,e,r,t.label))):z(n,t,a,e,r,t.label)))})}function z(e,t,a,l,r,d){const u=(0,c.toComputation)(t.icon),p=(0,i.composeComputation)([u],(e=>e&&e.image)),h=(0,i.composeComputation)([u],(e=>e&&e.position)),m=(0,c.toComputation)(t.loading),f=(0,c.toComputation)(t.valueExists);return s("div",{className:[y,"left"===l?k:_,{[P]:p}]},s(i.If,{condition:(0,c.toComputation)(t.loading),concealmentBehavior:"remove",trueFn:()=>s("div",{className:[b,N],image:n})}),s(i.If,{condition:(0,i.composeComputation)([m,f],((e,t)=>!e&&!t)),concealmentBehavior:"remove",trueFn:()=>s("div",{className:[v,T,N],"aria-label":'"---"',"aria-describedby":e.descId},"---")}),s("div",{className:[L,{[A]:(0,i.composeComputation)([m,f],((e,t)=>e||!t))}]},j(h,p,0),function(e,t,a,n,l){const r=W(),d=(t,s)=>{(0,i.subscribeAndRun)(s,[(0,c.toComputation)(e.loading),(0,c.toComputation)(e.valueExists)],((i,a)=>{if(!i&&a){const i=e.value;(0,o.initializeCopyBinding)(t.parentElement,i,{hideTextbox:!0,ariaLabel:ko.computed(s,i,(e=>l+" "+e))},s)}}))},u=(0,c.toComputation)(e.value);switch(e.type){case 4:case 5:return s("a",{className:[G,{"fxc-disabled":a.disabled}],fxclick:e.onClick&&ko.isObservable(e.onClick)?(0,c.toComputation)(e.onClick):e.onClick,id:r,"aria-labelledby":r,"aria-disabled":a.disabled,tabindex:a.tabIndex,"aria-describedby":n,title:u,afterMount:d},u);case 3:return s("button",{className:[G,{"fxc-disabled":a.disabled},{"fxs-essentials-item-disabled-button":a.disabled}],fxclick:e.onClick,id:r,"aria-labelledby":r,"aria-disabled":a.disabled,tabindex:a.tabIndex,"aria-describedby":n,title:u,afterMount:d},u);case 2:return s("a",{className:[G,{"fxc-disabled":a.disabled}],href:"#",fxclick:e.onClick,id:r,"aria-labelledby":r,"aria-disabled":a.disabled,tabindex:a.tabIndex,"aria-describedby":n,title:u,afterMount:d},u);case 1:return s("div",{className:[T,N,{"fxc-disabled":a.disabled}],"aria-label":u,"aria-describedby":n,title:u,afterMount:d},u);default:return null}}(t,0,a,r,d),j(h,p,1)))}t.EssentialsInner=t=>{const{vm:a,state:o}=t,v=(0,c.toComputation)(a.expanded),w=v.compose(l.negation),y=o.spreadOutLayout.compose(l.negation);return s(i.GetContext,{fn:t=>{const k=(0,r.aggregateContext)(t,a,o),{disabled:_,tabIndex:E}=k;return s(i.SetContext,{disabled:_,tabIndex:E},s("div",{className:"fxc-essentials-container fxs-portal-border"},s("div",{className:["fxc-essentials-accordion","fxs-portal-hover"]},s("h3",{className:[h]},s("button",{"aria-label":O.essentials,"aria-controls":o.controlId,className:[m,"fxs-portal-hover",p],"aria-disabled":_,disabled:_,tabindex:E,"aria-expanded":v},s("div",{className:["fxc-essentials-expand-icon","fxs-portal-svg",{"fxt-essentials-expand-svg":v,"fxt-essentials-collapse-svg":w}]},s(u.ShellHtml,{content:o.collapseIcon.data,skipSanitization:!0,require:e})),s("div",{className:["fxs-portal-text","fxc-essentials-accordion-text"]},O.essentials))),s("div",{className:"fxc-essentials-cost-and-json"},MsPortalFx.isFeatureEnabled("essentialschangesview")?s("a",{href:"#",className:["fxs-portal-border","fxc-essentials-resourcechanges-text"]},O.viewChanges):null,MsPortalFx.isFeatureEnabled("essentialscostview")?s("a",{href:"#",className:["fxs-portal-border","fxc-essentials-costview-text"]},O.costInformation):null,MsPortalFx.isFeatureEnabled("essentialsjsonview")?s("a",{href:"#",className:["fxc-essentials-jsonview-text"]},O.resourceInformation):null)),s("div",{id:o.controlId,className:[g,{[A]:w}],"aria-label":O.listProps},s("div",{id:o.descId,"aria-hidden":"true",className:"fxs-hide-accessible-label"},window.navigator.platform.includes("Mac")?O.Copy.mac:O.Copy.win),s("div",{"aria-live":"polite","aria-atomic":"true",className:"fxs-hide-accessible-label"},o.copyTextAriaLive),s("div",{className:f,"data-side":"left"},s(i.ForEach,{collection:o.leftItems,fn:({item:e})=>$("left",e,k,o,y)})),s("div",{className:f,"data-side":"right"},s(i.ForEach,{collection:o.rightItems,fn:({item:e})=>$("right",e,k,o,y)}))),s(i.If,{condition:o.showTags,concealmentBehavior:"remove",trueFn:()=>s("div",{className:["fxc-essentials-tags-container",{[A]:w}]},function(e,t,a,o){const r=e.options;let u;u=ko.isObservable(r.hiddenChangeLink)?!(!r.hiddenChangeLink||!~r.hiddenChangeLink().indexOf(6)):!(!r.hiddenChangeLink||!~r.hiddenChangeLink.indexOf(6));const p=W(),h=W();return s("div",{className:x,tabindex:"-1"},s("div",{className:[C,I]},s("label",{className:[D,"fxs-portal-subtext"],id:p},O.tags),u?null:s("span",{role:"presentation",className:"fxc-essentials-move"},"(",s("button",{role:"link",className:[R,S,{"fxc-disabled":a.disabled}],id:h,"aria-labelledby":[p,h].join(" "),"aria-disabled":a.disabled,tabindex:a.tabIndex},O.editTags),")")),s("div",{className:[B,{[A]:o}]},":"),s("div",{className:[b,N,{[A]:(0,c.toComputation)(t.fetchingResourceData).compose(l.negation)}],image:n}),s(i.If,{condition:t.noTags,concealmentBehavior:"remove",trueFn:()=>s("button",{className:[R,"fxc-essentials-notags-button",S,{[A]:(0,c.toComputation)(t.fetchingResourceData),"fxc-disabled":a.disabled}],"aria-disabled":a.disabled,tabindex:a.tabIndex},O.noTagsLabel),falseFn:()=>s(d.LazyPillCollection,{className:["fxc-essentials-tags-list",{[A]:(0,c.toComputation)(t.fetchingResourceData)}],vm:t.tagsPillList})}))}(a,o,k,y))}),s("div",{className:["fxc-essentials-viewall-button-container",{[A]:(0,i.composeComputation)([v,o.showViewAllButton],((e,t)=>!e||!t))}]},s("button",{className:["msportalfx-text-primary",F,{"fxc-disabled":_}],role:"button","aria-controls":o.controlId,"aria-disabled":_,"aria-expanded":o.viewAll,tabindex:E},o.viewAllSwitchText))))}})};const G=[R,T,N];function j(e,t,a){const n=`${M} ${M}-${0===a||3===a?"left":"right"}`;return s(i.If,{condition:(0,i.composeComputation)([e,t],((e,t)=>t&&e===a)),concealmentBehavior:"remove",trueFn:()=>s("span",{className:n,image:t})})}})),
define("_generated/Less/MsPortalImpl/Controls/Controls.Essentials.css",["module"],(function(e){"use strict";return{css:'.fxc-essentials{flex:0 0 auto}.fxc-essentials .fxc-disabled{pointer-events:none;cursor:default}.fxc-essentials .msportalfx-text-primary{padding:0;border:0;cursor:pointer}.fxc-essentials-cost-and-json{display:flex;flex-direction:row}.fxs-highcontrast-light button:focus .msportalfx-svg-c05{fill:white}.fxs-highcontrast-dark button:focus .msportalfx-svg-c05{fill:black}.fxc-essentials-jsonview-text,.fxc-essentials-costview-text,.fxc-essentials-resourcechanges-text{margin-left:auto;white-space:nowrap;padding-left:10px;cursor:pointer;width:max-content}.fxc-essentials-jsonview-text{padding-right:10px}.fxc-essentials-costview-text::after,.fxc-essentials-resourcechanges-text::after{content:"";height:16px;width:1px;padding-left:10px;border-right-style:solid;border-right-width:1px;border-right-color:inherit}.fxc-essentials-container{position:relative}.fxc-essentials-container::after{content:"";display:block;margin-left:20px;margin-right:20px;border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:inherit}.fxc-essentials-border{padding-top:22px;border-bottom-width:1px;border-bottom-style:solid;margin:0 20px}.fxc-essentials-accordion{height:28px;line-height:28px;box-sizing:border-box;margin:0 20px;display:flex;flex-direction:row}.fxc-essentials-accordion-title{width:100%;height:100%;margin:0}.fxc-essentials-accordion-text{float:left;margin-left:5px;margin-right:auto}.fxc-essentials-expand-icon{display:grid;width:8px;height:8px;padding:5px}.fxt-essentials-expand-svg{transform:rotate(-90deg)}.fxt-essentials-collapse-svg{transform:rotate(90deg)}.fxc-essentials-expand-button{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;width:100%;height:100%;background:transparent;border:0;padding:0;margin:0;display:flex;align-items:center;font-size:13px;font-weight:600}.fxc-essentials-collapse-button{cursor:pointer;width:calc(100% - 40px);height:28px;border:0;padding:0;margin:0 20px;display:block;position:absolute;bottom:1px;left:0;right:0}.fxc-essentials-column-container{padding-top:4px;width:100%}.fxc-essentials-column-container::after{content:" ";clear:both;display:block}.fxc-essentials-column{box-sizing:border-box;float:left;width:50%}.fxc-essentials-column[data-side="left"] .fxc-essentials-item,.fxc-essentials-column[data-side="right"] .fxc-essentials-item{clear:both}.fxc-essentials-item{box-sizing:border-box;padding:4px 10px;margin:0 10px}.fxc-essentials-item .msportalfx-text-primary{text-decoration:underline}.fxc-essentials-item .fxc-copyablelabel-textbox .azc-input{font-size:13px;height:18px;line-height:18px}.fxc-essentials-item .fxs-copyfield-wrapper{height:100%}.fxc-essentials-item-loading{display:inline-block;width:18px;height:18px}.fxc-essentials-label-container .msportalfx-text-primary{display:inline;font-size:inherit;overflow:hidden;text-overflow:ellipsis}.fxc-essentials-label{font-size:13px;line-height:18px;text-overflow:ellipsis;overflow:hidden}.fxc-essentials-move{display:inline-block;margin-left:4px;font-size:13px;line-height:18px}.fxc-essentials-move-button{line-height:18px}.fxc-essentials-item-value-container{height:18px;padding-top:4px}.fxc-essentials-item-value-container:first-child{padding-top:0}.fxc-essentials-value-container{position:relative;height:18px;padding-right:25px;display:inline-flex;max-width:100%;box-sizing:border-box}.fxc-essentials-value-container.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield{width:24px}.fxc-essentials-value{white-space:nowrap;overflow:hidden;font-size:13px;height:18px;line-height:18px;display:inline-block;text-overflow:ellipsis;text-align:left;max-width:100%}.fxc-essentials-value-icon{display:inline-block;width:18px;height:18px}.fxc-essentials-value-icon-left{margin-right:4px}.fxc-essentials-value-icon-right{margin-left:4px}.fxc-essentials-notags-button{height:18px;white-space:nowrap}.fxc-essentials-tags-container{padding-top:5px}.fxc-essentials-tags-list{margin-top:2px;margin-left:-5px;width:auto;flex:1 0 auto}.fxc-essentials-viewall-button-container{clear:both;float:none;height:20px;padding:10px 10px 0;margin:0 10px}.fxc-essentials-viewall-button{font-size:13px}.fxc-essentials-viewall-button:hover{text-decoration:underline}.fxc-essentials-spread-out .fxc-essentials-item{display:flex;padding:5px 15px}.fxc-essentials-spread-out .fxc-essentials-label-container{flex:0 0 auto;white-space:nowrap;text-overflow:ellipsis;display:inline-flex;overflow:hidden}.fxc-essentials-spread-out .fxc-essentials-item-label-splitter{flex:0 0 15px;text-align:center}.fxc-essentials-spread-out .fxc-essentials-value-wrapper{flex:1 0 auto;max-width:100%}.fxc-essentials-spread-out .fxc-essentials-viewall-button-container{padding:10px 15px 0}.fxc-essentials-spread-out .fxc-essentials-tags-list{margin-top:0}.fxc-essentials-spread-out .fxc-essentials-tags-container .fxc-essentials-label-container,.fxc-essentials-spread-out .fxc-essentials-tags-container .fxc-essentials-item-label-splitter,.fxc-essentials-spread-out .fxc-essentials-tags-container .fxc-essentials-notags-button{margin-top:5px}.fxc-essentials-spread-out .fxc-essentials-tags-container .fxc-essentials-item{padding-top:0}',moduleId:e.id}})),
define("_generated/MsPortalImpl/Svg/Library/Controls/Chevron.svg",["require","exports"],(function(e,t){"use strict";t.type=t.data=void 0;t.type=1,t.data="<svg viewBox='0 0 11 17' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M2.414 17 1 15.586l7.071-7.071L1 1.443 2.414.029l8.485 8.486z' class='msportalfx-svg-c05'/></g></svg>"})),
define("MsPortalImpl/Controls/Controls.Essentials",["require","exports","MsPortalImpl/Base/Base.KnockoutExtensions.Copy","Fx/Controls/Pill","Fx/Controls/PillCollection","Fx/Experimentation","Fx/ResourceManagement","MsPortalImpl.Controls/Controls/Base/ViewModelBase","MsPortalImpl.Controls/Controls/ResourceFilterHelper","FxInternal/Controls/Essentials","Viva.Controls/Util/Viva.Resize","MsPortalImpl/Base/Base.FeatureDetection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.ArmIdHelpers","_generated/MsPortalImpl/Svg/Library/Controls/Chevron.svg","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Services/Services.ProjectedDirectories","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl/Controls/Controls.Essentials.Component","Weave/Core/Computation","FxInternal/Css","_generated/Less/MsPortalImpl/Controls/Controls.Essentials.css","MsPortalImpl/Base/Base.Selectable2","FxInternal/Weave","Weave","Fx","FxInternal/Utils/Promise","Fx/Ajax","MsPortalImpl/UI/UI.BladeOpener","Fx/Notifications","Fx/Composition/Selectable"],(function(e,t,s,i,a,n,o,l,r,c,d,u,p,h,m,f,g,x,b,v,C,I,w,y,k,_,D,E,L,P,T,M){"use strict";t.WidgetUIState=t.Widget=t.InnerTsxComponent=void 0,(0,I.injectCss)(w);var F=MsPortalFx.Base,B=F.Diagnostics.Telemetry.Context;const N=window,R=1007,S=155,A=105,O="fxc-essentials",V="fxc-essentials-spread-out",W=p.Controls.Essentials,z=p.ResourceFilter.Directory.unknownText,G=new F.Diagnostics.Log("MsPortalImpl/Controls/Controls.Essentials");const j=(0,D.memoizePromise)((e=>(0,r.getLocations)().then((t=>{const s=(e.location||"").toLowerCase();return(MsPortalFx.find(t,(e=>e.name.toLowerCase()===s))||{}).displayName||e.location}))));t.InnerTsxComponent=v.EssentialsInner;class U extends b.WidgetUIState{constructor(e){super(),this.collapseIcon=F.Images.CustomImageWithOptions(m,{}),this.viewAll=(0,_.makeWritableComputation)(!1),this.viewAllSwitchText=this.viewAll.compose((e=>e?W.seeLess:W.seeMore)),this.showTags=(0,_.makeWritableComputation)(!1),this.copyTextAriaLive=(0,_.makeWritableComputation)(""),this.showViewAllButton=(0,_.makeWritableComputation)(!1),this.softDeleteInfo=(0,_.makeWritableComputation)(null),this.softDeleteLoaded=ko.observable(!0),this.leftItems=(0,_.makeWritableComputation)(),this.rightItems=(0,_.makeWritableComputation)(),this.noTags=(0,_.makeWritableComputation)(!0),this.fetchingResourceData=ko.observable(!1),this.spreadOutLayout=(0,_.makeWritableComputation)(!1),this.controlId=(0,D.getUniqueId)(),this.descId=`${this.controlId}-desc`;const t=e.vm.options;if(t.resourceId){this.tagsPillList=a.create(this._ltm,{multipleRows:!1,theme:2,ariaLabel:W.tags,items:[]});const e=t.hiddenBuiltInTypes&&t.hiddenBuiltInTypes.includes(6);this.showTags(t.includeTags&&!e)}}}function H(e,t,s,i){F.Diagnostics.Telemetry.trace({source:"Essentials",action:e,name:t,data:s,actionModifier:i})}t.WidgetUIState=U;class K extends l.Widget{constructor(e,t,s,i){super(e,t,s,i),this._staticItems={left:[],right:[]},this._events=[],this._lastKnownContainerWidth=0,this._armData={resourceGroup:{value:ko.observable(null),movableOnClick:ko.observable(MsPortalFx.noop),onClick:{resourceId:ko.observable(null),onLinkOpened:()=>{H("EssentialsClick","ResourceGroup",{bladeInstance:this._bladeInstanceId(),resourceId:this.vm.options.resourceId||""})}}},status:{value:ko.observable(null)},location:{value:ko.observable(null),movableOnClick:ko.observable(MsPortalFx.noop),onClickBladeLink:ko.observable(null)},subscriptionName:{value:ko.observable(null),movableOnClick:ko.observable(MsPortalFx.noop),onClick:{resourceId:ko.observable(null),onLinkOpened:()=>{H("EssentialsClick","Subscription",{bladeInstance:this._bladeInstanceId(),resourceId:this.vm.options.resourceId||""})}}},subscriptionId:{value:ko.observable(null)},directoryName:{value:ko.observable(null)},directoryId:{value:ko.observable(null)}},this._softDeleteValue=ko.observable(null),this._showTenantInfo=ko.observable(!1),this._bladeInstanceId=ko.observable(""),this._vivaResizeTracked=!1,i=this.state;const a=this.vm,o=a.options;this._showSoftDeleteFeature=this._diContainer.get(n.Experimentation).shellAssignments.getBooleanValue("softdeleteenabled")??!1;const l=(0,D.isFeatureEnabled)("essentialsjsonview")?this.element.find(".fxc-essentials-jsonview-text").get(0):null,r=(0,D.isFeatureEnabled)("essentialscostview")?this.element.find(".fxc-essentials-costview-text").get(0):null,c=(0,D.isFeatureEnabled)("essentialschangesview")?this.element.find(".fxc-essentials-resourcechanges-text").get(0):null,d=o.resourceId;if(this._bladeInstanceId(B.getBladeContext()?B.getBladeContext().instanceId:null),d){let t,n;if(this._processAndRender(),(0,D.isFeatureEnabled)("msptitle")){const{diContainer:e}=s;t=F.Promises.cancelOnDispose(this.ltm,Promise.all([e.getAsync(g.ServicesProjectedDirectories).then((e=>e.getDirectoryByResourceId(d))),e.getAsync(f.AuthStateManager).then((e=>e.getUserInfo()))]).then((([e,t])=>{if(!e||e.id!==t.directoryId)return this._showTenantInfo(!0),e?{directoryName:e.displayName,directoryId:e.id}:{directoryId:""}})))}const u=this.vm.options;u?.resourceId&&u?.showSoftDelete&&this._showSoftDeleteFeature&&(n=this._getSoftDeleteInfoApi(u.resourceId)),this.areHideChangeLinksObservable(o.hiddenChangeLink)&&o.hiddenChangeLink.subscribeAndRun(this.ltm,(e=>{o.hiddenChangeLink=e,this._processAndRender()})),a.resource.subscribeAndRun(this.ltm,(o=>{i.fetchingResourceData(!0);const u=o?this._getResourceInfo(o):null,p=(0,E.tryImmediateResolveValue)(u,(e=>e||a.options.skipResourceFetching?e:a.getResourceInfo(i.showTags.value))),h=Promise.all([p,t||Promise.resolve(null),n??Promise.resolve(null)]).then((([e,t,s])=>(s&&(this._softDeleteInfo=s),e&&t?MsPortalFx.extend(e,t):e))).then((e=>{this.resourceData=e,i.fetchingResourceData(!1),i.softDeleteLoaded(!1),this._processItems(),this._processTags(),F.Promises.cancelOnDispose(this.ltm,h)}));if((0,D.isFeatureEnabled)("essentialschangesview")){const t=(0,y.getFxClickSelectable)(s.diContainer,this.ltm,e,"fxClick","fxClickID");$(c).on("click",(e=>{e.preventDefault(),e.stopPropagation(),t.openBlade(new M.PdlBladeReference("ChangeDetailsTemplateBladeV2","Microsoft_Azure_ChangeAnalysis",{parameters:{resourceId:d,deepLinkOrigin:"ResourceEssentials"}})),t.invokeClick(this.vm,(()=>{}),e)}))}if((0,D.isFeatureEnabled)("essentialsjsonview")){const t=new M.PdlBladeReference("EssentialsResourceBlade","HubsExtension",{parameters:{resourceId:d}}),i=(0,y.getFxClickSelectable)(s.diContainer,this.ltm,e,"fxClick","fxClickID");$(l).on("click",(e=>{e.preventDefault(),e.stopPropagation(),H("EssentialsClick","Json",{bladeInstance:this._bladeInstanceId(),resourceId:this.vm.options.resourceId||"",accordionState:this.vm.expanded()?"Expanded":"Collapsed"}),i.openContextPane(t),i.invokeClick(this.vm,(()=>{}),e)}))}if((0,D.isFeatureEnabled)("essentialscostview")){const t=new M.PdlBladeReference("CostAnalysis","Microsoft_Azure_CostManagement",{parameters:{scope:d}});$(r).on("click",(i=>{if(i.preventDefault(),i.stopPropagation(),H("EssentialsClick","Cost",{bladeInstance:this._bladeInstanceId(),resourceId:this.vm.options.resourceId||"",accordionState:this.vm.expanded()?"Expanded":"Collapsed"}),a.containerHasMenu&&(0,D.isFeatureEnabled)("essentialscostinmenuview"))a.openBladeInMenuContext(t);else{const a=(0,y.getFxClickSelectable)(s.diContainer,this.ltm,e,"fxClick","fxClickID");a.openBlade(t),a.invokeClick(this.vm,(()=>{}),i)}}))}a.newTags.subscribe(this.ltm,(e=>{this._processTags(e)}))}))}else(0,D.isFeatureEnabled)("essentialschangesview")&&(c.style.display="none"),(0,D.isFeatureEnabled)("essentialsjsonview")&&(l.style.display="none"),(0,D.isFeatureEnabled)("essentialscostview")&&(r.style.display="none"),this._processAndRender()}areHideChangeLinksObservable(e){return ko.isObservable(e)}toggleColumnContainerVisibility(){this.element.find(`.${v.widgetColumnContainerClass}`).toggleClass(v.widgetInvisibleClass)}_getColumnLabelMaxWidth(e){const t=this.element.find(`.${v.widgetColumnClass}[data-side='${e}']`);let s=!1;this.element.find(`.${v.widgetColumnContainerClass}`).hasClass(v.widgetInvisibleClass)&&(s=!0,this.toggleColumnContainerVisibility());const i=t.find(`.${v.widgetLabelContainerClass}`);let a=0;return i.each((function(e,t){const s=$(t).children();let i=s[0].getBoundingClientRect().width;s.length>1&&(i+=s[1].getBoundingClientRect().width+4),i=Math.ceil(i),i>a&&(a=i)})),s&&this.toggleColumnContainerVisibility(),a>=S?S:a}_spreadLayoutProcess(e){let t;t=e||this.element[0].getBoundingClientRect().width;const s=this.state;t-=(0,u.getScrollbarWidth)(),this._lastKnownContainerWidth=t;const i=t/2,a=this.element.find(`.${v.widgetLabelContainerLeftClass}`),n=this.element.find(`.${v.widgetLabelContainerRightClass}`),o=this.element.find(`.${v.widgetItemItemValueContainerLeftClass}`),l=this.element.find(`.${v.widgetItemItemValueContainerRightClass}`),r=this.element.find(`.${v.widgetColumnContainerClass}`),c=this.element.find(".fxc-essentials-column"),d=this.element.find(".fxc-essentials-tags-container"),p=this.element.find(".fxc-essentials-tags-list");if(c.css("width","50%"),t>=R){r.css("display","block"),a.css("width","100%"),n.css("width","100%"),o.css("width","100%"),l.css("width","100%");const e=this._getColumnLabelMaxWidth("left"),t=this._getColumnLabelMaxWidth("right"),c=A/2,d=Math.floor(i-e-c),u=Math.floor(i-t-c);this.element.addClass(V),a.css("width",`${e}px`),n.css("width",`${t}px`),o.css("width",`${d}px`),l.css("width",`${u}px`),s.spreadOutLayout(!0)}else this.element.removeClass(V),r.css("display","block"),a.css("width","100%"),n.css("width","100%"),o.css("width","100%"),l.css("width","100%"),s.spreadOutLayout(!1),t<623&&(r.css("display","flex"),r.css("flex-direction","column"),t>=463?(this.element.addClass(V),s.spreadOutLayout(!0),d.css("width","50%")):c.css("width","100%"));p.width(o.width())}itemTypeDetector(e){const t=ko.unwrap(e.onClick),s=typeof t;if("function"===s)return 3;if("object"===s){if(t.hasOwnProperty("uri"))return 2;if(t.hasOwnProperty("bladeReference"))return 4;if(t.hasOwnProperty("resourceId"))return 5}return 1}dispose(){this._checkExistsOrRegisterDestroyId(super.dispose)||(this._cleanElement(O),super.dispose())}_getResourceInfo(e){const t=o.ArmId.parse(e.id,!0);return(0,h.isResourceAtAnyLevel)(t)?j(e).then((s=>{e.extendedLocation&&(s=W.extendedLocationFormatString.format(e.extendedLocation.name,s));return(t.subscription?MsPortalFx.Azure.getSubscriptionInfo(t.subscription):Promise.resolve(null)).then((i=>({resourceGroupName:t.resourceGroup,resourceGroupId:o.ArmId.stringify(t,4),subscriptionName:i&&i.displayName,subscriptionId:i&&t.subscription,location:s,tags:this._userModifiedTags?this._userModifiedTags:(0,c.convertStringMapToTagInfoArray)(e.tags),zones:e.zones,moveOptions:{resourceGroup:!0,subscription:!0,location:!0}})))})):4===t.kind?j(e).then((s=>MsPortalFx.Azure.getSubscriptionInfo(t.subscription).then((i=>({resourceGroupName:t.resourceGroup,resourceGroupId:e.id,subscriptionName:i.displayName,subscriptionId:t.subscription,location:s,tags:this._userModifiedTags?this._userModifiedTags:(0,c.convertStringMapToTagInfoArray)(e.tags),moveOptions:{resourceGroup:!1,subscription:!0,location:!1}}))))):Promise.resolve(null)}_createTagPill(e,t,s){return i.create(e,{showRemoveButton:!1,getKeyText:e=>e.key,getOperatorText:e=>":",getValueText:e=>e.value,ariaLabel:`${t} : ${s}`,value:{key:t,value:s},infoBalloonContent:{htmlTemplate:"<span data-bind='text:tagKey'></span><span> : </span><span data-bind='text:tagValue'></span>",viewModel:{tagKey:t,tagValue:s}},createEditor:()=>({onClick:()=>{const e={resourceId:this.vm.options.resourceId,key:t,value:s};F.Promises.cancelOnDispose(this.ltm,this.vm.openBlade(1,e))}})})}_getTagItems(){const e=[];return this.resourceData&&this.resourceData.tags&&this.resourceData.tags.forEach((t=>{(function(e){const t=(e||"").toLowerCase();return t.startsWith("hidden-")||t.startsWith("link:")})(t.key)||e.push(this._createTagPill(this.ltm,t.key,t.value))})),e}_processTags(e){if(e&&(this._userModifiedTags=e,this.resourceData.tags=e),this.state.showTags.value){const e=this._getTagItems();this.state.tagsPillList.items(e),this.state.noTags(!e.length)}}_throttleSpreadLayoutProcess(e){N.requestAnimationFrame((()=>{this._spreadLayoutProcess(e)}))}_processAndRender(){this._processItems(),this._processTags();const e=this.state,t=this.vm,s=(s,i)=>{!t.options.showAllItems&&s.length>5&&e.showViewAllButton(!0),t.options.showAllItems||i||s.length>5&&(s=s.splice(0,5));const a=s.map((e=>{const t=MsPortalFx.initObservable(e.value),s={value:t,icon:MsPortalFx.initObservable(e.icon),loading:MsPortalFx.initObservable(e.loading),valueExists:ko.computed(this.ltm,t,(e=>!MsPortalFx.isNullOrUndefined(e))),movableLabelExists:e.movableLabelExists||!1};return e.lines?(s.type=this.itemTypeDetector(e),s.lines=e.lines.map((e=>{const t=MsPortalFx.initObservable(e.value);return{...e,type:this.itemTypeDetector(e),icon:MsPortalFx.initObservable(e.icon),value:t,loading:MsPortalFx.initObservable(e.loading),valueExists:ko.computed(this.ltm,t,(e=>!MsPortalFx.isNullOrUndefined(e)))}}))):s.type=this.itemTypeDetector(e),{...e,...s}}));return s.length&&this._throttleSpreadLayoutProcess(),a};(0,_.subscribeAndRun)(this.ltm,[(0,k.toComputation)(t.dynamicLeftArray),e.viewAll],((t,i)=>{e.leftItems(s(this._staticItems.left.concat(t),i))})),(0,_.subscribeAndRun)(this.ltm,[(0,k.toComputation)(t.dynamicRightArray),e.viewAll],((t,i)=>{e.rightItems(s(this._staticItems.right.concat(t),i))})),this.element.addClass(O),this._assignEvents(),this._vivaResizeTracked||d.track(this.ltm,this.element.first(),(e=>{this._lastKnownContainerWidth!==e&&this._spreadLayoutProcess(e),this._lastKnownContainerWidth=e}),{ignoreInitialState:!0}),this._vivaResizeTracked=!0}_getResourceGroup(){const e=this.vm.options,t=e.hiddenChangeLink&&~ko.unwrap(e.hiddenChangeLink).indexOf(1),{value:s,movableOnClick:i,onClick:a}=this._armData.resourceGroup;if(this.resourceData){s(this.resourceData.resourceGroupName);i((()=>{if(H("EssentialsClick","ChangeResourceGroup",{bladeInstance:this._bladeInstanceId(),resourceId:this.vm.options.resourceId||""}),this.resourceData.moveOptions&&this.resourceData.moveOptions.resourceGroup){const t={resourceId:e.resourceId,moveType:1};F.Promises.cancelOnDispose(this.ltm,this.vm.openBlade(1,t))}})),a.resourceId(this.resourceData.resourceGroupId)}return{label:W.resourceGroup,value:s,movableLabel:t?"":W.move,movableLabelExists:!t,movableOnClick:i,onClick:a,loading:this.state.fetchingResourceData}}_getStatus(){const{value:e}=this._armData.status;return this.vm.status.subscribeAndRun(this.ltm,e),{label:W.status,value:e}}_getLocation(){const e=this.vm.options,t=!(0,D.isFeatureEnabled)("enablelocationchange")||!e.enableLocationChange||e.hiddenChangeLink&&ko.unwrap(e.hiddenChangeLink).includes(3),{value:s,movableOnClick:i}=this._armData.location;if(this.resourceData){let t=this.resourceData.location;if(this.resourceData.zones){t+=` (${W.zoneFormatString.format(this.resourceData.zones.join(W.zoneDelimiterString+" "))})`}s(t);i((()=>{if(H("EssentialsClick","ChangeLocation",{bladeInstance:this._bladeInstanceId(),resourceId:this.vm.options.resourceId||""}),this.resourceData.moveOptions&&this.resourceData.moveOptions.location){const t={subscriptionId:this.resourceData.subscriptionId,resourceId:e.resourceId,sourceRegion:this.resourceData.location};F.Promises.cancelOnDispose(this.ltm,this.vm.openBlade(3,t))}}))}return{label:W.location,value:s,movableLabel:t?"":W.move,movableLabelExists:!t,movableOnClick:i,loading:this.state.fetchingResourceData}}async _getSoftDeleteInfoApi(e){const t=`${e}/providers/Microsoft.Resources/deleteOptions/default?api-version=2024-10-01-preview`;return await(0,L.batch)({uri:t,type:"GET",setTelemetryHeader:"Essentials.getSoftDeleteInfo"}).then((e=>({softDeleteEnabled:!!e.content.properties.retentionTime,retentionTime:e.content.properties.retentionTime}))).catch((t=>{if(404===t.httpStatusCode)return{softDeleteEnabled:!1};{G.error(t);const s=o.ArmId.parse(e).resourceName||e;(0,T.publishNotification)({title:W.SoftDeleteNotification.errorGetTitle,description:W.SoftDeleteNotification.errorGetDesc.format(s),status:2}),Promise.reject(t)}}))}_getSoftDeleteInfo(){const e=this._softDeleteValue;this._softDeleteInfo&&e(this._softDeleteInfo.softDeleteEnabled?W.enabled:W.disabled);return{label:W.softDelete,value:e,loading:this.state.softDeleteLoaded,onClick:()=>{H("EssentialsClick","SoftDelete",{bladeInstance:this._bladeInstanceId(),resourceId:this.vm.options.resourceId||""}),this._diContainer.get(P.BladeOpener).openBlade(new M.PdlBladeReference("SoftDeleteConfig.ReactView","Microsoft_Azure_Resources",{parameters:{resourceId:this.vm.options.resourceId,isEnabled:this._softDeleteInfo.softDeleteEnabled,retentionTime:this._softDeleteInfo.retentionTime},onClosed:(e,t)=>{2===e&&t&&(void 0!==t.softDeleteEnabled&&t.softDeleteEnabled!==this._softDeleteInfo.softDeleteEnabled||t.retentionTime!==this._softDeleteInfo.retentionTime)&&this.vm.updateSoftDeleteInfo(this.vm.options.resourceId,this._softDeleteInfo.softDeleteEnabled,t.softDeleteEnabled,t.retentionTime).then((e=>{e&&(this._softDeleteInfo=e,this._softDeleteValue(e.softDeleteEnabled?W.enabled:W.disabled))}))}}),{flags:1,telemetryName:"PortalFx_KO_Essentials"})}}}_getSubscriptionName(){const e=this.vm.options,t=e.hiddenChangeLink&&~ko.unwrap(e.hiddenChangeLink).indexOf(4),{value:s,movableOnClick:i,onClick:a}=this._armData.subscriptionName;if(this.resourceData){s(this.resourceData.subscriptionName);i((()=>{if(H("EssentialsClick","ChangeSubscription",{bladeInstance:this._bladeInstanceId(),resourceId:this.vm.options.resourceId||""}),this.resourceData.moveOptions&&this.resourceData.moveOptions.subscription){const t={resourceId:e.resourceId,moveType:0};F.Promises.cancelOnDispose(this.ltm,this.vm.openBlade(4,t))}})),a.resourceId("/subscriptions/"+this.resourceData.subscriptionId)}return{label:W.subscription,value:s,movableLabel:t?"":W.move,movableLabelExists:!t,movableOnClick:i,onClick:a,loading:this.state.fetchingResourceData}}_getSubscriptionId(){const{value:e}=this._armData.subscriptionId;return this.resourceData&&e(this.resourceData.subscriptionId),{label:W.subscriptionId,value:e,loading:this.state.fetchingResourceData}}_getDirectoryName(){const{value:e}=this._armData.directoryName,t=this.resourceData;return t&&e(t.directoryName||t.directoryId||z),{label:W.directory,value:e,loading:this.state.fetchingResourceData,visible:this._showTenantInfo}}_getDirectoryId(){const{value:e}=this._armData.directoryId,t=this.resourceData;return t&&e(t.directoryId||z),{label:W.directoryId,value:e,loading:this.state.fetchingResourceData,visible:this._showTenantInfo}}_getItem(e){if("number"==typeof e)switch(e){case 1:return this._getResourceGroup();case 2:return this._getStatus();case 3:return this._getLocation();case 4:return this._getSubscriptionName();case 5:return this._getSubscriptionId();default:G.error("Unknown BuiltInType is used (Illegal Access)")}return e}_processItems(){let e=[],t=[];const s=this.vm.options,i=(0,D.isFeatureEnabled)("msptitle"),a=this.vm.options;switch(this.vm.optionType){case 1:{const a=[1,2,3,4,5];s.hiddenBuiltInTypes&&s.hiddenBuiltInTypes.forEach((e=>{const t=a.indexOf(e);t>-1&&a.splice(t,1)})),a.forEach((t=>{e.push(this._getItem(t))})),s.additionalLeft&&(e=e.concat(s.additionalLeft)),s.additionalRight&&(t=[...s.additionalRight]),i&&(e.unshift(this._getDirectoryName()),t.unshift(this._getDirectoryId()));break}case 2:i&&(e.push(this._getDirectoryName()),t.push(this._getDirectoryId())),s.left&&s.left.forEach((t=>{e.push(this._getItem(t))})),s.right&&s.right.forEach((e=>{t.push(this._getItem(e))}));break;case 3:s.left&&s.left.forEach((t=>{e.push(this._getItem(t))})),s.right&&s.right.forEach((e=>{t.push(this._getItem(e))}))}a?.resourceId&&a?.showSoftDelete&&this._showSoftDeleteFeature&&t.push(this._getSoftDeleteInfo()),this._staticItems.left=e,this._staticItems.right=t}_assignEvents(){const e=e=>{const t=this.vm.expanded,s=this.vm.options.onExpanderClick,i=!t();t(i),H("EssentialsClick","ToggleExpander",{bladeInstance:this._bladeInstanceId(),resourceId:this.vm.options.resourceId||""},i?"Expanded":"Collapsed"),(0,C.invokeAfterChangePropagation)((()=>{const e=this.element.find(`.${this.vm.expanded()?v.widgetCollapseButtonClass:v.widgetExpandButtonClass}`);document.activeElement!==e[0]&&e.focus()})),s&&s(i)};this.ltm.registerForDispose(this.element.setEvents(["click",`.${v.widgetCollapseButtonClass}`,e],["click",`.${v.widgetExpandButtonClass}`,e],["click",`.${v.widgetEditTagClass}`,e=>{H("EssentialsClick","ChangeTags",{bladeInstance:this._bladeInstanceId(),resourceId:this.vm.options.resourceId||""}),e.stopPropagation(),e.preventDefault();const t={resourceId:this.vm.options.resourceId,tag:void 0};this.vm.openBlade(6,t)}],["click",`.${v.widgetViewAllButtonClass}`,e=>{e.stopPropagation(),e.preventDefault(),this.state.viewAll(!this.state.viewAll.value)}])),this.ltm.registerForDispose(this.element.setEvents(["keyup",`.${v.widgetItemValueContainerClass} > .${v.widgetItemValueClass}`,e=>{if(x.isCtrlOrCommandOnly(e)&&67===e.keyCode){const t=e.target,s=N.document.createRange();s.selectNodeContents(t);const i=N.getSelection();i.removeAllRanges(),i.addRange(s),N.document.execCommand("copy"),t.focus(),this.state.copyTextAriaLive(`${i.toString()} ${W.copiedToClipboard}`)}}])),this.ltm.registerForDispose((()=>{this._events.forEach((e=>{e.element.off(e.event,e.handler)}))}))}}t.Widget=K}));