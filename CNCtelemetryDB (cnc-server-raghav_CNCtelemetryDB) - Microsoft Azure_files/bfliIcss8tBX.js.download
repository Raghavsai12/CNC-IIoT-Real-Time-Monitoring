define("MsPortalImpl/Widgets/AzureHomeShared/CopilotUtil",["require","exports","MsPortalImpl/Services/Services.Copilot"],(function(e,t,o){"use strict";t.Telemetry=void 0,t.getPortalScenario=async function(e,t,n){if(!e.get(o.CopilotService).getConfig().enabled)return Promise.resolve({isSupported:!1});return e.getAsync(o.CopilotShellAPIs).then((async e=>{const o=await e.getPortalScenario(t,n),l=function({extensionName:e,bladeName:t}){return["Extension",e,"Blade",t].join("/").toLowerCase()}(o.bladeReference);return{isSupported:"unknown"!==o.type,realBladeName:l,scenario:o}}))},t.getPrompts=function(e,t,n){return e.getAsync(o.CopilotShellAPIs).then((e=>e.awaitContentLoaded(n).then((()=>e.getPrompts(t)))))},t.getScenarioForTelemetry=function(e){const t=MsPortalFx.clone(e,!0);if(t?.bladeReference?.parameters){const{parameters:e,...o}=t.bladeReference;t.bladeReference=o}return t},t.isCopilotEnabled=void 0,t.nudge=n,t.openCopilotBlade=function({diContainer:e,prompt:t}){return n(e,{promptId:t.id,prompt:t.text,source:"home"})};t.isCopilotEnabled=o.isCopilotEnabled,t.Telemetry=MsPortalFx.Base.Diagnostics.Telemetry;function n(e,t){return e.get(o.CopilotService).nudge(t)}})),
define("_generated/MsPortalImpl/Svg/Internal/CopilotFilled.svg",["require","exports"],(function(e,t){"use strict";t.type=t.data=void 0;t.type=1,t.data="<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title></title><path d='M4.984 1.112h6.125c1.039 0 1.953.684 2.247 1.681l.462 1.572c.159.539.631.92 1.182.968h.285c.876 0 1.551.248 1.999.757.437.495.581 1.154.591 1.813.019 1.302-.491 2.92-.896 4.208-.354 1.121-.807 2.285-1.417 3.177-.606.888-1.435 1.6-2.546 1.6H6.891a2.342 2.342 0 0 1-2.247-1.681l-.462-1.572a1.356 1.356 0 0 0-1.181-.968h-.286c-.876 0-1.551-.248-1.999-.757-.437-.495-.581-1.154-.591-1.813-.019-1.302.491-2.92.896-4.208.354-1.121.807-2.285 1.417-3.177.606-.888 1.435-1.6 2.546-1.6Zm-.19 11.555c.146.206.259.438.333.69l.463 1.572c.17.577.699.973 1.3.973h.026a.9.9 0 0 0 .743-.373c.165-.224.315-.536.467-.944.143-.381.277-.816.427-1.302l.03-.097.197-.641a2.347 2.347 0 0 1-.732.117H5.46a2.744 2.744 0 0 1-.157.005h-.511Zm2.425-.991h.83c.545 0 1.032-.326 1.244-.818.432-1.426.859-2.856 1.155-3.85.075-.25.188-.48.333-.684H9.95c-.545 0-1.031.325-1.244.817a868.1 868.1 0 0 0-1.155 3.851 2.36 2.36 0 0 1-.332.684Zm2-6.221c.232-.076.478-.117.732-.117h2.589a2.68 2.68 0 0 1 .156-.005h.51a2.372 2.372 0 0 1-.333-.69l-.462-1.572a1.355 1.355 0 0 0-1.3-.973h-.015a.902.902 0 0 0-.754.373c-.165.223-.315.536-.467.944-.143.381-.277.816-.427 1.302l-.03.097-.197.641Z'/></g></svg>"})),
define("MsPortalImpl/Widgets/PromptRibbon/PromptRibbon.React",["require","exports","react","@griffel/react/makeStyles.esm","@griffel/core/mergeClasses.esm","@fluentui/tokens/lib/tokens","@fluentui/react-button/lib/components/Button/Button","@fluentui/react-button/lib/components/MenuButton/MenuButton","@fluentui/react-menu/lib/components/Menu/Menu","@fluentui/react-menu/lib/components/MenuTrigger/MenuTrigger","@fluentui/react-menu/lib/components/MenuPopover/MenuPopover","@fluentui/react-menu/lib/components/MenuList/MenuList","@fluentui/react-menu/lib/components/MenuItem/MenuItem","@fluentui/react-overflow/lib/components/Overflow","@fluentui/react-overflow/lib/components/OverflowItem/OverflowItem","@fluentui/react-overflow/lib/useIsOverflowItemVisible","@fluentui/react-overflow/lib/useOverflowMenu","@fluentui/react-skeleton/lib/components/Skeleton/Skeleton","@fluentui/react-skeleton/lib/components/SkeletonItem/SkeletonItem","_generated/MsPortalImpl/Svg/Internal/CopilotFilled.svg","_generated/MsPortalImpl/Svg/Internal/CopilotMonoline.svg","_generated/MsPortalImpl/Svg/Internal/AzureCopilot.svg","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Image/Image.React"],(function(e,t,o,n,l,r,a,i,s,c,m,u,d,p,g,f,b,v,k,C,I,x,h,B){"use strict";t.PromptRibbon=void 0;var w=MsPortalFx.Base.Diagnostics.Telemetry;const S=h.AzHome.PromptRibbon,M="PromptClick",P="PromptIconClick",E="first",N=(0,n.makeStyles)({container:{display:"flex",flexWrap:"nowrap",overflow:"hidden",minWidth:"32px",height:"32px",alignItems:"center"},firstContainer:{display:"flex",alignItems:"center"},firstButton:{height:"30px",width:"32px",minWidth:"32px",maxWidth:"32px",border:0,borderRadius:"4px",backgroundColor:`${r.tokens.colorSubtleBackgroundSelected}`,"& svg":{fill:`${r.tokens.colorNeutralForeground2Selected}`,":hover":{fill:`${r.tokens.colorNeutralForeground2BrandHover}`},":active":{fill:`${r.tokens.colorNeutralForeground2BrandPressed}`}},":hover":{backgroundColor:`${r.tokens.colorSubtleBackgroundHover}`},":active":{backgroundColor:`${r.tokens.colorSubtleBackgroundPressed}`}},firstButtonCollapsed:{backgroundColor:`${r.tokens.colorSubtleBackground}`,":hover":{backgroundColor:`${r.tokens.colorSubtleBackground}`},":active":{backgroundColor:`${r.tokens.colorSubtleBackground}`},"& svg":{fill:`${r.tokens.colorNeutralForeground2}`}},firstButtonStatic:{height:"30px",width:"27px",border:0,borderRadius:"4px",backgroundColor:`${r.tokens.colorSubtleBackground}`,display:"flex",padding:"7px 0px 7px 7px",alignItems:"center",boxSizing:"border-box"},firstButtonStaticOverflow:{backgroundColor:`${r.tokens.colorSubtleBackground}`},visibleItemContainer:{paddingLeft:`${r.tokens.spacingHorizontalS}`},visibleItem:{height:"24px",textWrap:"nowrap",minWidth:"min-content",borderRadius:"8px",border:`1px solid ${r.tokens.colorBrandStroke2}`,":hover":{border:`1px solid ${r.tokens.colorBrandStroke2Hover}`,backgroundColor:`${r.tokens.colorBrandBackground2Hover}`,color:`${r.tokens.colorBrandForeground2Hover}`},":active":{border:`1px solid ${r.tokens.colorBrandStroke2Pressed}`,backgroundColor:`${r.tokens.colorBrandBackground2Pressed}`,color:`${r.tokens.colorBrandForeground2Pressed}`}},overflowItem:{minWidth:"32px",padding:"0 2px 0 2px",marginLeft:`${r.tokens.spacingHorizontalXS}`},icon:{height:"20px",width:"20px"},loading:{width:"150px",padding:"4px",marginLeft:"4px",borderRadius:"4px"},loadingChild:{width:"100%"}}),y=({prompt:e,onClick:t,telemetryName:n})=>{const{id:l,text:r}=e;return(0,f.useIsOverflowItemVisible)(l)?null:o.createElement(d.MenuItem,{"data-testid":"overflowMenuItem-"+l,onClick:()=>L(e,t,{action:M,name:n,data:{isMenuPrompt:!0,id:l}})},r)},$=({prompts:e,minimumVisible:t,collapsible:n,useOutlineCopilotIcon:r,onClick:a,telemetryName:d})=>{const p=N(),{ref:g,overflowCount:f,isOverflowing:v}=(0,b.useOverflowMenu)(),k=t>e.length?1:e.length-t+1;return v?o.createElement(s.Menu,null,o.createElement(c.MenuTrigger,{disableButtonEnhancement:!0},k===f?o.createElement(i.MenuButton,{"data-testid":"firstIconMenuButton","aria-label":S.overflowAriaLabel.format(f),size:"large",icon:r?o.createElement(B.Image,{className:p.icon,image:I}):o.createElement(B.Image,{className:p.icon,image:x}),className:(0,l.mergeClasses)(p.firstButton,n&&p.firstButtonStaticOverflow),onClick:()=>{O(P,d,{hasOverflowMenu:!0})},ref:g}):o.createElement(i.MenuButton,{"data-testid":"overflowMenuButton","aria-label":S.overflowAriaLabel.format(f),menuIcon:null,size:"small",className:(0,l.mergeClasses)(p.visibleItem,p.overflowItem),ref:g},"+",f)),o.createElement(m.MenuPopover,null,o.createElement(u.MenuList,null,e.map(((e,t)=>o.createElement(y,{key:t,prompt:e,onClick:a,telemetryName:d})))))):null},R=()=>{const e=N();return o.createElement(a.Button,{"data-testid":"loadingButton",size:"small",className:e.loading,"aria-label":S.loading},o.createElement(v.Skeleton,{className:e.loadingChild},o.createElement(k.SkeletonItem,null)))};function O(e,t,o){w.trace({source:"PromptRibbon",action:e,name:t,data:o})}function L(e,t,o){t?.(e),O(o.action,o.name,o.data)}t.PromptRibbon=({prompts:e=[],minimumVisible:t=1,ariaLabel:n,collapsible:r=!1,defaultCollapsed:i=!1,collapsed:s,useOutlineCopilotIcon:c=!1,loading:m,telemetryName:u="",onClick:d,onChange:f})=>{const b=N(),[v,k]=o.useState(r&&(i||!0===s)),h=c?v?o.createElement(B.Image,{className:b.icon,image:I}):o.createElement(B.Image,{className:b.icon,image:C}):o.createElement(B.Image,{className:b.icon,image:x});return o.useEffect((()=>{r&&void 0!==s&&k(s)}),[s]),o.createElement(p.Overflow,null,o.createElement("div",{role:"group",className:b.container,"aria-label":n||S.defaultLabel},o.createElement(g.OverflowItem,{key:E,id:t>0&&e[0]?.id||E},o.createElement("div",{className:b.firstContainer},r?o.createElement(a.Button,{"data-testid":"firstIconButton","aria-expanded":!v,"aria-label":n||S.defaultLabel,size:"large",icon:h,className:(0,l.mergeClasses)(b.firstButton,v&&b.firstButtonCollapsed),onClick:()=>{void 0===s?k(!v):f?.(!v),O(P,u,{isCollapsed:!v})}}):o.createElement("div",{"data-testid":"firstIconButton",className:b.firstButtonStatic},h),!m&&!v&&e.slice(0,t).map(((e,t)=>o.createElement("div",{key:t,className:(0,l.mergeClasses)(b.visibleItemContainer)},o.createElement(a.Button,{"data-testid":"visibleButton-"+t,size:"small",className:(0,l.mergeClasses)(b.visibleItem),onClick:()=>L(e,d,{action:M,name:u,data:{isMenuPrompt:!1,id:e.id}})},e.text)))))),!m&&!v&&e.slice(t,e.length).map(((e,n)=>o.createElement(g.OverflowItem,{key:n+t,id:e.id},o.createElement("div",{className:b.visibleItemContainer},o.createElement(a.Button,{"data-testid":"visibleButton-"+(n+t),size:"small",className:(0,l.mergeClasses)(b.visibleItem),onClick:()=>L(e,d,{action:M,name:u,data:{isMenuPrompt:!1,id:e.id}})},e.text))))),!m&&!v&&o.createElement($,{prompts:e,minimumVisible:t,collapsible:r,useOutlineCopilotIcon:c,onClick:d,telemetryName:u}),m&&!v&&o.createElement(R,null)))}}));