define("MsPortalImpl/Weave/SandboxDomAgents/Button",["require","exports","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/UI/UI.LinkHandler","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Widgets/Widgets.Common","Fx"],(function(e,t,o,r,n,i,s){"use strict";t.attachDomAgent=function(t,c,d,p){const u=$(t).parent(),g=a+l++,m=(0,o.getFxClickSelectable)(d,c,u,a,g);let k,b=(e,t,o)=>!0,f="";ko.reactor(c,(()=>{k&&k.dispose(),k=c.createChildLifetime();const t=ko.unwrap(p.onClick);if(f=t&&t.telemetryName||"",!ko.unwrap(p.aggregatedDisabled)&&t){const o=u.find(".fxs-button");ko.ignoreDependencies((()=>{let a;if("function"==typeof t){const o=t;a=t=>{t.stopPropagation(),s.isPromiseLike(o)&&(0,n.logToExtension)(e,u,2,FxImpl.createError("SimpleButton binding argument is not a callback function. The click handler is "+o)),m.invokeClick(void 0,o,t)}}else a=t;(0,i.isLink)(t)?o.attr("role","link"):o.attr("role","button");const l=(0,r.getUriAndHandler)(k,d,a,!0);l.errorMessage.subscribeAndRun(k,(t=>{t&&(0,n.logToExtension)(e,u,1,FxImpl.createError(`SimpleButton failure: ${MsPortalFx.getLogFriendlyMessage(t)}`))}));(l.uriPromise&&l.uriPromise()?l.uriPromise():Promise.resolve()).then((()=>{!k.isDisposed()&&l.uri.subscribeAndRun(k,(e=>{p.selfDisabled(!e)}))})),b=l.handler}))}}));const P=t=>{if(t.stopPropagation(),t.preventDefault(),!ko.unwrap(p.aggregatedDisabled))try{b(t,m,f)}catch(t){(0,n.logToExtension)(e,u,2,FxImpl.createError("Button control failed to execute click handler",{innerErrors:t,data:{databind:$(u).attr("data-bind")}}))}};c.registerForDispose(u.setEvents(["click",P],["keydown",e=>{13!==e.keyCode&&32!==e.keyCode||(P(e),32===e.keyCode&&(e.preventDefault(),e.stopPropagation()))}]))};MsPortalFx.Base.Diagnostics;const a="simplebutton";let l=0}));