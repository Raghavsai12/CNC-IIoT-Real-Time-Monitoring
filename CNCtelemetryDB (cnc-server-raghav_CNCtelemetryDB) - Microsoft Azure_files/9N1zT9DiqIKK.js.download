define("MsPortalImpl/UI/Commands/UI.Commands.Lists",["require","exports","FxInternal/AsyncLoader","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/UI/UI.DeepLink","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/Resources/ImplScriptResources","FxInternal/Utils/Promise"],(function(e,t,s,a,n,i,o,l,r){"use strict";t.PinListItem=t.DeleteListItem=void 0,t.executePin=p,t.getOverviewModelAndLocator=u;var m=MsPortalFx.Base.Images;const d=l.ListCommands;function c(e){return e&&e.selectableItems().filter((e=>e.isSelected()))||[]}async function u(e,t,s){const{model:o,locator:l}=t,m=await s.get(a.DefinitionFinder).locateAsync(l),d=l.getExtensionLocator();if(m.menuBlade){const t={inputs:ko.toJS(o)},l=s.get(n.ViewModelManager),c=await l.getPartViewModel(d.name,m.viewModelLocator||m.viewModelName,454,{onInputsSetParameters:t});await Promise.resolve(c.onInputsSetPromise);const u=c.content,p=m.menuBlade.isV2?u().viewModel._msPortalFxMenu:m.menuBlade.isMenuView?(await u().menuBladeViewModel.fxAwaitAndRun(e))._msPortalFxMenu:u().menu,h=await p._msPortalFxData.overviewPromise,I=h.id;let M;M=h.supplyBladeReference?await Promise.resolve(h.supplyBladeReference()):await(0,r.ensureAsyncMethodReturnsPromiseForBackCompat)(h.supplyBladeReferenceAsync,h),l.releaseViewModel(c,!0);const P=(0,i.getDeepLink)(s,d.name,m,o,{selectedMenuItemId:I});return{locator:a.Locator.forExtension(M.extensionName).withBlade(M.bladeName),model:M.parameters,defaultMenuItemId:I,deepLink:P}}return t}function p(e,t,a,n){return u(e,a,t).then((e=>{if(e)return s.get("MsPortalImpl/UI/Dashboard/Common/DashboardPinHelper","pinTilesWithDashboardSelection").then((s=>s(t,n,e)))}))}class h extends o.ShellCommand{constructor(e,t,s,a){super(e,t,o.CommandNames.PinListItem,{text:d.pinToStartboard,icon:m.Pin()}),this._selectableSet=s.selectableSet,this._getModelAndLocatorPromise=a}bind(e){super.bind(e),this.enabled(1===c(this._selectableSet).length)}execute(e){this._getModelAndLocatorPromise().then((e=>p(this._ltm,this._diContainer,e,"ListCommands"))).finally((()=>{super.execute(e)}))}}t.PinListItem=h;class I extends o.ShellCommand{constructor(e,t,s){super(e,t,o.CommandNames.DeleteListItem,{text:s.deleteRowCommandTitle||d.deleteListItem,enabled:!1}),this.listData=s,this._itemsToDelete=[]}bind(e){super.bind(e),this.listData.selectableSet&&(this._itemsToDelete=c(this.listData.selectableSet)),this.enabled(this.listData.markForDelete&&this._itemsToDelete.length>0)}execute(e){super.execute(e),this._itemsToDelete.forEach((e=>{this.listData.markForDelete(e.data)}))}}t.DeleteListItem=I}));