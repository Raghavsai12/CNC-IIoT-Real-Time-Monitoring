/*! @azure/msal-browser-1p v4.21.0 2025-08-19 */
"use strict";!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).msal={})}(this,function(e){
/*! @azure/msal-common v15.12.0 2025-08-19 */
const t={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},n=200,r=400,o=400,i=499,a=500,s=599,c="GET",l="POST",u=[t.OPENID_SCOPE,t.PROFILE_SCOPE,t.OFFLINE_ACCESS_SCOPE],d=[...u,t.EMAIL_SCOPE],h="Content-Type",g="Content-Length",p="Retry-After",f="X-AnchorMailbox",m="WWW-Authenticate",v="Authentication-Info",y="x-ms-request-id",C="x-ms-httpver",I="active-account-filters",k="common",w="organizations",T="consumers",A="access_token",b="xms_cc",S={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},R="code",E="id_token token refresh_token",_={QUERY:"query",FRAGMENT:"fragment"},P="query",M="authorization_code",q="refresh_token",O="MSSTS",N="ADFS",B="Generic",x="-",L=".",D={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},U="appmetadata",H="1",F="authority-metadata",z=86400,K="config",$="cache",G="network",Q="hardcoded_values",j={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},W={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},V=60,J=3600,Y="throttling",X="retry-after, h429",Z="invalid_grant",ee="client_mismatch",te="1",ne="3",re="4",oe="2",ie="4",ae="5",se="0",ce="1",le="2",ue="3",de="4",he={Jwt:"JWT",Jwk:"JWK",Pop:"pop"},ge="unexpected_error",pe="post_request_failed";var fe=Object.freeze({__proto__:null,postRequestFailed:pe,unexpectedError:ge});
/*! @azure/msal-common v15.12.0 2025-08-19 */const me={[ge]:"Unexpected error in authentication.",[pe]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."},ve={unexpectedError:{code:ge,desc:me[ge]},postRequestFailed:{code:pe,desc:me[pe]}};class ye extends Error{constructor(e,n,r){super(n?`${e}: ${n}`:e),Object.setPrototypeOf(this,ye.prototype),this.errorCode=e||t.EMPTY_STRING,this.errorMessage=n||t.EMPTY_STRING,this.subError=r||t.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function Ce(e,t){return new ye(e,t?`${me[e]} ${t}`:me[e])}
/*! @azure/msal-common v15.12.0 2025-08-19 */const Ie="client_info_decoding_error",ke="client_info_empty_error",we="token_parsing_error",Te="null_or_empty_token",Ae="endpoints_resolution_error",be="network_error",Se="openid_config_error",Re="hash_not_deserialized",Ee="invalid_state",_e="state_mismatch",Pe="state_not_found",Me="nonce_mismatch",qe="auth_time_not_found",Oe="max_age_transpired",Ne="multiple_matching_tokens",Be="multiple_matching_accounts",xe="multiple_matching_appMetadata",Le="request_cannot_be_made",De="cannot_remove_empty_scope",Ue="cannot_append_scopeset",He="empty_input_scopeset",Fe="device_code_polling_cancelled",ze="device_code_expired",Ke="device_code_unknown_error",$e="no_account_in_silent_request",Ge="invalid_cache_record",Qe="invalid_cache_environment",je="no_account_found",We="no_crypto_object",Ve="unexpected_credential_type",Je="invalid_assertion",Ye="invalid_client_credential",Xe="token_refresh_required",Ze="user_timeout_reached",et="token_claims_cnf_required_for_signedjwt",tt="authorization_code_missing_from_server_response",nt="binding_key_not_removed",rt="end_session_endpoint_not_supported",ot="key_id_missing",it="no_network_connectivity",at="user_canceled",st="missing_tenant_id_error",ct="method_not_implemented",lt="nested_app_auth_bridge_disabled";var ut=Object.freeze({__proto__:null,authTimeNotFound:qe,authorizationCodeMissingFromServerResponse:tt,bindingKeyNotRemoved:nt,cannotAppendScopeSet:Ue,cannotRemoveEmptyScope:De,clientInfoDecodingError:Ie,clientInfoEmptyError:ke,deviceCodeExpired:ze,deviceCodePollingCancelled:Fe,deviceCodeUnknownError:Ke,emptyInputScopeSet:He,endSessionEndpointNotSupported:rt,endpointResolutionError:Ae,hashNotDeserialized:Re,invalidAssertion:Je,invalidCacheEnvironment:Qe,invalidCacheRecord:Ge,invalidClientCredential:Ye,invalidState:Ee,keyIdMissing:ot,maxAgeTranspired:Oe,methodNotImplemented:ct,missingTenantIdError:st,multipleMatchingAccounts:Be,multipleMatchingAppMetadata:xe,multipleMatchingTokens:Ne,nestedAppAuthBridgeDisabled:lt,networkError:be,noAccountFound:je,noAccountInSilentRequest:$e,noCryptoObject:We,noNetworkConnectivity:it,nonceMismatch:Me,nullOrEmptyToken:Te,openIdConfigError:Se,requestCannotBeMade:Le,stateMismatch:_e,stateNotFound:Pe,tokenClaimsCnfRequiredForSignedJwt:et,tokenParsingError:we,tokenRefreshRequired:Xe,unexpectedCredentialType:Ve,userCanceled:at,userTimeoutReached:Ze});
/*! @azure/msal-common v15.12.0 2025-08-19 */const dt={[Ie]:"The client info could not be parsed/decoded correctly",[ke]:"The client info was empty",[we]:"Token cannot be parsed",[Te]:"The token is null or empty",[Ae]:"Endpoints cannot be resolved",[be]:"Network request failed",[Se]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[Re]:"The hash parameters could not be deserialized",[Ee]:"State was not the expected format",[_e]:"State mismatch error",[Pe]:"State not found",[Me]:"Nonce mismatch error",[qe]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[Oe]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[Ne]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[Be]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[xe]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[Le]:"Token request cannot be made without authorization code or refresh token.",[De]:"Cannot remove null or empty scope from ScopeSet",[Ue]:"Cannot append ScopeSet",[He]:"Empty input ScopeSet cannot be processed",[Fe]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[ze]:"Device code is expired.",[Ke]:"Device code stopped polling for unknown reasons.",[$e]:"Please pass an account object, silent flow is not supported without account information",[Ge]:"Cache record object was null or undefined.",[Qe]:"Invalid environment when attempting to create cache entry",[je]:"No account found in cache for given key.",[We]:"No crypto object detected.",[Ve]:"Unexpected credential type.",[Je]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[Ye]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[Xe]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[Ze]:"User defined timeout for device code polling reached",[et]:"Cannot generate a POP jwt if the token_claims are not populated",[tt]:"Server response does not contain an authorization code to proceed",[nt]:"Could not remove the credential's binding key from storage.",[rt]:"The provided authority does not support logout",[ot]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[it]:"No network connectivity. Check your internet connection.",[at]:"User cancelled the flow.",[st]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[ct]:"This method has not been implemented",[lt]:"The nested app auth bridge is disabled"},ht={clientInfoDecodingError:{code:Ie,desc:dt[Ie]},clientInfoEmptyError:{code:ke,desc:dt[ke]},tokenParsingError:{code:we,desc:dt[we]},nullOrEmptyToken:{code:Te,desc:dt[Te]},endpointResolutionError:{code:Ae,desc:dt[Ae]},networkError:{code:be,desc:dt[be]},unableToGetOpenidConfigError:{code:Se,desc:dt[Se]},hashNotDeserialized:{code:Re,desc:dt[Re]},invalidStateError:{code:Ee,desc:dt[Ee]},stateMismatchError:{code:_e,desc:dt[_e]},stateNotFoundError:{code:Pe,desc:dt[Pe]},nonceMismatchError:{code:Me,desc:dt[Me]},authTimeNotFoundError:{code:qe,desc:dt[qe]},maxAgeTranspired:{code:Oe,desc:dt[Oe]},multipleMatchingTokens:{code:Ne,desc:dt[Ne]},multipleMatchingAccounts:{code:Be,desc:dt[Be]},multipleMatchingAppMetadata:{code:xe,desc:dt[xe]},tokenRequestCannotBeMade:{code:Le,desc:dt[Le]},removeEmptyScopeError:{code:De,desc:dt[De]},appendScopeSetError:{code:Ue,desc:dt[Ue]},emptyInputScopeSetError:{code:He,desc:dt[He]},DeviceCodePollingCancelled:{code:Fe,desc:dt[Fe]},DeviceCodeExpired:{code:ze,desc:dt[ze]},DeviceCodeUnknownError:{code:Ke,desc:dt[Ke]},NoAccountInSilentRequest:{code:$e,desc:dt[$e]},invalidCacheRecord:{code:Ge,desc:dt[Ge]},invalidCacheEnvironment:{code:Qe,desc:dt[Qe]},noAccountFound:{code:je,desc:dt[je]},noCryptoObj:{code:We,desc:dt[We]},unexpectedCredentialType:{code:Ve,desc:dt[Ve]},invalidAssertion:{code:Je,desc:dt[Je]},invalidClientCredential:{code:Ye,desc:dt[Ye]},tokenRefreshRequired:{code:Xe,desc:dt[Xe]},userTimeoutReached:{code:Ze,desc:dt[Ze]},tokenClaimsRequired:{code:et,desc:dt[et]},noAuthorizationCodeFromServer:{code:tt,desc:dt[tt]},bindingKeyNotRemovedError:{code:nt,desc:dt[nt]},logoutNotSupported:{code:rt,desc:dt[rt]},keyIdMissing:{code:ot,desc:dt[ot]},noNetworkConnectivity:{code:it,desc:dt[it]},userCanceledError:{code:at,desc:dt[at]},missingTenantIdError:{code:st,desc:dt[st]},nestedAppAuthBridgeDisabled:{code:lt,desc:dt[lt]}};class gt extends ye{constructor(e,t){super(e,t?`${dt[e]}: ${t}`:dt[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,gt.prototype)}}function pt(e,t){return new gt(e,t)}
/*! @azure/msal-common v15.12.0 2025-08-19 */const ft={createNewGuid:()=>{throw pt(ct)},base64Decode:()=>{throw pt(ct)},base64Encode:()=>{throw pt(ct)},base64UrlEncode:()=>{throw pt(ct)},encodeKid:()=>{throw pt(ct)},async getPublicKeyThumbprint(){throw pt(ct)},async removeTokenBindingKey(){throw pt(ct)},async clearKeystore(){throw pt(ct)},async signJwt(){throw pt(ct)},async hashString(){throw pt(ct)}};
/*! @azure/msal-common v15.12.0 2025-08-19 */var mt;e.LogLevel=void 0,(mt=e.LogLevel||(e.LogLevel={}))[mt.Error=0]="Error",mt[mt.Warning=1]="Warning",mt[mt.Info=2]="Info",mt[mt.Verbose=3]="Verbose",mt[mt.Trace=4]="Trace";class vt{constructor(n,r,o){this.level=e.LogLevel.Info;const i=n||vt.createDefaultLoggerOptions();this.localCallback=i.loggerCallback||(()=>{}),this.piiLoggingEnabled=i.piiLoggingEnabled||!1,this.level="number"==typeof i.logLevel?i.logLevel:e.LogLevel.Info,this.correlationId=i.correlationId||t.EMPTY_STRING,this.packageName=r||t.EMPTY_STRING,this.packageVersion=o||t.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:e.LogLevel.Info}}clone(e,t,n){return new vt({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,t)}logMessage(t,n){if(n.logLevel>this.level||!this.piiLoggingEnabled&&n.containsPii)return;const r=`${`[${(new Date).toUTCString()}] : [${n.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${e.LogLevel[n.logLevel]} - ${t}`;this.executeCallback(n.logLevel,r,n.containsPii||!1)}executeCallback(e,t,n){this.localCallback&&this.localCallback(e,t,n)}error(n,r){this.logMessage(n,{logLevel:e.LogLevel.Error,containsPii:!1,correlationId:r||t.EMPTY_STRING})}errorPii(n,r){this.logMessage(n,{logLevel:e.LogLevel.Error,containsPii:!0,correlationId:r||t.EMPTY_STRING})}warning(n,r){this.logMessage(n,{logLevel:e.LogLevel.Warning,containsPii:!1,correlationId:r||t.EMPTY_STRING})}warningPii(n,r){this.logMessage(n,{logLevel:e.LogLevel.Warning,containsPii:!0,correlationId:r||t.EMPTY_STRING})}info(n,r){this.logMessage(n,{logLevel:e.LogLevel.Info,containsPii:!1,correlationId:r||t.EMPTY_STRING})}infoPii(n,r){this.logMessage(n,{logLevel:e.LogLevel.Info,containsPii:!0,correlationId:r||t.EMPTY_STRING})}verbose(n,r){this.logMessage(n,{logLevel:e.LogLevel.Verbose,containsPii:!1,correlationId:r||t.EMPTY_STRING})}verbosePii(n,r){this.logMessage(n,{logLevel:e.LogLevel.Verbose,containsPii:!0,correlationId:r||t.EMPTY_STRING})}trace(n,r){this.logMessage(n,{logLevel:e.LogLevel.Trace,containsPii:!1,correlationId:r||t.EMPTY_STRING})}tracePii(n,r){this.logMessage(n,{logLevel:e.LogLevel.Trace,containsPii:!0,correlationId:r||t.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}
/*! @azure/msal-common v15.12.0 2025-08-19 */const yt="@azure/msal-common",Ct="15.12.0",It={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"},kt="redirect_uri_empty",wt="claims_request_parsing_error",Tt="authority_uri_insecure",At="url_parse_error",bt="empty_url_error",St="empty_input_scopes_error",Rt="invalid_claims",Et="token_request_empty",_t="logout_request_empty",Pt="invalid_code_challenge_method",Mt="pkce_params_missing",qt="invalid_cloud_discovery_metadata",Ot="invalid_authority_metadata",Nt="untrusted_authority",Bt="missing_ssh_jwk",xt="missing_ssh_kid",Lt="missing_nonce_authentication_header",Dt="invalid_authentication_header",Ut="cannot_set_OIDCOptions",Ht="cannot_allow_platform_broker",Ft="authority_mismatch",zt="invalid_request_method_for_EAR",Kt="invalid_authorize_post_body_parameters";var $t=Object.freeze({__proto__:null,authorityMismatch:Ft,authorityUriInsecure:Tt,cannotAllowPlatformBroker:Ht,cannotSetOIDCOptions:Ut,claimsRequestParsingError:wt,emptyInputScopesError:St,invalidAuthenticationHeader:Dt,invalidAuthorityMetadata:Ot,invalidAuthorizePostBodyParameters:Kt,invalidClaims:Rt,invalidCloudDiscoveryMetadata:qt,invalidCodeChallengeMethod:Pt,invalidRequestMethodForEAR:zt,logoutRequestEmpty:_t,missingNonceAuthenticationHeader:Lt,missingSshJwk:Bt,missingSshKid:xt,pkceParamsMissing:Mt,redirectUriEmpty:kt,tokenRequestEmpty:Et,untrustedAuthority:Nt,urlEmptyError:bt,urlParseError:At});
/*! @azure/msal-common v15.12.0 2025-08-19 */const Gt={[kt]:"A redirect URI is required for all calls, and none has been set.",[wt]:"Could not parse the given claims request object.",[Tt]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[At]:"URL could not be parsed into appropriate segments.",[bt]:"URL was empty or null.",[St]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[Rt]:"Given claims parameter must be a stringified JSON object.",[Et]:"Token request was empty and not found in cache.",[_t]:"The logout request was null or undefined.",[Pt]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[Mt]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[qt]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[Ot]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[Nt]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[Bt]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[xt]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[Lt]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[Dt]:"Invalid authentication header provided",[Ut]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[Ht]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[Ft]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority.",[Kt]:"Invalid authorize post body parameters provided. If you are using authorizePostBodyParameters, the request method must be POST. Please check the request method and parameters.",[zt]:"Invalid request method for EAR protocol mode. The request method cannot be GET when using EAR protocol mode. Please change the request method to POST."},Qt={redirectUriNotSet:{code:kt,desc:Gt[kt]},claimsRequestParsingError:{code:wt,desc:Gt[wt]},authorityUriInsecure:{code:Tt,desc:Gt[Tt]},urlParseError:{code:At,desc:Gt[At]},urlEmptyError:{code:bt,desc:Gt[bt]},emptyScopesError:{code:St,desc:Gt[St]},invalidClaimsRequest:{code:Rt,desc:Gt[Rt]},tokenRequestEmptyError:{code:Et,desc:Gt[Et]},logoutRequestEmptyError:{code:_t,desc:Gt[_t]},invalidCodeChallengeMethod:{code:Pt,desc:Gt[Pt]},invalidCodeChallengeParams:{code:Mt,desc:Gt[Mt]},invalidCloudDiscoveryMetadata:{code:qt,desc:Gt[qt]},invalidAuthorityMetadata:{code:Ot,desc:Gt[Ot]},untrustedAuthority:{code:Nt,desc:Gt[Nt]},missingSshJwk:{code:Bt,desc:Gt[Bt]},missingSshKid:{code:xt,desc:Gt[xt]},missingNonceAuthenticationHeader:{code:Lt,desc:Gt[Lt]},invalidAuthenticationHeader:{code:Dt,desc:Gt[Dt]},cannotSetOIDCOptions:{code:Ut,desc:Gt[Ut]},cannotAllowPlatformBroker:{code:Ht,desc:Gt[Ht]},authorityMismatch:{code:Ft,desc:Gt[Ft]},invalidAuthorizePostBodyParameters:{code:Kt,desc:Gt[Kt]},invalidRequestMethodForEAR:{code:zt,desc:Gt[zt]}};class jt extends ye{constructor(e){super(e,Gt[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,jt.prototype)}}function Wt(e){return new jt(e)}
/*! @azure/msal-common v15.12.0 2025-08-19 */class Vt{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return 0===Object.keys(t).length}catch(e){}return!0}static startsWith(e,t){return 0===e.indexOf(t)}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},n=e.split("&"),r=e=>decodeURIComponent(e.replace(/\+/g," "));return n.forEach(e=>{if(e.trim()){const[n,o]=e.split(/=(.+)/g,2);n&&o&&(t[r(n)]=r(o))}}),t}static trimArrayEntries(e){return e.map(e=>e.trim())}static removeEmptyStringsFromArray(e){return e.filter(e=>!!e)}static jsonParseHelper(e){try{return JSON.parse(e)}catch(e){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}
/*! @azure/msal-common v15.12.0 2025-08-19 */class Jt{constructor(e){const t=e?Vt.trimArrayEntries([...e]):[],n=t?Vt.removeEmptyStringsFromArray(t):[];if(!n||!n.length)throw Wt(St);this.scopes=new Set,n.forEach(e=>this.scopes.add(e))}static fromString(e){const n=(e||t.EMPTY_STRING).split(" ");return new Jt(n)}static createSearchScopes(e){const n=e&&e.length>0?e:[...u],r=new Jt(n);return r.containsOnlyOIDCScopes()?r.removeScope(t.OFFLINE_ACCESS_SCOPE):r.removeOIDCScopes(),r}containsScope(e){const t=this.printScopesLowerCase().split(" "),n=new Jt(t);return!!e&&n.scopes.has(e.toLowerCase())}containsScopeSet(e){return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every(e=>this.containsScope(e)))}containsOnlyOIDCScopes(){let e=0;return d.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(e=>this.appendScope(e))}catch(e){throw pt(Ue)}}removeScope(e){if(!e)throw pt(De);this.scopes.delete(e.trim())}removeOIDCScopes(){d.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw pt(He);const t=new Set;return e.scopes.forEach(e=>t.add(e.toLowerCase())),this.scopes.forEach(e=>t.add(e.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw pt(He);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),n=e.getScopeCount(),r=this.getScopeCount();return t.size<r+n}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){if(this.scopes){return this.asArray().join(" ")}return t.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}
/*! @azure/msal-common v15.12.0 2025-08-19 */function Yt(e,t){return!!e&&!!t&&e===t.split(".")[1]}function Xt(e,t,n,r){if(r){const{oid:t,sub:n,tid:o,name:i,tfp:a,acr:s,preferred_username:c,upn:l,login_hint:u}=r,d=o||a||s||"";return{tenantId:d,localAccountId:t||n||"",name:i,username:c||l||"",loginHint:u,isHomeTenant:Yt(d,e)}}return{tenantId:n,localAccountId:t,username:"",isHomeTenant:Yt(n,e)}}function Zt(e,t,n,r){let o=e;if(t){const{isHomeTenant:n,...r}=t;o={...e,...r}}if(n){const{isHomeTenant:t,...i}=Xt(e.homeAccountId,e.localAccountId,e.tenantId,n);return o={...o,...i,idTokenClaims:n,idToken:r},o}return o}
/*! @azure/msal-common v15.12.0 2025-08-19 */function en(e,t){const n=function(e){if(!e)throw pt(Te);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw pt(we);return t[2]}(e);try{const e=t(n);return JSON.parse(e)}catch(e){throw pt(we)}}function tn(e,t){if(0===t||Date.now()-3e5>e+t)throw pt(Oe)}
/*! @azure/msal-common v15.12.0 2025-08-19 */function nn(e){if(!e)return e;let t=e.toLowerCase();return Vt.endsWith(t,"?")?t=t.slice(0,-1):Vt.endsWith(t,"?/")&&(t=t.slice(0,-2)),Vt.endsWith(t,"/")||(t+="/"),t}function rn(e){return e.startsWith("#/")?e.substring(2):e.startsWith("#")||e.startsWith("?")?e.substring(1):e}function on(e){if(!e||e.indexOf("=")<0)return null;try{const t=rn(e),n=Object.fromEntries(new URLSearchParams(t));if(n.code||n.ear_jwe||n.error||n.error_description||n.state)return n}catch(e){throw pt(Re)}return null}function an(e,t=!0,n){const r=new Array;return e.forEach((e,o)=>{!t&&n&&o in n?r.push(`${o}=${e}`):r.push(`${o}=${encodeURIComponent(e)}`)}),r.join("&")}function sn(e){if(!e)return e;const t=e.split("#")[0];try{const e=new URL(t);return nn(e.origin+e.pathname+e.search)}catch(e){return nn(t)}}
/*! @azure/msal-common v15.12.0 2025-08-19 */class cn{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Wt(bt);e.includes("#")||(this._urlString=cn.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return Vt.endsWith(t,"?")?t=t.slice(0,-1):Vt.endsWith(t,"?/")&&(t=t.slice(0,-2)),Vt.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(e){throw Wt(At)}if(!e.HostNameAndPort||!e.PathSegments)throw Wt(At);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw Wt(Tt)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return cn.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),n=t.PathSegments;return!e||0===n.length||n[0]!==k&&n[0]!==w||(n[0]=e),cn.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Wt(At);const n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let r=n.AbsolutePath.split("/");return r=r.filter(e=>e&&e.length>0),n.PathSegments=r,n.QueryString&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw Wt(At);return n[2]}static getAbsoluteUrl(e,n){if(e[0]===t.FORWARD_SLASH){const t=new cn(n).getUrlComponents();return t.Protocol+"//"+t.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new cn(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!on(e)}}
/*! @azure/msal-common v15.12.0 2025-08-19 */const ln={"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},un={metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},dn=new Set;function hn(e,t,n,r){if(r?.trace(`getAliasesFromMetadata called with source: ${n}`),e&&t){const o=gn(t,e);if(o)return r?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${n}, returning aliases`),o.aliases;r?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${n}`)}return null}function gn(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r.aliases.includes(t))return r}return null}
/*! @azure/msal-common v15.12.0 2025-08-19 */un.metadata.forEach(e=>{e.aliases.forEach(e=>{dn.add(e)})});const pn="cache_quota_exceeded",fn="cache_error_unknown",mn={[pn]:"Exceeded cache storage capacity.",[fn]:"Unexpected error occurred when using cache storage."};class vn extends ye{constructor(e,t){const n=t||(mn[e]?mn[e]:mn[fn]);super(`${e}: ${n}`),Object.setPrototypeOf(this,vn.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=n}}function yn(e){return e instanceof Error?"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||e.message.includes("exceeded the quota")?new vn(pn):new vn(e.name,e.message):new vn(fn)}
/*! @azure/msal-common v15.12.0 2025-08-19 */class Cn{constructor(e,t,n,r,o){this.clientId=e,this.cryptoImpl=t,this.commonLogger=n.clone(yt,Ct),this.staticAuthorityOptions=o,this.performanceClient=r}getAllAccounts(e,t){return this.buildTenantProfiles(this.getAccountsFilteredBy(e,t),t,e)}getAccountInfoFilteredBy(e,t){if(0===Object.keys(e).length||Object.values(e).every(e=>!e))return this.commonLogger.warning("getAccountInfoFilteredBy: Account filter is empty or invalid, returning null"),null;const n=this.getAllAccounts(e,t);if(n.length>1){return n.sort(e=>e.idTokenClaims?-1:1)[0]}return 1===n.length?n[0]:null}getBaseAccountInfo(e,t){const n=this.getAccountsFilteredBy(e,t);return n.length>0?n[0].getAccountInfo():null}buildTenantProfiles(e,t,n){return e.flatMap(e=>this.getTenantProfilesFromAccountEntity(e,t,n?.tenantId,n))}getTenantedAccountInfoByFilter(e,t,n,r,o){let i,a=null;if(o&&!this.tenantProfileMatchesFilter(n,o))return null;const s=this.getIdToken(e,r,t,n.tenantId);return s&&(i=en(s.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(i,o))?null:(a=Zt(e,n,i,s?.secret),a)}getTenantProfilesFromAccountEntity(e,t,n,r){const o=e.getAccountInfo();let i=o.tenantProfiles||new Map;const a=this.getTokenKeys();if(n){const e=i.get(n);if(!e)return[];i=new Map([[n,e]])}const s=[];return i.forEach(e=>{const n=this.getTenantedAccountInfoByFilter(o,a,e,t,r);n&&s.push(n)}),s}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId))&&((!t.name||e.name===t.name)&&(void 0===t.isHomeTenant||e.isHomeTenant===t.isHomeTenant))}idTokenClaimsMatchTenantProfileFilter(e,t){if(t){if(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId))return!1;if(t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint))return!1;if(t.username&&!this.matchUsername(e.preferred_username,t.username))return!1;if(t.name&&!this.matchName(e,t.name))return!1;if(t.sid&&!this.matchSid(e,t.sid))return!1}return!0}async saveCacheRecord(e,t,n){if(!e)throw pt(Ge);try{e.account&&await this.setAccount(e.account,t),e.idToken&&!1!==n?.idToken&&await this.setIdTokenCredential(e.idToken,t),e.accessToken&&!1!==n?.accessToken&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&!1!==n?.refreshToken&&await this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata,t)}catch(e){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),e instanceof ye?e:yn(e)}}async saveAccessToken(e,t){const n={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},r=this.getTokenKeys(),o=Jt.fromString(e.target);r.accessToken.forEach(e=>{if(!this.accessTokenKeyMatchesFilter(e,n,!1))return;const r=this.getAccessTokenCredential(e,t);if(r&&this.credentialMatchesFilter(r,n)){Jt.fromString(r.target).intersectingScopeSets(o)&&this.removeAccessToken(e,t)}}),await this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e,t){const n=this.getAccountKeys(),r=[];return n.forEach(n=>{const o=this.getAccount(n,t);if(!o)return;if(e.homeAccountId&&!this.matchHomeAccountId(o,e.homeAccountId))return;if(e.username&&!this.matchUsername(o.username,e.username))return;if(e.environment&&!this.matchEnvironment(o,e.environment))return;if(e.realm&&!this.matchRealm(o,e.realm))return;if(e.nativeAccountId&&!this.matchNativeAccountId(o,e.nativeAccountId))return;if(e.authorityType&&!this.matchAuthorityType(o,e.authorityType))return;const i={localAccountId:e?.localAccountId,name:e?.name},a=o.tenantProfiles?.filter(e=>this.tenantProfileMatchesFilter(e,i));a&&0===a.length||r.push(o)}),r}credentialMatchesFilter(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"==typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===D.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===W.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0}getAppMetadataFilteredBy(e){const t=this.getKeys(),n={};return t.forEach(t=>{if(!this.isAppMetadata(t))return;const r=this.getAppMetadata(t);r&&(e.environment&&!this.matchEnvironment(r,e.environment)||e.clientId&&!this.matchClientId(r,e.clientId)||(n[t]=r))}),n}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let n=null;return t.forEach(t=>{if(!this.isAuthorityMetadata(t)||-1===t.indexOf(this.clientId))return;const r=this.getAuthorityMetadata(t);r&&-1!==r.aliases.indexOf(e)&&(n=r)}),n}removeAllAccounts(e){this.getAllAccounts({},e).forEach(t=>{this.removeAccount(t,e)})}removeAccount(e,t){this.removeAccountContext(e,t);this.getAccountKeys().filter(t=>t.includes(e.homeAccountId)&&t.includes(e.environment)).forEach(e=>{this.removeItem(e,t),this.performanceClient.incrementFields({accountsRemoved:1},t)})}removeAccountContext(e,t){const n=this.getTokenKeys(),r=t=>t.includes(e.homeAccountId)&&t.includes(e.environment);n.idToken.filter(r).forEach(e=>{this.removeIdToken(e,t)}),n.accessToken.filter(r).forEach(e=>{this.removeAccessToken(e,t)}),n.refreshToken.filter(r).forEach(e=>{this.removeRefreshToken(e,t)})}removeAccessToken(e,t){const n=this.getAccessTokenCredential(e,t);if(this.removeItem(e,t),this.performanceClient.incrementFields({accessTokensRemoved:1},t),!n||n.credentialType.toLowerCase()!==D.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||n.tokenType!==W.POP)return;const r=n.keyId;r&&this.cryptoImpl.removeTokenBindingKey(r).catch(()=>{this.commonLogger.error(`Failed to remove token binding key ${r}`,t),this.performanceClient?.incrementFields({removeTokenBindingKeyFailure:1},t)})}removeAppMetadata(e){return this.getKeys().forEach(t=>{this.isAppMetadata(t)&&this.removeItem(t,e)}),!0}getIdToken(e,t,n,r,o){this.commonLogger.trace("CacheManager - getIdToken called");const i={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:D.ID_TOKEN,clientId:this.clientId,realm:r},a=this.getIdTokensByFilter(i,t,n),s=a.size;if(s<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(s>1){let n=a;if(!r){const t=new Map;a.forEach((n,r)=>{n.realm===e.tenantId&&t.set(r,n)});const r=t.size;if(r<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),a.values().next().value;if(1===r)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),t.values().next().value;n=t}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),n.forEach((e,n)=>{this.removeIdToken(n,t)}),o&&t&&o.addFields({multiMatchedID:a.size},t),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),a.values().next().value}getIdTokensByFilter(e,t,n){const r=n&&n.idToken||this.getTokenKeys().idToken,o=new Map;return r.forEach(n=>{if(!this.idTokenKeyMatchesFilter(n,{clientId:this.clientId,...e}))return;const r=this.getIdTokenCredential(n,t);r&&this.credentialMatchesFilter(r,e)&&o.set(n,r)}),o}idTokenKeyMatchesFilter(e,t){const n=e.toLowerCase();return(!t.clientId||-1!==n.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==n.indexOf(t.homeAccountId.toLowerCase()))}removeIdToken(e,t){this.removeItem(e,t)}removeRefreshToken(e,t){this.removeItem(e,t)}getAccessToken(e,t,n,r){const o=t.correlationId;this.commonLogger.trace("CacheManager - getAccessToken called",o);const i=Jt.createSearchScopes(t.scopes),a=t.authenticationScheme||W.BEARER,s=a&&a.toLowerCase()!==W.BEARER.toLowerCase()?D.ACCESS_TOKEN_WITH_AUTH_SCHEME:D.ACCESS_TOKEN,c={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:s,clientId:this.clientId,realm:r||e.tenantId,target:i,tokenType:a,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},l=n&&n.accessToken||this.getTokenKeys().accessToken,u=[];l.forEach(e=>{if(this.accessTokenKeyMatchesFilter(e,c,!0)){const t=this.getAccessTokenCredential(e,o);t&&this.credentialMatchesFilter(t,c)&&u.push(t)}});const d=u.length;return d<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found",o),null):d>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them",o),u.forEach(e=>{this.removeAccessToken(this.generateCredentialKey(e),o)}),this.performanceClient.addFields({multiMatchedAT:u.length},o),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token",o),u[0])}accessTokenKeyMatchesFilter(e,t,n){const r=e.toLowerCase();if(t.clientId&&-1===r.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===r.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===r.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target){const e=t.target.asArray();for(let t=0;t<e.length;t++){if(n&&!r.includes(e[t].toLowerCase()))return!1;if(!n&&r.includes(e[t].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e,t){const n=this.getTokenKeys(),r=[];return n.accessToken.forEach(n=>{if(!this.accessTokenKeyMatchesFilter(n,e,!0))return;const o=this.getAccessTokenCredential(n,t);o&&this.credentialMatchesFilter(o,e)&&r.push(o)}),r}getRefreshToken(e,t,n,r,o){this.commonLogger.trace("CacheManager - getRefreshToken called");const i=t?H:void 0,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:D.REFRESH_TOKEN,clientId:this.clientId,familyId:i},s=r&&r.refreshToken||this.getTokenKeys().refreshToken,c=[];s.forEach(e=>{if(this.refreshTokenKeyMatchesFilter(e,a)){const t=this.getRefreshTokenCredential(e,n);t&&this.credentialMatchesFilter(t,a)&&c.push(t)}});const l=c.length;return l<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(l>1&&o&&n&&o.addFields({multiMatchedRT:l},n),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),c[0])}refreshTokenKeyMatchesFilter(e,t){const n=e.toLowerCase();return(!t.familyId||-1!==n.indexOf(t.familyId.toLowerCase()))&&(!(!t.familyId&&t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==n.indexOf(t.homeAccountId.toLowerCase())))}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},n=this.getAppMetadataFilteredBy(t),r=Object.keys(n).map(e=>n[e]),o=r.length;if(o<1)return null;if(o>1)throw pt(xe);return r[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==H)}matchHomeAccountId(e,t){return!("string"!=typeof e.homeAccountId||t!==e.homeAccountId)}matchLocalAccountIdFromTokenClaims(e,t){return t===(e.oid||e.sub)}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){return!(t.toLowerCase()!==e.name?.toLowerCase())}matchUsername(e,t){return!(!e||"string"!=typeof e||t?.toLowerCase()!==e.toLowerCase())}matchUserAssertionHash(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const n=function(e,t){let n;const r=e.canonicalAuthority;if(r){const o=new cn(r).getUrlComponents().HostNameAndPort;n=hn(o,e.cloudDiscoveryMetadata?.metadata,K,t)||hn(o,un.metadata,Q,t)||e.knownAuthorities}return n||[]}(this.staticAuthorityOptions,this.commonLogger);if(n.includes(t)&&n.includes(e.environment))return!0}const n=this.getAuthorityMetadataByAlias(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!(!e.clientId||t!==e.clientId)}matchFamilyId(e,t){return!(!e.familyId||t!==e.familyId)}matchRealm(e,t){return!(e.realm?.toLowerCase()!==t.toLowerCase())}matchNativeAccountId(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||(e.preferred_username===t||e.upn===t)}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!(!e.authorityType||t.toLowerCase()!==e.authorityType.toLowerCase())}matchTarget(e,t){if(e.credentialType!==D.ACCESS_TOKEN&&e.credentialType!==D.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;return Jt.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!(!e.tokenType||e.tokenType!==t)}matchKeyId(e,t){return!(!e.keyId||e.keyId!==t)}isAppMetadata(e){return-1!==e.indexOf(U)}isAuthorityMetadata(e){return-1!==e.indexOf(F)}generateAuthorityMetadataCacheKey(e){return`${F}-${this.clientId}-${e}`}static toObject(e,t){for(const n in t)e[n]=t[n];return e}}class In extends Cn{async setAccount(){throw pt(ct)}getAccount(){throw pt(ct)}async setIdTokenCredential(){throw pt(ct)}getIdTokenCredential(){throw pt(ct)}async setAccessTokenCredential(){throw pt(ct)}getAccessTokenCredential(){throw pt(ct)}async setRefreshTokenCredential(){throw pt(ct)}getRefreshTokenCredential(){throw pt(ct)}setAppMetadata(){throw pt(ct)}getAppMetadata(){throw pt(ct)}setServerTelemetry(){throw pt(ct)}getServerTelemetry(){throw pt(ct)}setAuthorityMetadata(){throw pt(ct)}getAuthorityMetadata(){throw pt(ct)}getAuthorityMetadataKeys(){throw pt(ct)}setThrottlingCache(){throw pt(ct)}getThrottlingCache(){throw pt(ct)}removeItem(){throw pt(ct)}getKeys(){throw pt(ct)}getAccountKeys(){throw pt(ct)}getTokenKeys(){throw pt(ct)}generateCredentialKey(){throw pt(ct)}generateAccountKey(){throw pt(ct)}}
/*! @azure/msal-common v15.12.0 2025-08-19 */const kn={AAD:"AAD",OIDC:"OIDC",EAR:"EAR"},wn={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",InitializeCache:"initializeCache",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",GetAuthCodeUrl:"getAuthCodeUrl",GetStandardParams:"getStandardParams",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",HandleResponseEar:"handleResponseEar",HandleResponsePlatformBroker:"handleResponsePlatformBroker",HandleResponseCode:"handleResponseCode",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",ImportExistingCache:"importExistingCache",SetUserData:"setUserData",LocalStorageUpdated:"localStorageUpdated",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues",GenerateHKDF:"generateHKDF",GenerateBaseKey:"generateBaseKey",Base64Decode:"base64Decode",UrlEncodeArr:"urlEncodeArr",Encrypt:"encrypt",Decrypt:"decrypt",GenerateEarKey:"generateEarKey",DecryptEarResponse:"decryptEarResponse"},Tn=new Map([[wn.AcquireTokenByCode,"ATByCode"],[wn.AcquireTokenByRefreshToken,"ATByRT"],[wn.AcquireTokenSilent,"ATS"],[wn.AcquireTokenSilentAsync,"ATSAsync"],[wn.AcquireTokenPopup,"ATPopup"],[wn.AcquireTokenRedirect,"ATRedirect"],[wn.CryptoOptsGetPublicKeyThumbprint,"CryptoGetPKThumb"],[wn.CryptoOptsSignJwt,"CryptoSignJwt"],[wn.SilentCacheClientAcquireToken,"SltCacheClientAT"],[wn.SilentIframeClientAcquireToken,"SltIframeClientAT"],[wn.SilentRefreshClientAcquireToken,"SltRClientAT"],[wn.SsoSilent,"SsoSlt"],[wn.StandardInteractionClientGetDiscoveredAuthority,"StdIntClientGetDiscAuth"],[wn.FetchAccountIdWithNativeBroker,"FetchAccIdWithNtvBroker"],[wn.NativeInteractionClientAcquireToken,"NtvIntClientAT"],[wn.BaseClientCreateTokenRequestHeaders,"BaseClientCreateTReqHead"],[wn.NetworkClientSendPostRequestAsync,"NetClientSendPost"],[wn.RefreshTokenClientExecutePostToTokenEndpoint,"RTClientExecPost"],[wn.AuthorizationCodeClientExecutePostToTokenEndpoint,"AuthCodeClientExecPost"],[wn.BrokerHandhshake,"BrokerHandshake"],[wn.AcquireTokenByRefreshTokenInBroker,"ATByRTInBroker"],[wn.AcquireTokenByBroker,"ATByBroker"],[wn.RefreshTokenClientExecuteTokenRequest,"RTClientExecTReq"],[wn.RefreshTokenClientAcquireToken,"RTClientAT"],[wn.RefreshTokenClientAcquireTokenWithCachedRefreshToken,"RTClientATWithCachedRT"],[wn.RefreshTokenClientAcquireTokenByRefreshToken,"RTClientATByRT"],[wn.RefreshTokenClientCreateTokenRequestBody,"RTClientCreateTReqBody"],[wn.AcquireTokenFromCache,"ATFromCache"],[wn.SilentFlowClientAcquireCachedToken,"SltFlowClientATCached"],[wn.SilentFlowClientGenerateResultFromCacheRecord,"SltFlowClientGenResFromCache"],[wn.AcquireTokenBySilentIframe,"ATBySltIframe"],[wn.InitializeBaseRequest,"InitBaseReq"],[wn.InitializeSilentRequest,"InitSltReq"],[wn.InitializeClientApplication,"InitClientApplication"],[wn.InitializeCache,"InitCache"],[wn.ImportExistingCache,"importCache"],[wn.SetUserData,"setUserData"],[wn.LocalStorageUpdated,"localStorageUpdated"],[wn.SilentIframeClientTokenHelper,"SIClientTHelper"],[wn.SilentHandlerInitiateAuthRequest,"SHandlerInitAuthReq"],[wn.SilentHandlerMonitorIframeForHash,"SltHandlerMonitorIframeForHash"],[wn.SilentHandlerLoadFrame,"SHandlerLoadFrame"],[wn.SilentHandlerLoadFrameSync,"SHandlerLoadFrameSync"],[wn.StandardInteractionClientCreateAuthCodeClient,"StdIntClientCreateAuthCodeClient"],[wn.StandardInteractionClientGetClientConfiguration,"StdIntClientGetClientConf"],[wn.StandardInteractionClientInitializeAuthorizationRequest,"StdIntClientInitAuthReq"],[wn.GetAuthCodeUrl,"GetAuthCodeUrl"],[wn.HandleCodeResponseFromServer,"HandleCodeResFromServer"],[wn.HandleCodeResponse,"HandleCodeResp"],[wn.HandleResponseEar,"HandleRespEar"],[wn.HandleResponseCode,"HandleRespCode"],[wn.HandleResponsePlatformBroker,"HandleRespPlatBroker"],[wn.UpdateTokenEndpointAuthority,"UpdTEndpointAuth"],[wn.AuthClientAcquireToken,"AuthClientAT"],[wn.AuthClientExecuteTokenRequest,"AuthClientExecTReq"],[wn.AuthClientCreateTokenRequestBody,"AuthClientCreateTReqBody"],[wn.PopTokenGenerateCnf,"PopTGenCnf"],[wn.PopTokenGenerateKid,"PopTGenKid"],[wn.HandleServerTokenResponse,"HandleServerTRes"],[wn.DeserializeResponse,"DeserializeRes"],[wn.AuthorityFactoryCreateDiscoveredInstance,"AuthFactCreateDiscInst"],[wn.AuthorityResolveEndpointsAsync,"AuthResolveEndpointsAsync"],[wn.AuthorityResolveEndpointsFromLocalSources,"AuthResolveEndpointsFromLocal"],[wn.AuthorityGetCloudDiscoveryMetadataFromNetwork,"AuthGetCDMetaFromNet"],[wn.AuthorityUpdateCloudDiscoveryMetadata,"AuthUpdCDMeta"],[wn.AuthorityGetEndpointMetadataFromNetwork,"AuthUpdCDMetaFromNet"],[wn.AuthorityUpdateEndpointMetadata,"AuthUpdEndpointMeta"],[wn.AuthorityUpdateMetadataWithRegionalInformation,"AuthUpdMetaWithRegInfo"],[wn.RegionDiscoveryDetectRegion,"RegDiscDetectReg"],[wn.RegionDiscoveryGetRegionFromIMDS,"RegDiscGetRegFromIMDS"],[wn.RegionDiscoveryGetCurrentVersion,"RegDiscGetCurrentVer"],[wn.AcquireTokenByCodeAsync,"ATByCodeAsync"],[wn.GetEndpointMetadataFromNetwork,"GetEndpointMetaFromNet"],[wn.GetCloudDiscoveryMetadataFromNetworkMeasurement,"GetCDMetaFromNet"],[wn.HandleRedirectPromiseMeasurement,"HandleRedirectPromise"],[wn.HandleNativeRedirectPromiseMeasurement,"HandleNtvRedirectPromise"],[wn.UpdateCloudDiscoveryMetadataMeasurement,"UpdateCDMeta"],[wn.UsernamePasswordClientAcquireToken,"UserPassClientAT"],[wn.NativeMessageHandlerHandshake,"NtvMsgHandlerHandshake"],[wn.NativeGenerateAuthResult,"NtvGenAuthRes"],[wn.RemoveHiddenIframe,"RemoveHiddenIframe"],[wn.ClearTokensAndKeysWithClaims,"ClearTAndKeysWithClaims"],[wn.CacheManagerGetRefreshToken,"CacheManagerGetRT"],[wn.GeneratePkceCodes,"GenPkceCodes"],[wn.GenerateCodeVerifier,"GenCodeVerifier"],[wn.GenerateCodeChallengeFromVerifier,"GenCodeChallengeFromVerifier"],[wn.Sha256Digest,"Sha256Digest"],[wn.GetRandomValues,"GetRandomValues"],[wn.GenerateHKDF,"genHKDF"],[wn.GenerateBaseKey,"genBaseKey"],[wn.Base64Decode,"b64Decode"],[wn.UrlEncodeArr,"urlEncArr"],[wn.Encrypt,"encrypt"],[wn.Decrypt,"decrypt"],[wn.GenerateEarKey,"genEarKey"],[wn.DecryptEarResponse,"decryptEarResp"]]),An=1,bn=2,Sn=new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT","unencryptedCacheCount","encryptedCacheExpiredCount","oldAccountCount","oldAccessCount","oldIdCount","oldRefreshCount","currAccountCount","currAccessCount","currIdCount","currRefreshCount","expiredCacheRemovedCount","upgradedCacheCount"]);
/*! @azure/msal-common v15.12.0 2025-08-19 */
/*! @azure/msal-common v15.12.0 2025-08-19 */
class Rn{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class En{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:An,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new Rn}}startPerformanceMeasurement(){return new Rn}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}
/*! @azure/msal-common v15.12.0 2025-08-19 */const _n={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},Pn={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:e.LogLevel.Info,correlationId:t.EMPTY_STRING},Mn={claimsBasedCachingEnabled:!1},qn={async sendGetRequestAsync(){throw pt(ct)},async sendPostRequestAsync(){throw pt(ct)}},On={sku:t.SKU,version:Ct,cpu:t.EMPTY_STRING,os:t.EMPTY_STRING},Nn={clientSecret:t.EMPTY_STRING,clientAssertion:void 0},Bn={azureCloudInstance:It.None,tenant:`${t.DEFAULT_COMMON_TENANT}`},xn={application:{appName:"",appVersion:""}};function Ln(e){return e.authOptions.authority.options.protocolMode===kn.OIDC}
/*! @azure/msal-common v15.12.0 2025-08-19 */const Dn="home_account_id",Un="UPN";
/*! @azure/msal-common v15.12.0 2025-08-19 */function Hn(e,t){if(!e)throw pt(ke);try{const n=t(e);return JSON.parse(n)}catch(e){throw pt(Ie)}}function Fn(e){if(!e)throw pt(Ie);const n=e.split(L,2);return{uid:n[0],utid:n.length<2?t.EMPTY_STRING:n[1]}}
/*! @azure/msal-common v15.12.0 2025-08-19 */const zn="client_id",Kn="redirect_uri",$n="token_type",Gn="req_cnf",Qn="return_spa_code",jn="x-client-xtra-sku",Wn="brk_client_id",Vn="brk_redirect_uri",Jn="instance_aware";
/*! @azure/msal-common v15.12.0 2025-08-19 */
function Yn(e,t,n){if(!t)return;const r=e.get(zn);r&&e.has(Wn)&&n?.addFields({embeddedClientId:r,embeddedRedirectUri:e.get(Kn)},t)}function Xn(e,t){e.set("response_type",t)}function Zn(e,t,n=!0,r=u){!n||r.includes("openid")||t.includes("openid")||r.push("openid");const o=n?[...t||[],...r]:t||[],i=new Jt(o);e.set("scope",i.printScopes())}function er(e,t){e.set(zn,t)}function tr(e,t){e.set(Kn,t)}function nr(e,t){e.set("login_hint",t)}function rr(e,t){e.set(f,`UPN:${t}`)}function or(e,t){e.set(f,`Oid:${t.uid}@${t.utid}`)}function ir(e,t){e.set("sid",t)}function ar(e,t,n){const r=Cr(t,n);try{JSON.parse(r)}catch(e){throw Wt(Rt)}e.set("claims",r)}function sr(e,t){e.set("client-request-id",t)}function cr(e,t){e.set("x-client-SKU",t.sku),e.set("x-client-VER",t.version),t.os&&e.set("x-client-OS",t.os),t.cpu&&e.set("x-client-CPU",t.cpu)}function lr(e,t){t?.appName&&e.set("x-app-name",t.appName),t?.appVersion&&e.set("x-app-ver",t.appVersion)}function ur(e,t){t&&e.set("state",t)}function dr(e,t,n){if(!t||!n)throw Wt(Mt);e.set("code_challenge",t),e.set("code_challenge_method",n)}function hr(e,t){e.set("client_secret",t)}function gr(e,t){t&&e.set("client_assertion",t)}function pr(e,t){t&&e.set("client_assertion_type",t)}function fr(e,t){e.set("grant_type",t)}function mr(e){e.set("client_info","1")}function vr(e){e.has(Jn)||e.set(Jn,"true")}function yr(e,t){Object.entries(t).forEach(([t,n])=>{!e.has(t)&&n&&e.set(t,n)})}function Cr(e,t){let n;if(e)try{n=JSON.parse(e)}catch(e){throw Wt(Rt)}else n={};return t&&t.length>0&&(n.hasOwnProperty(A)||(n[A]={}),n[A][b]={values:t}),JSON.stringify(n)}function Ir(e,t){t&&(e.set($n,W.POP),e.set(Gn,t))}function kr(e,t){t&&(e.set($n,W.SSH),e.set(Gn,t))}function wr(e,t){e.set("x-client-current-telemetry",t.generateCurrentRequestHeaderValue()),e.set("x-client-last-telemetry",t.generateLastRequestHeaderValue())}function Tr(e){e.set("x-ms-lib-capability",X)}function Ar(e,t,n){e.has(Wn)||e.set(Wn,t),e.has(Vn)||e.set(Vn,n)}
/*! @azure/msal-common v15.12.0 2025-08-19 */
const br=0,Sr=1,Rr=2,Er=3;
/*! @azure/msal-common v15.12.0 2025-08-19 */
/*! @azure/msal-common v15.12.0 2025-08-19 */
const _r=(e,t,n,r,o)=>(...i)=>{n.trace(`Executing function ${t}`);const a=r?.startMeasurement(t,o);if(o){const e=t+"CallCount";r?.incrementFields({[e]:1},o)}try{const r=e(...i);return a?.end({success:!0}),n.trace(`Returning result from ${t}`),r}catch(e){n.trace(`Error occurred in ${t}`);try{n.trace(JSON.stringify(e))}catch(e){n.trace("Unable to print error message.")}throw a?.end({success:!1},e),e}},Pr=(e,t,n,r,o)=>(...i)=>{n.trace(`Executing function ${t}`);const a=r?.startMeasurement(t,o);if(o){const e=t+"CallCount";r?.incrementFields({[e]:1},o)}return r?.setPreQueueTime(t,o),e(...i).then(e=>(n.trace(`Returning result from ${t}`),a?.end({success:!0}),e)).catch(e=>{n.trace(`Error occurred in ${t}`);try{n.trace(JSON.stringify(e))}catch(e){n.trace("Unable to print error message.")}throw a?.end({success:!1},e),e})};
/*! @azure/msal-common v15.12.0 2025-08-19 */
class Mr{constructor(e,t,n,r){this.networkInterface=e,this.logger=t,this.performanceClient=n,this.correlationId=r}async detectRegion(e,r){this.performanceClient?.addQueueMeasurement(wn.RegionDiscoveryDetectRegion,this.correlationId);let i=e;if(i)r.region_source=ne;else{const e=Mr.IMDS_OPTIONS;try{const a=await Pr(this.getRegionFromIMDS.bind(this),wn.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(t.IMDS_VERSION,e);if(a.status===n&&(i=a.body,r.region_source=re),a.status===o){const t=await Pr(this.getCurrentVersion.bind(this),wn.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(e);if(!t)return r.region_source=te,null;const o=await Pr(this.getRegionFromIMDS.bind(this),wn.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(t,e);o.status===n&&(i=o.body,r.region_source=re)}}catch(e){return r.region_source=te,null}}return i||(r.region_source=te),i||null}async getRegionFromIMDS(e,n){return this.performanceClient?.addQueueMeasurement(wn.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${t.IMDS_ENDPOINT}?api-version=${e}&format=text`,n,t.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(wn.RegionDiscoveryGetCurrentVersion,this.correlationId);try{const n=await this.networkInterface.sendGetRequestAsync(`${t.IMDS_ENDPOINT}?format=json`,e);return n.status===o&&n.body&&n.body["newest-versions"]&&n.body["newest-versions"].length>0?n.body["newest-versions"][0]:null}catch(e){return null}}}
/*! @azure/msal-common v15.12.0 2025-08-19 */
function qr(){return Math.round((new Date).getTime()/1e3)}function Or(e){return e.getTime()/1e3}function Nr(e){return e?new Date(1e3*Number(e)):new Date}function Br(e,t){const n=Number(e)||0;return qr()+t>n}function xr(e,t){const n=Number(e)+24*t*60*60*1e3;return Date.now()>n}function Lr(e){return Number(e)>qr()}
/*! @azure/msal-common v15.12.0 2025-08-19 */function Dr(e,t,n,r,o){return{credentialType:D.ID_TOKEN,homeAccountId:e,environment:t,clientId:r,secret:n,realm:o,lastUpdatedAt:Date.now().toString()}}function Ur(e,t,n,r,o,i,a,s,c,l,u,d,h,g,p){const f={homeAccountId:e,credentialType:D.ACCESS_TOKEN,secret:n,cachedAt:qr().toString(),expiresOn:a.toString(),extendedExpiresOn:s.toString(),environment:t,clientId:r,realm:o,target:i,tokenType:u||W.BEARER,lastUpdatedAt:Date.now().toString()};if(d&&(f.userAssertionHash=d),l&&(f.refreshOn=l.toString()),g&&(f.requestedClaims=g,f.requestedClaimsHash=p),f.tokenType?.toLowerCase()!==W.BEARER.toLowerCase())switch(f.credentialType=D.ACCESS_TOKEN_WITH_AUTH_SCHEME,f.tokenType){case W.POP:const e=en(n,c);if(!e?.cnf?.kid)throw pt(et);f.keyId=e.cnf.kid;break;case W.SSH:f.keyId=h}return f}function Hr(e,t,n,r,o,i,a){const s={credentialType:D.REFRESH_TOKEN,homeAccountId:e,environment:t,clientId:r,secret:n,lastUpdatedAt:Date.now().toString()};return i&&(s.userAssertionHash=i),o&&(s.familyId=o),a&&(s.expiresOn=a.toString()),s}function Fr(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")}function zr(e){return!!e&&(Fr(e)&&e.hasOwnProperty("realm")&&e.hasOwnProperty("target")&&(e.credentialType===D.ACCESS_TOKEN||e.credentialType===D.ACCESS_TOKEN_WITH_AUTH_SCHEME))}function Kr(e){return!!e&&(Fr(e)&&e.credentialType===D.REFRESH_TOKEN)}function $r(){return qr()+z}function Gr(e,t,n){e.authorization_endpoint=t.authorization_endpoint,e.token_endpoint=t.token_endpoint,e.end_session_endpoint=t.end_session_endpoint,e.issuer=t.issuer,e.endpointsFromNetwork=n,e.jwks_uri=t.jwks_uri}function Qr(e,t,n){e.aliases=t.aliases,e.preferred_cache=t.preferred_cache,e.preferred_network=t.preferred_network,e.aliasesFromNetwork=n}function jr(e){return e.expiresAt<=qr()}
/*! @azure/msal-common v15.12.0 2025-08-19 */Mr.IMDS_OPTIONS={headers:{Metadata:"true"}};class Wr{constructor(e,t,n,r,o,i,a,s){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=n,this.authorityOptions=r,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=o,this.performanceClient=a,this.correlationId=i,this.managedIdentity=s||!1,this.regionDiscovery=new Mr(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(t.CIAM_AUTH_URL))return Er;const n=e.PathSegments;if(n.length)switch(n[0].toLowerCase()){case t.ADFS:return Sr;case t.DSTS:return Rr}return br}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new cn(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw pt(Ae)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw pt(Ae)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw pt(Ae)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw pt(rt);return this.replacePath(this.metadata.end_session_endpoint)}throw pt(Ae)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw pt(Ae)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw pt(Ae)}canReplaceTenant(e){return 1===e.PathSegments.length&&!Wr.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===br&&this.protocolMode!==kn.OIDC}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const n=new cn(this.metadata.canonical_authority).getUrlComponents(),r=n.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((e,o)=>{let i=r[o];if(0===o&&this.canReplaceTenant(n)){const e=new cn(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];i!==e&&(this.logger.verbose(`Replacing tenant domain name ${i} with id ${e}`),i=e)}e!==i&&(t=t.replace(`/${i}/`,`/${e}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===Sr||this.protocolMode===kn.OIDC&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(wn.AuthorityResolveEndpointsAsync,this.correlationId);const e=this.getCurrentMetadataEntity(),t=await Pr(this.updateCloudDiscoveryMetadata.bind(this),wn.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const n=await Pr(this.updateEndpointMetadata.bind(this),wn.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:n}),this.performanceClient?.addFields({cloudDiscoverySource:t,authorityEndpointSource:n},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:$r(),jwks_uri:""}),e}updateCachedMetadata(e,t,n){t!==$&&n?.source!==$&&(e.expiresAt=$r(),e.canonical_authority=this.canonicalAuthority);const r=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(r,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(wn.AuthorityUpdateEndpointMetadata,this.correlationId);const t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===Q&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&t.metadata){Gr(e,await Pr(this.updateMetadataWithRegionalInformation.bind(this),wn.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(t.metadata),!1),e.canonical_authority=this.canonicalAuthority}return t.source}let n=await Pr(this.getEndpointMetadataFromNetwork.bind(this),wn.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(n=await Pr(this.updateMetadataWithRegionalInformation.bind(this),wn.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(n)),Gr(e,n,!0),G;throw pt(Se,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),Gr(e,t,!1),{source:K};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const t=this.getEndpointMetadataFromHardcodedValues();if(t)return Gr(e,t,!1),{source:Q,metadata:t};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const n=jr(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!n?(this.logger.verbose("Found endpoint metadata in the cache."),{source:$}):(n&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new cn(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw Wt(Ot)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(wn.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);const e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{const n=await this.networkInterface.sendGetRequestAsync(t,e),r=function(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}
/*! @azure/msal-common v15.12.0 2025-08-19 */(n.body);return r?n.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(e){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${e}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in ln?ln[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(wn.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);const n=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(n){if(n!==t.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=oe,this.regionDiscoveryMetadata.region_used=n,Wr.replaceWithRegionalInformation(e,n);const r=await Pr(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),wn.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(r)return this.regionDiscoveryMetadata.region_outcome=ie,this.regionDiscoveryMetadata.region_used=r,Wr.replaceWithRegionalInformation(e,r);this.regionDiscoveryMetadata.region_outcome=ae}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(wn.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);const t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;const n=await Pr(this.getCloudDiscoveryMetadataFromNetwork.bind(this),wn.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return Qr(e,n,!0),G;throw Wt(Nt)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||t.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||t.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||t.NOT_APPLICABLE}`);const n=this.getCloudDiscoveryMetadataFromConfig();if(n)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),Qr(e,n,!1),K;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const t=(r=this.hostnameAndPort,gn(un.metadata,r));if(t)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),Qr(e,t,!1),Q;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}var r;const o=jr(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!o?(this.logger.verbose("Found cloud discovery metadata in the cache."),$):(o&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===Er)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),Wr.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=gn(JSON.parse(this.authorityOptions.cloudDiscoveryMetadata).metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),e)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),e;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Wt(qt)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),Wr.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(wn.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);const e=`${t.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,n={};let r=null;try{const o=await this.networkInterface.sendGetRequestAsync(e,n);let i,a;if(function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}
/*! @azure/msal-common v15.12.0 2025-08-19 */(o.body))i=o.body,a=i.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${i.tenant_discovery_endpoint}`);else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(o.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${o.status}`),i=o.body,i.error===t.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${i.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${i.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=gn(a,this.hostnameAndPort)}catch(e){if(e instanceof ye)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.\nError: ${e.errorCode}\nError Description: ${e.errorMessage}`);else{const t=e;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ${t.name}\nError Description: ${t.message}`)}return null}return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=Wr.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),r}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(e=>e&&cn.getDomainFromUrl(e).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,n){let r;if(n&&n.azureCloudInstance!==It.None){const e=n.tenant?n.tenant:t.DEFAULT_COMMON_TENANT;r=`${n.azureCloudInstance}/${e}/`}return r||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return t.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw pt(Ae)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return dn.has(e)}static isPublicCloudAuthority(e){return t.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,n,r){const o=new cn(e);o.validateAsUri();const i=o.getUrlComponents();let a=`${n}.${i.HostNameAndPort}`;this.isPublicCloudAuthority(i.HostNameAndPort)&&(a=`${n}.${t.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const s=cn.constructAuthorityUriFromObject({...o.getUrlComponents(),HostNameAndPort:a}).urlString;return r?`${s}?${r}`:s}static replaceWithRegionalInformation(e,t){const n={...e};return n.authorization_endpoint=Wr.buildRegionalAuthorityString(n.authorization_endpoint,t),n.token_endpoint=Wr.buildRegionalAuthorityString(n.token_endpoint,t),n.end_session_endpoint&&(n.end_session_endpoint=Wr.buildRegionalAuthorityString(n.end_session_endpoint,t)),n}static transformCIAMAuthority(e){let n=e;const r=new cn(e).getUrlComponents();if(0===r.PathSegments.length&&r.HostNameAndPort.endsWith(t.CIAM_AUTH_URL)){n=`${n}${r.HostNameAndPort.split(".")[0]}${t.AAD_TENANT_DOMAIN_SUFFIX}`}return n}}function Vr(e){return e.endsWith(t.FORWARD_SLASH)?e:`${e}${t.FORWARD_SLASH}`}function Jr(e){const t=e.cloudDiscoveryMetadata;let n;if(t)try{n=JSON.parse(t)}catch(e){throw Wt(qt)}return{canonicalAuthority:e.authority?Vr(e.authority):void 0,knownAuthorities:e.knownAuthorities,cloudDiscoveryMetadata:n}}
/*! @azure/msal-common v15.12.0 2025-08-19 */async function Yr(e,t,n,r,o,i,a){a?.addQueueMeasurement(wn.AuthorityFactoryCreateDiscoveredInstance,i);const s=Wr.transformCIAMAuthority(Vr(e)),c=new Wr(s,t,n,r,o,i,a);try{return await Pr(c.resolveEndpointsAsync.bind(c),wn.AuthorityResolveEndpointsAsync,o,a,i)(),c}catch(e){throw pt(Ae)}}
/*! @azure/msal-common v15.12.0 2025-08-19 */Wr.reservedTenantDomains=new Set(["{tenant}","{tenantid}",k,T,w]);class Xr extends ye{constructor(e,t,n,r,o){super(e,t,n),this.name="ServerError",this.errorNo=r,this.status=o,Object.setPrototypeOf(this,Xr.prototype)}}
/*! @azure/msal-common v15.12.0 2025-08-19 */function Zr(e,t,n){return{clientId:e,authority:t.authority,scopes:t.scopes,homeAccountIdentifier:n,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid,embeddedClientId:t.embeddedClientId||t.tokenBodyParameters?.clientId}}
/*! @azure/msal-common v15.12.0 2025-08-19 */class eo{static generateThrottlingStorageKey(e){return`${Y}.${JSON.stringify(e)}`}static preProcess(e,n,r){const o=eo.generateThrottlingStorageKey(n),i=e.getThrottlingCache(o);if(i){if(i.throttleTime<Date.now())return void e.removeItem(o,r);throw new Xr(i.errorCodes?.join(" ")||t.EMPTY_STRING,i.errorMessage,i.subError)}}static postProcess(e,t,n,r){if(eo.checkResponseStatus(n)||eo.checkResponseForRetryAfter(n)){const o={throttleTime:eo.calculateThrottleTime(parseInt(n.headers[p])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};e.setThrottlingCache(eo.generateThrottlingStorageKey(t),o,r)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&(e.headers.hasOwnProperty(p)&&(e.status<200||e.status>=300))}static calculateThrottleTime(e){const t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(1e3*Math.min(n+(t||V),n+J))}static removeThrottle(e,t,n,r){const o=Zr(t,n,r),i=this.generateThrottlingStorageKey(o);e.removeItem(i,n.correlationId)}}
/*! @azure/msal-common v15.12.0 2025-08-19 */class to extends ye{constructor(e,t,n){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,to.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=n}}function no(e,t,n,r){return e.errorMessage=`${e.errorMessage}, additionalErrorInfo: error.name:${r?.name}, error.message:${r?.message}`,new to(e,t,n)}
/*! @azure/msal-common v15.12.0 2025-08-19 */class ro{constructor(e,t){this.config=function({authOptions:e,systemOptions:t,loggerOptions:n,cacheOptions:r,storageInterface:o,networkInterface:i,cryptoInterface:a,clientCredentials:s,libraryInfo:c,telemetry:l,serverTelemetryManager:u,persistencePlugin:d,serializableCache:h}){const g={...Pn,...n};return{authOptions:(p=e,{clientCapabilities:[],azureCloudOptions:Bn,skipAuthorityMetadataCache:!1,instanceAware:!1,encodeExtraQueryParams:!1,...p}),systemOptions:{..._n,...t},loggerOptions:g,cacheOptions:{...Mn,...r},storageInterface:o||new In(e.clientId,ft,new vt(g),new En),networkInterface:i||qn,cryptoInterface:a||ft,clientCredentials:s||Nn,libraryInfo:{...On,...c},telemetry:{...xn,...l},serverTelemetryManager:u||null,persistencePlugin:d||null,serializableCache:h||null};var p}(e),this.logger=new vt(this.config.loggerOptions,yt,Ct),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const n={};if(n[h]=t.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Dn:try{const t=Fn(e.credential);n[f]=`Oid:${t.uid}@${t.utid}`}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Un:n[f]=`UPN: ${e.credential}`}return n}async executePostToTokenEndpoint(e,t,n,r,o,i){i&&this.performanceClient?.addQueueMeasurement(i,o);const a=await this.sendPostRequest(r,e,{body:t,headers:n},o);return this.config.serverTelemetryManager&&a.status<500&&429!==a.status&&this.config.serverTelemetryManager.clearTelemetryCache(),a}async sendPostRequest(e,t,n,r){let o;eo.preProcess(this.cacheManager,e,r);try{o=await Pr(this.networkClient.sendPostRequestAsync.bind(this.networkClient),wn.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,r)(t,n);const e=o.headers||{};this.performanceClient?.addFields({refreshTokenSize:o.body.refresh_token?.length||0,httpVerToken:e[C]||"",requestId:e[y]||""},r)}catch(e){if(e instanceof to){const t=e.responseHeaders;throw t&&this.performanceClient?.addFields({httpVerToken:t[C]||"",requestId:t[y]||"",contentTypeHeader:t[h]||void 0,contentLengthHeader:t[g]||void 0,httpStatus:e.httpStatus},r),e.error}throw e instanceof ye?e:pt(be)}return eo.postProcess(this.cacheManager,e,o,r),o}async updateAuthority(e,t){this.performanceClient?.addQueueMeasurement(wn.UpdateTokenEndpointAuthority,t);const n=`https://${e}/${this.authority.tenant}/`,r=await Yr(n,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=r}createTokenQueryParameters(e){const t=new Map;return e.embeddedClientId&&Ar(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&yr(t,e.tokenQueryParameters),sr(t,e.correlationId),Yn(t,e.correlationId,this.performanceClient),an(t)}}
/*! @azure/msal-common v15.12.0 2025-08-19 */function oo(e){if(e){return e.tid||e.tfp||e.acr||null}return null}
/*! @azure/msal-common v15.12.0 2025-08-19 */class io{getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,loginHint:this.loginHint,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static createAccount(e,t,n){const r=new io;let o;t.authorityType===Sr?r.authorityType=N:t.protocolMode===kn.OIDC?r.authorityType=B:r.authorityType=O,e.clientInfo&&n&&(o=Hn(e.clientInfo,n)),r.clientInfo=e.clientInfo,r.homeAccountId=e.homeAccountId,r.nativeAccountId=e.nativeAccountId;const i=e.environment||t&&t.getPreferredCache();if(!i)throw pt(Qe);r.environment=i,r.realm=o?.utid||oo(e.idTokenClaims)||"",r.localAccountId=o?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";const a=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,s=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(r.username=a||s||"",r.loginHint=e.idTokenClaims?.login_hint,r.name=e.idTokenClaims?.name||"",r.cloudGraphHostName=e.cloudGraphHostName,r.msGraphHost=e.msGraphHost,e.tenantProfiles)r.tenantProfiles=e.tenantProfiles;else{const t=Xt(e.homeAccountId,r.localAccountId,r.realm,e.idTokenClaims);r.tenantProfiles=[t]}return r}static createFromAccountInfo(e,t,n){const r=new io;return r.authorityType=e.authorityType||B,r.homeAccountId=e.homeAccountId,r.localAccountId=e.localAccountId,r.nativeAccountId=e.nativeAccountId,r.realm=e.tenantId,r.environment=e.environment,r.username=e.username,r.name=e.name,r.loginHint=e.loginHint,r.cloudGraphHostName=t,r.msGraphHost=n,r.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),r}static generateHomeAccountId(e,t,n,r,o){if(t!==Sr&&t!==Rr){if(e)try{const t=Hn(e,r.base64Decode);if(t.uid&&t.utid)return`${t.uid}.${t.utid}`}catch(e){}n.warning("No client info in response")}return o?.sub||""}static isAccountEntity(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))}static accountInfoIsEqual(e,t,n){if(!e||!t)return!1;let r=!0;if(n){const n=e.idTokenClaims||{},o=t.idTokenClaims||{};r=n.iat===o.iat&&n.nonce===o.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.loginHint===t.loginHint&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&r}}
/*! @azure/msal-common v15.12.0 2025-08-19 */const ao="no_tokens_found",so="native_account_unavailable",co="refresh_token_expired",lo="ux_not_allowed",uo="interaction_required",ho="consent_required",go="login_required",po="bad_token";var fo=Object.freeze({__proto__:null,badToken:po,consentRequired:ho,interactionRequired:uo,loginRequired:go,nativeAccountUnavailable:so,noTokensFound:ao,refreshTokenExpired:co,uxNotAllowed:lo});
/*! @azure/msal-common v15.12.0 2025-08-19 */const mo=[uo,ho,go,po,lo],vo=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],yo={[ao]:"No refresh token found in the cache. Please sign-in.",[so]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[co]:"Refresh token has expired.",[po]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve.",[lo]:"`canShowUI` flag in Edge was set to false. User interaction required on web page. Please invoke an interactive API to resolve."},Co={noTokensFoundError:{code:ao,desc:yo[ao]},native_account_unavailable:{code:so,desc:yo[so]},bad_token:{code:po,desc:yo[po]}};class Io extends ye{constructor(e,n,r,o,i,a,s,c){super(e,n,r),Object.setPrototypeOf(this,Io.prototype),this.timestamp=o||t.EMPTY_STRING,this.traceId=i||t.EMPTY_STRING,this.correlationId=a||t.EMPTY_STRING,this.claims=s||t.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=c}}function ko(e,t,n){const r=!!e&&mo.indexOf(e)>-1,o=!!n&&vo.indexOf(n)>-1,i=!!t&&mo.some(e=>t.indexOf(e)>-1);return r||i||o}function wo(e){return new Io(e,yo[e])}
/*! @azure/msal-common v15.12.0 2025-08-19 */class To{static setRequestState(e,n,r){const o=To.generateLibraryState(e,r);return n?`${o}${t.RESOURCE_DELIM}${n}`:o}static generateLibraryState(e,t){if(!e)throw pt(We);const n={id:e.createNewGuid()};t&&(n.meta=t);const r=JSON.stringify(n);return e.base64Encode(r)}static parseRequestState(e,n){if(!e)throw pt(We);if(!n)throw pt(Ee);try{const r=n.split(t.RESOURCE_DELIM),o=r[0],i=r.length>1?r.slice(1).join(t.RESOURCE_DELIM):t.EMPTY_STRING,a=e.base64Decode(o),s=JSON.parse(a);return{userRequestState:i||t.EMPTY_STRING,libraryState:s}}catch(e){throw pt(Ee)}}}
/*! @azure/msal-common v15.12.0 2025-08-19 */const Ao="sw";class bo{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){this.performanceClient?.addQueueMeasurement(wn.PopTokenGenerateCnf,e.correlationId);const n=await Pr(this.generateKid.bind(this),wn.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),r=this.cryptoUtils.base64UrlEncode(JSON.stringify(n));return{kid:n.kid,reqCnfString:r}}async generateKid(e){this.performanceClient?.addQueueMeasurement(wn.PopTokenGenerateKid,e.correlationId);return{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:Ao}}async signPopToken(e,t,n){return this.signPayload(e,t,n)}async signPayload(e,t,n,r){const{resourceRequestMethod:o,resourceRequestUri:i,shrClaims:a,shrNonce:s,shrOptions:c}=n,l=i?new cn(i):void 0,u=l?.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:qr(),m:o?.toUpperCase(),u:u?.HostNameAndPort,nonce:s||this.cryptoUtils.createNewGuid(),p:u?.AbsolutePath,q:u?.QueryString?[[],u.QueryString]:void 0,client_claims:a||void 0,...r},t,c,n.correlationId)}}
/*! @azure/msal-common v15.12.0 2025-08-19 */class So{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}
/*! @azure/msal-common v15.12.0 2025-08-19 */class Ro{constructor(e,t,n,r,o,i,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=r,this.serializableCache=o,this.persistencePlugin=i,this.performanceClient=a}validateTokenResponse(e,n){if(e.error||e.error_description||e.suberror){const o=`Error(s): ${e.error_codes||t.NOT_AVAILABLE} - Timestamp: ${e.timestamp||t.NOT_AVAILABLE} - Description: ${e.error_description||t.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||t.NOT_AVAILABLE} - Trace ID: ${e.trace_id||t.NOT_AVAILABLE}`,c=e.error_codes?.length?e.error_codes[0]:void 0,l=new Xr(e.error,o,e.suberror,c,e.status);if(n&&e.status&&e.status>=a&&e.status<=s)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n${l}`);if(n&&e.status&&e.status>=r&&e.status<=i)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n${l}`);if(ko(e.error,e.error_description,e.suberror))throw new Io(e.error,e.error_description,e.suberror,e.timestamp||t.EMPTY_STRING,e.trace_id||t.EMPTY_STRING,e.correlation_id||t.EMPTY_STRING,e.claims||t.EMPTY_STRING,c);throw l}}async handleServerTokenResponse(e,n,r,o,i,a,s,c,l){let u,d;if(this.performanceClient?.addQueueMeasurement(wn.HandleServerTokenResponse,e.correlation_id),e.id_token){if(u=en(e.id_token||t.EMPTY_STRING,this.cryptoObj.base64Decode),i&&i.nonce&&u.nonce!==i.nonce)throw pt(Me);if(o.maxAge||0===o.maxAge){const e=u.auth_time;if(!e)throw pt(qe);tn(e,o.maxAge)}}this.homeAccountIdentifier=io.generateHomeAccountId(e.client_info||t.EMPTY_STRING,n.authorityType,this.logger,this.cryptoObj,u),i&&i.state&&(d=To.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||o.sshKid||void 0;const h=this.generateCacheRecord(e,n,r,o,u,a,i);let g;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),g=new So(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(g)),s&&!c&&h.account){const e=this.cacheStorage.generateAccountKey(h.account.getAccountInfo());if(!this.cacheStorage.getAccount(e,o.correlationId))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await Ro.generateAuthenticationResult(this.cryptoObj,n,h,!1,o,u,d,void 0,l)}await this.cacheStorage.saveCacheRecord(h,o.correlationId,o.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&g&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(g))}return Ro.generateAuthenticationResult(this.cryptoObj,n,h,!1,o,u,d,e,l)}generateCacheRecord(e,t,n,r,o,i,a){const s=t.getPreferredCache();if(!s)throw pt(Qe);const c=oo(o);let l,u;e.id_token&&o&&(l=Dr(this.homeAccountIdentifier,s,e.id_token,this.clientId,c||""),u=Eo(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,r.correlationId,o,e.client_info,s,c,a,void 0,this.logger));let d=null;if(e.access_token){const o=e.scope?Jt.fromString(e.scope):new Jt(r.scopes||[]),a=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,l=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,u=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,h=n+a,g=h+l,p=u&&u>0?n+u:void 0;d=Ur(this.homeAccountIdentifier,s,e.access_token,this.clientId,c||t.tenant||"",o.printScopes(),h,g,this.cryptoObj.base64Decode,p,e.token_type,i,e.key_id,r.claims,r.requestedClaimsHash)}let h=null;if(e.refresh_token){let t;if(e.refresh_token_expires_in){t=n+("string"==typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)}h=Hr(this.homeAccountIdentifier,s,e.refresh_token,this.clientId,e.foci,i,t)}let g=null;return e.foci&&(g={clientId:this.clientId,environment:s,familyId:e.foci}),{account:u,idToken:l,accessToken:d,refreshToken:h,appMetadata:g}}static async generateAuthenticationResult(e,n,r,o,i,a,s,c,l){let u,d,h=t.EMPTY_STRING,g=[],p=null,f=t.EMPTY_STRING;if(r.accessToken){if(r.accessToken.tokenType!==W.POP||i.popKid)h=r.accessToken.secret;else{const t=new bo(e),{secret:n,keyId:o}=r.accessToken;if(!o)throw pt(ot);h=await t.signPopToken(n,o,i)}g=Jt.fromString(r.accessToken.target).asArray(),p=Nr(r.accessToken.expiresOn),u=Nr(r.accessToken.extendedExpiresOn),r.accessToken.refreshOn&&(d=Nr(r.accessToken.refreshOn))}r.appMetadata&&(f=r.appMetadata.familyId===H?H:"");const m=a?.oid||a?.sub||"",v=a?.tid||"";c?.spa_accountid&&r.account&&(r.account.nativeAccountId=c?.spa_accountid);const y=r.account?Zt(r.account.getAccountInfo(),void 0,a,r.idToken?.secret):null;return{authority:n.canonicalAuthority,uniqueId:m,tenantId:v,scopes:g,account:y,idToken:r?.idToken?.secret||"",idTokenClaims:a||{},accessToken:h,fromCache:o,expiresOn:p,extExpiresOn:u,refreshOn:d,correlationId:i.correlationId,requestId:l||t.EMPTY_STRING,familyId:f,tokenType:r.accessToken?.tokenType||t.EMPTY_STRING,state:s?s.userRequestState:t.EMPTY_STRING,cloudGraphHostName:r.account?.cloudGraphHostName||t.EMPTY_STRING,msGraphHost:r.account?.msGraphHost||t.EMPTY_STRING,code:c?.spa_code,fromNativeBroker:!1}}}function Eo(e,t,n,r,o,i,a,s,c,l,u,d){d?.verbose("setCachedAccount called");const h=e.getAccountKeys().find(e=>e.startsWith(n));let g=null;h&&(g=e.getAccount(h,o));const p=g||io.createAccount({homeAccountId:n,idTokenClaims:i,clientInfo:a,environment:s,cloudGraphHostName:l?.cloud_graph_host_name,msGraphHost:l?.msgraph_host,nativeAccountId:u},t,r),f=p.tenantProfiles||[],m=c||p.realm;if(m&&!f.find(e=>e.tenantId===m)){const e=Xt(n,p.localAccountId,m,i);f.push(e)}return p.tenantProfiles=f,p}
/*! @azure/msal-common v15.12.0 2025-08-19 */async function _o(e,t,n){if("string"==typeof e)return e;return e({clientId:t,tokenEndpoint:n})}
/*! @azure/msal-common v15.12.0 2025-08-19 */class Po extends ro{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async acquireToken(e,t){if(this.performanceClient?.addQueueMeasurement(wn.AuthClientAcquireToken,e.correlationId),!e.code)throw pt(Le);const n=qr(),r=await Pr(this.executeTokenRequest.bind(this),wn.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),o=r.headers?.[y],i=new Ro(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return i.validateTokenResponse(r.body),Pr(i.handleServerTokenResponse.bind(i),wn.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(r.body,this.authority,n,e,t,void 0,void 0,void 0,o)}getLogoutUri(e){if(!e)throw Wt(_t);const t=this.createLogoutUrlQueryString(e);return cn.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(wn.AuthClientExecuteTokenRequest,t.correlationId);const n=this.createTokenQueryParameters(t),r=cn.appendQueryString(e.tokenEndpoint,n),o=await Pr(this.createTokenRequestBody.bind(this),wn.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t);let i;if(t.clientInfo)try{const e=Hn(t.clientInfo,this.cryptoUtils.base64Decode);i={credential:`${e.uid}${L}${e.utid}`,type:Dn}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}const a=this.createTokenRequestHeaders(i||t.ccsCredential),s=Zr(this.config.authOptions.clientId,t);return Pr(this.executePostToTokenEndpoint.bind(this),wn.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(r,o,a,s,t.correlationId,wn.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(wn.AuthClientCreateTokenRequestBody,e.correlationId);const t=new Map;if(er(t,e.embeddedClientId||e.tokenBodyParameters?.[zn]||this.config.authOptions.clientId),this.includeRedirectUri)tr(t,e.redirectUri);else if(!e.redirectUri)throw Wt(kt);if(Zn(t,e.scopes,!0,this.oidcDefaultScopes),function(e,t){e.set("code",t)}(t,e.code),cr(t,this.config.libraryInfo),lr(t,this.config.telemetry.application),Tr(t),this.serverTelemetryManager&&!Ln(this.config)&&wr(t,this.serverTelemetryManager),e.codeVerifier&&function(e,t){e.set("code_verifier",t)}(t,e.codeVerifier),this.config.clientCredentials.clientSecret&&hr(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const n=this.config.clientCredentials.clientAssertion;gr(t,await _o(n.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),pr(t,n.assertionType)}if(fr(t,M),mr(t),e.authenticationScheme===W.POP){const n=new bo(this.cryptoUtils,this.performanceClient);let r;if(e.popKid)r=this.cryptoUtils.encodeKid(e.popKid);else{r=(await Pr(n.generateCnf.bind(n),wn.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}Ir(t,r)}else if(e.authenticationScheme===W.SSH){if(!e.sshJwk)throw Wt(Bt);kr(t,e.sshJwk)}let n;if((!Vt.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&ar(t,e.claims,this.config.authOptions.clientCapabilities),e.clientInfo)try{const t=Hn(e.clientInfo,this.cryptoUtils.base64Decode);n={credential:`${t.uid}${L}${t.utid}`,type:Dn}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}else n=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&n)switch(n.type){case Dn:try{or(t,Fn(n.credential))}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Un:rr(t,n.credential)}return e.embeddedClientId&&Ar(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&yr(t,e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[Qn]||yr(t,{[Qn]:"1"}),Yn(t,e.correlationId,this.performanceClient),an(t)}createLogoutUrlQueryString(e){const t=new Map;return e.postLogoutRedirectUri&&function(e,t){e.set("post_logout_redirect_uri",t)}(t,e.postLogoutRedirectUri),e.correlationId&&sr(t,e.correlationId),e.idTokenHint&&function(e,t){e.set("id_token_hint",t)}(t,e.idTokenHint),e.state&&ur(t,e.state),e.logoutHint&&function(e,t){e.set("logout_hint",t)}(t,e.logoutHint),e.extraQueryParameters&&yr(t,e.extraQueryParameters),this.config.authOptions.instanceAware&&vr(t),an(t,this.config.authOptions.encodeExtraQueryParams,e.extraQueryParameters)}}
/*! @azure/msal-common v15.12.0 2025-08-19 */class Mo extends ro{constructor(e,t){super(e,t)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(wn.RefreshTokenClientAcquireToken,e.correlationId);const t=qr(),n=await Pr(this.executeTokenRequest.bind(this),wn.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),r=n.headers?.[y],o=new Ro(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return o.validateTokenResponse(n.body),Pr(o.handleServerTokenResponse.bind(o),wn.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,r)}async acquireTokenByRefreshToken(e){if(!e)throw Wt(Et);if(this.performanceClient?.addQueueMeasurement(wn.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw pt($e);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await Pr(this.acquireTokenWithCachedRefreshToken.bind(this),wn.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(t){const n=t instanceof Io&&t.errorCode===ao,r=t instanceof Xr&&t.errorCode===Z&&t.subError===ee;if(n||r)return Pr(this.acquireTokenWithCachedRefreshToken.bind(this),wn.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw t}return Pr(this.acquireTokenWithCachedRefreshToken.bind(this),wn.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){this.performanceClient?.addQueueMeasurement(wn.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);const n=_r(this.cacheManager.getRefreshToken.bind(this.cacheManager),wn.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,e.correlationId,void 0,this.performanceClient);if(!n)throw wo(ao);if(n.expiresOn&&Br(n.expiresOn,e.refreshTokenExpirationOffsetSeconds||300))throw this.performanceClient?.addFields({rtExpiresOnMs:Number(n.expiresOn)},e.correlationId),wo(co);const r={...e,refreshToken:n.secret,authenticationScheme:e.authenticationScheme||W.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Dn}};try{return await Pr(this.acquireToken.bind(this),wn.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(r)}catch(t){if(t instanceof Io&&(this.performanceClient?.addFields({rtExpiresOnMs:Number(n.expiresOn)},e.correlationId),t.subError===po)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const t=this.cacheManager.generateCredentialKey(n);this.cacheManager.removeRefreshToken(t,e.correlationId)}throw t}}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(wn.RefreshTokenClientExecuteTokenRequest,e.correlationId);const n=this.createTokenQueryParameters(e),r=cn.appendQueryString(t.tokenEndpoint,n),o=await Pr(this.createTokenRequestBody.bind(this),wn.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),i=this.createTokenRequestHeaders(e.ccsCredential),a=Zr(this.config.authOptions.clientId,e);return Pr(this.executePostToTokenEndpoint.bind(this),wn.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(r,o,i,a,e.correlationId,wn.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(wn.RefreshTokenClientCreateTokenRequestBody,e.correlationId);const t=new Map;if(er(t,e.embeddedClientId||e.tokenBodyParameters?.[zn]||this.config.authOptions.clientId),e.redirectUri&&tr(t,e.redirectUri),Zn(t,e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),fr(t,q),mr(t),cr(t,this.config.libraryInfo),lr(t,this.config.telemetry.application),Tr(t),this.serverTelemetryManager&&!Ln(this.config)&&wr(t,this.serverTelemetryManager),function(e,t){e.set("refresh_token",t)}(t,e.refreshToken),this.config.clientCredentials.clientSecret&&hr(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const n=this.config.clientCredentials.clientAssertion;gr(t,await _o(n.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),pr(t,n.assertionType)}if(e.authenticationScheme===W.POP){const n=new bo(this.cryptoUtils,this.performanceClient);let r;if(e.popKid)r=this.cryptoUtils.encodeKid(e.popKid);else{r=(await Pr(n.generateCnf.bind(n),wn.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}Ir(t,r)}else if(e.authenticationScheme===W.SSH){if(!e.sshJwk)throw Wt(Bt);kr(t,e.sshJwk)}if((!Vt.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&ar(t,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Dn:try{or(t,Fn(e.ccsCredential.credential))}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Un:rr(t,e.ccsCredential.credential)}return e.embeddedClientId&&Ar(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&yr(t,e.tokenBodyParameters),Yn(t,e.correlationId,this.performanceClient),an(t)}}
/*! @azure/msal-common v15.12.0 2025-08-19 */class qo extends ro{constructor(e,t){super(e,t)}async acquireCachedToken(e){this.performanceClient?.addQueueMeasurement(wn.SilentFlowClientAcquireCachedToken,e.correlationId);let t=se;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!Vt.isEmptyObj(e.claims))throw this.setCacheOutcome(ce,e.correlationId),pt(Xe);if(!e.account)throw pt($e);const n=e.account.tenantId||function(e){const t=new cn(e).getUrlComponents(),n=t.PathSegments.slice(-1)[0]?.toLowerCase();switch(n){case k:case w:case T:return;default:return n}}(e.authority),r=this.cacheManager.getTokenKeys(),o=this.cacheManager.getAccessToken(e.account,e,r,n);if(!o)throw this.setCacheOutcome(le,e.correlationId),pt(Xe);if(Lr(o.cachedAt)||Br(o.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(ue,e.correlationId),pt(Xe);o.refreshOn&&Br(o.refreshOn,0)&&(t=de);const i=e.authority||this.authority.getPreferredCache(),a={account:this.cacheManager.getAccount(this.cacheManager.generateAccountKey(e.account),e.correlationId),accessToken:o,idToken:this.cacheManager.getIdToken(e.account,e.correlationId,r,n,this.performanceClient),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(i)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await Pr(this.generateResultFromCacheRecord.bind(this),wn.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(a,e),t]}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),e!==se&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){let n;if(this.performanceClient?.addQueueMeasurement(wn.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId),e.idToken&&(n=en(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){const e=n?.auth_time;if(!e)throw pt(qe);tn(e,t.maxAge)}return Ro.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,n)}}
/*! @azure/msal-common v15.12.0 2025-08-19 */const Oo={sendGetRequestAsync:()=>Promise.reject(pt(ct)),sendPostRequestAsync:()=>Promise.reject(pt(ct))};
/*! @azure/msal-common v15.12.0 2025-08-19 */function No(e,t,n,r){const o=t.correlationId,i=new Map;er(i,t.embeddedClientId||t.extraQueryParameters?.[zn]||e.clientId);if(Zn(i,[...t.scopes||[],...t.extraScopesToConsent||[]],!0,e.authority.options.OIDCOptions?.defaultScopes),tr(i,t.redirectUri),sr(i,o),function(e,t){e.set("response_mode",t||P)}(i,t.responseMode),mr(i),t.prompt&&(!function(e,t){e.set("prompt",t)}(i,t.prompt),r?.addFields({prompt:t.prompt},o)),t.domainHint&&(!function(e,t){e.set("domain_hint",t)}(i,t.domainHint),r?.addFields({domainHintFromRequest:!0},o)),t.prompt!==S.SELECT_ACCOUNT)if(t.sid&&t.prompt===S.NONE)n.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),ir(i,t.sid),r?.addFields({sidFromRequest:!0},o);else if(t.account){const e=(a=t.account,a.idTokenClaims?.sid||null);let s=function(e){return e.loginHint||e.idTokenClaims?.login_hint||null}
/*! @azure/msal-common v15.12.0 2025-08-19 */(t.account);if(s&&t.domainHint&&(n.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),s=null),s){n.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),nr(i,s),r?.addFields({loginHintFromClaim:!0},o);try{or(i,Fn(t.account.homeAccountId))}catch(e){n.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e&&t.prompt===S.NONE){n.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),ir(i,e),r?.addFields({sidFromClaim:!0},o);try{or(i,Fn(t.account.homeAccountId))}catch(e){n.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)n.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),nr(i,t.loginHint),rr(i,t.loginHint),r?.addFields({loginHintFromRequest:!0},o);else if(t.account.username){n.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),nr(i,t.account.username),r?.addFields({loginHintFromUpn:!0},o);try{or(i,Fn(t.account.homeAccountId))}catch(e){n.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(n.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),nr(i,t.loginHint),rr(i,t.loginHint),r?.addFields({loginHintFromRequest:!0},o));else n.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");var a;return t.nonce&&function(e,t){e.set("nonce",t)}(i,t.nonce),t.state&&ur(i,t.state),(t.claims||e.clientCapabilities&&e.clientCapabilities.length>0)&&ar(i,t.claims,e.clientCapabilities),t.embeddedClientId&&Ar(i,e.clientId,e.redirectUri),!e.instanceAware||t.extraQueryParameters&&Object.keys(t.extraQueryParameters).includes(Jn)||vr(i),i}function Bo(e,t,n,r){const o=an(t,n,r);return cn.appendQueryString(e.authorizationEndpoint,o)}function xo(e,t){if(!e.state||!t)throw e.state?pt(Pe,"Cached State"):pt(Pe,"Server State");let n,r;try{n=decodeURIComponent(e.state)}catch(t){throw pt(Ee,e.state)}try{r=decodeURIComponent(t)}catch(t){throw pt(Ee,e.state)}if(n!==r)throw pt(_e);if(e.error||e.error_description||e.suberror){const t=function(e){const t="code=",n=e.error_uri?.lastIndexOf(t);return n&&n>=0?e.error_uri?.substring(n+t.length):void 0}(e);if(ko(e.error,e.error_description,e.suberror))throw new Io(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",t);throw new Xr(e.error||"",e.error_description,e.suberror,t)}}function Lo(e){const{skus:t,libraryName:n,libraryVersion:r,extensionName:o,extensionVersion:i}=e,a=new Map([[0,[n,r]],[2,[o,i]]]);let s=[];if(t?.length){if(s=t.split(","),s.length<4)return t}else s=Array.from({length:4},()=>"|");return a.forEach((e,t)=>{2===e.length&&e[0]?.length&&e[1]?.length&&function(e){const{skuArr:t,index:n,skuName:r,skuVersion:o}=e;if(n>=t.length)return;t[n]=[r,o].join("|")}({skuArr:s,index:t,skuName:e[0],skuVersion:e[1]})}),s.join(",")}class Do{constructor(e,n){this.cacheOutcome=se,this.cacheManager=n,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||t.EMPTY_STRING,this.wrapperVer=e.wrapperVer||t.EMPTY_STRING,this.telemetryCacheKey=j.CACHE_KEY+x+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${j.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],n=this.getNativeBrokerErrorCode();n?.length&&t.push(`broker_error=${n}`);const r=t.join(j.VALUE_SEPARATOR),o=[e,this.getRegionDiscoveryFields()].join(j.VALUE_SEPARATOR);return[j.SCHEMA_VERSION,o,r].join(j.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=Do.maxErrorsToSend(e),n=e.failedRequests.slice(0,2*t).join(j.VALUE_SEPARATOR),r=e.errors.slice(0,t).join(j.VALUE_SEPARATOR),o=e.errors.length,i=[o,t<o?j.OVERFLOW_TRUE:j.OVERFLOW_FALSE].join(j.VALUE_SEPARATOR);return[j.SCHEMA_VERSION,e.cacheHits,n,r,i].join(j.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=j.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof ye?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(j.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){const e=this.getLastRequests(),t=Do.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{const n={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n,this.correlationId)}}static maxErrorsToSend(e){let n,r=0,o=0;const i=e.errors.length;for(n=0;n<i;n++){const i=e.failedRequests[2*n]||t.EMPTY_STRING,a=e.failedRequests[2*n+1]||t.EMPTY_STRING,s=e.errors[n]||t.EMPTY_STRING;if(o+=i.toString().length+a.toString().length+s.length+3,!(o<j.MAX_LAST_HEADER_BYTES))break;r+=1}return r}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||t.EMPTY_STRING),e.push(this.regionSource||t.EMPTY_STRING),e.push(this.regionOutcome||t.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId)}static makeExtraSkuString(e){return Lo(e)}}
/*! @azure/msal-common v15.12.0 2025-08-19 */const Uo="missing_kid_error",Ho="missing_alg_error",Fo={[Uo]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[Ho]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class zo extends ye{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,zo.prototype)}}function Ko(e){return new zo(e,Fo[e])}
/*! @azure/msal-common v15.12.0 2025-08-19 */class $o{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw Ko(Uo);if(!e.alg)throw Ko(Ho);const t=new $o({typ:e.typ||he.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(t)}}
/*! @azure/msal-common v15.12.0 2025-08-19 */function Go(e,t,n,r=5){if(e instanceof Error)return e instanceof ye?(n.errorCode=e.errorCode,n.subErrorCode=e.subError,void((e instanceof Xr||e instanceof Io)&&(n.serverErrorNo=e.errorNo))):void(e instanceof vn?n.errorCode=e.errorCode:n.errorStack?.length?t.trace("PerformanceClient.addErrorStack: Stack already exist",n.correlationId):e.stack?.length?(e.stack&&(n.errorStack=function(e,t){if(t<0)return[];const n=e.split("\n")||[],r=[],o=n[0];o.startsWith("TypeError: Cannot read property")||o.startsWith("TypeError: Cannot read properties of")||o.startsWith("TypeError: Cannot set property")||o.startsWith("TypeError: Cannot set properties of")||o.endsWith("is not a function")?r.push(Qo(o)):(o.startsWith("SyntaxError")||o.startsWith("TypeError"))&&r.push(Qo(o.replace(/['].*[']|["].*["]/g,"<redacted>")));for(let e=1;e<n.length&&!(r.length>=t);e++){const t=n[e];r.push(Qo(t))}return r}(e.stack,r)),n.errorName=e.name):t.trace("PerformanceClient.addErrorStack: Input stack is empty",n.correlationId));t.trace("PerformanceClient.addErrorStack: Input error is not instance of Error",n.correlationId)}function Qo(e){const t=e.lastIndexOf(" ")+1;if(t<1)return e;const n=e.substring(t);let r=n.lastIndexOf("/");return r=r<0?n.lastIndexOf("\\"):r,r>=0?(e.substring(0,t)+"("+n.substring(r+1)+(")"===n.charAt(n.length-1)?"":")")).trimStart():e.trimStart()}class jo{constructor(e,t,n,r,o,i,a,s){this.authority=t,this.libraryName=r,this.libraryVersion=o,this.applicationTelemetry=i,this.clientId=e,this.logger=n,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.eventStack=new Map,this.queueMeasurements=new Map,this.preQueueTimeByCorrelationId=new Map,this.intFields=a||new Set;for(const e of Sn)this.intFields.add(e);this.abbreviations=s||new Map;for(const[e,t]of Tn)this.abbreviations.set(e,t)}startPerformanceMeasurement(e,t){return{}}getPreQueueTime(e,t){const n=this.preQueueTimeByCorrelationId.get(t);if(n){if(n.name===e)return n.time;this.logger.trace(`PerformanceClient.getPreQueueTime: no pre-queue time found for ${e}, unable to add queue measurement`)}else this.logger.trace(`PerformanceClient.getPreQueueTime: no pre-queue times found for correlationId: ${t}, unable to add queue measurement`)}calculateQueuedTime(e,t){return e<1?(this.logger.trace(`PerformanceClient: preQueueTime should be a positive integer and not ${e}`),0):t<1?(this.logger.trace(`PerformanceClient: currentTime should be a positive integer and not ${t}`),0):t<e?(this.logger.trace("PerformanceClient: currentTime is less than preQueueTime, check how time is being retrieved"),0):t-e}addQueueMeasurement(e,t,n,r){if(!t)return void this.logger.trace(`PerformanceClient.addQueueMeasurement: correlationId not provided for ${e}, cannot add queue measurement`);if(0===n)this.logger.trace(`PerformanceClient.addQueueMeasurement: queue time provided for ${e} is ${n}`);else if(!n)return void this.logger.trace(`PerformanceClient.addQueueMeasurement: no queue time provided for ${e}`);const o={eventName:e,queueTime:r?0:n,manuallyCompleted:r},i=this.queueMeasurements.get(t);if(i)i.push(o),this.queueMeasurements.set(t,i);else{this.logger.trace(`PerformanceClient.addQueueMeasurement: adding correlationId ${t} to queue measurements`);const e=[o];this.queueMeasurements.set(t,e)}this.preQueueTimeByCorrelationId.delete(t)}startMeasurement(e,t){const n=t||this.generateId();t||this.logger.info(`PerformanceClient: No correlation id provided for ${e}, generating`,n),this.logger.trace(`PerformanceClient: Performance measurement started for ${e}`,n);const r={eventId:this.generateId(),status:An,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:e,startTimeMs:Date.now(),correlationId:n,appName:this.applicationTelemetry?.appName,appVersion:this.applicationTelemetry?.appVersion};var o,i,a;return this.cacheEventByCorrelationId(r),o=r,i=this.abbreviations,(a=this.eventStack.get(n))&&a.push({name:i.get(o.name)||o.name}),{end:(e,t)=>this.endMeasurement({...r,...e},t),discard:()=>this.discardMeasurements(r.correlationId),add:e=>this.addFields(e,r.correlationId),increment:e=>this.incrementFields(e,r.correlationId),event:r,measurement:new Rn}}endMeasurement(e,t){const n=this.eventsByCorrelationId.get(e.correlationId);if(!n)return this.logger.trace(`PerformanceClient: Measurement not found for ${e.eventId}`,e.correlationId),null;const r=e.eventId===n.eventId;let o={totalQueueTime:0,totalQueueCount:0,manuallyCompletedCount:0};e.durationMs=Math.round(e.durationMs||this.getDurationMs(e.startTimeMs));const i=JSON.stringify(function(e,t,n,r){if(!n?.length)return;const o=e=>e.length?e[e.length-1]:void 0,i=t.get(e.name)||e.name,a=o(n);if(a?.name!==i)return;const s=n?.pop();if(!s)return;const c=r instanceof ye?r.errorCode:r instanceof Error?r.name:void 0,l=r instanceof ye?r.subError:void 0;c&&s.childErr!==c&&(s.err=c,l&&(s.subErr=l)),delete s.name,delete s.childErr;const u={...s,dur:e.durationMs};e.success||(u.fail=1);const d=o(n);if(!d)return{[i]:u};let h;if(c&&(d.childErr=c),d[i]){const e=Object.keys(d).filter(e=>e.startsWith(i)).length;h=`${i}_${e+1}`}else h=i;return d[h]=u,d}(e,this.abbreviations,this.eventStack.get(n.correlationId),t));if(r?(o=this.getQueueInfo(e.correlationId),this.discardMeasurements(n.correlationId)):n.incompleteSubMeasurements?.delete(e.eventId),this.logger.trace(`PerformanceClient: Performance measurement ended for ${e.name}: ${e.durationMs} ms`,e.correlationId),t&&Go(t,this.logger,n),!r)return n[e.name+"DurationMs"]=Math.floor(e.durationMs),{...n};r&&!t&&(n.errorCode||n.subErrorCode)&&(this.logger.trace(`PerformanceClient: Remove error and sub-error codes for root event ${e.name} as intermediate error was successfully handled`,e.correlationId),n.errorCode=void 0,n.subErrorCode=void 0);let a={...n,...e},s=0;return a.incompleteSubMeasurements?.forEach(t=>{this.logger.trace(`PerformanceClient: Incomplete submeasurement ${t.name} found for ${e.name}`,a.correlationId),s++}),a.incompleteSubMeasurements=void 0,a={...a,queuedTimeMs:o.totalQueueTime,queuedCount:o.totalQueueCount,queuedManuallyCompletedCount:o.manuallyCompletedCount,status:bn,incompleteSubsCount:s,context:i},this.truncateIntegralFields(a),this.emitEvents([a],e.correlationId),a}addFields(e,t){this.logger.trace("PerformanceClient: Updating static fields");const n=this.eventsByCorrelationId.get(t);n?this.eventsByCorrelationId.set(t,{...n,...e}):this.logger.trace("PerformanceClient: Event not found for",t)}incrementFields(e,t){this.logger.trace("PerformanceClient: Updating counters");const n=this.eventsByCorrelationId.get(t);if(n)for(const t in e){if(n.hasOwnProperty(t)){if(isNaN(Number(n[t])))return}else n[t]=0;n[t]+=e[t]}else this.logger.trace("PerformanceClient: Event not found for",t)}cacheEventByCorrelationId(e){const t=this.eventsByCorrelationId.get(e.correlationId);t?(this.logger.trace(`PerformanceClient: Performance measurement for ${e.name} added/updated`,e.correlationId),t.incompleteSubMeasurements=t.incompleteSubMeasurements||new Map,t.incompleteSubMeasurements.set(e.eventId,{name:e.name,startTimeMs:e.startTimeMs})):(this.logger.trace(`PerformanceClient: Performance measurement for ${e.name} started`,e.correlationId),this.eventsByCorrelationId.set(e.correlationId,{...e}),this.eventStack.set(e.correlationId,[]))}getQueueInfo(e){const t=this.queueMeasurements.get(e);t||this.logger.trace(`PerformanceClient: no queue measurements found for for correlationId: ${e}`);let n=0,r=0,o=0;return t?.forEach(e=>{n+=e.queueTime,r++,o+=e.manuallyCompleted?1:0}),{totalQueueTime:n,totalQueueCount:r,manuallyCompletedCount:o}}discardMeasurements(e){this.logger.trace("PerformanceClient: Performance measurements discarded",e),this.eventsByCorrelationId.delete(e),this.logger.trace("PerformanceClient: QueueMeasurements discarded",e),this.queueMeasurements.delete(e),this.logger.trace("PerformanceClient: Pre-queue times discarded",e),this.preQueueTimeByCorrelationId.delete(e),this.logger.trace("PerformanceClient: Event stack discarded",e),this.eventStack.delete(e)}addPerformanceCallback(e){for(const[t,n]of this.callbacks)if(n.toString()===e.toString())return this.logger.warning(`PerformanceClient: Performance callback is already registered with id: ${t}`),t;const t=this.generateId();return this.callbacks.set(t,e),this.logger.verbose(`PerformanceClient: Performance callback registered with id: ${t}`),t}removePerformanceCallback(e){const t=this.callbacks.delete(e);return t?this.logger.verbose(`PerformanceClient: Performance callback ${e} removed.`):this.logger.verbose(`PerformanceClient: Performance callback ${e} not removed.`),t}emitEvents(e,t){this.logger.verbose("PerformanceClient: Emitting performance events",t),this.callbacks.forEach((n,r)=>{this.logger.trace(`PerformanceClient: Emitting event to callback ${r}`,t),n.apply(null,[e])})}truncateIntegralFields(e){this.intFields.forEach(t=>{t in e&&"number"==typeof e[t]&&(e[t]=Math.floor(e[t]))})}getDurationMs(e){const t=Date.now()-e;return t<0?t:0}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */const Wo="pkce_not_created",Vo="ear_jwk_empty",Jo="ear_jwe_empty",Yo="crypto_nonexistent",Xo="empty_navigate_uri",Zo="hash_empty_error",ei="no_state_in_hash",ti="hash_does_not_contain_known_properties",ni="unable_to_parse_state",ri="state_interaction_type_mismatch",oi="interaction_in_progress",ii="popup_window_error",ai="empty_window_error",si="user_cancelled",ci="monitor_popup_timeout",li="monitor_window_timeout",ui="redirect_in_iframe",di="block_iframe_reload",hi="block_nested_popups",gi="iframe_closed_prematurely",pi="silent_logout_unsupported",fi="no_account_error",mi="silent_prompt_value_error",vi="no_token_request_cache_error",yi="unable_to_parse_token_request_cache_error",Ci="auth_request_not_set_error",Ii="invalid_cache_type",ki="non_browser_environment",wi="database_not_open",Ti="no_network_connectivity",Ai="post_request_failed",bi="get_request_failed",Si="failed_to_parse_response",Ri="unable_to_load_token",Ei="crypto_key_not_found",_i="auth_code_required",Pi="auth_code_or_nativeAccountId_required",Mi="spa_code_and_nativeAccountId_present",qi="database_unavailable",Oi="unable_to_acquire_token_from_native_platform",Ni="native_handshake_timeout",Bi="native_extension_not_installed",xi="native_connection_not_established",Li="uninitialized_public_client_application",Di="native_prompt_not_supported",Ui="invalid_base64_string",Hi="invalid_pop_token_request",Fi="failed_to_build_headers",zi="failed_to_parse_headers",Ki="failed_to_decrypt_ear_response",$i="timed_out";var Gi=Object.freeze({__proto__:null,authCodeOrNativeAccountIdRequired:Pi,authCodeRequired:_i,authRequestNotSetError:Ci,blockIframeReload:di,blockNestedPopups:hi,cryptoKeyNotFound:Ei,cryptoNonExistent:Yo,databaseNotOpen:wi,databaseUnavailable:qi,earJweEmpty:Jo,earJwkEmpty:Vo,emptyNavigateUri:Xo,emptyWindowError:ai,failedToBuildHeaders:Fi,failedToDecryptEarResponse:Ki,failedToParseHeaders:zi,failedToParseResponse:Si,getRequestFailed:bi,hashDoesNotContainKnownProperties:ti,hashEmptyError:Zo,iframeClosedPrematurely:gi,interactionInProgress:oi,invalidBase64String:Ui,invalidCacheType:Ii,invalidPopTokenRequest:Hi,monitorPopupTimeout:ci,monitorWindowTimeout:li,nativeConnectionNotEstablished:xi,nativeExtensionNotInstalled:Bi,nativeHandshakeTimeout:Ni,nativePromptNotSupported:Di,noAccountError:fi,noNetworkConnectivity:Ti,noStateInHash:ei,noTokenRequestCacheError:vi,nonBrowserEnvironment:ki,pkceNotCreated:Wo,popupWindowError:ii,postRequestFailed:Ai,redirectInIframe:ui,silentLogoutUnsupported:pi,silentPromptValueError:mi,spaCodeAndNativeAccountIdPresent:Mi,stateInteractionTypeMismatch:ri,timedOut:$i,unableToAcquireTokenFromNativePlatform:Oi,unableToLoadToken:Ri,unableToParseState:ni,unableToParseTokenRequestCacheError:yi,uninitializedPublicClientApplication:Li,userCancelled:si});
/*! @azure/msal-browser v4.21.0 2025-08-19 */const Qi="For more visit: aka.ms/msaljs/browser-errors",ji={[Wo]:"The PKCE code challenge and verifier could not be generated.",[Vo]:"No EAR encryption key provided. This is unexpected.",[Jo]:"Server response does not contain ear_jwe property. This is unexpected.",[Yo]:"The crypto object or function is not available.",[Xo]:"Navigation URI is empty. Please check stack trace for more info.",[Zo]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${Qi}`,[ei]:"Hash does not contain state. Please verify that the request originated from msal.",[ti]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${Qi}`,[ni]:"Unable to parse state. Please verify that the request originated from msal.",[ri]:"Hash contains state but the interaction type does not match the caller.",[oi]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${Qi}`,[ii]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[ai]:"window.open returned null or undefined window object.",[si]:"User cancelled the flow.",[ci]:`Token acquisition in popup failed due to timeout.  ${Qi}`,[li]:`Token acquisition in iframe failed due to timeout.  ${Qi}`,[ui]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[di]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${Qi}`,[hi]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[gi]:"The iframe being monitored was closed prematurely.",[pi]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[fi]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[mi]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[vi]:"No token request found in cache.",[yi]:"The cached token request could not be parsed.",[Ci]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[Ii]:"Invalid cache type",[ki]:"Login and token requests are not supported in non-browser environments.",[wi]:"Database is not open!",[Ti]:"No network connectivity. Check your internet connection.",[Ai]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[bi]:"Network request failed. Please check the network trace to determine root cause.",[Si]:"Failed to parse network response. Check network trace.",[Ri]:"Error loading token to cache.",[Ei]:"Cryptographic Key or Keypair not found in browser storage.",[_i]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[Pi]:"An authorization code or nativeAccountId must be provided to this flow.",[Mi]:"Request cannot contain both spa code and native account id.",[qi]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[Oi]:`Unable to acquire token from native platform.  ${Qi}`,[Ni]:"Timed out while attempting to establish connection to browser extension",[Bi]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[xi]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${Qi}`,[Li]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${Qi}`,[Di]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[Ui]:"Invalid base64 encoded string.",[Hi]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[Fi]:"Failed to build request headers object.",[zi]:"Failed to parse response headers",[Ki]:"Failed to decrypt ear response",[$i]:"The request timed out."},Wi={pkceNotGenerated:{code:Wo,desc:ji[Wo]},cryptoDoesNotExist:{code:Yo,desc:ji[Yo]},emptyNavigateUriError:{code:Xo,desc:ji[Xo]},hashEmptyError:{code:Zo,desc:ji[Zo]},hashDoesNotContainStateError:{code:ei,desc:ji[ei]},hashDoesNotContainKnownPropertiesError:{code:ti,desc:ji[ti]},unableToParseStateError:{code:ni,desc:ji[ni]},stateInteractionTypeMismatchError:{code:ri,desc:ji[ri]},interactionInProgress:{code:oi,desc:ji[oi]},popupWindowError:{code:ii,desc:ji[ii]},emptyWindowError:{code:ai,desc:ji[ai]},userCancelledError:{code:si,desc:ji[si]},monitorPopupTimeoutError:{code:ci,desc:ji[ci]},monitorIframeTimeoutError:{code:li,desc:ji[li]},redirectInIframeError:{code:ui,desc:ji[ui]},blockTokenRequestsInHiddenIframeError:{code:di,desc:ji[di]},blockAcquireTokenInPopupsError:{code:hi,desc:ji[hi]},iframeClosedPrematurelyError:{code:gi,desc:ji[gi]},silentLogoutUnsupportedError:{code:pi,desc:ji[pi]},noAccountError:{code:fi,desc:ji[fi]},silentPromptValueError:{code:mi,desc:ji[mi]},noTokenRequestCacheError:{code:vi,desc:ji[vi]},unableToParseTokenRequestCacheError:{code:yi,desc:ji[yi]},authRequestNotSet:{code:Ci,desc:ji[Ci]},invalidCacheType:{code:Ii,desc:ji[Ii]},notInBrowserEnvironment:{code:ki,desc:ji[ki]},databaseNotOpen:{code:wi,desc:ji[wi]},noNetworkConnectivity:{code:Ti,desc:ji[Ti]},postRequestFailed:{code:Ai,desc:ji[Ai]},getRequestFailed:{code:bi,desc:ji[bi]},failedToParseNetworkResponse:{code:Si,desc:ji[Si]},unableToLoadTokenError:{code:Ri,desc:ji[Ri]},signingKeyNotFoundInStorage:{code:Ei,desc:ji[Ei]},authCodeRequired:{code:_i,desc:ji[_i]},authCodeOrNativeAccountRequired:{code:Pi,desc:ji[Pi]},spaCodeAndNativeAccountPresent:{code:Mi,desc:ji[Mi]},databaseUnavailable:{code:qi,desc:ji[qi]},unableToAcquireTokenFromNativePlatform:{code:Oi,desc:ji[Oi]},nativeHandshakeTimeout:{code:Ni,desc:ji[Ni]},nativeExtensionNotInstalled:{code:Bi,desc:ji[Bi]},nativeConnectionNotEstablished:{code:xi,desc:ji[xi]},uninitializedPublicClientApplication:{code:Li,desc:ji[Li]},nativePromptNotSupported:{code:Di,desc:ji[Di]},invalidBase64StringError:{code:Ui,desc:ji[Ui]},invalidPopTokenRequest:{code:Hi,desc:ji[Hi]}};class Vi extends ye{constructor(e,t){super(e,ji[e],t),Object.setPrototypeOf(this,Vi.prototype),this.name="BrowserAuthError"}}function Ji(e,t){return new Vi(e,t)}
/*! @azure/msal-browser v4.21.0 2025-08-19 */const Yi="invalid_grant",Xi=483,Zi=600,ea="msal",ta=30,na="msal.js.browser",ra="53ee284d-920a-4b59-9d30-a60315b26836",oa="ppnbnpeolgkicgegkbkbjmhlideopiji",ia="MATS",aa="MicrosoftEntra",sa="DOM API",ca="get-token-and-sign-out",la="PlatformAuthDOMHandler",ua="PlatformAuthExtensionHandler",da="Handshake",ha="HandshakeResponse",ga="GetToken",pa="Response",fa={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},ma="GET",va="POST",ya="signin",Ca="signout",Ia="request.origin",ka="urlHash",wa="request.params",Ta="code.verifier",Aa="interaction.status",ba="request.native",Sa="wrapper.sku",Ra="wrapper.version",Ea={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var _a;e.InteractionType=void 0,(_a=e.InteractionType||(e.InteractionType={})).Redirect="redirect",_a.Popup="popup",_a.Silent="silent",_a.None="none";const Pa={Startup:"startup",Login:"login",Logout:"logout",AcquireToken:"acquireToken",SsoSilent:"ssoSilent",HandleRedirect:"handleRedirect",None:"none"},Ma={scopes:u},qa="msal.db",Oa=`${qa}.keys`,Na={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},Ba=[Na.Default,Na.Skip,Na.RefreshTokenAndNetwork];
/*! @azure/msal-browser v4.21.0 2025-08-19 */
function xa(e){return encodeURIComponent(Da(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function La(e){return Ua(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Da(e){return Ua((new TextEncoder).encode(e))}function Ua(e){const t=Array.from(e,e=>String.fromCodePoint(e)).join("");return btoa(t)}
/*! @azure/msal-browser v4.21.0 2025-08-19 */function Ha(e){return(new TextDecoder).decode(Fa(e))}function Fa(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Ji(Ui)}const n=atob(t);return Uint8Array.from(n,e=>e.codePointAt(0)||0)}
/*! @azure/msal-browser v4.21.0 2025-08-19 */const za="AES-GCM",Ka="HKDF",$a="SHA-256",Ga=new Uint8Array([1,0,1]),Qa="0123456789abcdef",ja=new Uint32Array(1),Wa="raw",Va="encrypt",Ja="decrypt",Ya={name:"RSASSA-PKCS1-v1_5",hash:$a,modulusLength:2048,publicExponent:Ga};async function Xa(e,t,n){t?.addQueueMeasurement(wn.Sha256Digest,n);const r=(new TextEncoder).encode(e);return window.crypto.subtle.digest($a,r)}function Za(e){return window.crypto.getRandomValues(e)}function es(){return window.crypto.getRandomValues(ja),ja[0]}function ts(){const e=Date.now(),t=1024*es()+(1023&es()),n=new Uint8Array(16),r=Math.trunc(t/2**30),o=t&2**30-1,i=es();n[0]=e/2**40,n[1]=e/2**32,n[2]=e/2**24,n[3]=e/65536,n[4]=e/256,n[5]=e,n[6]=112|r>>>8,n[7]=r,n[8]=128|o>>>24,n[9]=o>>>16,n[10]=o>>>8,n[11]=o,n[12]=i>>>24,n[13]=i>>>16,n[14]=i>>>8,n[15]=i;let a="";for(let e=0;e<n.length;e++)a+=Qa.charAt(n[e]>>>4),a+=Qa.charAt(15&n[e]),3!==e&&5!==e&&7!==e&&9!==e||(a+="-");return a}async function ns(e){return window.crypto.subtle.exportKey("jwk",e)}async function rs(){const e=await is(),t={alg:"dir",kty:"oct",k:La(new Uint8Array(e))};return Da(JSON.stringify(t))}async function os(e,t){const n=t.split(".");if(5!==n.length)throw Ji(Ki,"jwe_length");const r=await async function(e){const t=Ha(e),n=Fa(JSON.parse(t).k);return window.crypto.subtle.importKey(Wa,n,za,!1,[Ja])}(e).catch(()=>{throw Ji(Ki,"import_key")});try{const e=(new TextEncoder).encode(n[0]),t=Fa(n[2]),o=Fa(n[3]),i=Fa(n[4]),a=8*i.byteLength,s=new Uint8Array(o.length+i.length);s.set(o),s.set(i,o.length);const c=await window.crypto.subtle.decrypt({name:za,iv:t,tagLength:a,additionalData:e},r,s);return(new TextDecoder).decode(c)}catch(e){throw Ji(Ki,"decrypt")}}async function is(){const e=await window.crypto.subtle.generateKey({name:za,length:256},!0,[Va,Ja]);return window.crypto.subtle.exportKey(Wa,e)}async function as(e){return window.crypto.subtle.importKey(Wa,e,Ka,!1,["deriveKey"])}async function ss(e,t,n){return window.crypto.subtle.deriveKey({name:Ka,salt:t,hash:$a,info:(new TextEncoder).encode(n)},e,{name:za,length:256},!1,[Va,Ja])}async function cs(e,t,n){const r=(new TextEncoder).encode(t),o=window.crypto.getRandomValues(new Uint8Array(16)),i=await ss(e,o,n),a=await window.crypto.subtle.encrypt({name:za,iv:new Uint8Array(12)},i,r);return{data:La(new Uint8Array(a)),nonce:La(o)}}async function ls(e,t,n,r){const o=Fa(r),i=await ss(e,Fa(t),n),a=await window.crypto.subtle.decrypt({name:za,iv:new Uint8Array(12)},i,o);return(new TextDecoder).decode(a)}async function us(e){const t=await Xa(e);return La(new Uint8Array(t))}
/*! @azure/msal-browser v4.21.0 2025-08-19 */const ds="storage_not_supported",hs="stubbed_public_client_application_called",gs="in_mem_redirect_unavailable";var ps=Object.freeze({__proto__:null,inMemRedirectUnavailable:gs,storageNotSupported:ds,stubbedPublicClientApplicationCalled:hs});
/*! @azure/msal-browser v4.21.0 2025-08-19 */const fs={[ds]:"Given storage configuration option was not supported.",[hs]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[gs]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},ms={storageNotSupportedError:{code:ds,desc:fs[ds]},stubPcaInstanceCalled:{code:hs,desc:fs[hs]},inMemRedirectUnavailable:{code:gs,desc:fs[gs]}};class vs extends ye{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,vs.prototype)}}function ys(e){return new vs(e,fs[e])}
/*! @azure/msal-browser v4.21.0 2025-08-19 */function Cs(e){e.location.hash="","function"==typeof e.history.replaceState&&e.history.replaceState(null,"",`${e.location.origin}${e.location.pathname}${e.location.search}`)}function Is(e){const t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""}function ks(){return window.parent!==window}function ws(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(`${ea}.`)}function Ts(){return"undefined"!=typeof window&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function As(){const e=new cn(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function bs(){if(cn.hashContainsKnownProperties(window.location.hash)&&ks())throw Ji(di)}function Ss(e){if(ks()&&!e)throw Ji(ui)}function Rs(){if(ws())throw Ji(hi)}function Es(){if("undefined"==typeof window)throw Ji(ki)}function _s(e){if(!e)throw Ji(Li)}function Ps(e){Es(),bs(),Rs(),_s(e)}function Ms(e,t){if(Ps(e),Ss(t.system.allowRedirectInIframe),t.cache.cacheLocation===fa.MemoryStorage&&!t.cache.storeAuthStateInCookie)throw ys(gs)}function qs(e){const t=document.createElement("link");t.rel="preconnect",t.href=new URL(e).origin,t.crossOrigin="anonymous",document.head.appendChild(t),window.setTimeout(()=>{try{document.head.removeChild(t)}catch{}},1e4)}function Os(){return ts()}var Ns=Object.freeze({__proto__:null,blockAPICallsBeforeInitialize:_s,blockAcquireTokenInPopups:Rs,blockNonBrowserEnvironment:Es,blockRedirectInIframe:Ss,blockReloadInHiddenIframes:bs,clearHash:Cs,createGuid:Os,getCurrentUri:Ts,getHomepage:As,invoke:_r,invokeAsync:Pr,isInIframe:ks,isInPopup:ws,preconnect:qs,preflightCheck:Ps,redirectPreflightCheck:Ms,replaceHash:Is});
/*! @azure/msal-browser v4.21.0 2025-08-19 */class Bs{navigateInternal(e,t){return Bs.defaultNavigateWindow(e,t)}navigateExternal(e,t){return Bs.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((e,n)=>{setTimeout(()=>{n(Ji($i,"failed_to_redirect"))},t.timeout)})}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class xs{async sendGetRequestAsync(e,t){let n,r={},o=0;const i=Ls(t);try{n=await fetch(e,{method:ma,headers:i})}catch(e){throw no(Ji(window.navigator.onLine?bi:Ti),void 0,void 0,e)}r=Ds(n.headers);try{return o=n.status,{headers:r,body:await n.json(),status:o}}catch(e){throw no(Ji(Si),o,r,e)}}async sendPostRequestAsync(e,t){const n=t&&t.body||"",r=Ls(t);let o,i=0,a={};try{o=await fetch(e,{method:va,headers:r,body:n})}catch(e){throw no(Ji(window.navigator.onLine?Ai:Ti),void 0,void 0,e)}a=Ds(o.headers);try{return i=o.status,{headers:a,body:await o.json(),status:i}}catch(e){throw no(Ji(Si),i,a,e)}}}function Ls(e){try{const t=new Headers;if(!e||!e.headers)return t;const n=e.headers;return Object.entries(n).forEach(([e,n])=>{t.append(e,n)}),t}catch(e){throw no(Ji(Fi),void 0,void 0,e)}}function Ds(e){try{const t={};return e.forEach((e,n)=>{t[n]=e}),t}catch(e){throw Ji(zi)}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */const Us=1e4;
/*! @azure/msal-browser v4.21.0 2025-08-19 */
const Hs="@azure/msal-browser",Fs="4.21.0",zs="msal",Ks="browser",$s=`${zs}.${Ks}.log.level`,Gs=`${zs}.${Ks}.log.pii`,Qs=`${zs}.${Ks}.performance.enabled`,js=`${zs}.${Ks}.platform.auth.dom`,Ws=`${zs}.version`,Vs="account.keys",Js="token.keys";function Ys(e=1){return e<1?`${zs}.${Vs}`:`${zs}.${e}.${Vs}`}function Xs(e,t=1){return t<1?`${zs}.${Js}.${e}`:`${zs}.${t}.${Js}.${e}`}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class Zs{static loggerCallback(t,n){switch(t){case e.LogLevel.Error:return void console.error(n);case e.LogLevel.Info:return void console.info(n);case e.LogLevel.Verbose:return void console.debug(n);case e.LogLevel.Warning:return void console.warn(n);default:return void console.log(n)}}constructor(n){let r;this.browserEnvironment="undefined"!=typeof window,this.config=function({auth:n,cache:r,system:o,telemetry:i},a){const s={clientId:t.EMPTY_STRING,authority:`${t.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:t.EMPTY_STRING,authorityMetadata:t.EMPTY_STRING,redirectUri:"undefined"!=typeof window?Ts():"",postLogoutRedirectUri:t.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:kn.AAD,OIDCOptions:{serverResponseType:_.FRAGMENT,defaultScopes:[t.OPENID_SCOPE,t.PROFILE_SCOPE,t.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:It.None,tenant:t.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1,encodeExtraQueryParams:!1},c={cacheLocation:fa.SessionStorage,cacheRetentionDays:5,temporaryCacheLocation:fa.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!r||r.cacheLocation!==fa.LocalStorage),claimsBasedCachingEnabled:!1},l={loggerCallback:()=>{},logLevel:e.LogLevel.Info,piiLoggingEnabled:!1},u={...{..._n,loggerOptions:l,networkClient:a?new xs:Oo,navigationClient:new Bs,loadFrameTimeout:0,windowHashTimeout:o?.loadFrameTimeout||6e4,iframeHashTimeout:o?.loadFrameTimeout||Us,navigateFrameWait:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowPlatformBroker:!1,nativeBrokerHandshakeTimeout:o?.nativeBrokerHandshakeTimeout||2e3,pollIntervalMilliseconds:ta},...o,loggerOptions:o?.loggerOptions||l},d={application:{appName:t.EMPTY_STRING,appVersion:t.EMPTY_STRING},client:new En};n?.protocolMode!==kn.OIDC&&n?.OIDCOptions&&new vt(u.loggerOptions).warning(JSON.stringify(Wt(Ut)));if(n?.protocolMode&&n.protocolMode===kn.OIDC&&u?.allowPlatformBroker)throw Wt(Ht);return{auth:{...s,...n,OIDCOptions:{...s.OIDCOptions,...n?.OIDCOptions}},cache:{...c,...r},system:u,telemetry:{...d,...i}}}(n,this.browserEnvironment);try{r=window[fa.SessionStorage]}catch(e){}const o=r?.getItem($s),i=r?.getItem(Gs)?.toLowerCase(),a="true"===i||"false"!==i&&void 0,s={...this.config.system.loggerOptions},c=o&&Object.keys(e.LogLevel).includes(o)?e.LogLevel[o]:void 0;c&&(s.loggerCallback=Zs.loggerCallback,s.logLevel=c),void 0!==a&&(s.piiLoggingEnabled=a),this.logger=new vt(s,Hs,Fs),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */const ec="USER_INTERACTION_REQUIRED",tc="USER_CANCEL",nc="NO_NETWORK",rc="TRANSIENT_ERROR",oc="PERSISTENT_ERROR",ic="DISABLED",ac="ACCOUNT_UNAVAILABLE",sc="NESTED_APP_AUTH_UNAVAILABLE";
/*! @azure/msal-browser v4.21.0 2025-08-19 */class cc{static async initializeNestedAppAuthBridge(){if(void 0===window)throw new Error("window is undefined");if(void 0===window.nestedAppAuthBridge)throw new Error("window.nestedAppAuthBridge is undefined");try{window.nestedAppAuthBridge.addEventListener("message",e=>{const t="string"==typeof e?e:e.data,n=JSON.parse(t),r=cc.bridgeRequests.find(e=>e.requestId===n.requestId);void 0!==r&&(cc.bridgeRequests.splice(cc.bridgeRequests.indexOf(r),1),n.success?r.resolve(n):r.reject(n.error))});const e=await new Promise((e,t)=>{const n=cc.buildRequest("GetInitContext"),r={requestId:n.requestId,method:n.method,resolve:e,reject:t};cc.bridgeRequests.push(r),window.nestedAppAuthBridge.postMessage(JSON.stringify(n))});return cc.validateBridgeResultOrThrow(e.initContext)}catch(e){throw window.console.log(e),e}}getTokenInteractive(e){return this.getToken("GetTokenPopup",e)}getTokenSilent(e){return this.getToken("GetToken",e)}async getToken(e,t){const n=await this.sendRequest(e,{tokenParams:t});return{token:cc.validateBridgeResultOrThrow(n.token),account:cc.validateBridgeResultOrThrow(n.account)}}getHostCapabilities(){return this.capabilities??null}getAccountContext(){return this.accountContext?this.accountContext:null}static buildRequest(e,t){return{messageType:"NestedAppAuthRequest",method:e,requestId:ts(),sendTime:Date.now(),clientLibrary:na,clientLibraryVersion:Fs,...t}}sendRequest(e,t){const n=cc.buildRequest(e,t);return new Promise((e,t)=>{const r={requestId:n.requestId,method:n.method,resolve:e,reject:t};cc.bridgeRequests.push(r),window.nestedAppAuthBridge.postMessage(JSON.stringify(n))})}static validateBridgeResultOrThrow(e){if(void 0===e){throw{status:sc}}return e}constructor(e,t,n,r){this.sdkName=e,this.sdkVersion=t,this.accountContext=n,this.capabilities=r}static async create(){const e=await cc.initializeNestedAppAuthBridge();return new cc(e.sdkName,e.sdkVersion,e.accountContext,e.capabilities)}}cc.bridgeRequests=[];
/*! @azure/msal-browser v4.21.0 2025-08-19 */
class lc extends Zs{constructor(){super(...arguments),this.bridgeProxy=void 0,this.accountContext=null}getModuleName(){return lc.MODULE_NAME}getId(){return lc.ID}getBridgeProxy(){return this.bridgeProxy}async initialize(){try{if("undefined"!=typeof window){"function"==typeof window.__initializeNestedAppAuth&&await window.__initializeNestedAppAuth();const e=await cc.create();this.accountContext=e.getAccountContext(),this.bridgeProxy=e,this.available=void 0!==e}}catch(e){this.logger.infoPii(`Could not initialize Nested App Auth bridge (${e})`)}return this.logger.info(`Nested App Auth Bridge available: ${this.available}`),this.available}}lc.MODULE_NAME="",lc.ID="NestedAppOperatingContext";
/*! @azure/msal-browser v4.21.0 2025-08-19 */
class uc extends Zs{getModuleName(){return uc.MODULE_NAME}getId(){return uc.ID}async initialize(){return this.available="undefined"!=typeof window,this.available}}uc.MODULE_NAME="",uc.ID="StandardOperatingContext";
/*! @azure/msal-browser v4.21.0 2025-08-19 */
class dc{constructor(){this.dbName=qa,this.version=1,this.tableName=Oa,this.dbOpen=!1}async open(){return new Promise((e,t)=>{const n=window.indexedDB.open(this.dbName,this.version);n.addEventListener("upgradeneeded",e=>{e.target.result.createObjectStore(this.tableName)}),n.addEventListener("success",t=>{const n=t;this.db=n.target.result,this.dbOpen=!0,e()}),n.addEventListener("error",()=>t(Ji(qi)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(Ji(wi));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);r.addEventListener("success",e=>{const n=e;this.closeConnection(),t(n.target.result)}),r.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async setItem(e,t){return await this.validateDbIsOpen(),new Promise((n,r)=>{if(!this.db)return r(Ji(wi));const o=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);o.addEventListener("success",()=>{this.closeConnection(),n()}),o.addEventListener("error",e=>{this.closeConnection(),r(e)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(Ji(wi));const r=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);r.addEventListener("success",()=>{this.closeConnection(),t()}),r.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t(Ji(wi));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();n.addEventListener("success",t=>{const n=t;this.closeConnection(),e(n.target.result)}),n.addEventListener("error",e=>{this.closeConnection(),t(e)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(Ji(wi));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);r.addEventListener("success",e=>{const n=e;this.closeConnection(),t(1===n.target.result)}),r.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{const n=window.indexedDB.deleteDatabase(qa),r=setTimeout(()=>t(!1),200);n.addEventListener("success",()=>(clearTimeout(r),e(!0))),n.addEventListener("blocked",()=>(clearTimeout(r),e(!0))),n.addEventListener("error",()=>(clearTimeout(r),t(!1)))})}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class hc{constructor(){this.cache=new Map}async initialize(){}getItem(e){return this.cache.get(e)||null}getUserData(e){return this.getItem(e)}setItem(e,t){this.cache.set(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((t,n)=>{e.push(n)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}decryptData(){return Promise.resolve(null)}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class gc{constructor(e){this.inMemoryCache=new hc,this.indexedDBCache=new dc,this.logger=e}handleDatabaseAccessError(e){if(!(e instanceof Vi&&e.errorCode===qi))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(e){this.handleDatabaseAccessError(e)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(e){this.handleDatabaseAccessError(e)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(e){this.handleDatabaseAccessError(e)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(0===e.length)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(e){this.handleDatabaseAccessError(e)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(e){this.handleDatabaseAccessError(e)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class pc{constructor(e,t,n){this.logger=e,function(e){if(!window)throw Ji(ki);if(!window.crypto)throw Ji(Yo);if(!e&&!window.crypto.subtle)throw Ji(Yo,"crypto_subtle_undefined")}(n??!1),this.cache=new gc(this.logger),this.performanceClient=t}createNewGuid(){return ts()}base64Encode(e){return Da(e)}base64Decode(e){return Ha(e)}base64UrlEncode(e){return xa(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){const t=this.performanceClient?.startMeasurement(wn.CryptoOptsGetPublicKeyThumbprint,e.correlationId),n=await async function(e,t){return window.crypto.subtle.generateKey(Ya,e,t)}(pc.EXTRACTABLE,pc.POP_KEY_USAGES),r=await ns(n.publicKey),o=fc({e:r.e,kty:r.kty,n:r.n}),i=await this.hashString(o),a=await ns(n.privateKey),s=await async function(e,t,n){return window.crypto.subtle.importKey("jwk",e,Ya,t,n)}(a,!1,["sign"]);return await this.cache.setItem(i,{privateKey:s,publicKey:n.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),i}async removeTokenBindingKey(e){await this.cache.removeItem(e);if(await this.cache.containsKey(e))throw pt(nt)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,n,r){const o=this.performanceClient?.startMeasurement(wn.CryptoOptsSignJwt,r),i=await this.cache.getItem(t);if(!i)throw Ji(Ei);const a=await ns(i.publicKey),s=fc(a),c=xa(JSON.stringify({kid:t})),l=xa($o.getShrHeaderString({...n?.header,alg:a.alg,kid:c}));e.cnf={jwk:JSON.parse(s)};const u=`${l}.${xa(JSON.stringify(e))}`,d=(new TextEncoder).encode(u),h=await async function(e,t){return window.crypto.subtle.sign(Ya,e,t)}(i.privateKey,d),g=`${u}.${La(new Uint8Array(h))}`;return o&&o.end({success:!0}),g}async hashString(e){return us(e)}}function fc(e){return JSON.stringify(e,Object.keys(e).sort())}
/*! @azure/msal-browser v4.21.0 2025-08-19 */pc.POP_KEY_USAGES=["sign","verify"],pc.EXTRACTABLE=!0;const mc=864e5,vc="Lax",yc="None";class Cc{initialize(){return Promise.resolve()}getItem(e){const t=`${encodeURIComponent(e)}`,n=document.cookie.split(";");for(let e=0;e<n.length;e++){const r=n[e],[o,...i]=decodeURIComponent(r).trim().split("="),a=i.join("=");if(o===t)return a}return""}getUserData(){throw pt(ct)}setItem(e,t,n,r=!0,o=vc){let i=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=${o};`;if(n){const e=function(e){const t=new Date,n=new Date(t.getTime()+e*mc);return n.toUTCString()}
/*! @azure/msal-browser v4.21.0 2025-08-19 */(n);i+=`expires=${e};`}(r||o===yc)&&(i+="Secure;"),document.cookie=i}async setUserData(){return Promise.reject(pt(ct))}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach(e=>{const n=decodeURIComponent(e).trim().split("=");t.push(n[0])}),t}containsKey(e){return this.getKeys().includes(e)}decryptData(){return Promise.resolve(null)}}function Ic(e,t){const n=e.getItem(Ys(t));return n?JSON.parse(n):[]}function kc(e,t,n){const r=t.getItem(Xs(e,n));if(r){const e=JSON.parse(r);if(e&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("accessToken")&&e.hasOwnProperty("refreshToken"))return e}return{idToken:[],accessToken:[],refreshToken:[]}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */function wc(e){return e.hasOwnProperty("id")&&e.hasOwnProperty("nonce")&&e.hasOwnProperty("data")}
/*! @azure/msal-browser v4.21.0 2025-08-19 */const Tc="msal.cache.encryption";class Ac{constructor(e,t,n){if(!window.localStorage)throw ys(ds);this.memoryStorage=new hc,this.initialized=!1,this.clientId=e,this.logger=t,this.performanceClient=n,this.broadcast=new BroadcastChannel("msal.broadcast.cache")}async initialize(e){const t=new Cc,n=t.getItem(Tc);let r={key:"",id:""};if(n)try{r=JSON.parse(n)}catch(e){}if(r.key&&r.id){const t=_r(Fa,wn.Base64Decode,this.logger,this.performanceClient,e)(r.key);this.encryptionCookie={id:r.id,key:await Pr(as,wn.GenerateHKDF,this.logger,this.performanceClient,e)(t)}}else{const n=ts(),r=await Pr(is,wn.GenerateBaseKey,this.logger,this.performanceClient,e)(),o=_r(La,wn.UrlEncodeArr,this.logger,this.performanceClient,e)(new Uint8Array(r));this.encryptionCookie={id:n,key:await Pr(as,wn.GenerateHKDF,this.logger,this.performanceClient,e)(r)};const i={id:n,key:o};t.setItem(Tc,JSON.stringify(i),0,!0,yc)}await Pr(this.importExistingCache.bind(this),wn.ImportExistingCache,this.logger,this.performanceClient,e)(e),this.broadcast.addEventListener("message",this.updateCache.bind(this)),this.initialized=!0}getItem(e){return window.localStorage.getItem(e)}getUserData(e){if(!this.initialized)throw Ji(Li);return this.memoryStorage.getItem(e)}async decryptData(e,t,n){if(!this.initialized||!this.encryptionCookie)throw Ji(Li);if(t.id!==this.encryptionCookie.id)return this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},n),null;const r=await Pr(ls,wn.Decrypt,this.logger,this.performanceClient,n)(this.encryptionCookie.key,t.nonce,this.getContext(e),t.data);if(!r)return null;try{return JSON.parse(r)}catch(e){return this.performanceClient.incrementFields({encryptedCacheCorruptionCount:1},n),null}}setItem(e,t){window.localStorage.setItem(e,t)}async setUserData(e,t,n,r){if(!this.initialized||!this.encryptionCookie)throw Ji(Li);const{data:o,nonce:i}=await Pr(cs,wn.Encrypt,this.logger,this.performanceClient,n)(this.encryptionCookie.key,t,this.getContext(e)),a={id:this.encryptionCookie.id,nonce:i,data:o,lastUpdatedAt:r};this.memoryStorage.setItem(e,t),this.setItem(e,JSON.stringify(a)),this.broadcast.postMessage({key:e,value:t,context:this.getContext(e)})}removeItem(e){this.memoryStorage.containsKey(e)&&(this.memoryStorage.removeItem(e),this.broadcast.postMessage({key:e,value:null,context:this.getContext(e)})),window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}clear(){this.memoryStorage.clear();Ic(this).forEach(e=>this.removeItem(e));const e=kc(this.clientId,this);e.idToken.forEach(e=>this.removeItem(e)),e.accessToken.forEach(e=>this.removeItem(e)),e.refreshToken.forEach(e=>this.removeItem(e)),this.getKeys().forEach(e=>{(e.startsWith(zs)||-1!==e.indexOf(this.clientId))&&this.removeItem(e)})}async importExistingCache(e){if(!this.encryptionCookie)return;let t=Ic(this);t=await this.importArray(t,e),t.length?this.setItem(Ys(),JSON.stringify(t)):this.removeItem(Ys());const n=kc(this.clientId,this);n.idToken=await this.importArray(n.idToken,e),n.accessToken=await this.importArray(n.accessToken,e),n.refreshToken=await this.importArray(n.refreshToken,e),n.idToken.length||n.accessToken.length||n.refreshToken.length?this.setItem(Xs(this.clientId),JSON.stringify(n)):this.removeItem(Xs(this.clientId))}async getItemFromEncryptedCache(e,t){if(!this.encryptionCookie)return null;const n=this.getItem(e);if(!n)return null;let r;try{r=JSON.parse(n)}catch(e){return null}return wc(r)?r.id!==this.encryptionCookie.id?(this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},t),null):Pr(ls,wn.Decrypt,this.logger,this.performanceClient,t)(this.encryptionCookie.key,r.nonce,this.getContext(e),r.data):(this.performanceClient.incrementFields({unencryptedCacheCount:1},t),r)}async importArray(e,t){const n=[],r=[];return e.forEach(e=>{const o=this.getItemFromEncryptedCache(e,t).then(t=>{t?(this.memoryStorage.setItem(e,t),n.push(e)):this.removeItem(e)});r.push(o)}),await Promise.all(r),n}getContext(e){let t="";return e.includes(this.clientId)&&(t=this.clientId),t}updateCache(e){this.logger.trace("Updating internal cache from broadcast event");const t=this.performanceClient.startMeasurement(wn.LocalStorageUpdated);t.add({isBackground:!0});const{key:n,value:r,context:o}=e.data;return n?o&&o!==this.clientId?(this.logger.trace(`Ignoring broadcast event from clientId: ${o}`),void t.end({success:!1,errorCode:"contextMismatch"})):(r?(this.memoryStorage.setItem(n,r),this.logger.verbose("Updated item in internal cache")):(this.memoryStorage.removeItem(n),this.logger.verbose("Removed item from internal cache")),void t.end({success:!0})):(this.logger.error("Broadcast event missing key"),void t.end({success:!1,errorCode:"noKey"}))}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class bc{constructor(){if(!window.sessionStorage)throw ys(ds)}async initialize(){}getItem(e){return window.sessionStorage.getItem(e)}getUserData(e){return this.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}decryptData(){return Promise.resolve(null)}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */const Sc={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache",BROKER_CONNECTION_ESTABLISHED:"msal:brokerConnectionEstablished"};
/*! @azure/msal-browser v4.21.0 2025-08-19 */function Rc(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class Ec extends Cn{constructor(e,t,n,r,o,i,a){super(e,n,r,o,a),this.cacheConfig=t,this.logger=r,this.internalStorage=new hc,this.browserStorage=_c(e,t.cacheLocation,r,o),this.temporaryCacheStorage=_c(e,t.temporaryCacheLocation,r,o),this.cookieStorage=new Cc,this.eventHandler=i}async initialize(e){this.performanceClient.addFields({cacheLocation:this.cacheConfig.cacheLocation,cacheRetentionDays:this.cacheConfig.cacheRetentionDays},e),await this.browserStorage.initialize(e),await this.migrateExistingCache(e),this.trackVersionChanges(e)}async migrateExistingCache(e){const t=Ic(this.browserStorage,0),n=kc(this.clientId,this.browserStorage,0);this.performanceClient.addFields({oldAccountCount:t.length,oldAccessCount:n.accessToken.length,oldIdCount:n.idToken.length,oldRefreshCount:n.refreshToken.length},e);const r=Ic(this.browserStorage,1),o=kc(this.clientId,this.browserStorage,1);this.performanceClient.addFields({currAccountCount:r.length,currAccessCount:o.accessToken.length,currIdCount:o.idToken.length,currRefreshCount:o.refreshToken.length},e),await Promise.all([this.updateV0ToCurrent(1,t,r,e),this.updateV0ToCurrent(1,n.idToken,o.idToken,e),this.updateV0ToCurrent(1,n.accessToken,o.accessToken,e),this.updateV0ToCurrent(1,n.refreshToken,o.refreshToken,e)]),t.length>0?this.browserStorage.setItem(Ys(0),JSON.stringify(t)):this.browserStorage.removeItem(Ys(0)),r.length>0?this.browserStorage.setItem(Ys(1),JSON.stringify(r)):this.browserStorage.removeItem(Ys(1)),this.setTokenKeys(n,e,0),this.setTokenKeys(o,e,1)}async updateV0ToCurrent(e,t,n,r){const o=[];for(const i of[...t]){const a=this.browserStorage.getItem(i),s=this.validateAndParseJson(a||"");if(!s){Rc(t,i);continue}s.lastUpdatedAt||(s.lastUpdatedAt=Date.now().toString(),this.setItem(i,JSON.stringify(s),r));const c=wc(s)?await this.browserStorage.decryptData(i,s,r):s;let l;if(c&&(zr(c)||Kr(c))&&(l=c.expiresOn),!c||xr(s.lastUpdatedAt,this.cacheConfig.cacheRetentionDays)||l&&Br(l,300))this.browserStorage.removeItem(i),Rc(t,i),this.performanceClient.incrementFields({expiredCacheRemovedCount:1},r);else if(this.cacheConfig.cacheLocation!==fa.LocalStorage||wc(s)){const t=`${zs}.${e}-${i}`,a=this.browserStorage.getItem(t);if(!a){o.push(this.setUserData(t,JSON.stringify(c),r,s.lastUpdatedAt).then(()=>{n.push(t),this.performanceClient.incrementFields({upgradedCacheCount:1},r)}));continue}{const e=this.validateAndParseJson(a);if(Number(s.lastUpdatedAt)>Number(e.lastUpdatedAt)){o.push(this.setUserData(t,JSON.stringify(c),r,s.lastUpdatedAt).then(()=>{this.performanceClient.incrementFields({updatedCacheFromV0Count:1},r)}));continue}}}}return Promise.all(o)}trackVersionChanges(e){const t=this.browserStorage.getItem(Ws);t&&(this.logger.info(`MSAL.js was last initialized by version: ${t}`),this.performanceClient.addFields({previousLibraryVersion:t},e)),t!==Fs&&this.setItem(Ws,Fs,e)}validateAndParseJson(e){if(!e)return null;try{const t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}}setItem(e,t,n){let r=0,o=[];for(let i=0;i<=20;i++)try{this.browserStorage.setItem(e,t),i>0&&(i<=r?this.removeAccessTokenKeys(o.slice(0,i),n,0):(this.removeAccessTokenKeys(o.slice(0,r),n,0),this.removeAccessTokenKeys(o.slice(r,i),n)));break}catch(a){const s=yn(a);if(!(s.errorCode===pn&&i<20))throw s;if(!o.length){const n=e===Xs(this.clientId,0)?JSON.parse(t).accessToken:this.getTokenKeys(0).accessToken,i=e===Xs(this.clientId)?JSON.parse(t).accessToken:this.getTokenKeys().accessToken;o=[...n,...i],r=n.length}if(o.length<=i)throw s;this.removeAccessToken(o[i],n,!1)}}async setUserData(e,t,n,r){let o=0,i=[];for(let a=0;a<=20;a++)try{await Pr(this.browserStorage.setUserData.bind(this.browserStorage),wn.SetUserData,this.logger,this.performanceClient)(e,t,n,r),a>0&&(a<=o?this.removeAccessTokenKeys(i.slice(0,a),n,0):(this.removeAccessTokenKeys(i.slice(0,o),n,0),this.removeAccessTokenKeys(i.slice(o,a),n)));break}catch(e){const t=yn(e);if(!(t.errorCode===pn&&a<20))throw t;if(!i.length){const e=this.getTokenKeys(0).accessToken,t=this.getTokenKeys().accessToken;i=[...e,...t],o=e.length}if(i.length<=a)throw t;this.removeAccessToken(i[a],n,!1)}}getAccount(e,t){this.logger.trace("BrowserCacheManager.getAccount called");const n=this.browserStorage.getUserData(e);if(!n)return this.removeAccountKeyFromMap(e,t),null;const r=this.validateAndParseJson(n);return r&&io.isAccountEntity(r)?Cn.toObject(new io,r):null}async setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");const n=this.generateAccountKey(e.getAccountInfo()),r=Date.now().toString();e.lastUpdatedAt=r,await this.setUserData(n,JSON.stringify(e),t,r);const o=this.addAccountKeyToMap(n,t);this.cacheConfig.cacheLocation===fa.LocalStorage&&o&&this.eventHandler.emitEvent(Sc.ACCOUNT_ADDED,void 0,e.getAccountInfo())}getAccountKeys(){return Ic(this.browserStorage)}addAccountKeyToMap(e,t){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const n=this.getAccountKeys();return-1===n.indexOf(e)?(n.push(e),this.setItem(Ys(),JSON.stringify(n),t),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added"),!0):(this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map"),!1)}removeAccountKeyFromMap(e,t){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const n=this.getAccountKeys(),r=n.indexOf(e);if(r>-1){if(n.splice(r,1),0===n.length)return void this.removeItem(Ys());this.setItem(Ys(),JSON.stringify(n),t),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")}else this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}removeAccount(e,t){const n=this.getActiveAccount(t);n?.homeAccountId===e.homeAccountId&&n?.environment===e.environment&&this.setActiveAccount(null,t),super.removeAccount(e,t),this.removeAccountKeyFromMap(this.generateAccountKey(e),t),this.browserStorage.getKeys().forEach(t=>{t.includes(e.homeAccountId)&&t.includes(e.environment)&&this.browserStorage.removeItem(t)}),this.cacheConfig.cacheLocation===fa.LocalStorage&&this.eventHandler.emitEvent(Sc.ACCOUNT_REMOVED,void 0,e)}removeIdToken(e,t){super.removeIdToken(e,t);const n=this.getTokenKeys(),r=n.idToken.indexOf(e);r>-1&&(this.logger.info("idToken removed from tokenKeys map"),n.idToken.splice(r,1),this.setTokenKeys(n,t))}removeAccessToken(e,t,n=!0){super.removeAccessToken(e,t),n&&this.removeAccessTokenKeys([e],t)}removeAccessTokenKeys(e,t,n=1){this.logger.trace("removeAccessTokenKey called");const r=this.getTokenKeys(n);let o=0;if(e.forEach(e=>{const t=r.accessToken.indexOf(e);t>-1&&(r.accessToken.splice(t,1),o++)}),o>0)return this.logger.info(`removed ${o} accessToken keys from tokenKeys map`),void this.setTokenKeys(r,t,n)}removeRefreshToken(e,t){super.removeRefreshToken(e,t);const n=this.getTokenKeys(),r=n.refreshToken.indexOf(e);r>-1&&(this.logger.info("refreshToken removed from tokenKeys map"),n.refreshToken.splice(r,1),this.setTokenKeys(n,t))}getTokenKeys(e=1){return kc(this.clientId,this.browserStorage,e)}setTokenKeys(e,t,n=1){0!==e.idToken.length||0!==e.accessToken.length||0!==e.refreshToken.length?this.setItem(Xs(this.clientId,n),JSON.stringify(e),t):this.removeItem(Xs(this.clientId,n))}getIdTokenCredential(e,t){const n=this.browserStorage.getUserData(e);if(!n)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeIdToken(e,t),null;const r=this.validateAndParseJson(n);return r&&((o=r)&&Fr(o)&&o.hasOwnProperty("realm")&&o.credentialType===D.ID_TOKEN)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null);var o}async setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const n=this.generateCredentialKey(e),r=Date.now().toString();e.lastUpdatedAt=r,await this.setUserData(n,JSON.stringify(e),t,r);const o=this.getTokenKeys();-1===o.idToken.indexOf(n)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),o.idToken.push(n),this.setTokenKeys(o,t))}getAccessTokenCredential(e,t){const n=this.browserStorage.getUserData(e);if(!n)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeAccessTokenKeys([e],t),null;const r=this.validateAndParseJson(n);return r&&zr(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)}async setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const n=this.generateCredentialKey(e),r=Date.now().toString();e.lastUpdatedAt=r,await this.setUserData(n,JSON.stringify(e),t,r);const o=this.getTokenKeys(),i=o.accessToken.indexOf(n);-1!==i&&o.accessToken.splice(i,1),this.logger.trace(`access token ${-1===i?"added to":"updated in"} map`),o.accessToken.push(n),this.setTokenKeys(o,t)}getRefreshTokenCredential(e,t){const n=this.browserStorage.getUserData(e);if(!n)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeRefreshToken(e,t),null;const r=this.validateAndParseJson(n);return r&&Kr(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)}async setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const n=this.generateCredentialKey(e),r=Date.now().toString();e.lastUpdatedAt=r,await this.setUserData(n,JSON.stringify(e),t,r);const o=this.getTokenKeys();-1===o.refreshToken.indexOf(n)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),o.refreshToken.push(n),this.setTokenKeys(o,t))}getAppMetadata(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&(r=e,(o=n)&&0===r.indexOf(U)&&o.hasOwnProperty("clientId")&&o.hasOwnProperty("environment"))?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),n):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null);var r,o}setAppMetadata(e,t){this.logger.trace("BrowserCacheManager.setAppMetadata called");const n=function({environment:e,clientId:t}){return[U,e,t].join(x).toLowerCase()}(e);this.setItem(n,JSON.stringify(e),t)}getServerTelemetry(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){const n=0===e.indexOf(j.CACHE_KEY);let r=!0;return t&&(r=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),n&&r}(e,n)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),n):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,t,n){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t),n)}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){return!!t&&0===e.indexOf(F)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")}(e,n)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),n):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(e=>this.isAuthorityMetadata(e))}setWrapperMetadata(e,t){this.internalStorage.setItem(Sa,e),this.internalStorage.setItem(Ra,t)}getWrapperMetadata(){return[this.internalStorage.getItem(Sa)||t.EMPTY_STRING,this.internalStorage.getItem(Ra)||t.EMPTY_STRING]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(e){const t=this.generateCacheKey(I),n=this.browserStorage.getItem(t);if(!n)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters found"),null;const r=this.validateAndParseJson(n);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:r.homeAccountId,localAccountId:r.localAccountId,tenantId:r.tenantId},e)):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e,t){const n=this.generateCacheKey(I);if(e){this.logger.verbose("setActiveAccount: Active account set");const r={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId,lastUpdatedAt:qr().toString()};this.setItem(n,JSON.stringify(r),t)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(n);this.eventHandler.emitEvent(Sc.ACTIVE_ACCOUNT_CHANGED)}getThrottlingCache(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){let n=!1;e&&(n=0===e.indexOf(Y));let r=!0;return t&&(r=t.hasOwnProperty("throttleTime")),n&&r}(e,n)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),n):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,t,n){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t),n)}getTemporaryCache(e,t){const n=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const e=this.cookieStorage.getItem(n);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),e}const r=this.temporaryCacheStorage.getItem(n);if(!r){if(this.cacheConfig.cacheLocation===fa.LocalStorage){const e=this.browserStorage.getItem(n);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),e}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),r}setTemporaryCache(e,t,n){const r=n?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(r,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(r,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}clear(e){this.removeAllAccounts(e),this.removeAppMetadata(e),this.temporaryCacheStorage.getKeys().forEach(e=>{-1===e.indexOf(zs)&&-1===e.indexOf(this.clientId)||this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{-1===e.indexOf(zs)&&-1===e.indexOf(this.clientId)||this.browserStorage.removeItem(e)}),this.internalStorage.clear()}clearTokensAndKeysWithClaims(e){this.performanceClient.addQueueMeasurement(wn.ClearTokensAndKeysWithClaims,e);const t=this.getTokenKeys();let n=0;t.accessToken.forEach(t=>{const r=this.getAccessTokenCredential(t,e);r?.requestedClaimsHash&&t.includes(r.requestedClaimsHash.toLowerCase())&&(this.removeAccessToken(t,e),n++)}),n>0&&this.logger.warning(`${n} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return Vt.startsWith(e,zs)?e:`${zs}.${this.clientId}.${e}`}generateCredentialKey(e){const t=e.credentialType===D.REFRESH_TOKEN&&e.familyId||e.clientId,n=e.tokenType&&e.tokenType.toLowerCase()!==W.BEARER.toLowerCase()?e.tokenType.toLowerCase():"";return[`${zs}.1`,e.homeAccountId,e.environment,e.credentialType,t,e.realm||"",e.target||"",e.requestedClaimsHash||"",n].join("-").toLowerCase()}generateAccountKey(e){const t=e.homeAccountId.split(".")[1];return[`${zs}.1`,e.homeAccountId,e.environment,t||e.tenantId||""].join("-").toLowerCase()}resetRequestCache(){this.logger.trace("BrowserCacheManager.resetRequestCache called"),this.removeTemporaryItem(this.generateCacheKey(wa)),this.removeTemporaryItem(this.generateCacheKey(Ta)),this.removeTemporaryItem(this.generateCacheKey(Ia)),this.removeTemporaryItem(this.generateCacheKey(ka)),this.removeTemporaryItem(this.generateCacheKey(ba)),this.setInteractionInProgress(!1)}cacheAuthorizeRequest(e,t){this.logger.trace("BrowserCacheManager.cacheAuthorizeRequest called");const n=Da(JSON.stringify(e));if(this.setTemporaryCache(wa,n,!0),t){const e=Da(t);this.setTemporaryCache(Ta,e,!0)}}getCachedRequest(){this.logger.trace("BrowserCacheManager.getCachedRequest called");const e=this.getTemporaryCache(wa,!0);if(!e)throw Ji(vi);const t=this.getTemporaryCache(Ta,!0);let n,r="";try{n=JSON.parse(Ha(e)),t&&(r=Ha(t))}catch(t){throw this.logger.errorPii(`Attempted to parse: ${e}`),this.logger.error(`Parsing cached token request threw with error: ${t}`),Ji(yi)}return[n,r]}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(ba,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress()?.clientId;return e?t===this.clientId:!!t}getInteractionInProgress(){const e=`${zs}.${Aa}`,t=this.getTemporaryCache(e,!1);try{return t?JSON.parse(t):null}catch(t){return this.logger.error("Cannot parse interaction status. Removing temporary cache items and clearing url hash. Retrying interaction should fix the error"),this.removeTemporaryItem(e),this.resetRequestCache(),Cs(window),null}}setInteractionInProgress(e,t=ya){const n=`${zs}.${Aa}`;if(e){if(this.getInteractionInProgress())throw Ji(oi);this.setTemporaryCache(n,JSON.stringify({clientId:this.clientId,type:t}),!1)}else e||this.getInteractionInProgress()?.clientId!==this.clientId||this.removeTemporaryItem(n)}async hydrateCache(e,t){const n=Dr(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId);let r;t.claims&&(r=await this.cryptoImpl.hashString(t.claims));const o={idToken:n,accessToken:Ur(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?Or(e.expiresOn):0,e.extExpiresOn?Or(e.extExpiresOn):0,Ha,void 0,e.tokenType,void 0,t.sshKid,t.claims,r)};return this.saveCacheRecord(o,e.correlationId)}async saveCacheRecord(e,t,n){try{await super.saveCacheRecord(e,t,n)}catch(e){if(e instanceof vn&&this.performanceClient&&t)try{const e=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:e.refreshToken.length,cacheIdCount:e.idToken.length,cacheAtCount:e.accessToken.length},t)}catch(e){}throw e}}}function _c(e,t,n,r){try{switch(t){case fa.LocalStorage:return new Ac(e,n,r);case fa.SessionStorage:return new bc}}catch(e){n.error(e)}return new hc}const Pc=(e,t,n,r)=>new Ec(e,{cacheLocation:fa.MemoryStorage,cacheRetentionDays:5,temporaryCacheLocation:fa.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},ft,t,n,r);
/*! @azure/msal-browser v4.21.0 2025-08-19 */function Mc(e,t,n,r,o){return e.verbose("getAllAccounts called"),n?t.getAllAccounts(o||{},r):[]}function qc(e,t,n,r){const o=n.getAccountInfoFilteredBy(e,r);return o?(t.verbose("getAccount: Account matching provided filter found, returning"),o):(t.verbose("getAccount: No matching account found, returning null"),null)}function Oc(e,t,n,r){if(t.trace("getAccountByUsername called"),!e)return t.warning("getAccountByUsername: No username provided"),null;const o=n.getAccountInfoFilteredBy({username:e},r);return o?(t.verbose("getAccountByUsername: Account matching username found, returning"),t.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${e}`),o):(t.verbose("getAccountByUsername: No matching account found, returning null"),null)}function Nc(e,t,n,r){if(t.trace("getAccountByHomeId called"),!e)return t.warning("getAccountByHomeId: No homeAccountId provided"),null;const o=n.getAccountInfoFilteredBy({homeAccountId:e},r);return o?(t.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),t.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${e}`),o):(t.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function Bc(e,t,n,r){if(t.trace("getAccountByLocalId called"),!e)return t.warning("getAccountByLocalId: No localAccountId provided"),null;const o=n.getAccountInfoFilteredBy({localAccountId:e},r);return o?(t.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),t.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${e}`),o):(t.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function xc(e,t,n){t.setActiveAccount(e,n)}function Lc(e,t){return e.getActiveAccount(t)}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class Dc{constructor(e){this.eventCallbacks=new Map,this.logger=e||new vt({}),"undefined"!=typeof BroadcastChannel&&(this.broadcastChannel=new BroadcastChannel("msal.broadcast.event")),this.invokeCrossTabCallbacks=this.invokeCrossTabCallbacks.bind(this)}addEventCallback(e,t,n){if("undefined"!=typeof window){const r=n||Os();return this.eventCallbacks.has(r)?(this.logger.error(`Event callback with id: ${r} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(r,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${r}`),r)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,n,r){const o={eventType:e,interactionType:t||null,payload:n||null,error:r||null,timestamp:Date.now()};switch(e){case Sc.ACCOUNT_ADDED:case Sc.ACCOUNT_REMOVED:case Sc.ACTIVE_ACCOUNT_CHANGED:this.broadcastChannel?.postMessage(o);break;default:this.invokeCallbacks(o)}}invokeCallbacks(e){this.eventCallbacks.forEach(([t,n],r)=>{(0===n.length||n.includes(e.eventType))&&(this.logger.verbose(`Emitting event to callback ${r}: ${e.eventType}`),t.apply(null,[e]))})}invokeCrossTabCallbacks(e){const t=e.data;this.invokeCallbacks(t)}subscribeCrossTab(){this.broadcastChannel?.addEventListener("message",this.invokeCrossTabCallbacks)}unsubscribeCrossTab(){this.broadcastChannel?.removeEventListener("message",this.invokeCrossTabCallbacks)}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class Uc{constructor(e,t,n,r,o,i,a,s,c){this.config=e,this.browserStorage=t,this.browserCrypto=n,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.navigationClient=i,this.platformAuthProvider=s,this.correlationId=c||ts(),this.logger=r.clone(na,Fs,this.correlationId),this.performanceClient=a}async clearCacheOnLogout(e,t){if(t)try{this.browserStorage.removeAccount(t,e),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch(e){this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),this.browserStorage.clear(e),await this.browserCrypto.clearKeystore()}catch(e){this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return cn.getAbsoluteUrl(t,Ts())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const n={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Do(n,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,n=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(wn.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);const r={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e.requestAuthority||this.config.auth.authority,i=n?.length?"true"===n:this.config.auth.instanceAware,a=t&&i?this.config.auth.authority.replace(cn.getDomainFromUrl(o),t.environment):o,s=Wr.generateAuthority(a,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),c=await Pr(Yr,wn.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(s,this.config.system.networkClient,this.browserStorage,r,this.logger,this.correlationId,this.performanceClient);if(t&&!c.isAlias(t.environment))throw Wt(Ft);return c}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */async function Hc(e,t,n,r){n.addQueueMeasurement(wn.InitializeBaseRequest,e.correlationId);const o=e.authority||t.auth.authority,i=[...e&&e.scopes||[]],a={...e,correlationId:e.correlationId,authority:o,scopes:i};if(a.authenticationScheme){if(a.authenticationScheme===W.SSH){if(!e.sshJwk)throw Wt(Bt);if(!e.sshKid)throw Wt(xt)}r.verbose(`Authentication Scheme set to "${a.authenticationScheme}" as configured in Auth request`)}else a.authenticationScheme=W.BEARER,r.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return t.cache.claimsBasedCachingEnabled&&e.claims&&!Vt.isEmptyObj(e.claims)&&(a.requestedClaimsHash=await us(e.claims)),a}async function Fc(e,t,n,r,o){r.addQueueMeasurement(wn.InitializeSilentRequest,e.correlationId);const i=await Pr(Hc,wn.InitializeBaseRequest,o,r,e.correlationId)(e,n,r,o);return{...e,...i,account:t,forceRefresh:e.forceRefresh||!1}}function zc(e,t){let n;const r=e.httpMethod;if(t===kn.EAR){if(n=r||l,n!==l)throw Wt(zt)}else n=r||c;if(e.authorizePostBodyParameters&&n!==l)throw Wt(Kt);return n}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class Kc extends Uc{initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);const t={correlationId:this.correlationId||ts(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const n=this.getLogoutHintFromIdTokenClaims(e.account);n&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=n)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=cn.getAbsoluteUrl(e.postLogoutRedirectUri,Ts())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=cn.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,Ts())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=cn.getAbsoluteUrl(Ts(),Ts())),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(wn.StandardInteractionClientCreateAuthCodeClient,this.correlationId);const t=await Pr(this.getClientConfiguration.bind(this),wn.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e);return new Po(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:n,requestAuthority:r,requestAzureCloudOptions:o,requestExtraQueryParameters:i,account:a}=e;this.performanceClient.addQueueMeasurement(wn.StandardInteractionClientGetClientConfiguration,this.correlationId);const s=await Pr(this.getDiscoveredAuthority.bind(this),wn.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)({requestAuthority:r,requestAzureCloudOptions:o,requestExtraQueryParameters:i,account:a}),c=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:s,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:c.loggerCallback,piiLoggingEnabled:c.piiLoggingEnabled,logLevel:c.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:n,libraryInfo:{sku:na,version:Fs,cpu:t.EMPTY_STRING,os:t.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,n){this.performanceClient.addQueueMeasurement(wn.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);const r=this.getRedirectUri(e.redirectUri),o={interactionType:n},i=To.setRequestState(this.browserCrypto,e&&e.state||t.EMPTY_STRING,o),a={...await Pr(Hc,wn.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:r,state:i,nonce:e.nonce||ts(),responseMode:this.config.auth.OIDCOptions.serverResponseType},s={...a,httpMethod:zc(a,this.config.auth.protocolMode)};if(e.loginHint||e.sid)return s;const c=e.account||this.browserStorage.getActiveAccount(this.correlationId);return c&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${c.homeAccountId}`,this.correlationId),s.account=c),s}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */
/*! @azure/msal-browser v4.21.0 2025-08-19 */
function $c(e,t,n){const r=on(e);if(!r)throw rn(e)?(n.error(`A ${t} is present in the iframe but it does not contain known properties. It's likely that the ${t} has been replaced by code running on the redirectUri page.`),n.errorPii(`The ${t} detected is: ${e}`),Ji(ti)):(n.error(`The request has returned to the redirectUri but a ${t} is not present. It's likely that the ${t} has been removed or the page has been redirected by code running on the redirectUri page.`),Ji(Zo));return r}function Gc(e,t,n){if(!e.state)throw Ji(ei);const r=function(e,t){if(!t)return null;try{return To.parseRequestState(e,t).libraryState.meta}catch(e){throw pt(Ee)}}(t,e.state);if(!r)throw Ji(ni);if(r.interactionType!==n)throw Ji(ri)}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class Qc{constructor(e,t,n,r,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=r,this.performanceClient=o}async handleCodeResponse(e,t){let n;this.performanceClient.addQueueMeasurement(wn.HandleCodeResponse,t.correlationId);try{n=function(e,t){if(xo(e,t),!e.code)throw pt(tt);return e}(e,t.state)}catch(e){throw e instanceof Xr&&e.subError===si?Ji(si):e}return Pr(this.handleCodeResponseFromServer.bind(this),wn.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)(n,t)}async handleCodeResponseFromServer(e,t,n=!0){if(this.performanceClient.addQueueMeasurement(wn.HandleCodeResponseFromServer,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await Pr(this.authModule.updateAuthority.bind(this.authModule),wn.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),n&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const e=this.createCcsCredentials(t);e&&(this.authCodeRequest.ccsCredential=e)}return await Pr(this.authModule.acquireToken.bind(this.authModule),wn.AuthClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:Dn}:e.loginHint?{credential:e.loginHint,type:Un}:null}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */const jc="user_switch",Wc={[jc]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class Vc extends ye{constructor(e,t,n){super(e,t),Object.setPrototypeOf(this,Vc.prototype),this.name="NativeAuthError",this.ext=n}}function Jc(e){return!(!e.ext||!e.ext.status||"DISABLED"!==e.ext.status)||(!(!e.ext||!e.ext.error||-2147186943!==e.ext.error)||"ContentError"===e.errorCode)}function Yc(e,t,n){if(n&&n.status)switch(n.status){case"ACCOUNT_UNAVAILABLE":return wo(so);case"USER_INTERACTION_REQUIRED":return new Io(e,t);case"USER_CANCEL":return Ji(si);case"NO_NETWORK":return Ji(Ti);case"UX_NOT_ALLOWED":return wo(lo)}return new Vc(e,Wc[e]||t,n)}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class Xc extends Kc{async acquireToken(e){this.performanceClient.addQueueMeasurement(wn.SilentCacheClientAcquireToken,e.correlationId);const t=this.initializeServerTelemetryManager(Ea.acquireTokenSilent_silentFlow),n=await Pr(this.getClientConfiguration.bind(this),wn.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),r=new qo(n,this.performanceClient);this.logger.verbose("Silent auth client created");try{const t=(await Pr(r.acquireCachedToken.bind(r),wn.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),t}catch(e){throw e instanceof Vi&&e.errorCode===Ei&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),e}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t.correlationId,t?.account)}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class Zc extends Uc{constructor(e,t,n,r,o,i,a,s,c,l,u,d){super(e,t,n,r,o,i,s,c,d),this.apiId=a,this.accountId=l,this.platformAuthProvider=c,this.nativeStorageManager=u,this.silentCacheClient=new Xc(e,this.nativeStorageManager,n,r,o,i,s,c,d);const h=this.platformAuthProvider.getExtensionName();this.skus=Do.makeExtraSkuString({libraryName:na,libraryVersion:Fs,extensionName:h,extensionVersion:this.platformAuthProvider.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[jn]:this.skus}}async acquireToken(e,t){this.performanceClient.addQueueMeasurement(wn.NativeInteractionClientAcquireToken,this.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const n=this.performanceClient.startMeasurement(wn.NativeInteractionClientAcquireToken,this.correlationId),r=qr(),o=this.initializeServerTelemetryManager(this.apiId);try{const i=await this.initializeNativeRequest(e);try{const e=await this.acquireTokensFromCache(this.accountId,i);return n.end({success:!0,isNativeBroker:!1,fromCache:!0}),e}catch(e){if(t===Na.AccessToken)throw this.logger.info("MSAL internal Cache does not contain tokens, return error as per cache policy"),n.end({success:!1,brokerErrorCode:"cache_request_failed"}),e;this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const a=await this.platformAuthProvider.sendMessage(i);return await this.handleNativeResponse(a,i,r).then(e=>(n.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),o.clearNativeBrokerErrorCode(),e)).catch(e=>{throw n.end({success:!1,errorCode:e.errorCode,subErrorCode:e.subError}),e})}catch(e){throw e instanceof Vc&&o.setNativeBrokerErrorCode(e.errorCode),n.end({success:!1}),e}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:Jt.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),pt(je);const n=this.browserStorage.getBaseAccountInfo({nativeAccountId:e},this.correlationId);if(!n)throw pt(je);try{const e=this.createSilentCacheRequest(t,n),r=await this.silentCacheClient.acquireToken(e),o={...n,idTokenClaims:r?.idTokenClaims,idToken:r?.idToken};return{...r,account:o}}catch(e){throw e}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...n}=e;delete n.onRedirectNavigate;const r=await this.initializeNativeRequest(n);try{await this.platformAuthProvider.sendMessage(r)}catch(e){if(e instanceof Vc){if(this.initializeServerTelemetryManager(this.apiId).setNativeBrokerErrorCode(e.errorCode),Jc(e))throw e}}this.browserStorage.setTemporaryCache(ba,JSON.stringify(r),!0);const o={apiId:Ea.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},i=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(i,o)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const n=this.browserStorage.getCachedNativeRequest();if(!n)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&e?.addFields({errorCode:"no_cached_request"},t),null;const{prompt:r,...o}=n;r&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(ba));const i=qr();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const t=await this.platformAuthProvider.sendMessage(o),n=await this.handleNativeResponse(t,o,i);return this.initializeServerTelemetryManager(this.apiId).clearNativeBrokerErrorCode(),e&&this.correlationId&&this.performanceClient.addFields({isNativeBroker:!0},this.correlationId),n}catch(e){throw e}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,n){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const r=en(e.id_token,Ha),o=this.createHomeAccountIdentifier(e,r),i=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId},this.correlationId)?.homeAccountId;if(t.extraParameters?.child_client_id&&e.account.id!==t.accountId)this.logger.info("handleNativeServerResponse: Double broker flow detected, ignoring accountId mismatch");else if(o!==i&&e.account.id!==t.accountId)throw Yc(jc);const a=await this.getDiscoveredAuthority({requestAuthority:t.authority}),s=Eo(this.browserStorage,a,o,Ha,this.correlationId,r,e.client_info,void 0,r.tid,void 0,e.account.id,this.logger);e.expires_in=Number(e.expires_in);const c=await this.generateAuthenticationResult(e,t,r,s,a.canonicalAuthority,n);return await this.cacheAccount(s,this.correlationId),await this.cacheNativeTokens(e,t,o,r,e.access_token,c.tenantId,n),c}createHomeAccountIdentifier(e,n){return io.generateHomeAccountId(e.client_info||t.EMPTY_STRING,br,this.logger,this.browserCrypto,n)}generateScopes(e,t){return t?Jt.fromString(t):Jt.fromString(e)}async generatePopAccessToken(e,t){if(t.tokenType===W.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const n=new bo(this.browserCrypto),r={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw pt(ot);return n.signPopToken(e.access_token,t.keyId,r)}return e.access_token}async generateAuthenticationResult(e,n,r,o,i,a){const s=this.addTelemetryFromNativeResponse(e.properties.MATS),c=this.generateScopes(n.scope,e.scope),l=e.account.properties||{},u=l.UID||r.oid||r.sub||t.EMPTY_STRING,d=l.TenantId||r.tid||t.EMPTY_STRING,h=Zt(o.getAccountInfo(),void 0,r,e.id_token);h.nativeAccountId!==e.account.id&&(h.nativeAccountId=e.account.id);const g=await this.generatePopAccessToken(e,n),p=n.tokenType===W.POP?W.POP:W.BEARER;return{authority:i,uniqueId:u,tenantId:d,scopes:c.asArray(),account:h,idToken:e.id_token,idTokenClaims:r,accessToken:g,fromCache:!!s&&this.isResponseFromCache(s),expiresOn:Nr(a+e.expires_in),tokenType:p,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}async cacheAccount(e,t){await this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e.getAccountInfo(),t)}cacheNativeTokens(e,n,r,o,i,a,s){const c=Dr(r,n.authority,e.id_token||"",n.clientId,o.tid||""),l=s+(n.tokenType===W.POP?t.SHR_NONCE_VALIDITY:("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),u=this.generateScopes(e.scope,n.scope),d={idToken:c,accessToken:Ur(r,n.authority,i,n.clientId,o.tid||a,u.printScopes(),l,0,Ha,void 0,n.tokenType,void 0,n.keyId)};return this.nativeStorageManager.saveCacheRecord(d,this.correlationId,n.storeInCache)}getExpiresInValue(e,n){return e===W.POP?t.SHR_NONCE_VALIDITY:("string"==typeof n?parseInt(n,10):n)||0}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.platformAuthProvider.getExtensionId(),extensionVersion:this.platformAuthProvider.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}getMATSFromResponse(e){if(e)try{return JSON.parse(e)}catch(e){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return void 0===e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=await this.getCanonicalAuthority(e),{scopes:n,...r}=e,o=new Jt(n||[]);o.appendScopes(u);const i={...r,accountId:this.accountId,clientId:this.config.auth.clientId,authority:t.urlString,scope:o.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:this.getPrompt(e.prompt),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(i.signPopToken&&e.popKid)throw Ji(Hi);if(this.handleExtraBrokerParams(i),i.extraParameters=i.extraParameters||{},i.extraParameters.telemetry=ia,e.authenticationScheme===W.POP){const t={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},n=new bo(this.browserCrypto);let r;if(i.keyId)r=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:i.keyId})),i.signPopToken=!1;else{const e=await Pr(n.generateCnf.bind(n),wn.PopTokenGenerateCnf,this.logger,this.performanceClient,this.correlationId)(t,this.logger);r=e.reqCnfString,i.keyId=e.kid,i.signPopToken=!0}i.reqCnf=r}return this.addRequestSKUs(i),i}async getCanonicalAuthority(e){const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const n=new cn(t);return n.validateAsUri(),n}getPrompt(e){switch(this.apiId){case Ea.ssoSilent:case Ea.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),S.NONE}if(e)switch(e){case S.NONE:case S.CONSENT:case S.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e} is not compatible with native flow`),Ji(Di)}else this.logger.trace("initializeNativeRequest: prompt was not provided")}handleExtraBrokerParams(e){const t=e.extraParameters&&e.extraParameters.hasOwnProperty(Wn)&&e.extraParameters.hasOwnProperty(Vn)&&e.extraParameters.hasOwnProperty(zn);if(!e.embeddedClientId&&!t)return;let n="";const r=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,n=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[Vn],n=e.extraParameters[zn]),e.extraParameters={child_client_id:n,child_redirect_uri:r},this.performanceClient?.addFields({embeddedClientId:n,embeddedRedirectUri:r},this.correlationId)}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */async function el(e,t,n,r,o){const i=No({...e.auth,authority:t},n,r,o);if(cr(i,{sku:na,version:Fs,os:"",cpu:""}),e.auth.protocolMode!==kn.OIDC&&lr(i,e.telemetry.application),n.platformBroker&&(function(e){e.set("nativebroker","1")}(i),o.addFields({isPlatformAuthorizeRequest:!0},n.correlationId),n.authenticationScheme===W.POP)){const e=new pc(r,o),t=new bo(e);let a;if(n.popKid)a=e.encodeKid(n.popKid);else{a=(await Pr(t.generateCnf.bind(t),wn.PopTokenGenerateCnf,r,o,n.correlationId)(n,r)).reqCnfString}Ir(i,a)}return Yn(i,n.correlationId,o),i}async function tl(e,n,r,o,i){if(!r.codeChallenge)throw Wt(Mt);const a=await Pr(el,wn.GetStandardParams,o,i,r.correlationId)(e,n,r,o,i);return Xn(a,R),dr(a,r.codeChallenge,t.S256_CODE_CHALLENGE_METHOD),yr(a,r.extraQueryParameters||{}),Bo(n,a,e.auth.encodeExtraQueryParams,r.extraQueryParameters)}async function nl(e,t,n,r,o,i){if(!r.earJwk)throw Ji(Vo);const a=await el(t,n,r,o,i);Xn(a,E),function(e,t){e.set("ear_jwk",encodeURIComponent(t)),e.set("ear_jwe_crypto","eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0")}(a,r.earJwk);const s=new Map;yr(s,r.extraQueryParameters||{});return ol(e,Bo(n,s,t.auth.encodeExtraQueryParams,r.extraQueryParameters),a)}async function rl(e,n,r,o,i,a){const s=await el(n,r,o,i,a);Xn(s,R),dr(s,o.codeChallenge,o.codeChallengeMethod||t.S256_CODE_CHALLENGE_METHOD),function(e,t){Object.entries(t).forEach(([t,n])=>{n&&e.set(t,n)})}(s,o.authorizePostBodyParameters||{});const c=new Map;yr(c,o.extraQueryParameters||{});return ol(e,Bo(r,c,n.auth.encodeExtraQueryParams,o.extraQueryParameters),s)}function ol(e,t,n){const r=e.createElement("form");return r.method="post",r.action=t,n.forEach((t,n)=>{const o=e.createElement("input");o.hidden=!0,o.name=n,o.value=t,r.appendChild(o)}),e.body.appendChild(r),r}async function il(e,t,n,r,o,i,a,s,c,l){if(s.verbose("Account id found, calling WAM for token"),!l)throw Ji(xi);const u=new pc(s,c),d=new Zc(r,o,u,s,a,r.system.navigationClient,n,c,l,t,i,e.correlationId),{userRequestState:h}=To.parseRequestState(u,e.state);return Pr(d.acquireToken.bind(d),wn.NativeInteractionClientAcquireToken,s,c,e.correlationId)({...e,state:h,prompt:void 0})}async function al(e,t,n,r,o,i,a,s,c,l,u,d){if(eo.removeThrottle(a,o.auth.clientId,e),t.accountId)return Pr(il,wn.HandleResponsePlatformBroker,l,u,e.correlationId)(e,t.accountId,r,o,a,s,c,l,u,d);const h={...e,code:t.code||"",codeVerifier:n},g=new Qc(i,a,h,l,u);return await Pr(g.handleCodeResponse.bind(g),wn.HandleCodeResponse,l,u,e.correlationId)(t,e)}async function sl(e,t,n,r,o,i,a,s,c,l,u){if(eo.removeThrottle(i,r.auth.clientId,e),xo(t,e.state),!t.ear_jwe)throw Ji(Jo);if(!e.earJwk)throw Ji(Vo);const d=JSON.parse(await Pr(os,wn.DecryptEarResponse,c,l,e.correlationId)(e.earJwk,t.ear_jwe));if(d.accountId)return Pr(il,wn.HandleResponsePlatformBroker,c,l,e.correlationId)(e,d.accountId,n,r,i,a,s,c,l,u);const h=new Ro(r.auth.clientId,i,new pc(c,l),c,null,null,l);h.validateTokenResponse(d);const g={code:"",state:e.state,nonce:e.nonce,client_info:d.client_info,cloud_graph_host_name:d.cloud_graph_host_name,cloud_instance_host_name:d.cloud_instance_host_name,cloud_instance_name:d.cloud_instance_name,msgraph_host:d.msgraph_host};return await Pr(h.handleServerTokenResponse.bind(h),wn.HandleServerTokenResponse,c,l,e.correlationId)(d,o,qr(),e,g,void 0,void 0,void 0,void 0)}
/*! @azure/msal-browser v4.21.0 2025-08-19 */async function cl(e,t,n){e.addQueueMeasurement(wn.GeneratePkceCodes,n);const r=_r(ll,wn.GenerateCodeVerifier,t,e,n)(e,t,n);return{verifier:r,challenge:await Pr(ul,wn.GenerateCodeChallengeFromVerifier,t,e,n)(r,e,t,n)}}function ll(e,t,n){try{const r=new Uint8Array(32);_r(Za,wn.GetRandomValues,t,e,n)(r);return La(r)}catch(e){throw Ji(Wo)}}async function ul(e,t,n,r){t.addQueueMeasurement(wn.GenerateCodeChallengeFromVerifier,r);try{const o=await Pr(Xa,wn.Sha256Digest,n,t,r)(e,t,r);return La(new Uint8Array(o))}catch(e){throw Ji(Wo)}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class dl{constructor(e,t,n,r){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=r,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=n,this.handshakeEvent=n.startMeasurement(wn.NativeMessageHandlerHandshake),this.platformAuthType=ua}async sendMessage(e){this.logger.trace(this.platformAuthType+" - sendMessage called.");const t={method:ga,request:e},n={channel:ra,extensionId:this.extensionId,responseId:ts(),body:t};this.logger.trace(this.platformAuthType+" - Sending request to browser extension"),this.logger.tracePii(this.platformAuthType+` - Sending request to browser extension: ${JSON.stringify(n)}`),this.messageChannel.port1.postMessage(n);const r=await new Promise((e,t)=>{this.resolvers.set(n.responseId,{resolve:e,reject:t})});return this.validatePlatformBrokerResponse(r)}static async createProvider(e,t,n){e.trace("PlatformAuthExtensionHandler - createProvider called.");try{const r=new dl(e,t,n,oa);return await r.sendHandshakeRequest(),r}catch(r){const o=new dl(e,t,n);return await o.sendHandshakeRequest(),o}}async sendHandshakeRequest(){this.logger.trace(this.platformAuthType+" - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:ra,extensionId:this.extensionId,responseId:ts(),body:{method:da}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=e=>{this.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,n)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:n}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),n(Ji(Ni)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace(this.platformAuthType+" - onWindowMessage called"),e.source!==window)return;const t=e.data;if(t.channel&&t.channel===ra&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===da){const e=this.handshakeResolvers.get(t.responseId);if(!e)return void this.logger.trace(this.platformAuthType+`.onWindowMessage - resolver can't be found for request ${t.responseId}`);this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),e.reject(Ji(Bi))}}onChannelMessage(e){this.logger.trace(this.platformAuthType+" - onChannelMessage called.");const t=e.data,n=this.resolvers.get(t.responseId),r=this.handshakeResolvers.get(t.responseId);try{const e=t.body.method;if(e===pa){if(!n)return;const e=t.body.response;if(this.logger.trace(this.platformAuthType+" - Received response from browser extension"),this.logger.tracePii(this.platformAuthType+` - Received response from browser extension: ${JSON.stringify(e)}`),"Success"!==e.status)n.reject(Yc(e.code,e.description,e.ext));else{if(!e.result)throw Ce(ge,"Event does not contain result.");e.result.code&&e.result.description?n.reject(Yc(e.result.code,e.result.description,e.result.ext)):n.resolve(e.result)}this.resolvers.delete(t.responseId)}else if(e===ha){if(!r)return void this.logger.trace(this.platformAuthType+`.onChannelMessage - resolver can't be found for request ${t.responseId}`);clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(this.platformAuthType+` - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),r.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(t){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${t}`),this.logger.errorPii(`Unable to parse ${e}`),n?n.reject(t):r&&r.reject(t)}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw Ce(ge,"Response missing expected properties.")}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}getExtensionName(){return this.getExtensionId()===oa?"chrome":this.getExtensionId()?.length?"unknown":void 0}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class hl{constructor(e,t,n){this.logger=e,this.performanceClient=t,this.correlationId=n,this.platformAuthType=la}static async createProvider(e,t,n){if(e.trace("PlatformAuthDOMHandler: createProvider called"),window.navigator?.platformAuthentication){const r=await window.navigator.platformAuthentication.getSupportedContracts(aa);if(r?.includes(ca))return e.trace("Platform auth api available in DOM"),new hl(e,t,n)}}getExtensionId(){return aa}getExtensionVersion(){return""}getExtensionName(){return sa}async sendMessage(e){this.logger.trace(this.platformAuthType+" - Sending request to browser DOM API");try{const t=this.initializePlatformDOMRequest(e),n=await window.navigator.platformAuthentication.executeGetToken(t);return this.validatePlatformBrokerResponse(n)}catch(e){throw this.logger.error(this.platformAuthType+" - executeGetToken DOM API error"),e}}initializePlatformDOMRequest(e){this.logger.trace(this.platformAuthType+" - initializeNativeDOMRequest called");const{accountId:t,clientId:n,authority:r,scope:o,redirectUri:i,correlationId:a,state:s,storeInCache:c,embeddedClientId:l,extraParameters:u,...d}=e,h=this.getDOMExtraParams(d);return{accountId:t,brokerId:this.getExtensionId(),authority:r,clientId:n,correlationId:a||this.correlationId,extraParameters:{...u,...h},isSecurityTokenService:!1,redirectUri:i,scope:o,state:s,storeInCache:c,embeddedClientId:l}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("isSuccess")){if(e.hasOwnProperty("accessToken")&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("clientInfo")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scopes")&&e.hasOwnProperty("expiresIn"))return this.logger.trace(this.platformAuthType+" - platform broker returned successful and valid response"),this.convertToPlatformBrokerResponse(e);if(e.hasOwnProperty("error")){const t=e;if(!1===t.isSuccess&&t.error&&t.error.code)throw this.logger.trace(this.platformAuthType+" - platform broker returned error response"),Yc(t.error.code,t.error.description,{error:parseInt(t.error.errorCode),protocol_error:t.error.protocolError,status:t.error.status,properties:t.error.properties})}}throw Ce(ge,"Response missing expected properties.")}convertToPlatformBrokerResponse(e){this.logger.trace(this.platformAuthType+" - convertToNativeResponse called");return{access_token:e.accessToken,id_token:e.idToken,client_info:e.clientInfo,account:e.account,expires_in:e.expiresIn,scope:e.scopes,state:e.state||"",properties:e.properties||{},extendedLifetimeToken:e.extendedLifetimeToken??!1,shr:e.proofOfPossessionPayload}}getDOMExtraParams(e){return{...Object.entries(e).reduce((e,[t,n])=>(e[t]=String(n),e),{})}}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */async function gl(e,t,n,r){e.trace("getPlatformAuthProvider called",n);const o=function(){let e;try{return e=window[fa.SessionStorage],"true"===e?.getItem(js)}catch(e){return!1}}();let i;e.trace("Has client allowed platform auth via DOM API: "+o);try{o&&(i=await hl.createProvider(e,t,n)),i||(e.trace("Platform auth via DOM API not available, checking for extension"),i=await dl.createProvider(e,r||2e3,t))}catch(t){e.trace("Platform auth not available",t)}return i}function pl(e,t,n,r){if(t.trace("isPlatformAuthAllowed called"),!e.system.allowPlatformBroker)return t.trace("isPlatformAuthAllowed: allowPlatformBroker is not enabled, returning false"),!1;if(!n)return t.trace("isPlatformAuthAllowed: Platform auth provider is not initialized, returning false"),!1;if(r)switch(r){case W.BEARER:case W.POP:return t.trace("isPlatformAuthAllowed: authenticationScheme is supported, returning true"),!0;default:return t.trace("isPlatformAuthAllowed: authenticationScheme is not supported, returning false"),!1}return!0}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class fl extends Kc{constructor(e,t,n,r,o,i,a,s,c,l){super(e,t,n,r,o,i,a,c,l),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=s,this.eventHandler=o}acquireToken(e,t){let n;try{if(n={popupName:this.generatePopupName(e.scopes||u,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window},this.performanceClient.addFields({isAsyncPopup:this.config.system.asyncPopups},this.correlationId),this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,n,t);{const r={...e,httpMethod:zc(e,this.config.auth.protocolMode)};return this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),n.popup=this.openSizedPopup("about:blank",n),this.acquireTokenPopupAsync(r,n,t)}}catch(e){return Promise.reject(e)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),n={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:e?.popupWindowAttributes||{},popupWindowParent:e?.popupWindowParent??window},r=e&&e.authority,o=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,n,r,o)):(this.logger.verbose("asyncPopup set to false, opening popup"),n.popup=this.openSizedPopup("about:blank",n),this.logoutPopupAsync(t,n,r,o))}catch(e){return Promise.reject(e)}}async acquireTokenPopupAsync(t,n,r){this.logger.verbose("acquireTokenPopupAsync called");const o=await Pr(this.initializeAuthorizationRequest.bind(this),wn.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(t,e.InteractionType.Popup);n.popup&&qs(o.authority);const i=pl(this.config,this.logger,this.platformAuthProvider,t.authenticationScheme);return o.platformBroker=i,this.config.auth.protocolMode===kn.EAR?this.executeEarFlow(o,n):this.executeCodeFlow(o,n,r)}async executeCodeFlow(t,n,r){const o=t.correlationId,i=this.initializeServerTelemetryManager(Ea.acquireTokenPopup),a=r||await Pr(cl,wn.GeneratePkceCodes,this.logger,this.performanceClient,o)(this.performanceClient,this.logger,o),s={...t,codeChallenge:a.challenge};try{const r=await Pr(this.createAuthCodeClient.bind(this),wn.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,o)({serverTelemetryManager:i,requestAuthority:s.authority,requestAzureCloudOptions:s.azureCloudOptions,requestExtraQueryParameters:s.extraQueryParameters,account:s.account});if(s.httpMethod===l)return await this.executeCodeFlowWithPost(s,n,r,a.verifier);{const i=await Pr(tl,wn.GetAuthCodeUrl,this.logger,this.performanceClient,o)(this.config,r.authority,s,this.logger,this.performanceClient),c=this.initiateAuthRequest(i,n);this.eventHandler.emitEvent(Sc.POPUP_OPENED,e.InteractionType.Popup,{popupWindow:c},null);const l=await this.monitorPopupForHash(c,n.popupWindowParent),u=_r($c,wn.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(l,this.config.auth.OIDCOptions.serverResponseType,this.logger);return await Pr(al,wn.HandleResponseCode,this.logger,this.performanceClient,o)(t,u,a.verifier,Ea.acquireTokenPopup,this.config,r,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}}catch(e){throw n.popup?.close(),e instanceof ye&&(e.setCorrelationId(this.correlationId),i.cacheFailedRequest(e)),e}}async executeEarFlow(e,t){const n=e.correlationId,r=await Pr(this.getDiscoveredAuthority.bind(this),wn.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,n)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),o=await Pr(rs,wn.GenerateEarKey,this.logger,this.performanceClient,n)(),i={...e,earJwk:o},a=t.popup||this.openPopup("about:blank",t);(await nl(a.document,this.config,r,i,this.logger,this.performanceClient)).submit();const s=await Pr(this.monitorPopupForHash.bind(this),wn.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,n)(a,t.popupWindowParent),c=_r($c,wn.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(s,this.config.auth.OIDCOptions.serverResponseType,this.logger);return Pr(sl,wn.HandleResponseEar,this.logger,this.performanceClient,n)(i,c,Ea.acquireTokenPopup,this.config,r,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async executeCodeFlowWithPost(e,t,n,r){const o=e.correlationId,i=await Pr(this.getDiscoveredAuthority.bind(this),wn.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,o)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),a=t.popup||this.openPopup("about:blank",t);(await rl(a.document,this.config,i,e,this.logger,this.performanceClient)).submit();const s=await Pr(this.monitorPopupForHash.bind(this),wn.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,o)(a,t.popupWindowParent),c=_r($c,wn.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(s,this.config.auth.OIDCOptions.serverResponseType,this.logger);return Pr(al,wn.HandleResponseCode,this.logger,this.performanceClient,o)(e,c,r,Ea.acquireTokenPopup,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async logoutPopupAsync(t,n,r,o){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(Sc.LOGOUT_START,e.InteractionType.Popup,t);const i=this.initializeServerTelemetryManager(Ea.logoutPopup);try{await this.clearCacheOnLogout(this.correlationId,t.account);const a=await Pr(this.createAuthCodeClient.bind(this),wn.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:i,requestAuthority:r,account:t.account||void 0});try{a.authority.endSessionEndpoint}catch{if(t.account?.homeAccountId&&t.postLogoutRedirectUri&&a.authority.protocolMode===kn.OIDC){if(this.eventHandler.emitEvent(Sc.LOGOUT_SUCCESS,e.InteractionType.Popup,t),o){const e={apiId:Ea.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=cn.getAbsoluteUrl(o,Ts());await this.navigationClient.navigateInternal(t,e)}return void n.popup?.close()}}const s=a.getLogoutUri(t);this.eventHandler.emitEvent(Sc.LOGOUT_SUCCESS,e.InteractionType.Popup,t);const c=this.openPopup(s,n);if(this.eventHandler.emitEvent(Sc.POPUP_OPENED,e.InteractionType.Popup,{popupWindow:c},null),await this.monitorPopupForHash(c,n.popupWindowParent).catch(()=>{}),o){const e={apiId:Ea.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=cn.getAbsoluteUrl(o,Ts());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${t}`),await this.navigationClient.navigateInternal(t,e)}else this.logger.verbose("No main window navigation requested")}catch(t){throw n.popup?.close(),t instanceof ye&&(t.setCorrelationId(this.correlationId),i.cacheFailedRequest(t)),this.eventHandler.emitEvent(Sc.LOGOUT_FAILURE,e.InteractionType.Popup,null,t),this.eventHandler.emitEvent(Sc.LOGOUT_END,e.InteractionType.Popup),t}this.eventHandler.emitEvent(Sc.LOGOUT_END,e.InteractionType.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),Ji(Xo)}monitorPopupForHash(e,t){return new Promise((t,n)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const r=setInterval(()=>{if(e.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(r),void n(Ji(si));let o="";try{o=e.location.href}catch(e){}if(!o||"about:blank"===o)return;clearInterval(r);let i="";const a=this.config.auth.OIDCOptions.serverResponseType;e&&(i=a===_.QUERY?e.location.search:e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(i)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{let n;if(t.popup?(n=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),n.location.assign(e)):void 0===t.popup&&(this.logger.verbosePii(`Opening popup window to: ${e}`),n=this.openSizedPopup(e,t)),!n)throw Ji(ai);return n.focus&&n.focus(),this.currentWindow=n,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),n}catch(e){throw this.logger.error("error opening popup "+e.message),Ji(ii)}}openSizedPopup(e,{popupName:t,popupWindowAttributes:n,popupWindowParent:r}){const o=r.screenLeft?r.screenLeft:r.screenX,i=r.screenTop?r.screenTop:r.screenY,a=r.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=r.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let c=n.popupSize?.width,l=n.popupSize?.height,u=n.popupPosition?.top,d=n.popupPosition?.left;return(!c||c<0||c>a)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),c=Xi),(!l||l<0||l>s)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),l=Zi),(!u||u<0||u>s)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),u=Math.max(0,s/2-Zi/2+i)),(!d||d<0||d>a)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),d=Math.max(0,a/2-Xi/2+o)),r.open(e,t,`width=${c}, height=${l}, top=${u}, left=${d}, scrollbars=yes`)}unloadWindow(e){this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow)}generatePopupName(e,t){return`${ea}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return`${ea}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class ml extends Kc{constructor(e,t,n,r,o,i,a,s,c,l){super(e,t,n,r,o,i,a,c,l),this.nativeStorage=s}async acquireToken(t){const n=await Pr(this.initializeAuthorizationRequest.bind(this),wn.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(t,e.InteractionType.Redirect);n.platformBroker=pl(this.config,this.logger,this.platformAuthProvider,t.authenticationScheme);const r=t=>{t.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.resetRequestCache(),this.eventHandler.emitEvent(Sc.RESTORE_FROM_BFCACHE,e.InteractionType.Redirect))},o=this.getRedirectStartPage(t.redirectStartPage);this.logger.verbosePii(`Redirect start page: ${o}`),this.browserStorage.setTemporaryCache(Ia,o,!0),window.addEventListener("pageshow",r);try{this.config.auth.protocolMode===kn.EAR?await this.executeEarFlow(n):await this.executeCodeFlow(n,t.onRedirectNavigate)}catch(e){throw e instanceof ye&&e.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",r),e}}async executeCodeFlow(e,t){const n=e.correlationId,r=this.initializeServerTelemetryManager(Ea.acquireTokenRedirect),o=await Pr(cl,wn.GeneratePkceCodes,this.logger,this.performanceClient,n)(this.performanceClient,this.logger,n),i={...e,codeChallenge:o.challenge};this.browserStorage.cacheAuthorizeRequest(i,o.verifier);try{if(i.httpMethod===l)return await this.executeCodeFlowWithPost(i);{const n=await Pr(this.createAuthCodeClient.bind(this),wn.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:i.authority,requestAzureCloudOptions:i.azureCloudOptions,requestExtraQueryParameters:i.extraQueryParameters,account:i.account}),o=await Pr(tl,wn.GetAuthCodeUrl,this.logger,this.performanceClient,e.correlationId)(this.config,n.authority,i,this.logger,this.performanceClient);return await this.initiateAuthRequest(o,t)}}catch(e){throw e instanceof ye&&(e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e)),e}}async executeEarFlow(e){const t=e.correlationId,n=await Pr(this.getDiscoveredAuthority.bind(this),wn.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),r=await Pr(rs,wn.GenerateEarKey,this.logger,this.performanceClient,t)(),o={...e,earJwk:r};this.browserStorage.cacheAuthorizeRequest(o);return(await nl(document,this.config,n,o,this.logger,this.performanceClient)).submit(),new Promise((e,t)=>{setTimeout(()=>{t(Ji($i,"failed_to_redirect"))},this.config.system.redirectNavigationTimeout)})}async executeCodeFlowWithPost(e){const t=e.correlationId,n=await Pr(this.getDiscoveredAuthority.bind(this),wn.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});this.browserStorage.cacheAuthorizeRequest(e);return(await rl(document,this.config,n,e,this.logger,this.performanceClient)).submit(),new Promise((e,t)=>{setTimeout(()=>{t(Ji($i,"failed_to_redirect"))},this.config.system.redirectNavigationTimeout)})}async handleRedirectPromise(e="",n,r,o){const i=this.initializeServerTelemetryManager(Ea.handleRedirectPromise);try{const[a,s]=this.getRedirectResponse(e||"");if(!a)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.resetRequestCache(),"back_forward"!==function(){if("undefined"==typeof window||void 0===window.performance||"function"!=typeof window.performance.getEntriesByType)return;const e=window.performance.getEntriesByType("navigation"),t=e.length?e[0]:void 0;return t?.type}()?o.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const c=this.browserStorage.getTemporaryCache(Ia,!0)||t.EMPTY_STRING,l=sn(c);if(l===sn(window.location.href)&&this.config.auth.navigateToLoginRequestUrl){this.logger.verbose("Current page is loginRequestUrl, handling response"),c.indexOf("#")>-1&&Is(c);return await this.handleResponse(a,n,r,i)}if(!this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(a,n,r,i);if(!ks()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(ka,s,!0);const e={apiId:Ea.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let t=!0;if(c&&"null"!==c)this.logger.verbose(`Navigating to loginRequestUrl: ${c}`),t=await this.navigationClient.navigateInternal(c,e);else{const n=As();this.browserStorage.setTemporaryCache(Ia,n,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),t=await this.navigationClient.navigateInternal(n,e)}if(!t)return await this.handleResponse(a,n,r,i)}return null}catch(e){throw e instanceof ye&&(e.setCorrelationId(this.correlationId),i.cacheFailedRequest(e)),e}}getRedirectResponse(t){this.logger.verbose("getRedirectResponseHash called");let n=t;n||(n=this.config.auth.OIDCOptions.serverResponseType===_.QUERY?window.location.search:window.location.hash);let r=on(n);if(r){try{Gc(r,this.browserCrypto,e.InteractionType.Redirect)}catch(e){return e instanceof ye&&this.logger.error(`Interaction type validation failed due to ${e.errorCode}: ${e.errorMessage}`),[null,""]}return Cs(window),this.logger.verbose("Hash contains known properties, returning response hash"),[r,n]}const o=this.browserStorage.getTemporaryCache(ka,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(ka)),o&&(r=on(o),r)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[r,o]):[null,""]}async handleResponse(e,t,n,r){if(!e.state)throw Ji(ei);if(e.ear_jwe){const n=await Pr(this.getDiscoveredAuthority.bind(this),wn.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,t.correlationId)({requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account});return Pr(sl,wn.HandleResponseEar,this.logger,this.performanceClient,t.correlationId)(t,e,Ea.acquireTokenRedirect,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}const o=await Pr(this.createAuthCodeClient.bind(this),wn.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority});return Pr(al,wn.HandleResponseCode,this.logger,this.performanceClient,t.correlationId)(t,e,n,Ea.acquireTokenRedirect,this.config,o,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const n={apiId:Ea.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},r=t||this.config.auth.onRedirectNavigate;if("function"==typeof r){this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback");return!1!==r(e)?(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void await this.navigationClient.navigateExternal(e,n)):void this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")}return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void await this.navigationClient.navigateExternal(e,n)}throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Ji(Xo)}async logout(t){this.logger.verbose("logoutRedirect called");const n=this.initializeLogoutRequest(t),r=this.initializeServerTelemetryManager(Ea.logout);try{this.eventHandler.emitEvent(Sc.LOGOUT_START,e.InteractionType.Redirect,t),await this.clearCacheOnLogout(this.correlationId,n.account);const o={apiId:Ea.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},i=await Pr(this.createAuthCodeClient.bind(this),wn.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:t&&t.authority,requestExtraQueryParameters:t?.extraQueryParameters,account:t&&t.account||void 0});if(i.authority.protocolMode===kn.OIDC)try{i.authority.endSessionEndpoint}catch{if(n.account?.homeAccountId)return void this.eventHandler.emitEvent(Sc.LOGOUT_SUCCESS,e.InteractionType.Redirect,n)}const a=i.getLogoutUri(n);if(this.eventHandler.emitEvent(Sc.LOGOUT_SUCCESS,e.InteractionType.Redirect,n),!t||"function"!=typeof t.onRedirectNavigate)return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,Ca),void await this.navigationClient.navigateExternal(a,o);if(!1!==t.onRedirectNavigate(a))return this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,Ca),void await this.navigationClient.navigateExternal(a,o);this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(t){throw t instanceof ye&&(t.setCorrelationId(this.correlationId),r.cacheFailedRequest(t)),this.eventHandler.emitEvent(Sc.LOGOUT_FAILURE,e.InteractionType.Redirect,null,t),this.eventHandler.emitEvent(Sc.LOGOUT_END,e.InteractionType.Redirect),t}this.eventHandler.emitEvent(Sc.LOGOUT_END,e.InteractionType.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return cn.getAbsoluteUrl(t,Ts())}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */async function vl(e,t,n,r,o){if(t.addQueueMeasurement(wn.SilentHandlerInitiateAuthRequest,r),!e)throw n.info("Navigate url is empty"),Ji(Xo);return o?Pr(kl,wn.SilentHandlerLoadFrame,n,t,r)(e,o,t,r):_r(wl,wn.SilentHandlerLoadFrameSync,n,t,r)(e)}async function yl(e,t,n,r,o){const i=Tl();if(!i.contentDocument)throw"No document associated with iframe!";return(await rl(i.contentDocument,e,t,n,r,o)).submit(),i}async function Cl(e,t,n,r,o){const i=Tl();if(!i.contentDocument)throw"No document associated with iframe!";return(await nl(i.contentDocument,e,t,n,r,o)).submit(),i}async function Il(e,t,n,r,o,i,a){return r.addQueueMeasurement(wn.SilentHandlerMonitorIframeForHash,i),new Promise((r,i)=>{t<Us&&o.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${t}ms) than the default (10000ms). This may result in timeouts.`);const s=window.setTimeout(()=>{window.clearInterval(c),i(Ji(li))},t),c=window.setInterval(()=>{let t="";const n=e.contentWindow;try{t=n?n.location.href:""}catch(e){}if(!t||"about:blank"===t)return;let o="";n&&(o=a===_.QUERY?n.location.search:n.location.hash),window.clearTimeout(s),window.clearInterval(c),r(o)},n)}).finally(()=>{_r(Al,wn.RemoveHiddenIframe,o,r,i)(e)})}function kl(e,t,n,r){return n.addQueueMeasurement(wn.SilentHandlerLoadFrame,r),new Promise((n,r)=>{const o=Tl();window.setTimeout(()=>{o?(o.src=e,n(o)):r("Unable to load iframe")},t)})}function wl(e){const t=Tl();return t.src=e,t}function Tl(){const e=document.createElement("iframe");return e.className="msalSilentIframe",e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(e),e}function Al(e){document.body===e.parentNode&&document.body.removeChild(e)}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class bl extends Kc{constructor(e,t,n,r,o,i,a,s,c,l,u){super(e,t,n,r,o,i,s,l,u),this.apiId=a,this.nativeStorage=c}async acquireToken(t){this.performanceClient.addQueueMeasurement(wn.SilentIframeClientAcquireToken,t.correlationId),t.loginHint||t.sid||t.account&&t.account.username||this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const n={...t};n.prompt?n.prompt!==S.NONE&&n.prompt!==S.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${n.prompt} with ${S.NONE}`),n.prompt=S.NONE):n.prompt=S.NONE;const r=await Pr(this.initializeAuthorizationRequest.bind(this),wn.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,t.correlationId)(n,e.InteractionType.Silent);return r.platformBroker=pl(this.config,this.logger,this.platformAuthProvider,r.authenticationScheme),qs(r.authority),this.config.auth.protocolMode===kn.EAR?this.executeEarFlow(r):this.executeCodeFlow(r)}async executeCodeFlow(e){let t;const n=this.initializeServerTelemetryManager(this.apiId);try{return t=await Pr(this.createAuthCodeClient.bind(this),wn.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:n,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),await Pr(this.silentTokenHelper.bind(this),wn.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(t,e)}catch(r){if(r instanceof ye&&(r.setCorrelationId(this.correlationId),n.cacheFailedRequest(r)),!(t&&r instanceof ye&&r.errorCode===Yi))throw r;return this.performanceClient.addFields({retryError:r.errorCode},this.correlationId),await Pr(this.silentTokenHelper.bind(this),wn.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(t,e)}}async executeEarFlow(e){const t=e.correlationId,n=await Pr(this.getDiscoveredAuthority.bind(this),wn.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),r=await Pr(rs,wn.GenerateEarKey,this.logger,this.performanceClient,t)(),o={...e,earJwk:r},i=await Pr(Cl,wn.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,t)(this.config,n,o,this.logger,this.performanceClient),a=this.config.auth.OIDCOptions.serverResponseType,s=await Pr(Il,wn.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,t)(i,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,t,a),c=_r($c,wn.DeserializeResponse,this.logger,this.performanceClient,t)(s,a,this.logger);return Pr(sl,wn.HandleResponseEar,this.logger,this.performanceClient,t)(o,c,this.apiId,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}logout(){return Promise.reject(Ji(pi))}async silentTokenHelper(e,t){const n=t.correlationId;this.performanceClient.addQueueMeasurement(wn.SilentIframeClientTokenHelper,n);const r=await Pr(cl,wn.GeneratePkceCodes,this.logger,this.performanceClient,n)(this.performanceClient,this.logger,n),o={...t,codeChallenge:r.challenge};let i;if(t.httpMethod===l)i=await Pr(yl,wn.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,n)(this.config,e.authority,o,this.logger,this.performanceClient);else{const t=await Pr(tl,wn.GetAuthCodeUrl,this.logger,this.performanceClient,n)(this.config,e.authority,o,this.logger,this.performanceClient);i=await Pr(vl,wn.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,n)(t,this.performanceClient,this.logger,n,this.config.system.navigateFrameWait)}const a=this.config.auth.OIDCOptions.serverResponseType,s=await Pr(Il,wn.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,n)(i,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,n,a),c=_r($c,wn.DeserializeResponse,this.logger,this.performanceClient,n)(s,a,this.logger);return Pr(al,wn.HandleResponseCode,this.logger,this.performanceClient,n)(t,c,r.verifier,this.apiId,this.config,e,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class Sl extends Kc{async acquireToken(e){this.performanceClient.addQueueMeasurement(wn.SilentRefreshClientAcquireToken,e.correlationId);const t=await Pr(Hc,wn.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),n={...e,...t};e.redirectUri&&(n.redirectUri=this.getRedirectUri(e.redirectUri));const r=this.initializeServerTelemetryManager(Ea.acquireTokenSilent_silentFlow),o=await this.createRefreshTokenClient({serverTelemetryManager:r,authorityUrl:n.authority,azureCloudOptions:n.azureCloudOptions,account:n.account});return Pr(o.acquireTokenByRefreshToken.bind(o),wn.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(n).catch(e=>{throw e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e),e})}logout(){return Promise.reject(Ji(pi))}async createRefreshTokenClient(e){const t=await Pr(this.getClientConfiguration.bind(this),wn.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new Mo(t,this.performanceClient)}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class Rl{constructor(e,t,n,r){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=n,this.cryptoObj=r}async loadExternalTokens(e,t,n){if(!this.isBrowserEnvironment)throw Ji(ki);const r=e.correlationId||ts(),o=t.id_token?en(t.id_token,Ha):void 0,i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=e.authority?new Wr(Wr.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,i,this.logger,e.correlationId||ts()):void 0,s=await this.loadAccount(e,n.clientInfo||t.client_info||"",r,o,a),c=await this.loadIdToken(t,s.homeAccountId,s.environment,s.realm,r),l=await this.loadAccessToken(e,t,s.homeAccountId,s.environment,s.realm,n,r),u=await this.loadRefreshToken(t,s.homeAccountId,s.environment,r);return this.generateAuthenticationResult(e,{account:s,idToken:c,accessToken:l,refreshToken:u},o,a)}async loadAccount(e,t,n,r,o){if(this.logger.verbose("TokenCache - loading account"),e.account){const t=io.createFromAccountInfo(e.account);return await this.storage.setAccount(t,n),t}if(!o||!t&&!r)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),Ji(Ri);const i=io.generateHomeAccountId(t,o.authorityType,this.logger,this.cryptoObj,r),a=r?.tid,s=Eo(this.storage,o,i,Ha,n,r,t,o.hostnameAndPort,a,void 0,void 0,this.logger);return await this.storage.setAccount(s,n),s}async loadIdToken(e,t,n,r,o){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const i=Dr(t,n,e.id_token,this.config.auth.clientId,r);return await this.storage.setIdTokenCredential(i,o),i}async loadAccessToken(e,t,n,r,o,i,a){if(!t.access_token)return this.logger.verbose("TokenCache - no access token found in response"),null;if(!t.expires_in)return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;if(!(t.scope||e.scopes&&e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null;this.logger.verbose("TokenCache - loading access token");const s=t.scope?Jt.fromString(t.scope):new Jt(e.scopes),c=i.expiresOn||t.expires_in+qr(),l=i.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+qr(),u=Ur(n,r,t.access_token,this.config.auth.clientId,o,s.printScopes(),c,l,Ha);return await this.storage.setAccessTokenCredential(u,a),u}async loadRefreshToken(e,t,n,r){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const o=Hr(t,n,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return await this.storage.setRefreshTokenCredential(o,r),o}generateAuthenticationResult(e,t,n,r){let o,i="",a=[],s=null;t?.accessToken&&(i=t.accessToken.secret,a=Jt.fromString(t.accessToken.target).asArray(),s=Nr(t.accessToken.expiresOn),o=Nr(t.accessToken.extendedExpiresOn));const c=t.account;return{authority:r?r.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:a,account:c.getAccountInfo(),idToken:t.idToken?.secret||"",idTokenClaims:n||{},accessToken:i,fromCache:!0,expiresOn:s,correlationId:e.correlationId||"",requestId:"",extExpiresOn:o,familyId:t.refreshToken?.familyId||"",tokenType:t?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:c.cloudGraphHostName||"",msGraphHost:c.msGraphHost||"",fromNativeBroker:!1}}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class El extends Po{constructor(e){super(e),this.includeRedirectUri=!1}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class _l extends Kc{constructor(e,t,n,r,o,i,a,s,c,l){super(e,t,n,r,o,i,s,c,l),this.apiId=a}async acquireToken(t){if(!t.code)throw Ji(_i);const n=await Pr(this.initializeAuthorizationRequest.bind(this),wn.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,t.correlationId)(t,e.InteractionType.Silent),r=this.initializeServerTelemetryManager(this.apiId);try{const e={...n,code:t.code},o=await Pr(this.getClientConfiguration.bind(this),wn.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,t.correlationId)({serverTelemetryManager:r,requestAuthority:n.authority,requestAzureCloudOptions:n.azureCloudOptions,requestExtraQueryParameters:n.extraQueryParameters,account:n.account}),i=new El(o);this.logger.verbose("Auth code client created");const a=new Qc(i,this.browserStorage,e,this.logger,this.performanceClient);return await Pr(a.handleCodeResponseFromServer.bind(a),wn.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)({code:t.code,msgraph_host:t.msGraphHost,cloud_graph_host_name:t.cloudGraphHostName,cloud_instance_host_name:t.cloudInstanceHostName},n,!1)}catch(e){throw e instanceof ye&&(e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e)),e}}logout(){return Promise.reject(Ji(pi))}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */
/*! @azure/msal-browser v4.21.0 2025-08-19 */
function Pl(e){const t=e?.idTokenClaims;return t?.tfp||t?.acr?"B2C":t?.tid?"9188040d-6c67-4c5b-b112-36a304b66dad"===t?.tid?"MSA":"AAD":void 0}function Ml(e,t){try{Ps(e)}catch(e){throw t.end({success:!1},e),e}}class ql{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new pc(this.logger,this.performanceClient):ft,this.eventHandler=new Dc(this.logger),this.browserStorage=this.isBrowserEnvironment?new Ec(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,Jr(this.config.auth)):Pc(this.config.auth.clientId,this.logger,this.performanceClient,this.eventHandler);const t={cacheLocation:fa.MemoryStorage,cacheRetentionDays:5,temporaryCacheLocation:fa.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new Ec(this.config.auth.clientId,t,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler),this.tokenCache=new Rl(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(e,t){const n=new ql(e);return await n.initialize(t),n}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e,t){if(this.logger.trace("initialize called"),this.initialized)return void this.logger.info("initialize has already been called, exiting early.");if(!this.isBrowserEnvironment)return this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,void this.eventHandler.emitEvent(Sc.INITIALIZE_END);const n=e?.correlationId||this.getRequestCorrelationId(),r=this.config.system.allowPlatformBroker,o=this.performanceClient.startMeasurement(wn.InitializeClientApplication,n);if(this.eventHandler.emitEvent(Sc.INITIALIZE_START),!t)try{this.logMultipleInstances(o)}catch{}if(await Pr(this.browserStorage.initialize.bind(this.browserStorage),wn.InitializeCache,this.logger,this.performanceClient,n)(n),r)try{this.platformAuthProvider=await gl(this.logger,this.performanceClient,n,this.config.system.nativeBrokerHandshakeTimeout)}catch(e){this.logger.verbose(e)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),_r(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),wn.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,n)(n)),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(n),this.initialized=!0,this.eventHandler.emitEvent(Sc.INITIALIZE_END),o.end({allowPlatformBroker:r,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),_s(this.initialized),this.isBrowserEnvironment){const t=e||"";let n=this.redirectResponse.get(t);return void 0===n?(n=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,n),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),n}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(t){if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const n=this.browserStorage.getInteractionInProgress()?.type;if(n===Ca)return this.logger.verbose("handleRedirectPromise removing interaction_in_progress flag and returning null after sign-out"),this.browserStorage.setInteractionInProgress(!1),Promise.resolve(null);const r=this.getAllAccounts(),o=this.browserStorage.getCachedNativeRequest(),i=o&&this.platformAuthProvider&&!t;let a,s;this.eventHandler.emitEvent(Sc.HANDLE_REDIRECT_START,e.InteractionType.Redirect);try{if(i&&this.platformAuthProvider){a=this.performanceClient.startMeasurement(wn.AcquireTokenRedirect,o?.correlationId||""),this.logger.trace("handleRedirectPromise - acquiring token from native platform"),a.add({isPlatformBrokerRequest:!0});const e=new Zc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ea.handleRedirectPromise,this.performanceClient,this.platformAuthProvider,o.accountId,this.nativeInternalStorage,o.correlationId);s=Pr(e.handleRedirectPromise.bind(e),wn.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,a.event.correlationId)(this.performanceClient,a.event.correlationId)}else{const[e,n]=this.browserStorage.getCachedRequest(),r=e.correlationId;a=this.performanceClient.startMeasurement(wn.AcquireTokenRedirect,r),this.logger.trace("handleRedirectPromise - acquiring token from web flow");const o=this.createRedirectClient(r);s=Pr(o.handleRedirectPromise.bind(o),wn.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,a.event.correlationId)(t,e,n,a)}}catch(e){throw this.browserStorage.resetRequestCache(),e}return s.then(t=>{if(t){this.browserStorage.resetRequestCache();r.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(Sc.LOGIN_SUCCESS,e.InteractionType.Redirect,t),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Redirect,t),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),a.end({success:!0,accountType:Pl(t.account)})}else a.event.errorCode?a.end({success:!1}):a.discard();return this.eventHandler.emitEvent(Sc.HANDLE_REDIRECT_END,e.InteractionType.Redirect),t}).catch(t=>{this.browserStorage.resetRequestCache();const n=t;throw r.length>0?this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Redirect,null,n):this.eventHandler.emitEvent(Sc.LOGIN_FAILURE,e.InteractionType.Redirect,null,n),this.eventHandler.emitEvent(Sc.HANDLE_REDIRECT_END,e.InteractionType.Redirect),a.end({success:!1},n),t})}async acquireTokenRedirect(t){const n=this.getRequestCorrelationId(t);this.logger.verbose("acquireTokenRedirect called",n);const r=this.performanceClient.startMeasurement(wn.AcquireTokenPreRedirect,n);r.add({accountType:Pl(t.account),scenarioId:t.scenarioId});const o=t.onRedirectNavigate;if(o)t.onRedirectNavigate=e=>{const t="function"==typeof o?o(e):void 0;return r.add({navigateCallbackResult:!1!==t}),r.event=r.end({success:!0})||r.event,t};else{const e=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=t=>{const n="function"==typeof e?e(t):void 0;return r.add({navigateCallbackResult:!1!==n}),r.event=r.end({success:!0})||r.event,n}}const i=this.getAllAccounts().length>0;try{let o;if(Ms(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,ya),i?this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_START,e.InteractionType.Redirect,t):this.eventHandler.emitEvent(Sc.LOGIN_START,e.InteractionType.Redirect,t),this.platformAuthProvider&&this.canUsePlatformBroker(t)){o=new Zc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ea.acquireTokenRedirect,this.performanceClient,this.platformAuthProvider,this.getNativeAccountId(t),this.nativeInternalStorage,n).acquireTokenRedirect(t,r).catch(e=>{if(r.add({brokerErrorName:e.name,brokerErrorCode:e.errorCode}),e instanceof Vc&&Jc(e)){this.platformAuthProvider=void 0;return this.createRedirectClient(n).acquireToken(t)}if(e instanceof Io){this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createRedirectClient(n).acquireToken(t)}throw e})}else{o=this.createRedirectClient(n).acquireToken(t)}return await o}catch(t){throw this.browserStorage.resetRequestCache(),2===r.event.status?this.performanceClient.startMeasurement(wn.AcquireTokenRedirect,n).end({success:!1},t):r.end({success:!1},t),i?this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Redirect,null,t):this.eventHandler.emitEvent(Sc.LOGIN_FAILURE,e.InteractionType.Redirect,null,t),t}}acquireTokenPopup(t){const n=this.getRequestCorrelationId(t),r=this.performanceClient.startMeasurement(wn.AcquireTokenPopup,n);r.add({scenarioId:t.scenarioId,accountType:Pl(t.account)});try{this.logger.verbose("acquireTokenPopup called",n),Ml(this.initialized,r),this.browserStorage.setInteractionInProgress(!0,ya)}catch(e){return Promise.reject(e)}const o=this.getAllAccounts();let i;o.length>0?this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_START,e.InteractionType.Popup,t):this.eventHandler.emitEvent(Sc.LOGIN_START,e.InteractionType.Popup,t);const a=this.getPreGeneratedPkceCodes(n);if(this.canUsePlatformBroker(t))r.add({isPlatformBrokerRequest:!0}),i=this.acquireTokenNative({...t,correlationId:n},Ea.acquireTokenPopup).then(e=>(r.end({success:!0,accountType:Pl(e.account)}),e)).catch(e=>{if(r.add({brokerErrorName:e.name,brokerErrorCode:e.errorCode}),e instanceof Vc&&Jc(e)){this.platformAuthProvider=void 0;return this.createPopupClient(n).acquireToken(t,a)}if(e instanceof Io){this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createPopupClient(n).acquireToken(t,a)}throw e});else{i=this.createPopupClient(n).acquireToken(t,a)}return i.then(t=>(o.length<this.getAllAccounts().length?this.eventHandler.emitEvent(Sc.LOGIN_SUCCESS,e.InteractionType.Popup,t):this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Popup,t),r.end({success:!0,accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length,accountType:Pl(t.account)}),t)).catch(t=>(o.length>0?this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Popup,null,t):this.eventHandler.emitEvent(Sc.LOGIN_FAILURE,e.InteractionType.Popup,null,t),r.end({success:!1},t),Promise.reject(t))).finally(async()=>{this.browserStorage.setInteractionInProgress(!1),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(n)})}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(t){const n=this.getRequestCorrelationId(t),r={...t,prompt:t.prompt,correlationId:n};let o;if(this.ssoSilentMeasurement=this.performanceClient.startMeasurement(wn.SsoSilent,n),this.ssoSilentMeasurement?.add({scenarioId:t.scenarioId,accountType:Pl(t.account)}),Ml(this.initialized,this.ssoSilentMeasurement),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",n),this.eventHandler.emitEvent(Sc.SSO_SILENT_START,e.InteractionType.Silent,r),this.canUsePlatformBroker(r))this.ssoSilentMeasurement?.add({isPlatformBrokerRequest:!0}),o=this.acquireTokenNative(r,Ea.ssoSilent).catch(e=>{if(this.ssoSilentMeasurement?.add({brokerErrorName:e.name,brokerErrorCode:e.errorCode}),e instanceof Vc&&Jc(e)){this.platformAuthProvider=void 0;return this.createSilentIframeClient(r.correlationId).acquireToken(r)}throw e});else{o=this.createSilentIframeClient(r.correlationId).acquireToken(r)}return o.then(t=>(this.eventHandler.emitEvent(Sc.SSO_SILENT_SUCCESS,e.InteractionType.Silent,t),this.ssoSilentMeasurement?.end({success:!0,accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length,accountType:Pl(t.account)}),t)).catch(t=>{throw this.eventHandler.emitEvent(Sc.SSO_SILENT_FAILURE,e.InteractionType.Silent,null,t),this.ssoSilentMeasurement?.end({success:!1},t),t}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(t){const n=this.getRequestCorrelationId(t);this.logger.trace("acquireTokenByCode called",n);const r=this.performanceClient.startMeasurement(wn.AcquireTokenByCode,n);Ml(this.initialized,r),this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_BY_CODE_START,e.InteractionType.Silent,t),r.add({scenarioId:t.scenarioId});try{if(t.code&&t.nativeAccountId)throw Ji(Mi);if(t.code){const o=t.code;let i=this.hybridAuthCodeResponses.get(o);return i?(this.logger.verbose("Existing acquireTokenByCode request found",n),r.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",n),i=this.acquireTokenByCodeAsync({...t,correlationId:n}).then(t=>(this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_BY_CODE_SUCCESS,e.InteractionType.Silent,t),this.hybridAuthCodeResponses.delete(o),r.end({success:!0,accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length,accountType:Pl(t.account)}),t)).catch(t=>{throw this.hybridAuthCodeResponses.delete(o),this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_BY_CODE_FAILURE,e.InteractionType.Silent,null,t),r.end({success:!1},t),t}),this.hybridAuthCodeResponses.set(o,i)),await i}if(t.nativeAccountId){if(this.canUsePlatformBroker(t,t.nativeAccountId)){r.add({isPlatformBrokerRequest:!0});const e=await this.acquireTokenNative({...t,correlationId:n},Ea.acquireTokenByCode,t.nativeAccountId).catch(e=>{throw e instanceof Vc&&Jc(e)&&(this.platformAuthProvider=void 0),r.add({brokerErrorName:e.name,brokerErrorCode:e.errorCode}),e});return r.end({accountType:Pl(e.account),success:!0}),e}throw Ji(Oi)}throw Ji(Pi)}catch(t){throw this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_BY_CODE_FAILURE,e.InteractionType.Silent,null,t),r.end({success:!1},t),t}}async acquireTokenByCodeAsync(e){this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(wn.AcquireTokenByCodeAsync,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement);const t=this.createSilentAuthCodeClient(e.correlationId);return await t.acquireToken(e).then(e=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:e.fromCache}),e)).catch(e=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},e),e}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(wn.AcquireTokenFromCache,e.correlationId),t){case Na.Default:case Na.AccessToken:case Na.AccessTokenAndRefreshToken:const t=this.createSilentCacheClient(e.correlationId);return Pr(t.acquireToken.bind(t),wn.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw pt(Xe)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(wn.AcquireTokenByRefreshToken,e.correlationId),t){case Na.Default:case Na.AccessTokenAndRefreshToken:case Na.RefreshToken:case Na.RefreshTokenAndNetwork:const t=this.createSilentRefreshClient(e.correlationId);return Pr(t.acquireToken.bind(t),wn.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw pt(Xe)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(wn.AcquireTokenBySilentIframe,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return Pr(t.acquireToken.bind(t),wn.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);Ms(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,Ca);return this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);Ps(this.initialized),this.browserStorage.setInteractionInProgress(!0,Ca);return this.createPopupClient(t).logout(e).finally(()=>{this.browserStorage.setInteractionInProgress(!1)})}catch(e){return Promise.reject(e)}}async clearCache(e){if(!this.isBrowserEnvironment)return void this.logger.info("in non-browser environment, returning early.");const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){const t=this.getRequestCorrelationId();return Mc(this.logger,this.browserStorage,this.isBrowserEnvironment,t,e)}getAccount(e){const t=this.getRequestCorrelationId();return qc(e,this.logger,this.browserStorage,t)}getAccountByUsername(e){const t=this.getRequestCorrelationId();return Oc(e,this.logger,this.browserStorage,t)}getAccountByHomeId(e){const t=this.getRequestCorrelationId();return Nc(e,this.logger,this.browserStorage,t)}getAccountByLocalId(e){const t=this.getRequestCorrelationId();return Bc(e,this.logger,this.browserStorage,t)}setActiveAccount(e){const t=this.getRequestCorrelationId();xc(e,this.browserStorage,t)}getActiveAccount(){const e=this.getRequestCorrelationId();return Lc(this.browserStorage,e)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const n=io.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return await this.browserStorage.setAccount(n,e.correlationId),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,n,r){if(this.logger.trace("acquireTokenNative called"),!this.platformAuthProvider)throw Ji(xi);return new Zc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.platformAuthProvider,n||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e,r)}canUsePlatformBroker(e,t){if(this.logger.trace("canUsePlatformBroker called"),!this.platformAuthProvider)return this.logger.trace("canUsePlatformBroker: platform broker unavilable, returning false"),!1;if(!pl(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme))return this.logger.trace("canUsePlatformBroker: isBrokerAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case S.NONE:case S.CONSENT:case S.LOGIN:this.logger.trace("canUsePlatformBroker: prompt is compatible with platform broker flow");break;default:return this.logger.trace(`canUsePlatformBroker: prompt = ${e.prompt} is not compatible with platform broker flow, returning false`),!1}return!(!t&&!this.getNativeAccountId(e))||(this.logger.trace("canUsePlatformBroker: nativeAccountId is not available, returning false"),!1)}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new fl(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createRedirectClient(e){return new ml(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentIframeClient(e){return new bl(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ea.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentCacheClient(e){return new Xc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentRefreshClient(e){return new Sl(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentAuthCodeClient(e){return new _l(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Ea.acquireTokenByCode,this.performanceClient,this.platformAuthProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return Es(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){this.config.cache.cacheLocation===fa.LocalStorage?this.eventHandler.subscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}disableAccountStorageEvents(){this.config.cache.cacheLocation===fa.LocalStorage?this.eventHandler.unsubscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?ts():t.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||Ma})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||Ma})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(wn.AcquireTokenSilent,t);n.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),Ml(this.initialized,n),this.logger.verbose("acquireTokenSilent called",t);const r=e.account||this.getActiveAccount();if(!r)throw Ji(fi);return n.add({accountType:Pl(r)}),this.acquireTokenSilentDeduped(e,r,t).then(r=>(n.end({success:!0,fromCache:r.fromCache,accessTokenSize:r.accessToken.length,idTokenSize:r.idToken.length}),{...r,state:e.state,correlationId:t})).catch(e=>{throw e instanceof ye&&e.setCorrelationId(t),n.end({success:!1},e),e})}async acquireTokenSilentDeduped(e,t,n){const r=Zr(this.config.auth.clientId,{...e,authority:e.authority||this.config.auth.authority,correlationId:n},t.homeAccountId),o=JSON.stringify(r),i=this.activeSilentTokenRequests.get(o);if(void 0===i){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",n),this.performanceClient.addFields({deduped:!1},n);const r=Pr(this.acquireTokenSilentAsync.bind(this),wn.AcquireTokenSilentAsync,this.logger,this.performanceClient,n)({...e,correlationId:n},t);return this.activeSilentTokenRequests.set(o,r),r.finally(()=>{this.activeSilentTokenRequests.delete(o)})}return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",n),this.performanceClient.addFields({deduped:!0},n),i}async acquireTokenSilentAsync(t,n){const r=()=>this.trackPageVisibility(t.correlationId);this.performanceClient.addQueueMeasurement(wn.AcquireTokenSilentAsync,t.correlationId),this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_START,e.InteractionType.Silent,t),t.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},t.correlationId),document.addEventListener("visibilitychange",r);const o=await Pr(Fc,wn.InitializeSilentRequest,this.logger,this.performanceClient,t.correlationId)(t,n,this.config,this.performanceClient,this.logger),i=t.cacheLookupPolicy||Na.Default;return this.acquireTokenSilentNoIframe(o,i).catch(async e=>{const t=function(e,t){const n=!(e instanceof Io&&e.subError!==po),r=e.errorCode===Yi||e.errorCode===Xe,o=n&&r||e.errorCode===ao||e.errorCode===co,i=Ba.includes(t);return o&&i}
/*! @azure/msal-browser v4.21.0 2025-08-19 */(e,i);if(t){if(this.activeIframeRequest){if(i!==Na.Skip){const[t,n]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${n}`,o.correlationId);const r=this.performanceClient.startMeasurement(wn.AwaitConcurrentIframe,o.correlationId);r.add({awaitIframeCorrelationId:n});const a=await t;if(r.end({success:a}),a)return this.logger.verbose(`Parallel iframe request with correlationId: ${n} succeeded. Retrying cache and/or RT redemption`,o.correlationId),this.acquireTokenSilentNoIframe(o,i);throw this.logger.info(`Iframe request with correlationId: ${n} failed. Interaction is required.`),e}return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",o.correlationId),Pr(this.acquireTokenBySilentIframe.bind(this),wn.AcquireTokenBySilentIframe,this.logger,this.performanceClient,o.correlationId)(o)}{let e;return this.activeIframeRequest=[new Promise(t=>{e=t}),o.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",o.correlationId),Pr(this.acquireTokenBySilentIframe.bind(this),wn.AcquireTokenBySilentIframe,this.logger,this.performanceClient,o.correlationId)(o).then(t=>(e(!0),t)).catch(t=>{throw e(!1),t}).finally(()=>{this.activeIframeRequest=void 0})}}throw e}).then(n=>(this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Silent,n),t.correlationId&&this.performanceClient.addFields({fromCache:n.fromCache},t.correlationId),n)).catch(t=>{throw this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Silent,null,t),t}).finally(()=>{document.removeEventListener("visibilitychange",r)})}async acquireTokenSilentNoIframe(t,n){return pl(this.config,this.logger,this.platformAuthProvider,t.authenticationScheme)&&t.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.performanceClient.addFields({isPlatformBrokerRequest:!0},t.correlationId),this.acquireTokenNative(t,Ea.acquireTokenSilent_silentFlow,t.account.nativeAccountId,n).catch(async e=>{if(this.performanceClient.addFields({brokerErrorName:e.name,brokerErrorCode:e.errorCode},t.correlationId),e instanceof Vc&&Jc(e))throw this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.platformAuthProvider=void 0,pt(Xe);throw e})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),n===Na.AccessToken&&this.logger.verbose("acquireTokenSilent - cache lookup policy set to AccessToken, attempting to acquire token from local cache"),Pr(this.acquireTokenFromCache.bind(this),wn.AcquireTokenFromCache,this.logger,this.performanceClient,t.correlationId)(t,n).catch(r=>{if(n===Na.AccessToken)throw r;return this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_NETWORK_START,e.InteractionType.Silent,t),Pr(this.acquireTokenByRefreshToken.bind(this),wn.AcquireTokenByRefreshToken,this.logger,this.performanceClient,t.correlationId)(t,n)}))}async preGeneratePkceCodes(e){return this.logger.verbose("Generating new PKCE codes"),this.pkceCode=await Pr(cl,wn.GeneratePkceCodes,this.logger,this.performanceClient,e)(this.performanceClient,this.logger,e),Promise.resolve()}getPreGeneratedPkceCodes(e){this.logger.verbose("Attempting to pick up pre-generated PKCE codes");const t=this.pkceCode?{...this.pkceCode}:void 0;return this.pkceCode=void 0,this.logger.verbose((t?"Found":"Did not find")+" pre-generated PKCE codes"),this.performanceClient.addFields({usePreGeneratedPkce:!!t},e),t}logMultipleInstances(e){const t=this.config.auth.clientId;if(!window)return;window.msal=window.msal||{},window.msal.clientIds=window.msal.clientIds||[];window.msal.clientIds.length>0&&this.logger.verbose("There is already an instance of MSAL.js in the window."),window.msal.clientIds.push(t),function(e,t,n){const r=window.msal?.clientIds||[],o=r.length,i=r.filter(t=>t===e).length;i>1&&n.warning("There is already an instance of MSAL.js in the window with the same client id."),t.add({msalInstanceCount:o,sameClientIdInstanceCount:i})}(t,e,this.logger)}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */
class Ol{constructor(e,t,n,r){this.clientId=e,this.clientCapabilities=t,this.crypto=n,this.logger=r}toNaaTokenRequest(e){let t;t=void 0===e.extraQueryParameters?new Map:new Map(Object.entries(e.extraQueryParameters));const n=e.correlationId||this.crypto.createNewGuid(),r=Cr(e.claims,this.clientCapabilities),o=e.scopes||u;return{platformBrokerId:e.account?.homeAccountId,clientId:this.clientId,authority:e.authority,scope:o.join(" "),correlationId:n,claims:Vt.isEmptyObj(r)?void 0:r,state:e.state,authenticationScheme:e.authenticationScheme||W.BEARER,extraParameters:t}}fromNaaTokenResponse(e,t,n){if(!t.token.id_token||!t.token.access_token)throw pt(Te);const r=Nr(n+(t.token.expires_in||0)),o=en(t.token.id_token,this.crypto.base64Decode),i=this.fromNaaAccountInfo(t.account,t.token.id_token,o),a=t.token.scope||e.scope;return{authority:t.token.authority||i.environment,uniqueId:i.localAccountId,tenantId:i.tenantId,scopes:a.split(" "),account:i,idToken:t.token.id_token,idTokenClaims:o,accessToken:t.token.access_token,fromCache:!1,expiresOn:r,tokenType:e.authenticationScheme||W.BEARER,correlationId:e.correlationId,extExpiresOn:r,state:e.state}}fromNaaAccountInfo(e,t,n){const r=n||e.idTokenClaims,o=e.localAccountId||r?.oid||r?.sub||"",i=e.tenantId||r?.tid||"",a=e.homeAccountId||`${o}.${i}`,s=e.username||r?.preferred_username||"",c=e.name||r?.name,l=e.loginHint||r?.login_hint,u=new Map,d=Xt(a,o,i,r);u.set(i,d);return{homeAccountId:a,environment:e.environment,tenantId:i,username:s,localAccountId:o,name:c,loginHint:l,idToken:t,idTokenClaims:r,tenantProfiles:u}}fromBridgeError(e){if(!function(e){return void 0!==e.status}(e))return new ye("unknown_error","An unknown error occurred");switch(e.status){case tc:return new gt(at);case nc:return new gt(it);case ac:return new gt(je);case ic:return new gt(lt);case sc:return new gt(e.code||lt,e.description);case rc:case oc:return new Xr(e.code,e.description);case ec:return new Io(e.code,e.description);default:return new ye(e.code,e.description)}}toAuthenticationResultFromCache(e,t,n,r,o){if(!t||!n)throw pt(Te);const i=en(t.secret,this.crypto.base64Decode),a=n.target||r.scopes.join(" ");return{authority:n.environment||e.environment,uniqueId:e.localAccountId,tenantId:e.tenantId,scopes:a.split(" "),account:e,idToken:t.secret,idTokenClaims:i||{},accessToken:n.secret,fromCache:!0,expiresOn:Nr(n.expiresOn),extExpiresOn:Nr(n.extendedExpiresOn),tokenType:r.authenticationScheme||W.BEARER,correlationId:o,state:r.state}}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */const Nl={code:"unsupported_method",desc:"This method is not supported in nested app environment."};class Bl extends ye{constructor(e,t){super(e,t),Object.setPrototypeOf(this,Bl.prototype),this.name="NestedAppAuthError"}static createUnsupportedError(){return new Bl(Nl.code,Nl.desc)}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class xl{constructor(e){this.operatingContext=e;const t=this.operatingContext.getBridgeProxy();if(void 0===t)throw new Error("unexpected: bridgeProxy is undefined");this.bridgeProxy=t,this.config=e.getConfig(),this.logger=this.operatingContext.getLogger(),this.performanceClient=this.config.telemetry.client,this.browserCrypto=e.isBrowserEnvironment()?new pc(this.logger,this.performanceClient,!0):ft,this.eventHandler=new Dc(this.logger),this.browserStorage=this.operatingContext.isBrowserEnvironment()?new Ec(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,Jr(this.config.auth)):Pc(this.config.auth.clientId,this.logger,this.performanceClient,this.eventHandler),this.nestedAppAuthAdapter=new Ol(this.config.auth.clientId,this.config.auth.clientCapabilities,this.browserCrypto,this.logger);const n=this.bridgeProxy.getAccountContext();this.currentAccountContext=n||null}static async createController(e){const t=new xl(e);return Promise.resolve(t)}async initialize(e,t){const n=e?.correlationId||ts();return await this.browserStorage.initialize(n),Promise.resolve()}ensureValidRequest(e){return e?.correlationId?e:{...e,correlationId:this.browserCrypto.createNewGuid()}}async acquireTokenInteractive(t){const n=this.ensureValidRequest(t);this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_START,e.InteractionType.Popup,n);const r=this.performanceClient.startMeasurement(wn.AcquireTokenPopup,n.correlationId);r?.add({nestedAppAuthRequest:!0});try{const o=this.nestedAppAuthAdapter.toNaaTokenRequest(n),i=qr(),a=await this.bridgeProxy.getTokenInteractive(o),s={...this.nestedAppAuthAdapter.fromNaaTokenResponse(o,a,i)};try{await this.hydrateCache(s,t)}catch(e){this.logger.warningPii(`Failed to hydrate cache. Error: ${e}`,n.correlationId)}return this.currentAccountContext={homeAccountId:s.account.homeAccountId,environment:s.account.environment,tenantId:s.account.tenantId},this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Popup,s),r.add({accessTokenSize:s.accessToken.length,idTokenSize:s.idToken.length}),r.end({success:!0,requestId:s.requestId}),s}catch(t){const n=t instanceof ye?t:this.nestedAppAuthAdapter.fromBridgeError(t);throw this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Popup,null,t),r.end({success:!1},t),n}}async acquireTokenSilentInternal(t){const n=this.ensureValidRequest(t);this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_START,e.InteractionType.Silent,n);const r=await this.acquireTokenFromCache(n);if(r)return this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Silent,r),r;const o=this.performanceClient.startMeasurement(wn.SsoSilent,n.correlationId);o?.increment({visibilityChangeCount:0}),o?.add({nestedAppAuthRequest:!0});try{const r=this.nestedAppAuthAdapter.toNaaTokenRequest(n),i=qr(),a=await this.bridgeProxy.getTokenSilent(r),s=this.nestedAppAuthAdapter.fromNaaTokenResponse(r,a,i);try{await this.hydrateCache(s,t)}catch(e){this.logger.warningPii(`Failed to hydrate cache. Error: ${e}`,n.correlationId)}return this.currentAccountContext={homeAccountId:s.account.homeAccountId,environment:s.account.environment,tenantId:s.account.tenantId},this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Silent,s),o?.add({accessTokenSize:s.accessToken.length,idTokenSize:s.idToken.length}),o?.end({success:!0,requestId:s.requestId}),s}catch(t){const n=t instanceof ye?t:this.nestedAppAuthAdapter.fromBridgeError(t);throw this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Silent,null,t),o?.end({success:!1},t),n}}async acquireTokenFromCache(t){const n=this.performanceClient.startMeasurement(wn.AcquireTokenSilent,t.correlationId);if(n?.add({nestedAppAuthRequest:!0}),t.claims)return this.logger.verbose("Claims are present in the request, skipping cache lookup"),null;if(t.forceRefresh)return this.logger.verbose("forceRefresh is set to true, skipping cache lookup"),null;let r=null;switch(t.cacheLookupPolicy||(t.cacheLookupPolicy=Na.Default),t.cacheLookupPolicy){case Na.Default:case Na.AccessToken:case Na.AccessTokenAndRefreshToken:r=await this.acquireTokenFromCacheInternal(t);break;default:return null}return r?(this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Silent,r),n?.add({accessTokenSize:r?.accessToken.length,idTokenSize:r?.idToken.length}),n?.end({success:!0}),r):(this.logger.warning("Cached tokens are not found for the account, proceeding with silent token request."),this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Silent,null),n?.end({success:!1}),null)}async acquireTokenFromCacheInternal(e){const t=this.bridgeProxy.getAccountContext()||this.currentAccountContext;let n=null;const r=e.correlationId||this.browserCrypto.createNewGuid();if(t&&(n=qc(t,this.logger,this.browserStorage,r)),!n)return this.logger.verbose("No active account found, falling back to the host"),Promise.resolve(null);this.logger.verbose("active account found, attempting to acquire token silently");const o={...e,correlationId:e.correlationId||this.browserCrypto.createNewGuid(),authority:e.authority||n.environment,scopes:e.scopes?.length?e.scopes:[...u]},i=this.browserStorage.getTokenKeys(),a=this.browserStorage.getAccessToken(n,o,i,n.tenantId);if(!a)return this.logger.verbose("No cached access token found"),Promise.resolve(null);if(Lr(a.cachedAt)||Br(a.expiresOn,this.config.system.tokenRenewalOffsetSeconds))return this.logger.verbose("Cached access token has expired"),Promise.resolve(null);const s=this.browserStorage.getIdToken(n,o.correlationId,i,n.tenantId,this.performanceClient);return s?this.nestedAppAuthAdapter.toAuthenticationResultFromCache(n,s,a,o,o.correlationId):(this.logger.verbose("No cached id token found"),Promise.resolve(null))}async acquireTokenPopup(e){return this.acquireTokenInteractive(e)}acquireTokenRedirect(e){throw Bl.createUnsupportedError()}async acquireTokenSilent(e){return this.acquireTokenSilentInternal(e)}acquireTokenByCode(e){throw Bl.createUnsupportedError()}acquireTokenNative(e,t,n){throw Bl.createUnsupportedError()}acquireTokenByRefreshToken(e,t){throw Bl.createUnsupportedError()}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){throw Bl.createUnsupportedError()}removePerformanceCallback(e){throw Bl.createUnsupportedError()}enableAccountStorageEvents(){throw Bl.createUnsupportedError()}disableAccountStorageEvents(){throw Bl.createUnsupportedError()}getAllAccounts(e){const t=this.browserCrypto.createNewGuid();return Mc(this.logger,this.browserStorage,this.isBrowserEnv(),t,e)}getAccount(e){const t=this.browserCrypto.createNewGuid();return qc(e,this.logger,this.browserStorage,t)}getAccountByUsername(e){const t=this.browserCrypto.createNewGuid();return Oc(e,this.logger,this.browserStorage,t)}getAccountByHomeId(e){const t=this.browserCrypto.createNewGuid();return Nc(e,this.logger,this.browserStorage,t)}getAccountByLocalId(e){const t=this.browserCrypto.createNewGuid();return Bc(e,this.logger,this.browserStorage,t)}setActiveAccount(e){const t=this.browserCrypto.createNewGuid();return xc(e,this.browserStorage,t)}getActiveAccount(){const e=this.browserCrypto.createNewGuid();return Lc(this.browserStorage,e)}handleRedirectPromise(e){return Promise.resolve(null)}loginPopup(e){return this.acquireTokenInteractive(e||Ma)}loginRedirect(e){throw Bl.createUnsupportedError()}logout(e){throw Bl.createUnsupportedError()}logoutRedirect(e){throw Bl.createUnsupportedError()}logoutPopup(e){throw Bl.createUnsupportedError()}ssoSilent(e){return this.acquireTokenSilentInternal(e)}getTokenCache(){throw Bl.createUnsupportedError()}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){}setNavigationClient(e){this.logger.warning("setNavigationClient is not supported in nested app auth")}getConfiguration(){return this.config}isBrowserEnv(){return this.operatingContext.isBrowserEnvironment()}getBrowserCrypto(){return this.browserCrypto}getPerformanceClient(){throw Bl.createUnsupportedError()}getRedirectResponse(){throw Bl.createUnsupportedError()}async clearCache(e){throw Bl.createUnsupportedError()}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const n=io.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return await this.browserStorage.setAccount(n,e.correlationId),this.browserStorage.hydrateCache(e,t)}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */async function Ll(e){const t=new uc(e),n=new lc(e),r=[t.initialize(),n.initialize()];return await Promise.all(r),n.isAvailable()&&e.auth.supportsNestedAppAuth?xl.createController(n):t.isAvailable()?ql.createController(t):null}
/*! @azure/msal-browser v4.21.0 2025-08-19 */let Dl=class e{static async createPublicClientApplication(t){const n=await async function(e,t){const n=new uc(e);return await n.initialize(),ql.createController(n,t)}(t);return new e(t,n)}constructor(e,t){this.isBroker=!1,this.controller=t||new ql(new uc(e))}async initialize(e){return this.controller.initialize(e,this.isBroker)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}};async function Ul(e){const t=new Dl(e);return await t.initialize(),t}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class Hl{constructor(e){this.initialized=!1,this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.logger=e.getLogger(),this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new pc(this.logger,this.performanceClient):ft,this.eventHandler=new Dc(this.logger),this.browserStorage=this.isBrowserEnvironment?new Ec(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,void 0):Pc(this.config.auth.clientId,this.logger,this.performanceClient,this.eventHandler)}getBrowserStorage(){return this.browserStorage}getAccount(e){return null}getAccountByHomeId(e){return null}getAccountByLocalId(e){return null}getAccountByUsername(e){return null}getAllAccounts(){return[]}initialize(){return this.initialized=!0,Promise.resolve()}acquireTokenPopup(e){return _s(this.initialized),Es(),{}}acquireTokenRedirect(e){return _s(this.initialized),Es(),Promise.resolve()}acquireTokenSilent(e){return _s(this.initialized),Es(),{}}acquireTokenByCode(e){return _s(this.initialized),Es(),{}}acquireTokenNative(e,t,n){return _s(this.initialized),Es(),{}}acquireTokenByRefreshToken(e,t){return _s(this.initialized),Es(),{}}addEventCallback(e,t){return null}removeEventCallback(e){}addPerformanceCallback(e){return _s(this.initialized),Es(),""}removePerformanceCallback(e){return _s(this.initialized),Es(),!0}enableAccountStorageEvents(){_s(this.initialized),Es()}disableAccountStorageEvents(){_s(this.initialized),Es()}handleRedirectPromise(e){return _s(this.initialized),Promise.resolve(null)}loginPopup(e){return _s(this.initialized),Es(),{}}loginRedirect(e){return _s(this.initialized),Es(),{}}logout(e){return _s(this.initialized),Es(),{}}logoutRedirect(e){return _s(this.initialized),Es(),{}}logoutPopup(e){return _s(this.initialized),Es(),{}}ssoSilent(e){return _s(this.initialized),Es(),{}}getTokenCache(){return _s(this.initialized),Es(),{}}getLogger(){return this.logger}setLogger(e){_s(this.initialized),Es()}setActiveAccount(e){_s(this.initialized),Es()}getActiveAccount(){return _s(this.initialized),Es(),null}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){_s(this.initialized),Es()}getConfiguration(){return this.config}isBrowserEnv(){return _s(this.initialized),Es(),!0}getBrowserCrypto(){return _s(this.initialized),Es(),{}}getPerformanceClient(){return _s(this.initialized),Es(),{}}getRedirectResponse(){return _s(this.initialized),Es(),{}}async clearCache(e){_s(this.initialized),Es()}async hydrateCache(e,t){_s(this.initialized),Es()}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class Fl extends Zs{getId(){return Fl.ID}getModuleName(){return Fl.MODULE_NAME}async initialize(){return!0}}Fl.MODULE_NAME="",Fl.ID="UnknownOperatingContext";
/*! @azure/msal-browser v4.21.0 2025-08-19 */
class zl{static async createPublicClientApplication(e){const t=await Ll(e);let n;return n=null!==t?new zl(e,t):new zl(e),n}constructor(e,t){if(this.configuration=e,t)this.controller=t;else{const t=new Fl(e);this.controller=new Hl(t)}}async initialize(){if(this.controller instanceof Hl){const e=await Ll(this.configuration);return null!==e&&(this.controller=e),this.controller.initialize()}return Promise.resolve()}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */const Kl={initialize:()=>Promise.reject(ys(hs)),acquireTokenPopup:()=>Promise.reject(ys(hs)),acquireTokenRedirect:()=>Promise.reject(ys(hs)),acquireTokenSilent:()=>Promise.reject(ys(hs)),acquireTokenByCode:()=>Promise.reject(ys(hs)),getAllAccounts:()=>[],getAccount:()=>null,getAccountByHomeId:()=>null,getAccountByUsername:()=>null,getAccountByLocalId:()=>null,handleRedirectPromise:()=>Promise.reject(ys(hs)),loginPopup:()=>Promise.reject(ys(hs)),loginRedirect:()=>Promise.reject(ys(hs)),logout:()=>Promise.reject(ys(hs)),logoutRedirect:()=>Promise.reject(ys(hs)),logoutPopup:()=>Promise.reject(ys(hs)),ssoSilent:()=>Promise.reject(ys(hs)),addEventCallback:()=>null,removeEventCallback:()=>{},addPerformanceCallback:()=>"",removePerformanceCallback:()=>!1,enableAccountStorageEvents:()=>{},disableAccountStorageEvents:()=>{},getTokenCache:()=>{throw ys(hs)},getLogger:()=>{throw ys(hs)},setLogger:()=>{},setActiveAccount:()=>{},getActiveAccount:()=>null,initializeWrapperLibrary:()=>{},setNavigationClient:()=>{},getConfiguration:()=>{throw ys(hs)},hydrateCache:()=>Promise.reject(ys(hs)),clearCache:()=>Promise.reject(ys(hs))};
/*! @azure/msal-browser v4.21.0 2025-08-19 */
/*! @azure/msal-browser v4.21.0 2025-08-19 */
class $l{constructor(e,t){const n=t&&t.loggerOptions||{};this.logger=new vt(n,Hs,Fs),this.cryptoOps=new pc(this.logger),this.popTokenGenerator=new bo(this.cryptoOps),this.shrParameters=e}async generatePublicKeyThumbprint(){const{kid:e}=await this.popTokenGenerator.generateKid(this.shrParameters);return e}async signRequest(e,t,n){return this.popTokenGenerator.signPayload(e,t,this.shrParameters,n)}async removeKeys(e){return this.cryptoOps.removeTokenBindingKey(e).then(()=>!0).catch(e=>{if(e instanceof gt&&e.errorCode===nt)return!1;throw e})}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */function Gl(){let e;try{e=window[fa.SessionStorage];const t=e?.getItem(Qs);if(1===Number(t))return Promise.resolve().then(function(){return Jl})}catch(e){}}function Ql(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.now}function jl(e){if(e&&Ql())return Math.round(window.performance.now()-e)}class Wl extends jo{constructor(e,n,r){super(e.auth.clientId,e.auth.authority||`${t.DEFAULT_AUTHORITY}`,new vt(e.system?.loggerOptions||{},Hs,Fs),Hs,Fs,e.telemetry?.application||{appName:"",appVersion:""},n,r)}generateId(){return ts()}getPageVisibility(){return document.visibilityState?.toString()||null}deleteIncompleteSubMeasurements(e){Gl()?.then(t=>{const n=this.eventsByCorrelationId.get(e.event.correlationId),r=n&&n.eventId===e.event.eventId,o=[];r&&n?.incompleteSubMeasurements&&n.incompleteSubMeasurements.forEach(e=>{o.push({...e})}),t.BrowserPerformanceMeasurement.flushMeasurements(e.event.correlationId,o)})}startMeasurement(e,t){const n=this.getPageVisibility(),r=super.startMeasurement(e,t),o=Ql()?window.performance.now():void 0,i=Gl()?.then(t=>new t.BrowserPerformanceMeasurement(e,r.event.correlationId));return i?.then(e=>e.startMeasurement()),{...r,end:(e,t)=>{const a=r.end({...e,startPageVisibility:n,endPageVisibility:this.getPageVisibility(),durationMs:jl(o)},t);return i?.then(e=>e.endMeasurement()),this.deleteIncompleteSubMeasurements(r),a},discard:()=>{r.discard(),i?.then(e=>e.flushMeasurement()),this.deleteIncompleteSubMeasurements(r)}}}setPreQueueTime(e,t){if(!Ql())return void this.logger.trace(`BrowserPerformanceClient: window performance API not available, unable to set telemetry queue time for ${e}`);if(!t)return void this.logger.trace(`BrowserPerformanceClient: correlationId for ${e} not provided, unable to set telemetry queue time`);const n=this.preQueueTimeByCorrelationId.get(t);n&&(this.logger.trace(`BrowserPerformanceClient: Incomplete pre-queue ${n.name} found`,t),this.addQueueMeasurement(n.name,t,void 0,!0)),this.preQueueTimeByCorrelationId.set(t,{name:e,time:window.performance.now()})}addQueueMeasurement(e,t,n,r){if(!Ql())return void this.logger.trace(`BrowserPerformanceClient: window performance API not available, unable to add queue measurement for ${e}`);if(!t)return void this.logger.trace(`BrowserPerformanceClient: correlationId for ${e} not provided, unable to add queue measurement`);const o=super.getPreQueueTime(e,t);if(!o)return;const i=window.performance.now(),a=n||super.calculateQueuedTime(o,i);return super.addQueueMeasurement(e,t,a,r)}}
/*! @azure/msal-browser v4.21.0 2025-08-19 */class Vl{constructor(e,t){this.correlationId=t,this.measureName=Vl.makeMeasureName(e,t),this.startMark=Vl.makeStartMark(e,t),this.endMark=Vl.makeEndMark(e,t)}static makeMeasureName(e,t){return`msal.measure.${e}.${t}`}static makeStartMark(e,t){return`msal.start.${e}.${t}`}static makeEndMark(e,t){return`msal.end.${e}.${t}`}static supportsBrowserPerformance(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.mark&&"function"==typeof window.performance.measure&&"function"==typeof window.performance.clearMarks&&"function"==typeof window.performance.clearMeasures&&"function"==typeof window.performance.getEntriesByName}static flushMeasurements(e,t){if(Vl.supportsBrowserPerformance())try{t.forEach(t=>{const n=Vl.makeMeasureName(t.name,e);window.performance.getEntriesByName(n,"measure").length>0&&(window.performance.clearMeasures(n),window.performance.clearMarks(Vl.makeStartMark(n,e)),window.performance.clearMarks(Vl.makeEndMark(n,e)))})}catch(e){}}startMeasurement(){if(Vl.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch(e){}}endMeasurement(){if(Vl.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch(e){}}flushMeasurement(){if(Vl.supportsBrowserPerformance())try{const e=window.performance.getEntriesByName(this.measureName,"measure");if(e.length>0){const t=e[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),t}}catch(e){}return null}}var Jl=Object.freeze({__proto__:null,BrowserPerformanceMeasurement:Vl});const Yl={...wn,PairwiseBrokerApplicationInitializeBrokering:"pairwiseBrokerApplicationInitializeBrokering",BrokerClientApplicationHandleBrokerHandshake:"brokerClientApplicationHandleBrokerHandshake",BrokerClientApplicationBrokeredSSOSilentRequest:"brokerClientApplicationBrokeredSSOSilentRequest",BrokerClientApplicationBrokeredSilentRequest:"brokerClientApplicationBrokeredSilentRequest",EmbeddedClientApplicationSendSSOSilentRequest:"embeddedSSOSilent",EmbeddedClientApplicationSendPopupRequest:"embeddedPopup",EmbeddedClientApplicationSendRedirectRequest:"embeddedRedirect",EmbeddedClientApplicationHandleRedirectRequest:"embeddedHandleRedirect",EmbeddedClientApplicationSendSilentRefreshRequest:"embeddedSilentRefresh",EmbeddedSendSilentRefreshRequestInternal:"embeddedSilentRefreshInternal",SendHandshakeRequest:"sendHandshakeRequest",SendMessageToBroker:"sendMessageToBroker",SendRequest:"sendRequest",HandleResponse:"handleBrokerResponse",GetFrameDepth:"getFrameDepth",OnHandshakeResponse:"onHandshakeResponse",HandleBrokerMessage:"handleBrokerMessage",PostMessageToAllDescendantFrames:"postMessageToAllDescendantFrames",HandleBrokerAuthRequest:"handleBrokerAuthRequest",BrokeredSilentRequest:"brokeredSilentRequest",BrokeredSsoSilentRequest:"brokeredSsoSilentRequest",BrokeredRedirectRequest:"brokeredRedirectRequest",BrokeredPopupRequest:"brokeredPopupRequest",InteractiveBrokerRequest:"interactiveBrokerRequest"},Xl=new Map([[Yl.PairwiseBrokerApplicationInitializeBrokering,"PWBInitBrk"],[Yl.BrokerClientApplicationHandleBrokerHandshake,"BrkClientHandeBrkHandshake"],[Yl.BrokerClientApplicationBrokeredSSOSilentRequest,"BrkClientBrkSSOReq"],[Yl.BrokerClientApplicationBrokeredSilentRequest,"BrkClientBrkSltReq"],[Yl.EmbeddedClientApplicationSendSSOSilentRequest,"EmbClientSendSSOReq"],[Yl.EmbeddedClientApplicationSendPopupRequest,"EmbClientSendPopupReq"],[Yl.EmbeddedClientApplicationSendRedirectRequest,"EmbClientSendRedirectReq"],[Yl.EmbeddedClientApplicationHandleRedirectRequest,"EmbClientHandleRedirectReq"],[Yl.EmbeddedClientApplicationSendSilentRefreshRequest,"EmbClientSendSltRefreshReq"],[Yl.SendHandshakeRequest,"sendHandshakeReq"],[Yl.SendMessageToBroker,"sendMsgToBrk"],[Yl.SendRequest,"sendReq"],[Yl.HandleResponse,"handleBrkRes"],[Yl.GetFrameDepth,"getFrameDepth"],[Yl.OnHandshakeResponse,"onHandshakeRes"],[Yl.HandleBrokerMessage,"handleBrkMsg"],[Yl.PostMessageToAllDescendantFrames,"postMsgToDescFrames"],[Yl.HandleBrokerAuthRequest,"handleBrkAuthReq"],[Yl.BrokeredSilentRequest,"brkSltReq"],[Yl.BrokeredSsoSilentRequest,"brkSsoSltReq"],[Yl.BrokeredRedirectRequest,"brkRedirectReq"],[Yl.BrokeredPopupRequest,"brkPopupSltReq"],[Yl.InteractiveBrokerRequest,"intBrkReq"]]),Zl=new Set(["brokerInteractionTimeoutMs","brokerMessageTimeoutMs","brokerHandshakeTimeoutMs","brokerIframeTimeoutMs","maxFrameDepthReached","maxFrameDepthConfigured","framesNotified","handshakeIgnoredCount","brokerFrameDepth","resolverKeyMissingCount","resolverKeyNotExistCount"]),eu="mats-telemetry-profile-id",tu="PerformanceTelemetryReporter:";class nu{constructor(e,t,n,r,o,i,a,s,c,l){this.appInsights=null,this.appInsightsPromise=null,this.synthetic=!1,this.observabilityRatio=.1,this.samplingRatio=.01,this.telemetryQueue=function(){const e=[],t=[];return{enqueue:t=>{e.push(t)},dequeue:()=>{if(0===t.length){let n=e.pop();for(;n;)t.push(n),n=e.pop()}return t.pop()},size:()=>e.length+t.length,clear:()=>{e.length=0,t.length=0}}}(),this.isProcessingQueue=!1,this.initializationRetries=0,this.telemetryDisabled=!1,this.clientId=e,this.logger=t,this.eventsToEmit=new Set(r),this.miscEvents=new Set(o),this.maxQueueSize=l?.maxQueueSize||1e3,this.maxRetries=l?.maxRetries||3,this.onOnInitializationFailure=l?.onInitializationFailure,this.appInsightsConfig={instrumentationKey:"d634483c08244c1ca09af2b2d952c92e-ab2bba03-2ba3-49d8-a82c-ef6da750d8ab-7725",extensions:[],propertyConfiguration:{gpcDataSharingOptIn:!1},disableCookiesUsage:!0},this.synthetic=a||!1,this.appName=s,this.appVersion=c,this.channelId=i,this.sampleEvents=Math.random()<=this.samplingRatio,this.logger.verbose(`Sampling for misc event enabled: ${this.sampleEvents}`);try{const e=new Ac(this.clientId,t,n),r=e.getItem(eu);if(r)this.profileTelemetryId=r;else{const t=Os();this.profileTelemetryId=t,e.setItem(eu,t)}}catch(e){t.warning(`${tu} local storage is not available`),this.profileTelemetryId=""}this.logger.verbose(`${tu} Initialized`)}async initializeAppInsights(){if(null!==this.appInsights)return this.appInsights;if(null!==this.appInsightsPromise)return this.appInsightsPromise;this.initializationRetries>=this.maxRetries&&(this.telemetryDisabled=!0,this.telemetryQueue.clear(),this.logger.warning(`${tu} 1DS initialization failed after ${this.maxRetries} attempts. Telemetry disabled to prevent application issues.`),this.onOnInitializationFailure?.(new Error(`1DS initialization failed after ${this.maxRetries} attempts`))),this.appInsightsPromise=this.initAnalyticsDynamically();try{return this.appInsights=await this.appInsightsPromise,this.appInsights}catch(e){throw this.appInsightsPromise=null,this.initializationRetries++,this.onOnInitializationFailure?.(e instanceof Error?e:new Error(String(e))),e}}async initAnalyticsDynamically(){this.logger.verbose(`${tu} Lazy loading and initializing 1DS`);try{const{ApplicationInsights:e}=await Promise.resolve().then(function(){return FA}),t=new e;return t.initialize(this.appInsightsConfig,[]),this.logger.verbose(`${tu}: 1DS successfully loaded and initialized`),t}catch(e){const t=e instanceof Error?e.message:String(e);throw this.logger.error(`${tu} Failed to load 1DS`,t),e}}sendCustomEvent(e){if(this.telemetryDisabled)return;if(!this.eventsToEmit.has(e.name))return void this.logger.verbose(`${tu} Skipping telemetry for event ${e.name}`,e.correlationId);if(e.success&&!this.sampleEvents&&(this.miscEvents.has(e.name)||!0===e.fromCache))return void this.logger.verbose(`${tu} Skipping telemetry for event ${e.name}`,e.correlationId);if(this.telemetryQueue.size()>=this.maxQueueSize)return void this.logger.warning(`${tu} Queue size limit (${this.maxQueueSize}) reached. Dropping telemetry event ${e.name}.`);const t={...e,synthetic:this.synthetic,appName:this.appName,appVersion:this.appVersion,profileTelemetryId:this.profileTelemetryId,sessionId:this.channelId};var n;!e.success||(n=this.observabilityRatio,Math.random()<=n)?this.logger.verbose(`${tu} Sending ${t.name} with additional observability for tracking`):(delete t.context,delete t.errorStack,this.logger.verbose(`${tu} Sending ${t.name} for tracking`)),this.telemetryQueue.enqueue({name:e.name,data:t}),this.processQueueAsync().catch(t=>{const n=t instanceof Error?t.message:String(t);this.logger.warning(`${tu} Failed to send telemetry for event ${e.name}: ${n}`)})}async processQueueAsync(){if(!this.isProcessingQueue){this.isProcessingQueue=!0;try{const e=await this.initializeAppInsights();for(;this.telemetryQueue.size()>0;){const t=this.telemetryQueue.dequeue();t&&this.sendSingleEvent(e,t)}}finally{this.isProcessingQueue=!1}}}sendSingleEvent(e,t){e.track(t),t.name===Yl.AcquireTokenPreRedirect&&e.flush()}}const ru=[Yl.InitializeClientApplication,Yl.LocalStorageUpdated],ou=new Set([Yl.AcquireTokenSilent,Yl.AcquireTokenByCode,Yl.AcquireTokenPopup,Yl.AcquireTokenRedirect,Yl.AcquireTokenPreRedirect,Yl.PairwiseBrokerApplicationInitializeBrokering,Yl.SsoSilent,Yl.EmbeddedClientApplicationSendSSOSilentRequest,Yl.EmbeddedClientApplicationSendPopupRequest,Yl.EmbeddedClientApplicationSendRedirectRequest,Yl.EmbeddedClientApplicationHandleRedirectRequest,Yl.EmbeddedClientApplicationSendSilentRefreshRequest,...ru]);class iu{constructor(e,t,n,r,o){this.logger=t;const i=o?.eventsToEmit?.filter(e=>ou?.has(e))||[...ou];this.perfTelemetryReporter=new nu(e,t,n,i,ru,r,o?.synthetic,o?.appName,o?.appVersion,o?.queueConfig)}sendCustomEvent(e){this.perfTelemetryReporter.sendCustomEvent(e)}async initializeAppInsights(){await this.perfTelemetryReporter.initializeAppInsights()}getTelemetryCallback(){this.logger.trace("TelemetryReporter: Attaching callback to send custom metrics.");return this.logger.verbose("TelemetryReporter: Returning callback as telemetry emitted."),e=>{e.forEach(e=>{e.name===Yl.AcquireTokenByBroker&&(e.name=e.brokerEventName||e.name,e.isBroker=!0,delete e.brokerEventName,this.logger.verbosePii(`TelemetryReporter: Updated broker event ${JSON.stringify(e)}`,e.correlationId)),this.sendCustomEvent(e)})}}}const au=[It.AzurePublic,It.AzurePpe];class su extends Dl{constructor(e,t){let n;const r="undefined"!=typeof window,o=!t?.disabled&&function(e){return!e.auth.authority||au.some(t=>0===e.auth.authority?.indexOf(t.toString()))}(e)&&r;if(o?(n=e.telemetry?.client||new Wl(e,new Set(Zl),new Map(Xl)),super({...e,telemetry:{...e.telemetry,client:n}})):(super(e),n=new En),this.performanceClient=n,this.channelId=r?Os():"",o){const r=new iu(e.auth.clientId,this.getLogger(),n,this.channelId,t);this.addPerformanceCallback(r.getTelemetryCallback())}}static async createPublicClientApplication(e,t,n){const r=new su(e,t);return await r.initialize({correlationId:n}),r}}const cu="BrokerReady",lu="BrokerHandshakeRequest",uu="BrokerHandshakeResponse",du="BrokerAuthRequest",hu="BrokerRedirectResponse",gu="BrokerHandleRedirectRequest",pu="BrokerAuthResult",fu="EmbeddedLogoutRequest",mu="EmbeddedLogoutResponse",vu="BrokerAuthError",yu="InteractionRequiredAuthError",Cu="ServerError",Iu="ClientAuthError",ku="ClientConfigurationError",wu="BrowserAuthError",Tu="BrowserConfigurationError",Au="AuthError";class bu{constructor(e,t,n){this.messageType=e,this.channelId=t,this.messageId=n}static validateMessage(e){if(!e.data||!e.data.messageType)return null;switch(e.data.messageType){case lu:case uu:case gu:case du:case pu:case hu:case fu:case cu:return e;default:return null}}}class Su extends bu{constructor(e,t,n=!1,r,o,i){super(lu,r,o),this.embeddedClientId=e,this.version=t,this.allowTelemetry=n,this.nonce=i}static validate(e){return e.data&&e.data.messageType===lu&&e.data.embeddedClientId&&e.data.version?new Su(e.data.embeddedClientId,e.data.version,e.data.allowTelemetry,e.data.channelId||e.data.sessionId,e.data.messageId,e.data.nonce):null}}class Ru extends bu{constructor(e,t,n,r,o){super(uu,n,r),this.version=e,this.brokerOrigin=t,this.nonce=o}static validate(e,t){if(!t.includes(e.origin))return null;const n=bu.validateMessage(e);return n&&n.data.messageType===uu&&n.data.version?new Ru(n.data.version,n.origin,n.data.channelId||e.data.sessionId,n.data.messageId,n.data.nonce):null}}class Eu extends bu{get embeddedAppOrigin(){return this._embeddedAppOrigin}constructor(e,t,n,r,o,i){super(du,o,i),this.embeddedClientId=e,this._embeddedAppOrigin=r,this.interactionType=t,this.request=n}static validate(e,t){return e.data&&e.data.messageType===du&&e.data.embeddedClientId&&e.data.interactionType&&e.data.request?new Eu(e.data.embeddedClientId,e.data.interactionType,e.data.request,t,e.data.channelId||e.data.sessionId,e.data.messageId):null}}class _u extends bu{constructor(e,t){super(hu,e,t)}static validate(e){return e.data&&e.data.messageType===hu?new _u(e.data.channelId||e.data.sessionId,e.data.messageId):null}}const Pu="broker_response_invalid",Mu="broker_popup_will_redirect",qu="broker_timeout",Ou="broker_handshake_timeout",Nu="broker_handshake_failed",Bu="no_trusted_brokers_provided",xu="brokering_disabled",Lu="broker_connection_reset",Du="shr_generation_error";var Uu=Object.freeze({__proto__:null,BrokerConnectionReset:Lu,BrokerHandshakeFailed:Nu,BrokerHandshakeTimeout:Ou,BrokerPopupWillRedirect:Mu,BrokerResponseInvalid:Pu,BrokerTimeout:qu,BrokeringDisabled:xu,NoTrustedBrokersProvided:Bu,ShrGenerationError:Du});const Hu={[Pu]:"The broker response did not have the expected values.",[Mu]:"The request for a brokered popup requires a redirect by the broker. If your app does not perform the redirect, please check the broker's logs.",[qu]:"Message broker timed out.",[Ou]:"Broker handshake response timed out.",[Nu]:"Broker handshake failed. Please see logs for details.",[Bu]:"No trusted brokers provided.",[xu]:"Brokering is not enabled for the client application. Please check logs to see if handshake was performed.",[Lu]:"The broker connection was reset. Please retry the request.",[Du]:"Error generating SHRs. Kid is missing in the request."};class Fu extends ye{constructor(e,t){super(e,t),Object.setPrototypeOf(this,Fu.prototype),this.name=vu}}function zu(e){return new Fu(e,Hu[e])}class Ku extends bu{constructor(e,t,n,r,o){if(super(pu,n,r),this.interactionType=e,this.result=t,o){const{setCorrelationId:e,...t}=o;this.errorPayload=t}}static validate(e){return e.data&&e.data.messageType===pu&&e.data.interactionType&&(e.data.result||e.data.errorPayload)?new Ku(e.data.interactionType,e.data.result,e.data.channelId||e.data.sessionId,e.data.messageId,e.data.errorPayload):null}static detectError(e){let t;switch(e.name){case yu:t=new Io(e.errorCode,e.errorMessage,e.subError);break;case Cu:t=new Xr(e.errorCode,e.errorMessage,e.subError);break;case Iu:t=new gt(e.errorCode,e.errorMessage);break;case ku:t=new jt(e.errorCode);break;case wu:t=new Vi(e.errorCode);break;case Tu:t=new vs(e.errorCode,e.errorMessage);break;case vu:t=new Fu(e.errorCode,e.errorMessage);break;case Au:t=new ye(e.errorCode,e.errorMessage,e.subError);break;default:t=new ye(ge,JSON.stringify(e))}return t.setCorrelationId(e.correlationId),t}}class $u extends bu{constructor(t,n,r,o){super(gu,r,o),this.interactionType=e.InteractionType.Redirect,this.embeddedClientId=t,this.version=n}static validate(e){return e.data&&e.data.messageType===gu&&e.data.embeddedClientId&&e.data.version?new $u(e.data.embeddedClientId,e.data.version,e.data.channelId||e.data.sessionId,e.data.messageId):null}}function Gu(e){const t={preferredInteractionType:null,brokerRedirectParams:{},actAsBroker:!1,allowBrokering:!1,trustedBrokerDomains:[],brokerHandshakeTimeout:2e3,brokerMessageTimeout:15e3,brokerInteractionTimeout:3e5};return{preferredInteractionType:e?.preferredInteractionType||t.preferredInteractionType,brokerRedirectParams:e?.brokerRedirectParams||t.brokerRedirectParams,actAsBroker:e?.actAsBroker||t.actAsBroker,allowBrokering:e?.allowBrokering||t.allowBrokering,trustedBrokerDomains:e?.trustedBrokerDomains||t.trustedBrokerDomains,brokerHandshakeTimeout:e?.brokerHandshakeTimeout||t.brokerHandshakeTimeout,brokerMessageTimeout:e?.brokerMessageTimeout||t.brokerMessageTimeout,brokerInteractionTimeout:e?.brokerInteractionTimeout||t.brokerInteractionTimeout}}class Qu extends bu{constructor(e,t,n,r){super(fu,n,r),this.version=e,this.correlationId=t}static validate(e){const t=bu.validateMessage(e);return t&&t.data&&t.data.version?new Qu(t.data.version,t.data.correlationId,t.data.channelId||e.data.sessionId,t.data.messageId):null}}function ju(e,t,n){try{switch(e.cache?.temporaryCacheLocation){case fa.LocalStorage:return new Ac(e.auth.clientId,t,n);case fa.MemoryStorage:return new hc;default:return new bc}}catch(e){return new hc}}function Wu(e){return`msal.request.${e}`}const Vu="4.21.0";function Ju(e){const t=e.split("-",1)[0].split(".",3);return{major:parseInt(t[0]),minor:parseInt(t[1]),patch:parseInt(t[2])}}function Yu(e){e.port1.close(),e.port2.close()}function Xu(e,t,n,r=20){if(0===e.length||n>r)return[0,n-1];let o=n,i=e.length;for(let a=0;a<e.length;a++){e[a].postMessage(t,"*");const[s,c]=Xu(e[a],t,n+1,r);i+=s,c>o&&(o=c)}return[i,o]}const{invoke:Zu,invokeAsync:ed}=Ns;function td(e){return`${e.clientId}-${e.origin}`}class nd extends su{constructor(e,t,n){super(e),this.currentBrokerRedirectResponse=void 0,this.hybridAuthPromise=void 0,this.pwbBrokerAppConfiguration=Gu(t),this.redirectResponseMap=new Map,this.embeddedAppConfigMap=new Map,this.telemetryAllowedEmbeddedClients=new Set,this.logger=new vt(e.system?.loggerOptions||{},"@azure/msal-browser-1p",Vu),this.tempCache=ju(e,this.logger,this.performanceClient),this.eventHandler=n,this.messageListener=this.handleBrokerMessage.bind(this),this.isListening=!1,this.parentBrokerOrigins=new Set,this.isBroker=!0}getRedirectCorrelationId(){const e=`msal.${this.getConfiguration().auth.clientId}`,t=this.tempCache.getItem(`${e}.request.native`);try{if(t){const e=JSON.parse(t);return e&&"object"==typeof e?e.correlationId:null}}catch(e){this.logger.error("BrokerClientApplication.getRedirectCorrelationId: Unable to parse native request")}return this.tempCache.getItem(`${e}.request.correlationId`)||""}async handleRedirectPromise(e){const t=this.getRedirectCorrelationId(),n=this.performanceClient.startMeasurement(Yl.AcquireTokenByBroker,t);n.add({brokerEventName:Yl.AcquireTokenRedirect});try{const t=super.handleRedirectPromise(e);this.currentBrokerRedirectResponse=t;const r=await this.currentBrokerRedirectResponse;if(this.currentBrokerRedirectResponse=void 0,r){const e=function(e){if(!e)return null;try{const t=window.atob(e),n=new Uint8Array(t.length);for(let e=0;e<n.length;e++)n[e]=t.charCodeAt(e);const r=(new TextDecoder).decode(n),o=JSON.parse(r);return o.hasOwnProperty("brokerState")?o:null}catch(e){return null}}(r.state);if(this.setActiveAccount(r.account),!e)return n.end({success:!0}),r;{const t={...r,state:e.userState};this.redirectResponseMap.set(td({clientId:e.brokerState.requestClientId,origin:e.brokerState.requestOrigin}),t),n.add({embeddedClientId:e.brokerState.requestClientId,embeddedRedirectUri:e.brokerState.requestOrigin}),this.endBrokerPerformanceEvent(e.brokerState.requestClientId,n)}}else n.discard();return null}catch(e){throw e instanceof ye&&e.setCorrelationId(t),n.end({success:!1},e),e}}async listenForBrokerMessage(e,t){return this.logger.verbose("listening for child broker messages."),window.addEventListener("message",this.messageListener),this.broadcastBrokerReadyMessage(window.frames,e,t),this.isListening=!0,e&&e.codeRequest&&(this.hybridAuthPromise=this.acquireTokenByCode(e.codeRequest)),this.hybridAuthPromise}broadcastBrokerReadyMessage(e,t,n){const r={messageType:cu,channelId:this.channelId,messageId:Os()};this.logger.trace(`Broadcasting broker ready message ${r.messageId} to child frames.`),window.postMessage(r,"*");const[o,i]=Zu(Xu,Yl.PostMessageToAllDescendantFrames,this.logger,this.performanceClient,n?.event.correlationId)(e,r,1,t?.maxChildFrameDepth);n?.add({maxFrameDepthReached:i,framesNotified:o,maxFrameDepthConfigured:t?.maxChildFrameDepth,messageId:r.messageId}),this.logger.trace(`Broadcasted broker ready message to ${o} child frames with a max depth of ${i}`)}stopListeningForBrokerMessage(){this.logger.verbose("stop listening for child broker messages."),window.removeEventListener("message",this.messageListener),this.isListening=!1,this.embeddedAppConfigMap.forEach(([e,t])=>{this.logger.verbose(`closing message port for ${e}`),t.close()}),this.embeddedAppConfigMap.clear()}async handleBrokerMessage(e){const t=bu.validateMessage(e);if(t&&t.data.messageType)switch(this.logger.verbose(`Broker received message with type: ${t.data.messageType}`),t.data.messageType){case cu:return this.logger.warning("Multiple running brokers are detected in the frame tree. This is an unsupported configuration for your application."),void this.parentBrokerOrigins.add(t.origin);case lu:return this.handleBrokerHandshake(t);case gu:const e=$u.validate(t);if(!e)return;return this.handleBrokerRedirectResponse(e,t);case du:const n=Eu.validate(t,this.embeddedAppConfigMap.get(t.data.channelId||t.data.sessionId||t.data.embeddedClientId)?.[0]||t.origin);if(!n)return;n.request.correlationId||(n.request.correlationId=Os());const r=this.performanceClient.startMeasurement(Yl.AcquireTokenByBroker,n.request.correlationId);r.add({embeddedSessionId:n.channelId}),this.parentBrokerOrigins.size>0&&r.add({parentBrokerCount:this.parentBrokerOrigins.size});const o=t.ports?.[0];try{const e=await ed(this.handleBrokerAuthRequest.bind(this),Yl.HandleBrokerAuthRequest,this.logger,this.performanceClient,n.request.correlationId)(n,o);if(e?.errorPayload){const{errorCode:t,errorMessage:o,subError:i}={...e.errorPayload};return void this.endBrokerPerformanceEvent(n.embeddedClientId,r,new ye(t,o,i))}return void this.endBrokerPerformanceEvent(n.embeddedClientId,r)}catch(e){throw this.endBrokerPerformanceEvent(n.embeddedClientId,r,e),e}default:return}}isDescendantFrame(e){const t=[];for(t.push(e.sourceFrame);t.length>0;){const n=t.pop();if(n)for(let r=0;r<n.frames.length;r++){const o=n.frames[r];if(o===e.targetFrame)return!0;o!==n&&t.push(o)}}return!1}async handleBrokerHandshake(e){if(!e.source||!e.source.window||e.source.window!==e.source)return void this.logger.warning("Broker handshake request validation failed. Message origin is not an iframe");const t=e.source;window===t||this.isDescendantFrame({sourceFrame:window,targetFrame:t})||this.logger.warning("Broker handshake request validation failed. Message origin is not a descendant iframe");const n=Su.validate(e);if(!n)return void this.logger.warning("Broker handshake request validation failed. Message may not have come from MSAL.js.");const r=Os(),o=this.performanceClient.startMeasurement(Yl.BrokerClientApplicationHandleBrokerHandshake,r);try{if(o.add({embeddedClientId:n.embeddedClientId,embeddedSessionId:n.channelId,messageId:n.messageId}),n.allowTelemetry&&this.telemetryAllowedEmbeddedClients.add(n.embeddedClientId),this.logger.verbose(`${n.messageType} validated for AppId: ${n.embeddedClientId}`),this.hybridAuthPromise)try{await this.hybridAuthPromise}catch(e){this.logger.error(`Broker could not obtain tokens using authorization code initializer: ${e}`)}const t=new Ru(Vu,"",this.channelId,n.messageId,e.data.nonce);this.logger.verbose(`Sending handshake response to ${e.origin}`);const r=e.ports?.[0];r&&(r.onmessage=this.messageListener,this.embeddedAppConfigMap.set(n.channelId||n.embeddedClientId,[e.origin,r]));const i=Ju(e.data.version);r&&3===i.major&&i.minor>=15&&i.minor<=19?r?.postMessage(t):e.source?.postMessage(t,e.origin)}catch(e){throw this.endBrokerPerformanceEvent(n.embeddedClientId,o,e),e}}async handleBrokerRedirectResponse(t,n){if(t){const r=this.embeddedAppConfigMap.get(t.channelId||t.embeddedClientId);let o,i;r?[i,o]=r:(i=n.origin,o=n.ports?.[0]),this.currentBrokerRedirectResponse&&await this.currentBrokerRedirectResponse;const a=this.redirectResponseMap.get(td({clientId:t.embeddedClientId,origin:i})),s=new Ku(e.InteractionType.Redirect,a||null,this.channelId,t.messageId);this.logger.verbose("Sending auth response"),o?.postMessage(s),a?.correlationId&&this.performanceClient.addFields({messageId:t.messageId},a.correlationId);const c=`msal.${this.getConfiguration().auth.clientId}`;return void this.tempCache.removeItem(`${c}.request.native`)}}async handleBrokerAuthRequest(t,n){this.currentBrokerRedirectResponse&&await this.currentBrokerRedirectResponse,t.request.correlationId||(t.request.correlationId=Os());const r=t.request.correlationId,o=t.request.account||this.getActiveAccount();let i;switch(this.performanceClient.addFields({messageId:t.messageId},r),t.interactionType){case e.InteractionType.Silent:if(o){this.performanceClient.addFields({brokerEventName:Yl.AcquireTokenSilent},r),i=Zu(this.brokeredSilentRequest.bind(this),Yl.BrokeredSilentRequest,this.logger,this.performanceClient,r)(t,o,n);break}this.performanceClient.addFields({brokerEventName:Yl.SsoSilent},r),i=Zu(this.brokeredSsoSilentRequest.bind(this),Yl.BrokeredSsoSilentRequest,this.logger,this.performanceClient,r)(t,n);break;case e.InteractionType.Redirect:case e.InteractionType.Popup:default:const a=this.getInteractionType(t.interactionType);this.performanceClient.addFields({brokerEventName:a===e.InteractionType.Redirect?Yl.AcquireTokenRedirect:Yl.AcquireTokenPopup},r),i=Zu(this.interactiveBrokerRequest.bind(this),Yl.InteractiveBrokerRequest,this.logger,this.performanceClient,r)(a,t,n)}return i}getInteractionType(e){const t=this.pwbBrokerAppConfiguration.preferredInteractionType;return t||e}async interactiveBrokerRequest(t,n,r){switch(t){case e.InteractionType.Redirect:return Zu(this.brokeredRedirectRequest.bind(this),Yl.BrokeredRedirectRequest,this.logger,this.performanceClient,n.request.correlationId)(n,r);case e.InteractionType.Popup:return Zu(this.brokeredPopupRequest.bind(this),Yl.BrokeredPopupRequest,this.logger,this.performanceClient,n.request.correlationId)(n,r);case e.InteractionType.Silent:return void this.logger.error("Invalid code path. interactiveBrokerRequest() should only be called for interactive requests.");case e.InteractionType.None:return void this.logger.error("Broker is blocking interactive requests. Please attempt a silent request or sign into the broker first.");default:return void this.logger.error("Invalid code path. interactiveBrokerRequest() should only be called for interactive requests.")}}async brokeredRedirectRequest(t,n){this.logger.verbose("Brokered redirect request initiated.");const r=this.getAllAccounts();this.eventHandler.emitEvent(0===r.length?Sc.LOGIN_START:Sc.ACQUIRE_TOKEN_START,e.InteractionType.Redirect,t.request);const o=this.embeddedAppConfigMap.get(t.channelId||t.embeddedClientId)?.[1]||n;try{const e=new _u(this.channelId,t.messageId);o?.postMessage(e),this.logger.verbose(`Sending redirect response: ${JSON.stringify(e)}`);const n=this.addBrokerRequestProperties(t);return n.state=function(e,t){const n={userState:t,brokerState:{requestOrigin:e.embeddedAppOrigin,requestClientId:e.embeddedClientId}},r=JSON.stringify(n),o=(new TextEncoder).encode(r);return window.btoa(Array.from(o,e=>String.fromCodePoint(e)).join(""))}(t,n.state),await super.acquireTokenRedirect(n)}catch(n){const i=new Ku(e.InteractionType.Redirect,null,this.channelId,t.messageId,n);return this.logger.verbose(`Found auth error in redirect: ${n}`),o?.postMessage(i),this.eventHandler.emitEvent(0===r.length?Sc.LOGIN_FAILURE:Sc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Redirect,null,n),i}}async brokeredPopupRequest(t,n){this.logger.verbose("Brokered popup request initiated.");const r=this.getAllAccounts();this.eventHandler.emitEvent(0===r.length?Sc.LOGIN_START:Sc.ACQUIRE_TOKEN_START,e.InteractionType.Popup,t.request);const o=this.embeddedAppConfigMap.get(t.channelId||t.embeddedClientId)?.[1]||n;try{const n=this.addBrokerRequestProperties(t),i=await super.acquireTokenPopup(n),a=new Ku(e.InteractionType.Popup,i,this.channelId,t.messageId);this.logger.verbosePii("Sending auth response"),o?.postMessage(a);const s=r.length<this.getAllAccounts().length;return this.eventHandler.emitEvent(s?Sc.LOGIN_SUCCESS:Sc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Popup,i),a}catch(n){const i=new Ku(e.InteractionType.Popup,null,this.channelId,t.messageId,n);return this.logger.verbose(`Found auth error in popup: ${n}`),o?.postMessage(i),this.eventHandler.emitEvent(0===r.length?Sc.LOGIN_FAILURE:Sc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Popup,null,n),i}}async brokeredSsoSilentRequest(t,n){this.logger.verbose("Brokered SSO Silent request initiated."),this.eventHandler.emitEvent(Sc.SSO_SILENT_START,e.InteractionType.Silent,t.request);const r=this.embeddedAppConfigMap.get(t.channelId||t.embeddedClientId)?.[1]||n;try{const n=this.addBrokerRequestProperties(t),o=await super.ssoSilent(n),i=new Ku(e.InteractionType.Silent,o,this.channelId,t.messageId);return this.logger.verbosePii("Sending auth response"),r?.postMessage(i),this.eventHandler.emitEvent(Sc.SSO_SILENT_SUCCESS,e.InteractionType.Silent,o),i}catch(n){const o=new Ku(e.InteractionType.Silent,null,this.channelId,t.messageId,n);return this.logger.verbose(`Found auth error in ssoSilent: ${n}`),r?.postMessage(o),this.eventHandler.emitEvent(Sc.SSO_SILENT_FAILURE,e.InteractionType.Silent,null,n),o}}async brokeredSilentRequest(t,n,r){this.logger.verbose("Brokered Silent request initiated."),this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_START,e.InteractionType.Silent,t.request);const o=this.embeddedAppConfigMap.get(t.channelId||t.embeddedClientId)?.[1]||r;try{const r=this.addBrokerRequestProperties(t,n);r.cacheLookupPolicy=Na.RefreshTokenAndNetwork;const i=await super.acquireTokenSilent(r),a=new Ku(e.InteractionType.Silent,i,this.channelId,t.messageId);return o?.postMessage(a),this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Silent,i),a}catch(n){const r=new Ku(e.InteractionType.Silent,null,this.channelId,t.messageId,n);return this.logger.verbose(`Found auth error in silent: ${n}`),o?.postMessage(r),this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Silent,null,n),r}}getEmbeddedAppRedirectUri(e){const t=new cn(e);return`brk-${this.getConfiguration().auth.clientId}://${t.getUrlComponents().HostNameAndPort}`}addBrokerRequestProperties(e,t){const n={...e.request};n.redirectUri=this.getEmbeddedAppRedirectUri(e.embeddedAppOrigin),n.embeddedClientId=e.embeddedClientId,n.storeInCache={idToken:!1,accessToken:!1};const r=t||this.getActiveAccount();return r&&(n.account=r),e.request.correlationId&&this.performanceClient.addFields({embeddedClientId:e.embeddedClientId,embeddedRedirectUri:e.embeddedAppOrigin},e.request.correlationId),n}async sendLogoutRequestToEmbeddedApps(e){this.logger.verbose("sendLogoutRequestToEmbeddedApps called"),await this.messageEmbeddedAppsToLogout(new Qu(Vu,e?.correlationId||Os(),this.channelId,Os()))}async messageEmbeddedAppsToLogout(e){const t=[];this.embeddedAppConfigMap.forEach(n=>{t.push(new Promise((t,r)=>{const o=window.setTimeout(()=>{t()},200);try{n[1]?.postMessage(e),n[1].addEventListener("message",e=>{e.data.messageType===mu&&(this.logger.info(`Received logout response from embedded app: ${e.data.embeddedClientId}`),t(),clearTimeout(o))})}catch(e){this.logger.error(`Could not logout application ${n[0]}. Error in message channel: ${e}`),r(e)}}))}),await Promise.all(t)}endBrokerPerformanceEvent(e,t,n){this.telemetryAllowedEmbeddedClients.has(e)||(this.logger.verbosePii(`TelemetryReporter: Skipping brokered event as not allowed by the client ${e}`,t.event.correlationId),t.discard()),n?t.end({success:!1},n):t.end({success:!0})}}class rd extends bu{constructor(e,t,n,r,o){super(mu,r,o),this.version=e,this.correlationId=n,this.embeddedClientId=t}}const{invoke:od,invokeAsync:id}=Ns;class ad{constructor(e,t,n,r,o,i,a,s,c,l){this.pwbBrokeredAppConfiguration=n,this.clientId=e,this.logger=r,this.brokerMetadata=null,this.performanceClient=o,this.eventHandler=i,this.hydrateCache=s,this.clearCache=c,this.messageChannelList=[],this.messageChannel=new MessageChannel,this.resolvers=new Map,this.temporaryBrokerStorage=a,this.onWindowMessageCb=this.onWindowMessage.bind(this),this.handshake={correlationId:t,inFlight:!1,wait:Promise.resolve(),resolve:()=>{},reject:()=>{}},this.channelId=l}async isBrokerConnected(){return this.handshake.inFlight&&await this.handshake.wait.catch(e=>{const t=e;this.logger.error(t.message)}),!!this.brokerMetadata}setHandshakeReference(e){this.handshake.performanceEvent=e;const t=()=>{this.handshake.performanceEvent?.add({brokerHandshakeTimeoutMs:this.pwbBrokeredAppConfiguration.brokerHandshakeTimeout}),this.handshake.reject(zu(Ou))};if(this.handshake.inFlight)return clearTimeout(this.handshake.timeoutId),void(this.handshake.timeoutId=setTimeout(t,this.pwbBrokeredAppConfiguration.brokerHandshakeTimeout));this.handshake.inFlight=!0,this.handshake.wait=new Promise((e,n)=>{this.handshake.timeoutId=setTimeout(t,this.pwbBrokeredAppConfiguration.brokerHandshakeTimeout),this.handshake.resolve=e,this.handshake.reject=n}).then(()=>{this.resolvers.forEach(e=>{clearTimeout(e.timeoutId),e.reject(zu(Lu))}),this.resolvers.clear(),this.eventHandler.emitEvent(Sc.BROKER_CONNECTION_ESTABLISHED,void 0,{pairwiseBrokerOrigin:this.brokerMetadata?.origin||""}),this.handshake.performanceEvent?.end({success:!0})}).catch(e=>{const t=e;throw this.logger.error(t.message),this.handshake.performanceEvent?.end({success:!1},t),e}).finally(()=>{this.handshake.inFlight=!1})}getAncestors(){const e=[];let t=window;for(;t&&t.parent&&t.parent.window!==t;)t=t.parent?.window,e.push(t);return this.logger.verbose(`Attempting to send handshake request to ${e.length} ancestors`),e}async initiateHandshake(e){if(0===this.pwbBrokeredAppConfiguration.trustedBrokerDomains.length)throw zu(Bu);const t=Os();e?.add({messageId:t});try{this.setHandshakeReference(e),window.addEventListener("message",this.onWindowMessageCb);const n=[];n.push(window),n.push(...this.getAncestors());for(let r=0;r<n.length;r++){const o=n[r],i=n.length-r-1;this.logger.verbose(`Sending handshake request to frame with depth = ${i}`),od(this.sendHandshakeRequest.bind(this),Yl.SendHandshakeRequest,this.logger,this.performanceClient,e?.event.correlationId)(o,i,t,void 0,e)}await this.isBrokerConnected()}catch(e){const t=e;this.logger.error(t.message)}}async onWindowMessage(e){try{if(e.data&&e.origin&&this.pwbBrokeredAppConfiguration.trustedBrokerDomains.includes(e.origin)){if(e.data.messageType===cu){this.logger.verbose("Broker is available."),this.handshake.performanceEvent?.discard();const t=this.performanceClient.startMeasurement(Yl.PairwiseBrokerApplicationInitializeBrokering,this.handshake.correlationId),n=e.data.messageId;t.add({isBackground:!0,messageId:n}),e.origin===this.brokerMetadata?.origin&&(this.brokerMetadata=null,Yu(this.messageChannel)),this.setHandshakeReference(t);const r=od(this.getFrameDepth.bind(this),Yl.GetFrameDepth,this.logger,this.performanceClient,this.handshake.correlationId)(e.source);return od(this.sendHandshakeRequest.bind(this),Yl.SendHandshakeRequest,this.logger,this.performanceClient,this.handshake.correlationId)(e.source,r,n,e.origin,t)}e.data.messageType===uu&&this.onHandshakeResponse(e)}}catch(e){const t=e;this.logger.error(t.message)}}getFrameDepth(e){const t=[];t.push(window),t.push(...this.getAncestors());for(let n=0;n<t.length;n++){if(t[n]===e)return t.length-n-1}return 0}closeBrokerConnection(){this.logger.verbose("Closing broker connection."),this.brokerMetadata=null,Yu(this.messageChannel),this.messageChannelList.forEach(e=>Yu(e.channel)),window.removeEventListener("message",this.onWindowMessageCb)}async sendSsoSilentRequest(t){const n=this.performanceClient.startMeasurement(Yl.EmbeddedClientApplicationSendSSOSilentRequest,t.correlationId);Ps(!0),n.increment({visibilityChangeCount:0});const r=()=>{this.trackPageVisibility(t.correlationId)};document.addEventListener("visibilitychange",r);try{const r=await id(this.sendRequest.bind(this),Yl.SendRequest,this.logger,this.performanceClient,t.correlationId)(t,e.InteractionType.Silent),o=await id(this.handleResponse.bind(this),Yl.HandleResponse,this.logger,this.performanceClient,t.correlationId)(r,t);if(!o)throw this.logger.errorPii(`Broker response is empty in brokered ssoSilent request: ${JSON.stringify(o)}`),zu(Pu);return n.end({success:!0,fromCache:o.fromCache,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,isNativeBroker:o.fromNativeBroker,requestId:o.requestId},t.correlationId),o}catch(e){throw n.end({success:!1},e),e}finally{document.removeEventListener("visibilitychange",r)}}async sendPopupRequest(t){const n=this.performanceClient.startMeasurement(Yl.EmbeddedClientApplicationSendPopupRequest,t.correlationId);Ps(!0);try{const r=await id(this.sendRequest.bind(this),Yl.SendRequest,this.logger,this.performanceClient,t.correlationId)(t,e.InteractionType.Popup),o=await id(this.handleResponse.bind(this),Yl.HandleResponse,this.logger,this.performanceClient,t.correlationId)(r,t);if(!o){if(!_u.validate(r))throw this.logger.errorPii(`Broker response is empty in brokered popup request: ${JSON.stringify(o)}`),zu(Pu);throw this.logger.verbose("popupRequest requires a redirect by the broker, this app will now redirect."),zu(Mu)}return n.end({success:!0,fromCache:o.fromCache,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,isNativeBroker:o.fromNativeBroker,requestId:o.requestId}),o}catch(e){throw n.end({success:!1},e),e}}async sendHandleRedirectRequest(e){const t=this.performanceClient.startMeasurement(Yl.EmbeddedClientApplicationHandleRedirectRequest,e.correlationId);try{const n=new $u(this.clientId,Vu,this.channelId,Os()),r=await id(this.messageBroker.bind(this),Yl.SendMessageToBroker,this.logger,this.performanceClient,e.correlationId)(n,e.correlationId).catch(t=>{if(t instanceof Fu&&t.errorCode===Lu)return this.performanceClient.addFields({brokerConnReset:!0},e.correlationId),id(this.messageBroker.bind(this),Yl.SendMessageToBroker,this.logger,this.performanceClient,e.correlationId)(n,e.correlationId);throw t});t.add({brokerSessionId:r?.data?.channelId||r?.data?.sessionId});const o=await id(this.handleResponse.bind(this),Yl.HandleResponse,this.logger,this.performanceClient,e.correlationId)(r,e);return t.end({success:!0,fromCache:o?.fromCache,accessTokenSize:o?.accessToken.length,idTokenSize:o?.idToken.length,isNativeBroker:o?.fromNativeBroker}),o}catch(e){throw t.end({success:!1},e),e}}async sendSilentRefreshRequest(t){Ps(!0),this.performanceClient.incrementFields({visibilityChangeCount:0},t.correlationId);const n=()=>this.trackPageVisibility(t.correlationId);document.addEventListener("visibilitychange",n);try{const n=await id(this.sendRequest.bind(this),Yl.SendRequest,this.logger,this.performanceClient,t.correlationId)(t,e.InteractionType.Silent),r=await id(this.handleResponse.bind(this),Yl.HandleResponse,this.logger,this.performanceClient,t.correlationId)(n,t);if(!r)throw this.logger.errorPii(`Broker response is empty in brokered silent refresh request: ${JSON.stringify(r)}`),zu(Pu);return this.performanceClient.addFields({fromCache:r.fromCache,accessTokenSize:r.accessToken.length,idTokenSize:r.idToken.length,isNativeBroker:r.fromNativeBroker,requestId:r.requestId},t.correlationId),r}finally{document.removeEventListener("visibilitychange",n)}}async sendRequest(e,t){if(e.authenticationScheme===W.POP){const t=new $l(e);e.popKid=await t.generatePublicKeyThumbprint();const n=Wu(this.clientId);this.temporaryBrokerStorage.containsKey(n)&&this.temporaryBrokerStorage.setItem(n,JSON.stringify(e))}const n=new Eu(this.clientId,t,e,"",this.channelId,Os());return id(this.messageBroker.bind(this),Yl.SendMessageToBroker,this.logger,this.performanceClient,e.correlationId)(n,e.correlationId).catch(t=>{if(t instanceof Fu&&t.errorCode===Lu)return id(this.messageBroker.bind(this),Yl.SendMessageToBroker,this.logger,this.performanceClient,e.correlationId)(n,e.correlationId);throw t})}getMessageChannelProperties(e){return e?this.messageChannelList.find(t=>t.nonce===e):this.getMessageChannelPropertiesByDepth(0)}getMessageChannelPropertiesByDepth(e){return this.messageChannelList.find(t=>t.depth===e)}onHandshakeResponse(e){const t=this.handshake.performanceEvent;try{const n=Ru.validate(e,this.pwbBrokeredAppConfiguration.trustedBrokerDomains);if(n){const e=this.getMessageChannelProperties(n.nonce);if(!e)return this.logger.trace("No MessageChannel found, ignoring this response"),void t?.increment({handshakeIgnoredCount:1});if(n.nonce&&n.nonce!==e.nonce)return this.logger.trace("Received handshake response but there is a newer handshake request in flight, ignoring this one"),void t?.increment({handshakeIgnoredCount:1});this.handshake.timeoutId&&clearTimeout(this.handshake.timeoutId),this.logger.verbose("Received handshake response");const r=Ju(n.version);r.major<=3&&r.minor<15&&Yu(e.channel),Yu(this.messageChannel),this.messageChannel=e.channel,this.brokerMetadata={origin:n.brokerOrigin,version:n.version,semver:r,frameDepth:e.depth,supportsMessageId:!!n.messageId},t?.add({brokerFrameDepth:e.depth,brokerSessionId:n.channelId}),this.handshake.resolve()}}catch(e){this.handshake.reject(e)}}sendHandshakeRequest(e=window.top,t,n,r,o){if(this.logger.trace("Pairwise Broker - sendHandshakeRequest called."),!e)throw this.logger.error("Target frame is undefined."),zu(Nu);let i=new MessageChannel;const a=Os();i.port1.onmessage=async t=>{t.data&&(t.data.messageType===uu?(this.logger.warning("Received handshake response but the broker app is using a version of MSAL.js that does not report its origin, attempting direct communication with each trusted broker domain to resolve. This is a known issue with versions 3.15.0-3.19.1, consider asking the broker app to upgrade."),this.pwbBrokeredAppConfiguration.trustedBrokerDomains.forEach(t=>{const n=new MessageChannel;n.port1.onmessage=e=>(Yu(i),i=n,od(this.onHandshakeResponse.bind(this),Yl.OnHandshakeResponse,this.logger,this.performanceClient,o?.event.correlationId)({...e,data:{...e.data},origin:t})),this.logger.verbose(`Sending handshake request to ${t}`),e?.postMessage(s,t,[n.port2])})):await id(this.handleBrokerMessage.bind(this),Yl.HandleBrokerMessage,this.logger,this.performanceClient,o?.event.correlationId)(t))};const s=new Su(this.clientId,Vu,!0,this.channelId,n,a),c=this.getMessageChannelPropertiesByDepth(t);c?(Yu(c.channel),c.channel=i,c.nonce=a):this.messageChannelList.push({channel:i,nonce:a,depth:t}),this.logger.verbose("Sending handshake request"),o?.increment({handshakeSentCount:1}),e?.postMessage(s,r||"*",[i.port2])}async handleBrokerMessage(t){const n=t.data.messageType;if(this.logger.verbose(`Received message from broker of type: ${n}`),!n||n===hu)return;const r=t.data?.result?.correlationId||t.data?.errorPayload?.correlationId;if(n===fu)return this.logger.verbose("Received logout message from broker."),await this.handleLogoutMessageFromBroker(t),void this.messageChannel.port1.postMessage(new rd(Vu,this.clientId,r,this.channelId,t.data.messageId));const o=this.brokerMetadata?.supportsMessageId?t.data.messageId:n===pu&&t.data.interactionType===e.InteractionType.Redirect?e.InteractionType.Redirect:r;if(!o)return this.logger.verbose(`No embedded embedded request id or correlation id found in message: ${n}.`),void this.performanceClient.incrementFields({resolverKeyMissingCount:1},r);this.logger.verbose(`Received response of type ${n} and key ${o} from broker.`);const i=this.resolvers.get(o);i?(clearTimeout(i.timeoutId),i.resolve(t),this.resolvers.delete(o)):(this.logger.warning(`Cannot resolve message for ${o}. Ignoring.`),this.performanceClient.incrementFields({resolverKeyNotExistCount:1},r))}async messageBroker(t,n){return new Promise((r,o)=>{if(!this.brokerMetadata)return void o(zu(xu));let i=this.pwbBrokeredAppConfiguration.brokerMessageTimeout;const a={};t.interactionType===e.InteractionType.Popup?(a.brokerInteractionTimeoutMs=this.pwbBrokeredAppConfiguration.brokerInteractionTimeout,i=this.pwbBrokeredAppConfiguration.brokerInteractionTimeout):a.brokerMessageTimeoutMs=this.pwbBrokeredAppConfiguration.brokerMessageTimeout,this.performanceClient.addFields(a,n);const s=setTimeout(()=>{o(zu(qu))},i),c=this.brokerMetadata.supportsMessageId?t.messageId:t.messageType===gu?e.InteractionType.Redirect:n;if(this.resolvers.set(c,{resolve:r,reject:o,timeoutId:s}),this.brokerMetadata.semver.major>3||3===this.brokerMetadata.semver.major&&this.brokerMetadata.semver.minor>=15)this.messageChannel.port1.postMessage(t);else{const e=new MessageChannel;e.port1.onmessage=this.handleBrokerMessage.bind(this),window.top?.postMessage(t,this.brokerMetadata.origin,[e.port2])}})}async handleResponse(e,t){const n=Ku.validate(e);if(!n)return null;if(t.correlationId&&this.performanceClient.addFields({brokerSessionId:n.channelId},t.correlationId),n.errorPayload)throw Ku.detectError(n.errorPayload);if(!n.result)throw zu(Pu);let r;if(await this.hydrateCache(n.result,t),t.authenticationScheme===W.POP){if(!t.popKid)throw zu(Du);const e=new $l(t);r=await e.signRequest(n.result.accessToken,t.popKid)}return{...n.result,accessToken:r||n.result.accessToken,pairwiseBrokerOrigin:this.brokerMetadata?.origin}}async handleLogoutMessageFromBroker(e){Qu.validate(e)&&(this.logger.verbose("Logout request received from broker and validated. Logging out embedded app."),await this.clearCache())}trackPageVisibility(e){this.logger.info("Embedded client: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e)}}const{invokeAsync:sd}=Ns;var cd="object",ld="undefined",ud="prototype",dd=Object,hd=dd[ud];
/*! https://github.com/nevware21/ts-utils v0.12.5 */
function gd(e,t){return e||t}function pd(e,t){return e[t]}var fd,md=void 0,vd=null,yd="function",Cd="object",Id="prototype",kd="__proto__",wd="undefined",Td="constructor",Ad="Symbol",bd="length",Sd="name",Rd="call",Ed="toString",_d="getOwnPropertyDescriptor",Pd=gd(Object),Md=pd(Pd,Id),qd=gd(String),Od=pd(qd,Id),Nd=gd(Math),Bd=gd(Array),xd=pd(Bd,Id),Ld=pd(xd,"slice"),Dd="_polyfill",Ud="__nw21$polytype__";function Hd(e,t){try{return{v:e.apply(this,t)}}catch(e){return{e:e}}}function Fd(e){return function(t){return typeof t===e}}function zd(e){var t="[object "+e+"]";return function(e){return!(!e||function(e){return Md[Ed].call(e)}(e)!==t)}}function Kd(e){return typeof e===wd||e===wd}function $d(e){return e===vd||Kd(e)}function Gd(e){return e===vd||e===md}function Qd(e){return!!e||e!==md}var jd=Fd("string"),Wd=Fd(yd);function Vd(e){return!(!e&&$d(e))&&(!!e&&typeof e===Cd)}var Jd=pd(Bd,"isArray"),Yd=zd("Date"),Xd=Fd("number"),Zd=Fd("boolean"),eh=zd("Error");function th(e){return!!(e&&e.then&&Wd(e.then))}function nh(e){return!(!e||(t=function(){return!(e&&0+e)},n=!e,o=Hd(t,r),o.e?n:o.v));var t,n,r,o}function rh(){}function oh(){return[]}function ih(){return!1}var ah=gd(qd);function sh(e,t){var n="",r=Md[Ed][Rd](e);"[object Error]"===r&&(e={stack:ah(e.stack),message:ah(e.message),name:ah(e.name)});try{n=((n=JSON.stringify(e,vd,t?"number"==typeof t?t:4:md))?n.replace(/"(\w+)"\s*:\s{0,1}/g,"$1: "):vd)||ah(e)}catch(e){n=" - "+sh(e,t)}return r+": "+n}function ch(e){throw new Error(e)}function lh(e){throw new TypeError(e)}function uh(e){Gd(e)&&lh("Cannot convert undefined or null to object")}function dh(e){jd(e)||lh("'"+sh(e)+"' is not a string")}function hh(e,t){return!!e&&Md.hasOwnProperty[Rd](e,t)}var gh=gd(pd(Pd,_d),rh),ph=gd(pd(Pd,"hasOwn"),fh);function fh(e,t){return uh(e),hh(e,t)||!!gh(e,t)}function mh(e,t,n){if(e&&(Vd(e)||Wd(e)))for(var r in e)if(ph(e,r)&&-1===t[Rd](n||e,r,e[r]))break}function vh(e,t,n){if(e)for(var r=e[bd]>>>0,o=0;o<r&&(!(o in e)||-1!==t[Rd](n||e,e[o],o,e));o++);}var yh=Ch;function Ch(e,t,n){var r=t?t[e]:vd;return function(t){var o=(t?t[e]:vd)||r;if(o||n){var i=arguments;return(o||n).apply(t,o?Ld[Rd](i,1):i)}lh('"'+ah(e)+'" not defined for '+sh(t))}}function Ih(e){return function(t){return t[e]}}function kh(e,t){var n,r=Pd.getOwnPropertyDescriptor;return!Gd(e)&&r&&(n=Hd(r,[e,t]).v||vd),n||(n=Hd(function(){for(var n in e)if(n===t)return{enumerable:!0}}).v),n&&n.enumerable||!1}var wh=Ch("propertyIsEnumerable",vd,kh),Th=gd(pd(Pd,_d),rh),Ah=gd(pd(Pd,"getOwnPropertySymbols"),oh),bh={e:"enumerable",c:"configurable",v:"value",w:"writable",g:"get",s:"set"};function Sh(e){var t={};if(t[bh.c]=!0,t[bh.e]=!0,e.l){t.get=function(){return e.l.v};var n=Th(e.l,"v");n&&n.set&&(t.set=function(t){e.l.v=t})}return mh(e,function(e,n){t[bh[e]]=n===md?t[bh[e]]:n}),t}var Rh=pd(Pd,"defineProperty"),Eh=pd(Pd,"defineProperties");function _h(e,t,n){return Rh(e,t,Sh(n))}function Ph(e,t){var n={};return mh(t,function(e,t){n[e]=Sh(t)}),vh(Ah(t),function(e){wh(t,e)&&(n[e]=Sh(t[e]))}),Eh(e,n)}function Mh(e,t,n,r,o){var i={};return mh(e,function(e,r){qh(i,e,t?r:e),qh(i,r,n?r:e)}),r?r(i):i}function qh(e,t,n,r){Rh(e,t,{value:n,enumerable:!0,writable:!1})}var Oh=gd(pd(Pd,"isFrozen"),ih),Nh=pd(Pd,"freeze");function Bh(e){return e}function xh(e){return uh(e),e[kd]||vd}var Lh=pd(Pd,"assign"),Dh=pd(Pd,"keys");function Uh(e,t){if((Jd(e)||Vd(e)||Wd(e))&&!Oh(e)){for(var n=0;n<t.length;n++)if(t[n]===e)return e;t.push(e),mh(e,function(e,n){Uh(n,t)}),Fh(e)}return e}function Hh(e){return Nh?Uh(e,[]):e}var Fh=gd(Nh,Bh),zh=gd(pd(Pd,"getPrototypeOf"),xh);function Kh(e){return Mh(e,0,0,Fh)}var $h,Gh=Kh({asyncIterator:0,hasInstance:1,isConcatSpreadable:2,iterator:3,match:4,matchAll:5,replace:6,search:7,species:8,split:9,toPrimitive:10,toStringTag:11,unscopables:12}),Qh="__tsUtils$gblCfg";function jh(){var e;return typeof globalThis!==wd&&(e=globalThis),e||typeof self===wd||(e=self),e||typeof window===wd||(e=window),e||typeof global===wd||(e=global),e}function Wh(){if(!$h){var e=Hd(jh).v||{};$h=e[Qh]=e[Qh]||{}}return $h}var Vh=pd(Nd,"max"),Jh=yh("slice",Od),Yh=yh("substring",Od),Xh=Ch("substr",Od,Zh);function Zh(e,t,n){return uh(e),n<0?"":((t=t||0)<0&&(t=Vh(t+e[bd],0)),Kd(n)?Jh(e,t):Jh(e,t,t+n))}function eg(e,t){return Yh(e,0,t)}var tg,ng=gd(pd(Pd,"create"),rg);function rg(e,t){var n=null;function r(){}if(Gd(e))n={};else{var o=typeof e;o!==Cd&&o!==yd&&lh("Prototype must be an Object or function: "+sh(e)),r[Id]=e,Hd(function(){r[kd]=e}),n=new r}return t&&Hd(Eh,[n,t]),n}function og(){return(Date.now||ig)()}function ig(){return(new Date).getTime()}function ag(e,t,n){return e.apply(t,n)}function sg(){tg=Wh()}function cg(e,t){var n={};return!tg&&sg(),n.b=tg.lzy,Rh(n,"v",{configurable:!0,get:function(){var r=ag(e,null,t);return tg.lzy||Rh(n,"v",{value:r}),n.b=tg.lzy,r}}),n}var lg,ug,dg=pd(Nd,"random"),hg=cg(function(){for(var e=og().toString(36).slice(2);e.length<16;)e+=dg().toString(36).slice(2);return e=e.substring(0,16)}),gg="_urid",pg=0;function fg(e){var t="_"+pg+++"_"+hg.v,n=Ad+"("+e+")";function r(e,t){_h(a,e,{v:t,e:!1,w:!1})}var o,i,a=ng(null);return r("description",ah(e)),r(Ed,function(){return n+"$nw21sym"+t}),r("valueOf",function(){return a}),r("v",n),r("_uid",t),i="symbol",(o=a)&&(Hd(function(){o[Dd]=!0,o[Ud]=i}),Hd(_h,[o,Dd,{v:!0,w:!1,e:!1}]),Hd(_h,[o,Ud,{v:i,w:!1,e:!1}])),o}function mg(e){var t=function(){if(!lg){var e=Wh();lg=e.gblSym=e.gblSym||{k:{},s:{}}}return lg}();if(!ph(t.k,e)){var n=fg(e),r=Dh(t.s).length;n[gg]=function(){return r+"_"+n[Ed]()},t.k[e]=n,t.s[n[gg]()]=ah(e)}return t.k[e]}function vg(e){return Rh({toJSON:function(){return e}},"v",{value:e})}var yg,Cg="window";function Ig(e,t){var n;return function(){return!tg&&sg(),n&&!tg.lzy||(n=vg(Hd(e,t).v)),n.v}}function kg(e){return!tg&&sg(),yg&&!1!==e&&!tg.lzy||(yg=vg(Hd(jh).v||vd)),yg.v}function wg(e,t){var n;if((n=yg&&!1!==t?yg.v:kg(t))&&n[e])return n[e];if(e===Cg)try{return window}catch(e){}return vd}function Tg(){return!!Ag()}var Ag=Ig(wg,["document"]);var bg=Ig(wg,[Cg]);var Sg,Rg,Eg,_g=Ig(wg,["navigator"]),Pg=Ig(function(){return!!Hd(function(){return process&&(process.versions||{}).node}).v});function Mg(){return Sg=vg(Hd(wg,[Ad]).v)}function qg(e){var t=(tg.lzy?0:Sg)||Mg();return t.v?t.v[e]:md}function Og(){return!tg&&sg(),((tg.lzy?0:Sg)||Mg()).v}function Ng(e,t){var n=Gh[e];!tg&&sg();var r=(tg.lzy?0:Sg)||Mg();return r.v?r.v[n||e]:t?md:function(e){var t;!ug&&(ug={});var n=Gh[e];return n&&(t=ug[n]=ug[n]||fg(Ad+"."+n)),t}(e)}function Bg(e,t){!tg&&sg();var n=(tg.lzy?0:Sg)||Mg();return n.v?n.v(e):t?vd:fg(e)}function xg(e){return!tg&&sg(),((Rg=(tg.lzy?0:Rg)||vg(Hd(qg,["for"]).v)).v||mg)(e)}function Lg(e){return!!e&&Wd(e.next)}function Dg(e,t,n){if(e&&(Lg(e)||(!Eg&&(Eg=vg(Ng(3))),e=e[Eg.v]?e[Eg.v]():vd),Lg(e))){var r=md,o=md;try{for(var i=0;!(o=e.next()).done&&-1!==t[Rd](n||e,o.value,i,e);)i++}catch(t){r={e:t},e.throw&&(o=vd,e.throw(r))}finally{try{o&&!o.done&&e.return&&e.return(o)}finally{if(r)throw r.e}}}}function Ug(e,t){var n;return!Kd(t)&&e&&(Jd(t)?ag(e.push,e,t):Lg(t)||!Gd(n=t)&&Wd(n[Ng(3)])?Dg(t,function(t){e.push(t)}):e.push(t)),e}var Hg,Fg=yh("indexOf",xd);function zg(e,t,n){return((e?e.slice:vd)||Ld).apply(e,Ld[Rd](arguments,1))}var Kg=gd(pd(Pd,"setPrototypeOf"),$g);function $g(e,t){var n;return!Hg&&(Hg=vg(((n={})[kd]=[],n instanceof Array))),Hg.v?e[kd]=t:mh(t,function(t,n){return e[t]=n}),e}function Gg(e,t){t&&(e[Sd]=t)}function Qg(e,t,n){var r=n||Error,o=r[Id][Sd],i=Error.captureStackTrace;return function(e,t,n){function r(){this[Td]=t,Hd(_h,[this,Sd,{v:e,c:!0,e:!1}])}return Hd(_h,[t,Sd,{v:e,c:!0,e:!1}]),(t=Kg(t,n))[Id]=n===vd?ng(n):(r[Id]=n[Id],new r),t}(e,function(){var n=this,a=arguments;try{Hd(Gg,[r,e]);var s=ag(r,n,Ld[Rd](a))||n;if(s!==n){var c=zh(n);c!==zh(s)&&Kg(s,c)}return i&&i(s,n[Td]),t&&t(s,a),s}finally{Hd(Gg,[r,o])}},r)}function jg(e){return function(t){return uh(t),t&&t.replace&&(t=t.replace(e,"")),t}}var Wg,Vg,Jg,Yg=Ch("trim",Od,jg(/^\s+|(?=\s)\s+$/g));function Xg(e){if(!e||typeof e!==Cd)return!1;Jg||(Jg=!bg()||bg());var t=!1;if(e!==Jg){Vg||(Wg=Function[Id][Ed],Vg=Wg[Rd](Pd));try{var n=zh(e);(t=!n)||(hh(n,Td)&&(n=n[Td]),t=!(!n||typeof n!==yd||Wg[Rd](n)!==Vg))}catch(e){}}return t}function Zg(e){return e.value&&rp(e),!0}var ep=[function(e){var t=e.value;if(Jd(t)){var n=e.result=[];return n.length=t.length,e.copyTo(n,t),!0}return!1},rp,function(e){if(e.type===yd)return!0;return!1},function(e){var t=e.value;if(Yd(t))return e.result=new Date(t.getTime()),!0;return!1}];function tp(e,t,n,r){var o=n.handler,i=n.path?r?n.path.concat(r):n.path:[],a={handler:n.handler,src:n.src,path:i},s=typeof t,c=!1,l=t===vd;l||(t&&s===Cd?c=Xg(t):l=function(e){return!fd&&(fd=["string","number","boolean",wd,"symbol","bigint"]),!(e===Cd||-1===fd.indexOf(e))}(s));var u={type:s,isPrim:l,isPlain:c,value:t,result:t,path:i,origin:n.src,copy:function(t,r){return tp(e,t,r?a:n,r)},copyTo:function(t,n){return np(e,t,n,a)}};return u.isPrim?o&&o[Rd](n,u)?u.result:t:function(e,t,n,r){var o;return vh(e,function(e){if(e.k===t)return o=e,-1}),o||(o={k:t,v:t},e.push(o),r(o)),o.v}(e,t,0,function(e){_h(u,"result",{g:function(){return e.v},s:function(t){e.v=t}});for(var t=0,r=o;!(r||(t<ep.length?ep[t++]:Zg))[Rd](n,u);)r=vd})}function np(e,t,n,r){if(!$d(n))for(var o in n)t[o]=tp(e,n[o],r,o);return t}function rp(e){var t=e.value;if(t&&e.isPlain){var n=e.result={};return e.copyTo(n,t),!0}return!1}function op(e,t){return vh(t,function(t){!function(e,t,n){np([],e,t,{handler:n,src:t,path:[]})}(e,t)}),e}function ip(e,t,n,r,o,i,a){return op(tp([],s=e,{handler:c,src:s})||{},Ld[Rd](arguments));var s,c}var ap=Ih(bd);var sp=gd(pd(Pd,_d),rh),cp=Ch("endsWith",Od,lp);function lp(e,t,n){dh(e);var r=jd(t)?t:ah(t),o=!Kd(n)&&n<e[bd]?n:e[bd];return Yh(e,o-r[bd],o)===r}var up=yh("indexOf",Od),dp=Ch("startsWith",Od,hp);function hp(e,t,n){dh(e);var r=jd(t)?t:ah(t),o=n>0?n:0;return Yh(e,o,o+r[bd])===r}var gp="ref",pp="unref",fp="hasRef";function mp(e,t,n){var r=Jd(t),o=r?t.length:0,i=function(e){var t=Wd(e)?e:void 0;if(!t){var n=Wh().tmOut||[];Jd(n)&&n.length>0&&Wd(n[0])&&(t=n[0])}return t||setTimeout}(o>0?t[0]:r?md:t),a=function(e){var t=Wd(e)?e:void 0;if(!t){var n=Wh().tmOut||[];Jd(n)&&n.length>1&&Wd(n[1])&&(t=n[1])}return t||clearTimeout}(o>1?t[1]:md),s=n[0];n[0]=function(){c.dn(),ag(s,md,Ld[Rd](arguments))};var c=function(e,t,n){var r,o=!0,i=e?t(vd):vd;function a(){return o=!1,i&&i[pp]&&i[pp](),r}function s(){i&&n(i),i=vd}function c(){return i=t(i),o||a(),r}return(r={cancel:s,refresh:c})[fp]=function(){return i&&i[fp]?i[fp]():o},r[gp]=function(){return o=!0,i&&i[gp]&&i[gp](),r},r[pp]=a,{h:r=Rh(r,"enabled",{get:function(){return!!i},set:function(e){!e&&i&&s(),e&&!i&&c()}}),dn:function(){i=vd}}}(e,function(e){if(e){if(e.refresh)return e.refresh(),e;ag(a,md,[e])}return ag(i,md,n)},function(e){ag(a,md,[e])});return c.h}function vp(e,t){return mp(!0,md,Ld[Rd](arguments))}(kg()||{}).Symbol,(kg()||{}).Reflect;var yp,Cp=function(e,t){return Cp=dd.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},Cp(e,t)};function Ip(e,t){function n(){this.constructor=e}"function"!=typeof t&&null!==t&&lh("Class extends value "+String(t)+" is not a constructor or null"),Cp(e,t),e[ud]=null===t?ng(t):(n[ud]=t[ud],new n)}function kp(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e}var wp="constructor",Tp="prototype",Ap="function",bp="_dynInstFuncs",Sp="_isDynProxy",Rp="_dynClass",Ep="_dynInstChk",_p=Ep,Pp="_dfOpts",Mp="_unknown_",qp="__proto__",Op="_dyn"+qp,Np="__dynProto$Gbl",Bp="_dynInstProto",xp="useBaseInst",Lp="setInstFuncs",Dp=Object,Up=Dp.getPrototypeOf,Hp=Dp.getOwnPropertyNames,Fp=kg(),zp=Fp[Np]||(Fp[Np]={o:(yp={},yp[Lp]=!0,yp[xp]=!0,yp),n:1e3});function Kp(e){return e&&(e===Dp[Tp]||e===Array[Tp])}function $p(e){return Kp(e)||e===Function[Tp]}function Gp(e){var t;if(e){if(Up)return Up(e);var n=e[qp]||e[Tp]||(e[wp]?e[wp][Tp]:null);t=e[Op]||n,hh(e,Op)||(delete e[Bp],t=e[Op]=e[Bp]||e[Op],e[Bp]=n)}return t}function Qp(e,t){var n=[];if(Hp)n=Hp(e);else for(var r in e)"string"==typeof r&&hh(e,r)&&n.push(r);if(n&&n.length>0)for(var o=0;o<n.length;o++)t(n[o])}function jp(e,t,n){return t!==wp&&typeof e[t]===Ap&&(n||hh(e,t))&&t!==qp&&t!==Tp}function Wp(e){lh("DynamicProto: "+e)}function Vp(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function Jp(e,t,n,r,o){function i(e,t){var n=function(){var r=function(e,t,n,r){var o=null;if(e&&hh(n,Rp)){var i=e[bp]||ng(null);if((o=(i[n[Rp]]||ng(null))[t])||Wp("Missing ["+t+"] "+Ap),!o[Ep]&&!1!==i[_p]){for(var a=!hh(e,t),s=Gp(e),c=[];a&&s&&!$p(s)&&!Vp(c,s);){var l=s[t];if(l){a=l===r;break}c.push(s),s=Gp(s)}try{a&&(e[t]=o),o[Ep]=1}catch(e){i[_p]=!1}}}return o}(this,t,e,n)||function(e,t,n){var r=t[e];return r===n&&(r=Gp(t)[e]),typeof r!==Ap&&Wp("["+e+"] is not a "+Ap),r}(t,e,n);return r.apply(this,arguments)};return n[Sp]=1,n}if(!Kp(e)){var a=n[bp]=n[bp]||ng(null);if(!Kp(a)){var s=a[t]=a[t]||ng(null);!1!==a[_p]&&(a[_p]=!!o),Kp(s)||Qp(n,function(t){jp(n,t,!1)&&n[t]!==r[t]&&(s[t]=n[t],delete n[t],(!hh(e,t)||e[t]&&!e[t][Sp])&&(e[t]=i(e,t)))})}}}function Yp(e,t){return hh(e,Tp)?e.name||t||Mp:((e||{})[wp]||{}).name||t||Mp}function Xp(e,t,n,r){hh(e,Tp)||Wp("theClass is an invalid class definition.");var o=e[Tp];(function(e,t){if(Up){for(var n=[],r=Gp(t);r&&!$p(r)&&!Vp(n,r);){if(r===e)return!0;n.push(r),r=Gp(r)}return!1}return!0})(o,t)||Wp("["+Yp(e)+"] not in hierarchy of ["+Yp(t)+"]");var i=null;hh(o,Rp)?i=o[Rp]:(i="_dynCls$"+Yp(e,"_")+"$"+zp.n,zp.n++,o[Rp]=i);var a=Xp[Pp],s=!!a[xp];s&&r&&void 0!==r[xp]&&(s=!!r[xp]);var c=function(e){var t=ng(null);return Qp(e,function(n){!t[n]&&jp(e,n,!1)&&(t[n]=e[n])}),t}(t),l=function(e,t,n,r){function o(e,t,n){var o=t[n];if(o[Sp]&&r){var i=e[bp]||{};!1!==i[_p]&&(o=(i[t[Rp]]||{})[n]||o)}return function(){return o.apply(e,arguments)}}var i=ng(null);Qp(n,function(e){i[e]=o(t,n,e)});for(var a=Gp(e),s=[];a&&!$p(a)&&!Vp(s,a);)Qp(a,function(e){!i[e]&&jp(a,e,!Up)&&(i[e]=o(t,a,e))}),s.push(a),a=Gp(a);return i}(o,t,c,s);n(t,l);var u=!!Up&&!!a[Lp];u&&r&&(u=!!r[Lp]),Jp(o,i,t,c,!1!==u)}Xp[Pp]=zp.o;var Zp,ef=function(e){return function(e){var t={};return mh(e,function(e,n){qh(t,e,n[1]),qh(t,n[0],n[1])}),Fh(t)}(e)},tf=function(e){return Mh(e,1,0,Fh)}({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5}),nf="toLowerCase",rf="blkVal",of="length",af="rdOnly",sf="notify",cf="warnToConsole",lf="throwInternal",uf="setDf",df="watch",hf="logger",gf="apply",pf="push",ff="splice",mf="hdlr",vf="cancel",yf="initialize",Cf="identifier",If="removeNotificationListener",kf="addNotificationListener",wf="isInitialized",Tf="getNotifyMgr",Af="getPlugin",bf="pollInternalLogs",Sf="name",Rf="time",Ef="processNext",_f="getProcessTelContext",Pf="enabled",Mf="stopPollingInternalLogs",qf="unload",Of="onComplete",Nf="version",Bf="loggingLevelConsole",xf="createNew",Lf="teardown",Df="messageId",Uf="message",Hf="isAsync",Ff="diagLog",zf="_doTeardown",Kf="update",$f="getNext",Gf="setNextPlugin",Qf="protocol",jf="userAgent",Wf="split",Vf="nodeType",Jf="replace",Yf="type",Xf="handler",Zf="status",em="getResponseHeader",tm="getAllResponseHeaders",nm="isChildEvt",rm="data",om="getCtx",im="setCtx",am="complete",sm="urlString",cm="sendPOST",lm="headers",um="timeout",dm="setRequestHeader",hm="traceId",gm="spanId",pm="traceFlags";
/*!
     * NevWare21 Solutions LLC - ts-async, 0.5.4
     * https://github.com/nevware21/ts-async
     * Copyright (c) NevWare21 Solutions LLC and contributors. All rights reserved.
     * Licensed under the MIT license.
     */
var fm="Promise",mm="rejected";function vm(e,t){return ym(e,function(e){return t?t({status:"fulfilled",rejected:!1,value:e}):e},function(e){return t?t({status:mm,rejected:!0,reason:e}):e})}function ym(e,t,n,r){var o=e;try{if(th(e))(t||n)&&(o=e.then(t,n));else try{t&&(o=t(e))}catch(e){if(!n)throw e;o=n(e)}}finally{r&&function(e,t){var n=e;t&&(th(e)?n=e.finally?e.finally(t):e.then(function(e){return t(),e},function(e){throw t(),e}):t())}(o,r)}return o}var Cm,Im=["pending","resolving","resolved",mm],km="dispatchEvent";function wm(e){var t;return e&&e.createEvent&&(t=e.createEvent("Event")),!!t&&t.initEvent}var Tm,Am,bm,Sm="unhandledRejection",Rm=Sm.toLowerCase(),Em=[],_m=0;function Pm(e){return Wd(e)?e.toString():sh(e)}function Mm(e,t,n){var r,o,i=zg(arguments,3),a=0,s=!1,c=[],l=_m++,u=!1,d=null;function h(t,n){try{return Em.push(l),u=!0,d&&d.cancel(),d=null,e(function(e,o){c.push(function(){try{var i=2===a?t:n,s=Kd(i)?r:Wd(i)?i(r):i;th(s)?s.then(e,o):i?e(s):3===a?o(s):e(s)}catch(e){o(e)}}),s&&p()},i)}finally{Em.pop()}}function g(){return Im[a]}function p(){if(c.length>0){var e=c.slice();c=[],u=!0,d&&d.cancel(),d=null,t(e)}}function f(e,t){return function(n){if(a===t){if(2===e&&th(n))return a=1,void n.then(f(2,1),f(3,1));a=e,s=!0,r=n,p(),u||3!==e||d||(d=vp(m,10))}}}function m(){if(!u)if(u=!0,Pg())process.emit(Sm,r,o);else{var e=bg()||kg();!Tm&&(Tm=vg(Hd(wg,[fm+"RejectionEvent"]).v)),function(e,t,n,r){var o=Ag();!Cm&&(Cm=vg(!!Hd(wm,[o]).v));var i=Cm.v?o.createEvent("Event"):r?new Event(t):{};if(n&&n(i),Cm.v&&i.initEvent(t,!1,!0),i&&e[km])e[km](i);else{var a=e["on"+t];if(a)a(i);else{var s=wg("console");s&&(s.error||s.log)(t,sh(i))}}}(e,Rm,function(e){return _h(e,"promise",{g:function(){return o}}),e.reason=r,e},!!Tm.v)}}return Rh(o={then:h,catch:function(e){return h(void 0,e)},finally:function(e){var t=e,n=e;return Wd(e)&&(t=function(t){return e&&e(),t},n=function(t){throw e&&e(),t}),h(t,n)}},"state",{get:g}),Og()&&(o[Ng(11)]="IPromise"),o.toString=function(){return"IPromise "+g()+(s?" - "+Pm(r):"")},function(){Wd(n)||lh(fm+": executor is not a function - "+Pm(n));var e=f(3,0);try{n.call(o,f(2,0),e)}catch(t){e(t)}}(),o}function qm(e){return function(t){var n=zg(arguments,1);return e(function(e,n){try{var r=[],o=1;Dg(t,function(t,i){t&&(o++,ym(t,function(t){r[i]=t,0===--o&&e(r)},n))}),0===--o&&e(r)}catch(e){n(e)}},n)}}function Om(e){var t=Xd(e)?e:0;return function(e){vp(function(){!function(e){vh(e,function(e){try{e()}catch(e){}})}(e)},t)}}function Nm(e,t){return Mm(Nm,Om(t),e,t)}function Bm(e,t){!Am&&(Am=vg(Hd(wg,[fm]).v||null));var n=Am.v;if(!n)return Nm(e);Wd(e)||lh(fm+": executor is not a function - "+sh(e));var r=0;var o=new n(function(t,n){e(function(e){r=2,t(e)},function(e){r=3,n(e)})});return Rh(o,"state",{get:function(){return Im[r]}}),o}function xm(e,t){return!bm&&(bm=vg(Bm)),bm.v.call(this,e,t)}var Lm=qm(xm),Dm=void 0,Um="",Hm="channels",Fm="core",zm="createPerfMgr",Km="disabled",$m="extensionConfig",Gm="extensions",Qm="processTelemetry",jm="priority",Wm="eventsSent",Vm="eventsDiscarded",Jm="eventsSendRequest",Ym="perfEvent",Xm="offlineEventsStored",Zm="offlineBatchSent",ev="offlineBatchDrop",tv="getPerfMgr",nv="domain",rv="path",ov=/-([a-z])/g,iv=/([^\w\d_$])/g,av=/^(\d+[\w\d_$])/;function sv(e){return!$d(e)}function cv(e){var t=e;return t&&jd(t)&&(t=(t=(t=t[Jf](ov,function(e,t){return t.toUpperCase()}))[Jf](iv,"_"))[Jf](av,function(e,t){return"_"+t})),t}function lv(e,t){return!(!e||!t)&&-1!==up(e,t)}function uv(e){return e&&e.toISOString()||""}function dv(e){return eh(e)?e[Sf]:Um}function hv(e,t,n,r,o){var i=n;return e&&((i=e[t])===n||o&&!o(i)||r&&!r(n)||(i=n,e[t]=i)),i}function gv(e,t,n,r,o){e&&t&&n&&(!1!==o||Kd(e[t]))&&(e[t]=function(e,t){var n=null,r=null;return Wd(e)?n=e:r=e,function(){var e=arguments;if(n&&(r=n()),r)return r[t][gf](r,e)}}(n,r))}function pv(e,t,n,r){return e&&t&&Vd(e)&&Jd(n)&&vh(n,function(n){jd(n)&&gv(e,n,t,n,r)}),e}function fv(e){return e&&Lh&&(e=dd(Lh({},e))),e}function mv(e){try{return e.responseText}catch(e){}return null}function vv(e,t){return e?"XMLHttpRequest,Status:"+e[Zf]+",Response:"+mv(e)||e.response||"":t}function yv(e,t){return t&&(Xd(t)?e=[t].concat(e):Jd(t)&&(e=t.concat(e))),e}var Cv="withCredentials";function Iv(e,t,n){if(!e[n]&&t&&t[em]){var r=t[em](n);r&&(e[n]=Yg(r))}return e}function kv(e,t){var n,r,o={};return e[tm]?(n=e[tm](),r={},jd(n)&&vh(Yg(n)[Wf](/[\r\n]+/),function(e){if(e){var t=e.indexOf(": ");if(-1!==t){var n=Yg(e.substring(0,t))[nf](),o=Yg(e.substring(t+1));r[n]=o}else r[Yg(e)]=1}}),o=r):t&&(o=Iv(o,e,"time-delta-millis"),o=Iv(o,e,"kill-duration"),o=Iv(o,e,"kill-duration-seconds")),o}var wv="JSON",Tv="XMLHttpRequest",Av=null,bv=null,Sv=null,Rv=null;function Ev(e,t){var n=!1;if(e){try{if(!(n=t in e)){var r=e[ud];r&&(n=t in r)}}catch(e){}if(!n)try{n=!Kd((new e)[t])}catch(e){}}return n}function _v(e){return typeof location===cd&&location?location:wg("location")}function Pv(){return Boolean(typeof JSON===cd&&JSON||null!==wg(wv))}function Mv(){var e=_g();return!(!e||!e.product)&&"ReactNative"===e.product}function qv(){var e=_g();if(e&&(e[jf]!==bv||null===Av)){var t=((bv=e[jf])||Um)[nf]();Av=lv(t,"msie")||lv(t,"trident/")}return Av}function Ov(e){return null!==Rv&&!1!==e||(Rv=!!_g()&&Boolean(_g().sendBeacon)),Rv}function Nv(e){var t=!1;try{t=!!wg("fetch");var n=wg("Request");t&&e&&n&&(t=Ev(n,"keepalive"))}catch(e){}return t}function Bv(){return null===Sv&&(Sv=typeof XDomainRequest!==ld)&&xv()&&(Sv=Sv&&!Ev(wg(Tv),"withCredentials")),Sv}function xv(){var e=!1;try{e=!!wg(Tv)}catch(e){}return e}var Lv=4294967296,Dv=4294967295,Uv=123456789,Hv=987654321,Fv=!1,zv=Uv,Kv=Hv;function $v(){try{var e=2147483647&og();(t=(Math.random()*Lv^e)+e)<0&&(t>>>=0),zv=Uv+t&Dv,Kv=Hv-t&Dv,Fv=!0}catch(e){}var t}function Gv(e){var t=0,n=wg("crypto")||wg("msCrypto");return n&&n.getRandomValues&&(t=n.getRandomValues(new Uint32Array(1))[0]&Dv),0===t&&qv()&&(Fv||$v(),t=function(e){var t=((Kv=36969*(65535&Kv)+(Kv>>16)&Dv)<<16)+(65535&(zv=18e3*(65535&zv)+(zv>>16)&Dv))>>>0&Dv;e||(t>>>=0);return t}()&Dv),0===t&&(t=Math.floor(Lv*Math.random()|0)),e||(t>>>=0),t}function Qv(e){void 0===e&&(e=22);for(var t=Gv()>>>0,n=0,r=Um;r[of]<e;)n++,r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===n&&(t=(Gv()<<2&4294967295|3&t)>>>0,n=0);return r}var jv="3.2.1",Wv="."+Qv(6),Vv=0;function Jv(e){return 1===e[Vf]||9===e[Vf]||!+e[Vf]}function Yv(e,t){return void 0===t&&(t=!1),cv(e+Vv+++(t?"."+jv:Um)+Wv)}function Xv(e){var t={id:Yv("_aiData-"+(e||Um)+"."+jv),accept:function(e){return Jv(e)},get:function(e,n,r,o){var i=e[t.id];return i?i[cv(n)]:(o&&(i=function(e,t){var n=t[e.id];if(!n){n={};try{Jv(t)&&_h(t,e.id,{e:!1,v:n})}catch(e){}}return n}(t,e),i[cv(n)]=r),r)},kill:function(e,t){if(e&&e[t])try{delete e[t]}catch(e){}}};return t}function Zv(e){return e&&Vd(e)&&(e.isVal||e.fb||ph(e,"v")||ph(e,"mrg")||ph(e,"ref")||e.set)}function ey(e,t,n){var r,o=n.dfVal||Qd;if(t&&n.fb){var i=n.fb;Jd(i)||(i=[i]);for(var a=0;a<i[of];a++){var s=i[a],c=t[s];if(o(c)?r=c:e&&(o(c=e.cfg[s])&&(r=c),e.set(e.cfg,ah(s),c)),o(r))break}}return!o(r)&&o(n.v)&&(r=n.v),r}function ty(e,t,n){var r,o=n;(n&&Zv(n)&&(o=ey(e,t,n)),o)&&(Zv(o)&&(o=ty(e,t,o)),Jd(o)?(r=[])[of]=o[of]:Xg(o)&&(r={}),r&&(mh(o,function(n,o){o&&Zv(o)&&(o=ty(e,t,o)),r[n]=o}),o=r));return o}function ny(e,t,n,r){var o,i,a,s,c,l,u,d,h=r;Zv(h)?(o=h.isVal,i=h.set,l=h[af],u=h[rf],s=h.mrg,!(c=h.ref)&&Kd(c)&&(c=!!s),a=ey(e,t,h)):a=r,u&&e[rf](t,n);var g=!0,p=t[n];!p&&$d(p)||(d=p,g=!1,o&&d!==a&&!o(d)&&(d=a,g=!0),i&&(g=(d=i(d,a,t))===a)),g?d=a?ty(e,t,a):a:(Xg(d)||Jd(a))&&s&&a&&(Xg(a)||Jd(a))&&mh(a,function(t,n){ny(e,d,t,n)}),e.set(t,n,d),c&&e.ref(t,n),l&&e[af](t,n)}var ry=xg("[[ai_dynCfg_1]]"),oy=xg("[[ai_blkDynCfg_1]]"),iy=xg("[[ai_frcDynCfg_1]]");function ay(e){var t;if(e&&(Jd(e)?(t=[])[of]=e[of]:Xg(e)&&(t={}),t))return mh(e,function(e,n){t[e]=ay(n)}),t;return e}function sy(e,t,n){var r=!1;return n&&!e[t.blkVal]&&((r=n[iy])||n[oy]||(r=Xg(n)||Jd(n))),r}function cy(e){lh("InvalidAccess:"+e)}var ly=["push","pop","shift","unshift","splice"],uy=function(e,t,n,r){e&&e[lf](3,108,"".concat(n," [").concat(t,"] failed - ")+sh(r))};function dy(e,t){var n=sp(e,t);return n&&n.get}function hy(e,t,n,r){if(t){var o=dy(t,n);o&&!!o[e.prop]?t[n]=r:function(e,t,n,r){var o={n:n,h:[],trk:function(t){t&&t.fn&&(-1===Fg(o.h,t)&&o.h[pf](t),e.trk(t,o))},clr:function(e){var t=Fg(o.h,e);-1!==t&&o.h[ff](t,1)}},i=!0,a=!1;function s(){i&&(a=a||sy(s,e,r),r&&!r[ry]&&a&&(r=py(e,r,n,"Converting")),i=!1);var t=e.act;return t&&o.trk(t),r}s[e.prop]={chng:function(){e.add(o)}},_h(t,o.n,{g:s,s:function(c){if(r!==c){s[e.ro]&&!e.upd&&cy("["+n+"] is read-only:"+sh(t)),i&&(a=a||sy(s,e,r),i=!1);var l=a&&s[e.rf];if(a)if(l){mh(r,function(e){r[e]=c?c[e]:Dm});try{mh(c,function(t,n){hy(e,r,t,n)}),c=r}catch(t){uy((e.hdlr||{})[hf],n,"Assigning",t),a=!1}}else r&&r[ry]&&mh(r,function(t){var n=dy(r,t);if(n){var o=n[e.prop];o&&o.chng()}});if(c!==r){var u=c&&sy(s,e,c);!l&&u&&(c=py(e,c,n,"Converting")),r=c,a=u}e.add(o)}}})}(e,t,n,r)}return t}function gy(e,t,n,r){if(t){var o=dy(t,n),i=o&&!!o[e.prop],a=r&&r[0],s=r&&r[1],c=r&&r[2];if(!i){if(c)try{!function(e){if(e&&(Xg(e)||Jd(e)))try{e[oy]=!0}catch(e){}}(t)}catch(t){uy((e.hdlr||{})[hf],n,"Blocking",t)}try{hy(e,t,n,t[n]),o=dy(t,n)}catch(t){uy((e.hdlr||{})[hf],n,"State",t)}}a&&(o[e.rf]=a),s&&(o[e.ro]=s),c&&(o[e.blkVal]=!0)}return t}function py(e,t,n,r){try{mh(t,function(n,r){hy(e,t,n,r)}),t[ry]||(Rh(t,ry,{get:function(){return e[mf]}}),function(e,t,n){Jd(t)&&vh(ly,function(r){var o=t[r];t[r]=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var a=o[gf](this,r);return py(e,t,n,"Patching"),a}})}(e,t,n))}catch(t){uy((e.hdlr||{})[hf],n,r,t)}return t}var fy="[[ai_",my="]]";function vy(e){var t,n,r=Bg(fy+"get"+e.uid+my),o=Bg(fy+"ro"+e.uid+my),i=Bg(fy+"rf"+e.uid+my),a=Bg(fy+"blkVal"+e.uid+my),s=Bg(fy+"dtl"+e.uid+my),c=null,l=null;function u(t,r){var o=n.act;try{n.act=t,t&&t[s]&&(vh(t[s],function(e){e.clr(t)}),t[s]=[]),r({cfg:e.cfg,set:e.set.bind(e),setDf:e[uf].bind(e),ref:e.ref.bind(e),rdOnly:e[af].bind(e)})}catch(t){var i=e[hf];throw i&&i[lf](1,107,sh(t)),t}finally{n.act=o||null}}function d(){if(c){var e=c;c=null,l&&l[vf](),l=null;var t=[];if(vh(e,function(e){if(e&&(e[s]&&(vh(e[s],function(t){t.clr(e)}),e[s]=null),e.fn))try{u(e,e.fn)}catch(e){t[pf](e)}}),c)try{d()}catch(e){t[pf](e)}t[of]>0&&function(e,t){Zp||(Zp=Qg("AggregationError",function(e,t){t[of]>1&&(e.errors=t[1])}));var n=e||"One or more errors occurred.";throw vh(t,function(e,t){n+="\n".concat(t," > ").concat(sh(e))}),new Zp(n,t||[])}("Watcher error(s): ",t)}}return(t={prop:r,ro:o,rf:i})[rf]=a,t[mf]=e,t.add=function(e){if(e&&e.h[of]>0){c||(c=[]),l||(l=vp(function(){l=null,d()},0));for(var t=0;t<e.h[of];t++){var n=e.h[t];n&&-1===Fg(c,n)&&c[pf](n)}}},t[sf]=d,t.use=u,t.trk=function(e,t){if(e){var n=e[s]=e[s]||[];-1===Fg(n,t)&&n[pf](t)}},n=t}function yy(e,t,n){var r,o=function(e){if(e){var t=e[ry]||e;if(t.cfg&&(t.cfg===e||t.cfg[ry]===t))return t}return null}(t);if(o)return o;var i,a=Yv("dyncfg",!0),s=t&&!1!==n?t:ay(t);var c=((r={uid:null,cfg:s})[hf]=e,r[sf]=function(){i[sf]()},r.set=function(t,n,r){try{t=hy(i,t,n,r)}catch(t){uy(e,n,"Setting value",t)}return t[n]},r[uf]=function(e,t){return t&&mh(t,function(t,n){ny(c,e,t,n)}),e},r[df]=function(e){return function(e,t){var n={fn:t,rm:function(){n.fn=null,e=null,t=null}};return _h(n,"toJSON",{v:function(){return"WatcherHandler"+(n.fn?"":"[X]")}}),e.use(n,t),n}(i,e)},r.ref=function(e,t){var n;return gy(i,e,t,(n={},n[0]=!0,n))[t]},r[af]=function(e,t){var n;return gy(i,e,t,(n={},n[1]=!0,n))[t]},r[rf]=function(e,t){var n;return gy(i,e,t,(n={},n[2]=!0,n))[t]},r._block=function(e,t){i.use(null,function(n){var r=i.upd;try{Kd(t)||(i.upd=t),e(n)}finally{i.upd=r}})},r);return _h(c,"uid",{c:!1,e:!1,w:!1,v:a}),py(i=vy(c),s,"config","Creating"),c}function Cy(e,t,n,r){var o=yy(n,e||{},r);return t&&o[uf](o.cfg,t),o}function Iy(e,t,n){var r=e[ry]||e;return!r.cfg||r.cfg!==e&&r.cfg[ry]!==r?(function(e,t){e?(e[cf](t),e[lf](2,108,t)):cy(t)}(n,"Not dynamic - "+sh(e)),Cy(e,null,n)[df](t)):r[df](t)}function ky(e,t){if(e&&e[qf])return e[qf](t)}function wy(e,t,n){var r;return n||(r=xm(function(e){n=e})),e&&ap(e)>0?vm(ky(e[0],t),function(){wy(zg(e,1),t,n)}):n(),r}var Ty="Microsoft_ApplicationInsights_BypassAjaxInstrumentation";function Ay(e){return{mrg:!0,v:e}}function by(e){return{isVal:jd,v:ah(e||Um)}}var Sy,Ry,Ey=[Wm,Vm,Jm,Ym],_y=null;function Py(e,t){return function(){var n=arguments,r=My(t);if(r){var o=r.listener;o&&o[e]&&o[e][gf](o,n)}}}function My(e){var t,n=_y;return n||!0===e.disableDbgExt||(n=_y||((t=wg("Microsoft"))&&(_y=t.ApplicationInsights),_y)),n?n.ChromeDbgExt:null}var qy="warnToConsole",Oy={loggingLevelConsole:0,loggingLevelTelemetry:1,maxMessageLimit:25,enableDebug:!1},Ny=((Ry={})[0]=null,Ry[1]="errorToConsole",Ry[2]=qy,Ry[3]="debugToConsole",Ry);function By(e){return e?'"'+e[Jf](/\"/g,Um)+'"':Um}function xy(e,t){var n=typeof console!==ld?console:wg("console");if(n){var r="log";n[e]&&(r=e),Wd(n[r])&&n[r](t)}}var Ly=function(){function e(e,t,n,r){void 0===n&&(n=!1);var o=this;o[Df]=e,o[Uf]=(n?"AI: ":"AI (Internal): ")+e;var i=Um;Pv()&&(i=(Pv()?JSON||wg(wv):null).stringify(r));var a=(t?" message:"+By(t):Um)+(r?" props:"+By(i):Um);o[Uf]+=a}return e.dataType="MessageData",e}();function Dy(e,t){return(e||{})[hf]||new Fy(t)}var Uy,Hy,Fy=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n,r,o,i,a,s=0,c={};Xp(e,this,function(e){function l(t,n){if(!(s>=o)){var i=!0,a="AITR_"+n[Df];if(c[a]?i=!1:c[a]=!0,i&&(t<=r&&(e.queue[pf](n),s++,u(1===t?"error":"warn",n)),s===o)){var l="Internal events throttle limit per PageView reached for this app.",d=new Ly(23,l,!1);e.queue[pf](d),1===t?e.errorToConsole(l):e[cf](l)}}}function u(e,n){var r=My(t||{});r&&r[Ff]&&r[Ff](e,n)}a=function(t){return Iy(Cy(t,Oy,e).cfg,function(e){var t=e.cfg;n=t[Bf],r=t.loggingLevelTelemetry,o=t.maxMessageLimit,i=t.enableDebug})}(t||{}),e.consoleLoggingLevel=function(){return n},e[lf]=function(t,r,o,a,s){void 0===s&&(s=!1);var d=new Ly(r,o,s,a);if(i)throw sh(d);var h=Ny[t]||qy;if(Kd(d[Uf]))u("throw"+(1===t?"Critical":"Warning"),d);else{if(s){var g=+d[Df];!c[g]&&n>=t&&(e[h](d[Uf]),c[g]=!0)}else n>=t&&e[h](d[Uf]);l(t,d)}},e.debugToConsole=function(e){xy("debug",e),u("warning",e)},e[cf]=function(e){xy("warn",e),u("warning",e)},e.errorToConsole=function(e){xy("error",e),u("error",e)},e.resetInternalMessageCount=function(){s=0,c={}},e.logInternalMessage=l,e[qf]=function(e){a&&a.rm(),a=null}})}return e.__ieDyn=1,e}();function zy(e){return e||new Fy}function Ky(e,t,n,r,o,i){void 0===i&&(i=!1),zy(e)[lf](t,n,r,o,i)}function $y(e,t){zy(e)[cf](t)}var Gy,Qy="toGMTString",jy="toUTCString",Wy="cookie",Vy="expires",Jy="isCookieUseDisabled",Yy="disableCookiesUsage",Xy="_ckMgr",Zy=null,eC=null,tC=null,nC={},rC={},oC=((Uy={cookieCfg:Ay((Hy={},Hy[nv]={fb:"cookieDomain",dfVal:sv},Hy.path={fb:"cookiePath",dfVal:sv},Hy.enabled=Dm,Hy.ignoreCookies=Dm,Hy.blockedCookies=Dm,Hy)),cookieDomain:Dm,cookiePath:Dm})[Yy]=Dm,Uy);function iC(){!Gy&&(Gy=cg(function(){return Ag()}))}function aC(e){return!e||e.isEnabled()}function sC(e,t){return!!(t&&e&&Jd(e.ignoreCookies))&&-1!==Fg(e.ignoreCookies,t)}function cC(e,t){var n=t[Pf];if($d(n)){var r=void 0;Kd(e[Jy])||(r=!e[Jy]),Kd(e[Yy])||(r=!e[Yy]),n=r}return n}function lC(e,t){var n;if(e)n=e.getCookieMgr();else if(t){var r=t.cookieCfg;n=r&&r[Xy]?r[Xy]:uC(t)}return n||(n=function(e,t){var n=uC[Xy]||rC[Xy];return n||(n=uC[Xy]=uC(e,t),rC[Xy]=n),n}(t,(e||{})[hf])),n}function uC(e,t){var n,r,o,i,a,s,c,l,u;e=Cy(e||rC,null,t).cfg,a=Iy(e,function(t){t[uf](t.cfg,oC),r=t.ref(t.cfg,"cookieCfg"),o=r[rv]||"/",i=r[nv],s=!1!==cC(e,r),c=r.getCookie||fC,l=r.setCookie||mC,u=r.delCookie||mC},t);var d=(n={isEnabled:function(){var n=!1!==cC(e,r)&&s&&dC(t),o=rC[Xy];return n&&o&&d!==o&&(n=aC(o)),n},setEnabled:function(e){s=!1!==e,r[Pf]=e},set:function(e,t,n,a,s){var c=!1;if(aC(d)&&!function(e,t){return!!(t&&e&&Jd(e.blockedCookies)&&-1!==Fg(e.blockedCookies,t))||sC(e,t)}(r,e)){var u={},h=Yg(t||Um),g=up(h,";");if(-1!==g&&(h=Yg(eg(t,g)),u=hC(Yh(t,g+1))),hv(u,nv,a||i,nh,Kd),!$d(n)){var p=qv();if(Kd(u[Vy])){var f=og()+1e3*n;if(f>0){var m=new Date;m.setTime(f),hv(u,Vy,gC(m,p?Qy:jy)||gC(m,p?Qy:jy)||Um,nh)}}p||hv(u,"max-age",Um+n,null,Kd)}var v=_v();v&&"https:"===v[Qf]&&(hv(u,"secure",null,null,Kd),null===eC&&(eC=!function(e){if(!jd(e))return!1;if(lv(e,"CPU iPhone OS 12")||lv(e,"iPad; CPU OS 12"))return!0;if(lv(e,"Macintosh; Intel Mac OS X 10_14")&&lv(e,"Version/")&&lv(e,"Safari"))return!0;if(lv(e,"Macintosh; Intel Mac OS X 10_14")&&cp(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))return!0;if(lv(e,"Chrome/5")||lv(e,"Chrome/6"))return!0;if(lv(e,"UnrealEngine")&&!lv(e,"Chrome"))return!0;if(lv(e,"UCBrowser/12")||lv(e,"UCBrowser/11"))return!0;return!1}((_g()||{})[jf])),eC&&hv(u,"SameSite","None",null,Kd)),hv(u,rv,s||o,null,Kd),l(e,pC(h,u)),c=!0}return c},get:function(e){var t=Um;return aC(d)&&!sC(r,e)&&(t=c(e)),t},del:function(e,t){var n=!1;return aC(d)&&(n=d.purge(e,t)),n},purge:function(e,n){var r,o=!1;if(dC(t)){var i=((r={})[rv]=n||"/",r[Vy]="Thu, 01 Jan 1970 00:00:01 GMT",r);qv()||(i["max-age"]="0"),u(e,pC(Um,i)),o=!0}return o}},n[qf]=function(e){a&&a.rm(),a=null},n);return d[Xy]=d,d}function dC(e){if(null===Zy){Zy=!1,!Gy&&iC();try{var t=Gy.v||{};Zy=void 0!==t[Wy]}catch(t){Ky(e,2,68,"Cannot access document.cookie - "+dv(t),{exception:sh(t)})}}return Zy}function hC(e){var t={};e&&e[of]&&vh(Yg(e)[Wf](";"),function(e){if(e=Yg(e||Um)){var n=up(e,"=");-1===n?t[e]=null:t[Yg(eg(e,n))]=Yg(Yh(e,n+1))}});return t}function gC(e,t){return Wd(e[t])?e[t]():null}function pC(e,t){var n=e||Um;return mh(t,function(e,t){n+="; "+e+($d(t)?Um:"="+t)}),n}function fC(e){var t=Um;if(!Gy&&iC(),Gy.v){var n=Gy.v[Wy]||Um;tC!==n&&(nC=hC(n),tC=n),t=Yg(nC[e]||Um)}return t}function mC(e,t){!Gy&&iC(),Gy.v&&(Gy.v[Wy]=e+"="+t)}var vC={perfEvtsSendAll:!1};function yC(e){e.h=null;var t=e.cb;e.cb=[],vh(t,function(e){Hd(e.fn,[e.arg])})}function CC(e,t,n,r){vh(e,function(e){e&&e[t]&&(n?(n.cb[pf]({fn:r,arg:e}),n.h=n.h||vp(yC,0,n)):Hd(r,[e]))})}var IC=function(){function e(t){var n,r;this.listeners=[];var o=[],i={h:null,cb:[]},a=Cy(t,vC);r=a[df](function(e){n=!!e.cfg.perfEvtsSendAll}),Xp(e,this,function(e){_h(e,"listeners",{g:function(){return o}}),e[kf]=function(e){o[pf](e)},e[If]=function(e){for(var t=Fg(o,e);t>-1;)o[ff](t,1),t=Fg(o,e)},e[Wm]=function(e){CC(o,Wm,i,function(t){t[Wm](e)})},e[Vm]=function(e,t){CC(o,Vm,i,function(n){n[Vm](e,t)})},e[Jm]=function(e,t){CC(o,Jm,t?i:null,function(n){n[Jm](e,t)})},e[Ym]=function(e){e&&(!n&&e[nm]()||CC(o,Ym,null,function(t){e[Hf]?vp(function(){return t[Ym](e)},0):t[Ym](e)}))},e[Xm]=function(e){e&&e[of]&&CC(o,Xm,i,function(t){t[Xm](e)})},e[Zm]=function(e){e&&e[rm]&&CC(o,Zm,i,function(t){t[Zm](e)})},e[ev]=function(e,t){if(e>0){var n=t||0;CC(o,ev,i,function(t){t[ev](e,n)})}},e[qf]=function(e){var t,n=function(){r&&r.rm(),r=null,o=[],i.h&&i.h[vf](),i.h=null,i.cb=[]};if(CC(o,"unload",null,function(n){var r=n[qf](e);r&&(t||(t=[]),t[pf](r))}),t)return xm(function(e){return vm(Lm(t),function(){n(),e()})});n()}})}return e.__ieDyn=1,e}(),kC="ctx",wC="ParentContextKey",TC="ChildrenContextKey",AC=function(){function e(t,n,r){var o,i=this;(i.start=og(),i[Sf]=t,i[Hf]=r,i[nm]=function(){return!1},Wd(n))&&_h(i,"payload",{g:function(){return!o&&Wd(n)&&(o=n(),n=null),o}});i[om]=function(t){return t?t===e[wC]||t===e[TC]?i[t]:(i[kC]||{})[t]:null},i[im]=function(t,n){if(t)if(t===e[wC])i[t]||(i[nm]=function(){return!0}),i[t]=n;else if(t===e[TC])i[t]=n;else{(i[kC]=i[kC]||{})[t]=n}},i[am]=function(){var t=0,n=i[om](e[TC]);if(Jd(n))for(var r=0;r<n[of];r++){var o=n[r];o&&(t+=o[Rf])}i[Rf]=og()-i.start,i.exTime=i[Rf]-t,i[am]=function(){}}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),bC=function(){function e(t){this.ctx={},Xp(e,this,function(e){e.create=function(e,t,n){return new AC(e,t,n)},e.fire=function(e){e&&(e[am](),t&&Wd(t[Ym])&&t[Ym](e))},e[im]=function(t,n){t&&((e[kC]=e[kC]||{})[t]=n)},e[om]=function(t){return(e[kC]||{})[t]}})}return e.__ieDyn=1,e}(),SC="CoreUtils.doPerf";function RC(e,t,n,r,o){if(e){var i=e;if(i[tv]&&(i=i[tv]()),i){var a=void 0,s=i[om](SC);try{if(a=i.create(t(),r,o)){if(s&&a[im]&&(a[im](AC[wC],s),s[om]&&s[im])){var c=s[om](AC[TC]);c||(c=[],s[im](AC[TC],c)),c[pf](a)}return i[im](SC,a),n(a)}}catch(e){a&&a[im]&&a[im]("exception",e)}finally{a&&i.fire(a),i[im](SC,s)}}}return n()}function EC(){var e=_C();return Yh(e,0,8)+"-"+Yh(e,8,12)+"-"+Yh(e,12,16)+"-"+Yh(e,16,20)+"-"+Yh(e,20)}function _C(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n=Um,r=0;r<4;r++)n+=t[15&(e=Gv())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var o=t[8+(3&Gv())|0];return Xh(n,0,8)+Xh(n,9,4)+"4"+Xh(n,13,3)+o+Xh(n,16,3)+Xh(n,19,12)}function PC(e,t,n){return!(!e||e[of]!==t||e===n)&&!!e.match(/^[\da-f]*$/i)}function MC(e){return PC(e,32,"00000000000000000000000000000000")}function qC(e){return PC(e,16,"0000000000000000")}var OC=Xv("plugin");function NC(e){return OC.get(e,"state",{},!0)}function BC(e,t){for(var n,r=[],o=null,i=e[$f]();i;){var a=i[Af]();if(a){o&&o[Gf]&&a[Qm]&&o[Gf](a);var s=!!(n=NC(a))[wf];a[wf]&&(s=a[wf]()),s||r[pf](a),o=a,i=i[$f]()}}vh(r,function(r){var o=e[Fm]();r[yf](e.getCfg(),o,t,e[$f]()),n=NC(r),r[Fm]||n[Fm]||(n[Fm]=o),n[wf]=!0,delete n[Lf]})}function xC(e){return e.sort(function(e,t){var n=0;if(t){var r=t[Qm];e[Qm]?n=r?e[jm]-t[jm]:1:r&&(n=-1)}else n=e?1:-1;return n})}var LC,DC="TelemetryPluginChain",UC="_hasRun",HC="_getTelCtx",FC=0;function zC(e,t,n,r){var o=null,i=[];t||(t=Cy({},null,n[hf])),null!==r&&(o=r?function(e,t,n){for(;e;){if(e[Af]()===n)return e;e=e[$f]()}return QC([n],t.config||{},t)}(e,n,r):e);var a={_next:function(){var e=o;if(o=e?e[$f]():null,!e){var t=i;t&&t[of]>0&&(vh(t,function(e){try{e.func.call(e.self,e.args)}catch(e){Ky(n[hf],2,73,"Unexpected Exception during onComplete - "+sh(e))}}),i=[])}return e},ctx:{core:function(){return n},diagLog:function(){return Dy(n,t.cfg)},getCfg:function(){return t.cfg},getExtCfg:function(e,n){var r=s(e,!0);n&&mh(n,function(e,n){if($d(r[e])){var o=t.cfg[e];!o&&$d(o)||(r[e]=o)}ny(t,r,e,n)});return t[uf](r,n)},getConfig:function(e,n,r){void 0===r&&(r=!1);var o,i=s(e,!1),a=t.cfg;!i||!i[n]&&$d(i[n])?!a[n]&&$d(a[n])||(o=a[n]):o=i[n];return o||!$d(o)?o:r},hasNext:function(){return!!o},getNext:function(){return o},setNext:function(e){o=e},iterate:function(e){var t;for(;t=a._next();){var n=t[Af]();n&&e(n)}},onComplete:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];e&&i[pf]({func:e,self:Kd(t)?a.ctx:t,args:n})}}};function s(e,n){var r=null,o=t.cfg;if(o&&e){var i=o[$m];!i&&n&&(i={}),o[$m]=i,(i=t.ref(o,$m))&&(!(r=i[e])&&n&&(r={}),i[e]=r,r=t.ref(i,e))}return r}return a}function KC(e,t,n,r){var o=Cy(t),i=zC(e,o,n,r),a=i.ctx;return a[Ef]=function(e){var t=i._next();return t&&t[Qm](e,a),!t},a[xf]=function(e,t){return void 0===e&&(e=null),Jd(e)&&(e=QC(e,o.cfg,n,t)),KC(e||a[$f](),o.cfg,n,t)},a}function $C(e,t,n){var r=Cy(t.config),o=zC(e,r,t,n),i=o.ctx;return i[Ef]=function(e){var t=o._next();return t&&t[qf](i,e),!t},i[xf]=function(e,n){return void 0===e&&(e=null),Jd(e)&&(e=QC(e,r.cfg,t,n)),$C(e||i[$f](),t,n)},i}function GC(e,t,n){var r=Cy(t.config),o=zC(e,r,t,n).ctx;return o[Ef]=function(e){return o.iterate(function(t){Wd(t[Kf])&&t[Kf](o,e)})},o[xf]=function(e,n){return void 0===e&&(e=null),Jd(e)&&(e=QC(e,r.cfg,t,n)),GC(e||o[$f](),t,n)},o}function QC(e,t,n,r){var o=null,i=!r;if(Jd(e)&&e[of]>0){var a=null;vh(e,function(e){if(i||r!==e||(i=!0),i&&e&&Wd(e[Qm])){var s=function(e,t,n){var r,o=null,i=Wd(e[Qm]),a=Wd(e[Gf]);r=e?e[Cf]+"-"+e[jm]+"-"+FC++:"Unknown-0-"+FC++;var s={getPlugin:function(){return e},getNext:function(){return o},processTelemetry:u,unload:d,update:h,_id:r,_setNext:function(e){o=e}};function c(){var r;return e&&Wd(e[HC])&&(r=e[HC]()),r||(r=KC(s,t,n)),r}function l(t,n,i,a,s){var c=!1,l=e?e[Cf]:DC,u=t[UC];return u||(u=t[UC]={}),t.setNext(o),e&&RC(t[Fm](),function(){return l+":"+i},function(){u[r]=!0;try{var e=o?o._id:Um;e&&(u[e]=!1),c=n(t)}catch(e){var a=!o||u[o._id];a&&(c=!0),o&&a||Ky(t[Ff](),1,73,"Plugin ["+l+"] failed during "+i+" - "+sh(e)+", run flags: "+sh(u))}},a,s),c}function u(t,n){function r(n){if(!e||!i)return!1;var r=NC(e);return!r[Lf]&&!r[Km]&&(a&&e[Gf](o),e[Qm](t,n),!0)}l(n=n||c(),r,"processTelemetry",function(){return{item:t}},!t.sync)||n[Ef](t)}function d(t,n){function r(){var r=!1;if(e){var o=NC(e),i=e[Fm]||o[Fm];!e||i&&i!==t.core()||o[Lf]||(o[Fm]=null,o[Lf]=!0,o[wf]=!1,e[Lf]&&!0===e[Lf](t,n)&&(r=!0))}return r}l(t,r,"unload",function(){},n[Hf])||t[Ef](n)}function h(t,n){function r(){var r=!1;if(e){var o=NC(e),i=e[Fm]||o[Fm];!e||i&&i!==t.core()||o[Lf]||e[Kf]&&!0===e[Kf](t,n)&&(r=!0)}return r}l(t,r,"update",function(){},!1)||t[Ef](n)}return Fh(s)}(e,t,n);o||(o=s),a&&a._setNext(s),a=s}})}return r&&!o?QC([r],t,n):o}function jC(){var e=[];return{add:function(t){t&&e[pf](t)},run:function(t,n){vh(e,function(e){try{e(t,n)}catch(e){Ky(t[Ff](),2,73,"Unexpected error calling unload handler - "+sh(e))}}),e=[]}}}function WC(){var e=[];return{run:function(t){var n=e;e=[],vh(n,function(e){try{(e.rm||e.remove).call(e)}catch(e){Ky(t,2,73,"Unloading:"+sh(e))}})},add:function(t){t&&Ug(e,t)}}}var VC="getPlugin",JC=((LC={})[$m]={isVal:sv,v:{}},LC),YC=function(){function e(){var t,n,r,o,i,a=this;function s(e){void 0===e&&(e=null);var t=e;if(!t){var o=n||KC(null,{},a[Fm]);t=r&&r[VC]?o[xf](null,r[VC]):o[xf](null,r)}return t}function c(e,t,o){Cy(e,JC,Dy(t)),!o&&t&&(o=t[_f]()[$f]());var i=r;r&&r[VC]&&(i=r[VC]()),a[Fm]=t,n=KC(o,e,t,i)}function l(){t=!1,a[Fm]=null,n=null,r=null,i=WC(),o=jC()}l(),Xp(e,a,function(e){e[yf]=function(e,n,r,o){c(e,n,o),t=!0},e[Lf]=function(t,n){var a,s=e[Fm];if(s&&(!t||s===t[Fm]())){var c,u=!1,d=t||$C(null,s,r&&r[VC]?r[VC]():r),h=n||((a={reason:0})[Hf]=!1,a);return e[zf]&&!0===e[zf](d,h,g)?c=!0:g(),c}function g(){u||(u=!0,o.run(d,n),i.run(d[Ff]()),!0===c&&d[Ef](h),l())}},e[Kf]=function(t,n){var o=e[Fm];if(o&&(!t||o===t[Fm]())){var i,a=!1,s=t||GC(null,o,r&&r[VC]?r[VC]():r),l=n||{reason:0};return e._doUpdate&&!0===e._doUpdate(s,l,u)?i=!0:u(),i}function u(){a||(a=!0,c(s.getCfg(),s.core(),s[$f]()))}},gv(e,"_addUnloadCb",function(){return o},"add"),gv(e,"_addHook",function(){return i},"add"),_h(e,"_unloadHooks",{g:function(){return i}})}),a[Ff]=function(e){return s(e)[Ff]()},a[wf]=function(){return t},a.setInitialized=function(e){t=e},a[Gf]=function(e){r=e},a[Ef]=function(e,t){t?t[Ef](e):r&&Wd(r[Qm])&&r[Qm](e,null)},a._getTelCtx=s}return e.__ieDyn=1,e}();var XC,ZC=function(e){function t(){var n,r,o=e.call(this)||this;function i(){n=0,r=[]}return o.identifier="TelemetryInitializerPlugin",o.priority=199,i(),Xp(t,o,function(e,t){e.addTelemetryInitializer=function(e){return function(e,t,n){var r={id:t,fn:n};return Ug(e,r),{remove:function(){vh(e,function(t,n){if(t.id===r.id)return e[ff](n,1),-1})}}}(r,n++,e)},e[Qm]=function(t,n){(function(e,t,n){for(var r=!1,o=e[of],i=0;i<o;++i){var a=e[i];if(a)try{if(!1===a.fn[gf](null,[t])){r=!0;break}}catch(e){Ky(n,2,64,"Telemetry initializer failed: "+dv(e),{exception:sh(e)},!0)}}return!r})(r,t,n?n[Ff]():e[Ff]())&&e[Ef](t,n)},e[zf]=function(){i()}}),o}return Ip(t,e),t.__ieDyn=1,t}(YC),eI="Plugins must provide initialize method",tI="SDK is still unloading...",nI=Hh(((XC={cookieCfg:{}})[Gm]={rdOnly:!0,ref:!0,v:[]},XC[Hm]={rdOnly:!0,ref:!0,v:[]},XC[$m]={ref:!0,v:{}},XC[zm]=Dm,XC.loggingLevelConsole=0,XC.diagnosticLogInterval=Dm,XC));function rI(e,t){return new bC(t)}function oI(e,t){var n=!1;return vh(t,function(t){if(t===e)return n=!0,-1}),n}function iI(e,t,n,r){n&&mh(n,function(n,o){r&&Xg(o)&&Xg(t[n])&&iI(e,t[n],o,r),r&&Xg(o)&&Xg(t[n])?iI(e,t[n],o,r):e.set(t,n,o)})}function aI(e,t){var n=null,r=-1;return vh(e,function(e,o){if(e.w===t)return n=e,r=o,-1}),{i:r,l:n}}function sI(e,t,n,r){return t.add(e[df](function(e){var t=e.cfg.disableDbgExt;!0===t&&r&&(n[If](r),r=null),n&&!r&&!0!==t&&(r=function(e){if(!Sy){Sy={};for(var t=0;t<Ey[of];t++)Sy[Ey[t]]=Py(Ey[t],e)}return Sy}(e.cfg),n[kf](r))})),r}var cI=function(){function e(){var t,n,r,o,i,a,s,c,l,u,d,h,g,p,f,m,v,y,C,I,k,w,T,A,b,S,R,E;Xp(e,this,function(e){function _(e){S&&S[Pf]||E||(e||r&&r.queue[of]>0)&&(R||(R=!0,z(t[df](function(e){var t=e.cfg.diagnosticLogInterval;t&&t>0||(t=1e4);var n=!1;S&&(n=S[Pf],S[vf]()),S=function(e,t){return mp(!1,md,Ld[Rd](arguments))}(L,t),S.unref(),S[Pf]=n}))),S[Pf]=!0);return S}function P(){var e={};A=[];var t=function(t){t&&vh(t,function(t){if(t[Cf]&&t[Nf]&&!e[t.identifier]){var n=t[Cf]+"="+t[Nf];A[pf](n),e[t.identifier]=t}})};t(h),d&&vh(d,function(e){t(e)}),t(u)}function M(){n=!1,(t=Cy({},nI,e[hf])).cfg[Bf]=1,_h(e,"config",{g:function(){return t.cfg},s:function(t){e.updateCfg(t,!1)}}),_h(e,"pluginVersionStringArr",{g:function(){return A||P(),A}}),_h(e,"pluginVersionString",{g:function(){return b||(A||P(),b=A.join(";")),b||Um}}),_h(e,"logger",{g:function(){return r||(r=new Fy(t.cfg),t[hf]=r),r},s:function(e){t[hf]=e,r!==e&&(ky(r,!1),r=e)}}),e[hf]=new Fy(t.cfg),T=[];var C=e.config[Gm]||[];C.splice(0,C[of]),Ug(C,T),p=new ZC,o=[],ky(i,!1),i=null,a=null,s=null,ky(c,!1),c=null,l=null,u=[],d=null,h=null,g=!1,f=null,m=Yv("AIBaseCore",!0),v=jC(),I=null,k=null,y=WC(),w=[],b=null,A=null,E=!1,S=null,R=!1}function q(){var n=KC(B(),t.cfg,e);return n[Of](_),n}function O(t){var n=function(e,t,n){var r,o=[],i=[],a={};return vh(n,function(n){($d(n)||$d(n[yf]))&&ch(eI);var r=n[jm],s=n[Cf];n&&r&&($d(a[r])?a[r]=s:$y(e,"Two extensions have same priority #"+r+" - "+a[r]+", "+s)),!r||r<t?o[pf](n):i[pf](n)}),(r={})[Fm]=o,r[Hm]=i,r}(e[hf],500,u);l=null,b=null,A=null,h=xC(Ug(h=(d||[])[0]||[],n[Hm]));var r=Ug(xC(n[Fm]),h);T=Fh(r);var o=e.config[Gm]||[];o.splice(0,o[of]),Ug(o,T);var i=q();h&&h[of]>0&&BC(i[xf](h),r),BC(i,r),t&&U(t)}function N(e){var t=null,n=null,r=[];return vh(T,function(t){if(t[Cf]===e&&t!==p)return n=t,-1;t.getChannel&&r[pf](t)}),!n&&r[of]>0&&vh(r,function(t){if(!(n=t.getChannel(e)))return-1}),n&&(t={plugin:n,setEnabled:function(e){NC(n)[Km]=!e},isEnabled:function(){var e=NC(n);return!e[Lf]&&!e[Km]},remove:function(e,t){var r;void 0===e&&(e=!0);var o=[n],i=((r={reason:1})[Hf]=e,r);x(o,i,function(e){e&&O({reason:32,removed:o}),t&&t(e)})}}),t}function B(){if(!l){var n=(T||[]).slice();-1===Fg(n,p)&&n[pf](p),l=QC(xC(n),t.cfg,e)}return l}function x(n,r,o){if(n&&n[of]>0){var i=$C(QC(n,t.cfg,e),e);i[Of](function(){var e=!1,t=[];vh(u,function(r,o){oI(r,n)?e=!0:t[pf](r)}),u=t,b=null,A=null;var r=[];d&&(vh(d,function(t,o){var i=[];vh(t,function(t){oI(t,n)?e=!0:i[pf](t)}),r[pf](i)}),d=r),o&&o(e),_()}),i[Ef](r)}else o(!1)}function L(){if(r&&r.queue){var t=r.queue.slice(0);r.queue[of]=0,vh(t,function(t){var n,r=((n={})[Sf]=f||"InternalMessageId: "+t[Df],n.iKey=k,n[Rf]=uv(new Date),n.baseType=Ly.dataType,n.baseData={message:t[Uf]},n);e.track(r)})}}function D(e,t,n,r){var o=1,i=!1,a=null;function s(){o--,i&&0===o&&(a&&a[vf](),a=null,t&&t(i),t=null)}(r=r||5e3,h&&h[of]>0)&&q()[xf](h).iterate(function(t){if(t.flush){o++;var i=!1;t.flush(e,function(){i=!0,s()},n)||i||(e&&null==a?a=vp(function(){a=null,s()},r):s())}});return i=!0,s(),!0}function U(t){var n=GC(B(),e);n[Of](_),e._updateHook&&!0===e._updateHook(n,t)||n[Ef](t)}function H(t){var n=e[hf];n?(Ky(n,2,73,t),_()):ch(t)}function F(t){var n=e[Tf]();n&&n[Vm]([t],2)}function z(e){y.add(e)}M(),e._getDbgPlgTargets=function(){return[T]},e[wf]=function(){return n},e[yf]=function(o,c,l,p){var f;g&&ch(tI),e[wf]()&&ch("Core cannot be initialized more than once"),o=(t=Cy(o,nI,l||e[hf],!1)).cfg,z(t[df](function(e){k=e.cfg.instrumentationKey;var t=e.ref(e.cfg,$m);mh(t,function(n){e.ref(t,n)}),$d(k)&&ch("Please provide instrumentation key")})),C=sI(t,y,(i=p)&&e[Tf](),C),z(t[df](function(t){var n,r,o,i;if(t.cfg.enablePerfMgr){var c=t.cfg[zm];f!==c&&(c||(c=rI),n=t.cfg,r=zm,o=c,n?!(i=n[r])&&$d(i)&&(i=Kd(o)?{}:o,n[r]=i):i=Kd(o)?{}:o,f=c,s=null),a||s||!Wd(c)||(s=c(e,e[Tf]()))}else s=null,f=null})),e[hf]=l;var m=o[Gm];if((u=[])[pf].apply(u,kp(kp([],c),m)),d=o[Hm],O(null),h&&0!==h[of]||ch("No "+Hm+" available"),d&&d[of]>1){var v=e[Af]("TeeChannelController");v&&v.plugin||Ky(r,1,28,"TeeChannel required")}!function(e,t,n){vh(t,function(t){var r=Iy(e,t.w,n);delete t.w,t.rm=function(){r.rm()}})}(o,w,r),w=null,n=!0,e.releaseQueue(),e[bf]()},e.getChannels=function(){var e=[];return h&&vh(h,function(t){e[pf](t)}),Fh(e)},e.track=function(t){RC(e[tv](),function(){return"AppInsightsCore:track"},function(){null===t&&(F(t),ch("Invalid telemetry item")),!t[Sf]&&$d(t[Sf])&&(F(t),ch("telemetry name required")),t.iKey=t.iKey||k,t[Rf]=t[Rf]||uv(new Date),t.ver=t.ver||"4.0",!g&&e[wf]()?q()[Ef](t):o[pf](t)},function(){return{item:t}},!t.sync)},e[_f]=q,e[Tf]=function(){return i||(i=new IC(t.cfg),e._notificationManager=i),i},e[kf]=function(t){e.getNotifyMgr()[kf](t)},e[If]=function(e){i&&i[If](e)},e.getCookieMgr=function(){return c||(c=uC(t.cfg,e[hf])),c},e.setCookieMgr=function(e){c!==e&&(ky(c,!1),c=e)},e[tv]=function(){return a||s||null},e.setPerfMgr=function(e){a=e},e.eventCnt=function(){return o[of]},e.releaseQueue=function(){if(n&&o[of]>0){var e=o;o=[],vh(e,function(e){q()[Ef](e)})}},e[bf]=function(e){return f=e||null,E=!1,S&&S[vf](),_(!0)},e[Mf]=function(){E=!0,S&&S[vf](),L()},pv(e,function(){return p},["addTelemetryInitializer"]),e[qf]=function(t,o,a){var s;void 0===t&&(t=!0),n||ch("SDK is not initialized"),g&&ch(tI);var l,u=((s={reason:50})[Hf]=t,s.flushComplete=!1,s);t&&!o&&(l=xm(function(e){o=e}));var d=$C(B(),e);return d[Of](function(){y.run(e[hf]),wy([c,i,r],t,function(){M(),o&&o(u)})},e),L(),D(t,function(t){u.flushComplete=t,g=!0,v.run(d,u),e[Mf](),d[Ef](u)},6,a),l},e[Af]=N,e.addPlugin=function(e,t,n,r){if(!e)return r&&r(!1),void H(eI);var o=N(e[Cf]);if(o&&!t)return r&&r(!1),void H("Plugin ["+e[Cf]+"] is already loaded!");var i={reason:16};function a(t){u[pf](e),i.added=[e],O(i),r&&r(!0)}if(o){var s=[o.plugin];x(s,{reason:2,isAsync:!!n},function(e){e?(i.removed=s,i.reason|=32,a()):r&&r(!1)})}else a()},e.updateCfg=function(n,r){var o;if(void 0===r&&(r=!0),e[wf]()){o={reason:1,cfg:t.cfg,oldCfg:ip({},t.cfg),newConfig:ip({},n),merge:r},n=o.newConfig;var i=t.cfg;n[Gm]=i[Gm],n[Hm]=i[Hm]}t._block(function(e){var t=e.cfg;iI(e,t,n,r),r||mh(t,function(r){ph(n,r)||e.set(t,r,Dm)}),e[uf](t,nI)},!0),t[sf](),o&&U(o)},e.evtNamespace=function(){return m},e.flush=D,e.getTraceCtx=function(e){var t,n;return I||(n={},I={getName:function(){return n[Sf]},setName:function(e){t&&t.setName(e),n[Sf]=e},getTraceId:function(){return n[hm]},setTraceId:function(e){t&&t.setTraceId(e),MC(e)&&(n[hm]=e)},getSpanId:function(){return n[gm]},setSpanId:function(e){t&&t.setSpanId(e),qC(e)&&(n[gm]=e)},getTraceFlags:function(){return n[pm]},setTraceFlags:function(e){t&&t.setTraceFlags(e),n[pm]=e}}),I},e.setTraceCtx=function(e){I=e||null},e.addUnloadHook=z,gv(e,"addUnloadCb",function(){return v},"add"),e.onCfgChange=function(r){var o,i,a,s;return n?o=Iy(t.cfg,r,e[hf]):((s=aI(i=w,a=r).l)||(s={w:a,rm:function(){var e=aI(i,a);-1!==e.i&&i[ff](e.i,1)}},i[pf](s)),o=s),function(e){return _h({rm:function(){e.rm()}},"toJSON",{v:function(){return"aicore::onCfgChange<"+JSON.stringify(e)+">"}})}(o)},e.getWParam=function(){return Tg()||t.cfg.enableWParam?0:-1}})}return e.__ieDyn=1,e}(),lI="",uI="&NoResponseBody=true",dI="POST",hI=function(){function e(){var t,n,r,o,i,a,s,c,l,u,d,h,g,p=0;Xp(e,this,function(e,f){var m=!0;function v(e,t){Ky(r,2,26,"Failed to send telemetry.",{message:e}),C(t,400,{})}function y(e){v("No endpoint url is provided for the batch",e)}function C(e,t,n,r){try{e&&e(t,n,r)}catch(e){}}function I(e,t){var n=_g(),r=e[sm];if(!r)return y(t),!0;r=e[sm]+(h?uI:lI);var i=e[rm],a=o?i:new Blob([i],{type:"text/plain;charset=UTF-8"});return n.sendBeacon(r,a)}function k(e,t,n){var a=e[rm];try{if(a)if(I(e,t))C(t,200,{},lI);else{var c=i&&i.beaconOnRetry;c&&Wd(c)?c(e,t,I):(s&&s[cm](e,t,!0),Ky(r,2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}catch(e){o&&$y(r,"Failed to send telemetry using sendBeacon API. Ex:"+sh(e)),C(t,o?0:400,{},lI)}}function w(e,n,r){var a,s,c,l=e[lm]||{};!r&&t&&(a=xm(function(e,t){s=e,c=t})),o&&r&&e.disableXhrSync&&(r=!1);var u=e[sm];if(!u)return y(n),void(s&&s(!1));var d=function(e,t,n,r,o,i){function a(e,t,n){try{e[t]=n}catch(e){}}void 0===r&&(r=!1),void 0===o&&(o=!1);var s=new XMLHttpRequest;return r&&a(s,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",r),n&&a(s,Cv,n),s.open(e,t,!o),n&&a(s,Cv,n),!o&&i&&a(s,"timeout",i),s}(dI,u,m,!0,r,e[um]);function h(t){var r=i&&i.xhrOnComplete;if(r&&Wd(r))r(t,n,e);else{var a=mv(t);C(n,t[Zf],kv(t,o),a)}}return o||d[dm]("Content-type","application/json"),vh(Dh(l),function(e){d[dm](e,l[e])}),d.onreadystatechange=function(){o||(h(d),4===d.readyState&&s&&s(!0))},d.onload=function(){o&&h(d)},d.onerror=function(e){C(n,o?d[Zf]:400,kv(d,o),o?lI:vv(d)),c&&c(e)},d.ontimeout=function(){C(n,o?d[Zf]:500,kv(d,o),o?lI:vv(d)),s&&s(!1)},d.send(e[rm]),a}function T(e,n,r){var a,s,c,l,u=e[sm],d=e[rm],f=o?d:new Blob([d],{type:"application/json"}),v=new Headers,I=d[of],k=!1,w=!1,T=e[lm]||{},A=((a={method:dI,body:f})[Ty]=!0,a);e.headers&&Dh(e.headers)[of]>0&&(vh(Dh(T),function(e){v.append(e,T[e])}),A[lm]=v),m&&o&&(A.credentials="include"),r&&(A.keepalive=!0,p+=I,o?2===e._sendReason&&(k=!0,h&&(u+=uI)):k=!0);var b=new Request(u,A);try{b[Ty]=!0}catch(e){}if(!r&&t&&(s=xm(function(e,t){c=e,l=t})),!u)return y(n),void(c&&c(!1));function S(e){C(n,o?0:400,{},o?lI:e)}function R(e,t,r){var o=e[Zf],a=i.fetchOnComplete;a&&Wd(a)?a(e,n,r||lI,t):C(n,o,{},r||lI)}try{vm(fetch(o?u:b,o?A:null),function(t){if(r&&(p-=I,I=0),!w)if(w=!0,t.rejected)S(t.reason&&t.reason[Uf]),l&&l(t.reason);else{var n=t.value;try{o||n.ok?o&&!n.body?(R(n,null,lI),c&&c(!0)):vm(n.text(),function(t){R(n,e,t.value),c&&c(!0)}):(S(n.statusText),c&&c(!1))}catch(e){S(sh(e)),l&&l(e)}}})}catch(e){w||(S(sh(e)),l&&l(e))}return k&&!w&&(w=!0,C(n,200,{}),c&&c(!0)),o&&!w&&e[um]>0&&g&&g.set(function(){w||(w=!0,C(n,500,{}),c&&c(!0))},e[um]),s}function A(e,t,n){var a=bg(),s=new XDomainRequest,c=e[rm];s.onload=function(){var n=mv(s),r=i&&i.xdrOnComplete;r&&Wd(r)?r(s,t,e):C(t,200,{},n)},s.onerror=function(){C(t,400,{},o?lI:function(e,t){return e?"XDomainRequest,Response:"+mv(e)||"":t}(s))},s.ontimeout=function(){C(t,500,{})},s.onprogress=function(){};var l=a&&a.location&&a.location[Qf]||"",u=e[sm];if(u){if(!o&&0!==u.lastIndexOf(l,0)){var d="Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol.";return Ky(r,2,40,". "+d),void v(d,t)}var h=o?u:u[Jf](/^(https?:)/,"");s.open(dI,h),e[um]&&(s[um]=e[um]),s.send(c),o&&n?g&&g.set(function(){s.send(c)},0):s.send(c)}else y(t)}function b(){p=0,n=!1,t=!1,r=null,o=null,i=null,a=null,s=null,c=!1,l=!1,u=!1,d=!1,h=!1,g=null}b(),e[yf]=function(t,o){r=o,n&&Ky(r,1,28,"Sender is already initialized"),e.SetConfig(t),n=!0},e._getDbgPlgTargets=function(){return[n,o,a,t]},e.SetConfig=function(e){try{if(i=e.senderOnCompleteCallBack||{},a=!!e.disableCredentials,o=!!e.isOneDs,t=!!e.enableSendPromise,c=!!e.disableXhr,l=!!e.disableBeacon,u=!!e.disableBeaconSync,g=e.timeWrapper,h=!!e.addNoResponse,d=!!e.disableFetchKeepAlive,s={sendPOST:w},o||(m=!1),a){var n=_v();n&&n.protocol&&"file:"===n.protocol[nf]()&&(m=!1)}return!0}catch(e){}return!1},e.getSyncFetchPayload=function(){return p},e.getSenderInst=function(e,t){return e&&e[of]?function(e,t){var n,r=0,o=null,i=0;for(;null==o&&i<e[of];)r=e[i],c||1!==r?2!==r||!Nv(t)||t&&d?3!==r||!Ov()||(t?u:l)||(o=k):o=T:Bv()?o=A:xv()&&(o=w),i++;if(o)return(n={_transport:r,_isSync:t})[cm]=o,n;return null}(e,t):null},e.getFallbackInst=function(){return s},e[zf]=function(e,t){b()}})}return e.__ieDyn=1,e}(),gI="attachEvent",pI="addEventListener",fI="detachEvent",mI="removeEventListener",vI="events",yI="visibilitychange",CI="pagehide",II="pageshow",kI="unload",wI="beforeunload",TI=Yv("aiEvtPageHide"),AI=Yv("aiEvtPageShow"),bI=/\.[\.]+/g,SI=/[\.]+$/,RI=1,EI=Xv("events"),_I=/^([^.]*)(?:\.(.+)|)/;function PI(e){return e&&e[Jf]?e[Jf](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Um):e}function MI(e,t){var n;if(t){var r=Um;Jd(t)?(r=Um,vh(t,function(e){(e=PI(e))&&("."!==e[0]&&(e="."+e),r+=e)})):r=PI(t),r&&("."!==r[0]&&(r="."+r),e=(e||Um)+r)}var o=_I.exec(e||Um)||[];return(n={})[Yf]=o[1],n.ns=(o[2]||Um).replace(bI,".").replace(SI,Um)[Wf](".").sort().join("."),n}function qI(e,t,n){void 0===n&&(n=!0);var r=EI.get(e,vI,{},n),o=r[t];return o||(o=r[t]=[]),o}function OI(e,t,n,r){e&&t&&t[Yf]&&(e[mI]?e[mI](t[Yf],n,r):e[fI]&&e[fI]("on"+t[Yf],n))}function NI(e,t,n,r){for(var o=t[of];o--;){var i=t[o];i&&(n.ns&&n.ns!==i.evtName.ns||r&&!r(i)||(OI(e,i.evtName,i[Xf],i.capture),t[ff](o,1)))}}function BI(e,t){return t?MI("xx",Jd(t)?[e].concat(t):[e,t]).ns[Wf]("."):e}function xI(e,t,n,r,o){var i;void 0===o&&(o=!1);var a=!1;if(e)try{var s=MI(t,r);if(a=function(e,t,n,r){var o=!1;return e&&t&&t[Yf]&&n&&(e[pI]?(e[pI](t[Yf],n,r),o=!0):e[gI]&&(e[gI]("on"+t[Yf],n),o=!0)),o}(e,s,n,o),a&&EI.accept(e)){var c=((i={guid:RI++,evtName:s})[Xf]=n,i.capture=o,i);qI(e,s.type)[pf](c)}}catch(e){}return a}function LI(e,t,n,r,o){if(void 0===o&&(o=!1),e)try{var i=MI(t,r),a=!1;!function(e,t,n){if(t[Yf])NI(e,qI(e,t[Yf]),t,n);else{var r=EI.get(e,vI,{});mh(r,function(r,o){NI(e,o,t,n)}),0===Dh(r)[of]&&EI.kill(e,vI)}}(e,i,function(e){return!((!i.ns||n)&&e[Xf]!==n)&&(a=!0,!0)}),a||OI(e,i,n,o)}catch(e){}}function DI(e,t,n,r){var o=!1;return t&&e&&e[of]>0&&vh(e,function(e){e&&(n&&-1!==Fg(n,e)||(o=function(e,t,n){var r=!1,o=bg();o&&(r=xI(o,e,t,n),r=xI(o.body,e,t,n)||r);var i=Ag();return i&&(r=xI(i,e,t,n)||r),r}(e,t,r)||o))}),o}function UI(e,t,n){e&&Jd(e)&&vh(e,function(e){e&&function(e,t,n){var r=bg();r&&(LI(r,e,t,n),LI(r.body,e,t,n));var o=Ag();o&&LI(o,e,t,n)}(e,t,n)})}function HI(e,t,n){return function(e,t,n,r){var o=!1;return t&&e&&Jd(e)&&!(o=DI(e,t,n,r))&&n&&n[of]>0&&(o=DI(e,t,null,r)),o}([wI,kI,CI],e,t,n)}function FI(e,t,n){var r=BI(TI,n),o=DI([CI],e,t,r);return t&&-1!==Fg(t,yI)||(o=DI([yI],function(t){var n=Ag();e&&n&&"hidden"===n.visibilityState&&e(t)},t,r)||o),!o&&t&&(o=FI(e,null,n)),o}function zI(e,t,n){var r=BI(AI,n),o=DI([II],e,t,r);return!(o=DI([yI],function(t){var n=Ag();e&&n&&"visible"===n.visibilityState&&e(t)},t,r)||o)&&t&&(o=zI(e,null,n)),o}var KI,$I="",GI="version",QI="properties",jI="initialize",WI="logger",VI="timings",JI="pollInternalLogs",YI="value",XI="kind",ZI="length",ek="processTelemetryStart",tk="1DS-Web-JS-4.2.1",nk=hd.hasOwnProperty,rk=((KI={})[0]=0,KI[2]=6,KI[1]=1,KI[3]=7,KI[4098]=6,KI[4097]=1,KI[4099]=7,KI);function ok(e){return!(e===$I||$d(e))}function ik(e){return!!(e&&Xd(e)&&e>=1&&e<=4)}function ak(e,t,n){if(!t&&!ok(t)||"string"!=typeof e)return null;var r=typeof t;if("string"===r||"number"===r||"boolean"===r||Jd(t))t={value:t};else if("object"!==r||nk.call(t,"value")){if($d(t[YI])||t[YI]===$I||!jd(t[YI])&&!Xd(t[YI])&&!Zd(t[YI])&&!Jd(t[YI]))return null}else t={value:n?JSON.stringify(t):t};if(Jd(t[YI])&&!(t[YI][ZI]>0))return null;if(!$d(t[XI])){if(Jd(t[YI])||!function(e){if(0===e||e>0&&e<=13||32===e)return!0;return!1}(t[XI]))return null;t[YI]=t[YI].toString()}return t}function sk(e,t,n){var r=-1;if(!Kd(e))if(t>0&&(32===t?r=8192:t<=13&&(r=t<<5)),function(e){if(e>=0&&e<=9)return!0;return!1}(n))-1===r&&(r=0),r|=n;else{var o=rk[gk(e)]||-1;-1!==r&&-1!==o?r|=o:6===o&&(r=o)}return r}function ck(e,t,n){var r;return void 0===n&&(n=!0),e&&(r=e.get(t),n&&r&&decodeURIComponent&&(r=decodeURIComponent(r))),r||$I}function lk(e){void 0===e&&(e="D");var t=EC();return"B"===e?t="{"+t+"}":"P"===e?t="("+t+")":"N"===e&&(t=t.replace(/-/g,$I)),t}function uk(e,t,n,r,o){var i={},a=!1,s=0,c=arguments[ZI],l=arguments;for(Zd(l[0])&&(a=l[0],s++);s<c;s++){mh(l[s],function(e,t){a&&t&&Vd(t)?Jd(t)?(i[e]=i[e]||[],vh(t,function(t,n){t&&Vd(t)?i[e][n]=uk(!0,i[e][n],t):i[e][n]=t})):i[e]=uk(!0,i[e],t):i[e]=t})}return i}var dk=function(){return og()};function hk(e,t){var n=e;n[VI]=n[VI]||{},n[VI][ek]=n[VI][ek]||{},n[VI][ek][t]=dk()}function gk(e){var t=0;if(null!=e){var n=typeof e;"string"===n?t=1:"number"===n?t=2:"boolean"===n?t=3:n===cd&&(t=4,Jd(e)?(t=4096,e[ZI]>0&&(t|=gk(e[0]))):nk.call(e,"value")&&(t=8192|gk(e[YI])))}return t}function pk(e){return e>0}var fk=Hh({endpointUrl:"https://browser.events.data.microsoft.com/OneCollector/1.0/",propertyStorageOverride:{isVal:function(e){!e||e.getProperty&&e.setProperty||ch("Invalid property storage override passed.");return!0}}});var mk,vk=function(e){function t(){var n=e.call(this)||this;return Xp(t,n,function(e,t){e[jI]=function(n,r,o,i){RC(e,function(){return"AppInsightsCore.initialize"},function(){try{t[jI](Cy(n,fk,o||e[WI],!1).cfg,r,o,i)}catch(t){var a=e[WI],s=sh(t);-1!==s.indexOf("channels")&&(s+="\n - Channels must be provided through config.channels only!"),Ky(a,1,514,"SDK Initialization Failed - no telemetry will be sent: "+s)}},function(){return{config:n,extensions:r,logger:o,notificationManager:i}})},e.track=function(n){RC(e,function(){return"AppInsightsCore.track"},function(){var r=n;if(r){r[VI]=r[VI]||{},r[VI].trackStart=dk(),ik(r.latency)||(r.latency=1);var o=r.ext=r.ext||{};o.sdk=o.sdk||{},o.sdk.ver=tk;var i=r.baseData=r.baseData||{};i[QI]=i[QI]||{};var a=i[QI];a[GI]=a[GI]||e.pluginVersionString||$I}t.track(r)},function(){return{item:n}},!n.sync)},e[JI]=function(e){return t[JI](e||"InternalLog")}}),n}return Ip(t,e),t.__ieDyn=1,t}(cI),yk="locale",Ck="ver",Ik="name",kk=ef({UserExt:[0,"user"],DeviceExt:[1,"device"],TraceExt:[2,"trace"],WebExt:[3,"web"],AppExt:[4,"app"],OSExt:[5,"os"],SdkExt:[6,"sdk"],IntWebExt:[7,"intweb"],UtcExt:[8,"utc"],LocExt:[9,"loc"],CloudExt:[10,"cloud"],DtExt:[11,"dt"]}),wk=ef({id:[0,"id"],ver:[1,Ck],appName:[2,Ik],locale:[3,yk],expId:[4,"expId"],env:[5,"env"]}),Tk=ef({domain:[0,"domain"],browser:[1,"browser"],browserVer:[2,"browserVer"],screenRes:[3,"screenRes"],userConsent:[4,"userConsent"],consentDetails:[5,"consentDetails"]}),Ak=ef({locale:[0,yk],localId:[1,"localId"],id:[2,"id"]}),bk=ef({osName:[0,Ik],ver:[1,Ck]}),Sk=ef({ver:[0,Ck],seq:[1,"seq"],installId:[2,"installId"],epoch:[3,"epoch"]}),Rk=ef({msfpc:[0,"msfpc"],anid:[1,"anid"],serviceName:[2,"serviceName"]}),Ek=ef({popSample:[0,"popSample"],eventFlags:[1,"eventFlags"]}),_k=ef({tz:[0,"tz"]}),Pk=ef({sessionId:[0,"sesId"]}),Mk=ef({localId:[0,"localId"],deviceClass:[1,"deviceClass"],make:[2,"make"],model:[3,"model"]}),qk=ef({role:[0,"role"],roleInstance:[1,"roleInstance"],roleVer:[2,"roleVer"]}),Ok=ef({traceId:[0,"traceID"],traceName:[1,Ik],parentId:[2,"parentID"]}),Nk=ef({traceId:[0,"traceId"],spanId:[1,"spanId"],traceFlags:[2,"traceFlags"]});function Bk(){return void 0===mk&&(mk=!!Lk(0)),mk}function xk(){return Bk()?Lk(0):null}function Lk(e){var t,n,r=null;try{var o=kg();if(!o)return null;n=new Date,(r=0===e?o.localStorage:o.sessionStorage)&&Wd(r.setItem)&&(r.setItem(n,n),t=r.getItem(n)!==n,r.removeItem(n),t&&(r=null))}catch(e){r=null}return r}
/**
    * Session.ts
    * @copyright Microsoft 2019
    */
function Dk(){return this.getId()}function Uk(e){this.setId(e)}var Hk=function(){function e(){Xp(e,this,function(e){e.setId=function(t){e.customId=t},e.getId=function(){return jd(e.customId)?e.customId:e.automaticId}})}return e._staticInit=void _h(e.prototype,"id",{g:Dk,s:Uk}),e}(),Fk="ai_session",zk=function(){function e(t,n,r){var o,i,a,s=Dy(t),c=lC(t);Xp(e,this,function(t){var l=Iy(n,function(){a=n,t.config=a});function u(e){var n=t.automaticSession,r=e.split("|");r.length>0&&n.setId(r[0]);try{if(r.length>1){var o=+r[1];n.acquisitionDate=+new Date(o),n.acquisitionDate=n.acquisitionDate>0?n.acquisitionDate:0}if(r.length>2){var i=+r[2];n.renewalDate=+new Date(i),n.renewalDate=n.renewalDate>0?n.renewalDate:0}}catch(e){Ky(s,1,510,"Error parsing ai_session cookie, session will be reset: "+e)}0===n.renewalDate&&Ky(s,2,517,"AI session renewal date is 0, session will be reset.")}function d(){var e=t.automaticSession,n=(new Date).getTime(),r=t.config.sessionAsGuid;!Kd(r)&&r?Zd(r)?e.setId(lk()):e.setId(lk(r)):e.setId(Qv(a.idLength||22)),e.acquisitionDate=n,e.renewalDate=n,h(e.getId(),e.acquisitionDate,e.renewalDate),Bk()||Ky(s,2,505,"Browser does not support local storage. Session durations will be inaccurate.")}function h(e,n,r){var a=n+t.config.sessionExpirationMs,s=r+t.config.sessionRenewalMs,l=new Date,u=[e,n,r];a<s?l.setTime(a):l.setTime(s);var d=t.config.cookieDomain||null;c.set(i(),u.join("|")+";expires="+l.toUTCString(),null,d),o=(new Date).getTime()}r&&r.add(l),i=function(){return t.config.namePrefix?Fk+t.config.namePrefix:Fk},t.automaticSession=new Hk,t.update=function(){t.automaticSession.getId()||function(){var e=c.get(i());if(e&&Wd(e.split))u(e);else{var n=function(e,t){var n=xk();if(null!==n)try{return n.getItem(t)}catch(t){mk=!1,Ky(e,1,503,"Browser failed read of local storage. "+t)}return null}(s,i());n&&u(n)}t.automaticSession.getId()||d()}();var n=t.automaticSession,r=t.config,a=(new Date).getTime(),l=a-n.acquisitionDate>r.sessionExpirationMs,g=a-n.renewalDate>r.sessionRenewalMs;if(l||g)d();else{(!o||a-o>e.cookieUpdateInterval)&&(n.renewalDate=a,h(n.getId(),n.acquisitionDate,n.renewalDate))}},t.backup=function(){var e,n,r,o=t.automaticSession;e=o.getId(),n=o.acquisitionDate,r=o.renewalDate,function(e,t,n){var r=xk();if(null!==r)try{return r.setItem(t,n),!0}catch(t){mk=!1,Ky(e,1,504,"Browser failed write to local storage. "+t)}}(s,i(),[e,n,r].join("|"))}})}return e.cookieUpdateInterval=6e4,e}(),Kk=["AX","EX","SF","CS","CF","CT","CU","DC","DF","H5","HL","WS","WP"];
/**
    * SessionManager.ts
    * @author Hector Hernandez (hectorh)
    * @copyright Microsoft 2019
    */function $k(e,t){void 0===t&&(t=Kk);var n=null;if(e)for(var r=e.split(","),o=0;o<r.length;o++)Gk(r[o],t)&&(n?n+=","+r[o]:n=r[o]);return n}function Gk(e,t){if(void 0===t&&(t=Kk),!e||e.length<4)return!1;for(var n=!1,r=e.substring(0,3).toString().toUpperCase(),o=0;o<t.length;o++)if(t[o]+":"===r&&e.length<=256){n=!0;break}return n}function Qk(){return this.getExpId()}var jk=function(){function e(t,n,r){var o,i=null,a=Kk.slice(0),s="Treatments",c=null;Xp(e,this,function(e){var l,u;if(u=Iy(l=t,function(){o=n&&n.getCookieMgr(),c=l||{},e.env=c.env||function(e){var t,n={},r=Ag();if(r){t=r&&r.querySelectorAll("meta");for(var o=0;o<t.length;o++){var i=t[o];i.name&&0===i.name.toLowerCase().indexOf(e)&&(n[i.name.replace(e,"")]=i.content)}}return n}("awa-").env}),r&&r.add(u),Tg()){var d=Ag().documentElement;d&&(e.locale=d.lang)}function h(e){e!==i&&(i=$k(e,a))}e.getExpId=function(){return c.expId?(h(c.expId),i):(h(ck(o,s)),i)}})}return e.validateAppExpId=$k,e._staticInit=void _h(e.prototype,"expId",{g:Qk}),e}(),Wk=function(){},Vk=function(){};
/**
    * Cloud.ts
    * @author Hector Hernandez (hectorh)
    * @copyright Microsoft 2020
    */
/**
    * IntWeb.ts
    * @author Hector Hernandez (hectorh)
    * @copyright Microsoft 2019
    */
function Jk(){return this.getMsfpc()}function Yk(){return this.getAnid()}var Xk=function(){function e(t,n,r){var o;Xp(e,this,function(e){var i,a;a=Iy(i=t,function(){o=n&&n.getCookieMgr();var t=i||{};t.serviceName&&(e.serviceName=t.serviceName)}),r&&r.add(a),e.getMsfpc=function(){return ck(o,"MSFPC")},e.getAnid=function(){return ck(o,"ANON").slice(0,34)}})}var t;return e._staticInit=(_h(t=e.prototype,"msfpc",{g:Jk}),void _h(t,"anid",{g:Yk})),e}(),Zk=function(){var e=(new Date).getTimezoneOffset(),t=e%60,n=(e-t)/60,r="+";n>0&&(r="-"),n=Math.abs(n),t=Math.abs(t),this.tz=r+(n<10?"0"+n:n.toString())+":"+(t<10?"0"+t:t.toString())},ew={WIN:/(windows|win32)/i,WINRT:/ arm;/i,WINPHONE:/windows\sphone\s\d+\.\d+/i,OSX:/(macintosh|mac os x)/i,IOS:/(ipad|iphone|ipod)(?=.*like mac os x)/i,LINUX:/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,ANDROID:/android/i,CROS:/CrOS/i},tw={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},nw="([\\d,_,.]+)",rw="Unknown",ow=[{r:ew.WINPHONE,os:"Windows Phone"},{r:ew.WINRT,os:"Windows RT"},{r:ew.WIN,os:"Windows"},{r:ew.IOS,os:"iOS"},{r:ew.ANDROID,os:"Android"},{r:ew.LINUX,os:"Linux"},{r:ew.CROS,os:"Chrome OS"},{s:"x11",os:"Unix"},{s:"blackberry",os:"BlackBerry"},{s:"symbian",os:"Symbian"},{s:"nokia",os:"Nokia"},{r:ew.OSX,os:"Mac OS X"}];
/**
    * Loc.ts
    * @author Hector Hernandez (hectorh)
    * @copyright Microsoft 2019
    */function iw(e,t){return"Windows"===t?aw(e,"Windows NT"):"Android"===t?aw(e,t):"Mac OS X"===t?function(e){var t=e.match(new RegExp("Mac OS X "+nw));if(t){var n=t[1].replace(/_/g,".");if(n){var r=sw(n);return r?n.split(r)[0]:n}}return rw}(e):"iOS"===t?function(e){var t=e.match(new RegExp("OS "+nw));if(t){var n=t[1].replace(/_/g,".");if(n){var r=sw(n);return r?n.split(r)[0]:n}}return rw}(e):rw}function aw(e,t){var n=e.match(new RegExp(t+" ([\\d,.]+)"));return n?tw[n[1]]?tw[n[1]]:n[1]:rw}function sw(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null}var cw=function(e,t){var n=null,r=null,o=null,i=null,a=Iy(e,function(){if((e||{}).populateOperatingSystemInfo){var t=_g()||{},o=e.userAgent||t.userAgent||"",i=(e.userAgentData||{}).platform||(t.userAgentData||{}).platform;if(o){var a=function(e){for(var t=0;t<ow.length;t++){var n=ow[t];if(n.r&&e.match(n.r))return n.os;if(n.s&&-1!==e.indexOf(n.s))return n.os}return rw}(o.toLowerCase());n=a,r=iw(o,a)}n&&n!==rw||!jd(i)||(n=i)}});t&&t.add(a),_h(this,"name",{s:function(e){o=e},g:function(){return o||n}}),_h(this,"ver",{s:function(e){i=e},g:function(){return i||r}})},lw="MicrosoftApplicationsTelemetryDeviceId";
/**
    * Sdk.ts
    * @author Hector Hernandez (hectorh)
    * @copyright Microsoft 2019
    */var uw=function(){function e(t,n,r){var o,i=0;Xp(e,this,function(e){e.seq=i,e.epoch=Gv(!1).toString(),e.getSequenceId=function(){return++i};var a=Iy(t,function(t){o=n&&n.getCookieMgr();var r=t.cfg.propertyStorageOverride;if(o.isEnabled()||r){var i=function(e,t,n){return t?t.getProperty(n)||"":ck(e,n)}(o,r,lw);i||(i=EC()),function(e,t,n,r){t?t.setProperty(n,r):e.set(n,r,31536e3)}(o,r,lw,i),e.installId=i}else o.purge(lw)});r&&r.add(a)})}return e.__ieDyn=1,e}(),dw=function(e,t,n,r,o){var i=this;i.traceId=t||_C();var a=Iy(e,function(){var t=e;if(t.enableDistributedTracing&&!n&&(n=_C().substring(0,16)),i.parentId=i.parentId||n,t.enableApplicationInsightsTrace&&!r){var o=_v();o&&o.pathname&&(r=o.pathname)}i.name=i.name||r});o&&o.add(a)},hw="setLocalId";
/**
    * AITrace.ts
    * @author Hector Hernandez (hectorh)
    * @copyright Microsoft 2019
    */function gw(){return this.getLocalId()}function pw(e){this[hw](e)}var fw=function(){function e(t,n,r,o){var i,a,s;Xp(e,this,function(c){var l,u;if(u=Iy(l=n,function(){if(s=r&&r.getCookieMgr(),i=l,a=null,s&&s.isEnabled()&&(h(),i.enableApplicationInsightsUser)){var n=ck(s,e.userCookieName);if(n){var o=n.split(e.cookieSeparator);o.length>0&&(c.id=o[0])}if(!c.id){c.id=Qv(t&&!Kd(t.idLength)?t.idLength:22);var u=uv(new Date);c.accountAcquisitionDate=u;var d=[c.id,u],g=i.cookieDomain?i.cookieDomain:void 0;s.set(e.userCookieName,d.join(e.cookieSeparator),31536e3,g)}}}),o&&o.add(u),"undefined"!=typeof navigator){var d=navigator;c.locale=d.userLanguage||d.language}function h(){if(!i.hashIdentifiers&&!i.dropIdentifiers){var e=ck(s,"MUID");e&&(a="t:"+e)}return a}c.getLocalId=function(){return a||h()},c[hw]=function(e){a=e}})}return e.cookieSeparator="|",e.userCookieName="ai_user",e._staticInit=void _h(e.prototype,"localId",{g:gw,s:pw}),e}(),mw=function(e,t){var n=this;n.popSample=100;var r=Iy(e,function(){n.eventFlags=0,e.hashIdentifiers&&(n.eventFlags=1048576|n.eventFlags),e.dropIdentifiers&&(n.eventFlags=2097152|n.eventFlags),e.scrubIpOnly&&(n.eventFlags=4194304|n.eventFlags)});t&&t.add(r)},vw=["Required","Analytics","SocialMedia","Advertising"],yw="([\\d,.]+)",Cw="Unknown",Iw="Edg/",kw=[{ua:"OPR/",b:"Opera"},{ua:"PhantomJS",b:"PhantomJS"},{ua:"Edge",b:"Edge"},{ua:Iw,b:"Edge"},{ua:"Electron",b:"Electron"},{ua:"Chrome",b:"Chrome"},{ua:"Trident",b:"MSIE"},{ua:"MSIE ",b:"MSIE"},{ua:"Firefox",b:"Firefox"},{ua:"Safari",b:"Safari"},{ua:"SkypeShell",b:"SkypeShell"}],ww=[{br:"Microsoft Edge",b:"Edge"},{br:"Google Chrome",b:"Chrome"},{br:"Opera",b:"Opera"}];
/**
    * Utc.ts
    * @author Hector Hernandez (hectorh)
    * @copyright Microsoft 2019
    */function Tw(e,t){return t.indexOf(e)>-1}function Aw(e,t){for(var n=0;n<t.length;n++)if(e==t[n].brand)return t[n].version;return null}function bw(e,t){return"MSIE"===t?function(e){var t=e.match(new RegExp("MSIE "+yw));if(t)return t[1];var n=e.match(new RegExp("rv:"+yw));if(n)return n[1]}(e):function(e,t){"Safari"===e?e="Version":"Edge"===e&&Tw(Iw,t)&&(e="Edg");var n=t.match(new RegExp(e+"/"+yw));if(n)return n[1];if("Opera"===e&&(n=t.match(new RegExp("OPR/"+yw))))return n[1];return Cw}(t,e)}function Sw(){return this.getUserConsent()}var Rw=function(){function e(t,n,r){var o=lC(n),i=t||{},a=null,s=null,c=null,l=null,u=null,d=null,h=null;Xp(e,this,function(e){var n,g;g=Iy(n=t,function(){if((i=n).populateBrowserInfo){var e=i.userAgent,t=(i.userAgentData||{}).brands;if(e!==a||t!==s){if(!e||!t||0===t.length){var r=_g();r&&(e=e||r.userAgent||"",t=t||(r.userAgentData||{}).brands)}!function(e,t){if(Jd(t))try{for(var n=0;n<ww.length;n++){var r=Aw(ww[n].br,t);if(r)return u=ww[n].b,void(d=r)}}catch(e){}if(e){var o=function(e){if(e)for(var t=0;t<kw.length;t++)if(Tw(kw[t].ua,e))return kw[t].b;return Cw}(e);u=o,d=bw(e,o)}}(e,t),a=e,s=t}}h=Zd(i.gpcDataSharingOptIn)?i.gpcDataSharingOptIn:null}),r&&r.add(g);var p=_v();if(p){var f=p.hostname;f&&(e.domain="file:"===p.protocol?"local":f)}var m=function(){var e={h:0,w:0},t=bg();return t&&t.screen&&(e.h=screen.height,e.w=screen.width),e}();e.screenRes=m.w+"X"+m.h,e.getUserConsent=function(){return i.userConsented||!!ck(o,i.userConsentCookieName||"MSCC")},e.getUserConsentDetails=function(){var e=null;try{var t=i.callback;if(t&&t.userConsentDetails){var n=t.userConsentDetails();if(n){e=i.disableConsentDetailsSanitize?n:{};for(var r=0;r<vw.length;r++){var o=vw[r];e[o]=n[o]||!1}}}return null!==h&&((e=e||{}).GPC_DataSharingOptIn=!!h),e?JSON.stringify(e):null}catch(e){}};Ph(e,{userConsent:{g:e.getUserConsent},browser:{s:function(e){c=e},g:function(){return c||u}},browserVer:{s:function(e){l=e},g:function(){return l||d}},gpcDataSharingOptIn:{g:function(){return h},s:function(e){h=Zd(e)?e:null,i.gpcDataSharingOptIn=h}}})})}return e._staticInit=void _h(e.prototype,"userConsent",{g:Sw}),e}();
/**
    * TelemetryContext.ts
    * @author Hector Hernandez (hectorh)
    * @copyright Microsoft 2019
    */function Ew(e,t,n,r,o){var i=t.ext[kk[e]];if(i)try{mh(r,function(e,t){if(jd(t)||Xd(t)||Zd(t)){var r=i[n[e]];!o&&(r||jd(r)||Xd(r)||Zd(r))&&(t=r),i[n[e]]=t}})}catch(e){}return i}var _w,Pw=function(){function e(t,n,r,o){Xp(e,this,function(e){e.app=new jk(n,r,o),e.cloud=new Wk,e.user=new fw(t,n,r,o),e.os=new cw(n,o),e.web=new Rw(n,r,o);var i=new uw(t,r,o),a=new Xk(n,r,o),s=new mw(n,o);e.loc=new Zk,e.device=new Vk;var c=new zk(r,n,o);e.session=new Hk;var l,u,d,h=void 0,g=(l=new dw(n,h,h,h,o),u=m(),d=l||{},{getName:function(){return d.name},setName:function(e){u&&u.setName(e),d.name=e},getTraceId:function(){return d.traceId},setTraceId:function(e){u&&u.setTraceId(e),MC(e)&&(d.traceId=e)},getSpanId:function(){return d.parentId},setSpanId:function(e){u&&u.setSpanId(e),qC(e)&&(d.parentId=e)},getTraceFlags:function(){return d.traceFlags},setTraceFlags:function(e){u&&u.setTraceFlags(e),d.traceFlags=e}}),p=!(n||{}).eventContainExtFields;function f(){var t=e.session;if(t&&jd(t.customId))return t.customId;c.update();var n=c.automaticSession;if(n){var r=n.getId();r&&jd(r)&&(t.automaticId=r)}return t.automaticId}function m(){var e=g;return r&&r.getTraceCtx&&(e=r.getTraceCtx(!1)||g),e}e.getTraceCtx=function(){return g},e.getSessionId=f,e.applyApplicationContext=function(t){var n,r=e.app;Ew(4,t,wk,((n={})[0]=r.id,n[1]=r.ver,n[2]=r.name,n[3]=r.locale,n[4]=r.getExpId(),n[5]=r.env,n),p)},e.applyUserContext=function(t){var n,r=e.user;Ew(0,t,Ak,((n={})[1]=r.getLocalId(),n[0]=r.locale,n[2]=r.id,n),p)},e.applyWebContext=function(t){var n,r=e.web;Ew(3,t,Tk,((n={})[0]=r.domain,n[1]=r.browser,n[2]=r.browserVer,n[3]=r.screenRes,n[5]=r.getUserConsentDetails(),n[4]=r.getUserConsent(),n),p)},e.applyOsContext=function(t){var n,r=e.os;Ew(5,t,bk,((n={})[0]=r.name,n[1]=r.ver,n),p)},e.applySdkContext=function(e){var t;Ew(6,e,Sk,((t={})[2]=i.installId,t[1]=i.getSequenceId(),t[3]=i.epoch,t),p)},e.applyIntWebContext=function(e){var t;Ew(7,e,Rk,((t={})[0]=a.getMsfpc(),t[1]=a.getAnid(),t[2]=a.serviceName,t),p)},e.applyUtcContext=function(e){var t,n=((t={})[0]=s.popSample,t);s.eventFlags>0&&(n[1]=s.eventFlags),Ew(8,e,Ek,n,p)},e.applyLocContext=function(t){var n;Ew(9,t,_k,((n={})[0]=e.loc.tz,n),p)},e.applySessionContext=function(e){var t;Ew(4,e,Pk,((t={})[0]=f(),t),p)},e.applyDeviceContext=function(t){var n,r=e.device;Ew(1,t,Mk,((n={})[0]=r.localId,n[2]=r.make,n[3]=r.model,n[1]=r.deviceClass,n),p)},e.applyCloudContext=function(t){var n,r=e.cloud;Ew(10,t,qk,((n={})[0]=r.role,n[1]=r.roleInstance,n[2]=r.roleVer,n),p)},e.applyAITraceContext=function(e){var t;if(n.enableApplicationInsightsTrace){var r=m();r&&Ew(2,e,Ok,((t={})[0]=r.getTraceId(),t[1]=r.getName(),t[2]=r.getSpanId(),t),!1)}},e.applyDistributedTraceContext=function(e){var t,n=m();if(n){var r=((t={})[0]=n.getTraceId(),t[1]=n.getSpanId(),t),o=n.getTraceFlags();$d(o)||(r[2]=o),Ew(11,e,Nk,r,!1)}}})}return e.__ieDyn=1,e}();var Mw=[kk[4],kk[0],kk[3],kk[5],kk[6],kk[7],kk[8],kk[9],kk[1],kk[2],kk[11],kk[10]],qw=Hh({populateBrowserInfo:!1,populateOperatingSystemInfo:!1,userAgent:by(),userAgentData:Ay({brands:_w,mobile:_w,platform:_w}),userConsentCookieName:by(),userConsented:!1,serviceName:by(),env:by(),expId:by(),sessionRenewalMs:18e5,sessionExpirationMs:864e5,sessionAsGuid:null,cookieDomain:by(),namePrefix:by(),enableApplicationInsightsTrace:!1,enableApplicationInsightsUser:!1,hashIdentifiers:!1,dropIdentifiers:!1,scrubIpOnly:!1,callback:Ay({userConsentDetails:null}),gpcDataSharingOptIn:_w,idLength:22,enableDistributedTracing:!1,eventContainExtFields:!1}),Ow=function(e){function t(){var n,r,o,i=e.call(this)||this;return i.identifier="SystemPropertiesCollector",i.priority=3,i.version="4.2.1",Xp(t,i,function(e,t){function i(){n=null,r={}}i(),e.initialize=function(r,i,a){t.initialize(r,i,a),function(t){var r=e.identifier,i=e.core;e._addHook(Iy(t,function(){var e=KC(null,t,i);o=e.getExtCfg(r,qw)})),n=new Pw(t,o,i,e._unloadHooks),i&&i.setTraceCtx&&i.setTraceCtx(n.getTraceCtx())}(r)},e.processTelemetry=function(t,i){hk(t,e.identifier),i=e._getTelCtx(i);var a,s,c=t.ext=t.ext?t.ext:{};t.data=t.data?t.data:{},vh(Mw,function(e){c[e]=c[e]||{}}),n&&(n.applyUtcContext(t),n.applyApplicationContext(t),n.applyUserContext(t),n.applyWebContext(t),n.applyOsContext(t),n.applySdkContext(t),n.applyIntWebContext(t),n.applyLocContext(t),n.applySessionContext(t),n.applyDeviceContext(t),o.enableApplicationInsightsTrace&&n.applyAITraceContext(t),o.enableDistributedTracing&&n.applyDistributedTraceContext(t),n.applyCloudContext(t)),vh(Dh(c),function(e){0===Dh(c[e]).length&&delete c[e]}),a=r,s=t.data,a&&mh(a,function(e,t){s[e]||(s[e]=t)}),e.processNext(t,i)},e.getPropertiesContext=function(){return n},e.setProperty=function(e,t){r[e]=t},e._doTeardown=function(e,t){var r=(e||{}).core();if(r&&r.getTraceCtx&&n){var o=r.getTraceCtx(!1);o&&o===n.getTraceCtx()&&r.setTraceCtx(null)}i()},e._getDbgPlgTargets=function(){return[o]}}),i}return Ip(t,e),t.__ieDyn=1,t}(YC),Nw="REAL_TIME",Bw="NEAR_REAL_TIME",xw="BEST_EFFORT",Lw="",Dw="drop",Uw="send",Hw="requeue",Fw="rspFail",zw="no-cache, no-store",Kw="application/x-json-stream",$w="cache-control",Gw="content-type",Qw="kill-tokens",jw="kill-duration",Ww="time-delta-millis",Vw="client-version",Jw="client-id",Yw="time-delta-to-apply-millis",Xw="upload-time",Zw="apikey",eT="AuthMsaDeviceTicket",tT="WebAuthToken",nT="AuthXToken",rT="msfpc",oT="trace",iT="user",aT="allowRequestSending",sT="firstRequestSent",cT="shouldAddClockSkewHeaders",lT="getClockSkewHeaderValue",uT="setClockSkew",dT="length",hT="concat",gT="iKey",pT="count",fT="events",mT="push",vT="split",yT="splice",CT="toLowerCase",IT="hdrs",kT="useHdrs",wT="initialize",TT="setTimeoutOverride",AT="clearTimeoutOverride",bT="overrideEndpointUrl",ST="avoidOptions",RT="enableCompoundKey",ET="disableXhrSync",_T="disableFetchKeepAlive",PT="useSendBeacon",MT="alwaysUseXhrOverride",qT="serializeOfflineEvt",OT="getOfflineRequestDetails",NT="createPayload",BT="createOneDSPayload",xT="payloadBlob",LT="headers",DT="_thePayload",UT="urlString",HT="batches",FT="sendType",zT="addHeader",KT="canSendRequest",$T="sendQueuedRequests",GT="isCompletelyIdle",QT="setUnloading",jT="sendSynchronousBatch",WT="_transport",VT="getWParam",JT="isBeacon",YT="timings",XT="isTeardown",ZT="isSync",eA="data",tA="_sendReason",nA="setKillSwitchTenants",rA="_backOffTransmission",oA="identifier",iA="eventsLimitInMem",aA="autoFlushEventsLimit",sA="baseData",cA="sendAttempt",lA="latency",uA="sync";
/**
    * EventBatch.ts
    * @author Nev Wylie (newylie)
    * @copyright Microsoft 2020
    */
function dA(e){var t=(e.ext||{}).intweb;return t&&ok(t[rT])?t[rT]:null}function hA(e){for(var t=null,n=0;null===t&&n<e[dT];n++)t=dA(e[n]);return t}var gA=function(){function e(t,n){var r=n?[][hT](n):[],o=this,i=hA(r);o[gT]=function(){return t},o.Msfpc=function(){return i||Lw},o[pT]=function(){return r[dT]},o[fT]=function(){return r},o.addEvent=function(e){return!!e&&(r[mT](e),i||(i=dA(e)),!0)},o[vT]=function(n,o){var a;if(n<r[dT]){var s=r[dT]-n;$d(o)||(s=o<s?o:s),a=r[yT](n,s),i=hA(r)}return new e(t,a)}}return e.create=function(t,n){return new e(t,n)},e}(),pA=function(){function e(){var t=!0,n=!0,r=!0,o="use-collector-delta",i=!1;Xp(e,this,function(e){e[aT]=function(){return t},e[sT]=function(){r&&(r=!1,i||(t=!1))},e[cT]=function(){return n},e[lT]=function(){return o},e[uT]=function(e){i||(e?(o=e,n=!0,i=!0):n=!1,t=!0)}})}return e.__ieDyn=1,e}(),fA=function(){function e(){var t={};Xp(e,this,function(e){e[nA]=function(e,n){if(e&&n)try{var r=(a=e[vT](","),s=[],a&&vh(a,function(e){s[mT](Yg(e))}),s);if("this-request-only"===n)return r;for(var o=1e3*parseInt(n,10),i=0;i<r[dT];++i)t[r[i]]=og()+o}catch(e){return[]}var a,s;return[]},e.isTenantKilled=function(e){var n=t,r=Yg(e);return void 0!==n[r]&&n[r]>og()||(delete n[r],!1)}})}return e.__ieDyn=1,e}();
/**
    * ClockSkewManager.ts
    * @author Abhilash Panwar (abpanwar)
    * @copyright Microsoft 2018
    */function mA(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)}
/**
    * Serializer.ts
    * @author Abhilash Panwar (abpanwar); Hector Hernandez (hectorh); Nev Wylie (newylie)
    * @copyright Microsoft 2018-2020
    */var vA,yA=2e6,CA=Math.min(yA,65e3),IA="metadata",kA="f",wA=/\./,TA=function(){function e(t,n,r,o,i,a){var s="data",c="baseData",l=!!o,u=!0,d=n,h={},g=!!a,p=i||sk;Xp(e,this,function(e){function n(e,t,o,i,a,s,c){mh(e,function(e,u){var g=null;if(u||ok(u)){var p=o,f=e,m=a,v=t;if(l&&!i&&wA.test(e)){var y=e.split("."),C=y.length;if(C>1){m&&(m=m.slice());for(var I=0;I<C-1;I++){var k=y[I];v=v[k]=v[k]||{},p+="."+k,m&&m.push(k)}f=y[C-1]}}var w=i&&function(e){var t=h[e];return void 0===t&&(e.length>=7&&(t=dp(e,"ext.metadata")||dp(e,"ext.web")),h[e]=t),t}(p);if(g=!w&&d&&d.handleField(p,f)?d.value(p,f,u,r):ak(f,u,r)){var T=g.value;if(v[f]=T,s&&s(m,f,g),c&&"object"==typeof T&&!Jd(T)){var A=m;A&&(A=A.slice()).push(f),n(u,T,p+"."+f,i,A,s,c)}}}})}e.createPayload=function(e,t,n,r,o,i){return{apiKeys:[],payloadBlob:Lw,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:r,sendType:i,sendReason:o}},e.appendPayload=function(n,r,o){var i=n&&r&&!n.overflow;return i&&RC(t,function(){return"Serializer:appendPayload"},function(){for(var t=r.events(),i=n.payloadBlob,a=n.numEvents,s=!1,c=[],l=[],u=n.isBeacon,d=u?65e3:3984588,h=u?CA:yA,g=0,p=0;g<t.length;){var f=t[g];if(f){if(a>=o){n.overflow=r.split(g);break}var m=e.getEventBlob(f);if(m&&m.length<=h){var v=m.length;if(i.length+v>d){n.overflow=r.split(g);break}i&&(i+="\n"),i+=m,++p>20&&(Xh(i,0,1),p=0),s=!0,a++}else m?c.push(f):l.push(f),t.splice(g,1),g--}g++}if(c.length>0&&n.sizeExceed.push(gA.create(r.iKey(),c)),l.length>0&&n.failedEvts.push(gA.create(r.iKey(),l)),s){n.batches.push(r),n.payloadBlob=i,n.numEvents=a;var y=r.iKey();-1===Fg(n.apiKeys,y)&&n.apiKeys.push(y)}},function(){return{payload:n,theBatch:{iKey:r.iKey(),evts:r.events()},max:o}}),i},e.getEventBlob=function(e){try{return RC(t,function(){return"Serializer.getEventBlob"},function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+function(e){if(e){var t=up(e,"-");if(t>-1)return eg(e,t)}return $I}(e.iKey);var r,o={};g||(r=function(e,t,n){!function(e,t,n,r,o){if(o&&t){var i=e(o.value,o.kind,o.propertyType);if(i>-1){var a=t[IA];a||(a=t[IA]={f:{}});var s=a[kA];if(s||(s=a[kA]={}),n)for(var c=0;c<n.length;c++){var l=n[c];s[l]||(s[l]={f:{}});var u=s[l][kA];u||(u=s[l][kA]={}),s=u}s=s[r]={},Jd(o.value)?s.a={t:i}:s.t=i}}}
/**
    * TimeoutOverrideWrapper.ts
    * @author  Nev Wylie (newylie)
    * @copyright Microsoft 2022
    * Simple internal timeout wrapper
    */(p,o,e,t,n)});var i=e.ext;i&&(t.ext=o,mh(i,function(e,t){n(t,o[e]={},"ext."+e,!0,null,null,!0)}));var a=t[s]={};a.baseType=e.baseType;var l=a[c]={};return n(e.baseData,l,c,!1,[c],r,u),n(e.data,a,s,!1,[],r,u),JSON.stringify(t)},function(){return{item:e}})}catch(e){return null}}})}return e.__ieDyn=1,e}();function AA(e,t){return{set:function(n,r){for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];return function(e,t,n){return mp(!0,e,Ld[Rd](arguments,1))}([e,t],n,r,o)}}}var bA="sendAttempt",SA="?cors=true&"+Gw[CT]()+"="+Kw,RA=((vA={})[1]=Hw,vA[100]=Hw,vA[200]="sent",vA[8004]=Dw,vA[8003]=Dw,vA),EA={},_A={};function PA(e,t,n){EA[e]=t,!1!==n&&(_A[t]=e)}function MA(e,t){var n=!1;if(e&&t){var r=Dh(e);if(r&&r[dT]>0)for(var o=t[CT](),i=0;i<r[dT];i++){var a=r[i];if(a&&hh(t,a)&&a[CT]()===o){n=!0;break}}}return n}function qA(e,t,n,r){t&&n&&n[dT]>0&&(r&&EA[t]?(e[IT][EA[t]]=n,e[kT]=!0):e.url+="&"+t+"="+n)}PA(eT,eT,!1),PA(Vw,Vw),PA(Jw,"Client-Id"),PA(Zw,Zw),PA(Yw,Yw),PA(Xw,Xw),PA(nT,nT);var OA=function(){function e(t,n,r,o){var i,a,s,c,l,u,d,h,g,p,f,m,v,y,C,I,k,w,T,A,b,S,R,E,_,P,M,q,O,N,B,x=!1;Xp(e,this,function(e){!function(){var e;i=null,a=new fA,s=!1,c=new pA,x=!1,l=0,u=null,d=null,h=null,g=null,p=!0,f=[],m={},v=[],y=null,C=!1,I=null,k=!1,w=!1,T=e,A=e,b=e,S=e,R=e,E=[],_=e,P=e,M=[],q=!1,O=AA(),N=!1,B=null}();function L(e,t){try{return B&&B.getSenderInst(e,t)}catch(e){}return null}function D(e,t,n){var r=mv(e);F(t,200,{},r),ee(r)}function U(e,t,n,r){var o={},i=e[LT];i&&i.forEach(function(e,t){o[t]=e}),function(e,n,r){F(t,e,n,r),ee(r)}(e.status,o,n||Lw)}function H(e,t,n){var r=mv(e);F(t,e.status,kv(e,!0),r),ee(r)}function F(e,t,n,r){try{e(t,n,r)}catch(e){Ky(d,2,518,sh(e))}}function z(e,t,n){var r=200,o=e[DT],i=e[UT]+(R?"&NoResponseBody=true":Lw);try{var a=_g();if(o){var s=!!g.getPlugin("LocalStorage"),c=[],l=[];vh(o[HT],function(e){if(c&&e&&e[pT]()>0)for(var t=e[fT](),n=0;n<t[dT];n++){if(!a.sendBeacon(i,y.getEventBlob(t[n]))){c[mT](e[vT](n));break}l[mT](e[n])}else c[mT](e[vT](0))}),l[dT]>0&&(o.sentEvts=l),s||te(c,8003,o[FT],!0)}else r=0}catch(e){$y(d,"Failed to send telemetry using sendBeacon API. Ex:"+sh(e)),r=0}finally{F(t,r,{},Lw)}}function K(e){return 2===e||3===e}function $(e){return k&&K(e)&&(e=2),e}function G(){return!s&&l<n}function Q(){var e=v;return v=[],e}function j(e,t,n){var r=!1;return e&&e[dT]>0&&!s&&h[t]&&y&&(r=0!==t||G()&&(n>0||c[aT]())),r}function W(e){var t={};return e&&vh(e,function(e,n){t[n]={iKey:e[gT](),evts:e[fT]()}}),t}function V(e,n,r,o,i){if(e&&0!==e[dT])if(s)te(e,1,o);else{o=$(o);try{var c=e,l=0!==o;RC(g,function(){return"HttpManager:_sendBatches"},function(s){s&&(e=e.slice(0));for(var c=[],u=null,d=dk(),g=h[o]||(l?h[1]:h[0]),p=g&&g[WT],f=S&&(k||K(o)||3===p||g._isSync&&2===p);j(e,o,n);){var m=e.shift();m&&m[pT]()>0&&(a.isTenantKilled(m[gT]())?c[mT](m):(u=u||y[NT](n,r,l,f,i,o),y.appendPayload(u,m,t)?null!==u.overflow&&(e=[u.overflow][hT](e),u.overflow=null,X(u,d,dk(),i),d=dk(),u=null):(X(u,d,dk(),i),d=dk(),e=[m][hT](e),u=null)))}u&&X(u,d,dk(),i),e[dT]>0&&(v=e[hT](v)),te(c,8004,o)},function(){return{batches:W(c),retryCount:n,isTeardown:r,isSynchronous:l,sendReason:i,useSendBeacon:K(o),sendType:o}},!l)}catch(e){Ky(d,2,48,"Unexpected Exception sending batch: "+sh(e))}}}function J(e,t){var n={url:i,hdrs:{},useHdrs:!1};t?(n[IT]=uk(n[IT],m),n.useHdrs=Dh(n.hdrs)[dT]>0):mh(m,function(e,t){_A[e]?qA(n,_A[e],t,!1):(n[IT][e]=t,n[kT]=!0)}),qA(n,Jw,"NO_AUTH",t),qA(n,Vw,tk,t);var r=Lw;vh(e.apiKeys,function(e){r[dT]>0&&(r+=","),r+=e}),qA(n,Zw,r,t),qA(n,Xw,og().toString(),t);var o=function(e){for(var t=0;t<e.batches[dT];t++){var n=e[HT][t].Msfpc();if(n)return encodeURIComponent(n)}return Lw}(e);if(ok(o)&&(n.url+="&ext.intweb.msfpc="+o),c[cT]()&&qA(n,Yw,c[lT](),t),g[VT]){var a=g[VT]();a>=0&&(n.url+="&w="+a)}for(var s=0;s<f[dT];s++)n.url+="&"+f[s].name+"="+f[s].value;return n}function Y(e,t,n){e[t]=e[t]||{},e[t][u.identifier]=n}function X(t,n,o,i){if(t&&t.payloadBlob&&t.payloadBlob[dT]>0){var s=!!_,f=h[t.sendType];!K(t[FT])&&t[JT]&&2===t.sendReason&&(f=h[2]||h[3]||f);var m=w;(t.isBeacon||3===f[WT])&&(m=!1);var v=J(t,m);m=m||v[kT];var y=dk();RC(g,function(){return"HttpManager:_doPayloadSend"},function(){for(var h=0;h<t.batches[dT];h++)for(var I=t[HT][h][fT](),w=0;w<I[dT];w++){var S=I[w];if(C){var R=S[YT]=S[YT]||{};Y(R,"sendEventStart",y),Y(R,"serializationStart",n),Y(R,"serializationCompleted",o)}S[bA]>0?S[bA]++:S[bA]=1}te(t[HT],1e3+(i||0),t[FT],!0);var E={data:t[xT],urlString:v.url,headers:v[IT],_thePayload:t,_sendReason:i,timeout:T,disableXhrSync:A,disableFetchKeepAlive:b};m&&(MA(E[LT],$w)||(E[LT][$w]=zw),MA(E[LT],Gw)||(E[LT][Gw]=Kw));var M=null;f&&(M=function(n){c[sT]();var o=function(n,o){!function(t,n,o,i){var s=9e3,d=null,h=!1,g=!1;try{var p=!0;if(typeof t!==ld){if(n){c[uT](n[Ww]);var f=n[jw]||n["kill-duration-seconds"];vh(a[nA](n[Qw],f),function(e){vh(o[HT],function(t){if(t[gT]()===e){d=d||[];var n=t[vT](0);o.numEvents-=n[pT](),d[mT](n)}})})}if(200==t||204==t)return void(s=200);((v=t)>=300&&v<500&&429!=v||501==v||505==v||o.numEvents<=0)&&(p=!1),s=9e3+t%1e3}if(p){s=100;var m=o.retryCnt;0===o[FT]&&(m<r?(h=!0,Z(function(){0===o[FT]&&l--,V(o[HT],m+1,o[XT],k?2:o[FT],5)},k,mA(m))):(g=!0,k&&(s=8001)))}}finally{h||(c[uT](),function(t,n,r,o){try{o&&u[rA]();var i=t[HT];200===n&&(i=t.sentEvts||t[HT],o||t[ZT]||u._clearBackOff(),function(e){if(C){var t=dk();vh(e,function(e){e&&e[pT]()>0&&function(e,t){C&&vh(e,function(e){Y(e[YT]=e[YT]||{},"sendEventCompleted",t)})}(e[fT](),t)})}}(i)),te(i,n,t[FT],!0)}finally{0===t[FT]&&(l--,5!==r&&e.sendQueuedRequests(t[FT],r))}}(o,s,i,g)),te(d,8004,o[FT])}var v}(n,o,t,i)},s=t[XT]||t[ZT];try{f.sendPOST(n,o,s),P&&P(E,n,s,t[JT])}catch(e){$y(d,"Unexpected exception sending payload. Ex:"+sh(e)),F(o,0,{})}}),RC(g,function(){return"HttpManager:_doPayloadSend.sender"},function(){if(M)if(0===t[FT]&&l++,s&&!t.isBeacon&&3!==f[WT]){var e={data:E[eA],urlString:E[UT],headers:uk({},E[LT]),timeout:E.timeout,disableXhrSync:E[ET],disableFetchKeepAlive:E[_T]},n=!1;RC(g,function(){return"HttpManager:_doPayloadSend.sendHook"},function(){try{_(e,function(e){n=!0,p||e[DT]||(e[DT]=e[DT]||E[DT],e[tA]=e[tA]||E[tA]),M(e)},t.isSync||t[XT])}catch(e){n||M(E)}})}else M(E)})},function(){return{thePayload:t,serializationStart:n,serializationCompleted:o,sendReason:i}},t[ZT])}t.sizeExceed&&t.sizeExceed[dT]>0&&te(t.sizeExceed,8003,t[FT]),t.failedEvts&&t.failedEvts[dT]>0&&te(t.failedEvts,8002,t[FT])}function Z(e,t,n){t?e():O.set(e,n)}function ee(e){var t=M;try{for(var n=0;n<t[dT];n++)try{t[n](e)}catch(e){Ky(d,1,519,"Response handler failed: "+e)}if(e){var r=JSON.parse(e);ok(r.webResult)&&ok(r.webResult[rT])&&I.set("MSFPC",r.webResult[rT],31536e3)}}catch(e){}}function te(e,t,n,r){if(e&&e[dT]>0&&o){var i=o[function(e){var t=RA[e];ok(t)||(t="oth",e>=9e3&&e<=9999?t=Fw:e>=8e3&&e<=8999?t=Dw:e>=1e3&&e<=1999&&(t=Uw));return t}(t)];if(i){var a=0!==n;RC(g,function(){return"HttpManager:_sendBatchesNotification"},function(){Z(function(){try{i.call(o,e,t,a,n)}catch(e){Ky(d,1,74,"send request notification failed: "+e)}},r||a,0)},function(){return{batches:W(e),reason:t,isSync:a,sendSync:r,sendType:n}},!a)}}}e[wT]=function(e,t,n){q||(g=t,I=t.getCookieMgr(),d=(u=n).diagLog(),Ug(E,Iy(e,function(e){var r,o=e.cfg,a=e.cfg.extensionConfig[n.identifier];O=AA(a[TT],a[AT]),ok(o.anonCookieName)?function(e,t,n){for(var r=0;r<e[dT];r++)if(e[r].name===t)return void(e[r].value=n);e[mT]({name:t,value:n})}(f,"anoncknm",o.anonCookieName):function(e,t){for(var n=0;n<e[dT];n++)if(e[n].name===t)return void e[yT](n,1)}(f,"anoncknm"),_=a.payloadPreprocessor,P=a.payloadListener;var s=a.httpXHROverride,c=a[bT]?a[bT]:o.endpointUrl;i=c+SA,w=!!Kd(a[ST])||!a[ST],C=!a.disableEventTimings;var l=a.valueSanitizer,u=a.stringifyObjects,m=!!o[RT];Kd(a[RT])||(m=!!a[RT]),T=a.xhrTimeout,A=!!a[ET],b=!!a[_T],R=!1!==a.addNoResponse,N=!!a.excludeCsMetaData,t.getPlugin("LocalStorage")&&(b=!0),x=!Mv(),y=new TA(g,l,u,m,sk,N),$d(a[PT])||(x=!!a[PT]);var v=function(){try{return{enableSendPromise:!1,isOneDs:!0,disableCredentials:!1,disableXhr:!1,disableBeacon:!x,disableBeaconSync:!x,disableFetchKeepAlive:b,timeWrapper:O,addNoResponse:R,senderOnCompleteCallBack:{xdrOnComplete:D,fetchOnComplete:U,xhrOnComplete:H,beaconOnRetry:z}}}catch(e){}return null}();B?B.SetConfig(v):(B=new hI)[wT](v,d);var I=s,k=a[MT]?s:null,E=a[MT]?s:null,M=[3,2];if(!s){p=!1;var q=[];Mv()?(q=[2,1],M=[2,1,3]):q=[1,2,3],(s=L(q=yv(q,a.transports),!1))||$y(d,"No available transport to send events"),I=L(q,!0)}k||(k=L(M=yv(M,a.unloadTransports),!0)),S=!p&&(x&&Ov()||!b&&Nv(!0)),(r={})[0]=s,r[1]=I||L([1,2,3],!0),r[2]=k||I||L([1],!0),r[3]=E||L([2,3],!0)||I||L([1],!0),h=r})),q=!0)},e.addResponseHandler=function(e){return M[mT](e),{rm:function(){var t=M.indexOf(e);t>=0&&M[yT](t,1)}}},e[qT]=function(e){try{if(y)return y.getEventBlob(e)}catch(e){}return Lw},e[OT]=function(){try{return J(y&&y[NT](0,!1,!1,!1,1,0),w)}catch(e){}return null},e[BT]=function(e,n){try{var r=[];vh(e,function(e){n&&(e=fv(e));var t=gA.create(e[gT],[e]);r[mT](t)});for(var o=null;r[dT]>0&&y;){var i=r.shift();i&&i[pT]()>0&&(o=o||y[NT](0,!1,!1,!1,1,0),y.appendPayload(o,i,t))}var a=J(o,w),s={data:o[xT],urlString:a.url,headers:a[IT],timeout:T,disableXhrSync:A,disableFetchKeepAlive:b};return w&&(MA(s[LT],$w)||(s[LT][$w]=zw),MA(s[LT],Gw)||(s[LT][Gw]=Kw)),s}catch(e){}return null},e._getDbgPlgTargets=function(){return[h[0],a,y,h]},e[zT]=function(e,t){m[e]=t},e.removeHeader=function(e){delete m[e]},e[KT]=function(){return G()&&c[aT]()},e[$T]=function(e,t){Kd(e)&&(e=0),k&&(e=$(e),t=2),j(v,e,0)&&V(Q(),0,!1,e,t||0)},e[GT]=function(){return!s&&0===l&&0===v[dT]},e[QT]=function(e){k=e},e.addBatch=function(e){if(e&&e[pT]()>0){if(a.isTenantKilled(e[gT]()))return!1;v[mT](e)}return!0},e.teardown=function(){v[dT]>0&&V(Q(),0,!0,2,2),vh(E,function(e){e&&e.rm&&e.rm()}),E=[]},e.pause=function(){s=!0},e.resume=function(){s=!1,e[$T](0,4)},e[jT]=function(e,t,n){e&&e[pT]()>0&&($d(t)&&(t=1),k&&(t=$(t),n=2),V([e],0,!1,t,n||0))}})}return e.__ieDyn=1,e}(),NA=1e4,BA="eventsDiscarded",xA=void 0,LA=Hh({eventsLimitInMem:{isVal:pk,v:NA},immediateEventLimit:{isVal:pk,v:500},autoFlushEventsLimit:{isVal:pk,v:0},disableAutoBatchFlushLimit:!1,httpXHROverride:{isVal:function(e){return e&&e.sendPOST},v:xA},overrideInstrumentationKey:xA,overrideEndpointUrl:xA,disableTelemetry:!1,ignoreMc1Ms0CookieProcessing:!1,setTimeoutOverride:xA,clearTimeoutOverride:xA,payloadPreprocessor:xA,payloadListener:xA,disableEventTimings:xA,valueSanitizer:xA,stringifyObjects:xA,enableCompoundKey:xA,disableOptimizeObj:!1,transports:xA,unloadTransports:xA,useSendBeacon:xA,disableFetchKeepAlive:xA,avoidOptions:!1,xhrTimeout:xA,disableXhrSync:xA,alwaysUseXhrOverride:!1,maxEventRetryAttempts:{isVal:Xd,v:6},maxUnloadEventRetryAttempts:{isVal:Xd,v:2},addNoResponse:xA,excludeCsMetaData:xA});var DA=function(e){function t(){var n,r=e.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="4.2.1";var o,i,a,s,c,l,u,d,h,g,p,f,m,v,y,C,I,k,w,T,A,b,S,R,E,_=!1,P=[],M=!1,q=0,O=0,N={},B=Nw;return Xp(t,r,function(e,t){function r(){UI([wI,kI,CI],null,k),function(e,t){var n=BI(TI,t);UI([CI],e,n),UI([yI],null,n)}(null,k),function(e,t){var n=BI(AI,t);UI([II],e,n),UI([yI],null,n)}(null,k)}function x(e){var t="";return e&&e[dT]&&vh(e,function(e){t&&(t+="\n"),t+=e}),t}function L(e){var t="";try{H(e),t=d[qT](e)}catch(e){}return t}function D(e){"beforeunload"!==(e||bg().event).type&&(y=!0,d[QT](y)),W(2,2)}function U(e){y=!1,d[QT](y)}function H(e){e.ext&&e.ext[oT]&&delete e.ext[oT],e.ext&&e.ext[iT]&&e.ext[iT].id&&delete e.ext[iT].id,v&&(e.ext=fv(e.ext),e[sA]&&(e[sA]=fv(e[sA])),e[eA]&&(e[eA]=fv(e[eA])))}function F(e,t){if(e[cA]||(e[cA]=0),e[lA]||(e[lA]=1),H(e),e[uA])if(l||M)e[lA]=3,e[uA]=!1;else if(d)return v&&(e=fv(e)),void d[jT](gA.create(e[gT],[e]),!0===e[uA]?1:e[uA],3);var n=e[lA],r=O,o=a;4===n&&(r=q,o=i);var s=!1;if(r<o)s=!Y(e,t);else{var c=1,u=20;4===n&&(c=4,u=1),s=!0,function(e,t,n,r){for(;n<=t;){var o=V(e,t,!0);if(o&&o[pT]()>0){var i=o[vT](0,r),a=i[pT]();if(a>0)return 4===n?q-=a:O-=a,ae(BA,[i],tf.QueueFull),!0}n++}return X(),!1}(e[gT],e[lA],c,u)&&(s=!Y(e,t))}s&&ie(BA,[e],tf.QueueFull)}function z(e,t,n){var r=Z(e,t,n);return d[$T](t,n),r}function K(){return O>0}function $(){if(f>=0&&Z(f,0,m)&&d[$T](0,m),q>0&&!c&&!M){var e=N[B][2];e>=0&&(c=Q(function(){c=null,z(4,0,1),$()},e))}var t=N[B][1];!s&&!o&&t>=0&&!M&&(K()?s=Q(function(){s=null,z(0===u?3:1,0,1),u++,u%=2,$()},t):u=0)}function G(){n=null,_=!1,P=[],o=null,M=!1,q=0,i=500,O=0,a=NA,N={},B=Nw,s=null,c=null,l=0,u=0,h={},g=0,S=!1,p=0,f=-1,m=null,v=!0,y=!1,C=6,I=2,k=null,R=null,E=!1,w=AA(),d=new OA(500,2,1,{requeue:re,send:se,sent:ce,drop:le,rspFail:ue,oth:de}),ne(),h[4]={batches:[],iKeyMap:{}},h[3]={batches:[],iKeyMap:{}},h[2]={batches:[],iKeyMap:{}},h[1]={batches:[],iKeyMap:{}},he()}function Q(e,t){0===t&&l&&(t=1);var n=1e3;return l&&(n=mA(l-1)),w.set(e,t*n)}function j(){return null!==s&&(s.cancel(),s=null,u=0,!0)}function W(e,t){j(),o&&(o.cancel(),o=null),M||z(1,e,t)}function V(e,t,n){var r=h[t];r||(r=h[t=1]);var o=r.iKeyMap[e];return!o&&n&&(o=gA.create(e),r.batches[mT](o),r.iKeyMap[e]=o),o}function J(t,n){d[KT]()&&!l&&(g>0&&O>g&&(n=!0),n&&null==o&&e.flush(t,function(){},20))}function Y(e,t){v&&(e=fv(e));var n=e[lA],r=V(e[gT],n,!0);return!!r.addEvent(e)&&(4!==n?(O++,t&&0===e[cA]&&J(!e.sync,p>0&&r[pT]()>=p)):q++,!0)}function X(){for(var e=0,t=0,n=function(n){var r=h[n];r&&r[HT]&&vh(r[HT],function(r){4===n?e+=r[pT]():t+=r[pT]()})},r=1;r<=4;r++)n(r);O=t,q=e}function Z(t,n,r){var o=!1,i=0===n;return!i||d[KT]()?RC(e.core,function(){return"PostChannel._queueBatches"},function(){for(var e=[],n=4;n>=t;){var r=h[n];r&&r.batches&&r.batches[dT]>0&&(vh(r[HT],function(t){d.addBatch(t)?o=o||t&&t[pT]()>0:e=e[hT](t[fT]()),4===n?q-=t[pT]():O-=t[pT]()}),r[HT]=[],r.iKeyMap={}),n--}e[dT]>0&&ie(BA,e,tf.KillSwitch),o&&f>=t&&(f=-1,m=0)},function(){return{latency:t,sendType:n,sendReason:r}},!i):(f=f>=0?Math.min(f,t):t,m=Math.max(m,r)),o}function ee(e,t){z(1,0,t),X(),te(function(){e&&e(),P[dT]>0?o=Q(function(){o=null,ee(P.shift(),t)},0):(o=null,$())})}function te(e){d[GT]()?e():o=Q(function(){o=null,te(e)},.25)}function ne(){(N={})[Nw]=[2,1,0],N[Bw]=[6,3,0],N[xw]=[18,9,0]}function re(t,n){var r=[],o=C;y&&(o=I),vh(t,function(t){t&&t[pT]()>0&&vh(t[fT](),function(t){t&&(t[uA]&&(t[lA]=4,t[uA]=!1),t[cA]<o?(hk(t,e[oA]),F(t,!1)):r[mT](t))})}),r[dT]>0&&ie(BA,r,tf.NonRetryableStatus),y&&W(2,2)}function oe(t,n){var r=b||{},o=r[t];if(o)try{o.apply(r,n)}catch(n){Ky(e.diagLog(),1,74,t+" notification failed: "+n)}}function ie(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t[dT]>0&&oe(e,[t][hT](n))}function ae(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t[dT]>0&&vh(t,function(t){t&&t[pT]()>0&&oe(e,[t.events()][hT](n))})}function se(e,t,n){e&&e[dT]>0&&oe("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])}function ce(e,t){ae("eventsSent",e,t),$()}function le(e,t){ae(BA,e,t>=8e3&&t<=8999?t-8e3:tf.Unknown)}function ue(e){ae(BA,e,tf.NonRetryableStatus),$()}function de(e,t){ae(BA,e,tf.Unknown),$()}function he(){p=A?0:Math.max(1500,a/6)}G(),e._getDbgPlgTargets=function(){return[d,n]},e[wT]=function(o,s,c){RC(s,function(){return"PostChannel:initialize"},function(){t[wT](o,s,c),b=s.getNotifyMgr();try{k=BI(Yv(e[oA]),s.evtNamespace&&s.evtNamespace()),e._addHook(Iy(o,function(t){var o=t.cfg,c=KC(null,o,s);n=c.getExtCfg(e[oA],LA),w=AA(n[TT],n[AT]),v=!n.disableOptimizeObj&&!!wg("chrome"),T=n.ignoreMc1Ms0CookieProcessing,function(e){var t=e[VT];e[VT]=function(){var n=0;return T&&(n|=2),n|t.call(e)}}(s),a=n[iA],i=n.immediateEventLimit,g=n[aA],C=n.maxEventRetryAttempts,I=n.maxUnloadEventRetryAttempts,A=n.disableAutoBatchFlushLimit,he(),R=n.overrideInstrumentationKey,E=!!n.disableTelemetry,S&&r();var l=o.disablePageUnloadEvents||[];S=HI(D,l,k),S=FI(D,l,k)||S,S=zI(U,o.disablePageShowEvents,k)||S})),d[wT](o,e.core,e)}catch(t){throw e.setInitialized(!1),t}},function(){return{theConfig:o,core:s,extensions:c}})},e.processTelemetry=function(t,n){hk(t,e[oA]),n=n||e._getTelCtx(n);var r=t;E||_||(R&&(r[gT]=R),F(r,!0),y?W(2,2):$()),e.processNext(r,n)},e.getOfflineSupport=function(){try{var e=d&&d[OT]();if(d)return{getUrl:function(){return e?e.url:null},serialize:L,batch:x,shouldProcess:function(e){return!E},createPayload:function(e){return null},createOneDSPayload:function(e){if(d[BT])return d[BT](e,v)}}}catch(e){}return null},e._doTeardown=function(e,t){W(2,2),_=!0,d.teardown(),r(),G()},e.setEventQueueLimits=function(e,t){n[iA]=a=pk(e)?e:NA,n[aA]=g=pk(t)?t:0,he();var r=O>e;if(!r&&p>0)for(var o=1;!r&&o<=3;o++){var i=h[o];i&&i[HT]&&vh(i[HT],function(e){e&&e[pT]()>=p&&(r=!0)})}J(!0,r)},e.pause=function(){j(),M=!0,d.pause()},e.resume=function(){M=!1,d.resume(),$()},e._loadTransmitProfiles=function(e){j(),ne(),B=Nw,$(),mh(e,function(e,t){var n=t[dT];if(n>=2){var r=n>2?t[2]:0;if(t[yT](0,n-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var o=t[0]/t[1];t[0]=Math.ceil(o)*t[1]}r>=0&&t[1]>=0&&r>t[1]&&(r=t[1]),t[mT](r),N[e]=t}})},e.flush=function(e,t,n){var r;if(void 0===e&&(e=!0),!M)if(n=n||1,e)t||(r=xm(function(e){t=e})),null==o?(j(),Z(1,0,n),o=Q(function(){o=null,ee(t,n)},0)):P[mT](t);else{var i=j();z(1,1,n),t&&t(),i&&$()}return r},e.setMsaAuthTicket=function(e){d[zT](eT,e)},e.setAuthPluginHeader=function(e){d[zT](tT,e)},e.removeAuthPluginHeader=function(){d.removeHeader(tT)},e.hasEvents=K,e._setTransmitProfile=function(e){B!==e&&void 0!==N[e]&&(j(),B=e,$())},pv(e,function(){return d},["addResponseHandler"]),e[rA]=function(){l<4&&(l++,j(),$())},e._clearBackOff=function(){l&&(l=0,j(),$())}}),r}return Ip(t,e),t.__ieDyn=1,t}(YC),UA=Hh({cookieCfg:{ref:!0,v:{}},extensions:{rdOnly:!0,ref:!0,v:[]},channels:{rdOnly:!0,ref:!0,v:[]},extensionConfig:{ref:!0,v:{}}}),HA=function(e){function t(){var n,r,o=e.call(this)||this;return Xp(t,o,function(e,t){e.initialize=function(e,i){var a=o;RC(o,function(){return"ApplicationInsights:initialize"},function(){e=Cy(e,UA,a.logger,!1).cfg,n=new DA;var o=[r=new Ow];i&&(o=o.concat(i)),e||ch("You must provide a config object!");var s=e.channels;if(s&&s.length>0){for(var c=!1,l=0;l<s[0].length;l++)if(s[0][l].identifier===n.identifier){c=!0;break}c||Ug(s[0],n)}else e.channels.push([n]);var u=e.extensionConfig;u[n.identifier]=u[n.identifier]||e&&e.channelConfiguration||{},u[r.identifier]=u[r.identifier]||e&&e.propertyConfiguration||{};try{t.initialize(e,o),a.isInitialized()&&Ph(e,{channelConfiguration:{g:function(){return e.extensionConfig[n.identifier]}},propertyConfiguration:{g:function(){return e.extensionConfig[r.identifier]}}})}catch(e){Ky(a.logger,1,514,"Failed to initialize SDK."+sh(e))}},function(){return{config:e,extensions:i}})},e.getPropertyManager=function(){return r},e.getPostChannel=function(){return n}}),o}return Ip(t,e),t.__ieDyn=1,t}(vk),FA=Object.freeze({__proto__:null,AppInsightsCore:vk,ApplicationInsights:HA,BE_PROFILE:xw,BaseTelemetryPlugin:YC,Cloud:Wk,Device:Vk,DiagnosticLogger:Fy,EventsDiscardedReason:tf,InternalAppInsightsCore:cI,Loc:Zk,NRT_PROFILE:Bw,NotificationManager:IC,PostChannel:DA,PropertiesPlugin:Ow,RT_PROFILE:Nw,Session:Hk,TelemetryContext:Pw,_InternalLogMessage:Ly,cookieAvailable:dC,getISOString:uv,isArray:Jd,isBeaconsSupported:Ov,isBoolean:Zd,isLatency:ik,isNumber:Xd,isReactNative:Mv,isString:jd,isValueAssigned:ok});e.AccountEntity=io,e.ApiId=Ea,e.AuthError=ye,e.AuthErrorCodes=fe,e.AuthErrorMessage=ve,e.AuthenticationHeaderParser=class{constructor(e){this.headers=e}getShrNonce(){const e=this.headers[v];if(e){const t=this.parseChallenges(e);if(t.nextnonce)return t.nextnonce;throw Wt(Dt)}const t=this.headers[m];if(t){const e=this.parseChallenges(t);if(e.nonce)return e.nonce;throw Wt(Dt)}throw Wt(Lt)}parseChallenges(e){const n=e.indexOf(" "),r=e.substr(n+1).split(","),o={};return r.forEach(e=>{const[n,r]=e.split("=");o[n]=unescape(r.replace(/['"]+/g,t.EMPTY_STRING))}),o}}
/*! @azure/msal-common v15.12.0 2025-08-19 */,e.AuthenticationScheme=W,e.AzureCloudInstance=It,e.BrokerAuthError=Fu,e.BrokerAuthErrorCodes=Uu,e.BrowserAuthError=Vi,e.BrowserAuthErrorCodes=Gi,e.BrowserAuthErrorMessage=Wi,e.BrowserCacheLocation=fa,e.BrowserConfigurationAuthError=vs,e.BrowserConfigurationAuthErrorCodes=ps,e.BrowserConfigurationAuthErrorMessage=ms,e.BrowserPerformanceClient=Wl,e.BrowserPerformanceMeasurement=Vl,e.BrowserUtils=Ns,e.CacheLookupPolicy=Na,e.ClientAuthError=gt,e.ClientAuthErrorCodes=ut,e.ClientAuthErrorMessage=ht,e.ClientConfigurationError=jt,e.ClientConfigurationErrorCodes=$t,e.ClientConfigurationErrorMessage=Qt,e.DEFAULT_IFRAME_TIMEOUT_MS=Us,e.EventHandler=Dc,e.EventMessageUtils=class{static getInteractionStatusFromEvent(t,n){switch(t.eventType){case Sc.LOGIN_START:return Pa.Login;case Sc.SSO_SILENT_START:return Pa.SsoSilent;case Sc.ACQUIRE_TOKEN_START:if(t.interactionType===e.InteractionType.Redirect||t.interactionType===e.InteractionType.Popup)return Pa.AcquireToken;break;case Sc.HANDLE_REDIRECT_START:return Pa.HandleRedirect;case Sc.LOGOUT_START:return Pa.Logout;case Sc.SSO_SILENT_SUCCESS:case Sc.SSO_SILENT_FAILURE:if(n&&n!==Pa.SsoSilent)break;return Pa.None;case Sc.LOGOUT_END:if(n&&n!==Pa.Logout)break;return Pa.None;case Sc.HANDLE_REDIRECT_END:if(n&&n!==Pa.HandleRedirect)break;return Pa.None;case Sc.LOGIN_SUCCESS:case Sc.LOGIN_FAILURE:case Sc.ACQUIRE_TOKEN_SUCCESS:case Sc.ACQUIRE_TOKEN_FAILURE:case Sc.RESTORE_FROM_BFCACHE:if(t.interactionType===e.InteractionType.Redirect||t.interactionType===e.InteractionType.Popup){if(n&&n!==Pa.Login&&n!==Pa.AcquireToken)break;return Pa.None}}return null}},e.EventType=Sc,e.InteractionRequiredAuthError=Io,e.InteractionRequiredAuthErrorCodes=fo,e.InteractionRequiredAuthErrorMessage=Co,e.InteractionStatus=Pa,e.JsonWebTokenTypes=he,e.LocalStorage=Ac,e.Logger=vt,e.MemoryStorage=hc,e.NavigationClient=Bs,e.OIDC_DEFAULT_SCOPES=u,e.PairwiseBrokerApplication=class extends su{constructor(e,t,n){super(e,n),this.pwbBrokerAppConfig=Gu(t),this.temporaryBrokerStorage=ju(e,this.getLogger(),this.performanceClient),this.eventHandler=new Dc(this.getLogger()),this.redirectResponse=new Map,this.initialized=!1}async initialize(e){await super.initialize(e),this.initialized=!0}async initializeBrokering(e,t){if("undefined"==typeof window)return;const n={...t,correlationId:t?.correlationId||Os()},r=this.performanceClient.startMeasurement(Yl.PairwiseBrokerApplicationInitializeBrokering,n.correlationId);r.add({isBackground:!1});try{this.pwbBrokerAppConfig.actAsBroker?(this.pwbBrokerAppConfig.allowBrokering&&this.getLogger().verbose("Running in top frame and both actAsBroker, allowBrokering flags set to true. actAsBroker takes precedence."),r.add({isBroker:!0}),this.broker||(this.getLogger().verbose("Acting as Broker"),this.broker=new nd(this.getConfiguration(),this.pwbBrokerAppConfig,this.eventHandler),await this.broker.initialize(n)),this.broker.isListening?this.getLogger().info("Broker already initialized"):await this.broker.listenForBrokerMessage(e,r),r.end({success:!0})):this.pwbBrokerAppConfig.allowBrokering&&(this.getLogger().verbose("Acting as child"),r.add({isBroker:!1}),this.embeddedApp?await this.embeddedApp.isBrokerConnected()?this.getLogger().info("Embedded app is already connected to the broker"):(this.getLogger().info("initializeBrokering was called again, retrying handshake"),await this.embeddedApp.initiateHandshake(r)):(this.embeddedApp=new ad(this.getConfiguration().auth.clientId,n.correlationId,this.pwbBrokerAppConfig,this.getLogger(),this.performanceClient,this.eventHandler,this.temporaryBrokerStorage,this.hydrateCache.bind(this),this.clearCache.bind(this),this.channelId),await this.embeddedApp.initiateHandshake(r)))}catch(e){throw r.end({success:!1},e),e}}createEmbeddedRequest(e){const t={...e,correlationId:e.correlationId||Os()};return t.account||t.sid||t.loginHint||(t.account=this.getActiveAccount()||void 0),t}async handleRedirectPromise(t){if(_s(this.initialized),"undefined"!=typeof window){const n=t||"";let r=this.redirectResponse.get(n);if(void 0===r){this.eventHandler.emitEvent(Sc.HANDLE_REDIRECT_START,e.InteractionType.Redirect);const o=this.getAllAccounts();r=this.handleRedirectPromiseInternal(t).then(t=>{if(!t)return null;const n=o.length<this.getAllAccounts().length;return this.eventHandler.emitEvent(n?Sc.LOGIN_SUCCESS:Sc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Redirect,t),t}).catch(t=>{throw this.eventHandler.emitEvent(o.length>0?Sc.ACQUIRE_TOKEN_FAILURE:Sc.LOGIN_FAILURE,e.InteractionType.Redirect,null,t),t}).finally(()=>{this.eventHandler.emitEvent(Sc.HANDLE_REDIRECT_END,e.InteractionType.Redirect)}),this.redirectResponse.set(n,r)}return r}return null}async handleRedirectPromiseInternal(e){if(this.embeddedApp&&await this.embeddedApp.isBrokerConnected()){const e=Wu(this.controller.getConfiguration().auth.clientId),t=this.temporaryBrokerStorage.getItem(e);if(t){const n=JSON.parse(t);return await this.embeddedApp.sendHandleRedirectRequest(n).catch(e=>{throw e instanceof ye&&e.setCorrelationId(n.correlationId),e}).finally(()=>{this.temporaryBrokerStorage.removeItem(e)})}return null}return this.broker?this.broker.handleRedirectPromise(e):super.handleRedirectPromise(e)}async loginRedirect(e){return this.acquireTokenRedirect(e||{scopes:u})}async acquireTokenRedirect(t){const n=0===this.getAllAccounts().length;return this.eventHandler.emitEvent(n?Sc.LOGIN_START:Sc.ACQUIRE_TOKEN_START,e.InteractionType.Redirect,t),super.acquireTokenRedirect(t).catch(t=>(this.eventHandler.emitEvent(n?Sc.LOGIN_FAILURE:Sc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Redirect,null,t),Promise.reject(t)))}async loginPopup(e){return this.acquireTokenPopup(e||{scopes:u})}async acquireTokenPopup(t){Ps(!0);const n=this.createEmbeddedRequest(t),r=this.getAllAccounts();return this.eventHandler.emitEvent(0===r.length?Sc.LOGIN_START:Sc.ACQUIRE_TOKEN_START,e.InteractionType.Popup,n),this.acquireTokenPopupInternal(n).then(t=>{const n=r.length<this.getAllAccounts().length;return this.eventHandler.emitEvent(n?Sc.LOGIN_SUCCESS:Sc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Popup,t),t}).catch(t=>{t instanceof ye&&t.setCorrelationId(n.correlationId);const o=0===r.length;return this.eventHandler.emitEvent(o?Sc.LOGIN_FAILURE:Sc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Popup,null,t),Promise.reject(t)})}async acquireTokenPopupInternal(e){if(this.embeddedApp&&await this.embeddedApp.isBrokerConnected()){this.getLogger().verbose("pairwise broker (embedded app) acquireTokenPopup called",e.correlationId);const t=Wu(this.controller.getConfiguration().auth.clientId);this.temporaryBrokerStorage.setItem(t,JSON.stringify(e));return await this.embeddedApp.sendPopupRequest(e).finally(()=>{this.temporaryBrokerStorage.removeItem(t)})}return super.acquireTokenPopup(e)}async ssoSilent(t){Ps(!0);const n=this.createEmbeddedRequest(t);return this.eventHandler.emitEvent(Sc.SSO_SILENT_START,e.InteractionType.Silent,n),this.ssoSilentInternal(n).then(t=>(this.eventHandler.emitEvent(Sc.SSO_SILENT_SUCCESS,e.InteractionType.Silent,t),t)).catch(t=>{throw t instanceof ye&&t.setCorrelationId(n.correlationId),this.eventHandler.emitEvent(Sc.SSO_SILENT_FAILURE,e.InteractionType.Silent,null,t),t})}async ssoSilentInternal(e){return this.embeddedApp&&await this.embeddedApp.isBrokerConnected()?(this.getLogger().verbose("ssoSilent called",e.correlationId),this.embeddedApp.sendSsoSilentRequest(e)):super.ssoSilent(e)}async acquireTokenSilent(t){Ps(!0);const n=this.createEmbeddedRequest(t);return this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_START,e.InteractionType.Silent,n),this.acquireTokenSilentInternal(n).then(t=>(this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_SUCCESS,e.InteractionType.Silent,t),t)).catch(t=>(t instanceof ye&&t.setCorrelationId(n.correlationId),this.eventHandler.emitEvent(Sc.ACQUIRE_TOKEN_FAILURE,e.InteractionType.Silent,null,t),Promise.reject(t)))}async acquireTokenSilentInternal(e){if(this.embeddedApp&&await this.embeddedApp.isBrokerConnected()){this.getLogger().verbose("acquireTokenSilent - attempting to acquire token from web flow");const t=this.performanceClient.startMeasurement(Yl.EmbeddedClientApplicationSendSilentRefreshRequest,e.correlationId);try{const n={...e,cacheLookupPolicy:Na.AccessToken};let r;r=e.cacheLookupPolicy===Na.RefreshToken||e.cacheLookupPolicy===Na.RefreshTokenAndNetwork||e.cacheLookupPolicy===Na.Skip||e.forceRefresh?Promise.reject(new gt(Xe)):super.acquireTokenSilent(n);try{const e=await r;return t.end({success:!0}),e}catch(n){if(e.cacheLookupPolicy===Na.AccessToken)throw n;const r=await sd(this.embeddedApp.sendSilentRefreshRequest.bind(this.embeddedApp),Yl.EmbeddedSendSilentRefreshRequestInternal,this.getLogger(),this.performanceClient,e.correlationId)(e);return t.end({success:!0}),r}}catch(e){throw t.end({success:!1},e),e}}return super.acquireTokenSilent(e)}async logoutRedirect(e){if(this.embeddedApp&&await this.embeddedApp.isBrokerConnected())this.getLogger().error("Embedded app is not allowed to logout while the broker app is logged in.");else if(this.broker)return await this.broker.sendLogoutRequestToEmbeddedApps(),super.logoutRedirect(e)}async logoutPopup(e){if(this.embeddedApp&&await this.embeddedApp.isBrokerConnected())this.getLogger().error("Embedded app is not allowed to logout while the broker app is logged in.");else if(this.broker)return await this.broker.sendLogoutRequestToEmbeddedApps(),super.logoutPopup(e)}setActiveAccount(e){this.broker&&this.broker.setActiveAccount(e),super.setActiveAccount(e)}addEventCallback(e,t=Object.values(Sc)){const n=[Sc.ACQUIRE_TOKEN_START,Sc.ACQUIRE_TOKEN_SUCCESS,Sc.ACQUIRE_TOKEN_FAILURE,Sc.LOGIN_START,Sc.LOGIN_SUCCESS,Sc.LOGIN_FAILURE,Sc.SSO_SILENT_START,Sc.SSO_SILENT_SUCCESS,Sc.SSO_SILENT_FAILURE,Sc.HANDLE_REDIRECT_START,Sc.HANDLE_REDIRECT_END,Sc.BROKER_CONNECTION_ESTABLISHED],r=[],o=[];t.forEach(e=>{n.includes(e)?r.push(e):o.push(e)});const i=super.addEventCallback(e,o);return i?(this.eventHandler.addEventCallback(e,r,i),i):null}removeEventCallback(e){super.removeEventCallback(e),this.eventHandler.removeEventCallback(e)}},e.PerformanceEvents=wn,e.PromptValue=S,e.ProtocolMode=kn,e.PublicClientApplication=su,e.PublicClientNext=zl,e.ServerError=Xr,e.ServerResponseType=_,e.SessionStorage=bc,e.SignedHttpRequest=$l,e.StringUtils=Vt,e.StubPerformanceClient=En,e.UrlString=cn,e.WrapperSKU={React:"@azure/msal-react",Angular:"@azure/msal-angular"},e.createNestablePublicClientApplication=async function(e){const t=new lc(e);if(await t.initialize(),t.isAvailable()){const n=new xl(t),r=new Dl(e,n);return await r.initialize(),r}return Ul(e)},e.createStandardPublicClientApplication=Ul,e.isPlatformBrokerAvailable=async function(e,t,n){const r=new vt(e||{},Hs,Fs);r.trace("isPlatformBrokerAvailable called");const o=t||new En;return"undefined"==typeof window?(r.trace("Non-browser environment detected, returning false"),!1):!!await gl(r,o,n||ts())},e.stubbedPublicClientApplication=Kl,e.version=Vu});
