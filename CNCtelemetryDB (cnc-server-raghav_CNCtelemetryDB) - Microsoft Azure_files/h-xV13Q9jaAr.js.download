define("_generated/Less/MsPortalImpl.Controls/Controls/Documents/Editor.css",["module"],(function(e){"use strict";return{css:".fxc-editor{box-sizing:border-box;border-width:1px;border-style:solid;overflow:hidden}.fxc-editor.fxc-editor-disabled{opacity:.5}.fxc-editor .fxc-editor-content{height:100%;width:100%;left:0}.monaco-editor.vs .line-numbers{color:#0058ad}.monaco-editor>.context-view{overflow-y:auto}.monaco-editor.vs-dark .line-numbers{color:#777}.monaco-quick-open-widget{position:relative}.fxs-mode-light .original-in-monaco-diff-editor .mtk22{color:#971515}.fxs-mode-light .original-in-monaco-diff-editor .mtk5{color:#034a98}",moduleId:e.id}})),
define("MsPortalImpl.Controls/Controls/Documents/Editor",["require","exports","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Themes","Viva.Controls/Util/Viva.Resize","MsPortalImpl.Controls/Controls/Base/Loadable","MsPortalImpl/Interactions/Interactions.DismissHandler","Fx/Controls/Editor","FxInternal/Css","_generated/Less/MsPortalImpl.Controls/Controls/Documents/Editor.css","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Copilot"],(function(e,t,o,i,s,n,r,a,d,l,c,h){"use strict";t.Widget=void 0,(0,d.injectCss)(l);var u=MsPortalFx.Base,g=u.Diagnostics,m=u.Resources,p=MsPortalFx.clone;const _=window,b="fxc-editor",C=g.createLog(e),f=c.Controls.Editor;class M extends n.Widget{constructor(e,t,o){super(e,t,$.extend({fillBehavior:3},o)),this._decorations=[],this._ignoreUpdateFromKeyboard=!1,this._isDestroyed=!1,C.verbose("instance created"),t.content.extend({notify:"always"}),e.addClass(`${b} fxs-portal-border`).html("<div class='fxc-editor-content'></div>"),this._saving=!1,this._editorModelValue=null,this._editorValue=null,_.MonacoEnvironment||(_.MonacoEnvironment={}),_.MonacoEnvironment.getWorkerUrl=(e,t)=>{let o="";const i=MsPortalEarly.query.clientoptimizations;return i&&"false"===i.toLowerCase()&&(o="ClientOptimizations=false&"),m.getAppRelativeUri("Editor/WebWorker")+"?"+o+"label="+t},_.requirejs(["vs/editor/editor.main"],(()=>{this._content=e.find(".fxc-editor-content"),monaco.editor.onDidChangeMarkers((()=>{this.options.currentMarkers(monaco.editor.getModelMarkers({}))})),t.ariaLabel.subscribeAndRun(this.ltm,(e=>{this._editor&&this._editor.updateOptions({ariaLabel:e})})),t.refreshPayload.subscribe(this.ltm,(e=>{e&&(this._refresh(),t.refreshPayload(!1))})),t.savePayload.subscribe(this.ltm,(e=>{e&&(this._save(),t.savePayload(!1))})),this._load(),this._initializeSubscriptions(),this._disableElement(t.disabled()),this._resetResizeTracking()}))}dispose(){this._checkExistsOrRegisterDestroyId(super.dispose)||(this._isDestroyed=!0,C.verbose("instance disposed"),this._editorValue&&(this._editorValue.dispose(),this._editorValue=null),super.dispose(),this._cleanElement(b))}get options(){return this._options}get _editor(){return this._editorValue}get _editorModel(){return this._editorModelValue}set _editorModel(e){this._editorModelValue=e}_isCustomLanguage(e){return 1===e}_editorLanguage(e){switch(e){case 2:return"text/x-bat";case 3:return"text/x-c";case 4:return"text/coffeescript";case 5:return"text/x-cpp";case 6:return"text/x-csharp";case 7:return"text/x-cshtml";case 8:return"text/css";case 9:return"text/x-dockerfile";case 10:return"text/x-fsharp";case 11:return"text/x-go";case 12:return"text/x-handlebars-template";case 13:return"text/html";case 14:return"text/x-ini";case 15:return"pug";case 16:return"text/x-java-source";case 17:return"text/javascript";case 18:return"text/x-jshtm";case 19:return"application/json";case 20:return"text/x-less";case 21:return"text/x-lua";case 22:return"text/x-markdown";case 23:return"objective-c";case 24:return"application/x-php";case 25:return"text/x-powershell";case 26:return"text/x-python";case 27:return"text/x-r";case 28:return"text/x-ruby";case 29:return"sql";case 30:return"swift";case 31:return"text/typescript";case 32:return"text/x-vb";case 33:return"application/xaml+xml";case 34:return"text/xml";case 35:return"mysql";case 36:return"pgsql";case 38:return"yaml";default:return"text/plain"}}_addContentChangedListenerToModel(){this._editorModel.onDidChangeContent((()=>{this.options.dirty(!0),this._handleAutoSave()}))}_handleAutoSave(){const e=this.options.autoSaveDelay;e&&(this._autoSaveHandle&&clearTimeout(this._autoSaveHandle),this._autoSaveHandle=setTimeout((()=>{this._autoSaveHandle=null,this._save()}),e))}_getEditorOptions(){const e={roundedSelection:!0,contextmenu:!0,readOnly:!1,scrollBeyondLastLine:!1,fixedOverflowWidgets:!0,minimap:{enabled:!1}},t=this.options,o=t.readOnly(),i=t.showLineNumbers(),s=t.enhancedScrollbar(),n=t.wrappingColumn(),r=t.selectionHighlight();return this.$disabled()?e.readOnly=!0:void 0!==o&&(e.readOnly=o),void 0!==i&&(e.lineNumbers=i?"on":"off"),void 0!==s&&(e.minimap.enabled=s),void 0!==n&&(-1===n?e.wordWrap="off":0===n?e.wordWrap="on":(e.wordWrap="wordWrapColumn",e.wordWrapColumn=n)),void 0!==r&&(e.selectionHighlight=r),e}_initializeWidgets(){this._bindDescendants()}_subscribeTheme(){const e=this._diContainer;return e?e.getAsync(i.ThemeManager).then((e=>{const t=e&&e.currentTheme;t&&t.subscribe(this.ltm,(t=>{this._updateTheme(e)}));const o=e&&e.highContrastMode;return o&&o.subscribe(this.ltm,(t=>{this._updateTheme(e)})),e})):Promise.resolve(null)}_load(){C.verbose("load initiated"),this._subscribeTheme().then((e=>{C.verbose("required amd editor modules loaded"),this._isDestroyed||void 0===window.monaco?C.verbose("disposed before required amd editor modules loaded"):(this.options.loading(!1),this._setSyntaxHighlightTokens(),this._createEditorAndModel(),this._updateEditorOptions(),this._updateModelOptions(),this._updateLanguage(),this._updateMinHeight(),this._updateTheme(e))}))}_getContentUri(){if(this.options&&this.options.contentUri&&this.options.contentUri()){let e=this.options.contentUri();const t=/^([^:/?#]+:(\/+|\\?))?(.*)/.exec(e);return e=(t[1]||"schema://")+MsPortalFx.getUniqueId()+t[3],monaco.Uri.parse(e,!1)}return null}_setSyntaxHighlightTokens(){const e=[{token:"info-token",foreground:"6796e6"},{token:"warn-token",foreground:"cd9731"},{token:"error-token",foreground:"f44747"},{token:"debug-token",foreground:"b267e6"}];monaco.editor.defineTheme("lightTheme",{base:"vs",inherit:!0,rules:[{token:"info-token",foreground:"316bcd"},{token:"warn-token",foreground:"cd9731"},{token:"error-token",foreground:"cd3131"},{token:"debug-token",foreground:"800080"}],colors:{}}),monaco.editor.defineTheme("darkTheme",{base:"vs-dark",inherit:!0,rules:e,colors:{}}),monaco.editor.defineTheme("darkHighContrastTheme",{base:"hc-black",inherit:!0,rules:e,colors:{}})}createModel(e,t){return monaco.editor.createModel(e||"",t?null:"text/plain",t)}_addLanguageReferenceToContextMenu(){this._editor.addAction({id:"languageReferenceID",label:f.languageReference,contextMenuGroupId:"10_languageReferenceID",run:()=>{window.open("https://learn.microsoft.com/azure/governance/resource-graph/concepts/query-language")}})}_addCopilotExplainToContextMenu(){const e=this._editor.createContextKey("copilotExplainEnabled",!1);this.options.blockContent.subscribeAndRun(this.ltm,(t=>{e.set(!!t)})),this._editor.addAction({id:"copilotExplainID",label:f.copilotExplain,contextMenuGroupId:"11_copilotID",precondition:"copilotExplainEnabled",run:()=>{const e=this._editor.getSelection(),t=this.options.blockContent(),o=e.isEmpty()?t:this._editorModel.getValueInRange(e);let i=f.copilotExplainPrompt.format(o),s=f.copilotExplainDisplayPrompt;if(i.length>2e3){i=f.copilotExplainPromptTruncated.format(o).substring(0,1997)+"...",s=f.copilotExplainDisplayPromptTruncated}this._diContainer.get(h.CopilotService).nudge({promptId:"EditorPromptToExplain",prompt:i,displayPrompt:s,source:"editor"})}})}_isArgSchema(e){return e&&!("clusterType"in e)}_modifyUnsupportedMenuItems(){let e;!function(e){e[e.GoToDefinition=0]="GoToDefinition",e[e.GoToReferences=1]="GoToReferences",e[e.Peek=2]="Peek",e[e.HorizontalBorder1=3]="HorizontalBorder1",e[e.FormatCommandUnderCursor=4]="FormatCommandUnderCursor",e[e.RenameSymbol=5]="RenameSymbol",e[e.ChangeAllOccurences=6]="ChangeAllOccurences",e[e.FormatDocument=7]="FormatDocument",e[e.HorizontalBorder2=8]="HorizontalBorder2",e[e.LanguageReference=9]="LanguageReference",e[e.HorizontalBorder3=10]="HorizontalBorder3",e[e.Cut=11]="Cut",e[e.Copy=12]="Copy",e[e.Paste=13]="Paste",e[e.HorizontalBorder4=14]="HorizontalBorder4",e[e.CommandPalette=15]="CommandPalette"}(e||(e={})),this._content[0].addEventListener("contextmenu",(t=>{t.preventDefault();const o=[e.GoToDefinition,e.Peek,e.HorizontalBorder1,e.RenameSymbol],i=this._content[0].getElementsByClassName("shadow-root-host")[0].shadowRoot.querySelector("div").getElementsByClassName("actions-container")[0].getElementsByClassName("action-item");return o.forEach((e=>{i[e].setAttribute("style","display: none")})),!1}),!1)}_convertToEngineSchema(e){const t={name:"ARGDatabase",tables:e?.tables||[],functions:[],majorVersion:0,minorVersion:0};return{cluster:{connectionString:"",databases:[t]},database:t,clusterType:"Engine"}}_createKustoEditor(){const e=m.getContentUri("Content/Scripts/_oss/monaco-editor/0.25.2/min/vs/language/kusto/");_.requirejs(["vs/editor/editor.main",e+"bridge.min.js"],(()=>{_.requirejs([e+"newtonsoft.json.min.js",e+"kusto.javascript.client.min.js",e+"Kusto.Language.Bridge.min.js","vs/language/kusto/monaco.contribution"],(async()=>{if(!this._isDestroyed){const e={value:this.options.content(),language:"kusto"};this._editorValue=monaco.editor.create(this._content[0],e),this._editorValue.updateOptions({ariaLabel:this.options.ariaLabel()}),this._addLanguageReferenceToContextMenu(),(0,h.isCopilotEnabled)(this._diContainer)&&this._addCopilotExplainToContextMenu();const t=await monaco.languages.kusto.getKustoWorker();if(this._editorModel=this._editorValue.getModel(),this._kustoWorker=await t(this._editorModel),this._editor){const e=this.options.contentSchema();this._modifyUnsupportedMenuItems(),e?this._isArgSchema(e)?this._kustoWorker.setSchema(this._convertToEngineSchema(e)):this._kustoWorker.setSchema(e):this._kustoWorker.setSchema(this._convertToEngineSchema(null)),this.applyBindings(),this._editorModel.onDidChangeContent((()=>{const e=this._editorModel.getValue();this._ignoreUpdateFromKeyboard=!0,this.options.content(e),this._ignoreUpdateFromKeyboard=!1}))}}}))}))}applyBindings(){C.verbose("editor created with the plain text model");const e={dismissFn:MsPortalFx.noop,logName:"editor"};this._editor.onDidFocusEditorWidget((()=>{r.register(e),this.ltm.registerForDispose((()=>{r.unregister(e)}))})),this._editor.onDidBlurEditorWidget((()=>{r.unregister(e)}));const t=this.options;this._editor.addCommand(monaco.KeyMod.CtrlCmd|monaco.KeyCode.KEY_S,(()=>{this._save()})),this.options.customCommands().forEach((e=>{const t=e.keyModifier?e.keyModifier|e.keyCode:e.keyCode;this._editor.addCommand(t,(()=>{e.commandCallback(e.keyCode,e.keyModifier)}))})),this._editor.onDidChangeCursorPosition((e=>{t.dirty()||this._saving||this.updateCursorPosition()})),this._editor.onDidChangeCursorSelection((e=>{if(t.dirty()||this._saving||this.updateSelection(),!t.blockHighlight())return;if(!e.selection.isEmpty())return void(this._decorations=this._editor.deltaDecorations(this._decorations,[]));let o;o=t.defineBlock?t.defineBlock(e.selection.getStartPosition(),this._editor.getModel().getLinesContent()):this._getCurrentCommandRange(this._editor,e.selection.getStartPosition());const i=[{range:o,options:{className:"selectionHighlight"}}];this._decorations=this._editor.deltaDecorations(this._decorations,i),t.blockContent(this._editor.getModel().getValueInRange(o))}))}_createEditorAndModel(){if(C.verbose("creating plain text model"),this._editorModel=this.createModel(this.options.content(),this._getContentUri()),this._addContentChangedListenerToModel(),C.verbose("creating editor using the plain text model"),37===this.options.contentType())this._createKustoEditor();else{const e=ko.unwrap(this.options.ariaLabel);this._editorValue=monaco.editor.create(this._content[0],{model:this._editorModel}),this._editorValue.updateOptions({ariaLabel:e}),this.applyBindings()}}_onDisabledChanged(e){this._disableElement(e)}_onContentChanged(e){this._editorModel&&!this._saving&&(this._editorModel.setValue(e||""),this.options.dirty(!1))}_onContentUriChanged(e){if(!this._editorModel)return;const t=this._editorModel;this._editorModel=this.createModel(t.getValue(),this._getContentUri()),this._addContentChangedListenerToModel(),this._editor.setModel(this._editorModel),this._updateModelOptions(),this._updateLanguage()}_canRefresh(){return this.options.visible()}_refresh(){this._canRefresh()&&(this._resetResizeTracking(),this._refreshLayout())}_refreshLayout(){this._editor&&this._editor.layout()}_resetResizeTracking(){this._resizeTrackingLifetime&&this._resizeTrackingLifetime.dispose(),this._resizeTrackingLifetime=this.ltm.createChildLifetime(),s.track(this._resizeTrackingLifetime,this.element.first(),(()=>{this._refreshLayout()}))}_onVisibleChanged(e){o.toggle(this.element,!1!==e),e&&this._refresh()}_onSelectedRangeChanged(e){if(this._editor&&!this._saving){const t=this._editor;null===e&&(e={startLineNumber:t.getPosition().lineNumber,startColumn:t.getPosition().column,endLineNumber:t.getPosition().lineNumber,endColumn:t.getPosition().column}),this._cachedSelectionRange&&e.startLineNumber===this._cachedSelectionRange.startLineNumber&&e.startColumn===this._cachedSelectionRange.startColumn&&e.endLineNumber===this._cachedSelectionRange.endLineNumber&&e.endColumn===this._cachedSelectionRange.endColumn||(t.setSelection(e),t.revealRangeInCenter(e))}}_onPositionChanged(e){if(this._editor&&!this._saving){const t=this._editor;null===e||this._cachedCursorPosition&&e.column===this._cachedCursorPosition.column&&e.lineNumber===this._cachedCursorPosition.lineNumber||(t.setPosition(e),t.revealPositionInCenter(e))}}_save(){try{this._saving=!0;const e=this.options,t=this._editorModel;if(this._editor&&t){const o=t.getValue();e.content(o);const i=this._generateOutput;i&&i(o),this.updateSelection(),this.updateCursorPosition()}this.options.dirty(!1)}finally{this._saving=!1}}updateCursorPosition(){const e=this.options;this._cachedCursorPosition=this._editor.getPosition(),e.cursorPosition(this._cachedCursorPosition)}updateSelection(){const e=this.options,t=this._editor.getSelection();this._cachedSelectionRange=t||new monaco.Selection(1,1,1,1),t.isEmpty()?e.selectedContent(""):e.selectedContent(this._editorModel.getValueInRange(t)),e.selectedRange(this._cachedSelectionRange)}_initializeSubscriptions(){const e=this.options;let t=!0;ko.reactor(this.ltm,[e.readOnly,e.showLineNumbers,e.enhancedScrollbar,e.wrappingColumn,e.selectionHighlight,e.tabFocus,this.$disabled],(()=>{t||this._updateEditorOptions()})),ko.reactor(this.ltm,[e.tabSize,e.insertSpaces],(()=>{t||this._updateModelOptions()})),ko.reactor(this.ltm,[e.minVisibleLines],(()=>{t||this._updateMinHeight()})),this.vm.contentSchema?.subscribe(this.ltm,(e=>{this._kustoWorker&&(e?this._isArgSchema(e)&&(e=this._convertToEngineSchema(e)):e=this._convertToEngineSchema(null),this._kustoWorker.setSchema(e))})),e.content.subscribe(this.ltm,(e=>{this._ignoreUpdateFromKeyboard||this._onContentChanged(e)})),e.selectedRange.subscribe(this.ltm,(e=>{this._onSelectedRangeChanged(e)}));e.cursorPosition.subscribe(this.ltm,(e=>{this._onPositionChanged(e)})),e.contentUri.subscribe(this.ltm,(e=>{this._onContentUriChanged(e)})),e.contentType.subscribe(this.ltm,(()=>{this._updateLanguage()}));const o=e.customConfig;o&&o.subscribe(this.ltm,(()=>{this._updateLanguage()})),e.markers.subscribe(this.ltm,(e=>{this._updateMarkers(e)})),this.$disabled.subscribeAndRun(this.ltm,(e=>{this._onDisabledChanged(e)})),e.visible.subscribe(this.ltm,(e=>{this._onVisibleChanged(e)})),t=!1}_disableElement(e){this.element.toggleClass("fxc-editor-disabled",e),this.element.find("textarea").attr("tabindex",e?"-1":"0")}_updateTheme(e){this._editor&&(e&&e.highContrastMode&&2===e.highContrastMode()?monaco.editor.setTheme("darkHighContrastTheme"):e&&e.highContrastMode&&1===e.highContrastMode()?monaco.editor.setTheme("lightTheme"):e&&e.currentTheme&&1===e.currentTheme().mode?monaco.editor.setTheme("darkTheme"):monaco.editor.setTheme("lightTheme"))}_updateEditorOptions(){if(!this._editor)return;const e=this._getEditorOptions();this._editor.updateOptions(e);const t=this.options.tabFocus();void 0!==t&&this._editor.createContextKey("editorTabMovesFocus",t)}_updateModelOptions(){const e={},t=this.options,o=t.tabSize(),i=t.insertSpaces();o&&(e.tabSize=o),void 0!==i&&(e.insertSpaces=i),this._setOptions(e)}_setOptions(e){this._editorModel&&this._editorModel.updateOptions(e)}_updateMinHeight(){let e=this._editor;e&&e.getOriginalEditor&&(e=e.getOriginalEditor());let t=0;if(e&&e.getOption&&(t=e.getOption(monaco.editor.EditorOption.lineHeight)),0!==t){const e=this.options.minVisibleLines(),o=0===e||e&&e>0?e:2;this._currentMinLines!==o&&(this._currentMinLines=o,this._content.css("min-height",t*o+"px"),this._refreshLayout())}}_updateMarkers(e){this._saving||(e=e||[],this._setMarker("markers",e.filter((e=>(e.range||C.warning("Marker '{0}' skipped. Text range property was not set".format(e.message)),!!e.range))).map((e=>({severity:this._getSeverity(e.severity),message:e.message,startLineNumber:e.range.startLineNumber,startColumn:e.range.startColumn,endLineNumber:e.range.endLineNumber,endColumn:e.range.endColumn})))))}_getSeverity(e){switch(e){case a.MarkerSeverity.Hint:return monaco.MarkerSeverity.Hint;case a.MarkerSeverity.Info:return monaco.MarkerSeverity.Info;case a.MarkerSeverity.Warning:return monaco.MarkerSeverity.Warning;case a.MarkerSeverity.Error:return monaco.MarkerSeverity.Error;default:return 0}}_setMarker(e,t){this._editorModel&&monaco.editor.setModelMarkers(this._editorModel,e,t)}_updateLanguage(){C.verbose("setting the language"),this._setLanguage(this._loadLanguage()),C.verbose("updating markers"),this._updateMarkers(this.options.markers())}_setLanguage(e){this._editorModel&&monaco.editor.setModelLanguage(this._editorModel,e)}_loadLanguage(){const e=this.options.customConfig;return this.options.contentType&&e&&this._isCustomLanguage(this.options.contentType())?this._createCustomLanguage(e()):this._loadStandardLanguage(this._editorLanguage(this.options.contentType()))}_loadStandardLanguage(e){return C.verbose("loading standard language"),"application/json"===e&&this.options.json?this._configureJSON(this.options.json):"text/typescript"===e&&this.options.typescript&&this._configureTypeScript(this.options.typescript),C.verbose("standard language '{0}' was loaded.".format(e)),e}_configureJSON(e){const t=e.schemas?e.schemas.map((({uri:e,schema:t,fileMatch:o})=>({uri:e,schema:t,fileMatch:o}))):null;monaco.languages.json.jsonDefaults.setDiagnosticsOptions({enableSchemaRequest:!0,validate:!0,schemas:t,allowComments:e.allowComments})}_configureTypeScript(e){const t=monaco.languages.typescript;(e.extraLibs||[]).forEach((e=>{this.ltm.registerForDispose(t.typescriptDefaults.addExtraLib(e.content,e.path))}));const o=e.compilerOptions,i={};o&&(i.target=o.target),i.noEmit=!0,i.noLib=!0,i.allowNonTsExtensions=!0,t.typescriptDefaults.setDiagnosticsOptions({noSemanticValidation:!1,noSyntaxValidation:!1}),t.typescriptDefaults.setCompilerOptions(i);const s=this.options.typescriptOutput;s&&_.requirejs(["vs/language/typescript/lib/typescriptServices"],(e=>{this._generateOutput=t=>{s(e.transpileModule(t,{compilerOptions:{module:e.ModuleKind.AMD,target:i.target,noLib:!0,noResolve:!0,suppressOutputPathCheck:!0}}).outputText)};const t=this._editorModel;t&&this._generateOutput(t.getValue())}))}_createCustomLanguage(e){if(C.verbose("loading custom language"),!e||!e.tokenizer)return C.verbose("requested null custom language"),null;const t=p(e,!0,!0),o="custom."+(++M.CUSTOM_CONTENT_TYPE_ID).toString();return monaco.languages.register({id:o}),monaco.languages.setMonarchTokensProvider(o,t),e.suggestSupport&&monaco.languages.registerCompletionItemProvider(o,{triggerCharacters:e.suggestSupport.triggerCharacters||[],provideCompletionItems:()=>function(e){const t=[],o={suggestions:t};return e.forEach((e=>{const o={label:null,kind:null,insertText:null,range:null};var i;"string"==typeof e?(o.label=e,o.kind=monaco.languages.CompletionItemKind.Text,o.insertText=e):(o.label=e.label,o.kind=monaco.languages.CompletionItemKind[(i=e.type,i?i.charAt(0).toUpperCase()+i.slice(1):null)],o.insertText=e.codeSnippet,e.documentationLabel&&(o.documentation=e.documentationLabel)),t.push(o)})),o}(t.suggestSupport.snippets)}),C.verbose("custom language was loaded.".format(o)),o}_getCurrentCommandRange(e,t){const o=t.lineNumber-1,i=e.getModel().getLinesContent();let s=0,n=0;if(""===i[o].trim())return{startLineNumber:t.lineNumber,startColumn:1,endLineNumber:t.lineNumber,endColumn:i[t.lineNumber]?i[t.lineNumber].length+1:1};let r=o;for(;""!==i[r].trim()&&r>0;)r--;s=""!==i[r].trim()?r:r+1;for(let e=s;e<i.length&&""!==i[e].trim();e++)n=e;return{startLineNumber:s+1,startColumn:1,endLineNumber:n+1,endColumn:i[n].length+1}}}t.Widget=M,M.CUSTOM_CONTENT_TYPE_ID=0})),
define("MsPortalImpl.Controls/Controls/Documents/DiffEditor",["require","exports","MsPortalImpl.Controls/Controls/Documents/Editor"],(function(e,t,o){"use strict";t.Widget=void 0;const i="fxc-diffeditor";class s extends o.Widget{constructor(e,t,o){super(e,t,o),this.options.oldContent.extend({notify:"always"}),e.addClass(i),this._oldEditorModel=null}dispose(){this._checkExistsOrRegisterDestroyId(super.dispose)||(super.dispose(),this._cleanElement(i))}get options(){return this._options}get _diffEditor(){return this._editorValue}get _newEditorModel(){return this._editorModelValue}set _newEditorModel(e){this._editorModelValue=e}_getRenderSideBySide(){const e=this.options,t=ko.unwrap(e.renderSideBySide);return void 0===t||t}_getEditorOptions(){const e=super._getEditorOptions(),t=this.options;return e.enableSplitViewResizing=ko.unwrap(t.enableSplitViewResizing),e.renderSideBySide=this._getRenderSideBySide(),e}_createEditorAndModel(){this._editorValue=monaco.editor.createDiffEditor(this._content[0]),this._oldEditorModel=monaco.editor.createModel(this.options.oldContent()||"","text/plain"),this._newEditorModel=monaco.editor.createModel(this.options.content()||"","text/plain"),this._diffEditor.setModel({original:this._oldEditorModel,modified:this._newEditorModel})}_onOriginalContentChanged(e){this._oldEditorModel&&this._oldEditorModel.setValue(e||"")}_initializeSubscriptions(){const e=this.options;let t=!0;ko.reactor(this.ltm,[e.renderSideBySide,e.enableSplitViewResizing],(()=>{t||this._updateEditorOptions()})),e.oldContent.subscribe(this.ltm,(e=>{this._onOriginalContentChanged(e)})),super._initializeSubscriptions(),t=!1}_updateEditorOptions(){super._updateEditorOptions(),this._editor}_setOptions(e){this._oldEditorModel&&this._newEditorModel&&(this._oldEditorModel.updateOptions(e),this._newEditorModel.updateOptions(e))}_setMarker(e,t){this._oldEditorModel&&this._newEditorModel&&(monaco.editor.setModelMarkers(this._oldEditorModel,e,t),monaco.editor.setModelMarkers(this._newEditorModel,e,t))}_setLanguage(e){this._oldEditorModel&&this._newEditorModel&&(monaco.editor.setModelLanguage(this._oldEditorModel,e),monaco.editor.setModelLanguage(this._newEditorModel,e))}}t.Widget=s}));