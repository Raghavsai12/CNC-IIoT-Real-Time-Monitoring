define("MsPortalImpl/ReactViews/ReactFrame.CopilotConfig",["require","exports","Fx/DependencyInjection","FxInternal/RpcEndPointsCore"],(function(e,t,r,o){"use strict";t.CopilotFxRequireConfigSource=void 0;let i=t.CopilotFxRequireConfigSource=class{constructor(e){const t={};this.getRequireConfig=r=>(void 0===t[r]&&(t[r]=o.getCopilotFxRequireConfigEndPoint.invoke(e,"fxw",r)),t[r])}};t.CopilotFxRequireConfigSource=i=__decorate([__metadata("fx:diagnostics",[e,"CopilotFxRequireConfigSource"]),r.Class(),__metadata("design:paramtypes",[FxImpl.Rpc.Client])],i)})),
define("MsPortalImpl/ReactViews/ReactFrame.DevTools",["require","exports","MsPortalImpl/ReactViews/ReactFrame.Constants","MsPortalImpl/Services/Services.ExtensionStorageManager"],(function(e,t,r,o){"use strict";t.applyPerfToolsToReactFrame=function(e){const{bladeId:t,diContainer:i,extensionName:s,reactFramePromise:n}=e,a={completePerfToolApplication:(e,t)=>{i.get(o.ExtensionStorageManager).getStorageForExtension(s).then((o=>{const i=o.serialize().sessionStorage;a.profileOnLoad?(i[r.SESSION_STORAGE_DEVTOOLS_RELOAD_AND_PROFILE]="true",i[r.SESSION_STORAGE_DEVTOOLS_RECORD_CHANGE_DESCRIPTIONS_KEY]=MsPortalImpl.localStorage.getItem(r.SESSION_STORAGE_DEVTOOLS_RECORD_CHANGE_DESCRIPTIONS_KEY),t(e.element)):delete i[r.SESSION_STORAGE_DEVTOOLS_RELOAD_AND_PROFILE]}))},networkThrottlingEnabled:MsPortalImpl.sessionStorage.getItem(r.SESSION_STORAGE_THROTTLE)===t,networkThrottlingPromise:Promise.resolve(void 0),profileOnLoad:"true"===MsPortalImpl.sessionStorage.getItem(r.SESSION_STORAGE_DEVTOOLS_RELOAD_AND_PROFILE),toggleDevToolsPromise:Promise.resolve(void 0)};a.networkThrottlingEnabled&&(a.networkThrottlingPromise=async function(e){const{bladeId:t,diContainer:r,extensionName:o,getAsyncEndTime:i,loadReactViewStart:s,updateLoadReactViewStart:n}=e;try{const{KustoClient:e,QueryType:i}=await MsPortalFx.require("MsPortalImpl/Services/Kusto/KustoClient"),s=await r.get(e).getPrimaryData(i.P95NetworkRequestDurations,{bladeId:t,tableName:"HubsExtension"===o?"LighthousePerfVizClientTelemetry":"LighthousePerfVizExtTelemetry"},!0);return console.info("Network throttling: Network requests will be throttled to p95 durations. Unrecognized network requests will be throttled to averaged times."),s.data[0].bag}catch(e){return console.error(`Failed to get network request durations from Kusto: ${e}`),{}}finally{const e=i(),t=Date.now();if("number"==typeof e&&t>e){n(t-(e-s))}}}(e),n.then((e=>{e.networkThrottlingTelemetryPromise=a.networkThrottlingPromise})));a.profileOnLoad&&(a.toggleDevToolsPromise=MsPortalFx.require("MsPortalImpl/Parts/ReactDevTools/ReactDevTools").then((async({initializeReactDevTools:e,toggleReactDevTools:t})=>(await e(),t))));return a}})),
define("MsPortalImpl/ReactViews/ReactFrame.ViewPrefetcher",["require","exports","Fx/DependencyInjection","MsPortalImpl/ReactViews/ReactFrame.Utils","Fx/ResourceManagement","Fx/Experimentation","MsPortalImpl/ReactViews/ShellReactQueries"],(function(e,t,r,o,i,s,n){"use strict";t.ReactQueryHelperFactory=t.ReactQueryHelper=void 0,t.determineBladeUseType=d,t.getPrefetchableTokenNames=p,t.prefetchExtensionTokens=function(e,t,r,o,i,s,l){let c=[];MsPortalFx.isFeatureEnabled("reacttokenfetch")&&t&&(n.authTokenQuery.bind(e,l,o).get({force:!0}),c=s.tokensToPrefetch?s.tokensToPrefetch:p(t,i),c.length&&(c.forEach((t=>n.authTokenQuery.bind(e,l,o,{isBackground:!0,resourceName:t}).get({force:!0}))),a.trace({source:"ReactViewPrewarmer",action:"PrefetchCustomToken",name:r,extension:o,data:{resourceNames:c}})));return c};var a=MsPortalFx.Base.Diagnostics.Telemetry;const l=".WithProvisioning",c=["@microsoft/azureportal-reactview/Provisioning"];let u=t.ReactQueryHelperFactory=class{constructor(e){this._diContainer=e}createHelper(e){return new m(this._diContainer,e.viewName,e.queryStore,e.telemetryContext,e.extensionName)}};t.ReactQueryHelperFactory=u=__decorate([__metadata("fx:diagnostics",[e,"ReactQueryHelperFactory"]),r.Class(),__metadata("design:paramtypes",[r.Container])],u);class m{constructor(e,t,r,o,i){this._diContainer=e,this._viewName=t,this._queryStore=r,this._telemetryContext=o,this._extensionName=i,this._perfTimingLogs=[],this._queryPromises=[],this._shellExpProvider=this._diContainer.get(s.Experimentation).shellAssignments,this._prefetchShellAssignments(),this._prefetchExtensionAssignments(),this._prefetchGlobalSubscriptions()}async prefetchReactQueries(e){const{lifetime:t,viewMetadata:r,determineParams:o,logPerfTiming:i}=e;this._sendLogs=i,this._sendLogs(this._perfTimingLogs),this._perfTimingLogs=[];const{isCreateBlade:s,resourceId:n,doesProvisioning:a,containsBrowseComponents:l}=d(o);var c;return n&&this._prefetchEssentialsResourceInfo(n,t),this._prepareProvisioningContext(r,a),this._prefetchDropdownData({isCreateBlade:s,withProvisioningInfix:a,viewMetadata:r,createViewConfig:(c=this._viewName,"createstorageaccount.reactview"===c.toLowerCase()&&{resourceTypes:["Microsoft.Storage/storageAccounts"]}||"virtualnetworkcreatev3.reactview"===c.toLowerCase()&&{resourceTypes:["Microsoft.Network/virtualNetworks"]}||"publicipaddresscreate.reactview"===c.toLowerCase()&&{resourceTypes:["Microsoft.Network/publicIPAddresses"]}||"createaksbladev2.reactview"===c.toLowerCase()&&{resourceTypes:["Microsoft.ContainerService/managedClusters"]}||"createautomatic.reactview"===c.toLowerCase()&&{resourceTypes:["Microsoft.ContainerService/managedClusters"]}||"createcomputefleet.reactview"===c.toLowerCase()&&{resourceTypes:["Microsoft.AzureFleet/fleets"]}||"createazurefleetmanager.reactview"===c.toLowerCase()&&{resourceTypes:["Microsoft.ContainerService/fleets"]}||"createexperience.reactview"===c.toLowerCase()&&{}||"simplecreate.reactview"===c.toLowerCase()&&{})}),l&&this._prewarmBrowseFrame(this._viewName,o),Promise.all(this._queryPromises).then((()=>{this._perfTimingLogs.length&&this._sendLogs(this._perfTimingLogs)}))}_logRequest(e,t){this._perfTimingLogs.push({groupName:"Shell React Queries",name:e,isAsyncStart:t,isAsyncEnd:!t,timeStamp:Date.now()}),this._sendLogs&&(this._sendLogs(this._perfTimingLogs),this._perfTimingLogs=[])}_bindQuery(e,t,r=!0){r&&this._logRequest(e.name,!0);return e.bind(this._queryStore,...t).get({force:!0,telemetryContext:this._telemetryContext}).then((t=>(this._logRequest(e.name,!1),t)))}_prefetchGlobalSubscriptions(){this._globalSubscriptionsPromise=this._bindQuery(n.globalSubscriptionsQuery,[this._diContainer]),this._queryPromises.push(this._globalSubscriptionsPromise)}_prefetchShellAssignments(){return this._shellAssignmentsPromise||(this._shellAssignmentsPromise=this._bindQuery(n.experimentationShellAssignmentsQuery,[this._diContainer]),this._queryPromises.push(this._shellAssignmentsPromise)),this._shellAssignmentsPromise}_prefetchExtensionAssignments(){this._queryPromises.push(this._bindQuery(n.extensionExperimentationAssignmentsQuery,[this._diContainer,this._extensionName]))}_prefetchEssentialsResourceInfo(e,t){this._queryPromises.push(this._bindQuery(n.essentialsResourceInfoQuery,[t,e,!0]))}_prefetchInitialDropdownValues(){return this._initialDropdownValuesPromise||(this._initialDropdownValuesPromise=this._bindQuery(n.initialDropdownValuesQuery,[this._diContainer,this._queryStore]),this._queryPromises.push(this._initialDropdownValuesPromise)),this._initialDropdownValuesPromise}_prepareProvisioningContext(e,t){const r=FxImpl.TelemetryContext.usingState((()=>MsPortalFx.Base.Diagnostics.Telemetry.Context.getBladeContext()?.instanceId),this._telemetryContext);n.provisioningContextQuery.bind(this._queryStore,this._diContainer,this._queryStore,r,e.doesProvisioning||t).get()}_prefetchDropdownData(e){const{isCreateBlade:t,withProvisioningInfix:r,viewMetadata:o,createViewConfig:i}=e;(t||r||o.doesProvisioning||o.getLocationsOptions||o.resourceGroups)&&this._queryPromises.push(this._globalSubscriptionsPromise.then((e=>{const t=this._prefetchInitialDropdownValues(),r=e.length>0;let s;i?s=i:o.getLocationsOptions&&this._shellExpProvider.getBooleanValue("EarlyLocations")&&(s=o.getLocationsOptions);const a=r&&s;return r&&this._logRequest(n.resourceGroupsQuery.name,!0),a&&this._logRequest(n.locationsForCreateQuery.name,!0),t.then((e=>{const t=[],r=e?.subscriptionIds?.[0];if(r){if(s){const e=s.resourceTypes;t.push(this._bindQuery(n.locationsForCreateQuery,[{subscriptionId:r,resourceTypes:e}],!1))}t.push(this._bindQuery(n.resourceGroupsQuery,[[r]],!1))}return Promise.all(t)}))})))}_prewarmBrowseFrame(e,t){this._queryPromises.push(MsPortalFx.require("MsPortalImpl/ReactViews/Browse.Prewarmer").then((({prewarmBrowseFrame:r})=>{this._shellExpProvider.whenAvailable().then((o=>{r(e,t,this._queryStore,o)}))})))}}function p(e,t){const r=e.replace(".ReactView",".TokenFetcher."),i=r&&(0,o.getModuleIdAndUrl)(r,t,!0).id;return i?i.replace(r,"").split("!"):[]}function d(e){const{requireConfig:t,viewModuleId:r,viewName:o,url:s,parameters:n}=e,a={containsBrowseComponents:!1,isCreateBlade:!1,doesProvisioning:!1},u=r.replace(".ReactView",l).toLowerCase();Object.entries(t.dependencyTree).forEach((([e,t])=>{Object.entries(t).forEach((([t,r])=>{t.toLowerCase().startsWith(u)&&(a.doesProvisioning=!0),e===s&&r.forEach((e=>{if(c.includes(e))a.isCreateBlade=o.toLocaleLowerCase().split("/").pop().includes("create");else if("@microsoft/azureportal-reactview/Essentials"===e){if(n){const e=n.resourceId||n.id,t=i.ArmId.parse(e);!t?.kind||6!==t.kind&&3!==t.kind&&8!==t.kind&&4!==t.kind||(a.resourceId=e)}}else e.includes("@microsoft/azureportal-reactview/browse")&&(a.containsBrowseComponents=!0)}))}))}));return["browseall.reactview","browseresourcegroups.reactview","browseresource.reactview","resourcegroupoverview.reactview"].includes(o.toLowerCase())&&(a.containsBrowseComponents=!0),a}t.ReactQueryHelper=m})),
define("MsPortalImpl/ReactViews/ReactFrame.ViewLoader",["require","exports","MsPortalImpl/Services/Services.ExtensionStorageManager","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Base/Themes","MsPortalImpl/Interactions/Interactions.FullScreenMode","MsPortalImpl/Widgets/Widgets.SideBar","FxInternal/AsyncLoader","MsPortalImpl/ReactViews/ReactFrame.CopilotConfig","MsPortalImpl/ReactViews/ReactFrame.Constants","MsPortalImpl/ReactViews/ReactFrame.ViewPrefetcher","MsPortalImpl/ReactViews/ReactFrame.DevTools","MsPortalImpl/ReactViews/ReactFrame.Utils","MsPortalImpl/ReactViews/ReactQueryStore","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Base/Base.DeepLink","FxInternal/Composition/ViewModelComposer","FxInternal/Ajax","Fx/Experimentation"],(function(e,t,r,o,i,s,n,a,l,c,u,m,p,d,g,h,w,f,P){"use strict";t.loadReactViewIntoFrame=async function(e){const{bladeSequenceNumber:t,diContainer:n,extensionName:g,experiments:_,frameLifetime:x,inContextPane:R,parameters:E,reactFramePromise:I,rpcClient:F,viewLoadingStartedDeferred:M,viewName:T}=e;let b=e.loadReactViewStart;const L=n.get(o.PostBootCache).get(g),D=n.get(d.ReactQueryStoreManager).getViewStore(g,t,x),V=n.get(u.ReactQueryHelperFactory).createHelper({viewName:T,queryStore:D,telemetryContext:(0,w.getEarlyViewModelTelemetryContext)(T,t),extensionName:g}),k=(0,p.watchFirstHiddenAndOffline)(x);let A;const q=`Extension/${g}/Blade/${T}`,{completePerfToolApplication:N,networkThrottlingPromise:O,profileOnLoad:Q,toggleDevToolsPromise:B}=(0,m.applyPerfToolsToReactFrame)({bladeId:q,diContainer:n,extensionName:g,getAsyncEndTime:()=>A,loadReactViewStart:b,updateLoadReactViewStart:e=>{b=e},reactFramePromise:I}),z=Date.now(),H=[{groupName:"ReactView boot",name:"extension boot",timeStamp:z}],G=n.get(r.ExtensionStorageManager).getStorageForExtension(g),U=MsPortalFx.require("MsPortalImpl/ReactViews/ReactFrameBinder"),K=n.get(l.CopilotFxRequireConfigSource).getRequireConfig(g),j="HubsExtension"===g?Promise.resolve(null):n.get(P.Experimentation).shellAssignments.whenAvailable().then((e=>e.getBooleanValue("useCopilotDomainConfig")?n.getAsync(a.get("MsPortalImpl/Services/Services.Copilot","CopilotReactViewChannelFactory")).then((e=>e?.createChannel(x,q,t))):n.getAsync(a.get("MsPortalImpl/Services/Services.CopilotReactViewChannelFactory","ReactViewChannelFactory")).then((e=>e.createChannel(x,q,t))))),W=n.getAsync(a.get("MsPortalImpl/Services/Services.Copilot","CopilotService")).then((e=>e.getConfig().initModuleId)),$=I.then((e=>(M.resolve(),e))),[Y,J,X,Z,ee,te,re]=await Promise.all([C(H,z,"storage",G),C(H,z,"boot",L),U,C(H,z,"frame",$),C(H,z,"copilotConfig",K),C(H,z,"copilotPort",j),C(H,z,"copilotInitModuleId",W)]);A=Date.now();const oe=await O,ie=await B,{port:se}=X.loadModel(F,g),ne=ko.toJS(E),ae=n.get(i.ThemeManager),le=n.get(s.FullScreenMode).isActive(),ce=e=>(e&&(e.blockedHosts=new Set(MsPortalEarly.blockedHosts)),e),ue=ce(J.requireConfig),{id:me,url:pe}=T&&(0,p.getModuleIdAndUrl)(T,ue),de=T&&`${T.substring(0,T.length-10)}.DataFetcher`,ge=de&&(0,p.getModuleIdAndUrl)(de,ue).id,he=J.extensionEnvironment.sdkEnv?.viewMetadata,we={...he?.["*"],...he?.[T]},fe=(0,u.prefetchExtensionTokens)(D,me,T,g,ue,we,n);Z.frameReuseSupported=Boolean(we.frameReuseSupported),Z.onDisposed=()=>{Z.onDisposed=null,x.dispose()};const Pe={viewName:T,sequenceNumber:t};FxImpl.Extension.onNewReactViewEndPoint.invoke(F,g,Pe),x.registerForDispose((()=>{FxImpl.Extension.onReactViewDisposed.invoke(F,g,Pe)}));const _e=Date.now();H.push({groupName:"ReactView boot",name:"extension boot",timeStamp:_e}),H.push({groupName:"ReactView boot",name:"early",timeStamp:_e}),N(Z,ie),Z.element.name=T;const ye=n.get(FxImpl.Features),Se=(0,f.getEndpoints)(),Ce={requireConfig:!Z.initialized&&T&&ue,initModules:[me],parameters:ne,type:"early",endpoints:Se,environment:!Z.initialized&&{...J.extensionEnvironment,requireConfig:void 0},experiments:_,features:!Z.initialized&&J.features,perfTelemetry:{experiments:_,frameReused:Z.reused},initialDeepLink:location.hash,urlQueryParams:location.search,internalEnv:{blockUntrustedDomains:FxImpl.internalEnv.blockUntrustedDomains,azsEndpoints:FxImpl.internalEnv.azsEndpoints,fxTrustedDomains:MsPortalFx.getEnvironmentValue("trustedDomains"),createSubscriptionLink:FxImpl.internalEnv.createSubscriptionLink,subscriptionLearnMoreLink:FxImpl.internalEnv.subscriptionLearnMoreLink},fetcherId:ge,serializedStorage:Y.serialize(),sessionId:MsPortalFx.sessionId,sideBarLayoutMode:v(n),browserTabId:S,tokenResourceNames:fe,isMenuBladeContent:e.isMenuBladeContent,perfLogEntries:H,loadReactViewStart:b,azHostId:t,queryStoreEntries:_.skipEarlyStorageData?void 0:D.getEntries(),verifyLinks:y,theme:{mode:ae.currentTheme().mode,highContrastMode:ae.highContrastMode()},fullScreenMode:le,name:T,inContextPane:R,profileOnLoad:Q,networkRequestDurations:oe,entryPointName:e.entryPointName,entryPointArgs:e.entryPointArgs,copilotFxRequireConfig:ce(ee),copilotInitModuleId:re,hashQueryString:(0,h.getCurrentUri)().hashQueryString,queryStringAssignments:{flightsFeature:ye.getValue("experimentationflights"),fromQuery:ye.shellFeatures.fromQuery},armContext:{armEndpoint:Se.arm,batchApiVersion:MsPortalFx.getFeatureValue("batchapiversion"),fxArmEndpoint:FxImpl.internalEnv.fxArmEndpoint,dArmDomains:FxImpl.internalEnv.dArmDomains,blockUntrustedDomains:FxImpl.internalEnv.blockUntrustedDomains||MsPortalFx.isFeatureEnabled("blockuntrusteddomains")},extensionContentRoot:MsPortalFx.trimEnd(ue.baseUrl||"","/Scripts"),extensionName:g,viewLoadStartTime:e.viewLoadStartTime};return Z.port.postMessage({signature:c.reactFrameSignature,kind:3,data:Ce},[se,...te?[te]:[]]),V.prefetchReactQueries({lifetime:x,viewMetadata:we,determineParams:{requireConfig:ue,viewModuleId:me,viewName:T,url:pe,parameters:E},logPerfTiming:e=>{Z.port.postMessage({signature:c.reactFrameSignature,kind:3,data:{type:"pushPerfTimings",entries:e}})}}),Z.model=X.loadModelForView(F,ue,g,T,ne),Z.getFirstHiddenOrOfflineTime=k,Z.initialized=!0,{viewMetadata:we}};const _="Extension boot",y=MsPortalFx.isFeatureEnabled("verifytopleveldomains"),S=(0,p.getBrowserTabId)();function C(e,t,r,o){return e.push({groupName:_,name:r,timeStamp:t}),o.then((t=>(e.push({groupName:_,name:r,timeStamp:Date.now()}),t)))}function v(e){if((0,g.isSideBarDocked)(e)){const t=e.get(n.ViewModel).layoutMode.value;return 1===t?"collapsed":2===t?"expanded":"flyout"}return"flyout"}}));