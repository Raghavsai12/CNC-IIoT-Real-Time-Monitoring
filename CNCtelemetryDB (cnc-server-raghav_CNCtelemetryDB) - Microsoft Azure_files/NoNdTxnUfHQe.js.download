define("MsPortalImpl/Widgets/ShellHeader/ShellHeaderStyle",["require","exports","@fluentui/tokens/lib/tokens","@griffel/react/makeStyles.esm"],(function(e,t,a,l){"use strict";t.default=void 0;const i=(0,l.makeStyles)({menuItem:{"[data-fui-focus-visible]::after":{zIndex:1,border:`1px ${a.tokens.colorNeutralForeground2} solid`,borderRadius:"0px",outlineOffset:"-1px"},fontSize:"13px"},headerButtonClose:{border:"0px",":hover":{backgroundColor:["#ba141a","!important"],color:["#fff","!important"]}},svgButton:{display:"contents"},menuPopover:{padding:"0px"},copilotMenuItemContent:{display:"flex"},copilotMenuItemText:{wordBreak:"break-word"}});t.default=i})),
define("MsPortalImpl/Widgets/ShellHeader/CopilotMenu.React",["require","exports","@fluentui/react-menu/lib/components/Menu/Menu","@fluentui/react-menu/lib/components/MenuItem/MenuItem","@fluentui/react-menu/lib/components/MenuList/MenuList","@fluentui/react-menu/lib/components/MenuPopover/MenuPopover","@fluentui/react-menu/lib/components/MenuTrigger/MenuTrigger","react","MsPortalImpl/Resources/ImplScriptResources","FxInternal/RpcEndPoints","MsPortalImpl/Services/Services.FeedbackPolicies","Fx/Experimentation","MsPortalImpl/Widgets/Image/Image.React","_generated/MsPortalImpl/Svg/Library/People.svg","_generated/MsPortalImpl/Svg/Library/PeopleFilled.svg","_generated/MsPortalImpl/Svg/Library/PersonFeedback.svg","_generated/MsPortalImpl/Svg/Library/PersonFeedbackFilled.svg","MsPortalImpl/Widgets/ShellHeader/ShellHeaderStyle"],(function(e,t,a,l,i,o,s,r,n,d,c,u,m,p,b,f,x,g){"use strict";t.default=void 0;var h=MsPortalFx.Base.Images,I=MsPortalFx.Base.Diagnostics.Telemetry;const v="AzureCopilot",M="CopilotMenuLinkClick",C="privacyStatement",E={palette:99},S=MsPortalFx.getEnvironmentValue("copilotMenuLinks"),V="CopilotMenuFeedbackPolicyControl";function P(e,t,a="_blank"){I.trace({source:v,action:M,name:t}),window.open(e,a)}function R({onClick:e,icon:t,filledIcon:a,label:i,ariaLabel:o,isExternalUri:s=!0}){const[n,d]=r.useState(!1),c=(0,g.default)();return r.createElement(l.MenuItem,{icon:n?r.createElement(m.Image,{className:"fxs-copilot-menu-icon",image:a}):r.createElement(m.Image,{className:"fxs-copilot-menu-icon",image:t}),onClick:e,className:"fxs-blade-dropmenubutton fxs-copilot-menu-ext-link fxs-portal-hover","aria-label":o,onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1)},r.createElement("div",{className:c.copilotMenuItemContent},r.createElement("span",{className:c.copilotMenuItemText},i),s&&r.createElement(m.Image,{inline:!0,className:"fxs-blade-dropmenubuttonsvg",image:h.Hyperlink()})))}t.default=({showCopilotContextMenu:e,diContainer:t})=>{const l=MsPortalFx.getUniqueId(),[g,w]=r.useState(!1),[k,B]=r.useState(!0),[y,F]=r.useState(!0);r.useEffect((()=>{(async()=>{try{const e=await(t?.get(u.Experimentation)).extensionAssignments.getBooleanValue("feedbackpolicycontrol"),a=await(t?.get(u.Experimentation)).extensionAssignments.getBooleanValue("copilotmanageabilityuimenu");if(F(a),e){const e=await(0,c.fetchFeedbackPolicySettings)();!1===e?.policyAllowFeedback&&(B(!1),I.trace({source:v,action:V,name:"CopilotMenuFeedbackOptionHidden",data:{policyAllowFeedback:e.policyAllowFeedback}}))}}catch(e){I.trace({source:v,action:V,name:"CopilotMenuFeedbackPoliciesFetchedFailed",data:{error:MsPortalFx.getLogFriendlyMessage(e)}})}})()}),[t]);const{extension:H}=e||{},T=[{onClick:()=>{return e=H,void d.copilotResetConversationEndpoint.invoke(FxImpl.Rpc.client,e,null).then((()=>{I.trace({source:v,action:M,name:"NewChatCreated"})})).catch((e=>{I.trace({source:v,action:M,name:"NewChatCreationFailed",data:{error:e.message}})}));var e},icon:h.NewChat(E),filledIcon:h.NewChatAlternate(E),label:n.Blade.Copilot.MenuOption.newChat,ariaLabel:n.Blade.Copilot.MenuOption.newChatArialLabel,isExternalUri:!1},y&&{onClick:()=>{P(`#view/HubsExtension/AssetMenuBlade/~/accessManagement/assetName/CopilotSettingsAsset/extensionName/${H}`,"AccessManagement","_self")},icon:h.CustomImageWithOptions(p,E),filledIcon:h.CustomImageWithOptions(b,E),label:n.Blade.Copilot.MenuOption.accessManagement,ariaLabel:n.Blade.Copilot.MenuOption.accessManagement,isExternalUri:!1},...(S??[]).map((e=>({onClick:()=>function(e){const t="true"===String(e.newWindow)?"_blank":"_self";e.titleResxKey===C?MsPortalFx.Base.Security.getUserInfo().then((a=>{P("72f988bf-86f1-41af-91ab-2d7cd011db47"===(a?.directoryId||"").toLowerCase()?e.alternativeUri:e.uri,e.titleResxKey,t)})).catch((a=>{I.trace({source:v,action:M,name:`getUserInfo fetch failed for ${C}`,data:{error:a.message}}),P(e.uri,e.titleResxKey,t)})):P(e.uri,e.titleResxKey,t)}(e),icon:h[e.icon](E),filledIcon:h[e.iconFilled](E),label:n.Blade.Copilot.MenuOption[e.titleResxKey],ariaLabel:n.Blade.Copilot.MenuOption[e.ariaLabelResxKey],isExternalUri:!0}))),k&&{onClick:()=>{return e=H,void d.copilotOpenGlobalFeedbackEndpoint.invoke(FxImpl.Rpc.client,e,null).then((()=>{I.trace({source:v,action:M,name:"CopilotGlobalFeedbackOpened"})})).catch((e=>{I.trace({source:v,action:M,name:"CopilotGlobalFeedbackFailedToOpen",data:{error:e.message}})}));var e},icon:h.CustomImageWithOptions(f,E),filledIcon:h.CustomImageWithOptions(x,E),label:n.Blade.Copilot.MenuOption.globalCopilotFeedback,ariaLabel:n.Blade.Copilot.MenuOption.globalCopilotFeedback,isExternalUri:!1}].filter(Boolean);return r.useEffect((()=>{const e=e=>{if("Escape"===e.key&&g)return e.preventDefault(),e.stopPropagation(),w(!1),!1};return document.addEventListener("keydown",e,!0),()=>{document.removeEventListener("keydown",e,!0)}}),[g]),e&&r.createElement("div",{className:"fxs-blade-copilot-menu-container"},r.createElement(a.Menu,{open:g,onOpenChange:(e,t)=>{w(t.open)}},r.createElement(s.MenuTrigger,null,r.createElement("button",{"aria-controls":l,className:"fxs-dropmenu-button fxs-popup-button","aria-haspopup":"true",title:n.Blade.Copilot.actionsAria,"aria-label":n.Blade.Copilot.actionsAria},r.createElement("div",{className:"fxs-blade-button fxs-blade-more fxs-portal-hover"},r.createElement(m.Image,{image:h.Ellipsis(E)})))),r.createElement(o.MenuPopover,{style:{overflowY:"hidden"},className:"fxs-text-link fxs-popup fxs-portal-bg-txt-br msportalfx-shadow-level2"},r.createElement(i.MenuList,null,T.map(((e,t)=>r.createElement(R,{key:t,icon:e.icon,filledIcon:e.filledIcon,label:e.label,ariaLabel:e.ariaLabel,onClick:e.onClick,isExternalUri:e.isExternalUri})))))))}})),
define("MsPortalImpl/Widgets/ShellHeader/HeaderButton.React",["require","exports","react","classnames","MsPortalImpl/Widgets/Image/Image.React","MsPortalImpl/Widgets/ShellHeader/ShellHeaderStyle","@fluentui/react-button/lib/components/Button/Button"],(function(e,t,a,l,i,o,s){"use strict";t.default=void 0;t.default=({className:e,title:t,ariaLabel:r,disabled:n,image:d,hidden:c,onClick:u})=>{const m=(0,o.default)(),p=e.includes("fxs-blade-close"),b=e.includes("fxs-blade-pin"),f=!!e.includes("fxs-blade-collapser")||!e.includes("fxs-blade-expander")&&void 0;return a.createElement(s.Button,{as:"button",type:"button",className:l(e,{"fxs-display-none":c,[m.headerButtonClose]:p}),title:t,"aria-label":r,onClick:u,size:"medium",disabled:!b&&n,appearance:"subtle","aria-expanded":f,icon:a.createElement(i.Image,{className:m.svgButton,image:d})})}})),
define("MsPortalImpl/Widgets/ShellHeader/CopilotResizeButtons.React",["require","exports","react","Fx/Experimentation","MsPortalImpl/Widgets/Widgets.Portal.init","MsPortalImpl/Widgets/ShellHeader/HeaderButton.React"],(function(e,t,a,l,i,o){"use strict";t.default=void 0;var s=MsPortalFx.Base.Images,r=MsPortalFx.Base.Diagnostics.Telemetry;t.default=e=>{const{titleValue:t,bladeResx:n,customHome:d,diContainer:c}=e,u="AzureCopilot",[m,p]=a.useState(!1),[b,f]=a.useState(!1);a.useEffect((()=>{(async()=>{try{await(c?.get(l.Experimentation)).extensionAssignments.getBooleanValue("allowfullscreenresize")&&p(!0)}catch(e){r.trace({source:u,action:"allowFullScreenResizeExp",name:"allowfullscreenresizeExpFailed",data:{error:e}})}})();const e=(0,i.getPortalViewModel)(c).dockedContextPane.getRootElement(),t=()=>f(!0),a=()=>f(!1);return e.on("maximized",t),e.on("restore",a),()=>{e.off("maximized",t),e.off("restore",a)}}),[c]);return m?a.createElement("div",null,a.createElement(o.default,{className:"fxs-blade-button fxs-blade-maximized msportalfx-hideonactivated fxs-portal-hover "+(b?"fxs-display-none":""),title:n.maximize,ariaLabel:n.maximizeAria,hidden:d,image:s.Maximize(),disabled:!1,onClick:()=>{(0,i.getPortalViewModel)(c).dockedContextPane.getRootElement().trigger("maximized"),r.trace({source:u,action:"SideCarMaximized",name:"maximizeButtonClicked",data:{titleValue:t}})},"data-testid":"maximize-button"}),a.createElement(o.default,{className:"fxs-blade-button fxs-blade-restore msportalfx-hideonactivated fxs-portal-hover "+(b?"":"fxs-display-none"),title:n.restore,ariaLabel:n.restoreAria,image:s.Restore(),hidden:d,disabled:!1,onClick:()=>{(0,i.getPortalViewModel)(c).dockedContextPane.getRootElement().trigger("restore"),r.trace({source:u,action:"SideCarRestored",name:"restoreButtonClicked",data:{titleValue:t}})},"data-testid":"restore-button"})):null}})),
define("MsPortalImpl/Widgets/ShellHeader/useFullScreeenMode",["require","exports","FxInternal/Css","_generated/Less/MsPortalImpl/Interactions/Interactions.FullScreenMode.css","react"],(function(e,t,a,l,i){"use strict";t.default=void 0,(0,a.injectCss)(l);const o=document.body,s=o.classList;t.default=()=>{const[e,t]=(0,i.useState)(!1);(0,i.useEffect)((()=>{const e=new MutationObserver((()=>{t(s.contains("fxs-portal-fullscreen"))}));return e.observe(o,{attributes:!0,attributeFilter:["class"]}),()=>e.disconnect()}),[]);const a=()=>{s.add("fxs-portal-fullscreen"),t(!0)},l=()=>{s.remove("fxs-portal-fullscreen"),t(!1)};return{isActive:e,enter:a,exit:l,toggle:()=>{e?l():a()}}}})),
define("MsPortalImpl/Widgets/ShellHeader/DropMenuInner.React",["require","exports","react","@fluentui/react-menu/lib/components/Menu/Menu","@fluentui/react-menu/lib/components/MenuItem/MenuItem","@fluentui/react-menu/lib/components/MenuList/MenuList","@fluentui/react-menu/lib/components/MenuPopover/MenuPopover","@fluentui/react-menu/lib/components/MenuTrigger/MenuTrigger","@griffel/core/mergeClasses.esm","_generated/Less/MsPortalImpl/Widgets/Widgets.Blade.css","FxInternal/Css","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Image/Image.React","MsPortalImpl/Widgets/ShellHeader/ShellHeaderStyle","MsPortalImpl/Widgets/ShellHeader/useFullScreeenMode"],(function(e,t,a,l,i,o,s,r,n,d,c,u,m,p,b){"use strict";t.default=t.copyToClipboard=void 0;var f=MsPortalFx.Base.Images;(0,c.injectCss)(d);t.copyToClipboard=e=>{const t=document.createRange();t.selectNodeContents(document.querySelector(e));const a=window.getSelection();a.removeAllRanges(),a.addRange(t),document.execCommand("copy"),a.removeAllRanges()};t.default=({handlePrintClick:e,handleCopyClick:t})=>{const d=MsPortalFx.getUniqueId(),c=(0,p.default)(),{toggle:x}=(0,b.default)(),[g,h]=a.useState(!1),I={palette:99},v=[{onClick:t,icon:f.Copy(I),text:u.Blade.copy,className:"fxs-blade-copyname"},{onClick:()=>{h(!1),e()},icon:f.Print(I),text:u.Blade.print,className:"fxs-blade-print"},{onClick:()=>{x()},icon:f.Fullscreen(I),text:u.Blade.fullScreen,className:"fxs-blade-fullscreen"}];return a.createElement("div",{className:"fxs-dropmenu",role:"presentation"},a.createElement(l.Menu,{open:g,onOpenChange:(e,t)=>{h(t.open)}},a.createElement(r.MenuTrigger,null,a.createElement("button",{"aria-controls":d,className:"fxs-dropmenu-button fxs-popup-button","aria-haspopup":"true",title:u.Blade.moreContentActionAria,"aria-label":u.Blade.moreContentActionAria},a.createElement("div",{className:"fxs-blade-button fxs-blade-more fxs-portal-hover"},a.createElement(m.Image,{className:c.svgButton,image:f.Ellipsis(I)})))),a.createElement(s.MenuPopover,{style:{overflowY:"hidden"},className:"fxs-dropmenu-content fxs-text-link fxs-popup fxs-portal-bg-txt-br msportalfx-shadow-level2"},a.createElement(o.MenuList,{id:d,className:"fxs-blade-dropmenucontent"},v.map(((e,t)=>a.createElement(i.MenuItem,{key:t,className:(0,n.mergeClasses)(c.menuItem,e.className,"fxs-blade-dropmenubutton","fxs-blade-copyname","fxs-portal-hover"),onClick:e.onClick,icon:a.createElement(m.Image,{image:e.icon})},e.text)))))))}})),
define("MsPortalImpl/Widgets/ShellHeader/Subtitle.React",["require","exports","react","classnames","MsPortalImpl/Widgets/Image/Image.React"],(function(e,t,a,l,i){"use strict";t.default=void 0;t.default=({subtitleValue:e,directoryInfoValue:t,bladeResx:o,uniqueIdForSubtitle:s})=>a.createElement("div",{className:"fxs-blade-title-subtitle"},a.createElement("div",{className:l("fxs-blade-title-subtitleText","msportalfx-tooltip-overflow fxs-portal-subtext",{"fxs-display-none":!e}),id:s},e,t&&a.createElement("div",{className:"fxs-blade-title-subtitleDirectory fxs-blade-title-subtitleText fxs-portal-subtext"},a.createElement(i.Image,{className:"fxs-blade-title-subtitleDirectoryIcon fxs-blade-header-icon fxs-portal-border",image:t?.directoryIcon,title:o.DelegatedDirectory.info,inline:!0}),a.createElement("div",{className:"fxs-blade-title-subtitleDirectoryText"},t?.directoryName))))})),
define("MsPortalImpl/Widgets/ShellHeader/TitleImage.React",["require","exports","react","MsPortalImpl/Widgets/Image/Image.React"],(function(e,t,a,l){"use strict";t.default=void 0;const i=e=>{if(e){return e.split(",").map((e=>"url('"+e.trim()+"')")).join(",")}};t.default=({showTitleImageValue:e,titleImageUriValue:t,showBladeIconValue:o,iconValue:s})=>a.createElement(a.Fragment,null,e&&a.createElement("div",{className:"fxs-blade-title-image",style:{backgroundImage:i(t)}}),o&&a.createElement(l.Image,{className:"fxs-blade-header-icon",image:s}))})),
define("MsPortalImpl/Widgets/ShellHeader/TitleMainText.React",["require","exports","react"],(function(e,t,a){"use strict";t.default=void 0;t.default=({titleMainValue:e,titleExtrasValue:t,uniqueIdForTitle:l,uniqueIdForSubtitle:i})=>a.createElement("h2",{className:"fxs-blade-title-titleText msportalfx-tooltip-overflow",id:l,"aria-describedby":i},e,a.createElement("span",{className:"msportalfx-font-regular"},t))})),
define("MsPortalImpl/Widgets/ShellHeader/RenderCopilotHeader.React",["require","exports","@fluentui/react-provider/lib/components/FluentProvider/FluentProvider","classnames","react","MsPortalImpl/Widgets/ShellHeader/CopilotMenu.React","MsPortalImpl/Widgets/ShellHeader/TitleImage.React","MsPortalImpl/Widgets/ShellHeader/TitleMainText.React","MsPortalImpl/Widgets/ShellHeader/Subtitle.React","MsPortalImpl/Widgets/ShellHeader/HeaderButton.React","MsPortalImpl/Widgets/ShellHeader/CopilotResizeButtons.React"],(function(e,t,a,l,i,o,s,r,n,d,c){"use strict";t.default=void 0;var u=MsPortalFx.Base.Images;t.default=e=>{const{titleValue:t,loadedValue:m,showCopilotContextMenu:p,bladeResx:b,handleOnClickClose:f,customHome:x,theme:g,showTitleImageValue:h,titleImageUriValue:I,showBladeIconValue:v,iconValue:M,titleMainValue:C,titleExtrasValue:E,subtitleValue:S,diContainer:V,uniqueIdForTitle:P,uniqueIdForSubtitle:R}=e;return i.createElement(a.FluentProvider,{theme:g},i.createElement("header",{className:l("fxs-blade-header fxs-header fxs-portal-svg fxs-portal-background",{"fxs-blade-loading-status":!m,"fxs-blade-loaded":m}),"aria-labelledby":`${P} ${R}`},i.createElement("div",{className:"fxs-blade-title-content"},i.createElement(s.default,{showTitleImageValue:h,titleImageUriValue:I,showBladeIconValue:v,iconValue:M}),i.createElement("div",{className:"fxs-blade-title"},i.createElement("div",{className:"fxs-blade-title-toprow"},i.createElement(r.default,{titleMainValue:C,titleExtrasValue:E,uniqueIdForTitle:P,uniqueIdForSubtitle:P}),i.createElement("div",{className:"fxs-blade-actions-spacefiller msportalfx-hideonactivated"}),i.createElement(o.default,{diContainer:V,showCopilotContextMenu:p}),i.createElement(c.default,{titleValue:t,bladeResx:b,customHome:x,diContainer:V}),i.createElement(d.default,{className:"fxs-blade-button fxs-blade-close msportalfx-hideonactivated",title:b.close,ariaLabel:b.closeAria.format(t),disabled:!1,image:u.Close(),hidden:x,onClick:f})),i.createElement(n.default,{subtitleValue:S,bladeResx:b,uniqueIdForSubtitle:R})))))}})),
define("MsPortalImpl/Widgets/ShellHeader/RenderHelpSupportHeader.React",["require","exports","@fluentui/react-provider/lib/components/FluentProvider/FluentProvider","classnames","react","MsPortalImpl/Widgets/ShellHeader/TitleImage.React","MsPortalImpl/Widgets/ShellHeader/TitleMainText.React","MsPortalImpl/Widgets/ShellHeader/Subtitle.React","MsPortalImpl/Widgets/ShellHeader/HeaderButton.React"],(function(e,t,a,l,i,o,s,r,n){"use strict";t.default=void 0;var d=MsPortalFx.Base.Images;t.default=e=>{const{titleValue:t,loadedValue:c,bladeResx:u,handleOnClickClose:m,handleOnClickMinimize:p,customHome:b,theme:f,showTitleImageValue:x,titleImageUriValue:g,showBladeIconValue:h,showMinimize:I,iconValue:v,titleMainValue:M,titleExtrasValue:C,subtitleValue:E,uniqueIdForTitle:S,uniqueIdForSubtitle:V}=e;return i.createElement(a.FluentProvider,{theme:f},i.createElement("header",{className:l("fxs-blade-header fxs-header fxs-portal-svg fxs-portal-background",{"fxs-blade-loading-status":!c,"fxs-blade-loaded":c}),"aria-labelledby":`${S} ${V}`},i.createElement("div",{className:"fxs-blade-title-content"},i.createElement(o.default,{showTitleImageValue:x,titleImageUriValue:g,showBladeIconValue:h,iconValue:v}),i.createElement("div",{className:"fxs-blade-title"},i.createElement("div",{className:"fxs-blade-title-toprow"},i.createElement(s.default,{titleMainValue:M,titleExtrasValue:C,uniqueIdForTitle:S,uniqueIdForSubtitle:V}),i.createElement("div",{className:"fxs-blade-actions-spacefiller msportalfx-hideonactivated"}),i.createElement(n.default,{className:l("fxs-blade-button fxs-blade-minimize msportalfx-hideonactivated fxs-portal-hover",{"fxs-display-none":!I}),title:u.minimize,ariaLabel:u.minimizeAria.format(t),disabled:!1,image:d.Minimize(),hidden:b,onClick:p}),i.createElement(n.default,{className:"fxs-blade-button fxs-blade-close msportalfx-hideonactivated",title:u.close,ariaLabel:u.closeAria.format(t),disabled:!1,image:d.Close(),hidden:b,onClick:m})),i.createElement(r.default,{subtitleValue:E,bladeResx:u,uniqueIdForSubtitle:V})))))}})),
define("MsPortalImpl/Widgets/ShellHeader/ShellHeaderPromptRibbon.React",["require","exports","react","MsPortalImpl/Resources/ImplScriptResources","@griffel/react/makeStyles.esm","MsPortalImpl/Widgets/PromptRibbon/PromptRibbon.React","MsPortalImpl/Widgets/AzureHomeShared/CopilotUtil"],(function(e,t,a,l,i,o,s){"use strict";t.ShellHeaderPromptRibbon=void 0;const r=(0,i.makeStyles)({promptRibbonContainer:{flex:1}}),n="portal-prompt-ribbon-collapsed";function d(){try{const e=sessionStorage.getItem(n);return null!==e&&"true"===e}catch(e){return s.Telemetry.trace({source:"ShellHeaderPromptRibbon",action:"Error",name:"getInitialCollapsedState",data:{error:e.message}}),!1}}t.ShellHeaderPromptRibbon=a.memo((({diContainer:e,bladeName:t,bladeId:i})=>{const c=r(),[u,m]=a.useState(!1),[p,b]=a.useState(),[f,x]=a.useState(d),[{isSupported:g,realBladeName:h,scenario:I},v]=a.useState({isSupported:!1});return a.useEffect((()=>{const e=e=>{e.detail&&void 0!==e.detail.collapsed&&x((t=>t!==e.detail.collapsed?e.detail.collapsed:t))};return window.addEventListener("header-prompt-ribbon-state-changed",e),()=>{window.removeEventListener("header-prompt-ribbon-state-changed",e)}}),[]),a.useEffect((()=>{let a=!0;return e.isDisposed()||(0,s.getPortalScenario)(e,t,i).then((t=>{a&&!e.isDisposed()&&v((e=>JSON.stringify(t)!==JSON.stringify(e)?t:e))})),()=>{a=!1}})),a.useEffect((()=>{let a=!0;if(g){b(void 0);const l=(0,s.getScenarioForTelemetry)(I),o=s.Telemetry.startTrace({source:"ShellHeaderPromptRibbon",action:"GetPrompts",name:h,data:{bladeId:i,bladeName:t,scenario:l}});(0,s.getPrompts)(e,I,i).then((e=>{const{prompts:t}=e||{};if(s.Telemetry.completeTrace(o,{bladeId:i,prompts:t,scenario:l,isMounted:a}),a)if(t?.length){const e=t.map((({prompt:e,promptId:t},a)=>({id:t||a.toString(),text:e})));b(e)}else m(!1)})).catch((e=>{const t=e.type?e:{message:e.message,stack:e.stack};s.Telemetry.cancelTrace(o,{bladeId:i,logError:t,scenario:l,isMounted:a}),a&&m(!1)}))}return m(g),()=>{a=!1}}),[g,h,I?.type,JSON.stringify(I?.details)]),a.createElement("div",{className:c.promptRibbonContainer},u&&a.createElement("div",null,a.createElement(o.PromptRibbon,{prompts:p,collapsible:!0,collapsed:f,loading:!p,ariaLabel:l.ShellHeader.PromptRibbon.ariaLabel,onClick:({id:t,text:a})=>(0,s.nudge)(e,{prompt:a,promptId:t,source:"bladeheader"}),onChange:e=>{x(e),function(e){try{sessionStorage.setItem(n,e.toString())}catch(e){s.Telemetry.trace({source:"ShellHeaderPromptRibbon",action:"Error",name:"SaveCollapseState",data:{error:e.message}})}}(e);const t=new CustomEvent("header-prompt-ribbon-state-changed",{detail:{collapsed:e}});window.dispatchEvent(t)}})))}))})),
define("MsPortalImpl/Widgets/ShellHeader/SpaceFiller.React",["require","exports","react"],(function(e,t,a){"use strict";t.default=void 0;t.default=()=>a.createElement("div",{className:"fxs-blade-actions-spacefiller msportalfx-hideonactivated"})})),
define("MsPortalImpl/Widgets/ShellHeader/RenderShellHeader.React",["require","exports","@fluentui/react-provider/lib/components/FluentProvider/FluentProvider","classnames","react","MsPortalImpl/Widgets/ShellHeader/DropMenuInner.React","MsPortalImpl/Widgets/ShellHeader/TitleMainText.React","MsPortalImpl/Widgets/ShellHeader/TitleImage.React","MsPortalImpl/Widgets/ShellHeader/Subtitle.React","MsPortalImpl/Widgets/ShellHeader/SpaceFiller.React","MsPortalImpl/Widgets/ShellHeader/HeaderButton.React","MsPortalImpl/Widgets/ShellHeader/ShellHeaderPromptRibbon.React","Fx/Experimentation","MsPortalImpl/Interactions/Interactions.PrintHandler","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/UI/Hubs/UI.FavoritesManager"],(function(e,t,a,l,i,o,s,r,n,d,c,u,m,p,b,f,x){"use strict";t.default=void 0,t.getTitleTextToCopy=I;var g=MsPortalFx.Base.Images,h=MsPortalFx.Base.Diagnostics.Telemetry;function I(e,t){return(e||"")+(t||"")}t.default=e=>{const{titleValue:t,titleMainValue:v,titleExtrasValue:M,titleImageUriValue:C,subtitleValue:E,directoryInfoValue:S,collapsedValue:V,collapseVisibleValue:P,loadedValue:R,showTranslucentSpinnerValue:w,showTitleImageValue:k,showBladeIconValue:B,showMinimize:y,iconValue:F,shareItDisabled:H,pinDisabled:T,pinVisibleValue:N,shareItVisibleValue:W,showFavoriteResourceButton:O,favoriteResourceButtonIcon:A,favoriteResourceButtonTitle:L,showEditAssetButton:q,editAssetButtonIcon:z,editAssetButtonTitle:U,editVisible:D,editEnabled:_,editState:$,bladeResx:K,handleOnClickMaximize:j,handleOnClickMinimize:G,handleOnClickClose:J,handleOnClickRestore:Y,pinblade:Q,editblade:X,shareItBlade:Z,favoriteResourceButtonOnClick:ee,editAssetButtonOnClick:te,customHome:ae,theme:le,diContainer:ie,bladeName:oe,bladeId:se,hashParts:re,isInContextPane:ne,telemetryName:de,isMenuBlade:ce,lifeTimeManager:ue,uniqueIdForTitle:me,uniqueIdForSubtitle:pe,resourceType:be,kind:fe,isCopilotEnabled:xe}=e,ge=ie.get(m.Experimentation),he=xe&&!ne,[Ie,ve]=i.useState(!1),[Me,Ce]=i.useState(null);i.useEffect((()=>{ge?.shellAssignments&&ge.shellAssignments.whenAvailable().then((e=>{if(e.getBooleanValue("favoriteServiceHeader")&&null===Me&&be){const e=ie.get(x.FavoritesManager).favorites.value.find((e=>e.resourceType?.toLowerCase()===be.toLowerCase()))||null;e?(Ce(e),ve(!0)):MsPortalFx.require("MsPortalImpl/Services/Services.AssetTypes").then((e=>{const t=ie.get(e.AssetTypeService).getAssetTypeByResourceType(be),a=(0,x.getFavoriteType)({assetType:t,kind:fe,diContainer:ie});Ce(a)}))}}))}),[]);const Ee={palette:99};return i.createElement(a.FluentProvider,{theme:le},i.createElement("header",{className:l("fxs-blade-header fxs-header fxs-portal-svg fxs-portal-background",R?"fxs-blade-loaded":"fxs-blade-loading-status"),"aria-labelledby":`${me} ${pe}`},i.createElement("div",{className:l("fxs-blade-progress-translucent fxs-loading5dots-container",{"fxs-display-none":!w})}),i.createElement("div",{className:"fxs-blade-title-content"},i.createElement(r.default,{showTitleImageValue:k,titleImageUriValue:C,showBladeIconValue:B,iconValue:F}),i.createElement("div",{className:"fxs-blade-title"},i.createElement("div",{className:"fxs-blade-title-toprow"},i.createElement(s.default,{titleMainValue:v,titleExtrasValue:M,uniqueIdForTitle:me,uniqueIdForSubtitle:pe}),i.createElement("div",{className:"fxs-blade-actions msportalfx-unselectable az-noprint"},i.createElement(c.default,{className:"fxs-blade-button fxs-blade-collapser fxs-portal-hover",title:K.collapseAria.format(t),ariaLabel:K.collapseAria.format(t),disabled:!1,image:g.DoubleChevron(Ee),hidden:!P}),i.createElement(c.default,{className:"fxs-blade-button fxs-blade-shareit fxs-portal-hover msportalfx-hideonactivated",title:K.shareIt,ariaLabel:K.shareItAria,disabled:H,image:g.ShareIt(Ee),hidden:w||!W,onClick:()=>(h.trace({timestamp:Date.now(),source:de,action:"CommandExecuted",name:"fxs-blade-shareit",data:{isReactShellHeader:!0}}),Z(null),!1)}),i.createElement(c.default,{className:"fxs-blade-button fxs-blade-pin fxs-portal-hover msportalfx-hideonactivated",title:K.pin,ariaLabel:K.pinAria.format(t),disabled:T,image:g.Pin(Ee),hidden:w||!N,onClick:()=>(h.trace({timestamp:Date.now(),source:de,action:"CommandExecuted",name:"fxs-blade-pin",data:{isReactShellHeader:!0}}),Q(null),!1)}),O&&i.createElement(c.default,{className:"fxs-blade-button fxs-blade-favorite fxs-portal-hover msportalfx-hideonactivated",title:L,ariaLabel:L,disabled:!1,image:A,hidden:!1,onClick:()=>{h.trace({timestamp:Date.now(),source:de,action:"CommandExecuted",name:"fxs-blade-favorite",data:{isReactShellHeader:!0}}),ee()}}),Me&&i.createElement(c.default,{className:"fxs-blade-button fxs-blade-favorite fxs-portal-hover msportalfx-hideonactivated",title:b.Blade.addServiceToFavorites,ariaLabel:b.Blade.addServiceToFavorites,disabled:!1,image:Ie?g.Star(Ee):g.Favorite(Ee),hidden:!1,onClick:()=>{ve((e=>!e)),Promise.all([MsPortalFx.require("MsPortalImpl/Widgets/Widgets.AllServicesMenu"),MsPortalFx.require("MsPortalImpl/UI/Hubs/UI.FavoritesManagerDeferred")]).then((([e,t])=>{const a=ie.get(x.FavoritesManager);e.toggleFavorite({clickedFavorite:Me,favoritesManager:a,favoritesManagerDeferred:ie.get(t.FavoritesManagerDeferred),telemetrySource:"Service Browse Page"}),a.loadFavorites()}))}}),q&&i.createElement(c.default,{className:"fxs-blade-button fxs-blade-editasset fxs-portal-hover msportalfx-hideonactivated",title:U,ariaLabel:U,disabled:!1,image:z,hidden:!1,onClick:()=>{h.trace({timestamp:Date.now(),source:de,action:"CommandExecuted",name:"fxs-blade-editasset",data:{isReactShellHeader:!0}}),te()}}),i.createElement(c.default,{className:"fxs-blade-button fxs-blade-edit fxs-portal-hover msportalfx-hideonactivated",title:K.edit,ariaLabel:K.editAria.format(t),disabled:!_,image:$?g.Save(Ee):g.Edit(Ee),hidden:!D,onClick:()=>(h.trace({timestamp:Date.now(),source:de,action:"CommandExecuted",name:"fxs-blade-edit",data:{isReactShellHeader:!0}}),X(null),!1)}),i.createElement("div",{className:"fxs-blade-actiondropmenu msportalfx-hideonactivated"},i.createElement(o.default,{handlePrintClick:()=>{h.trace({timestamp:Date.now(),source:de,action:"CommandExecuted",name:"fxs-blade-print",data:{isReactShellHeader:!0}});const e=document.querySelector(".fxs-blade-lastblade"),t=e.querySelector("[data-react-id]");if(t){const e=t.getAttribute("data-react-id"),a=parent.window.frames[e];a?.contentWindow&&a.contentWindow.postMessage({signature:"Az",kind:3036,data:ce?{titleMain:v,titleExtras:M,subtitle:E}:null},"*")}else ie.get(p.PrintHandler).printBlade(e,{name:de,source:"BladeCommand",menuBladeCtx:ce?de:null})},handleCopyClick:()=>{h.trace({timestamp:Date.now(),source:de,action:"CommandExecuted",name:"fxs-blade-copy",data:{isReactShellHeader:!0}});const e=I(v,M);navigator.clipboard.writeText(e);const t=ue.createChildLifetime();new f.PortalReader(t).read(b.Blade.copyAriaResult),t.dispose()}})),he?i.createElement(u.ShellHeaderPromptRibbon,{diContainer:ie,bladeName:oe,bladeId:se,hashParts:re}):i.createElement(d.default,null),i.createElement(c.default,{className:"fxs-blade-button fxs-blade-minimize msportalfx-hideonactivated",title:K.minimize,ariaLabel:K.minimizeAria.format(t),disabled:!1,image:g.Minimize(),hidden:!y,onClick:G}),i.createElement(c.default,{className:"fxs-blade-button fxs-blade-maximized msportalfx-hideonactivated",title:K.maximize,ariaLabel:K.maximizeAria.format(t),disabled:ae,image:g.Maximize(),hidden:!0,onClick:j}),i.createElement(c.default,{className:"fxs-blade-button fxs-blade-restore msportalfx-hideonactivated",title:K.restore,ariaLabel:K.restoreAria.format(t),disabled:ae,image:g.Restore(),hidden:!0,onClick:Y}),i.createElement(c.default,{className:"fxs-blade-button fxs-blade-close msportalfx-hideonactivated",title:K.close,ariaLabel:K.closeAria.format(t),disabled:!1,image:g.Close(),hidden:ae,onClick:()=>{h.trace({timestamp:Date.now(),source:de,action:"CommandExecuted",name:"fxs-blade-close",data:{isReactShellHeader:!0}}),J()}}))),i.createElement(n.default,{subtitleValue:E,bladeResx:K,directoryInfoValue:S,uniqueIdForSubtitle:pe}))),i.createElement(c.default,{className:"fxs-blade-expander fxs-portal-hover",title:K.expandAria.format(t),ariaLabel:K.expandAria.format(t),disabled:!1,image:g.DoubleChevron(Ee),hidden:!V})))}})),
define("MsPortalImpl/Widgets/ShellHeader/useKnockoutComputationBatch",["require","exports","react"],(function(e,t,a){"use strict";t.default=void 0;t.default=(e,t)=>{const[l,i]=a.useState((()=>Object.entries(t).reduce(((e,[t,a])=>{const l=a.peek();return{...e,[t]:l}}),{}))),o=a.useRef([]),s=a.useRef(!1),r=a.useCallback((()=>{if(0===o.current.length||s.current)return;s.current=!0;const e=o.current;o.current=[],i((t=>{const a={...t};return e.forEach((e=>{e.key in t&&(a[e.key]=e.value)})),a})),s.current=!1}),[]);return a.useEffect((()=>{Object.entries(t).forEach((([e,t])=>{const a=t.peek();a!==l[e]&&o.current.push({key:e,value:a})})),o.current.length>0&&r();const a=Object.entries(t).map((([t,a])=>a.subscribe(e,(e=>{o.current.push({key:t,value:e}),queueMicrotask(r)}))));return()=>{o.current.length>0&&r(),a.forEach((e=>e.dispose()))}}),[e,t,r,l]),l}})),
define("MsPortalImpl/Widgets/ShellHeader/ShellHeader.React",["require","exports","_generated/Less/MsPortalImpl/Widgets/Widgets.Blade.css","FxInternal/Css","FxInternal/Weave","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/ShellHeader/RenderShellHeader.React","MsPortalImpl/Widgets/ShellHeader/RenderCopilotHeader.React","MsPortalImpl/Widgets/ShellHeader/RenderHelpSupportHeader.React","MsPortalImpl/Widgets/Hooks/useFluentTheme","MsPortalImpl/Widgets/ShellHeader/useKnockoutComputationBatch","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Services/Services.Copilot"],(function(e,t,a,l,i,o,s,r,n,d,c,u,m){"use strict";t.default=void 0,(0,l.injectCss)(a);t.default=({lifeTimeManager:e,vm:t,widgetBladeRef:a})=>{const l=t.bladeName.name?.toLowerCase(),p={titleValue:(0,i.toObservable)(e,t.title),titleMainValue:(0,i.toObservable)(e,t.titleMain),titleExtrasValue:(0,i.toObservable)(e,t.titleExtras),titleImageUriValue:(0,i.toObservable)(e,t.titleImageUri),subtitleValue:(0,i.toObservable)(e,t.subtitle),directoryInfoValue:(0,i.toObservable)(e,t.directoryInfo),collapsedValue:(0,i.toObservable)(e,t.collapsed),collapseVisibleValue:(0,i.toObservable)(e,t.collapseVisible),loadedValue:t.loaded,showTranslucentSpinnerValue:(0,i.toObservable)(e,t.showTranslucentSpinner),showTitleImageValue:(0,i.toObservable)(e,t.showTitleImage),showBladeIconValue:(0,i.toObservable)(e,t.showBladeIcon),iconValue:(0,i.toObservable)(e,t.icon),shareItEnabled:(0,i.toObservable)(e,t.shareItEnabled),pinEnabled:(0,i.toObservable)(e,t.pinEnabled),pinVisibleValue:(0,i.toObservable)(e,t.pinVisible),shareItVisibleValue:(0,i.toObservable)(e,t.shareItVisible),showFavoriteResourceButton:(0,i.toObservable)(e,t.showFavoriteResourceButton),favoriteResourceButtonIcon:(0,i.toObservable)(e,t.favoriteResourceButton.icon),favoriteResourceButtonTitle:(0,i.toObservable)(e,t.favoriteResourceButton.title),showEditAssetButton:(0,i.toObservable)(e,t.showEditAssetButton),editAssetButtonIcon:(0,i.toObservable)(e,t.editAssetButton.icon),editAssetButtonTitle:(0,i.toObservable)(e,t.editAssetButton.title),blade:a,editVisible:(0,i.toObservable)(e,t.editVisible),editEnabled:(0,i.toObservable)(e,t.editEnabled),editState:(0,i.toObservable)(e,t.editState),showCopilotContextMenu:(0,i.toObservable)(e,t.showCopilotContextMenu),deepLink:t.deepLink,isInContextPane:t.isInContextPane,isMenuBlade:t.isMenuBlade},b=t.ariaIds.title,f=t.ariaIds.subtitle,x=(0,c.default)(e,p),g=t.getTelemetryName(),h=!x.shareItEnabled,I=!x.pinEnabled,v=o.Blade,M=()=>{x.blade.minimize()},C=()=>{x.blade.maximize()},E=()=>{x.blade.close(!1)},S=()=>{x.blade.restore()},V=(0,d.useFluentTheme)(t.diContainer,e),P=new u.Uri(x.deepLink).getHashParts(),{enabled:R,chatView:w}=t.diContainer.get(m.CopilotService).getConfig();return l===w?(0,r.default)({titleValue:x.titleValue,loadedValue:x.loadedValue,showCopilotContextMenu:x.showCopilotContextMenu,showTitleImageValue:x.showTitleImageValue,titleImageUriValue:x.titleImageUriValue,showBladeIconValue:x.showBladeIconValue,iconValue:x.iconValue,titleMainValue:x.titleMainValue,titleExtrasValue:x.titleExtrasValue,subtitleValue:x.subtitleValue,customHome:t.customHome,bladeResx:v,handleOnClickClose:E,theme:V,diContainer:t.diContainer,uniqueIdForTitle:b,uniqueIdForSubtitle:f}):"helppane.reactview"===l?(0,n.default)({titleValue:x.titleValue,loadedValue:x.loadedValue,showTitleImageValue:x.showTitleImageValue,titleImageUriValue:x.titleImageUriValue,showBladeIconValue:x.showBladeIconValue,showMinimize:t.showMinimize,iconValue:x.iconValue,titleMainValue:x.titleMainValue,titleExtrasValue:x.titleExtrasValue,subtitleValue:x.subtitleValue,customHome:t.customHome,bladeResx:v,handleOnClickClose:E,handleOnClickMinimize:M,theme:V,uniqueIdForTitle:b,uniqueIdForSubtitle:f}):(0,s.default)({titleValue:x.titleValue,titleMainValue:x.titleMainValue,titleExtrasValue:x.titleExtrasValue,titleImageUriValue:x.titleImageUriValue,subtitleValue:x.subtitleValue,directoryInfoValue:x.directoryInfoValue,collapsedValue:x.collapsedValue,collapseVisibleValue:x.collapseVisibleValue,loadedValue:x.loadedValue,showTranslucentSpinnerValue:x.showTranslucentSpinnerValue,showTitleImageValue:x.showTitleImageValue,showBladeIconValue:x.showBladeIconValue,showMinimize:t.showMinimize,iconValue:x.iconValue,pinVisibleValue:x.pinVisibleValue,shareItVisibleValue:x.shareItVisibleValue,showFavoriteResourceButton:x.showFavoriteResourceButton,favoriteResourceButtonIcon:x.favoriteResourceButtonIcon,favoriteResourceButtonTitle:x.favoriteResourceButtonTitle,showEditAssetButton:x.showEditAssetButton,editAssetButtonIcon:x.editAssetButtonIcon,editAssetButtonTitle:x.editAssetButtonTitle,editVisible:x.editVisible,editEnabled:x.editEnabled,editState:x.editState,pinblade:t.pinblade,editblade:t.editblade,shareItBlade:t.shareItBlade,favoriteResourceButtonOnClick:t.favoriteResourceButton.onClick,editAssetButtonOnClick:t.editAssetButton.onClick,customHome:t.customHome,diContainer:t.diContainer,bladeName:t.getTelemetryName()?.toLowerCase(),bladeId:t.id,shareItDisabled:h,pinDisabled:I,bladeResx:v,handleOnClickMaximize:C,handleOnClickMinimize:M,handleOnClickClose:E,handleOnClickRestore:S,theme:V,hashParts:P,isInContextPane:x.isInContextPane,telemetryName:g,isMenuBlade:x.isMenuBlade,lifeTimeManager:e,uniqueIdForTitle:b,uniqueIdForSubtitle:f,resourceType:t.resourceType,kind:t.kind,isCopilotEnabled:R})}})),
define("MsPortalImpl/Widgets/ShellHeader/ShellHeaderWrapper",["require","exports","react","react-dom/client","MsPortalImpl/Widgets/ShellHeader/ShellHeader.React"],(function(e,t,a,l,i){"use strict";t.ShellHeaderWrapper=void 0;t.ShellHeaderWrapper=({element:e,...t})=>{const o=(0,l.createRoot)(e);return o.render(a.createElement(i.default,{...t})),t.lifeTimeManager.registerForDispose((()=>{o.unmount()})),e}}));