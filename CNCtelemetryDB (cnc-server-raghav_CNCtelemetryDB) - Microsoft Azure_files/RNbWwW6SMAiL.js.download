define("_generated/Less/MsPortalImpl/Widgets/ModalToolTip.css",["module"],(function(o){"use strict";return{css:'@keyframes keyframesForFadein{from{opacity:0}to{opacity:1}}.fxs-modal-can-transition{transition:.1s transform;animation:keyframesForFadein .1s ease-out;animation-fill-mode:forwards}.fxs-modal-overlay{position:fixed;z-index:6;top:0;left:0}.fxs-modal-overlay.fxs-modal-overlay-dismiss{cursor:pointer}.fxs-modal{position:absolute;box-sizing:border-box;top:0;left:0;z-index:7;background-color:#fff;opacity:0;transform:translateZ(0)}.fxs-modal>.fxs-modal-triangle{position:absolute;top:0;left:0;height:20px;width:20px}.fxs-modal>.fxs-modal-triangle::after{transition:.1s border-color;border:solid transparent;content:" ";height:0;width:0;position:absolute;top:0;left:0;pointer-events:none;border-color:rgba(255,255,255,0);border-width:10px}.fxs-modal>.fxs-modal-triangle.fxs-modal-right-triangle::after{border-right-color:#fff}.fxs-modal>.fxs-modal-triangle.fxs-modal-left-triangle::after{border-left-color:#fff}.fxs-modal>.fxs-modal-triangle.fxs-modal-top-triangle::after{border-top-color:#fff}.fxs-modal>.fxs-modal-triangle.fxs-modal-bottom-triangle::after{border-bottom-color:#fff}.fxs-modal-progress{display:flex;align-items:center}.fxs-modal-progress>.fxs-modal-progress-circle{width:6px;height:6px;padding:0;border-radius:50%;border:1px solid #808080;background-color:#fff;margin:0 2px;cursor:pointer}.fxs-modal-progress>.fxs-modal-progress-circle.fxs-modal-progress-current{background-color:#808080}.fxs-modaltooltip{width:300px;max-width:100%;padding:15px}.fxs-modaltooltip-title{font-size:15px;line-height:1;margin-top:0;margin-bottom:15px}.fxs-modaltooltip-description{font-size:12px;line-height:normal;margin-bottom:6px}.fxs-modaltooltip-button-container{position:relative;height:30px}.fxs-modaltooltip-close.fxc-simplebutton{position:absolute}.fxs-modaltooltip-close.fxc-simplebutton .fxs-button-default{min-width:24px;border:transparent;padding:0;line-height:24px}.fxs-modaltooltip-close.fxc-simplebutton .fxs-button-default .fxs-button-icon-right{margin-left:0}.fxs-modaltooltip-close-icon{z-index:-1;width:10px;height:10px;display:inline-block;position:absolute;right:12px;top:5px}.fxs-modaltooltip-close-icon svg{fill:#0058ad}.fxs-modaltooltip-progress{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);height:6px}.fxs-modaltooltip-button{display:flex;position:absolute;bottom:2px;min-width:0}.fxs-modaltooltip-button .fxs-button-default{border:transparent;padding:4px 10px;word-break:keep-all;white-space:nowrap;text-transform:uppercase;font-weight:600;font-size:10px;line-height:normal}.fxs-modaltooltip-prev{left:2px}.fxs-modaltooltip-prev .fxs-button-icon{position:absolute;top:50%;transform:translateY(-50%);pointer-events:none;height:20px;z-index:1;left:0}.fxs-modaltooltip-prev .fxs-button-icon svg{height:100%;width:10px}.fxs-modaltooltip-prev .fxs-button-icon svg{transform:rotate(-90deg)}.fxs-modaltooltip-next{right:2px}.fxs-modaltooltip-next .fxs-button-icon{position:absolute;top:50%;transform:translateY(-50%);pointer-events:none;height:20px;z-index:1;right:0}.fxs-modaltooltip-next .fxs-button-icon svg{height:100%;width:10px}.fxs-modaltooltip-next .fxs-button-icon svg{transform:rotate(90deg)}.fxs-modaltooltip-prev.fxs-modaltooltip-button,.fxs-modaltooltip-next.fxs-modaltooltip-button{position:absolute}',moduleId:o.id}})),
define("_generated/Less/MsPortalImpl/Widgets/ModalWelcomePrompt.css",["module"],(function(o){"use strict";return{css:".fxs-welcometour-bubble-layout{background-color:var(--colorButtonBackgroundPrimary);max-width:360px;border-radius:1px;box-shadow:0 6.4px 14.4px 0 rgba(0,0,0,.13),0 1.2px 3.6px 0 rgba(0,0,0,.1)}.fxs-welcometour-bubble-layout .fxs-portal-button-primary{border-color:var(--colorButtonBackgroundSecondary);margin-right:8px}.fxs-welcometour-bubble-layout .fxs-portal-button-primary:hover{border-color:var(--colorButtonBackgroundSecondary)}.fxs-welcometour-bubble-layout>.fxs-modal-triangle.fxs-modal-right-triangle::after{border-right-color:var(--colorButtonBackgroundPrimary)!important}.fxs-welcometour-bubble-layout>.fxs-modal-triangle.fxs-modal-left-triangle::after{border-left-color:var(--colorButtonBackgroundPrimary)!important}.fxs-welcometour-bubble-layout>.fxs-modal-triangle.fxs-modal-top-triangle::after{border-top-color:var(--colorButtonBackgroundPrimary)!important}.fxs-welcometour-bubble-layout>.fxs-modal-triangle.fxs-modal-bottom-triangle::after{border-bottom-color:var(--colorButtonBackgroundPrimary)!important}.fxs-welcometour-button-container{display:flex;gap:10px}.fxs-welcometour-button-container .fxs-button-default{border-color:var(--colorButtonBackgroundSecondary);color:var(--colorLink)}.fxs-welcometour-button-container .fxs-button-default:hover{border-color:var(--colorButtonBackgroundSecondary);color:var(--colorLink)}.fxs-welcometour-button-container .fxs-button-default:focus{border-color:var(--colorButtonBackgroundSecondary);color:var(--colorLink)}.fxs-welcometour-bubble-container{display:flex;flex-direction:column;gap:14px;box-sizing:border-box;line-height:1.5715;white-space:normal;background-color:var(--colorButtonBackgroundPrimary);padding:20px 24px;color:var(--colorTextInverted)}.fxs-welcometour-bubble-title{font-size:20px;font-weight:600}.fxs-welcometour-bubble-description{font-size:14px}.fxs-welcometour-bubble-footer{font-size:14px;display:flex;text-align:right;justify-content:space-between}.fxs-welcometour-bubble-step-text{margin-right:20px}.fxs-welcometour-bubble-close{width:24px;height:24px;position:absolute;right:16px;top:16px;border:0;cursor:pointer}.fxs-welcometour-bubble-close svg{fill:var(--colorButtonForegroundPrimary)}.fxs-welcometour-bubble-close :focus{outline-color:var(--colorControlBackgroundSelected)}.fxs-welcometour-bubble-close :hover{background-color:var(--colorButtonBackgroundPrimaryHover)}@media screen and (forced-colors:active){.fxs-welcometour-bubble-container{background-color:var(--colorHighContrastCanvas);color:var(--colorHighContrastCanvasText);box-shadow:inset 0 0 0 1px var(--colorHighContrastCanvasText)}.fxs-welcometour-button-container .fxs-button-default{color:var(--colorHighContrastButtonText);border-color:var(--colorHighContrastButtonText)}.fxs-welcometour-bubble-layout .fxs-portal-button-primary{border-color:var(--colorHighContrastButtonText)}.fxs-welcometour-bubble-layout .fxs-welcometour-bubble-close svg{fill:var(--colorHighContrastButtonText)}.fxs-welcometour-bubble-layout .fxs-welcometour-bubble-close :hover{background-color:inherit}.fxs-welcometour-bubble-layout .fxs-welcometour-bubble-close:hover svg{fill:var(--colorHighContrastHighlightText)}}.fxs-modalwelcomeprompt{box-sizing:border-box;width:480px;max-width:100%;text-align:center;padding:25px}.fxs-modalwelcomeprompt-title{font-weight:200;font-size:28px;line-height:normal;margin-top:0;margin-bottom:20px}.fxs-modalwelcomeprompt-body{font-size:13px;line-height:normal;margin-top:0;margin-bottom:20px}.fxs-modalwelcomeprompt-button-container{display:flex;justify-content:center}.fxs-modalwelcomeprompt-starttour{padding:5px 10px;word-break:keep-all;white-space:nowrap;border:0;margin-right:10px}.fxs-modalwelcomeprompt-maybelater{padding:5px 10px;word-break:keep-all;white-space:nowrap;border:0;margin-left:10px}.fxs-modalwelcomeprompt-maybelater:hover::after{border:0}",moduleId:o.id}})),
define("MsPortalImpl/Widgets/Widgets.WelcomeSequence",["require","exports","MsPortalImpl/TsxStringMode/Tsx","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.Modal","MsPortalImpl/Base/JQueryHelper","FxInternal/Css","_generated/Less/MsPortalImpl/Widgets/ModalWelcomePrompt.css","_generated/Less/MsPortalImpl/Widgets/ModalToolTip.css","MsPortalImpl/Widgets/Widgets.PersonalizedSurvey","MsPortalImpl/Services/Services.Copilot"],(function(o,t,e,r,s,l,a,i,n,c,d,p){"use strict";t.Widget=void 0;var u=e;(0,i.injectCss)(n,c);const m=s.Modal,x=s.WelcomeSequence,f="fxs-sidebar-create",b="fxs-sidebar-favorites",g="fxs-sidebar-browse",h="fxs-sidebar-home",w="fxs-sidebar-dashboard",v="fxs-search-box",y="fxs-topbar-notifications",B="fxs-topbar-helpmenu",C="fxs-topbar-avatarmenu",S="fxs-topbar-copilot",M=MsPortalFx.isFeatureEnabled("azurehome"),T=u.tsx(e.Root,null,u.tsx("h1",{class:"fxs-modalwelcomeprompt-title","data-bind":{text:"title"}}),u.tsx("p",{class:"fxs-modalwelcomeprompt-body","data-bind":{text:"description"}}),u.tsx("div",{class:"fxs-modalwelcomeprompt-button-container"},u.tsx("div",{class:"fxs-modalwelcomeprompt-starttour","data-bind":{pcControl:"startTourButton"}}),u.tsx("div",{class:"fxs-modalwelcomeprompt-maybelater","data-bind":{pcControl:"maybeLaterButton"}}))),k=u.tsx(e.Root,null,u.tsx("div",{class:"fxs-welcometour-bubble-container"},u.tsx("div",{class:"fxs-welcometour-bubble-title","data-bind":{text:"title"}}),u.tsx("div",{class:"fxs-welcometour-bubble-description","data-bind":{text:"description"}}),u.tsx("div",{class:"fxs-welcometour-bubble-footer"},u.tsx("div",{class:"fxs-welcometour-bubble-step-text","data-bind":{text:"stepText"}}),u.tsx("div",{class:"fxs-welcometour-button-container"},u.tsx("div",{class:"fxs-modaltooltip-prev","data-bind":{pcControl:"prevButton"}}),u.tsx("div",{class:"fxs-modaltooltip-next","data-bind":{pcControl:"nextButton"}})))),u.tsx("button",{class:"fxs-welcometour-bubble-close","data-bind":{fxclick:"closeTour",image:"MsPortalFx.Base.Images.Close()"},"aria-label":m.ariaCloseLabel}));class W extends r.Widget{constructor(o,t,e,r,s,l){super(o,t),this._settingsManager=r,this._diContainer=l,this._portal=e;let a,i=["fxs-sidebar-bar",v,y,B,C];const n=()=>{const o=this._portal.getRootElement();return!!o&&(i=i.filter((t=>!o.find(`.${t}`).length)),i.length?void 0:(void 0!==a&&clearInterval(a),this._intro(o,s),!0))};n()||(a=setInterval(n,1e3))}dispose(){super.dispose()}_intro(o,t){if(t.skipWelcomePrompt)return void this._startTour(o,t);const e={modalId:"Shell+WelcomeSequencePrompt",modalCategoryName:"GuidedTour",templateClass:"fxs-modalwelcomeprompt",template:T,activeClasses:{close:"fxs-modalwelcomeprompt-maybelater",next:"fxs-modalwelcomeprompt-starttour",title:"fxs-modalwelcomeprompt-title",description:"fxs-modalwelcomeprompt-body"},defaultLabels:{next:x.introStartTour,close:x.introMaybeLater},escapeToDismiss:!0,nextPrimaryButton:!0,items:[{title:x.introTitle,description:x.introDescription}]},r=new l.ViewModel(e),s=$(FxImpl.createElement("div"));o.append(s);const a=new l.Widget(s,r,o),i=this.ltm;i.registerForDispose(a),s.focus(),r.sequenceState.subscribe(i,(e=>{s.remove(),2===e?this.dispose():1===e&&this._startTour(o,t),this._settingsManager.setSetting(7,"WelcomeSequence",{viewed:+Date.now(),action:e,source:"WelcomeSequencePrompt"})}))}_startTour(o,t){const e=this._portal.sideBar,r=this._portal.topBar,s=[],i=(0,p.isCopilotEnabled)(this._diContainer),n=()=>{(e.hamburgerMode.value||0===e.layoutMode.value)&&e.setCollapsed(!1,!1)},c=()=>{(e.hamburgerMode.value||0===e.layoutMode.value)&&e.setCollapsed(!0,!1)},u=()=>{r.dropMenuWidget&&a.isElementVisible(r.dropMenuWidget.element[0])&&r.dropMenuWidget.openMenu(!1)},m=()=>{r.dropMenuWidget&&r.dropMenuWidget.closeMenu()},T=()=>{this._settingsManager.setSetting(7,"WelcomeSequenceCopilotStep",{viewed:+Date.now(),action:"CopilotStepDisplayed",source:"WelcomeSequencePrompt"})},W={anchorClass:f,anchorSide:2,title:x.tourNewTitle,description:x.tourNewDescription,cutouts:[f],onBefore:n,onAfter:c};if(s.push(W),M){const o={anchorClass:h,anchorSide:2,title:x.tourHomeTitle,description:x.tourHomeDescription,cutouts:[h],onBefore:n,onAfter:c};s.push(o)}const P={anchorClass:w,anchorSide:2,title:x.tourDashboardTitle,description:x.tourDashboardDescription,cutouts:[w],onBefore:n,onAfter:c};s.push(P);const I={anchorClass:g,anchorSide:2,title:x.tourBrowseTitle,description:x.tourBrowseDescription,cutouts:[g],onBefore:n,onAfter:c};s.push(I);const D={anchorClass:b,anchorSide:2,title:x.tourFavoritesTitle,description:x.tourFavoritesWithAllServicesDescription,cutouts:[b],onBefore:n,onAfter:c};s.push(D);const _={anchorClass:v,anchorSide:3,title:x.tourSearchTitle,description:x.tourSearchDescription,cutouts:[v]};if(s.push(_),i){const o={anchorClass:S,anchorSide:3,title:x.copilotTitle,description:x.copilotDescription,cutouts:[S],left:"10",onBefore:T};s.push(o)}const z={anchorClass:y,anchorSide:3,title:x.tourNotificationsTitle,description:x.tourNotificationsDescription,cutouts:[y],onBefore:u,onAfter:m,left:"10"};s.push(z);const F={anchorClass:B,anchorSide:3,title:x.tourSettingsHelpTitle,description:x.tourSettingsHelpDescription,cutouts:[B],onBefore:u,onAfter:m,left:"10"};s.push(F);const H={anchorClass:C,anchorSide:3,title:x.tourAvatarTitle,description:x.tourAvatarDescription,cutouts:[C],left:"10"};s.push(H);const q={modalId:"Shell+WelcomeSequenceTour",modalCategoryName:"GuidedTour",templateClass:"fxs-welcometour-bubble-layout",template:k,activeClasses:{close:"fxs-welcometour-bubble-close",prev:"fxs-modaltooltip-prev",next:"fxs-modaltooltip-next",title:"fxs-welcometour-bubble-title",description:"fxs-welcometour-bubble-description",stepText:"fxs-welcometour-bubble-step-text"},escapeToDismiss:!0,items:s},L=new l.ViewModel(q),A=$(FxImpl.createElement("div"));o.append(A);const E=new l.Widget(A,L,o),N=this.ltm;N.registerForDispose(E),A.focus(),L.sequenceState.subscribe(N,(o=>{0!==o&&(A.remove(),this.dispose(),t.shouldDisplaySettingBubble&&(0,d.displaySettingBubble)(this._diContainer))}))}static create(o,t,e,s){return new W($(FxImpl.createElement("div")),new r.ViewModel,o,t,e,s)}}t.Widget=W}));